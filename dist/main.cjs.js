"use strict";var Jw=Object.defineProperty,Zw=Object.defineProperties;var Kw=Object.getOwnPropertyDescriptors;var ev=Object.getOwnPropertySymbols;var Qw=Object.prototype.hasOwnProperty,$w=Object.prototype.propertyIsEnumerable;var nv=(b,E,v)=>E in b?Jw(b,E,{enumerable:!0,configurable:!0,writable:!0,value:v}):b[E]=v,Ac=(b,E)=>{for(var v in E||(E={}))Qw.call(E,v)&&nv(b,v,E[v]);if(ev)for(var v of ev(E))$w.call(E,v)&&nv(b,v,E[v]);return b},iv=(b,E)=>Zw(b,Kw(E));Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function tE(b){if(b&&b.__esModule)return b;var E=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});return b&&Object.keys(b).forEach(function(v){if(v!=="default"){var O=Object.getOwnPropertyDescriptor(b,v);Object.defineProperty(E,v,O.get?O:{enumerable:!0,get:function(){return b[v]}})}}),E.default=b,Object.freeze(E)}var li=function(b){var E={};function v(O){if(E[O])return E[O].exports;var S=E[O]={i:O,l:!1,exports:{}};return b[O].call(S.exports,S,S.exports,v),S.l=!0,S.exports}return v.m=b,v.c=E,v.d=function(O,S,I){v.o(O,S)||Object.defineProperty(O,S,{enumerable:!0,get:I})},v.r=function(O){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})},v.t=function(O,S){if(1&S&&(O=v(O)),8&S||4&S&&typeof O=="object"&&O&&O.__esModule)return O;var I=Object.create(null);if(v.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:O}),2&S&&typeof O!="string")for(var D in O)v.d(I,D,function(F){return O[F]}.bind(null,D));return I},v.n=function(O){var S=O&&O.__esModule?function(){return O.default}:function(){return O};return v.d(S,"a",S),S},v.o=function(O,S){return Object.prototype.hasOwnProperty.call(O,S)},v.p="",v(v.s=229)}([function(b,E,v){/*!
* @pixi/constants - v6.4.2
* Compiled Thu, 02 Jun 2022 15:39:26 UTC
*
* @pixi/constants is licensed under the MIT License.
* http://www.opensource.org/licenses/mit-license
*/var O,S,I,D,F,z,J,X,et,ut,Rt,St,L,R,U,W,P,j,$;v.d(E,"a",function(){return L}),v.d(E,"b",function(){return D}),v.d(E,"c",function(){return I}),v.d(E,"d",function(){return $}),v.d(E,"e",function(){return R}),v.d(E,"f",function(){return F}),v.d(E,"g",function(){return O}),v.d(E,"h",function(){return z}),v.d(E,"i",function(){return U}),v.d(E,"j",function(){return P}),v.d(E,"k",function(){return St}),v.d(E,"l",function(){return j}),v.d(E,"m",function(){return W}),v.d(E,"n",function(){return S}),v.d(E,"o",function(){return et}),v.d(E,"p",function(){return ut}),v.d(E,"q",function(){return J}),v.d(E,"r",function(){return X}),v.d(E,"s",function(){return Rt}),function(H){H[H.WEBGL_LEGACY=0]="WEBGL_LEGACY",H[H.WEBGL=1]="WEBGL",H[H.WEBGL2=2]="WEBGL2"}(O||(O={})),function(H){H[H.UNKNOWN=0]="UNKNOWN",H[H.WEBGL=1]="WEBGL",H[H.CANVAS=2]="CANVAS"}(S||(S={})),function(H){H[H.COLOR=16384]="COLOR",H[H.DEPTH=256]="DEPTH",H[H.STENCIL=1024]="STENCIL"}(I||(I={})),function(H){H[H.NORMAL=0]="NORMAL",H[H.ADD=1]="ADD",H[H.MULTIPLY=2]="MULTIPLY",H[H.SCREEN=3]="SCREEN",H[H.OVERLAY=4]="OVERLAY",H[H.DARKEN=5]="DARKEN",H[H.LIGHTEN=6]="LIGHTEN",H[H.COLOR_DODGE=7]="COLOR_DODGE",H[H.COLOR_BURN=8]="COLOR_BURN",H[H.HARD_LIGHT=9]="HARD_LIGHT",H[H.SOFT_LIGHT=10]="SOFT_LIGHT",H[H.DIFFERENCE=11]="DIFFERENCE",H[H.EXCLUSION=12]="EXCLUSION",H[H.HUE=13]="HUE",H[H.SATURATION=14]="SATURATION",H[H.COLOR=15]="COLOR",H[H.LUMINOSITY=16]="LUMINOSITY",H[H.NORMAL_NPM=17]="NORMAL_NPM",H[H.ADD_NPM=18]="ADD_NPM",H[H.SCREEN_NPM=19]="SCREEN_NPM",H[H.NONE=20]="NONE",H[H.SRC_OVER=0]="SRC_OVER",H[H.SRC_IN=21]="SRC_IN",H[H.SRC_OUT=22]="SRC_OUT",H[H.SRC_ATOP=23]="SRC_ATOP",H[H.DST_OVER=24]="DST_OVER",H[H.DST_IN=25]="DST_IN",H[H.DST_OUT=26]="DST_OUT",H[H.DST_ATOP=27]="DST_ATOP",H[H.ERASE=26]="ERASE",H[H.SUBTRACT=28]="SUBTRACT",H[H.XOR=29]="XOR"}(D||(D={})),function(H){H[H.POINTS=0]="POINTS",H[H.LINES=1]="LINES",H[H.LINE_LOOP=2]="LINE_LOOP",H[H.LINE_STRIP=3]="LINE_STRIP",H[H.TRIANGLES=4]="TRIANGLES",H[H.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",H[H.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(F||(F={})),function(H){H[H.RGBA=6408]="RGBA",H[H.RGB=6407]="RGB",H[H.RG=33319]="RG",H[H.RED=6403]="RED",H[H.RGBA_INTEGER=36249]="RGBA_INTEGER",H[H.RGB_INTEGER=36248]="RGB_INTEGER",H[H.RG_INTEGER=33320]="RG_INTEGER",H[H.RED_INTEGER=36244]="RED_INTEGER",H[H.ALPHA=6406]="ALPHA",H[H.LUMINANCE=6409]="LUMINANCE",H[H.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",H[H.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",H[H.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(z||(z={})),function(H){H[H.TEXTURE_2D=3553]="TEXTURE_2D",H[H.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",H[H.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",H[H.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",H[H.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",H[H.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",H[H.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",H[H.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",H[H.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(J||(J={})),function(H){H[H.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",H[H.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",H[H.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",H[H.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",H[H.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",H[H.UNSIGNED_INT=5125]="UNSIGNED_INT",H[H.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",H[H.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",H[H.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",H[H.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",H[H.BYTE=5120]="BYTE",H[H.SHORT=5122]="SHORT",H[H.INT=5124]="INT",H[H.FLOAT=5126]="FLOAT",H[H.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",H[H.HALF_FLOAT=36193]="HALF_FLOAT"}(X||(X={})),function(H){H[H.FLOAT=0]="FLOAT",H[H.INT=1]="INT",H[H.UINT=2]="UINT"}(et||(et={})),function(H){H[H.NEAREST=0]="NEAREST",H[H.LINEAR=1]="LINEAR"}(ut||(ut={})),function(H){H[H.CLAMP=33071]="CLAMP",H[H.REPEAT=10497]="REPEAT",H[H.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Rt||(Rt={})),function(H){H[H.OFF=0]="OFF",H[H.POW2=1]="POW2",H[H.ON=2]="ON",H[H.ON_MANUAL=3]="ON_MANUAL"}(St||(St={})),function(H){H[H.NPM=0]="NPM",H[H.UNPACK=1]="UNPACK",H[H.PMA=2]="PMA",H[H.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",H[H.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",H[H.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",H[H.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(L||(L={})),function(H){H[H.NO=0]="NO",H[H.YES=1]="YES",H[H.AUTO=2]="AUTO",H[H.BLEND=0]="BLEND",H[H.CLEAR=1]="CLEAR",H[H.BLIT=2]="BLIT"}(R||(R={})),function(H){H[H.AUTO=0]="AUTO",H[H.MANUAL=1]="MANUAL"}(U||(U={})),function(H){H.LOW="lowp",H.MEDIUM="mediump",H.HIGH="highp"}(W||(W={})),function(H){H[H.NONE=0]="NONE",H[H.SCISSOR=1]="SCISSOR",H[H.STENCIL=2]="STENCIL",H[H.SPRITE=3]="SPRITE"}(P||(P={})),function(H){H[H.NONE=0]="NONE",H[H.LOW=2]="LOW",H[H.MEDIUM=4]="MEDIUM",H[H.HIGH=8]="HIGH"}(j||(j={})),function(H){H[H.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",H[H.ARRAY_BUFFER=34962]="ARRAY_BUFFER",H[H.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}($||($={}))},function(b,E,v){v.d(E,"a",function(){return X}),v.d(E,"b",function(){return D}),v.d(E,"c",function(){return et}),v.d(E,"d",function(){return L}),v.d(E,"e",function(){return St}),v.d(E,"f",function(){return S}),v.d(E,"g",function(){return F}),v.d(E,"h",function(){return ut}),v.d(E,"i",function(){return I}),v.d(E,"j",function(){return J}),v.d(E,"k",function(){return Rt}),v.d(E,"l",function(){return O}),v.d(E,"m",function(){return Vt}),v.d(E,"n",function(){return Nt});/*!
 * @pixi/math - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var O,S=2*Math.PI,I=180/Math.PI,D=Math.PI/180;(function(st){st[st.POLY=0]="POLY",st[st.RECT=1]="RECT",st[st.CIRC=2]="CIRC",st[st.ELIP=3]="ELIP",st[st.RREC=4]="RREC"})(O||(O={}));var F=function(){function st(V,B){V===void 0&&(V=0),B===void 0&&(B=0),this.x=0,this.y=0,this.x=V,this.y=B}return st.prototype.clone=function(){return new st(this.x,this.y)},st.prototype.copyFrom=function(V){return this.set(V.x,V.y),this},st.prototype.copyTo=function(V){return V.set(this.x,this.y),V},st.prototype.equals=function(V){return V.x===this.x&&V.y===this.y},st.prototype.set=function(V,B){return V===void 0&&(V=0),B===void 0&&(B=V),this.x=V,this.y=B,this},st.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},st}(),z=[new F,new F,new F,new F],J=function(){function st(V,B,ft,tt){V===void 0&&(V=0),B===void 0&&(B=0),ft===void 0&&(ft=0),tt===void 0&&(tt=0),this.x=Number(V),this.y=Number(B),this.width=Number(ft),this.height=Number(tt),this.type=O.RECT}return Object.defineProperty(st.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(st,"EMPTY",{get:function(){return new st(0,0,0,0)},enumerable:!1,configurable:!0}),st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.copyFrom=function(V){return this.x=V.x,this.y=V.y,this.width=V.width,this.height=V.height,this},st.prototype.copyTo=function(V){return V.x=this.x,V.y=this.y,V.width=this.width,V.height=this.height,V},st.prototype.contains=function(V,B){return!(this.width<=0||this.height<=0)&&V>=this.x&&V<this.x+this.width&&B>=this.y&&B<this.y+this.height},st.prototype.intersects=function(V,B){if(!B){var ft=this.x<V.x?V.x:this.x;if((this.right>V.right?V.right:this.right)<=ft)return!1;var tt=this.y<V.y?V.y:this.y;return(this.bottom>V.bottom?V.bottom:this.bottom)>tt}var vt=this.left,Dt=this.right,Z=this.top,pt=this.bottom;if(Dt<=vt||pt<=Z)return!1;var rt=z[0].set(V.left,V.top),_t=z[1].set(V.left,V.bottom),Et=z[2].set(V.right,V.top),Gt=z[3].set(V.right,V.bottom);if(Et.x<=rt.x||_t.y<=rt.y)return!1;var Xt=Math.sign(B.a*B.d-B.b*B.c);if(Xt===0||(B.apply(rt,rt),B.apply(_t,_t),B.apply(Et,Et),B.apply(Gt,Gt),Math.max(rt.x,_t.x,Et.x,Gt.x)<=vt||Math.min(rt.x,_t.x,Et.x,Gt.x)>=Dt||Math.max(rt.y,_t.y,Et.y,Gt.y)<=Z||Math.min(rt.y,_t.y,Et.y,Gt.y)>=pt))return!1;var Jt=Xt*(_t.y-rt.y),at=Xt*(rt.x-_t.x),_e=Jt*vt+at*Z,ke=Jt*Dt+at*Z,Oe=Jt*vt+at*pt,Ae=Jt*Dt+at*pt;if(Math.max(_e,ke,Oe,Ae)<=Jt*rt.x+at*rt.y||Math.min(_e,ke,Oe,Ae)>=Jt*Gt.x+at*Gt.y)return!1;var ze=Xt*(rt.y-Et.y),$e=Xt*(Et.x-rt.x),cn=ze*vt+$e*Z,Ue=ze*Dt+$e*Z,Ge=ze*vt+$e*pt,Rn=ze*Dt+$e*pt;return!(Math.max(cn,Ue,Ge,Rn)<=ze*rt.x+$e*rt.y||Math.min(cn,Ue,Ge,Rn)>=ze*Gt.x+$e*Gt.y)},st.prototype.pad=function(V,B){return V===void 0&&(V=0),B===void 0&&(B=V),this.x-=V,this.y-=B,this.width+=2*V,this.height+=2*B,this},st.prototype.fit=function(V){var B=Math.max(this.x,V.x),ft=Math.min(this.x+this.width,V.x+V.width),tt=Math.max(this.y,V.y),vt=Math.min(this.y+this.height,V.y+V.height);return this.x=B,this.width=Math.max(ft-B,0),this.y=tt,this.height=Math.max(vt-tt,0),this},st.prototype.ceil=function(V,B){V===void 0&&(V=1),B===void 0&&(B=.001);var ft=Math.ceil((this.x+this.width-B)*V)/V,tt=Math.ceil((this.y+this.height-B)*V)/V;return this.x=Math.floor((this.x+B)*V)/V,this.y=Math.floor((this.y+B)*V)/V,this.width=ft-this.x,this.height=tt-this.y,this},st.prototype.enlarge=function(V){var B=Math.min(this.x,V.x),ft=Math.max(this.x+this.width,V.x+V.width),tt=Math.min(this.y,V.y),vt=Math.max(this.y+this.height,V.y+V.height);return this.x=B,this.width=ft-B,this.y=tt,this.height=vt-tt,this},st.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),X=function(){function st(V,B,ft){V===void 0&&(V=0),B===void 0&&(B=0),ft===void 0&&(ft=0),this.x=V,this.y=B,this.radius=ft,this.type=O.CIRC}return st.prototype.clone=function(){return new st(this.x,this.y,this.radius)},st.prototype.contains=function(V,B){if(this.radius<=0)return!1;var ft=this.radius*this.radius,tt=this.x-V,vt=this.y-B;return(tt*=tt)+(vt*=vt)<=ft},st.prototype.getBounds=function(){return new J(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},st.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},st}(),et=function(){function st(V,B,ft,tt){V===void 0&&(V=0),B===void 0&&(B=0),ft===void 0&&(ft=0),tt===void 0&&(tt=0),this.x=V,this.y=B,this.width=ft,this.height=tt,this.type=O.ELIP}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.contains=function(V,B){if(this.width<=0||this.height<=0)return!1;var ft=(V-this.x)/this.width,tt=(B-this.y)/this.height;return(ft*=ft)+(tt*=tt)<=1},st.prototype.getBounds=function(){return new J(this.x-this.width,this.y-this.height,this.width,this.height)},st.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),ut=function(){function st(){for(var V=arguments,B=[],ft=0;ft<arguments.length;ft++)B[ft]=V[ft];var tt=Array.isArray(B[0])?B[0]:B;if(typeof tt[0]!="number"){for(var vt=[],Dt=0,Z=tt.length;Dt<Z;Dt++)vt.push(tt[Dt].x,tt[Dt].y);tt=vt}this.points=tt,this.type=O.POLY,this.closeStroke=!0}return st.prototype.clone=function(){var V=new st(this.points.slice());return V.closeStroke=this.closeStroke,V},st.prototype.contains=function(V,B){for(var ft=!1,tt=this.points.length/2,vt=0,Dt=tt-1;vt<tt;Dt=vt++){var Z=this.points[2*vt],pt=this.points[2*vt+1],rt=this.points[2*Dt],_t=this.points[2*Dt+1];pt>B!=_t>B&&V<(B-pt)/(_t-pt)*(rt-Z)+Z&&(ft=!ft)}return ft},st.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(V,B){return V+", "+B},"")+"]"},st}(),Rt=function(){function st(V,B,ft,tt,vt){V===void 0&&(V=0),B===void 0&&(B=0),ft===void 0&&(ft=0),tt===void 0&&(tt=0),vt===void 0&&(vt=20),this.x=V,this.y=B,this.width=ft,this.height=tt,this.radius=vt,this.type=O.RREC}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height,this.radius)},st.prototype.contains=function(V,B){if(this.width<=0||this.height<=0)return!1;if(V>=this.x&&V<=this.x+this.width&&B>=this.y&&B<=this.y+this.height){var ft=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(B>=this.y+ft&&B<=this.y+this.height-ft||V>=this.x+ft&&V<=this.x+this.width-ft)return!0;var tt=V-(this.x+ft),vt=B-(this.y+ft),Dt=ft*ft;if(tt*tt+vt*vt<=Dt||(tt=V-(this.x+this.width-ft))*tt+vt*vt<=Dt||tt*tt+(vt=B-(this.y+this.height-ft))*vt<=Dt||(tt=V-(this.x+ft))*tt+vt*vt<=Dt)return!0}return!1},st.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},st}(),St=function(){function st(V,B,ft,tt){ft===void 0&&(ft=0),tt===void 0&&(tt=0),this._x=ft,this._y=tt,this.cb=V,this.scope=B}return st.prototype.clone=function(V,B){return V===void 0&&(V=this.cb),B===void 0&&(B=this.scope),new st(V,B,this._x,this._y)},st.prototype.set=function(V,B){return V===void 0&&(V=0),B===void 0&&(B=V),this._x===V&&this._y===B||(this._x=V,this._y=B,this.cb.call(this.scope)),this},st.prototype.copyFrom=function(V){return this._x===V.x&&this._y===V.y||(this._x=V.x,this._y=V.y,this.cb.call(this.scope)),this},st.prototype.copyTo=function(V){return V.set(this._x,this._y),V},st.prototype.equals=function(V){return V.x===this._x&&V.y===this._y},st.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(st.prototype,"x",{get:function(){return this._x},set:function(V){this._x!==V&&(this._x=V,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"y",{get:function(){return this._y},set:function(V){this._y!==V&&(this._y=V,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),st}(),L=function(){function st(V,B,ft,tt,vt,Dt){V===void 0&&(V=1),B===void 0&&(B=0),ft===void 0&&(ft=0),tt===void 0&&(tt=1),vt===void 0&&(vt=0),Dt===void 0&&(Dt=0),this.array=null,this.a=V,this.b=B,this.c=ft,this.d=tt,this.tx=vt,this.ty=Dt}return st.prototype.fromArray=function(V){this.a=V[0],this.b=V[1],this.c=V[3],this.d=V[4],this.tx=V[2],this.ty=V[5]},st.prototype.set=function(V,B,ft,tt,vt,Dt){return this.a=V,this.b=B,this.c=ft,this.d=tt,this.tx=vt,this.ty=Dt,this},st.prototype.toArray=function(V,B){this.array||(this.array=new Float32Array(9));var ft=B||this.array;return V?(ft[0]=this.a,ft[1]=this.b,ft[2]=0,ft[3]=this.c,ft[4]=this.d,ft[5]=0,ft[6]=this.tx,ft[7]=this.ty,ft[8]=1):(ft[0]=this.a,ft[1]=this.c,ft[2]=this.tx,ft[3]=this.b,ft[4]=this.d,ft[5]=this.ty,ft[6]=0,ft[7]=0,ft[8]=1),ft},st.prototype.apply=function(V,B){B=B||new F;var ft=V.x,tt=V.y;return B.x=this.a*ft+this.c*tt+this.tx,B.y=this.b*ft+this.d*tt+this.ty,B},st.prototype.applyInverse=function(V,B){B=B||new F;var ft=1/(this.a*this.d+this.c*-this.b),tt=V.x,vt=V.y;return B.x=this.d*ft*tt+-this.c*ft*vt+(this.ty*this.c-this.tx*this.d)*ft,B.y=this.a*ft*vt+-this.b*ft*tt+(-this.ty*this.a+this.tx*this.b)*ft,B},st.prototype.translate=function(V,B){return this.tx+=V,this.ty+=B,this},st.prototype.scale=function(V,B){return this.a*=V,this.d*=B,this.c*=V,this.b*=B,this.tx*=V,this.ty*=B,this},st.prototype.rotate=function(V){var B=Math.cos(V),ft=Math.sin(V),tt=this.a,vt=this.c,Dt=this.tx;return this.a=tt*B-this.b*ft,this.b=tt*ft+this.b*B,this.c=vt*B-this.d*ft,this.d=vt*ft+this.d*B,this.tx=Dt*B-this.ty*ft,this.ty=Dt*ft+this.ty*B,this},st.prototype.append=function(V){var B=this.a,ft=this.b,tt=this.c,vt=this.d;return this.a=V.a*B+V.b*tt,this.b=V.a*ft+V.b*vt,this.c=V.c*B+V.d*tt,this.d=V.c*ft+V.d*vt,this.tx=V.tx*B+V.ty*tt+this.tx,this.ty=V.tx*ft+V.ty*vt+this.ty,this},st.prototype.setTransform=function(V,B,ft,tt,vt,Dt,Z,pt,rt){return this.a=Math.cos(Z+rt)*vt,this.b=Math.sin(Z+rt)*vt,this.c=-Math.sin(Z-pt)*Dt,this.d=Math.cos(Z-pt)*Dt,this.tx=V-(ft*this.a+tt*this.c),this.ty=B-(ft*this.b+tt*this.d),this},st.prototype.prepend=function(V){var B=this.tx;if(V.a!==1||V.b!==0||V.c!==0||V.d!==1){var ft=this.a,tt=this.c;this.a=ft*V.a+this.b*V.c,this.b=ft*V.b+this.b*V.d,this.c=tt*V.a+this.d*V.c,this.d=tt*V.b+this.d*V.d}return this.tx=B*V.a+this.ty*V.c+V.tx,this.ty=B*V.b+this.ty*V.d+V.ty,this},st.prototype.decompose=function(V){var B=this.a,ft=this.b,tt=this.c,vt=this.d,Dt=V.pivot,Z=-Math.atan2(-tt,vt),pt=Math.atan2(ft,B),rt=Math.abs(Z+pt);return rt<1e-5||Math.abs(S-rt)<1e-5?(V.rotation=pt,V.skew.x=V.skew.y=0):(V.rotation=0,V.skew.x=Z,V.skew.y=pt),V.scale.x=Math.sqrt(B*B+ft*ft),V.scale.y=Math.sqrt(tt*tt+vt*vt),V.position.x=this.tx+(Dt.x*B+Dt.y*tt),V.position.y=this.ty+(Dt.x*ft+Dt.y*vt),V},st.prototype.invert=function(){var V=this.a,B=this.b,ft=this.c,tt=this.d,vt=this.tx,Dt=V*tt-B*ft;return this.a=tt/Dt,this.b=-B/Dt,this.c=-ft/Dt,this.d=V/Dt,this.tx=(ft*this.ty-tt*vt)/Dt,this.ty=-(V*this.ty-B*vt)/Dt,this},st.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},st.prototype.clone=function(){var V=new st;return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},st.prototype.copyTo=function(V){return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},st.prototype.copyFrom=function(V){return this.a=V.a,this.b=V.b,this.c=V.c,this.d=V.d,this.tx=V.tx,this.ty=V.ty,this},st.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(st,"IDENTITY",{get:function(){return new st},enumerable:!1,configurable:!0}),Object.defineProperty(st,"TEMP_MATRIX",{get:function(){return new st},enumerable:!1,configurable:!0}),st}(),R=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],U=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],W=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],P=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],j=[],$=[],H=Math.sign;(function(){for(var st=0;st<16;st++){var V=[];j.push(V);for(var B=0;B<16;B++)for(var ft=H(R[st]*R[B]+W[st]*U[B]),tt=H(U[st]*R[B]+P[st]*U[B]),vt=H(R[st]*W[B]+W[st]*P[B]),Dt=H(U[st]*W[B]+P[st]*P[B]),Z=0;Z<16;Z++)if(R[Z]===ft&&U[Z]===tt&&W[Z]===vt&&P[Z]===Dt){V.push(Z);break}}for(st=0;st<16;st++){var pt=new L;pt.set(R[st],U[st],W[st],P[st],0,0),$.push(pt)}})();var Nt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(st){return R[st]},uY:function(st){return U[st]},vX:function(st){return W[st]},vY:function(st){return P[st]},inv:function(st){return 8&st?15&st:7&-st},add:function(st,V){return j[st][V]},sub:function(st,V){return j[st][Nt.inv(V)]},rotate180:function(st){return 4^st},isVertical:function(st){return(3&st)==2},byDirection:function(st,V){return 2*Math.abs(st)<=Math.abs(V)?V>=0?Nt.S:Nt.N:2*Math.abs(V)<=Math.abs(st)?st>0?Nt.E:Nt.W:V>0?st>0?Nt.SE:Nt.SW:st>0?Nt.NE:Nt.NW},matrixAppendRotationInv:function(st,V,B,ft){B===void 0&&(B=0),ft===void 0&&(ft=0);var tt=$[Nt.inv(V)];tt.tx=B,tt.ty=ft,st.append(tt)}},Vt=function(){function st(){this.worldTransform=new L,this.localTransform=new L,this.position=new St(this.onChange,this,0,0),this.scale=new St(this.onChange,this,1,1),this.pivot=new St(this.onChange,this,0,0),this.skew=new St(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return st.prototype.onChange=function(){this._localID++},st.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},st.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},st.prototype.updateLocalTransform=function(){var V=this.localTransform;this._localID!==this._currentLocalID&&(V.a=this._cx*this.scale.x,V.b=this._sx*this.scale.x,V.c=this._cy*this.scale.y,V.d=this._sy*this.scale.y,V.tx=this.position.x-(this.pivot.x*V.a+this.pivot.y*V.c),V.ty=this.position.y-(this.pivot.x*V.b+this.pivot.y*V.d),this._currentLocalID=this._localID,this._parentID=-1)},st.prototype.updateTransform=function(V){var B=this.localTransform;if(this._localID!==this._currentLocalID&&(B.a=this._cx*this.scale.x,B.b=this._sx*this.scale.x,B.c=this._cy*this.scale.y,B.d=this._sy*this.scale.y,B.tx=this.position.x-(this.pivot.x*B.a+this.pivot.y*B.c),B.ty=this.position.y-(this.pivot.x*B.b+this.pivot.y*B.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==V._worldID){var ft=V.worldTransform,tt=this.worldTransform;tt.a=B.a*ft.a+B.b*ft.c,tt.b=B.a*ft.b+B.b*ft.d,tt.c=B.c*ft.a+B.d*ft.c,tt.d=B.c*ft.b+B.d*ft.d,tt.tx=B.tx*ft.a+B.ty*ft.c+ft.tx,tt.ty=B.tx*ft.b+B.ty*ft.d+ft.ty,this._parentID=V._worldID,this._worldID++}},st.prototype.setFromMatrix=function(V){V.decompose(this),this._localID++},Object.defineProperty(st.prototype,"rotation",{get:function(){return this._rotation},set:function(V){this._rotation!==V&&(this._rotation=V,this.updateSkew())},enumerable:!1,configurable:!0}),st.IDENTITY=new st,st}()},function(b,E,v){v.d(E,"a",function(){return bi}),v.d(E,"b",function(){return tt}),v.d(E,"c",function(){return U}),v.d(E,"d",function(){return To}),v.d(E,"e",function(){return or}),v.d(E,"f",function(){return Ao}),v.d(E,"g",function(){return Fr}),v.d(E,"h",function(){return Xt}),v.d(E,"i",function(){return L}),v.d(E,"j",function(){return $}),v.d(E,"k",function(){return Mi}),v.d(E,"l",function(){return Oe}),v.d(E,"m",function(){return pe}),v.d(E,"n",function(){return jn}),v.d(E,"o",function(){return ze}),v.d(E,"p",function(){return rt}),v.d(E,"q",function(){return Ni}),v.d(E,"r",function(){return Ki}),v.d(E,"s",function(){return Wr}),v.d(E,"t",function(){return pt}),v.d(E,"u",function(){return Lr}),v.d(E,"v",function(){return cn}),v.d(E,"w",function(){return st}),v.d(E,"x",function(){return wo}),v.d(E,"y",function(){return so}),v.d(E,"z",function(){return Wn}),v.d(E,"A",function(){return fi});var O=v(4),S=v(0),I=v(3),D=v(12),F=v(7),z=v(1);/*!
 * @pixi/core - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */O.b.PREFER_ENV=I.isMobile.any?S.g.WEBGL:S.g.WEBGL2,O.b.STRICT_TEXTURE_CACHE=!1;var J=[];function X(Y,g){if(!Y)return null;var m="";if(typeof Y=="string"){var y=/\.(\w{3,4})(?:$|\?|#)/i.exec(Y);y&&(m=y[1].toLowerCase())}for(var N=J.length-1;N>=0;--N){var q=J[N];if(q.test&&q.test(Y,m))return new q(Y,g)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var et=function(Y,g){return(et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var N in y)y.hasOwnProperty(N)&&(m[N]=y[N])})(Y,g)};function ut(Y,g){function m(){this.constructor=Y}et(Y,g),Y.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}var Rt=function(){return(Rt=Object.assign||function(Y){for(var g,m=arguments,y=1,N=arguments.length;y<N;y++)for(var q in g=m[y])Object.prototype.hasOwnProperty.call(g,q)&&(Y[q]=g[q]);return Y}).apply(this,arguments)},St=function(){function Y(g,m){g===void 0&&(g=0),m===void 0&&(m=0),this._width=g,this._height=m,this.destroyed=!1,this.internal=!1,this.onResize=new D.a("setRealSize"),this.onUpdate=new D.a("update"),this.onError=new D.a("onError")}return Y.prototype.bind=function(g){this.onResize.add(g),this.onUpdate.add(g),this.onError.add(g),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},Y.prototype.unbind=function(g){this.onResize.remove(g),this.onUpdate.remove(g),this.onError.remove(g)},Y.prototype.resize=function(g,m){g===this._width&&m===this._height||(this._width=g,this._height=m,this.onResize.emit(g,m))},Object.defineProperty(Y.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),Y.prototype.update=function(){this.destroyed||this.onUpdate.emit()},Y.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(Y.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Y.prototype.style=function(g,m,y){return!1},Y.prototype.dispose=function(){},Y.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Y.test=function(g,m){return!1},Y}(),L=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,xt=q.height;if(!ht||!xt)throw new Error("BufferResource width or height invalid");return(N=Y.call(this,ht,xt)||this).data=m,N}return ut(g,Y),g.prototype.upload=function(m,y,N){var q=m.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===S.a.UNPACK);var ht=y.realWidth,xt=y.realHeight;return N.width===ht&&N.height===xt?q.texSubImage2D(y.target,0,0,0,ht,xt,y.format,N.type,this.data):(N.width=ht,N.height=xt,q.texImage2D(y.target,0,N.internalFormat,ht,xt,0,y.format,N.type,this.data)),!0},g.prototype.dispose=function(){this.data=null},g.test=function(m){return m instanceof Float32Array||m instanceof Uint8Array||m instanceof Uint32Array},g}(St),R={scaleMode:S.p.NEAREST,format:S.h.RGBA,alphaMode:S.a.NPM},U=function(Y){function g(m,y){m===void 0&&(m=null),y===void 0&&(y=null);var N=Y.call(this)||this,q=(y=y||{}).alphaMode,ht=y.mipmap,xt=y.anisotropicLevel,Tt=y.scaleMode,Kt=y.width,ee=y.height,Fe=y.wrapMode,Te=y.format,Qe=y.type,hn=y.target,vn=y.resolution,un=y.resourceOptions;return!m||m instanceof St||((m=X(m,un)).internal=!0),N.resolution=vn||O.b.RESOLUTION,N.width=Math.round((Kt||0)*N.resolution)/N.resolution,N.height=Math.round((ee||0)*N.resolution)/N.resolution,N._mipmap=ht!==void 0?ht:O.b.MIPMAP_TEXTURES,N.anisotropicLevel=xt!==void 0?xt:O.b.ANISOTROPIC_LEVEL,N._wrapMode=Fe||O.b.WRAP_MODE,N._scaleMode=Tt!==void 0?Tt:O.b.SCALE_MODE,N.format=Te||S.h.RGBA,N.type=Qe||S.r.UNSIGNED_BYTE,N.target=hn||S.q.TEXTURE_2D,N.alphaMode=q!==void 0?q:S.a.UNPACK,N.uid=Object(I.uid)(),N.touched=0,N.isPowerOfTwo=!1,N._refreshPOT(),N._glTextures={},N.dirtyId=0,N.dirtyStyleId=0,N.cacheId=null,N.valid=Kt>0&&ee>0,N.textureCacheIds=[],N.destroyed=!1,N.resource=null,N._batchEnabled=0,N._batchLocation=0,N.parentTextureArray=null,N.setResource(m),N}return ut(g,Y),Object.defineProperty(g.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"mipmap",{get:function(){return this._mipmap},set:function(m){this._mipmap!==m&&(this._mipmap=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(m){this._scaleMode!==m&&(this._scaleMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(m){this._wrapMode!==m&&(this._wrapMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),g.prototype.setStyle=function(m,y){var N;return m!==void 0&&m!==this.scaleMode&&(this.scaleMode=m,N=!0),y!==void 0&&y!==this.mipmap&&(this.mipmap=y,N=!0),N&&this.dirtyStyleId++,this},g.prototype.setSize=function(m,y,N){return N=N||this.resolution,this.setRealSize(m*N,y*N,N)},g.prototype.setRealSize=function(m,y,N){return this.resolution=N||this.resolution,this.width=Math.round(m)/this.resolution,this.height=Math.round(y)/this.resolution,this._refreshPOT(),this.update(),this},g.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(I.isPow2)(this.realWidth)&&Object(I.isPow2)(this.realHeight)},g.prototype.setResolution=function(m){var y=this.resolution;return y===m||(this.resolution=m,this.valid&&(this.width=Math.round(this.width*y)/m,this.height=Math.round(this.height*y)/m,this.emit("update",this)),this._refreshPOT()),this},g.prototype.setResource=function(m){if(this.resource===m)return this;if(this.resource)throw new Error("Resource can be set only once");return m.bind(this),this.resource=m,this},g.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},g.prototype.onError=function(m){this.emit("error",this,m)},g.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete I.BaseTextureCache[this.cacheId],delete I.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),g.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},g.prototype.dispose=function(){this.emit("dispose",this)},g.prototype.castToBaseTexture=function(){return this},g.from=function(m,y,N){N===void 0&&(N=O.b.STRICT_TEXTURE_CACHE);var q=typeof m=="string",ht=null;if(q)ht=m;else{if(!m._pixiId){var xt=y&&y.pixiIdPrefix||"pixiid";m._pixiId=xt+"_"+Object(I.uid)()}ht=m._pixiId}var Tt=I.BaseTextureCache[ht];if(q&&N&&!Tt)throw new Error('The cacheId "'+ht+'" does not exist in BaseTextureCache.');return Tt||((Tt=new g(m,y)).cacheId=ht,g.addToCache(Tt,ht)),Tt},g.fromBuffer=function(m,y,N,q){m=m||new Float32Array(y*N*4);var ht=new L(m,{width:y,height:N}),xt=m instanceof Float32Array?S.r.FLOAT:S.r.UNSIGNED_BYTE;return new g(ht,Object.assign(R,q||{width:y,height:N,type:xt}))},g.addToCache=function(m,y){y&&(m.textureCacheIds.indexOf(y)===-1&&m.textureCacheIds.push(y),I.BaseTextureCache[y]&&console.warn("BaseTexture added to the cache with an id ["+y+"] that already had an entry"),I.BaseTextureCache[y]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var y=I.BaseTextureCache[m];if(y){var N=y.textureCacheIds.indexOf(m);return N>-1&&y.textureCacheIds.splice(N,1),delete I.BaseTextureCache[m],y}}else if(m&&m.textureCacheIds){for(var q=0;q<m.textureCacheIds.length;++q)delete I.BaseTextureCache[m.textureCacheIds[q]];return m.textureCacheIds.length=0,m}return null},g._globalBatch=0,g}(I.EventEmitter),W=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,xt=q.height;(N=Y.call(this,ht,xt)||this).items=[],N.itemDirtyIds=[];for(var Tt=0;Tt<m;Tt++){var Kt=new U;N.items.push(Kt),N.itemDirtyIds.push(-2)}return N.length=m,N._load=null,N.baseTexture=null,N}return ut(g,Y),g.prototype.initFromArray=function(m,y){for(var N=0;N<this.length;N++)m[N]&&(m[N].castToBaseTexture?this.addBaseTextureAt(m[N].castToBaseTexture(),N):m[N]instanceof St?this.addResourceAt(m[N],N):this.addResourceAt(X(m[N],y),N))},g.prototype.dispose=function(){for(var m=0,y=this.length;m<y;m++)this.items[m].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},g.prototype.addResourceAt=function(m,y){if(!this.items[y])throw new Error("Index "+y+" is out of bounds");return m.valid&&!this.valid&&this.resize(m.width,m.height),this.items[y].setResource(m),this},g.prototype.bind=function(m){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");Y.prototype.bind.call(this,m);for(var y=0;y<this.length;y++)this.items[y].parentTextureArray=m,this.items[y].on("update",m.update,m)},g.prototype.unbind=function(m){Y.prototype.unbind.call(this,m);for(var y=0;y<this.length;y++)this.items[y].parentTextureArray=null,this.items[y].off("update",m.update,m)},g.prototype.load=function(){var m=this;if(this._load)return this._load;var y=this.items.map(function(N){return N.resource}).filter(function(N){return N}).map(function(N){return N.load()});return this._load=Promise.all(y).then(function(){var N=m.items[0],q=N.realWidth,ht=N.realHeight;return m.resize(q,ht),Promise.resolve(m)}),this._load},g}(St),P=function(Y){function g(m,y){var N,q,ht=this,xt=y||{},Tt=xt.width,Kt=xt.height;return Array.isArray(m)?(N=m,q=m.length):q=m,ht=Y.call(this,q,{width:Tt,height:Kt})||this,N&&ht.initFromArray(N,y),ht}return ut(g,Y),g.prototype.addBaseTextureAt=function(m,y){if(!m.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(m.resource,y),this},g.prototype.bind=function(m){Y.prototype.bind.call(this,m),m.target=S.q.TEXTURE_2D_ARRAY},g.prototype.upload=function(m,y,N){var q=this.length,ht=this.itemDirtyIds,xt=this.items,Tt=m.gl;N.dirtyId<0&&Tt.texImage3D(Tt.TEXTURE_2D_ARRAY,0,N.internalFormat,this._width,this._height,q,0,y.format,N.type,null);for(var Kt=0;Kt<q;Kt++){var ee=xt[Kt];ht[Kt]<ee.dirtyId&&(ht[Kt]=ee.dirtyId,ee.valid&&Tt.texSubImage3D(Tt.TEXTURE_2D_ARRAY,0,0,0,Kt,ee.resource.width,ee.resource.height,1,y.format,N.type,ee.resource.source))}return!0},g}(W),j=function(Y){function g(m){var y=this,N=m,q=N.naturalWidth||N.videoWidth||N.width,ht=N.naturalHeight||N.videoHeight||N.height;return(y=Y.call(this,q,ht)||this).source=m,y.noSubImage=!1,y}return ut(g,Y),g.crossOrigin=function(m,y,N){N===void 0&&y.indexOf("data:")!==0?m.crossOrigin=Object(I.determineCrossOrigin)(y):N!==!1&&(m.crossOrigin=typeof N=="string"?N:"anonymous")},g.prototype.upload=function(m,y,N,q){var ht=m.gl,xt=y.realWidth,Tt=y.realHeight;if((q=q||this.source)instanceof HTMLImageElement){if(!q.complete||q.naturalWidth===0)return!1}else if(q instanceof HTMLVideoElement&&q.readyState<=1)return!1;return ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===S.a.UNPACK),this.noSubImage||y.target!==ht.TEXTURE_2D||N.width!==xt||N.height!==Tt?(N.width=xt,N.height=Tt,ht.texImage2D(y.target,0,N.internalFormat,y.format,N.type,q)):ht.texSubImage2D(ht.TEXTURE_2D,0,0,0,y.format,N.type,q),!0},g.prototype.update=function(){if(!this.destroyed){var m=this.source,y=m.naturalWidth||m.videoWidth||m.width,N=m.naturalHeight||m.videoHeight||m.height;this.resize(y,N),Y.prototype.update.call(this)}},g.prototype.dispose=function(){this.source=null},g}(St),$=function(Y){function g(m){return Y.call(this,m)||this}return ut(g,Y),g.test=function(m){var y=globalThis.OffscreenCanvas;return!!(y&&m instanceof y)||globalThis.HTMLCanvasElement&&m instanceof HTMLCanvasElement},g}(j),H=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,xt=q.height,Tt=q.autoLoad,Kt=q.linkBaseTexture;if(m&&m.length!==g.SIDES)throw new Error("Invalid length. Got "+m.length+", expected 6");N=Y.call(this,6,{width:ht,height:xt})||this;for(var ee=0;ee<g.SIDES;ee++)N.items[ee].target=S.q.TEXTURE_CUBE_MAP_POSITIVE_X+ee;return N.linkBaseTexture=Kt!==!1,m&&N.initFromArray(m,y),Tt!==!1&&N.load(),N}return ut(g,Y),g.prototype.bind=function(m){Y.prototype.bind.call(this,m),m.target=S.q.TEXTURE_CUBE_MAP},g.prototype.addBaseTextureAt=function(m,y,N){if(!this.items[y])throw new Error("Index "+y+" is out of bounds");if(!this.linkBaseTexture||m.parentTextureArray||Object.keys(m._glTextures).length>0){if(!m.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(m.resource,y)}else m.target=S.q.TEXTURE_CUBE_MAP_POSITIVE_X+y,m.parentTextureArray=this.baseTexture,this.items[y]=m;return m.valid&&!this.valid&&this.resize(m.realWidth,m.realHeight),this.items[y]=m,this},g.prototype.upload=function(m,y,N){for(var q=this.itemDirtyIds,ht=0;ht<g.SIDES;ht++){var xt=this.items[ht];q[ht]<xt.dirtyId&&(xt.valid&&xt.resource?(xt.resource.upload(m,xt,N),q[ht]=xt.dirtyId):q[ht]<-1&&(m.gl.texImage2D(xt.target,0,N.internalFormat,y.realWidth,y.realHeight,0,y.format,N.type,null),q[ht]=-1))}return!0},g.test=function(m){return Array.isArray(m)&&m.length===g.SIDES},g.SIDES=6,g}(W),Nt=function(Y){function g(m,y){var N=this;if(y=y||{},!(m instanceof HTMLImageElement)){var q=new Image;j.crossOrigin(q,m,y.crossorigin),q.src=m,m=q}return N=Y.call(this,m)||this,!m.complete&&N._width&&N._height&&(N._width=0,N._height=0),N.url=m.src,N._process=null,N.preserveBitmap=!1,N.createBitmap=(y.createBitmap!==void 0?y.createBitmap:O.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,N.alphaMode=typeof y.alphaMode=="number"?y.alphaMode:null,N.bitmap=null,N._load=null,y.autoLoad!==!1&&N.load(),N}return ut(g,Y),g.prototype.load=function(m){var y=this;return this._load||(m!==void 0&&(this.createBitmap=m),this._load=new Promise(function(N,q){var ht=y.source;y.url=ht.src;var xt=function(){y.destroyed||(ht.onload=null,ht.onerror=null,y.resize(ht.width,ht.height),y._load=null,y.createBitmap?N(y.process()):N(y))};ht.complete&&ht.src?xt():(ht.onload=xt,ht.onerror=function(Tt){q(Tt),y.onError.emit(Tt)})})),this._load},g.prototype.process=function(){var m=this,y=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var N=globalThis.createImageBitmap,q=!y.crossOrigin||y.crossOrigin==="anonymous";return this._process=fetch(y.src,{mode:q?"cors":"no-cors"}).then(function(ht){return ht.blob()}).then(function(ht){return N(ht,0,0,y.width,y.height,{premultiplyAlpha:m.alphaMode===S.a.UNPACK?"premultiply":"none"})}).then(function(ht){return m.destroyed?Promise.reject():(m.bitmap=ht,m.update(),m._process=null,Promise.resolve(m))}),this._process},g.prototype.upload=function(m,y,N){if(typeof this.alphaMode=="number"&&(y.alphaMode=this.alphaMode),!this.createBitmap)return Y.prototype.upload.call(this,m,y,N);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(Y.prototype.upload.call(this,m,y,N,this.bitmap),!this.preserveBitmap){var q=!0,ht=y._glTextures;for(var xt in ht){var Tt=ht[xt];if(Tt!==N&&Tt.dirtyId!==y.dirtyId){q=!1;break}}q&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},g.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,Y.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},g.test=function(m){return typeof m=="string"||m instanceof HTMLImageElement},g}(j),Vt=function(Y){function g(m,y){var N=this;return y=y||{},(N=Y.call(this,document.createElement("canvas"))||this)._width=0,N._height=0,N.svg=m,N.scale=y.scale||1,N._overrideWidth=y.width,N._overrideHeight=y.height,N._resolve=null,N._crossorigin=y.crossorigin,N._load=null,y.autoLoad!==!1&&N.load(),N}return ut(g,Y),g.prototype.load=function(){var m=this;return this._load||(this._load=new Promise(function(y){if(m._resolve=function(){m.resize(m.source.width,m.source.height),y(m)},g.SVG_XML.test(m.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");m.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(m.svg)))}m._loadSvg()})),this._load},g.prototype._loadSvg=function(){var m=this,y=new Image;j.crossOrigin(y,this.svg,this._crossorigin),y.src=this.svg,y.onerror=function(N){m._resolve&&(y.onerror=null,m.onError.emit(N))},y.onload=function(){if(m._resolve){var N=y.width,q=y.height;if(!N||!q)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var ht=N*m.scale,xt=q*m.scale;(m._overrideWidth||m._overrideHeight)&&(ht=m._overrideWidth||m._overrideHeight/q*N,xt=m._overrideHeight||m._overrideWidth/N*q),ht=Math.round(ht),xt=Math.round(xt);var Tt=m.source;Tt.width=ht,Tt.height=xt,Tt._pixiId="canvas_"+Object(I.uid)(),Tt.getContext("2d").drawImage(y,0,0,N,q,0,0,ht,xt),m._resolve(),m._resolve=null}}},g.getSize=function(m){var y=g.SVG_SIZE.exec(m),N={};return y&&(N[y[1]]=Math.round(parseFloat(y[3])),N[y[5]]=Math.round(parseFloat(y[7]))),N},g.prototype.dispose=function(){Y.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},g.test=function(m,y){return y==="svg"||typeof m=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(m)||typeof m=="string"&&g.SVG_XML.test(m)},g.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,g.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,g}(j),st=function(Y){function g(m,y){var N=this;if(y=y||{},!(m instanceof HTMLVideoElement)){var q=document.createElement("video");q.setAttribute("preload","auto"),q.setAttribute("webkit-playsinline",""),q.setAttribute("playsinline",""),typeof m=="string"&&(m=[m]);var ht=m[0].src||m[0];j.crossOrigin(q,ht,y.crossorigin);for(var xt=0;xt<m.length;++xt){var Tt=document.createElement("source"),Kt=m[xt],ee=Kt.src,Fe=Kt.mime,Te=(ee=ee||m[xt]).split("?").shift().toLowerCase(),Qe=Te.slice(Te.lastIndexOf(".")+1);Fe=Fe||g.MIME_TYPES[Qe]||"video/"+Qe,Tt.src=ee,Tt.type=Fe,q.appendChild(Tt)}m=q}return(N=Y.call(this,m)||this).noSubImage=!0,N._autoUpdate=!0,N._isConnectedToTicker=!1,N._updateFPS=y.updateFPS||0,N._msToNextUpdate=0,N.autoPlay=y.autoPlay!==!1,N._load=null,N._resolve=null,N._onCanPlay=N._onCanPlay.bind(N),N._onError=N._onError.bind(N),y.autoLoad!==!1&&N.load(),N}return ut(g,Y),g.prototype.update=function(m){if(!this.destroyed){var y=F.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-y),(!this._updateFPS||this._msToNextUpdate<=0)&&(Y.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},g.prototype.load=function(){var m=this;if(this._load)return this._load;var y=this.source;return(y.readyState===y.HAVE_ENOUGH_DATA||y.readyState===y.HAVE_FUTURE_DATA)&&y.width&&y.height&&(y.complete=!0),y.addEventListener("play",this._onPlayStart.bind(this)),y.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(y.addEventListener("canplay",this._onCanPlay),y.addEventListener("canplaythrough",this._onCanPlay),y.addEventListener("error",this._onError,!0)),this._load=new Promise(function(N){m.valid?N(m):(m._resolve=N,y.load())}),this._load},g.prototype._onError=function(m){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(m)},g.prototype._isSourcePlaying=function(){var m=this.source;return m.currentTime>0&&m.paused===!1&&m.ended===!1&&m.readyState>2},g.prototype._isSourceReady=function(){var m=this.source;return m.readyState===3||m.readyState===4},g.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(F.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},g.prototype._onPlayStop=function(){this._isConnectedToTicker&&(F.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},g.prototype._onCanPlay=function(){var m=this.source;m.removeEventListener("canplay",this._onCanPlay),m.removeEventListener("canplaythrough",this._onCanPlay);var y=this.valid;this.resize(m.videoWidth,m.videoHeight),!y&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&m.play()},g.prototype.dispose=function(){this._isConnectedToTicker&&(F.a.shared.remove(this.update,this),this._isConnectedToTicker=!1);var m=this.source;m&&(m.removeEventListener("error",this._onError,!0),m.pause(),m.src="",m.load()),Y.prototype.dispose.call(this)},Object.defineProperty(g.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(m){m!==this._autoUpdate&&(this._autoUpdate=m,!this._autoUpdate&&this._isConnectedToTicker?(F.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(F.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(m){m!==this._updateFPS&&(this._updateFPS=m)},enumerable:!1,configurable:!0}),g.test=function(m,y){return globalThis.HTMLVideoElement&&m instanceof HTMLVideoElement||g.TYPES.indexOf(y)>-1},g.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],g.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},g}(j),V=function(Y){function g(m){return Y.call(this,m)||this}return ut(g,Y),g.test=function(m){return!!globalThis.createImageBitmap&&m instanceof ImageBitmap},g}(j);J.push(Nt,V,$,st,Vt,L,H,P);var B=function(Y){function g(){return Y!==null&&Y.apply(this,arguments)||this}return ut(g,Y),g.prototype.upload=function(m,y,N){var q=m.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===S.a.UNPACK);var ht=y.realWidth,xt=y.realHeight;return N.width===ht&&N.height===xt?q.texSubImage2D(y.target,0,0,0,ht,xt,y.format,N.type,this.data):(N.width=ht,N.height=xt,q.texImage2D(y.target,0,N.internalFormat,ht,xt,0,y.format,N.type,this.data)),!0},g}(L),ft=function(){function Y(g,m){this.width=Math.round(g||100),this.height=Math.round(m||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new D.a("disposeFramebuffer"),this.multisample=S.l.NONE}return Object.defineProperty(Y.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),Y.prototype.addColorTexture=function(g,m){return g===void 0&&(g=0),this.colorTextures[g]=m||new U(null,{scaleMode:S.p.NEAREST,resolution:1,mipmap:S.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Y.prototype.addDepthTexture=function(g){return this.depthTexture=g||new U(new B(null,{width:this.width,height:this.height}),{scaleMode:S.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:S.k.OFF,format:S.h.DEPTH_COMPONENT,type:S.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Y.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Y.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Y.prototype.resize=function(g,m){if(g=Math.round(g),m=Math.round(m),g!==this.width||m!==this.height){this.width=g,this.height=m,this.dirtyId++,this.dirtySize++;for(var y=0;y<this.colorTextures.length;y++){var N=this.colorTextures[y],q=N.resolution;N.setSize(g/q,m/q)}this.depthTexture&&(q=this.depthTexture.resolution,this.depthTexture.setSize(g/q,m/q))}},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},Y}(),tt=function(Y){function g(m){m===void 0&&(m={});var y=this;if(typeof m=="number"){var N=arguments[0],q=arguments[1],ht=arguments[2],xt=arguments[3];m={width:N,height:q,scaleMode:ht,resolution:xt}}return m.width=m.width||100,m.height=m.height||100,m.multisample=m.multisample!==void 0?m.multisample:S.l.NONE,(y=Y.call(this,null,m)||this).mipmap=S.k.OFF,y.valid=!0,y.clearColor=[0,0,0,0],y.framebuffer=new ft(y.realWidth,y.realHeight).addColorTexture(0,y),y.framebuffer.multisample=m.multisample,y.maskStack=[],y.filterStack=[{}],y}return ut(g,Y),g.prototype.resize=function(m,y){this.framebuffer.resize(m*this.resolution,y*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},g.prototype.dispose=function(){this.framebuffer.dispose(),Y.prototype.dispose.call(this)},g.prototype.destroy=function(){Y.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},g}(U),vt=function(){function Y(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return Y.prototype.set=function(g,m,y){var N=m.width,q=m.height;if(y){var ht=g.width/2/N,xt=g.height/2/q,Tt=g.x/N+ht,Kt=g.y/q+xt;y=z.n.add(y,z.n.NW),this.x0=Tt+ht*z.n.uX(y),this.y0=Kt+xt*z.n.uY(y),y=z.n.add(y,2),this.x1=Tt+ht*z.n.uX(y),this.y1=Kt+xt*z.n.uY(y),y=z.n.add(y,2),this.x2=Tt+ht*z.n.uX(y),this.y2=Kt+xt*z.n.uY(y),y=z.n.add(y,2),this.x3=Tt+ht*z.n.uX(y),this.y3=Kt+xt*z.n.uY(y)}else this.x0=g.x/N,this.y0=g.y/q,this.x1=(g.x+g.width)/N,this.y1=g.y/q,this.x2=(g.x+g.width)/N,this.y2=(g.y+g.height)/q,this.x3=g.x/N,this.y3=(g.y+g.height)/q;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},Y.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},Y}(),Dt=new vt;function Z(Y){Y.destroy=function(){},Y.on=function(){},Y.once=function(){},Y.emit=function(){}}var pt=function(Y){function g(m,y,N,q,ht,xt){var Tt=Y.call(this)||this;if(Tt.noFrame=!1,y||(Tt.noFrame=!0,y=new z.j(0,0,1,1)),m instanceof g&&(m=m.baseTexture),Tt.baseTexture=m,Tt._frame=y,Tt.trim=q,Tt.valid=!1,Tt._uvs=Dt,Tt.uvMatrix=null,Tt.orig=N||y,Tt._rotate=Number(ht||0),ht===!0)Tt._rotate=2;else if(Tt._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return Tt.defaultAnchor=xt?new z.g(xt.x,xt.y):new z.g(0,0),Tt._updateID=0,Tt.textureCacheIds=[],m.valid?Tt.noFrame?m.valid&&Tt.onBaseTextureUpdated(m):Tt.frame=y:m.once("loaded",Tt.onBaseTextureUpdated,Tt),Tt.noFrame&&m.on("update",Tt.onBaseTextureUpdated,Tt),Tt}return ut(g,Y),g.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},g.prototype.onBaseTextureUpdated=function(m){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=m.width,this._frame.height=m.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},g.prototype.destroy=function(m){if(this.baseTexture){if(m){var y=this.baseTexture.resource;y&&y.url&&I.TextureCache[y.url]&&g.removeFromCache(y.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,g.removeFromCache(this),this.textureCacheIds=null},g.prototype.clone=function(){var m=this._frame.clone(),y=this._frame===this.orig?m:this.orig.clone(),N=new g(this.baseTexture,!this.noFrame&&m,y,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(N._frame=m),N},g.prototype.updateUvs=function(){this._uvs===Dt&&(this._uvs=new vt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},g.from=function(m,y,N){y===void 0&&(y={}),N===void 0&&(N=O.b.STRICT_TEXTURE_CACHE);var q=typeof m=="string",ht=null;if(q)ht=m;else if(m instanceof U){if(!m.cacheId){var xt=y&&y.pixiIdPrefix||"pixiid";m.cacheId=xt+"-"+Object(I.uid)(),U.addToCache(m,m.cacheId)}ht=m.cacheId}else m._pixiId||(xt=y&&y.pixiIdPrefix||"pixiid",m._pixiId=xt+"_"+Object(I.uid)()),ht=m._pixiId;var Tt=I.TextureCache[ht];if(q&&N&&!Tt)throw new Error('The cacheId "'+ht+'" does not exist in TextureCache.');return Tt||m instanceof U?!Tt&&m instanceof U&&(Tt=new g(m),g.addToCache(Tt,ht)):(y.resolution||(y.resolution=Object(I.getResolutionOfUrl)(m)),(Tt=new g(new U(m,y))).baseTexture.cacheId=ht,U.addToCache(Tt.baseTexture,ht),g.addToCache(Tt,ht)),Tt},g.fromURL=function(m,y){var N=Object.assign({autoLoad:!1},y==null?void 0:y.resourceOptions),q=g.from(m,Object.assign({resourceOptions:N},y),!1),ht=q.baseTexture.resource;return q.baseTexture.valid?Promise.resolve(q):ht.load().then(function(){return Promise.resolve(q)})},g.fromBuffer=function(m,y,N,q){return new g(U.fromBuffer(m,y,N,q))},g.fromLoader=function(m,y,N,q){var ht=new U(m,Object.assign({scaleMode:O.b.SCALE_MODE,resolution:Object(I.getResolutionOfUrl)(y)},q)),xt=ht.resource;xt instanceof Nt&&(xt.url=y);var Tt=new g(ht);return N||(N=y),U.addToCache(Tt.baseTexture,N),g.addToCache(Tt,N),N!==y&&(U.addToCache(Tt.baseTexture,y),g.addToCache(Tt,y)),Tt.baseTexture.valid?Promise.resolve(Tt):new Promise(function(Kt){Tt.baseTexture.once("loaded",function(){return Kt(Tt)})})},g.addToCache=function(m,y){y&&(m.textureCacheIds.indexOf(y)===-1&&m.textureCacheIds.push(y),I.TextureCache[y]&&console.warn("Texture added to the cache with an id ["+y+"] that already had an entry"),I.TextureCache[y]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var y=I.TextureCache[m];if(y){var N=y.textureCacheIds.indexOf(m);return N>-1&&y.textureCacheIds.splice(N,1),delete I.TextureCache[m],y}}else if(m&&m.textureCacheIds){for(var q=0;q<m.textureCacheIds.length;++q)I.TextureCache[m.textureCacheIds[q]]===m&&delete I.TextureCache[m.textureCacheIds[q]];return m.textureCacheIds.length=0,m}return null},Object.defineProperty(g.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"frame",{get:function(){return this._frame},set:function(m){this._frame=m,this.noFrame=!1;var y=m.x,N=m.y,q=m.width,ht=m.height,xt=y+q>this.baseTexture.width,Tt=N+ht>this.baseTexture.height;if(xt||Tt){var Kt=xt&&Tt?"and":"or",ee="X: "+y+" + "+q+" = "+(y+q)+" > "+this.baseTexture.width,Fe="Y: "+N+" + "+ht+" = "+(N+ht)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+ee+" "+Kt+" "+Fe)}this.valid=q&&ht&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=m),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"rotate",{get:function(){return this._rotate},set:function(m){this._rotate=m,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),g.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(g,"EMPTY",{get:function(){return g._EMPTY||(g._EMPTY=new g(new U),Z(g._EMPTY),Z(g._EMPTY.baseTexture)),g._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(g,"WHITE",{get:function(){if(!g._WHITE){var m=document.createElement("canvas"),y=m.getContext("2d");m.width=16,m.height=16,y.fillStyle="white",y.fillRect(0,0,16,16),g._WHITE=new g(new U(new $(m))),Z(g._WHITE),Z(g._WHITE.baseTexture)}return g._WHITE},enumerable:!1,configurable:!0}),g}(I.EventEmitter),rt=function(Y){function g(m,y){var N=Y.call(this,m,y)||this;return N.valid=!0,N.filterFrame=null,N.filterPoolKey=null,N.updateUvs(),N}return ut(g,Y),Object.defineProperty(g.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(m){this.framebuffer.multisample=m},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,y,N){N===void 0&&(N=!0);var q=this.baseTexture.resolution,ht=Math.round(m*q)/q,xt=Math.round(y*q)/q;this.valid=ht>0&&xt>0,this._frame.width=this.orig.width=ht,this._frame.height=this.orig.height=xt,N&&this.baseTexture.resize(ht,xt),this.updateUvs()},g.prototype.setResolution=function(m){var y=this.baseTexture;y.resolution!==m&&(y.setResolution(m),this.resize(y.width,y.height,!1))},g.create=function(m){for(var y=arguments,N=[],q=1;q<arguments.length;q++)N[q-1]=y[q];return typeof m=="number"&&(Object(I.deprecation)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),m={width:m,height:N[0],scaleMode:N[1],resolution:N[2]}),new g(new tt(m))},g}(pt),_t=function(){function Y(g){this.texturePool={},this.textureOptions=g||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return Y.prototype.createTexture=function(g,m,y){y===void 0&&(y=S.l.NONE);var N=new tt(Object.assign({width:g,height:m,resolution:1,multisample:y},this.textureOptions));return new rt(N)},Y.prototype.getOptimalTexture=function(g,m,y,N){var q;y===void 0&&(y=1),N===void 0&&(N=S.l.NONE),g=Math.ceil(g*y-1e-6),m=Math.ceil(m*y-1e-6),this.enableFullScreen&&g===this._pixelsWidth&&m===this._pixelsHeight?q=N>1?-N:-1:(q=((65535&(g=Object(I.nextPow2)(g)))<<16|65535&(m=Object(I.nextPow2)(m)))>>>0,N>1&&(q+=4294967296*N)),this.texturePool[q]||(this.texturePool[q]=[]);var ht=this.texturePool[q].pop();return ht||(ht=this.createTexture(g,m,N)),ht.filterPoolKey=q,ht.setResolution(y),ht},Y.prototype.getFilterTexture=function(g,m,y){var N=this.getOptimalTexture(g.width,g.height,m||g.resolution,y||S.l.NONE);return N.filterFrame=g.filterFrame,N},Y.prototype.returnTexture=function(g){var m=g.filterPoolKey;g.filterFrame=null,this.texturePool[m].push(g)},Y.prototype.returnFilterTexture=function(g){this.returnTexture(g)},Y.prototype.clear=function(g){if(g=g!==!1)for(var m in this.texturePool){var y=this.texturePool[m];if(y)for(var N=0;N<y.length;N++)y[N].destroy(!0)}this.texturePool={}},Y.prototype.setScreenSize=function(g){if(g.width!==this._pixelsWidth||g.height!==this._pixelsHeight){for(var m in this.enableFullScreen=g.width>0&&g.height>0,this.texturePool)if(Number(m)<0){var y=this.texturePool[m];if(y)for(var N=0;N<y.length;N++)y[N].destroy(!0);this.texturePool[m]=[]}this._pixelsWidth=g.width,this._pixelsHeight=g.height}},Y.SCREEN_KEY=-1,Y}(),Et=function(){function Y(g,m,y,N,q,ht,xt){m===void 0&&(m=0),y===void 0&&(y=!1),N===void 0&&(N=S.r.FLOAT),this.buffer=g,this.size=m,this.normalized=y,this.type=N,this.stride=q,this.start=ht,this.instance=xt}return Y.prototype.destroy=function(){this.buffer=null},Y.from=function(g,m,y,N,q){return new Y(g,m,y,N,q)},Y}(),Gt=0,Xt=function(){function Y(g,m,y){m===void 0&&(m=!0),y===void 0&&(y=!1),this.data=g||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=y,this.static=m,this.id=Gt++,this.disposeRunner=new D.a("disposeBuffer")}return Y.prototype.update=function(g){g instanceof Array&&(g=new Float32Array(g)),this.data=g||this.data,this._updateID++},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(Y.prototype,"index",{get:function(){return this.type===S.d.ELEMENT_ARRAY_BUFFER},set:function(g){this.type=g?S.d.ELEMENT_ARRAY_BUFFER:S.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),Y.from=function(g){return g instanceof Array&&(g=new Float32Array(g)),new Y(g)},Y}(),Jt={Float32Array,Uint32Array,Int32Array,Uint8Array},at={5126:4,5123:2,5121:1},_e=0,ke={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Oe=function(){function Y(g,m){g===void 0&&(g=[]),m===void 0&&(m={}),this.buffers=g,this.indexBuffer=null,this.attributes=m,this.glVertexArrayObjects={},this.id=_e++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new D.a("disposeGeometry"),this.refCount=0}return Y.prototype.addAttribute=function(g,m,y,N,q,ht,xt,Tt){if(y===void 0&&(y=0),N===void 0&&(N=!1),Tt===void 0&&(Tt=!1),!m)throw new Error("You must pass a buffer when creating an attribute");m instanceof Xt||(m instanceof Array&&(m=new Float32Array(m)),m=new Xt(m));var Kt=g.split("|");if(Kt.length>1){for(var ee=0;ee<Kt.length;ee++)this.addAttribute(Kt[ee],m,y,N,q);return this}var Fe=this.buffers.indexOf(m);return Fe===-1&&(this.buffers.push(m),Fe=this.buffers.length-1),this.attributes[g]=new Et(Fe,y,N,q,ht,xt,Tt),this.instanced=this.instanced||Tt,this},Y.prototype.getAttribute=function(g){return this.attributes[g]},Y.prototype.getBuffer=function(g){return this.buffers[this.getAttribute(g).buffer]},Y.prototype.addIndex=function(g){return g instanceof Xt||(g instanceof Array&&(g=new Uint16Array(g)),g=new Xt(g)),g.type=S.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=g,this.buffers.indexOf(g)===-1&&this.buffers.push(g),this},Y.prototype.getIndex=function(){return this.indexBuffer},Y.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var g,m=[],y=[],N=new Xt;for(g in this.attributes){var q=this.attributes[g],ht=this.buffers[q.buffer];m.push(ht.data),y.push(q.size*at[q.type]/4),q.buffer=0}for(N.data=function(xt,Tt){for(var Kt=0,ee=0,Fe={},Te=0;Te<xt.length;Te++)ee+=Tt[Te],Kt+=xt[Te].length;var Qe=new ArrayBuffer(4*Kt),hn=null,vn=0;for(Te=0;Te<xt.length;Te++){var un=Tt[Te],Kn=xt[Te],mi=Object(I.getBufferType)(Kn);Fe[mi]||(Fe[mi]=new Jt[mi](Qe)),hn=Fe[mi];for(var gi=0;gi<Kn.length;gi++)hn[(gi/un|0)*ee+vn+gi%un]=Kn[gi];vn+=un}return new Float32Array(Qe)}(m,y),g=0;g<this.buffers.length;g++)this.buffers[g]!==this.indexBuffer&&this.buffers[g].destroy();return this.buffers=[N],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Y.prototype.getSize=function(){for(var g in this.attributes){var m=this.attributes[g];return this.buffers[m.buffer].data.length/(m.stride/4||m.size)}return 0},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Y.prototype.clone=function(){for(var g=new Y,m=0;m<this.buffers.length;m++)g.buffers[m]=new Xt(this.buffers[m].data.slice(0));for(var m in this.attributes){var y=this.attributes[m];g.attributes[m]=new Et(y.buffer,y.size,y.normalized,y.type,y.stride,y.start,y.instance)}return this.indexBuffer&&(g.indexBuffer=g.buffers[this.buffers.indexOf(this.indexBuffer)],g.indexBuffer.type=S.d.ELEMENT_ARRAY_BUFFER),g},Y.merge=function(g){for(var m,y=new Y,N=[],q=[],ht=[],xt=0;xt<g.length;xt++){m=g[xt];for(var Tt=0;Tt<m.buffers.length;Tt++)q[Tt]=q[Tt]||0,q[Tt]+=m.buffers[Tt].data.length,ht[Tt]=0}for(xt=0;xt<m.buffers.length;xt++)N[xt]=new ke[Object(I.getBufferType)(m.buffers[xt].data)](q[xt]),y.buffers[xt]=new Xt(N[xt]);for(xt=0;xt<g.length;xt++)for(m=g[xt],Tt=0;Tt<m.buffers.length;Tt++)N[Tt].set(m.buffers[Tt].data,ht[Tt]),ht[Tt]+=m.buffers[Tt].data.length;if(y.attributes=m.attributes,m.indexBuffer){y.indexBuffer=y.buffers[m.buffers.indexOf(m.indexBuffer)],y.indexBuffer.type=S.d.ELEMENT_ARRAY_BUFFER;var Kt=0,ee=0,Fe=0,Te=0;for(xt=0;xt<m.buffers.length;xt++)if(m.buffers[xt]!==m.indexBuffer){Te=xt;break}for(var xt in m.attributes){var Qe=m.attributes[xt];(0|Qe.buffer)===Te&&(ee+=Qe.size*at[Qe.type]/4)}for(xt=0;xt<g.length;xt++){var hn=g[xt].indexBuffer.data;for(Tt=0;Tt<hn.length;Tt++)y.indexBuffer.data[Tt+Fe]+=Kt;Kt+=g[xt].buffers[Te].data.length/ee,Fe+=hn.length}}return y},Y}(),Ae=function(Y){function g(){var m=Y.call(this)||this;return m.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),m}return ut(g,Y),g}(Oe),ze=function(Y){function g(){var m=Y.call(this)||this;return m.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),m.uvs=new Float32Array([0,0,1,0,1,1,0,1]),m.vertexBuffer=new Xt(m.vertices),m.uvBuffer=new Xt(m.uvs),m.addAttribute("aVertexPosition",m.vertexBuffer).addAttribute("aTextureCoord",m.uvBuffer).addIndex([0,1,2,0,2,3]),m}return ut(g,Y),g.prototype.map=function(m,y){var N=0,q=0;return this.uvs[0]=N,this.uvs[1]=q,this.uvs[2]=N+y.width/m.width,this.uvs[3]=q,this.uvs[4]=N+y.width/m.width,this.uvs[5]=q+y.height/m.height,this.uvs[6]=N,this.uvs[7]=q+y.height/m.height,N=y.x,q=y.y,this.vertices[0]=N,this.vertices[1]=q,this.vertices[2]=N+y.width,this.vertices[3]=q,this.vertices[4]=N+y.width,this.vertices[5]=q+y.height,this.vertices[6]=N,this.vertices[7]=q+y.height,this.invalidate(),this},g.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},g}(Oe),$e=0,cn=function(){function Y(g,m,y){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=$e++,this.static=!!m,this.ubo=!!y,g instanceof Xt?(this.buffer=g,this.buffer.type=S.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=g,this.ubo&&(this.buffer=new Xt(new Float32Array(1)),this.buffer.type=S.d.UNIFORM_BUFFER,this.autoManage=!0))}return Y.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},Y.prototype.add=function(g,m,y){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[g]=new Y(m,y)},Y.from=function(g,m,y){return new Y(g,m,y)},Y.uboFrom=function(g,m){return new Y(g,m==null||m,!0)},Y}(),Ue=function(){function Y(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=S.l.NONE,this.sourceFrame=new z.j,this.destinationFrame=new z.j,this.bindingSourceFrame=new z.j,this.bindingDestinationFrame=new z.j,this.filters=[],this.transform=null}return Y.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},Y}(),Ge=[new z.g,new z.g,new z.g,new z.g],Rn=new z.d,re=function(){function Y(g){this.renderer=g,this.defaultFilterStack=[{}],this.texturePool=new _t,this.texturePool.setScreenSize(g.view),this.statePool=[],this.quad=new Ae,this.quadUv=new ze,this.tempRect=new z.j,this.activeState={},this.globalUniforms=new cn({outputFrame:new z.j,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return Y.prototype.push=function(g,m){for(var y,N,q=this.renderer,ht=this.defaultFilterStack,xt=this.statePool.pop()||new Ue,Tt=this.renderer.renderTexture,Kt=m[0].resolution,ee=m[0].multisample,Fe=m[0].padding,Te=m[0].autoFit,Qe=(y=m[0].legacy)===null||y===void 0||y,hn=1;hn<m.length;hn++){var vn=m[hn];Kt=Math.min(Kt,vn.resolution),ee=Math.min(ee,vn.multisample),Fe=this.useMaxPadding?Math.max(Fe,vn.padding):Fe+vn.padding,Te=Te&&vn.autoFit,Qe=Qe||(N=vn.legacy)===null||N===void 0||N}ht.length===1&&(this.defaultFilterStack[0].renderTexture=Tt.current),ht.push(xt),xt.resolution=Kt,xt.multisample=ee,xt.legacy=Qe,xt.target=g,xt.sourceFrame.copyFrom(g.filterArea||g.getBounds(!0)),xt.sourceFrame.pad(Fe);var un=this.tempRect.copyFrom(Tt.sourceFrame);q.projection.transform&&this.transformAABB(Rn.copyFrom(q.projection.transform).invert(),un),Te?(xt.sourceFrame.fit(un),(xt.sourceFrame.width<=0||xt.sourceFrame.height<=0)&&(xt.sourceFrame.width=0,xt.sourceFrame.height=0)):xt.sourceFrame.intersects(un)||(xt.sourceFrame.width=0,xt.sourceFrame.height=0),this.roundFrame(xt.sourceFrame,Tt.current?Tt.current.resolution:q.resolution,Tt.sourceFrame,Tt.destinationFrame,q.projection.transform),xt.renderTexture=this.getOptimalFilterTexture(xt.sourceFrame.width,xt.sourceFrame.height,Kt,ee),xt.filters=m,xt.destinationFrame.width=xt.renderTexture.width,xt.destinationFrame.height=xt.renderTexture.height;var Kn=this.tempRect;Kn.x=0,Kn.y=0,Kn.width=xt.sourceFrame.width,Kn.height=xt.sourceFrame.height,xt.renderTexture.filterFrame=xt.sourceFrame,xt.bindingSourceFrame.copyFrom(Tt.sourceFrame),xt.bindingDestinationFrame.copyFrom(Tt.destinationFrame),xt.transform=q.projection.transform,q.projection.transform=null,Tt.bind(xt.renderTexture,xt.sourceFrame,Kn),q.framebuffer.clear(0,0,0,0)},Y.prototype.pop=function(){var g=this.defaultFilterStack,m=g.pop(),y=m.filters;this.activeState=m;var N=this.globalUniforms.uniforms;N.outputFrame=m.sourceFrame,N.resolution=m.resolution;var q=N.inputSize,ht=N.inputPixel,xt=N.inputClamp;if(q[0]=m.destinationFrame.width,q[1]=m.destinationFrame.height,q[2]=1/q[0],q[3]=1/q[1],ht[0]=Math.round(q[0]*m.resolution),ht[1]=Math.round(q[1]*m.resolution),ht[2]=1/ht[0],ht[3]=1/ht[1],xt[0]=.5*ht[2],xt[1]=.5*ht[3],xt[2]=m.sourceFrame.width*q[2]-.5*ht[2],xt[3]=m.sourceFrame.height*q[3]-.5*ht[3],m.legacy){var Tt=N.filterArea;Tt[0]=m.destinationFrame.width,Tt[1]=m.destinationFrame.height,Tt[2]=m.sourceFrame.x,Tt[3]=m.sourceFrame.y,N.filterClamp=N.inputClamp}this.globalUniforms.update();var Kt=g[g.length-1];if(this.renderer.framebuffer.blit(),y.length===1)y[0].apply(this,m.renderTexture,Kt.renderTexture,S.e.BLEND,m),this.returnFilterTexture(m.renderTexture);else{var ee=m.renderTexture,Fe=this.getOptimalFilterTexture(ee.width,ee.height,m.resolution);Fe.filterFrame=ee.filterFrame;var Te=0;for(Te=0;Te<y.length-1;++Te){Te===1&&m.multisample>1&&((Fe=this.getOptimalFilterTexture(ee.width,ee.height,m.resolution)).filterFrame=ee.filterFrame),y[Te].apply(this,ee,Fe,S.e.CLEAR,m);var Qe=ee;ee=Fe,Fe=Qe}y[Te].apply(this,ee,Kt.renderTexture,S.e.BLEND,m),Te>1&&m.multisample>1&&this.returnFilterTexture(m.renderTexture),this.returnFilterTexture(ee),this.returnFilterTexture(Fe)}m.clear(),this.statePool.push(m)},Y.prototype.bindAndClear=function(g,m){m===void 0&&(m=S.e.CLEAR);var y=this.renderer,N=y.renderTexture,q=y.state;if(g===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,g&&g.filterFrame){var ht=this.tempRect;ht.x=0,ht.y=0,ht.width=g.filterFrame.width,ht.height=g.filterFrame.height,N.bind(g,g.filterFrame,ht)}else g!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?N.bind(g):this.renderer.renderTexture.bind(g,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var xt=1&q.stateId||this.forceClear;(m===S.e.CLEAR||m===S.e.BLIT&&xt)&&this.renderer.framebuffer.clear(0,0,0,0)},Y.prototype.applyFilter=function(g,m,y,N){var q=this.renderer;q.state.set(g.state),this.bindAndClear(y,N),g.uniforms.uSampler=m,g.uniforms.filterGlobals=this.globalUniforms,q.shader.bind(g),g.legacy=!!g.program.attributeData.aTextureCoord,g.legacy?(this.quadUv.map(m._frame,m.filterFrame),q.geometry.bind(this.quadUv),q.geometry.draw(S.f.TRIANGLES)):(q.geometry.bind(this.quad),q.geometry.draw(S.f.TRIANGLE_STRIP))},Y.prototype.calculateSpriteMatrix=function(g,m){var y=this.activeState,N=y.sourceFrame,q=y.destinationFrame,ht=m._texture.orig,xt=g.set(q.width,0,0,q.height,N.x,N.y),Tt=m.worldTransform.copyTo(z.d.TEMP_MATRIX);return Tt.invert(),xt.prepend(Tt),xt.scale(1/ht.width,1/ht.height),xt.translate(m.anchor.x,m.anchor.y),xt},Y.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},Y.prototype.getOptimalFilterTexture=function(g,m,y,N){return y===void 0&&(y=1),N===void 0&&(N=S.l.NONE),this.texturePool.getOptimalTexture(g,m,y,N)},Y.prototype.getFilterTexture=function(g,m,y){if(typeof g=="number"){var N=g;g=m,m=N}g=g||this.activeState.renderTexture;var q=this.texturePool.getOptimalTexture(g.width,g.height,m||g.resolution,y||S.l.NONE);return q.filterFrame=g.filterFrame,q},Y.prototype.returnFilterTexture=function(g){this.texturePool.returnTexture(g)},Y.prototype.emptyPool=function(){this.texturePool.clear(!0)},Y.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},Y.prototype.transformAABB=function(g,m){var y=Ge[0],N=Ge[1],q=Ge[2],ht=Ge[3];y.set(m.left,m.top),N.set(m.left,m.bottom),q.set(m.right,m.top),ht.set(m.right,m.bottom),g.apply(y,y),g.apply(N,N),g.apply(q,q),g.apply(ht,ht);var xt=Math.min(y.x,N.x,q.x,ht.x),Tt=Math.min(y.y,N.y,q.y,ht.y),Kt=Math.max(y.x,N.x,q.x,ht.x),ee=Math.max(y.y,N.y,q.y,ht.y);m.x=xt,m.y=Tt,m.width=Kt-xt,m.height=ee-Tt},Y.prototype.roundFrame=function(g,m,y,N,q){if(!(g.width<=0||g.height<=0||y.width<=0||y.height<=0)){if(q){var ht=q.a,xt=q.b,Tt=q.c,Kt=q.d;if((Math.abs(xt)>1e-4||Math.abs(Tt)>1e-4)&&(Math.abs(ht)>1e-4||Math.abs(Kt)>1e-4))return}(q=q?Rn.copyFrom(q):Rn.identity()).translate(-y.x,-y.y).scale(N.width/y.width,N.height/y.height).translate(N.x,N.y),this.transformAABB(q,g),g.ceil(m),this.transformAABB(q.invert(),g)}},Y}(),pe=function(){function Y(g){this.renderer=g}return Y.prototype.flush=function(){},Y.prototype.destroy=function(){this.renderer=null},Y.prototype.start=function(){},Y.prototype.stop=function(){this.flush()},Y.prototype.render=function(g){},Y}(),we=function(){function Y(g){this.renderer=g,this.emptyRenderer=new pe(g),this.currentRenderer=this.emptyRenderer}return Y.prototype.setObjectRenderer=function(g){this.currentRenderer!==g&&(this.currentRenderer.stop(),this.currentRenderer=g,this.currentRenderer.start())},Y.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},Y.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},Y.prototype.copyBoundTextures=function(g,m){for(var y=this.renderer.texture.boundTextures,N=m-1;N>=0;--N)g[N]=y[N]||null,g[N]&&(g[N]._batchLocation=N)},Y.prototype.boundArray=function(g,m,y,N){for(var q=g.elements,ht=g.ids,xt=g.count,Tt=0,Kt=0;Kt<xt;Kt++){var ee=q[Kt],Fe=ee._batchLocation;if(Fe>=0&&Fe<N&&m[Fe]===ee)ht[Kt]=Fe;else for(;Tt<N;){var Te=m[Tt];if(!Te||Te._batchEnabled!==y||Te._batchLocation!==Tt){ht[Kt]=Tt,ee._batchLocation=Tt,m[Tt]=ee;break}Tt++}}},Y.prototype.destroy=function(){this.renderer=null},Y}(),ln=0,In=function(){function Y(g){this.renderer=g,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),g.view.addEventListener("webglcontextlost",this.handleContextLost,!1),g.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(Y.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),Y.prototype.contextChange=function(g){this.gl=g,this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,g.isContextLost()&&g.getExtension("WEBGL_lose_context")&&g.getExtension("WEBGL_lose_context").restoreContext()},Y.prototype.initFromContext=function(g){this.gl=g,this.validateContext(g),this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,this.renderer.runners.contextChange.emit(g)},Y.prototype.initFromOptions=function(g){var m=this.createContext(this.renderer.view,g);this.initFromContext(m)},Y.prototype.createContext=function(g,m){var y;if(O.b.PREFER_ENV>=S.g.WEBGL2&&(y=g.getContext("webgl2",m)),y)this.webGLVersion=2;else if(this.webGLVersion=1,!(y=g.getContext("webgl",m)||g.getContext("experimental-webgl",m)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=y,this.getExtensions(),this.gl},Y.prototype.getExtensions=function(){var g=this.gl,m={anisotropicFiltering:g.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),s3tc:g.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:g.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:g.getExtension("WEBGL_compressed_texture_etc"),etc1:g.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:g.getExtension("WEBGL_compressed_texture_pvrtc")||g.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:g.getExtension("WEBGL_compressed_texture_atc"),astc:g.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,m,{drawBuffers:g.getExtension("WEBGL_draw_buffers"),depthTexture:g.getExtension("WEBGL_depth_texture"),loseContext:g.getExtension("WEBGL_lose_context"),vertexArrayObject:g.getExtension("OES_vertex_array_object")||g.getExtension("MOZ_OES_vertex_array_object")||g.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:g.getExtension("OES_element_index_uint"),floatTexture:g.getExtension("OES_texture_float"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),textureHalfFloat:g.getExtension("OES_texture_half_float"),textureHalfFloatLinear:g.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,m,{colorBufferFloat:g.getExtension("EXT_color_buffer_float")})},Y.prototype.handleContextLost=function(g){g.preventDefault()},Y.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},Y.prototype.destroy=function(){var g=this.renderer.view;this.renderer=null,g.removeEventListener("webglcontextlost",this.handleContextLost),g.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},Y.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},Y.prototype.validateContext=function(g){var m=g.getContextAttributes(),y="WebGL2RenderingContext"in globalThis&&g instanceof globalThis.WebGL2RenderingContext;y&&(this.webGLVersion=2),m&&!m.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var N=y||!!g.getExtension("OES_element_index_uint");this.supports.uint32Indices=N,N||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},Y}(),Zn=function(Y){this.framebuffer=Y,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=S.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},pi=new z.j,tn=function(){function Y(g){this.renderer=g,this.managedFramebuffers=[],this.unknownFramebuffer=new ft(10,10),this.msaaSamples=null}return Y.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new z.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var m=this.renderer.context.extensions.drawBuffers,y=this.renderer.context.extensions.depthTexture;O.b.PREFER_ENV===S.g.WEBGL_LEGACY&&(m=null,y=null),m?g.drawBuffers=function(N){return m.drawBuffersWEBGL(N)}:(this.hasMRT=!1,g.drawBuffers=function(){}),y||(this.writeDepthTexture=!1)}else this.msaaSamples=g.getInternalformatParameter(g.RENDERBUFFER,g.RGBA8,g.SAMPLES)},Y.prototype.bind=function(g,m,y){y===void 0&&(y=0);var N=this.gl;if(g){var q=g.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(g);this.current!==g&&(this.current=g,N.bindFramebuffer(N.FRAMEBUFFER,q.framebuffer)),q.mipLevel!==y&&(g.dirtyId++,g.dirtyFormat++,q.mipLevel=y),q.dirtyId!==g.dirtyId&&(q.dirtyId=g.dirtyId,q.dirtyFormat!==g.dirtyFormat?(q.dirtyFormat=g.dirtyFormat,q.dirtySize=g.dirtySize,this.updateFramebuffer(g,y)):q.dirtySize!==g.dirtySize&&(q.dirtySize=g.dirtySize,this.resizeFramebuffer(g)));for(var ht=0;ht<g.colorTextures.length;ht++){var xt=g.colorTextures[ht];this.renderer.texture.unbind(xt.parentTextureArray||xt)}if(g.depthTexture&&this.renderer.texture.unbind(g.depthTexture),m){var Tt=m.width>>y,Kt=m.height>>y,ee=Tt/m.width;this.setViewport(m.x*ee,m.y*ee,Tt,Kt)}else Tt=g.width>>y,Kt=g.height>>y,this.setViewport(0,0,Tt,Kt)}else this.current&&(this.current=null,N.bindFramebuffer(N.FRAMEBUFFER,null)),m?this.setViewport(m.x,m.y,m.width,m.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},Y.prototype.setViewport=function(g,m,y,N){var q=this.viewport;g=Math.round(g),m=Math.round(m),y=Math.round(y),N=Math.round(N),q.width===y&&q.height===N&&q.x===g&&q.y===m||(q.x=g,q.y=m,q.width=y,q.height=N,this.gl.viewport(g,m,y,N))},Object.defineProperty(Y.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),Y.prototype.clear=function(g,m,y,N,q){q===void 0&&(q=S.c.COLOR|S.c.DEPTH);var ht=this.gl;ht.clearColor(g,m,y,N),ht.clear(q)},Y.prototype.initFramebuffer=function(g){var m=this.gl,y=new Zn(m.createFramebuffer());return y.multisample=this.detectSamples(g.multisample),g.glFramebuffers[this.CONTEXT_UID]=y,this.managedFramebuffers.push(g),g.disposeRunner.add(this),y},Y.prototype.resizeFramebuffer=function(g){var m=this.gl,y=g.glFramebuffers[this.CONTEXT_UID];y.msaaBuffer&&(m.bindRenderbuffer(m.RENDERBUFFER,y.msaaBuffer),m.renderbufferStorageMultisample(m.RENDERBUFFER,y.multisample,m.RGBA8,g.width,g.height)),y.stencil&&(m.bindRenderbuffer(m.RENDERBUFFER,y.stencil),y.msaaBuffer?m.renderbufferStorageMultisample(m.RENDERBUFFER,y.multisample,m.DEPTH24_STENCIL8,g.width,g.height):m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,g.width,g.height));var N=g.colorTextures,q=N.length;m.drawBuffers||(q=Math.min(q,1));for(var ht=0;ht<q;ht++){var xt=N[ht],Tt=xt.parentTextureArray||xt;this.renderer.texture.bind(Tt,0)}g.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(g.depthTexture,0)},Y.prototype.updateFramebuffer=function(g,m){var y=this.gl,N=g.glFramebuffers[this.CONTEXT_UID],q=g.colorTextures,ht=q.length;y.drawBuffers||(ht=Math.min(ht,1)),N.multisample>1&&this.canMultisampleFramebuffer(g)?(N.msaaBuffer=N.msaaBuffer||y.createRenderbuffer(),y.bindRenderbuffer(y.RENDERBUFFER,N.msaaBuffer),y.renderbufferStorageMultisample(y.RENDERBUFFER,N.multisample,y.RGBA8,g.width,g.height),y.framebufferRenderbuffer(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.RENDERBUFFER,N.msaaBuffer)):N.msaaBuffer&&(y.deleteRenderbuffer(N.msaaBuffer),N.msaaBuffer=null,N.blitFramebuffer&&(N.blitFramebuffer.dispose(),N.blitFramebuffer=null));for(var xt=[],Tt=0;Tt<ht;Tt++){var Kt=q[Tt],ee=Kt.parentTextureArray||Kt;this.renderer.texture.bind(ee,0),Tt===0&&N.msaaBuffer||(y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0+Tt,Kt.target,ee._glTextures[this.CONTEXT_UID].texture,m),xt.push(y.COLOR_ATTACHMENT0+Tt))}if(xt.length>1&&y.drawBuffers(xt),g.depthTexture&&this.writeDepthTexture){var Fe=g.depthTexture;this.renderer.texture.bind(Fe,0),y.framebufferTexture2D(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.TEXTURE_2D,Fe._glTextures[this.CONTEXT_UID].texture,m)}!g.stencil&&!g.depth||g.depthTexture&&this.writeDepthTexture?N.stencil&&(y.deleteRenderbuffer(N.stencil),N.stencil=null):(N.stencil=N.stencil||y.createRenderbuffer(),y.bindRenderbuffer(y.RENDERBUFFER,N.stencil),N.msaaBuffer?y.renderbufferStorageMultisample(y.RENDERBUFFER,N.multisample,y.DEPTH24_STENCIL8,g.width,g.height):y.renderbufferStorage(y.RENDERBUFFER,y.DEPTH_STENCIL,g.width,g.height),y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_STENCIL_ATTACHMENT,y.RENDERBUFFER,N.stencil))},Y.prototype.canMultisampleFramebuffer=function(g){return this.renderer.context.webGLVersion!==1&&g.colorTextures.length<=1&&!g.depthTexture},Y.prototype.detectSamples=function(g){var m=this.msaaSamples,y=S.l.NONE;if(g<=1||m===null)return y;for(var N=0;N<m.length;N++)if(m[N]<=g){y=m[N];break}return y===1&&(y=S.l.NONE),y},Y.prototype.blit=function(g,m,y){var N=this.current,q=this.renderer,ht=this.gl,xt=this.CONTEXT_UID;if(q.context.webGLVersion===2&&N){var Tt=N.glFramebuffers[xt];if(Tt){if(!g){if(!Tt.msaaBuffer)return;var Kt=N.colorTextures[0];if(!Kt)return;Tt.blitFramebuffer||(Tt.blitFramebuffer=new ft(N.width,N.height),Tt.blitFramebuffer.addColorTexture(0,Kt)),(g=Tt.blitFramebuffer).colorTextures[0]!==Kt&&(g.colorTextures[0]=Kt,g.dirtyId++,g.dirtyFormat++),g.width===N.width&&g.height===N.height||(g.width=N.width,g.height=N.height,g.dirtyId++,g.dirtySize++)}m||((m=pi).width=N.width,m.height=N.height),y||(y=m);var ee=m.width===y.width&&m.height===y.height;this.bind(g),ht.bindFramebuffer(ht.READ_FRAMEBUFFER,Tt.framebuffer),ht.blitFramebuffer(m.left,m.top,m.right,m.bottom,y.left,y.top,y.right,y.bottom,ht.COLOR_BUFFER_BIT,ee?ht.NEAREST:ht.LINEAR)}}},Y.prototype.disposeFramebuffer=function(g,m){var y=g.glFramebuffers[this.CONTEXT_UID],N=this.gl;if(y){delete g.glFramebuffers[this.CONTEXT_UID];var q=this.managedFramebuffers.indexOf(g);q>=0&&this.managedFramebuffers.splice(q,1),g.disposeRunner.remove(this),m||(N.deleteFramebuffer(y.framebuffer),y.msaaBuffer&&N.deleteRenderbuffer(y.msaaBuffer),y.stencil&&N.deleteRenderbuffer(y.stencil)),y.blitFramebuffer&&y.blitFramebuffer.dispose()}},Y.prototype.disposeAll=function(g){var m=this.managedFramebuffers;this.managedFramebuffers=[];for(var y=0;y<m.length;y++)this.disposeFramebuffer(m[y],g)},Y.prototype.forceStencil=function(){var g=this.current;if(g){var m=g.glFramebuffers[this.CONTEXT_UID];if(m&&!m.stencil){g.stencil=!0;var y=g.width,N=g.height,q=this.gl,ht=q.createRenderbuffer();q.bindRenderbuffer(q.RENDERBUFFER,ht),m.msaaBuffer?q.renderbufferStorageMultisample(q.RENDERBUFFER,m.multisample,q.DEPTH24_STENCIL8,y,N):q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_STENCIL,y,N),m.stencil=ht,q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,ht)}}},Y.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new z.j},Y.prototype.destroy=function(){this.renderer=null},Y}(),yt={5126:4,5123:2,5121:1},wt=function(){function Y(g){this.renderer=g,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return Y.prototype.contextChange=function(){this.disposeAll(!0);var g=this.gl=this.renderer.gl,m=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,m.webGLVersion!==2){var y=this.renderer.context.extensions.vertexArrayObject;O.b.PREFER_ENV===S.g.WEBGL_LEGACY&&(y=null),y?(g.createVertexArray=function(){return y.createVertexArrayOES()},g.bindVertexArray=function(q){return y.bindVertexArrayOES(q)},g.deleteVertexArray=function(q){return y.deleteVertexArrayOES(q)}):(this.hasVao=!1,g.createVertexArray=function(){return null},g.bindVertexArray=function(){return null},g.deleteVertexArray=function(){return null})}if(m.webGLVersion!==2){var N=g.getExtension("ANGLE_instanced_arrays");N?(g.vertexAttribDivisor=function(q,ht){return N.vertexAttribDivisorANGLE(q,ht)},g.drawElementsInstanced=function(q,ht,xt,Tt,Kt){return N.drawElementsInstancedANGLE(q,ht,xt,Tt,Kt)},g.drawArraysInstanced=function(q,ht,xt,Tt){return N.drawArraysInstancedANGLE(q,ht,xt,Tt)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=m.webGLVersion===2||!!m.extensions.uint32ElementIndex},Y.prototype.bind=function(g,m){m=m||this.renderer.shader.shader;var y=this.gl,N=g.glVertexArrayObjects[this.CONTEXT_UID],q=!1;N||(this.managedGeometries[g.id]=g,g.disposeRunner.add(this),g.glVertexArrayObjects[this.CONTEXT_UID]=N={},q=!0);var ht=N[m.program.id]||this.initGeometryVao(g,m,q);this._activeGeometry=g,this._activeVao!==ht&&(this._activeVao=ht,this.hasVao?y.bindVertexArray(ht):this.activateVao(g,m.program)),this.updateBuffers()},Y.prototype.reset=function(){this.unbind()},Y.prototype.updateBuffers=function(){for(var g=this._activeGeometry,m=this.renderer.buffer,y=0;y<g.buffers.length;y++){var N=g.buffers[y];m.update(N)}},Y.prototype.checkCompatibility=function(g,m){var y=g.attributes,N=m.attributeData;for(var q in N)if(!y[q])throw new Error('shader and geometry incompatible, geometry missing the "'+q+'" attribute')},Y.prototype.getSignature=function(g,m){var y=g.attributes,N=m.attributeData,q=["g",g.id];for(var ht in y)N[ht]&&q.push(ht,N[ht].location);return q.join("-")},Y.prototype.initGeometryVao=function(g,m,y){y===void 0&&(y=!0);var N=this.gl,q=this.CONTEXT_UID,ht=this.renderer.buffer,xt=m.program;xt.glPrograms[q]||this.renderer.shader.generateProgram(m),this.checkCompatibility(g,xt);var Tt=this.getSignature(g,xt),Kt=g.glVertexArrayObjects[this.CONTEXT_UID],ee=Kt[Tt];if(ee)return Kt[xt.id]=ee,ee;var Fe=g.buffers,Te=g.attributes,Qe={},hn={};for(var vn in Fe)Qe[vn]=0,hn[vn]=0;for(var vn in Te)!Te[vn].size&&xt.attributeData[vn]?Te[vn].size=xt.attributeData[vn].size:Te[vn].size||console.warn("PIXI Geometry attribute '"+vn+"' size cannot be determined (likely the bound shader does not have the attribute)"),Qe[Te[vn].buffer]+=Te[vn].size*yt[Te[vn].type];for(var vn in Te){var un=Te[vn],Kn=un.size;un.stride===void 0&&(Qe[un.buffer]===Kn*yt[un.type]?un.stride=0:un.stride=Qe[un.buffer]),un.start===void 0&&(un.start=hn[un.buffer],hn[un.buffer]+=Kn*yt[un.type])}ee=N.createVertexArray(),N.bindVertexArray(ee);for(var mi=0;mi<Fe.length;mi++){var gi=Fe[mi];ht.bind(gi),y&&gi._glBuffers[q].refCount++}return this.activateVao(g,xt),this._activeVao=ee,Kt[xt.id]=ee,Kt[Tt]=ee,ee},Y.prototype.disposeGeometry=function(g,m){var y;if(this.managedGeometries[g.id]){delete this.managedGeometries[g.id];var N=g.glVertexArrayObjects[this.CONTEXT_UID],q=this.gl,ht=g.buffers,xt=(y=this.renderer)===null||y===void 0?void 0:y.buffer;if(g.disposeRunner.remove(this),N){if(xt)for(var Tt=0;Tt<ht.length;Tt++){var Kt=ht[Tt]._glBuffers[this.CONTEXT_UID];Kt&&(Kt.refCount--,Kt.refCount!==0||m||xt.dispose(ht[Tt],m))}if(!m){for(var ee in N)if(ee[0]==="g"){var Fe=N[ee];this._activeVao===Fe&&this.unbind(),q.deleteVertexArray(Fe)}}delete g.glVertexArrayObjects[this.CONTEXT_UID]}}},Y.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedGeometries),y=0;y<m.length;y++)this.disposeGeometry(this.managedGeometries[m[y]],g)},Y.prototype.activateVao=function(g,m){var y=this.gl,N=this.CONTEXT_UID,q=this.renderer.buffer,ht=g.buffers,xt=g.attributes;g.indexBuffer&&q.bind(g.indexBuffer);var Tt=null;for(var Kt in xt){var ee=xt[Kt],Fe=ht[ee.buffer],Te=Fe._glBuffers[N];if(m.attributeData[Kt]){Tt!==Te&&(q.bind(Fe),Tt=Te);var Qe=m.attributeData[Kt].location;if(y.enableVertexAttribArray(Qe),y.vertexAttribPointer(Qe,ee.size,ee.type||y.FLOAT,ee.normalized,ee.stride,ee.start),ee.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");y.vertexAttribDivisor(Qe,1)}}}},Y.prototype.draw=function(g,m,y,N){var q=this.gl,ht=this._activeGeometry;if(ht.indexBuffer){var xt=ht.indexBuffer.data.BYTES_PER_ELEMENT,Tt=xt===2?q.UNSIGNED_SHORT:q.UNSIGNED_INT;xt===2||xt===4&&this.canUseUInt32ElementIndex?ht.instanced?q.drawElementsInstanced(g,m||ht.indexBuffer.data.length,Tt,(y||0)*xt,N||1):q.drawElements(g,m||ht.indexBuffer.data.length,Tt,(y||0)*xt):console.warn("unsupported index buffer type: uint32")}else ht.instanced?q.drawArraysInstanced(g,y,m||ht.getSize(),N||1):q.drawArrays(g,y,m||ht.getSize());return this},Y.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},Y.prototype.destroy=function(){this.renderer=null},Y}(),It=function(){function Y(g){g===void 0&&(g=null),this.type=S.j.NONE,this.autoDetect=!0,this.maskObject=g||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=O.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(Y.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(g){g?this._filters?this._filters[0]=g:this._filters=[g]:this._filters=null},enumerable:!1,configurable:!0}),Y.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=S.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},Y.prototype.copyCountersOrReset=function(g){g?(this._stencilCounter=g._stencilCounter,this._scissorCounter=g._scissorCounter,this._scissorRect=g._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},Y}();function Qt(Y,g,m){var y=Y.createShader(g);return Y.shaderSource(y,m),Y.compileShader(y),y}function Wt(Y,g){var m=Y.getShaderSource(g).split(`
`).map(function(Kt,ee){return ee+": "+Kt}),y=Y.getShaderInfoLog(g),N=y.split(`
`),q={},ht=N.map(function(Kt){return parseFloat(Kt.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(Kt){return!(!Kt||q[Kt])&&(q[Kt]=!0,!0)}),xt=[""];ht.forEach(function(Kt){m[Kt-1]="%c"+m[Kt-1]+"%c",xt.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var Tt=m.join(`
`);xt[0]=Tt,console.error(y),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,xt),console.groupEnd()}function Zt(Y){for(var g=new Array(Y),m=0;m<g.length;m++)g[m]=!1;return g}function oe(Y,g){switch(Y){case"float":return 0;case"vec2":return new Float32Array(2*g);case"vec3":return new Float32Array(3*g);case"vec4":return new Float32Array(4*g);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*g);case"ivec3":return new Int32Array(3*g);case"ivec4":return new Int32Array(4*g);case"uvec2":return new Uint32Array(2*g);case"uvec3":return new Uint32Array(3*g);case"uvec4":return new Uint32Array(4*g);case"bool":return!1;case"bvec2":return Zt(2*g);case"bvec3":return Zt(3*g);case"bvec4":return Zt(4*g);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Me,Se={},Ee=Se;function Ve(){if(!Me){Me=S.m.MEDIUM;var Y=function(){if(Ee===Se||Ee&&Ee.isContextLost()){var m=document.createElement("canvas"),y=void 0;O.b.PREFER_ENV>=S.g.WEBGL2&&(y=m.getContext("webgl2",{})),y||((y=m.getContext("webgl",{})||m.getContext("experimental-webgl",{}))?y.getExtension("WEBGL_draw_buffers"):y=null),Ee=y}return Ee}();if(Y&&Y.getShaderPrecisionFormat){var g=Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.HIGH_FLOAT);Me=g.precision?S.m.HIGH:S.m.MEDIUM}}return Me}function en(Y,g,m){if(Y.substring(0,9)!=="precision"){var y=g;return g===S.m.HIGH&&m!==S.m.HIGH&&(y=S.m.MEDIUM),"precision "+y+` float;
`+Y}return m!==S.m.HIGH&&Y.substring(0,15)==="precision highp"?Y.replace("precision highp","precision mediump"):Y}var dn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Tn(Y){return dn[Y]}var yn=null,Xn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Pn(Y,g){if(!yn){var m=Object.keys(Xn);yn={};for(var y=0;y<m.length;++y){var N=m[y];yn[Y[N]]=Xn[N]}}return yn[g]}var zi=[{test:function(Y){return Y.type==="float"&&Y.size===1},code:function(Y){return`
            if(uv["`+Y+'"] !== ud["'+Y+`"].value)
            {
                ud["`+Y+'"].value = uv["'+Y+`"]
                gl.uniform1f(ud["`+Y+'"].location, uv["'+Y+`"])
            }
            `}},{test:function(Y){return(Y.type==="sampler2D"||Y.type==="samplerCube"||Y.type==="sampler2DArray")&&Y.size===1&&!Y.isArray},code:function(Y){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+Y+`"], t);

            if(ud["`+Y+`"].value !== t)
            {
                ud["`+Y+`"].value = t;
                gl.uniform1i(ud["`+Y+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(Y,g){return Y.type==="mat3"&&Y.size===1&&g.a!==void 0},code:function(Y){return`
            gl.uniformMatrix3fv(ud["`+Y+'"].location, false, uv["'+Y+`"].toArray(true));
            `},codeUbo:function(Y){return`
                var `+Y+"_matrix = uv."+Y+`.toArray(true);

                data[offset] = `+Y+`_matrix[0];
                data[offset+1] = `+Y+`_matrix[1];
                data[offset+2] = `+Y+`_matrix[2];
        
                data[offset + 4] = `+Y+`_matrix[3];
                data[offset + 5] = `+Y+`_matrix[4];
                data[offset + 6] = `+Y+`_matrix[5];
        
                data[offset + 8] = `+Y+`_matrix[6];
                data[offset + 9] = `+Y+`_matrix[7];
                data[offset + 10] = `+Y+`_matrix[8];
            `}},{test:function(Y,g){return Y.type==="vec2"&&Y.size===1&&g.x!==void 0},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+Y+`"].location, v.x, v.y);
                }`},codeUbo:function(Y){return`
                v = uv.`+Y+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(Y){return Y.type==="vec2"&&Y.size===1},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+Y+`"].location, v[0], v[1]);
                }
            `}},{test:function(Y,g){return Y.type==="vec4"&&Y.size===1&&g.width!==void 0},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+Y+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(Y){return`
                    v = uv.`+Y+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(Y){return Y.type==="vec4"&&Y.size===1},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+Y+`"].location, v[0], v[1], v[2], v[3])
                }`}}],fo={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},io={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Fn,Yo=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ro(Y){for(var g="",m=0;m<Y;++m)m>0&&(g+=`
else `),m<Y-1&&(g+="if(test == "+m+".0){}");return g}var mo=0,kn={},jn=function(){function Y(g,m,y){y===void 0&&(y="pixi-shader"),this.id=mo++,this.vertexSrc=g||Y.defaultVertexSrc,this.fragmentSrc=m||Y.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(y=y.replace(/\s+/g,"-"),kn[y]?(kn[y]++,y+="-"+kn[y]):kn[y]=1,this.vertexSrc="#define SHADER_NAME "+y+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+y+`
`+this.fragmentSrc,this.vertexSrc=en(this.vertexSrc,O.b.PRECISION_VERTEX,S.m.HIGH),this.fragmentSrc=en(this.fragmentSrc,O.b.PRECISION_FRAGMENT,Ve())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(Y,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(Y,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),Y.from=function(g,m,y){var N=g+m,q=I.ProgramCache[N];return q||(I.ProgramCache[N]=q=new Y(g,m,y)),q},Y}(),Ki=function(){function Y(g,m){this.uniformBindCount=0,this.program=g,this.uniformGroup=m?m instanceof cn?m:new cn(m):new cn({})}return Y.prototype.checkUniformExists=function(g,m){if(m.uniforms[g])return!0;for(var y in m.uniforms){var N=m.uniforms[y];if(N.group&&this.checkUniformExists(g,N))return!0}return!1},Y.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(Y.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),Y.from=function(g,m,y){return new Y(jn.from(g,m),y)},Y}(),Wr=function(){function Y(){this.data=0,this.blendMode=S.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(Y.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(g){!!(1&this.data)!==g&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(g){!!(2&this.data)!==g&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(g){!!(4&this.data)!==g&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(g){!!(8&this.data)!==g&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(g){!!(32&this.data)!==g&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(g){!!(16&this.data)!==g&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"blendMode",{get:function(){return this._blendMode},set:function(g){this.blend=g!==S.b.NONE,this._blendMode=g},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(g){this.offsets=!!g,this._polygonOffset=g},enumerable:!1,configurable:!0}),Y.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},Y.for2d=function(){var g=new Y;return g.depthTest=!1,g.blend=!0,g},Y}(),Mi=function(Y){function g(m,y,N){var q=this,ht=jn.from(m||g.defaultVertexSrc,y||g.defaultFragmentSrc);return(q=Y.call(this,ht,N)||this).padding=0,q.resolution=O.b.FILTER_RESOLUTION,q.multisample=O.b.FILTER_MULTISAMPLE,q.enabled=!0,q.autoFit=!0,q.state=new Wr,q}return ut(g,Y),g.prototype.apply=function(m,y,N,q,ht){m.applyFilter(this,y,N,q)},Object.defineProperty(g.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(m){this.state.blendMode=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"resolution",{get:function(){return this._resolution},set:function(m){this._resolution=m},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),g}(Ki),Sr=new z.d,Lr=function(){function Y(g,m){this._texture=g,this.mapCoord=new z.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=m===void 0?.5:m,this.isSimple=!1}return Object.defineProperty(Y.prototype,"texture",{get:function(){return this._texture},set:function(g){this._texture=g,this._textureID=-1},enumerable:!1,configurable:!0}),Y.prototype.multiplyUvs=function(g,m){m===void 0&&(m=g);for(var y=this.mapCoord,N=0;N<g.length;N+=2){var q=g[N],ht=g[N+1];m[N]=q*y.a+ht*y.c+y.tx,m[N+1]=q*y.b+ht*y.d+y.ty}return m},Y.prototype.update=function(g){var m=this._texture;if(!m||!m.valid||!g&&this._textureID===m._updateID)return!1;this._textureID=m._updateID,this._updateID++;var y=m._uvs;this.mapCoord.set(y.x1-y.x0,y.y1-y.y0,y.x3-y.x0,y.y3-y.y0,y.x0,y.y0);var N=m.orig,q=m.trim;q&&(Sr.set(N.width/q.width,0,0,N.height/q.height,-q.x/q.width,-q.y/q.height),this.mapCoord.append(Sr));var ht=m.baseTexture,xt=this.uClampFrame,Tt=this.clampMargin/ht.resolution,Kt=this.clampOffset;return xt[0]=(m._frame.x+Tt+Kt)/ht.width,xt[1]=(m._frame.y+Tt+Kt)/ht.height,xt[2]=(m._frame.x+m._frame.width-Tt+Kt)/ht.width,xt[3]=(m._frame.y+m._frame.height-Tt+Kt)/ht.height,this.uClampOffset[0]=Kt/ht.realWidth,this.uClampOffset[1]=Kt/ht.realHeight,this.isSimple=m._frame.width===ht.width&&m._frame.height===ht.height&&m.rotate===0,!0},Y}(),qo=function(Y){function g(m,y,N){var q=this,ht=null;return typeof m!="string"&&y===void 0&&N===void 0&&(ht=m,m=void 0,y=void 0,N=void 0),(q=Y.call(this,m||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,y||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,N)||this).maskSprite=ht,q.maskMatrix=new z.d,q}return ut(g,Y),Object.defineProperty(g.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(m){this._maskSprite=m,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),g.prototype.apply=function(m,y,N,q){var ht=this._maskSprite,xt=ht._texture;xt.valid&&(xt.uvMatrix||(xt.uvMatrix=new Lr(xt,0)),xt.uvMatrix.update(),this.uniforms.npmAlpha=xt.baseTexture.alphaMode?0:1,this.uniforms.mask=xt,this.uniforms.otherMatrix=m.calculateSpriteMatrix(this.maskMatrix,ht).prepend(xt.uvMatrix.mapCoord),this.uniforms.alpha=ht.worldAlpha,this.uniforms.maskClamp=xt.uvMatrix.uClampFrame,m.applyFilter(this,y,N,q))},g}(Mi),Jo=function(){function Y(g){this.renderer=g,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return Y.prototype.setMaskStack=function(g){this.maskStack=g,this.renderer.scissor.setMaskStack(g),this.renderer.stencil.setMaskStack(g)},Y.prototype.push=function(g,m){var y=m;if(!y.isMaskData){var N=this.maskDataPool.pop()||new It;N.pooled=!0,N.maskObject=m,y=N}var q=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(y.copyCountersOrReset(q),y.autoDetect&&this.detect(y),y._target=g,y.type!==S.j.SPRITE&&this.maskStack.push(y),y.enabled)switch(y.type){case S.j.SCISSOR:this.renderer.scissor.push(y);break;case S.j.STENCIL:this.renderer.stencil.push(y);break;case S.j.SPRITE:y.copyCountersOrReset(null),this.pushSpriteMask(y)}y.type===S.j.SPRITE&&this.maskStack.push(y)},Y.prototype.pop=function(g){var m=this.maskStack.pop();if(m&&m._target===g){if(m.enabled)switch(m.type){case S.j.SCISSOR:this.renderer.scissor.pop();break;case S.j.STENCIL:this.renderer.stencil.pop(m.maskObject);break;case S.j.SPRITE:this.popSpriteMask(m)}if(m.reset(),m.pooled&&this.maskDataPool.push(m),this.maskStack.length!==0){var y=this.maskStack[this.maskStack.length-1];y.type===S.j.SPRITE&&y._filters&&(y._filters[0].maskSprite=y.maskObject)}}},Y.prototype.detect=function(g){g.maskObject.isSprite?g.type=S.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(g)?g.type=S.j.SCISSOR:g.type=S.j.STENCIL},Y.prototype.pushSpriteMask=function(g){var m,y,N=g.maskObject,q=g._target,ht=g._filters;ht||(ht=this.alphaMaskPool[this.alphaMaskIndex])||(ht=this.alphaMaskPool[this.alphaMaskIndex]=[new qo]);var xt,Tt,Kt=this.renderer,ee=Kt.renderTexture;if(ee.current){var Fe=ee.current;xt=g.resolution||Fe.resolution,Tt=(m=g.multisample)!==null&&m!==void 0?m:Fe.multisample}else xt=g.resolution||Kt.resolution,Tt=(y=g.multisample)!==null&&y!==void 0?y:Kt.multisample;ht[0].resolution=xt,ht[0].multisample=Tt,ht[0].maskSprite=N;var Te=q.filterArea;q.filterArea=N.getBounds(!0),Kt.filter.push(q,ht),q.filterArea=Te,g._filters||this.alphaMaskIndex++},Y.prototype.popSpriteMask=function(g){this.renderer.filter.pop(),g._filters?g._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},Y.prototype.destroy=function(){this.renderer=null},Y}(),go=function(){function Y(g){this.renderer=g,this.maskStack=[],this.glConst=0}return Y.prototype.getStackLength=function(){return this.maskStack.length},Y.prototype.setMaskStack=function(g){var m=this.renderer.gl,y=this.getStackLength();this.maskStack=g;var N=this.getStackLength();N!==y&&(N===0?m.disable(this.glConst):(m.enable(this.glConst),this._useCurrent()))},Y.prototype._useCurrent=function(){},Y.prototype.destroy=function(){this.renderer=null,this.maskStack=null},Y}(),vo=new z.d,ui=function(Y){function g(m){var y=Y.call(this,m)||this;return y.glConst=WebGLRenderingContext.SCISSOR_TEST,y}return ut(g,Y),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._scissorCounter:0},g.prototype.calcScissorRect=function(m){if(!m._scissorRectLocal){var y=m._scissorRect,N=m.maskObject,q=this.renderer,ht=q.renderTexture;N.renderable=!0;var xt=N.getBounds();this.roundFrameToPixels(xt,ht.current?ht.current.resolution:q.resolution,ht.sourceFrame,ht.destinationFrame,q.projection.transform),N.renderable=!1,y&&xt.fit(y),m._scissorRectLocal=xt}},g.isMatrixRotated=function(m){if(!m)return!1;var y=m.a,N=m.b,q=m.c,ht=m.d;return(Math.abs(N)>1e-4||Math.abs(q)>1e-4)&&(Math.abs(y)>1e-4||Math.abs(ht)>1e-4)},g.prototype.testScissor=function(m){var y=m.maskObject;if(!y.isFastRect||!y.isFastRect()||g.isMatrixRotated(y.worldTransform)||g.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(m);var N=m._scissorRectLocal;return N.width>0&&N.height>0},g.prototype.roundFrameToPixels=function(m,y,N,q,ht){g.isMatrixRotated(ht)||((ht=ht?vo.copyFrom(ht):vo.identity()).translate(-N.x,-N.y).scale(q.width/N.width,q.height/N.height).translate(q.x,q.y),this.renderer.filter.transformAABB(ht,m),m.fit(q),m.x=Math.round(m.x*y),m.y=Math.round(m.y*y),m.width=Math.round(m.width*y),m.height=Math.round(m.height*y))},g.prototype.push=function(m){m._scissorRectLocal||this.calcScissorRect(m);var y=this.renderer.gl;m._scissorRect||y.enable(y.SCISSOR_TEST),m._scissorCounter++,m._scissorRect=m._scissorRectLocal,this._useCurrent()},g.prototype.pop=function(){var m=this.renderer.gl;this.getStackLength()>0?this._useCurrent():m.disable(m.SCISSOR_TEST)},g.prototype._useCurrent=function(){var m,y=this.maskStack[this.maskStack.length-1]._scissorRect;m=this.renderer.renderTexture.current?y.y:this.renderer.height-y.height-y.y,this.renderer.gl.scissor(y.x,m,y.width,y.height)},g}(go),Zo=function(Y){function g(m){var y=Y.call(this,m)||this;return y.glConst=WebGLRenderingContext.STENCIL_TEST,y}return ut(g,Y),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._stencilCounter:0},g.prototype.push=function(m){var y=m.maskObject,N=this.renderer.gl,q=m._stencilCounter;q===0&&(this.renderer.framebuffer.forceStencil(),N.clearStencil(0),N.clear(N.STENCIL_BUFFER_BIT),N.enable(N.STENCIL_TEST)),m._stencilCounter++,N.colorMask(!1,!1,!1,!1),N.stencilFunc(N.EQUAL,q,4294967295),N.stencilOp(N.KEEP,N.KEEP,N.INCR),y.renderable=!0,y.render(this.renderer),this.renderer.batch.flush(),y.renderable=!1,this._useCurrent()},g.prototype.pop=function(m){var y=this.renderer.gl;this.getStackLength()===0?y.disable(y.STENCIL_TEST):(y.colorMask(!1,!1,!1,!1),y.stencilOp(y.KEEP,y.KEEP,y.DECR),m.renderable=!0,m.render(this.renderer),this.renderer.batch.flush(),m.renderable=!1,this._useCurrent())},g.prototype._useCurrent=function(){var m=this.renderer.gl;m.colorMask(!0,!0,!0,!0),m.stencilFunc(m.EQUAL,this.getStackLength(),4294967295),m.stencilOp(m.KEEP,m.KEEP,m.KEEP)},g}(go),Ci=function(){function Y(g){this.renderer=g,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new z.d,this.transform=null}return Y.prototype.update=function(g,m,y,N){this.destinationFrame=g||this.destinationFrame||this.defaultFrame,this.sourceFrame=m||this.sourceFrame||g,this.calculateProjection(this.destinationFrame,this.sourceFrame,y,N),this.transform&&this.projectionMatrix.append(this.transform);var q=this.renderer;q.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,q.globalUniforms.update(),q.shader.shader&&q.shader.syncUniformGroup(q.shader.shader.uniforms.globals)},Y.prototype.calculateProjection=function(g,m,y,N){var q=this.projectionMatrix,ht=N?-1:1;q.identity(),q.a=1/m.width*2,q.d=ht*(1/m.height*2),q.tx=-1-m.x*q.a,q.ty=-ht-m.y*q.d},Y.prototype.setTransform=function(g){},Y.prototype.destroy=function(){this.renderer=null},Y}(),mr=new z.j,Oi=new z.j,Dr=function(){function Y(g){this.renderer=g,this.clearColor=g._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new z.j,this.destinationFrame=new z.j,this.viewportFrame=new z.j}return Y.prototype.bind=function(g,m,y){g===void 0&&(g=null);var N,q,ht,xt=this.renderer;this.current=g,g?(ht=(N=g.baseTexture).resolution,m||(mr.width=g.frame.width,mr.height=g.frame.height,m=mr),y||(Oi.x=g.frame.x,Oi.y=g.frame.y,Oi.width=m.width,Oi.height=m.height,y=Oi),q=N.framebuffer):(ht=xt.resolution,m||(mr.width=xt.screen.width,mr.height=xt.screen.height,m=mr),y||((y=mr).width=m.width,y.height=m.height));var Tt=this.viewportFrame;Tt.x=y.x*ht,Tt.y=y.y*ht,Tt.width=y.width*ht,Tt.height=y.height*ht,g||(Tt.y=xt.view.height-(Tt.y+Tt.height)),Tt.ceil(),this.renderer.framebuffer.bind(q,Tt),this.renderer.projection.update(y,m,ht,!q),g?this.renderer.mask.setMaskStack(N.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(m),this.destinationFrame.copyFrom(y)},Y.prototype.clear=function(g,m){g=this.current?g||this.current.baseTexture.clearColor:g||this.clearColor;var y=this.destinationFrame,N=this.current?this.current.baseTexture:this.renderer.screen,q=y.width!==N.width||y.height!==N.height;if(q){var ht=this.viewportFrame,xt=ht.x,Tt=ht.y,Kt=ht.width,ee=ht.height;xt=Math.round(xt),Tt=Math.round(Tt),Kt=Math.round(Kt),ee=Math.round(ee),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(xt,Tt,Kt,ee)}this.renderer.framebuffer.clear(g[0],g[1],g[2],g[3],m),q&&this.renderer.scissor.pop()},Y.prototype.resize=function(){this.bind(null)},Y.prototype.reset=function(){this.bind(null)},Y.prototype.destroy=function(){this.renderer=null},Y}();function _o(Y,g,m,y,N){m.buffer.update(N)}var oo={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},yo={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function fn(Y,g){if(!Y.autoManage)return{size:0,syncFunc:_o};for(var m=function(mi){for(var gi=mi.map(function(Br){return{data:Br,offset:0,dataLen:0,dirty:0}}),ei=0,Di=0,Fi=0,hi=0;hi<gi.length;hi++){var Ti=gi[hi];if(ei=yo[Ti.data.type],Ti.data.size>1&&(ei=Math.max(ei,16)*Ti.data.size),Ti.dataLen=ei,Di%ei!=0&&Di<16){var vr=Di%ei%16;Di+=vr,Fi+=vr}Di+ei>16?(Fi=16*Math.ceil(Fi/16),Ti.offset=Fi,Fi+=ei,Di=ei):(Ti.offset=Fi,Di+=ei,Fi+=ei)}return{uboElements:gi,size:Fi=16*Math.ceil(Fi/16)}}(function(mi,gi){var ei=[];for(var Di in mi)gi[Di]&&ei.push(gi[Di]);return ei.sort(function(Fi,hi){return Fi.index-hi.index}),ei}(Y.uniforms,g)),y=m.uboElements,N=m.size,q=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],ht=0;ht<y.length;ht++){for(var xt=y[ht],Tt=Y.uniforms[xt.data.name],Kt=xt.data.name,ee=!1,Fe=0;Fe<zi.length;Fe++){var Te=zi[Fe];if(Te.codeUbo&&Te.test(xt.data,Tt)){q.push("offset = "+xt.offset/4+";",zi[Fe].codeUbo(xt.data.name,Tt)),ee=!0;break}}if(!ee)if(xt.data.size>1){var Qe=Tn(xt.data.type),hn=Math.max(yo[xt.data.type]/16,1),vn=Qe/hn,un=(4-vn%4)%4;q.push(`
                cv = ud.`+Kt+`.value;
                v = uv.`+Kt+`;
                offset = `+xt.offset/4+`;

                t = 0;

                for(var i=0; i < `+xt.data.size*hn+`; i++)
                {
                    for(var j = 0; j < `+vn+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+un+`;
                }

                `)}else{var Kn=oo[xt.data.type];q.push(`
                cv = ud.`+Kt+`.value;
                v = uv.`+Kt+`;
                offset = `+xt.offset/4+`;
                `+Kn+`;
                `)}}return q.push(`
       renderer.buffer.update(buffer);
    `),{size:N,syncFunc:new Function("ud","uv","renderer","syncData","buffer",q.join(`
`))}}var Qi=function(){function Y(g,m){this.program=g,this.uniformData=m,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return Y.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},Y}();function Mn(Y,g){var m=Qt(Y,Y.VERTEX_SHADER,g.vertexSrc),y=Qt(Y,Y.FRAGMENT_SHADER,g.fragmentSrc),N=Y.createProgram();if(Y.attachShader(N,m),Y.attachShader(N,y),Y.linkProgram(N),Y.getProgramParameter(N,Y.LINK_STATUS)||function(Kt,ee,Fe,Te){Kt.getProgramParameter(ee,Kt.LINK_STATUS)||(Kt.getShaderParameter(Fe,Kt.COMPILE_STATUS)||Wt(Kt,Fe),Kt.getShaderParameter(Te,Kt.COMPILE_STATUS)||Wt(Kt,Te),console.error("PixiJS Error: Could not initialize shader."),Kt.getProgramInfoLog(ee)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",Kt.getProgramInfoLog(ee)))}(Y,N,m,y),g.attributeData=function(Kt,ee){for(var Fe={},Te=ee.getProgramParameter(Kt,ee.ACTIVE_ATTRIBUTES),Qe=0;Qe<Te;Qe++){var hn=ee.getActiveAttrib(Kt,Qe);if(hn.name.indexOf("gl_")!==0){var vn=Pn(ee,hn.type),un={type:vn,name:hn.name,size:Tn(vn),location:ee.getAttribLocation(Kt,hn.name)};Fe[hn.name]=un}}return Fe}(N,Y),g.uniformData=function(Kt,ee){for(var Fe={},Te=ee.getProgramParameter(Kt,ee.ACTIVE_UNIFORMS),Qe=0;Qe<Te;Qe++){var hn=ee.getActiveUniform(Kt,Qe),vn=hn.name.replace(/\[.*?\]$/,""),un=!!hn.name.match(/\[.*?\]$/),Kn=Pn(ee,hn.type);Fe[vn]={name:vn,index:Qe,type:Kn,size:hn.size,isArray:un,value:oe(Kn,hn.size)}}return Fe}(N,Y),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(g.vertexSrc)){var q=Object.keys(g.attributeData);q.sort(function(Kt,ee){return Kt>ee?1:-1});for(var ht=0;ht<q.length;ht++)g.attributeData[q[ht]].location=ht,Y.bindAttribLocation(N,ht,q[ht]);Y.linkProgram(N)}Y.deleteShader(m),Y.deleteShader(y);var xt={};for(var ht in g.uniformData){var Tt=g.uniformData[ht];xt[ht]={location:Y.getUniformLocation(N,ht),value:oe(Tt.type,Tt.size)}}return new Qi(N,xt)}var xo=0,Yn={textureCount:0,uboCount:0},vs=function(){function Y(g){this.destroyed=!1,this.renderer=g,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=xo++}return Y.prototype.systemCheck=function(){if(!function(){if(typeof Fn=="boolean")return Fn;try{var g=new Function("param1","param2","param3","return param1[param2] === param3;");Fn=g({a:"b"},"a","b")===!0}catch{Fn=!1}return Fn}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},Y.prototype.contextChange=function(g){this.gl=g,this.reset()},Y.prototype.bind=function(g,m){g.uniforms.globals=this.renderer.globalUniforms;var y=g.program,N=y.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(g);return this.shader=g,this.program!==y&&(this.program=y,this.gl.useProgram(N.program)),m||(Yn.textureCount=0,Yn.uboCount=0,this.syncUniformGroup(g.uniformGroup,Yn)),N},Y.prototype.setUniforms=function(g){var m=this.shader.program,y=m.glPrograms[this.renderer.CONTEXT_UID];m.syncUniforms(y.uniformData,g,this.renderer)},Y.prototype.syncUniformGroup=function(g,m){var y=this.getGlProgram();g.static&&g.dirtyId===y.uniformDirtyGroups[g.id]||(y.uniformDirtyGroups[g.id]=g.dirtyId,this.syncUniforms(g,y,m))},Y.prototype.syncUniforms=function(g,m,y){(g.syncUniforms[this.shader.program.id]||this.createSyncGroups(g))(m.uniformData,g.uniforms,this.renderer,y)},Y.prototype.createSyncGroups=function(g){var m=this.getSignature(g,this.shader.program.uniformData,"u");return this.cache[m]||(this.cache[m]=function(y,N){var q,ht=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var xt in y.uniforms){var Tt=N[xt];if(Tt){for(var Kt=y.uniforms[xt],ee=!1,Fe=0;Fe<zi.length;Fe++)if(zi[Fe].test(Tt,Kt)){ht.push(zi[Fe].code(xt,Kt)),ee=!0;break}if(!ee){var Te=(Tt.size===1?fo:io)[Tt.type].replace("location",'ud["'+xt+'"].location');ht.push(`
            cu = ud["`+xt+`"];
            cv = cu.value;
            v = uv["`+xt+`"];
            `+Te+";")}}else!((q=y.uniforms[xt])===null||q===void 0)&&q.group&&(y.uniforms[xt].ubo?ht.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+xt+", '"+xt+`');
                    `):ht.push(`
                        renderer.shader.syncUniformGroup(uv.`+xt+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",ht.join(`
`))}(g,this.shader.program.uniformData)),g.syncUniforms[this.shader.program.id]=this.cache[m],g.syncUniforms[this.shader.program.id]},Y.prototype.syncUniformBufferGroup=function(g,m){var y=this.getGlProgram();if(!g.static||g.dirtyId!==0||!y.uniformGroups[g.id]){g.dirtyId=0;var N=y.uniformGroups[g.id]||this.createSyncBufferGroup(g,y,m);g.buffer.update(),N(y.uniformData,g.uniforms,this.renderer,Yn,g.buffer)}this.renderer.buffer.bindBufferBase(g.buffer,y.uniformBufferBindings[m])},Y.prototype.createSyncBufferGroup=function(g,m,y){var N=this.renderer.gl;this.renderer.buffer.bind(g.buffer);var q=this.gl.getUniformBlockIndex(m.program,y);m.uniformBufferBindings[y]=this.shader.uniformBindCount,N.uniformBlockBinding(m.program,q,this.shader.uniformBindCount),this.shader.uniformBindCount++;var ht=this.getSignature(g,this.shader.program.uniformData,"ubo"),xt=this._uboCache[ht];if(xt||(xt=this._uboCache[ht]=fn(g,this.shader.program.uniformData)),g.autoManage){var Tt=new Float32Array(xt.size/4);g.buffer.update(Tt)}return m.uniformGroups[g.id]=xt.syncFunc,m.uniformGroups[g.id]},Y.prototype.getSignature=function(g,m,y){var N=g.uniforms,q=[y+"-"];for(var ht in N)q.push(ht),m[ht]&&q.push(m[ht].type);return q.join("-")},Y.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},Y.prototype.generateProgram=function(g){var m=this.gl,y=g.program,N=Mn(m,y);return y.glPrograms[this.renderer.CONTEXT_UID]=N,N},Y.prototype.reset=function(){this.program=null,this.shader=null},Y.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},Y}(),ea=function(){function Y(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=S.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Wr,this.defaultState.blend=!0}return Y.prototype.contextChange=function(g){this.gl=g,this.blendModes=function(m,y){return y===void 0&&(y=[]),y[S.b.NORMAL]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.ADD]=[m.ONE,m.ONE],y[S.b.MULTIPLY]=[m.DST_COLOR,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.SCREEN]=[m.ONE,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.OVERLAY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.DARKEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.LIGHTEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.COLOR_DODGE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.COLOR_BURN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.HARD_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.SOFT_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.DIFFERENCE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.EXCLUSION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.HUE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.SATURATION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.COLOR]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.LUMINOSITY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.NONE]=[0,0],y[S.b.NORMAL_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.ADD_NPM]=[m.SRC_ALPHA,m.ONE,m.ONE,m.ONE],y[S.b.SCREEN_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[S.b.SRC_IN]=[m.DST_ALPHA,m.ZERO],y[S.b.SRC_OUT]=[m.ONE_MINUS_DST_ALPHA,m.ZERO],y[S.b.SRC_ATOP]=[m.DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],y[S.b.DST_OVER]=[m.ONE_MINUS_DST_ALPHA,m.ONE],y[S.b.DST_IN]=[m.ZERO,m.SRC_ALPHA],y[S.b.DST_OUT]=[m.ZERO,m.ONE_MINUS_SRC_ALPHA],y[S.b.DST_ATOP]=[m.ONE_MINUS_DST_ALPHA,m.SRC_ALPHA],y[S.b.XOR]=[m.ONE_MINUS_DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],y[S.b.SUBTRACT]=[m.ONE,m.ONE,m.ONE,m.ONE,m.FUNC_REVERSE_SUBTRACT,m.FUNC_ADD],y}(g),this.set(this.defaultState),this.reset()},Y.prototype.set=function(g){if(g=g||this.defaultState,this.stateId!==g.data){for(var m=this.stateId^g.data,y=0;m;)1&m&&this.map[y].call(this,!!(g.data&1<<y)),m>>=1,y++;this.stateId=g.data}for(y=0;y<this.checks.length;y++)this.checks[y](this,g)},Y.prototype.forceState=function(g){g=g||this.defaultState;for(var m=0;m<this.map.length;m++)this.map[m].call(this,!!(g.data&1<<m));for(m=0;m<this.checks.length;m++)this.checks[m](this,g);this.stateId=g.data},Y.prototype.setBlend=function(g){this.updateCheck(Y.checkBlendMode,g),this.gl[g?"enable":"disable"](this.gl.BLEND)},Y.prototype.setOffset=function(g){this.updateCheck(Y.checkPolygonOffset,g),this.gl[g?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},Y.prototype.setDepthTest=function(g){this.gl[g?"enable":"disable"](this.gl.DEPTH_TEST)},Y.prototype.setDepthMask=function(g){this.gl.depthMask(g)},Y.prototype.setCullFace=function(g){this.gl[g?"enable":"disable"](this.gl.CULL_FACE)},Y.prototype.setFrontFace=function(g){this.gl.frontFace(this.gl[g?"CW":"CCW"])},Y.prototype.setBlendMode=function(g){if(g!==this.blendMode){this.blendMode=g;var m=this.blendModes[g],y=this.gl;m.length===2?y.blendFunc(m[0],m[1]):y.blendFuncSeparate(m[0],m[1],m[2],m[3]),m.length===6?(this._blendEq=!0,y.blendEquationSeparate(m[4],m[5])):this._blendEq&&(this._blendEq=!1,y.blendEquationSeparate(y.FUNC_ADD,y.FUNC_ADD))}},Y.prototype.setPolygonOffset=function(g,m){this.gl.polygonOffset(g,m)},Y.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},Y.prototype.updateCheck=function(g,m){var y=this.checks.indexOf(g);m&&y===-1?this.checks.push(g):m||y===-1||this.checks.splice(y,1)},Y.checkBlendMode=function(g,m){g.setBlendMode(m.blendMode)},Y.checkPolygonOffset=function(g,m){g.setPolygonOffset(1,m.polygonOffset)},Y.prototype.destroy=function(){this.gl=null},Y}(),bo=function(){function Y(g){this.renderer=g,this.count=0,this.checkCount=0,this.maxIdle=O.b.GC_MAX_IDLE,this.checkCountMax=O.b.GC_MAX_CHECK_COUNT,this.mode=O.b.GC_MODE}return Y.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==S.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},Y.prototype.run=function(){for(var g=this.renderer.texture,m=g.managedTextures,y=!1,N=0;N<m.length;N++){var q=m[N];!q.framebuffer&&this.count-q.touched>this.maxIdle&&(g.destroyTexture(q,!0),m[N]=null,y=!0)}if(y){var ht=0;for(N=0;N<m.length;N++)m[N]!==null&&(m[ht++]=m[N]);m.length=ht}},Y.prototype.unload=function(g){var m=this.renderer.texture,y=g._texture;y&&!y.framebuffer&&m.destroyTexture(y);for(var N=g.children.length-1;N>=0;N--)this.unload(g.children[N])},Y.prototype.destroy=function(){this.renderer=null},Y}(),An=function(Y){this.texture=Y,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=S.r.UNSIGNED_BYTE,this.internalFormat=S.h.RGBA,this.samplerType=0},_s=function(){function Y(g){this.renderer=g,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new U,this.hasIntegerTextures=!1}return Y.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(q){var ht,xt,Tt,Kt,ee,Fe,Te,Qe,hn,vn,un,Kn,mi,gi,ei,Di,Fi,hi,Ti,vr,Br,$o,ts;return"WebGL2RenderingContext"in globalThis&&q instanceof globalThis.WebGL2RenderingContext?((ht={})[S.r.UNSIGNED_BYTE]=((xt={})[S.h.RGBA]=q.RGBA8,xt[S.h.RGB]=q.RGB8,xt[S.h.RG]=q.RG8,xt[S.h.RED]=q.R8,xt[S.h.RGBA_INTEGER]=q.RGBA8UI,xt[S.h.RGB_INTEGER]=q.RGB8UI,xt[S.h.RG_INTEGER]=q.RG8UI,xt[S.h.RED_INTEGER]=q.R8UI,xt[S.h.ALPHA]=q.ALPHA,xt[S.h.LUMINANCE]=q.LUMINANCE,xt[S.h.LUMINANCE_ALPHA]=q.LUMINANCE_ALPHA,xt),ht[S.r.BYTE]=((Tt={})[S.h.RGBA]=q.RGBA8_SNORM,Tt[S.h.RGB]=q.RGB8_SNORM,Tt[S.h.RG]=q.RG8_SNORM,Tt[S.h.RED]=q.R8_SNORM,Tt[S.h.RGBA_INTEGER]=q.RGBA8I,Tt[S.h.RGB_INTEGER]=q.RGB8I,Tt[S.h.RG_INTEGER]=q.RG8I,Tt[S.h.RED_INTEGER]=q.R8I,Tt),ht[S.r.UNSIGNED_SHORT]=((Kt={})[S.h.RGBA_INTEGER]=q.RGBA16UI,Kt[S.h.RGB_INTEGER]=q.RGB16UI,Kt[S.h.RG_INTEGER]=q.RG16UI,Kt[S.h.RED_INTEGER]=q.R16UI,Kt[S.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT16,Kt),ht[S.r.SHORT]=((ee={})[S.h.RGBA_INTEGER]=q.RGBA16I,ee[S.h.RGB_INTEGER]=q.RGB16I,ee[S.h.RG_INTEGER]=q.RG16I,ee[S.h.RED_INTEGER]=q.R16I,ee),ht[S.r.UNSIGNED_INT]=((Fe={})[S.h.RGBA_INTEGER]=q.RGBA32UI,Fe[S.h.RGB_INTEGER]=q.RGB32UI,Fe[S.h.RG_INTEGER]=q.RG32UI,Fe[S.h.RED_INTEGER]=q.R32UI,Fe[S.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT24,Fe),ht[S.r.INT]=((Te={})[S.h.RGBA_INTEGER]=q.RGBA32I,Te[S.h.RGB_INTEGER]=q.RGB32I,Te[S.h.RG_INTEGER]=q.RG32I,Te[S.h.RED_INTEGER]=q.R32I,Te),ht[S.r.FLOAT]=((Qe={})[S.h.RGBA]=q.RGBA32F,Qe[S.h.RGB]=q.RGB32F,Qe[S.h.RG]=q.RG32F,Qe[S.h.RED]=q.R32F,Qe[S.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT32F,Qe),ht[S.r.HALF_FLOAT]=((hn={})[S.h.RGBA]=q.RGBA16F,hn[S.h.RGB]=q.RGB16F,hn[S.h.RG]=q.RG16F,hn[S.h.RED]=q.R16F,hn),ht[S.r.UNSIGNED_SHORT_5_6_5]=((vn={})[S.h.RGB]=q.RGB565,vn),ht[S.r.UNSIGNED_SHORT_4_4_4_4]=((un={})[S.h.RGBA]=q.RGBA4,un),ht[S.r.UNSIGNED_SHORT_5_5_5_1]=((Kn={})[S.h.RGBA]=q.RGB5_A1,Kn),ht[S.r.UNSIGNED_INT_2_10_10_10_REV]=((mi={})[S.h.RGBA]=q.RGB10_A2,mi[S.h.RGBA_INTEGER]=q.RGB10_A2UI,mi),ht[S.r.UNSIGNED_INT_10F_11F_11F_REV]=((gi={})[S.h.RGB]=q.R11F_G11F_B10F,gi),ht[S.r.UNSIGNED_INT_5_9_9_9_REV]=((ei={})[S.h.RGB]=q.RGB9_E5,ei),ht[S.r.UNSIGNED_INT_24_8]=((Di={})[S.h.DEPTH_STENCIL]=q.DEPTH24_STENCIL8,Di),ht[S.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((Fi={})[S.h.DEPTH_STENCIL]=q.DEPTH32F_STENCIL8,Fi),ts=ht):((hi={})[S.r.UNSIGNED_BYTE]=((Ti={})[S.h.RGBA]=q.RGBA,Ti[S.h.RGB]=q.RGB,Ti[S.h.ALPHA]=q.ALPHA,Ti[S.h.LUMINANCE]=q.LUMINANCE,Ti[S.h.LUMINANCE_ALPHA]=q.LUMINANCE_ALPHA,Ti),hi[S.r.UNSIGNED_SHORT_5_6_5]=((vr={})[S.h.RGB]=q.RGB,vr),hi[S.r.UNSIGNED_SHORT_4_4_4_4]=((Br={})[S.h.RGBA]=q.RGBA,Br),hi[S.r.UNSIGNED_SHORT_5_5_5_1]=(($o={})[S.h.RGBA]=q.RGBA,$o),ts=hi),ts}(g);var m=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=m;for(var y=0;y<m;y++)this.boundTextures[y]=null;this.emptyTextures={};var N=new An(g.createTexture());for(g.bindTexture(g.TEXTURE_2D,N.texture),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[g.TEXTURE_2D]=N,this.emptyTextures[g.TEXTURE_CUBE_MAP]=new An(g.createTexture()),g.bindTexture(g.TEXTURE_CUBE_MAP,this.emptyTextures[g.TEXTURE_CUBE_MAP].texture),y=0;y<6;y++)g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,null);for(g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MIN_FILTER,g.LINEAR),y=0;y<this.boundTextures.length;y++)this.bind(null,y)},Y.prototype.bind=function(g,m){m===void 0&&(m=0);var y=this.gl;if((g=g==null?void 0:g.castToBaseTexture())&&g.valid&&!g.parentTextureArray){g.touched=this.renderer.textureGC.count;var N=g._glTextures[this.CONTEXT_UID]||this.initTexture(g);this.boundTextures[m]!==g&&(this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),y.bindTexture(g.target,N.texture)),N.dirtyId!==g.dirtyId&&(this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),this.updateTexture(g)),this.boundTextures[m]=g}else this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),y.bindTexture(y.TEXTURE_2D,this.emptyTextures[y.TEXTURE_2D].texture),this.boundTextures[m]=null},Y.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var g=0;g<this.boundTextures.length;g++)this.boundTextures[g]=this.unknownTexture},Y.prototype.unbind=function(g){var m=this.gl,y=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var N=0;N<y.length;N++)y[N]===this.unknownTexture&&this.bind(null,N)}for(N=0;N<y.length;N++)y[N]===g&&(this.currentLocation!==N&&(m.activeTexture(m.TEXTURE0+N),this.currentLocation=N),m.bindTexture(g.target,this.emptyTextures[g.target].texture),y[N]=null)},Y.prototype.ensureSamplerType=function(g){var m=this.boundTextures,y=this.hasIntegerTextures,N=this.CONTEXT_UID;if(y)for(var q=g-1;q>=0;--q){var ht=m[q];ht&&ht._glTextures[N].samplerType!==S.o.FLOAT&&this.renderer.texture.unbind(ht)}},Y.prototype.initTexture=function(g){var m=new An(this.gl.createTexture());return m.dirtyId=-1,g._glTextures[this.CONTEXT_UID]=m,this.managedTextures.push(g),g.on("dispose",this.destroyTexture,this),m},Y.prototype.initTextureType=function(g,m){var y,N;m.internalFormat=(N=(y=this.internalFormats[g.type])===null||y===void 0?void 0:y[g.format])!==null&&N!==void 0?N:g.format,this.webGLVersion===2&&g.type===S.r.HALF_FLOAT?m.type=this.gl.HALF_FLOAT:m.type=g.type},Y.prototype.updateTexture=function(g){var m=g._glTextures[this.CONTEXT_UID];if(m){var y=this.renderer;if(this.initTextureType(g,m),g.resource&&g.resource.upload(y,g,m))m.samplerType!==S.o.FLOAT&&(this.hasIntegerTextures=!0);else{var N=g.realWidth,q=g.realHeight,ht=y.gl;(m.width!==N||m.height!==q||m.dirtyId<0)&&(m.width=N,m.height=q,ht.texImage2D(g.target,0,m.internalFormat,N,q,0,g.format,m.type,null))}g.dirtyStyleId!==m.dirtyStyleId&&this.updateTextureStyle(g),m.dirtyId=g.dirtyId}},Y.prototype.destroyTexture=function(g,m){var y=this.gl;if((g=g.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(g),y.deleteTexture(g._glTextures[this.CONTEXT_UID].texture),g.off("dispose",this.destroyTexture,this),delete g._glTextures[this.CONTEXT_UID],!m)){var N=this.managedTextures.indexOf(g);N!==-1&&Object(I.removeItems)(this.managedTextures,N,1)}},Y.prototype.updateTextureStyle=function(g){var m=g._glTextures[this.CONTEXT_UID];m&&(g.mipmap!==S.k.POW2&&this.webGLVersion===2||g.isPowerOfTwo?m.mipmap=g.mipmap>=1:m.mipmap=!1,this.webGLVersion===2||g.isPowerOfTwo?m.wrapMode=g.wrapMode:m.wrapMode=S.s.CLAMP,g.resource&&g.resource.style(this.renderer,g,m)||this.setStyle(g,m),m.dirtyStyleId=g.dirtyStyleId)},Y.prototype.setStyle=function(g,m){var y=this.gl;if(m.mipmap&&g.mipmap!==S.k.ON_MANUAL&&y.generateMipmap(g.target),y.texParameteri(g.target,y.TEXTURE_WRAP_S,m.wrapMode),y.texParameteri(g.target,y.TEXTURE_WRAP_T,m.wrapMode),m.mipmap){y.texParameteri(g.target,y.TEXTURE_MIN_FILTER,g.scaleMode===S.p.LINEAR?y.LINEAR_MIPMAP_LINEAR:y.NEAREST_MIPMAP_NEAREST);var N=this.renderer.context.extensions.anisotropicFiltering;if(N&&g.anisotropicLevel>0&&g.scaleMode===S.p.LINEAR){var q=Math.min(g.anisotropicLevel,y.getParameter(N.MAX_TEXTURE_MAX_ANISOTROPY_EXT));y.texParameterf(g.target,N.TEXTURE_MAX_ANISOTROPY_EXT,q)}}else y.texParameteri(g.target,y.TEXTURE_MIN_FILTER,g.scaleMode===S.p.LINEAR?y.LINEAR:y.NEAREST);y.texParameteri(g.target,y.TEXTURE_MAG_FILTER,g.scaleMode===S.p.LINEAR?y.LINEAR:y.NEAREST)},Y.prototype.destroy=function(){this.renderer=null},Y}(),Ko=new z.d,bi=function(Y){function g(m,y){m===void 0&&(m=S.n.UNKNOWN);var N=Y.call(this)||this;return y=Object.assign({},O.b.RENDER_OPTIONS,y),N.options=y,N.type=m,N.screen=new z.j(0,0,y.width,y.height),N.view=y.view||document.createElement("canvas"),N.resolution=y.resolution||O.b.RESOLUTION,N.useContextAlpha=y.useContextAlpha,N.autoDensity=!!y.autoDensity,N.preserveDrawingBuffer=y.preserveDrawingBuffer,N.clearBeforeRender=y.clearBeforeRender,N._backgroundColor=0,N._backgroundColorRgba=[0,0,0,1],N._backgroundColorString="#000000",N.backgroundColor=y.backgroundColor||N._backgroundColor,N.backgroundAlpha=y.backgroundAlpha,y.transparent!==void 0&&(Object(I.deprecation)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),N.useContextAlpha=y.transparent,N.backgroundAlpha=y.transparent?0:1),N._lastObjectRendered=null,N.plugins={},N}return ut(g,Y),g.prototype.initPlugins=function(m){for(var y in m)this.plugins[y]=new m[y](this)},Object.defineProperty(g.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,y){this.view.width=Math.round(m*this.resolution),this.view.height=Math.round(y*this.resolution);var N=this.view.width/this.resolution,q=this.view.height/this.resolution;this.screen.width=N,this.screen.height=q,this.autoDensity&&(this.view.style.width=N+"px",this.view.style.height=q+"px"),this.emit("resize",N,q)},g.prototype.generateTexture=function(m,y,N,q){y===void 0&&(y={}),typeof y=="number"&&(Object(I.deprecation)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),y={scaleMode:y,resolution:N,region:q});var ht=y.region,xt=function(Kt,ee){var Fe={};for(var Te in Kt)Object.prototype.hasOwnProperty.call(Kt,Te)&&ee.indexOf(Te)<0&&(Fe[Te]=Kt[Te]);if(Kt!=null&&typeof Object.getOwnPropertySymbols=="function"){var Qe=0;for(Te=Object.getOwnPropertySymbols(Kt);Qe<Te.length;Qe++)ee.indexOf(Te[Qe])<0&&(Fe[Te[Qe]]=Kt[Te[Qe]])}return Fe}(y,["region"]);(q=ht||m.getLocalBounds(null,!0)).width===0&&(q.width=1),q.height===0&&(q.height=1);var Tt=rt.create(Rt({width:q.width,height:q.height},xt));return Ko.tx=-q.x,Ko.ty=-q.y,this.render(m,{renderTexture:Tt,clear:!1,transform:Ko,skipUpdateTransform:!!m.parent}),Tt},g.prototype.destroy=function(m){for(var y in this.plugins)this.plugins[y].destroy(),this.plugins[y]=null;m&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=S.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(g.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(m){this._backgroundColor=m,this._backgroundColorString=Object(I.hex2string)(m),Object(I.hex2rgb)(m,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(m){this._backgroundColorRgba[3]=m},enumerable:!1,configurable:!0}),g}(I.EventEmitter),Qo=function(Y){this.buffer=Y||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},gr=function(){function Y(g){this.renderer=g,this.managedBuffers={},this.boundBufferBases={}}return Y.prototype.destroy=function(){this.renderer=null},Y.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},Y.prototype.bind=function(g){var m=this.gl,y=this.CONTEXT_UID,N=g._glBuffers[y]||this.createGLBuffer(g);m.bindBuffer(g.type,N.buffer)},Y.prototype.bindBufferBase=function(g,m){var y=this.gl,N=this.CONTEXT_UID;if(this.boundBufferBases[m]!==g){var q=g._glBuffers[N]||this.createGLBuffer(g);this.boundBufferBases[m]=g,y.bindBufferBase(y.UNIFORM_BUFFER,m,q.buffer)}},Y.prototype.bindBufferRange=function(g,m,y){var N=this.gl,q=this.CONTEXT_UID;y=y||0;var ht=g._glBuffers[q]||this.createGLBuffer(g);N.bindBufferRange(N.UNIFORM_BUFFER,m||0,ht.buffer,256*y,256)},Y.prototype.update=function(g){var m=this.gl,y=this.CONTEXT_UID,N=g._glBuffers[y];if(g._updateID!==N.updateID)if(N.updateID=g._updateID,m.bindBuffer(g.type,N.buffer),N.byteLength>=g.data.byteLength)m.bufferSubData(g.type,0,g.data);else{var q=g.static?m.STATIC_DRAW:m.DYNAMIC_DRAW;N.byteLength=g.data.byteLength,m.bufferData(g.type,g.data,q)}},Y.prototype.dispose=function(g,m){if(this.managedBuffers[g.id]){delete this.managedBuffers[g.id];var y=g._glBuffers[this.CONTEXT_UID],N=this.gl;g.disposeRunner.remove(this),y&&(m||N.deleteBuffer(y.buffer),delete g._glBuffers[this.CONTEXT_UID])}},Y.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedBuffers),y=0;y<m.length;y++)this.dispose(this.managedBuffers[m[y]],g)},Y.prototype.createGLBuffer=function(g){var m=this.CONTEXT_UID,y=this.gl;return g._glBuffers[m]=new Qo(y.createBuffer()),this.managedBuffers[g.id]=g,g.disposeRunner.add(this),g._glBuffers[m]},Y}(),Ni=function(Y){function g(m){var y=Y.call(this,S.n.WEBGL,m)||this;return m=y.options,y.gl=null,y.CONTEXT_UID=0,y.runners={destroy:new D.a("destroy"),contextChange:new D.a("contextChange"),reset:new D.a("reset"),update:new D.a("update"),postrender:new D.a("postrender"),prerender:new D.a("prerender"),resize:new D.a("resize")},y.runners.contextChange.add(y),y.globalUniforms=new cn({projectionMatrix:new z.d},!0),y.addSystem(Jo,"mask").addSystem(In,"context").addSystem(ea,"state").addSystem(vs,"shader").addSystem(_s,"texture").addSystem(gr,"buffer").addSystem(wt,"geometry").addSystem(tn,"framebuffer").addSystem(ui,"scissor").addSystem(Zo,"stencil").addSystem(Ci,"projection").addSystem(bo,"textureGC").addSystem(re,"filter").addSystem(Dr,"renderTexture").addSystem(we,"batch"),y.initPlugins(g.__plugins),y.multisample=void 0,m.context?y.context.initFromContext(m.context):y.context.initFromOptions({alpha:!!y.useContextAlpha,antialias:m.antialias,premultipliedAlpha:y.useContextAlpha&&y.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:m.preserveDrawingBuffer,powerPreference:y.options.powerPreference}),y.renderingToScreen=!0,Object(I.sayHello)(y.context.webGLVersion===2?"WebGL 2":"WebGL 1"),y.resize(y.options.width,y.options.height),y}return ut(g,Y),g.create=function(m){if(Object(I.isWebGLSupported)())return new g(m);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},g.prototype.contextChange=function(){var m,y=this.gl;if(this.context.webGLVersion===1){var N=y.getParameter(y.FRAMEBUFFER_BINDING);y.bindFramebuffer(y.FRAMEBUFFER,null),m=y.getParameter(y.SAMPLES),y.bindFramebuffer(y.FRAMEBUFFER,N)}else N=y.getParameter(y.DRAW_FRAMEBUFFER_BINDING),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,null),m=y.getParameter(y.SAMPLES),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,N);m>=S.l.HIGH?this.multisample=S.l.HIGH:m>=S.l.MEDIUM?this.multisample=S.l.MEDIUM:m>=S.l.LOW?this.multisample=S.l.LOW:this.multisample=S.l.NONE},g.prototype.addSystem=function(m,y){var N=new m(this);if(this[y])throw new Error('Whoops! The name "'+y+'" is already in use');for(var q in this[y]=N,this.runners)this.runners[q].add(N);return this},g.prototype.render=function(m,y){var N,q,ht,xt;if(y&&(y instanceof rt?(Object(I.deprecation)("6.0.0","Renderer#render arguments changed, use options instead."),N=y,q=arguments[2],ht=arguments[3],xt=arguments[4]):(N=y.renderTexture,q=y.clear,ht=y.transform,xt=y.skipUpdateTransform)),this.renderingToScreen=!N,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=ht,!this.context.isLost){if(N||(this._lastObjectRendered=m),!xt){var Tt=m.enableTempParent();m.updateTransform(),m.disableTempParent(Tt)}this.renderTexture.bind(N),this.batch.currentRenderer.start(),(q!==void 0?q:this.clearBeforeRender)&&this.renderTexture.clear(),m.render(this),this.batch.currentRenderer.flush(),N&&N.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},g.prototype.generateTexture=function(m,y,N,q){y===void 0&&(y={});var ht=Y.prototype.generateTexture.call(this,m,y,N,q);return this.framebuffer.blit(),ht},g.prototype.resize=function(m,y){Y.prototype.resize.call(this,m,y),this.runners.resize.emit(this.screen.height,this.screen.width)},g.prototype.reset=function(){return this.runners.reset.emit(),this},g.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},g.prototype.destroy=function(m){for(var y in this.runners.destroy.emit(),this.runners)this.runners[y].destroy();Y.prototype.destroy.call(this,m),this.gl=null},Object.defineProperty(g.prototype,"extract",{get:function(){return Object(I.deprecation)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),g.registerPlugin=function(m,y){g.__plugins=g.__plugins||{},g.__plugins[m]=y},g}(bi);function so(Y){return Ni.create(Y)}var fi=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Wn=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,To=function(){this.texArray=null,this.blend=0,this.type=S.f.TRIANGLES,this.start=0,this.size=0,this.data=null},Fr=function(){function Y(){this.elements=[],this.ids=[],this.count=0}return Y.prototype.clear=function(){for(var g=0;g<this.count;g++)this.elements[g]=null;this.count=0},Y}(),wo=function(){function Y(g){typeof g=="number"?this.rawBinaryData=new ArrayBuffer(g):g instanceof Uint8Array?this.rawBinaryData=g.buffer:this.rawBinaryData=g,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(Y.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),Y.prototype.view=function(g){return this[g+"View"]},Y.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Y.sizeOf=function(g){switch(g){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(g+" isn't a valid view type")}},Y}(),Ar=function(Y){function g(m){var y=Y.call(this,m)||this;return y.shaderGenerator=null,y.geometryClass=null,y.vertexSize=null,y.state=Wr.for2d(),y.size=4*O.b.SPRITE_BATCH_SIZE,y._vertexCount=0,y._indexCount=0,y._bufferedElements=[],y._bufferedTextures=[],y._bufferSize=0,y._shader=null,y._packedGeometries=[],y._packedGeometryPoolSize=2,y._flushId=0,y._aBuffers={},y._iBuffers={},y.MAX_TEXTURES=1,y.renderer.on("prerender",y.onPrerender,y),m.runners.contextChange.add(y),y._dcIndex=0,y._aIndex=0,y._iIndex=0,y._attributeBuffer=null,y._indexBuffer=null,y._tempBoundTextures=[],y}return ut(g,Y),g.prototype.contextChange=function(){var m=this.renderer.gl;O.b.PREFER_ENV===S.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS),O.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(N,q){if(N===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var ht=q.createShader(q.FRAGMENT_SHADER);;){var xt=Yo.replace(/%forloop%/gi,ro(N));if(q.shaderSource(ht,xt),q.compileShader(ht),q.getShaderParameter(ht,q.COMPILE_STATUS))break;N=N/2|0}return N}(this.MAX_TEXTURES,m)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var y=0;y<this._packedGeometryPoolSize;y++)this._packedGeometries[y]=new this.geometryClass;this.initFlushBuffers()},g.prototype.initFlushBuffers=function(){for(var m=g._drawCallPool,y=g._textureArrayPool,N=this.size/4,q=Math.floor(N/this.MAX_TEXTURES)+1;m.length<N;)m.push(new To);for(;y.length<q;)y.push(new Fr);for(var ht=0;ht<this.MAX_TEXTURES;ht++)this._tempBoundTextures[ht]=null},g.prototype.onPrerender=function(){this._flushId=0},g.prototype.render=function(m){m._texture.valid&&(this._vertexCount+m.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=m.vertexData.length/2,this._indexCount+=m.indices.length,this._bufferedTextures[this._bufferSize]=m._texture.baseTexture,this._bufferedElements[this._bufferSize++]=m)},g.prototype.buildTexturesAndDrawCalls=function(){var m=this._bufferedTextures,y=this.MAX_TEXTURES,N=g._textureArrayPool,q=this.renderer.batch,ht=this._tempBoundTextures,xt=this.renderer.textureGC.count,Tt=++U._globalBatch,Kt=0,ee=N[0],Fe=0;q.copyBoundTextures(ht,y);for(var Te=0;Te<this._bufferSize;++Te){var Qe=m[Te];m[Te]=null,Qe._batchEnabled!==Tt&&(ee.count>=y&&(q.boundArray(ee,ht,Tt,y),this.buildDrawCalls(ee,Fe,Te),Fe=Te,ee=N[++Kt],++Tt),Qe._batchEnabled=Tt,Qe.touched=xt,ee.elements[ee.count++]=Qe)}for(ee.count>0&&(q.boundArray(ee,ht,Tt,y),this.buildDrawCalls(ee,Fe,this._bufferSize),++Kt,++Tt),Te=0;Te<ht.length;Te++)ht[Te]=null;U._globalBatch=Tt},g.prototype.buildDrawCalls=function(m,y,N){var q=this._bufferedElements,ht=this._attributeBuffer,xt=this._indexBuffer,Tt=this.vertexSize,Kt=g._drawCallPool,ee=this._dcIndex,Fe=this._aIndex,Te=this._iIndex,Qe=Kt[ee];Qe.start=this._iIndex,Qe.texArray=m;for(var hn=y;hn<N;++hn){var vn=q[hn],un=vn._texture.baseTexture,Kn=I.premultiplyBlendMode[un.alphaMode?1:0][vn.blendMode];q[hn]=null,y<hn&&Qe.blend!==Kn&&(Qe.size=Te-Qe.start,y=hn,(Qe=Kt[++ee]).texArray=m,Qe.start=Te),this.packInterleavedGeometry(vn,ht,xt,Fe,Te),Fe+=vn.vertexData.length/2*Tt,Te+=vn.indices.length,Qe.blend=Kn}y<N&&(Qe.size=Te-Qe.start,++ee),this._dcIndex=ee,this._aIndex=Fe,this._iIndex=Te},g.prototype.bindAndClearTexArray=function(m){for(var y=this.renderer.texture,N=0;N<m.count;N++)y.bind(m.elements[N],m.ids[N]),m.elements[N]=null;m.count=0},g.prototype.updateGeometry=function(){var m=this._packedGeometries,y=this._attributeBuffer,N=this._indexBuffer;O.b.CAN_UPLOAD_SAME_BUFFER?(m[this._flushId]._buffer.update(y.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,m[this._flushId]=new this.geometryClass),m[this._flushId]._buffer.update(y.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.bind(m[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},g.prototype.drawBatches=function(){for(var m=this._dcIndex,y=this.renderer,N=y.gl,q=y.state,ht=g._drawCallPool,xt=null,Tt=0;Tt<m;Tt++){var Kt=ht[Tt],ee=Kt.texArray,Fe=Kt.type,Te=Kt.size,Qe=Kt.start,hn=Kt.blend;xt!==ee&&(xt=ee,this.bindAndClearTexArray(ee)),this.state.blendMode=hn,q.set(this.state),N.drawElements(Fe,Te,N.UNSIGNED_SHORT,2*Qe)}},g.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},g.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),O.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},g.prototype.stop=function(){this.flush()},g.prototype.destroy=function(){for(var m=0;m<this._packedGeometryPoolSize;m++)this._packedGeometries[m]&&this._packedGeometries[m].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),Y.prototype.destroy.call(this)},g.prototype.getAttributeBuffer=function(m){var y=Object(I.nextPow2)(Math.ceil(m/8)),N=Object(I.log2)(y),q=8*y;this._aBuffers.length<=N&&(this._iBuffers.length=N+1);var ht=this._aBuffers[q];return ht||(this._aBuffers[q]=ht=new wo(q*this.vertexSize*4)),ht},g.prototype.getIndexBuffer=function(m){var y=Object(I.nextPow2)(Math.ceil(m/12)),N=Object(I.log2)(y),q=12*y;this._iBuffers.length<=N&&(this._iBuffers.length=N+1);var ht=this._iBuffers[N];return ht||(this._iBuffers[N]=ht=new Uint16Array(q)),ht},g.prototype.packInterleavedGeometry=function(m,y,N,q,ht){for(var xt=y.uint32View,Tt=y.float32View,Kt=q/this.vertexSize,ee=m.uvs,Fe=m.indices,Te=m.vertexData,Qe=m._texture.baseTexture._batchLocation,hn=Math.min(m.worldAlpha,1),vn=hn<1&&m._texture.baseTexture.alphaMode?Object(I.premultiplyTint)(m._tintRGB,hn):m._tintRGB+(255*hn<<24),un=0;un<Te.length;un+=2)Tt[q++]=Te[un],Tt[q++]=Te[un+1],Tt[q++]=ee[un],Tt[q++]=ee[un+1],xt[q++]=vn,Tt[q++]=Qe;for(un=0;un<Fe.length;un++)N[ht++]=Kt+Fe[un]},g._drawCallPool=[],g._textureArrayPool=[],g}(pe),Mr=function(){function Y(g,m){if(this.vertexSrc=g,this.fragTemplate=m,this.programCache={},this.defaultGroupCache={},m.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(m.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return Y.prototype.generateShader=function(g){if(!this.programCache[g]){for(var m=new Int32Array(g),y=0;y<g;y++)m[y]=y;this.defaultGroupCache[g]=cn.from({uSamplers:m},!0);var N=this.fragTemplate;N=(N=N.replace(/%count%/gi,""+g)).replace(/%forloop%/gi,this.generateSampleSrc(g)),this.programCache[g]=new jn(this.vertexSrc,N)}var q={tint:new Float32Array([1,1,1,1]),translationMatrix:new z.d,default:this.defaultGroupCache[g]};return new Ki(this.programCache[g],q)},Y.prototype.generateSampleSrc=function(g){var m="";m+=`
`,m+=`
`;for(var y=0;y<g;y++)y>0&&(m+=`
else `),y<g-1&&(m+="if(vTextureId < "+y+".5)"),m+=`
{`,m+=`
	color = texture2D(uSamplers[`+y+"], vTextureCoord);",m+=`
}`;return m+=`
`,m+=`
`},Y}(),or=function(Y){function g(m){m===void 0&&(m=!1);var y=Y.call(this)||this;return y._buffer=new Xt(null,m,!1),y._indexBuffer=new Xt(null,m,!0),y.addAttribute("aVertexPosition",y._buffer,2,!1,S.r.FLOAT).addAttribute("aTextureCoord",y._buffer,2,!1,S.r.FLOAT).addAttribute("aColor",y._buffer,4,!0,S.r.UNSIGNED_BYTE).addAttribute("aTextureId",y._buffer,1,!0,S.r.FLOAT).addIndex(y._indexBuffer),y}return ut(g,Y),g}(Oe),Eo=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,So=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Ao=function(){function Y(){}return Y.create=function(g){var m=Object.assign({vertex:Eo,fragment:So,geometryClass:or,vertexSize:6},g),y=m.vertex,N=m.fragment,q=m.vertexSize,ht=m.geometryClass;return function(xt){function Tt(Kt){var ee=xt.call(this,Kt)||this;return ee.shaderGenerator=new Mr(y,N),ee.geometryClass=ht,ee.vertexSize=q,ee}return ut(Tt,xt),Tt}(Ar)},Object.defineProperty(Y,"defaultVertexSrc",{get:function(){return Eo},enumerable:!1,configurable:!0}),Object.defineProperty(Y,"defaultFragmentTemplate",{get:function(){return So},enumerable:!1,configurable:!0}),Y}().create()},function(b,E,v){v.r(E),v.d(E,"BaseTextureCache",function(){return _e}),v.d(E,"CanvasRenderTarget",function(){return Ae}),v.d(E,"DATA_URI",function(){return cn}),v.d(E,"ProgramCache",function(){return Jt}),v.d(E,"TextureCache",function(){return at}),v.d(E,"clearTextureCache",function(){return Oe}),v.d(E,"correctBlendMode",function(){return H}),v.d(E,"createIndicesForQuads",function(){return V}),v.d(E,"decomposeDataUri",function(){return Ue}),v.d(E,"deprecation",function(){return Xt}),v.d(E,"destroyTextureCache",function(){return ke}),v.d(E,"determineCrossOrigin",function(){return Ge}),v.d(E,"getBufferType",function(){return B}),v.d(E,"getResolutionOfUrl",function(){return Rn}),v.d(E,"hex2rgb",function(){return U}),v.d(E,"hex2string",function(){return W}),v.d(E,"interleaveTypedArrays",function(){return tt}),v.d(E,"isPow2",function(){return Dt}),v.d(E,"isWebGLSupported",function(){return L}),v.d(E,"log2",function(){return Z}),v.d(E,"nextPow2",function(){return vt}),v.d(E,"premultiplyBlendMode",function(){return $}),v.d(E,"premultiplyRgba",function(){return Nt}),v.d(E,"premultiplyTint",function(){return Vt}),v.d(E,"premultiplyTintToRgba",function(){return st}),v.d(E,"removeItems",function(){return pt}),v.d(E,"rgb2hex",function(){return j}),v.d(E,"sayHello",function(){return St}),v.d(E,"sign",function(){return rt}),v.d(E,"skipHello",function(){return Rt}),v.d(E,"string2hex",function(){return P}),v.d(E,"trimCanvas",function(){return ze}),v.d(E,"uid",function(){return Et}),v.d(E,"url",function(){return X});var O=v(4);v.d(E,"isMobile",function(){return O.a});var S=v(52),I=v.n(S);v.d(E,"EventEmitter",function(){return I.a});var D=v(53),F=v.n(D);v.d(E,"earcut",function(){return F.a});var z=v(36),J=v(0),X={parse:z.parse,format:z.format,resolve:z.resolve};O.b.RETINA_PREFIX=/@([0-9\.]+)x/,O.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var et,ut=!1;function Rt(){ut=!0}function St(re){var pe;if(!ut){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var we=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+re+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(pe=globalThis.console).log.apply(pe,we)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+re+" - http://www.pixijs.com/");ut=!0}}function L(){return et===void 0&&(et=function(){var re={stencil:!0,failIfMajorPerformanceCaveat:O.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var pe=document.createElement("canvas"),we=pe.getContext("webgl",re)||pe.getContext("experimental-webgl",re),ln=!(!we||!we.getContextAttributes().stencil);if(we){var In=we.getExtension("WEBGL_lose_context");In&&In.loseContext()}return we=null,ln}catch{return!1}}()),et}var R={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function U(re,pe){return pe===void 0&&(pe=[]),pe[0]=(re>>16&255)/255,pe[1]=(re>>8&255)/255,pe[2]=(255&re)/255,pe}function W(re){var pe=re.toString(16);return"#"+(pe="000000".substring(0,6-pe.length)+pe)}function P(re){return typeof re=="string"&&(re=R[re.toLowerCase()]||re)[0]==="#"&&(re=re.slice(1)),parseInt(re,16)}function j(re){return(255*re[0]<<16)+(255*re[1]<<8)+(255*re[2]|0)}var $=function(){for(var re=[],pe=[],we=0;we<32;we++)re[we]=we,pe[we]=we;re[J.b.NORMAL_NPM]=J.b.NORMAL,re[J.b.ADD_NPM]=J.b.ADD,re[J.b.SCREEN_NPM]=J.b.SCREEN,pe[J.b.NORMAL]=J.b.NORMAL_NPM,pe[J.b.ADD]=J.b.ADD_NPM,pe[J.b.SCREEN]=J.b.SCREEN_NPM;var ln=[];return ln.push(pe),ln.push(re),ln}();function H(re,pe){return $[pe?1:0][re]}function Nt(re,pe,we,ln){return we=we||new Float32Array(4),ln||ln===void 0?(we[0]=re[0]*pe,we[1]=re[1]*pe,we[2]=re[2]*pe):(we[0]=re[0],we[1]=re[1],we[2]=re[2]),we[3]=pe,we}function Vt(re,pe){if(pe===1)return(255*pe<<24)+re;if(pe===0)return 0;var we=re>>16&255,ln=re>>8&255,In=255&re;return(255*pe<<24)+((we=we*pe+.5|0)<<16)+((ln=ln*pe+.5|0)<<8)+(In=In*pe+.5|0)}function st(re,pe,we,ln){return(we=we||new Float32Array(4))[0]=(re>>16&255)/255,we[1]=(re>>8&255)/255,we[2]=(255&re)/255,(ln||ln===void 0)&&(we[0]*=pe,we[1]*=pe,we[2]*=pe),we[3]=pe,we}function V(re,pe){pe===void 0&&(pe=null);var we=6*re;if((pe=pe||new Uint16Array(we)).length!==we)throw new Error("Out buffer length is incorrect, got "+pe.length+" and expected "+we);for(var ln=0,In=0;ln<we;ln+=6,In+=4)pe[ln+0]=In+0,pe[ln+1]=In+1,pe[ln+2]=In+2,pe[ln+3]=In+0,pe[ln+4]=In+2,pe[ln+5]=In+3;return pe}function B(re){if(re.BYTES_PER_ELEMENT===4)return re instanceof Float32Array?"Float32Array":re instanceof Uint32Array?"Uint32Array":"Int32Array";if(re.BYTES_PER_ELEMENT===2){if(re instanceof Uint16Array)return"Uint16Array"}else if(re.BYTES_PER_ELEMENT===1&&re instanceof Uint8Array)return"Uint8Array";return null}var ft={Float32Array,Uint32Array,Int32Array,Uint8Array};function tt(re,pe){for(var we=0,ln=0,In={},Zn=0;Zn<re.length;Zn++)ln+=pe[Zn],we+=re[Zn].length;var pi=new ArrayBuffer(4*we),tn=null,yt=0;for(Zn=0;Zn<re.length;Zn++){var wt=pe[Zn],It=re[Zn],Qt=B(It);In[Qt]||(In[Qt]=new ft[Qt](pi)),tn=In[Qt];for(var Wt=0;Wt<It.length;Wt++)tn[(Wt/wt|0)*ln+yt+Wt%wt]=It[Wt];yt+=wt}return new Float32Array(pi)}function vt(re){return re+=re===0?1:0,--re,re|=re>>>1,re|=re>>>2,re|=re>>>4,re|=re>>>8,(re|=re>>>16)+1}function Dt(re){return!(re&re-1||!re)}function Z(re){var pe=(re>65535?1:0)<<4,we=((re>>>=pe)>255?1:0)<<3;return pe|=we,pe|=we=((re>>>=we)>15?1:0)<<2,(pe|=we=((re>>>=we)>3?1:0)<<1)|(re>>>=we)>>1}function pt(re,pe,we){var ln,In=re.length;if(!(pe>=In||we===0)){var Zn=In-(we=pe+we>In?In-pe:we);for(ln=pe;ln<Zn;++ln)re[ln]=re[ln+we];re.length=Zn}}function rt(re){return re===0?0:re<0?-1:1}var _t=0;function Et(){return++_t}var Gt={};function Xt(re,pe,we){if(we===void 0&&(we=3),!Gt[pe]){var ln=new Error().stack;ln===void 0?console.warn("PixiJS Deprecation Warning: ",pe+`
Deprecated since v`+re):(ln=ln.split(`
`).splice(we).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",pe+`
Deprecated since v`+re),console.warn(ln),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",pe+`
Deprecated since v`+re),console.warn(ln))),Gt[pe]=!0}}var Jt={},at=Object.create(null),_e=Object.create(null);function ke(){var re;for(re in at)at[re].destroy();for(re in _e)_e[re].destroy()}function Oe(){var re;for(re in at)delete at[re];for(re in _e)delete _e[re]}var Ae=function(){function re(pe,we,ln){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=ln||O.b.RESOLUTION,this.resize(pe,we)}return re.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},re.prototype.resize=function(pe,we){this.canvas.width=Math.round(pe*this.resolution),this.canvas.height=Math.round(we*this.resolution)},re.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(re.prototype,"width",{get:function(){return this.canvas.width},set:function(pe){this.canvas.width=Math.round(pe)},enumerable:!1,configurable:!0}),Object.defineProperty(re.prototype,"height",{get:function(){return this.canvas.height},set:function(pe){this.canvas.height=Math.round(pe)},enumerable:!1,configurable:!0}),re}();function ze(re){var pe,we,ln,In=re.width,Zn=re.height,pi=re.getContext("2d"),tn=pi.getImageData(0,0,In,Zn).data,yt=tn.length,wt={top:null,left:null,right:null,bottom:null},It=null;for(pe=0;pe<yt;pe+=4)tn[pe+3]!==0&&(we=pe/4%In,ln=~~(pe/4/In),wt.top===null&&(wt.top=ln),(wt.left===null||we<wt.left)&&(wt.left=we),(wt.right===null||wt.right<we)&&(wt.right=we+1),(wt.bottom===null||wt.bottom<ln)&&(wt.bottom=ln));return wt.top!==null&&(In=wt.right-wt.left,Zn=wt.bottom-wt.top+1,It=pi.getImageData(wt.left,wt.top,In,Zn)),{height:Zn,width:In,data:It}}var $e,cn=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Ue(re){var pe=cn.exec(re);if(pe)return{mediaType:pe[1]?pe[1].toLowerCase():void 0,subType:pe[2]?pe[2].toLowerCase():void 0,charset:pe[3]?pe[3].toLowerCase():void 0,encoding:pe[4]?pe[4].toLowerCase():void 0,data:pe[5]}}function Ge(re,pe){if(pe===void 0&&(pe=globalThis.location),re.indexOf("data:")===0)return"";pe=pe||globalThis.location,$e||($e=document.createElement("a")),$e.href=re;var we=X.parse($e.href),ln=!we.port&&pe.port===""||we.port===pe.port;return we.hostname===pe.hostname&&ln&&we.protocol===pe.protocol?"":"anonymous"}function Rn(re,pe){var we=O.b.RETINA_PREFIX.exec(re);return we?parseFloat(we[1]):pe!==void 0?pe:1}},function(b,E,v){v.d(E,"a",function(){return Xt}),v.d(E,"b",function(){return Jt});var O=/iPhone/i,S=/iPod/i,I=/iPad/i,D=/\biOS-universal(?:.+)Mac\b/i,F=/\bAndroid(?:.+)Mobile\b/i,z=/Android/i,J=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,X=/Silk/i,et=/Windows Phone/i,ut=/\bWindows(?:.+)ARM\b/i,Rt=/BlackBerry/i,St=/BB10/i,L=/Opera Mini/i,R=/\b(CriOS|Chrome)(?:.+)Mobile/i,U=/Mobile(?:.+)Firefox\b/i,W=function(at){return at!==void 0&&at.platform==="MacIntel"&&typeof at.maxTouchPoints=="number"&&at.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var P,j,$,H,Nt,Vt,st,V,B,ft,tt,vt,Dt,Z,pt,rt,_t,Et,Gt,Xt=function(at){var _e={userAgent:"",platform:"",maxTouchPoints:0};at||typeof navigator=="undefined"?typeof at=="string"?_e.userAgent=at:at&&at.userAgent&&(_e={userAgent:at.userAgent,platform:at.platform,maxTouchPoints:at.maxTouchPoints||0}):_e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var ke=_e.userAgent,Oe=ke.split("[FBAN");Oe[1]!==void 0&&(ke=Oe[0]),(Oe=ke.split("Twitter"))[1]!==void 0&&(ke=Oe[0]);var Ae=function($e){return function(cn){return cn.test($e)}}(ke),ze={apple:{phone:Ae(O)&&!Ae(et),ipod:Ae(S),tablet:!Ae(O)&&(Ae(I)||W(_e))&&!Ae(et),universal:Ae(D),device:(Ae(O)||Ae(S)||Ae(I)||Ae(D)||W(_e))&&!Ae(et)},amazon:{phone:Ae(J),tablet:!Ae(J)&&Ae(X),device:Ae(J)||Ae(X)},android:{phone:!Ae(et)&&Ae(J)||!Ae(et)&&Ae(F),tablet:!Ae(et)&&!Ae(J)&&!Ae(F)&&(Ae(X)||Ae(z)),device:!Ae(et)&&(Ae(J)||Ae(X)||Ae(F)||Ae(z))||Ae(/\bokhttp\b/i)},windows:{phone:Ae(et),tablet:Ae(ut),device:Ae(et)||Ae(ut)},other:{blackberry:Ae(Rt),blackberry10:Ae(St),opera:Ae(L),firefox:Ae(U),chrome:Ae(R),device:Ae(Rt)||Ae(St)||Ae(L)||Ae(U)||Ae(R)},any:!1,phone:!1,tablet:!1};return ze.any=ze.apple.device||ze.android.device||ze.windows.device||ze.other.device,ze.phone=ze.apple.phone||ze.android.phone||ze.windows.phone,ze.tablet=ze.apple.tablet||ze.android.tablet||ze.windows.tablet,ze}(globalThis.navigator);(function(at){at[at.WEBGL_LEGACY=0]="WEBGL_LEGACY",at[at.WEBGL=1]="WEBGL",at[at.WEBGL2=2]="WEBGL2"})(P||(P={})),function(at){at[at.UNKNOWN=0]="UNKNOWN",at[at.WEBGL=1]="WEBGL",at[at.CANVAS=2]="CANVAS"}(j||(j={})),function(at){at[at.COLOR=16384]="COLOR",at[at.DEPTH=256]="DEPTH",at[at.STENCIL=1024]="STENCIL"}($||($={})),function(at){at[at.NORMAL=0]="NORMAL",at[at.ADD=1]="ADD",at[at.MULTIPLY=2]="MULTIPLY",at[at.SCREEN=3]="SCREEN",at[at.OVERLAY=4]="OVERLAY",at[at.DARKEN=5]="DARKEN",at[at.LIGHTEN=6]="LIGHTEN",at[at.COLOR_DODGE=7]="COLOR_DODGE",at[at.COLOR_BURN=8]="COLOR_BURN",at[at.HARD_LIGHT=9]="HARD_LIGHT",at[at.SOFT_LIGHT=10]="SOFT_LIGHT",at[at.DIFFERENCE=11]="DIFFERENCE",at[at.EXCLUSION=12]="EXCLUSION",at[at.HUE=13]="HUE",at[at.SATURATION=14]="SATURATION",at[at.COLOR=15]="COLOR",at[at.LUMINOSITY=16]="LUMINOSITY",at[at.NORMAL_NPM=17]="NORMAL_NPM",at[at.ADD_NPM=18]="ADD_NPM",at[at.SCREEN_NPM=19]="SCREEN_NPM",at[at.NONE=20]="NONE",at[at.SRC_OVER=0]="SRC_OVER",at[at.SRC_IN=21]="SRC_IN",at[at.SRC_OUT=22]="SRC_OUT",at[at.SRC_ATOP=23]="SRC_ATOP",at[at.DST_OVER=24]="DST_OVER",at[at.DST_IN=25]="DST_IN",at[at.DST_OUT=26]="DST_OUT",at[at.DST_ATOP=27]="DST_ATOP",at[at.ERASE=26]="ERASE",at[at.SUBTRACT=28]="SUBTRACT",at[at.XOR=29]="XOR"}(H||(H={})),function(at){at[at.POINTS=0]="POINTS",at[at.LINES=1]="LINES",at[at.LINE_LOOP=2]="LINE_LOOP",at[at.LINE_STRIP=3]="LINE_STRIP",at[at.TRIANGLES=4]="TRIANGLES",at[at.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",at[at.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Nt||(Nt={})),function(at){at[at.RGBA=6408]="RGBA",at[at.RGB=6407]="RGB",at[at.RG=33319]="RG",at[at.RED=6403]="RED",at[at.RGBA_INTEGER=36249]="RGBA_INTEGER",at[at.RGB_INTEGER=36248]="RGB_INTEGER",at[at.RG_INTEGER=33320]="RG_INTEGER",at[at.RED_INTEGER=36244]="RED_INTEGER",at[at.ALPHA=6406]="ALPHA",at[at.LUMINANCE=6409]="LUMINANCE",at[at.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",at[at.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",at[at.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Vt||(Vt={})),function(at){at[at.TEXTURE_2D=3553]="TEXTURE_2D",at[at.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",at[at.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",at[at.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",at[at.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",at[at.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",at[at.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(st||(st={})),function(at){at[at.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",at[at.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",at[at.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",at[at.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",at[at.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",at[at.UNSIGNED_INT=5125]="UNSIGNED_INT",at[at.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",at[at.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",at[at.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",at[at.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",at[at.BYTE=5120]="BYTE",at[at.SHORT=5122]="SHORT",at[at.INT=5124]="INT",at[at.FLOAT=5126]="FLOAT",at[at.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",at[at.HALF_FLOAT=36193]="HALF_FLOAT"}(V||(V={})),function(at){at[at.FLOAT=0]="FLOAT",at[at.INT=1]="INT",at[at.UINT=2]="UINT"}(B||(B={})),function(at){at[at.NEAREST=0]="NEAREST",at[at.LINEAR=1]="LINEAR"}(ft||(ft={})),function(at){at[at.CLAMP=33071]="CLAMP",at[at.REPEAT=10497]="REPEAT",at[at.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(tt||(tt={})),function(at){at[at.OFF=0]="OFF",at[at.POW2=1]="POW2",at[at.ON=2]="ON",at[at.ON_MANUAL=3]="ON_MANUAL"}(vt||(vt={})),function(at){at[at.NPM=0]="NPM",at[at.UNPACK=1]="UNPACK",at[at.PMA=2]="PMA",at[at.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",at[at.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",at[at.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",at[at.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Dt||(Dt={})),function(at){at[at.NO=0]="NO",at[at.YES=1]="YES",at[at.AUTO=2]="AUTO",at[at.BLEND=0]="BLEND",at[at.CLEAR=1]="CLEAR",at[at.BLIT=2]="BLIT"}(Z||(Z={})),function(at){at[at.AUTO=0]="AUTO",at[at.MANUAL=1]="MANUAL"}(pt||(pt={})),function(at){at.LOW="lowp",at.MEDIUM="mediump",at.HIGH="highp"}(rt||(rt={})),function(at){at[at.NONE=0]="NONE",at[at.SCISSOR=1]="SCISSOR",at[at.STENCIL=2]="STENCIL",at[at.SPRITE=3]="SPRITE"}(_t||(_t={})),function(at){at[at.NONE=0]="NONE",at[at.LOW=2]="LOW",at[at.MEDIUM=4]="MEDIUM",at[at.HIGH=8]="HIGH"}(Et||(Et={})),function(at){at[at.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",at[at.ARRAY_BUFFER=34962]="ARRAY_BUFFER",at[at.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Gt||(Gt={}));var Jt={MIPMAP_TEXTURES:vt.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Et.NONE,SPRITE_MAX_TEXTURES:function(at){var _e=!0;if(Xt.tablet||Xt.phone){var ke;Xt.apple.device&&(ke=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(ke[1],10)<11&&(_e=!1),Xt.android.device&&(ke=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(ke[1],10)<7&&(_e=!1)}return _e?at:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:pt.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:tt.CLAMP,SCALE_MODE:ft.LINEAR,PRECISION_VERTEX:rt.HIGH,PRECISION_FRAGMENT:Xt.apple.device?rt.HIGH:rt.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Xt.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},function(b,E,v){v.d(E,"a",function(){return D}),v.d(E,"b",function(){return Dt}),v.d(E,"c",function(){return ft}),v.d(E,"d",function(){return tt});var O=v(4),S=v(1),I=v(3);/*!
 * @pixi/display - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */O.b.SORTABLE_CHILDREN=!1;var D=function(){function Z(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return Z.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Z.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Z.prototype.getRectangle=function(pt){return this.minX>this.maxX||this.minY>this.maxY?S.j.EMPTY:((pt=pt||new S.j(0,0,1,1)).x=this.minX,pt.y=this.minY,pt.width=this.maxX-this.minX,pt.height=this.maxY-this.minY,pt)},Z.prototype.addPoint=function(pt){this.minX=Math.min(this.minX,pt.x),this.maxX=Math.max(this.maxX,pt.x),this.minY=Math.min(this.minY,pt.y),this.maxY=Math.max(this.maxY,pt.y)},Z.prototype.addPointMatrix=function(pt,rt){var _t=pt.a,Et=pt.b,Gt=pt.c,Xt=pt.d,Jt=pt.tx,at=pt.ty,_e=_t*rt.x+Gt*rt.y+Jt,ke=Et*rt.x+Xt*rt.y+at;this.minX=Math.min(this.minX,_e),this.maxX=Math.max(this.maxX,_e),this.minY=Math.min(this.minY,ke),this.maxY=Math.max(this.maxY,ke)},Z.prototype.addQuad=function(pt){var rt=this.minX,_t=this.minY,Et=this.maxX,Gt=this.maxY,Xt=pt[0],Jt=pt[1];rt=Xt<rt?Xt:rt,_t=Jt<_t?Jt:_t,Et=Xt>Et?Xt:Et,Gt=Jt>Gt?Jt:Gt,rt=(Xt=pt[2])<rt?Xt:rt,_t=(Jt=pt[3])<_t?Jt:_t,Et=Xt>Et?Xt:Et,Gt=Jt>Gt?Jt:Gt,rt=(Xt=pt[4])<rt?Xt:rt,_t=(Jt=pt[5])<_t?Jt:_t,Et=Xt>Et?Xt:Et,Gt=Jt>Gt?Jt:Gt,rt=(Xt=pt[6])<rt?Xt:rt,_t=(Jt=pt[7])<_t?Jt:_t,Et=Xt>Et?Xt:Et,Gt=Jt>Gt?Jt:Gt,this.minX=rt,this.minY=_t,this.maxX=Et,this.maxY=Gt},Z.prototype.addFrame=function(pt,rt,_t,Et,Gt){this.addFrameMatrix(pt.worldTransform,rt,_t,Et,Gt)},Z.prototype.addFrameMatrix=function(pt,rt,_t,Et,Gt){var Xt=pt.a,Jt=pt.b,at=pt.c,_e=pt.d,ke=pt.tx,Oe=pt.ty,Ae=this.minX,ze=this.minY,$e=this.maxX,cn=this.maxY,Ue=Xt*rt+at*_t+ke,Ge=Jt*rt+_e*_t+Oe;Ae=Ue<Ae?Ue:Ae,ze=Ge<ze?Ge:ze,$e=Ue>$e?Ue:$e,cn=Ge>cn?Ge:cn,Ae=(Ue=Xt*Et+at*_t+ke)<Ae?Ue:Ae,ze=(Ge=Jt*Et+_e*_t+Oe)<ze?Ge:ze,$e=Ue>$e?Ue:$e,cn=Ge>cn?Ge:cn,Ae=(Ue=Xt*rt+at*Gt+ke)<Ae?Ue:Ae,ze=(Ge=Jt*rt+_e*Gt+Oe)<ze?Ge:ze,$e=Ue>$e?Ue:$e,cn=Ge>cn?Ge:cn,Ae=(Ue=Xt*Et+at*Gt+ke)<Ae?Ue:Ae,ze=(Ge=Jt*Et+_e*Gt+Oe)<ze?Ge:ze,$e=Ue>$e?Ue:$e,cn=Ge>cn?Ge:cn,this.minX=Ae,this.minY=ze,this.maxX=$e,this.maxY=cn},Z.prototype.addVertexData=function(pt,rt,_t){for(var Et=this.minX,Gt=this.minY,Xt=this.maxX,Jt=this.maxY,at=rt;at<_t;at+=2){var _e=pt[at],ke=pt[at+1];Et=_e<Et?_e:Et,Gt=ke<Gt?ke:Gt,Xt=_e>Xt?_e:Xt,Jt=ke>Jt?ke:Jt}this.minX=Et,this.minY=Gt,this.maxX=Xt,this.maxY=Jt},Z.prototype.addVertices=function(pt,rt,_t,Et){this.addVerticesMatrix(pt.worldTransform,rt,_t,Et)},Z.prototype.addVerticesMatrix=function(pt,rt,_t,Et,Gt,Xt){Gt===void 0&&(Gt=0),Xt===void 0&&(Xt=Gt);for(var Jt=pt.a,at=pt.b,_e=pt.c,ke=pt.d,Oe=pt.tx,Ae=pt.ty,ze=this.minX,$e=this.minY,cn=this.maxX,Ue=this.maxY,Ge=_t;Ge<Et;Ge+=2){var Rn=rt[Ge],re=rt[Ge+1],pe=Jt*Rn+_e*re+Oe,we=ke*re+at*Rn+Ae;ze=Math.min(ze,pe-Gt),cn=Math.max(cn,pe+Gt),$e=Math.min($e,we-Xt),Ue=Math.max(Ue,we+Xt)}this.minX=ze,this.minY=$e,this.maxX=cn,this.maxY=Ue},Z.prototype.addBounds=function(pt){var rt=this.minX,_t=this.minY,Et=this.maxX,Gt=this.maxY;this.minX=pt.minX<rt?pt.minX:rt,this.minY=pt.minY<_t?pt.minY:_t,this.maxX=pt.maxX>Et?pt.maxX:Et,this.maxY=pt.maxY>Gt?pt.maxY:Gt},Z.prototype.addBoundsMask=function(pt,rt){var _t=pt.minX>rt.minX?pt.minX:rt.minX,Et=pt.minY>rt.minY?pt.minY:rt.minY,Gt=pt.maxX<rt.maxX?pt.maxX:rt.maxX,Xt=pt.maxY<rt.maxY?pt.maxY:rt.maxY;if(_t<=Gt&&Et<=Xt){var Jt=this.minX,at=this.minY,_e=this.maxX,ke=this.maxY;this.minX=_t<Jt?_t:Jt,this.minY=Et<at?Et:at,this.maxX=Gt>_e?Gt:_e,this.maxY=Xt>ke?Xt:ke}},Z.prototype.addBoundsMatrix=function(pt,rt){this.addFrameMatrix(rt,pt.minX,pt.minY,pt.maxX,pt.maxY)},Z.prototype.addBoundsArea=function(pt,rt){var _t=pt.minX>rt.x?pt.minX:rt.x,Et=pt.minY>rt.y?pt.minY:rt.y,Gt=pt.maxX<rt.x+rt.width?pt.maxX:rt.x+rt.width,Xt=pt.maxY<rt.y+rt.height?pt.maxY:rt.y+rt.height;if(_t<=Gt&&Et<=Xt){var Jt=this.minX,at=this.minY,_e=this.maxX,ke=this.maxY;this.minX=_t<Jt?_t:Jt,this.minY=Et<at?Et:at,this.maxX=Gt>_e?Gt:_e,this.maxY=Xt>ke?Xt:ke}},Z.prototype.pad=function(pt,rt){pt===void 0&&(pt=0),rt===void 0&&(rt=pt),this.isEmpty()||(this.minX-=pt,this.maxX+=pt,this.minY-=rt,this.maxY+=rt)},Z.prototype.addFramePad=function(pt,rt,_t,Et,Gt,Xt){pt-=Gt,rt-=Xt,_t+=Gt,Et+=Xt,this.minX=this.minX<pt?this.minX:pt,this.maxX=this.maxX>_t?this.maxX:_t,this.minY=this.minY<rt?this.minY:rt,this.maxY=this.maxY>Et?this.maxY:Et},Z}(),F=function(Z,pt){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(rt,_t){rt.__proto__=_t}||function(rt,_t){for(var Et in _t)_t.hasOwnProperty(Et)&&(rt[Et]=_t[Et])})(Z,pt)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function z(Z,pt){function rt(){this.constructor=Z}F(Z,pt),Z.prototype=pt===null?Object.create(pt):(rt.prototype=pt.prototype,new rt)}var J,X,et,ut,Rt,St,L,R,U,W,P,j,$,H,Nt,Vt,st,V,B,ft=function(Z){function pt(){var rt=Z.call(this)||this;return rt.tempDisplayObjectParent=null,rt.transform=new S.m,rt.alpha=1,rt.visible=!0,rt.renderable=!0,rt.cullable=!1,rt.cullArea=null,rt.parent=null,rt.worldAlpha=1,rt._lastSortedIndex=0,rt._zIndex=0,rt.filterArea=null,rt.filters=null,rt._enabledFilters=null,rt._bounds=new D,rt._localBounds=null,rt._boundsID=0,rt._boundsRect=null,rt._localBoundsRect=null,rt._mask=null,rt._maskRefCount=0,rt._destroyed=!1,rt.isSprite=!1,rt.isMask=!1,rt}return z(pt,Z),pt.mixin=function(rt){for(var _t=Object.keys(rt),Et=0;Et<_t.length;++Et){var Gt=_t[Et];Object.defineProperty(pt.prototype,Gt,Object.getOwnPropertyDescriptor(rt,Gt))}},Object.defineProperty(pt.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),pt.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},pt.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},pt.prototype.getBounds=function(rt,_t){return rt||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),_t||(this._boundsRect||(this._boundsRect=new S.j),_t=this._boundsRect),this._bounds.getRectangle(_t)},pt.prototype.getLocalBounds=function(rt){rt||(this._localBoundsRect||(this._localBoundsRect=new S.j),rt=this._localBoundsRect),this._localBounds||(this._localBounds=new D);var _t=this.transform,Et=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var Gt=this._bounds,Xt=this._boundsID;this._bounds=this._localBounds;var Jt=this.getBounds(!1,rt);return this.parent=Et,this.transform=_t,this._bounds=Gt,this._bounds.updateID+=this._boundsID-Xt,Jt},pt.prototype.toGlobal=function(rt,_t,Et){return Et===void 0&&(Et=!1),Et||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(rt,_t)},pt.prototype.toLocal=function(rt,_t,Et,Gt){return _t&&(rt=_t.toGlobal(rt,Et,Gt)),Gt||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(rt,Et)},pt.prototype.setParent=function(rt){if(!rt||!rt.addChild)throw new Error("setParent: Argument must be a Container");return rt.addChild(this),rt},pt.prototype.setTransform=function(rt,_t,Et,Gt,Xt,Jt,at,_e,ke){return rt===void 0&&(rt=0),_t===void 0&&(_t=0),Et===void 0&&(Et=1),Gt===void 0&&(Gt=1),Xt===void 0&&(Xt=0),Jt===void 0&&(Jt=0),at===void 0&&(at=0),_e===void 0&&(_e=0),ke===void 0&&(ke=0),this.position.x=rt,this.position.y=_t,this.scale.x=Et||1,this.scale.y=Gt||1,this.rotation=Xt,this.skew.x=Jt,this.skew.y=at,this.pivot.x=_e,this.pivot.y=ke,this},pt.prototype.destroy=function(rt){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(pt.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new tt),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),pt.prototype.enableTempParent=function(){var rt=this.parent;return this.parent=this._tempDisplayObjectParent,rt},pt.prototype.disableTempParent=function(rt){this.parent=rt},Object.defineProperty(pt.prototype,"x",{get:function(){return this.position.x},set:function(rt){this.transform.position.x=rt},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"y",{get:function(){return this.position.y},set:function(rt){this.transform.position.y=rt},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"position",{get:function(){return this.transform.position},set:function(rt){this.transform.position.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"scale",{get:function(){return this.transform.scale},set:function(rt){this.transform.scale.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(rt){this.transform.pivot.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"skew",{get:function(){return this.transform.skew},set:function(rt){this.transform.skew.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(rt){this.transform.rotation=rt},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"angle",{get:function(){return this.transform.rotation*S.i},set:function(rt){this.transform.rotation=rt*S.b},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"zIndex",{get:function(){return this._zIndex},set:function(rt){this._zIndex=rt,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"worldVisible",{get:function(){var rt=this;do{if(!rt.visible)return!1;rt=rt.parent}while(rt);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"mask",{get:function(){return this._mask},set:function(rt){if(this._mask!==rt){var _t;this._mask&&((_t=this._mask.maskObject||this._mask)._maskRefCount--,_t._maskRefCount===0&&(_t.renderable=!0,_t.isMask=!1)),this._mask=rt,this._mask&&((_t=this._mask.maskObject||this._mask)._maskRefCount===0&&(_t.renderable=!1,_t.isMask=!0),_t._maskRefCount++)}},enumerable:!1,configurable:!0}),pt}(I.EventEmitter),tt=function(Z){function pt(){var rt=Z!==null&&Z.apply(this,arguments)||this;return rt.sortDirty=null,rt}return z(pt,Z),pt}(ft);function vt(Z,pt){return Z.zIndex===pt.zIndex?Z._lastSortedIndex-pt._lastSortedIndex:Z.zIndex-pt.zIndex}ft.prototype.displayObjectUpdateTransform=ft.prototype.updateTransform,function(Z){Z[Z.WEBGL_LEGACY=0]="WEBGL_LEGACY",Z[Z.WEBGL=1]="WEBGL",Z[Z.WEBGL2=2]="WEBGL2"}(J||(J={})),function(Z){Z[Z.UNKNOWN=0]="UNKNOWN",Z[Z.WEBGL=1]="WEBGL",Z[Z.CANVAS=2]="CANVAS"}(X||(X={})),function(Z){Z[Z.COLOR=16384]="COLOR",Z[Z.DEPTH=256]="DEPTH",Z[Z.STENCIL=1024]="STENCIL"}(et||(et={})),function(Z){Z[Z.NORMAL=0]="NORMAL",Z[Z.ADD=1]="ADD",Z[Z.MULTIPLY=2]="MULTIPLY",Z[Z.SCREEN=3]="SCREEN",Z[Z.OVERLAY=4]="OVERLAY",Z[Z.DARKEN=5]="DARKEN",Z[Z.LIGHTEN=6]="LIGHTEN",Z[Z.COLOR_DODGE=7]="COLOR_DODGE",Z[Z.COLOR_BURN=8]="COLOR_BURN",Z[Z.HARD_LIGHT=9]="HARD_LIGHT",Z[Z.SOFT_LIGHT=10]="SOFT_LIGHT",Z[Z.DIFFERENCE=11]="DIFFERENCE",Z[Z.EXCLUSION=12]="EXCLUSION",Z[Z.HUE=13]="HUE",Z[Z.SATURATION=14]="SATURATION",Z[Z.COLOR=15]="COLOR",Z[Z.LUMINOSITY=16]="LUMINOSITY",Z[Z.NORMAL_NPM=17]="NORMAL_NPM",Z[Z.ADD_NPM=18]="ADD_NPM",Z[Z.SCREEN_NPM=19]="SCREEN_NPM",Z[Z.NONE=20]="NONE",Z[Z.SRC_OVER=0]="SRC_OVER",Z[Z.SRC_IN=21]="SRC_IN",Z[Z.SRC_OUT=22]="SRC_OUT",Z[Z.SRC_ATOP=23]="SRC_ATOP",Z[Z.DST_OVER=24]="DST_OVER",Z[Z.DST_IN=25]="DST_IN",Z[Z.DST_OUT=26]="DST_OUT",Z[Z.DST_ATOP=27]="DST_ATOP",Z[Z.ERASE=26]="ERASE",Z[Z.SUBTRACT=28]="SUBTRACT",Z[Z.XOR=29]="XOR"}(ut||(ut={})),function(Z){Z[Z.POINTS=0]="POINTS",Z[Z.LINES=1]="LINES",Z[Z.LINE_LOOP=2]="LINE_LOOP",Z[Z.LINE_STRIP=3]="LINE_STRIP",Z[Z.TRIANGLES=4]="TRIANGLES",Z[Z.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Z[Z.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Rt||(Rt={})),function(Z){Z[Z.RGBA=6408]="RGBA",Z[Z.RGB=6407]="RGB",Z[Z.RG=33319]="RG",Z[Z.RED=6403]="RED",Z[Z.RGBA_INTEGER=36249]="RGBA_INTEGER",Z[Z.RGB_INTEGER=36248]="RGB_INTEGER",Z[Z.RG_INTEGER=33320]="RG_INTEGER",Z[Z.RED_INTEGER=36244]="RED_INTEGER",Z[Z.ALPHA=6406]="ALPHA",Z[Z.LUMINANCE=6409]="LUMINANCE",Z[Z.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Z[Z.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Z[Z.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(St||(St={})),function(Z){Z[Z.TEXTURE_2D=3553]="TEXTURE_2D",Z[Z.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Z[Z.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(L||(L={})),function(Z){Z[Z.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Z[Z.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Z[Z.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",Z[Z.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Z[Z.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Z[Z.UNSIGNED_INT=5125]="UNSIGNED_INT",Z[Z.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",Z[Z.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",Z[Z.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",Z[Z.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",Z[Z.BYTE=5120]="BYTE",Z[Z.SHORT=5122]="SHORT",Z[Z.INT=5124]="INT",Z[Z.FLOAT=5126]="FLOAT",Z[Z.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",Z[Z.HALF_FLOAT=36193]="HALF_FLOAT"}(R||(R={})),function(Z){Z[Z.FLOAT=0]="FLOAT",Z[Z.INT=1]="INT",Z[Z.UINT=2]="UINT"}(U||(U={})),function(Z){Z[Z.NEAREST=0]="NEAREST",Z[Z.LINEAR=1]="LINEAR"}(W||(W={})),function(Z){Z[Z.CLAMP=33071]="CLAMP",Z[Z.REPEAT=10497]="REPEAT",Z[Z.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(P||(P={})),function(Z){Z[Z.OFF=0]="OFF",Z[Z.POW2=1]="POW2",Z[Z.ON=2]="ON",Z[Z.ON_MANUAL=3]="ON_MANUAL"}(j||(j={})),function(Z){Z[Z.NPM=0]="NPM",Z[Z.UNPACK=1]="UNPACK",Z[Z.PMA=2]="PMA",Z[Z.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Z[Z.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Z[Z.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",Z[Z.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}($||($={})),function(Z){Z[Z.NO=0]="NO",Z[Z.YES=1]="YES",Z[Z.AUTO=2]="AUTO",Z[Z.BLEND=0]="BLEND",Z[Z.CLEAR=1]="CLEAR",Z[Z.BLIT=2]="BLIT"}(H||(H={})),function(Z){Z[Z.AUTO=0]="AUTO",Z[Z.MANUAL=1]="MANUAL"}(Nt||(Nt={})),function(Z){Z.LOW="lowp",Z.MEDIUM="mediump",Z.HIGH="highp"}(Vt||(Vt={})),function(Z){Z[Z.NONE=0]="NONE",Z[Z.SCISSOR=1]="SCISSOR",Z[Z.STENCIL=2]="STENCIL",Z[Z.SPRITE=3]="SPRITE"}(st||(st={})),function(Z){Z[Z.NONE=0]="NONE",Z[Z.LOW=2]="LOW",Z[Z.MEDIUM=4]="MEDIUM",Z[Z.HIGH=8]="HIGH"}(V||(V={})),function(Z){Z[Z.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",Z[Z.ARRAY_BUFFER=34962]="ARRAY_BUFFER",Z[Z.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(B||(B={}));var Dt=function(Z){function pt(){var rt=Z.call(this)||this;return rt.children=[],rt.sortableChildren=O.b.SORTABLE_CHILDREN,rt.sortDirty=!1,rt}return z(pt,Z),pt.prototype.onChildrenChange=function(rt){},pt.prototype.addChild=function(){for(var rt=arguments,_t=[],Et=0;Et<arguments.length;Et++)_t[Et]=rt[Et];if(_t.length>1)for(var Gt=0;Gt<_t.length;Gt++)this.addChild(_t[Gt]);else{var Xt=_t[0];Xt.parent&&Xt.parent.removeChild(Xt),Xt.parent=this,this.sortDirty=!0,Xt.transform._parentID=-1,this.children.push(Xt),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",Xt,this,this.children.length-1),Xt.emit("added",this)}return _t[0]},pt.prototype.addChildAt=function(rt,_t){if(_t<0||_t>this.children.length)throw new Error(rt+"addChildAt: The index "+_t+" supplied is out of bounds "+this.children.length);return rt.parent&&rt.parent.removeChild(rt),rt.parent=this,this.sortDirty=!0,rt.transform._parentID=-1,this.children.splice(_t,0,rt),this._boundsID++,this.onChildrenChange(_t),rt.emit("added",this),this.emit("childAdded",rt,this,_t),rt},pt.prototype.swapChildren=function(rt,_t){if(rt!==_t){var Et=this.getChildIndex(rt),Gt=this.getChildIndex(_t);this.children[Et]=_t,this.children[Gt]=rt,this.onChildrenChange(Et<Gt?Et:Gt)}},pt.prototype.getChildIndex=function(rt){var _t=this.children.indexOf(rt);if(_t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return _t},pt.prototype.setChildIndex=function(rt,_t){if(_t<0||_t>=this.children.length)throw new Error("The index "+_t+" supplied is out of bounds "+this.children.length);var Et=this.getChildIndex(rt);Object(I.removeItems)(this.children,Et,1),this.children.splice(_t,0,rt),this.onChildrenChange(_t)},pt.prototype.getChildAt=function(rt){if(rt<0||rt>=this.children.length)throw new Error("getChildAt: Index ("+rt+") does not exist.");return this.children[rt]},pt.prototype.removeChild=function(){for(var rt=arguments,_t=[],Et=0;Et<arguments.length;Et++)_t[Et]=rt[Et];if(_t.length>1)for(var Gt=0;Gt<_t.length;Gt++)this.removeChild(_t[Gt]);else{var Xt=_t[0],Jt=this.children.indexOf(Xt);if(Jt===-1)return null;Xt.parent=null,Xt.transform._parentID=-1,Object(I.removeItems)(this.children,Jt,1),this._boundsID++,this.onChildrenChange(Jt),Xt.emit("removed",this),this.emit("childRemoved",Xt,this,Jt)}return _t[0]},pt.prototype.removeChildAt=function(rt){var _t=this.getChildAt(rt);return _t.parent=null,_t.transform._parentID=-1,Object(I.removeItems)(this.children,rt,1),this._boundsID++,this.onChildrenChange(rt),_t.emit("removed",this),this.emit("childRemoved",_t,this,rt),_t},pt.prototype.removeChildren=function(rt,_t){rt===void 0&&(rt=0),_t===void 0&&(_t=this.children.length);var Et,Gt=rt,Xt=_t-Gt;if(Xt>0&&Xt<=_t){Et=this.children.splice(Gt,Xt);for(var Jt=0;Jt<Et.length;++Jt)Et[Jt].parent=null,Et[Jt].transform&&(Et[Jt].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(rt),Jt=0;Jt<Et.length;++Jt)Et[Jt].emit("removed",this),this.emit("childRemoved",Et[Jt],this,Jt);return Et}if(Xt===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},pt.prototype.sortChildren=function(){for(var rt=!1,_t=0,Et=this.children.length;_t<Et;++_t){var Gt=this.children[_t];Gt._lastSortedIndex=_t,rt||Gt.zIndex===0||(rt=!0)}rt&&this.children.length>1&&this.children.sort(vt),this.sortDirty=!1},pt.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var rt=0,_t=this.children.length;rt<_t;++rt){var Et=this.children[rt];Et.visible&&Et.updateTransform()}},pt.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var rt=0;rt<this.children.length;rt++){var _t=this.children[rt];if(_t.visible&&_t.renderable)if(_t.calculateBounds(),_t._mask){var Et=_t._mask.maskObject||_t._mask;Et.calculateBounds(),this._bounds.addBoundsMask(_t._bounds,Et._bounds)}else _t.filterArea?this._bounds.addBoundsArea(_t._bounds,_t.filterArea):this._bounds.addBounds(_t._bounds)}this._bounds.updateID=this._boundsID},pt.prototype.getLocalBounds=function(rt,_t){_t===void 0&&(_t=!1);var Et=Z.prototype.getLocalBounds.call(this,rt);if(!_t)for(var Gt=0,Xt=this.children.length;Gt<Xt;++Gt){var Jt=this.children[Gt];Jt.visible&&Jt.updateTransform()}return Et},pt.prototype._calculateBounds=function(){},pt.prototype._renderWithCulling=function(rt){var _t=rt.renderTexture.sourceFrame;if(_t.width>0&&_t.height>0){var Et,Gt;if(this.cullArea?(Et=this.cullArea,Gt=this.worldTransform):this._render!==pt.prototype._render&&(Et=this.getBounds(!0)),Et&&_t.intersects(Et,Gt))this._render(rt);else if(this.cullArea)return;for(var Xt=0,Jt=this.children.length;Xt<Jt;++Xt){var at=this.children[Xt],_e=at.cullable;at.cullable=_e||!this.cullArea,at.render(rt),at.cullable=_e}}},pt.prototype.render=function(rt){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(rt);else if(this.cullable)this._renderWithCulling(rt);else{this._render(rt);for(var _t=0,Et=this.children.length;_t<Et;++_t)this.children[_t].render(rt)}},pt.prototype.renderAdvanced=function(rt){var _t=this.filters,Et=this._mask;if(_t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var Gt=0;Gt<_t.length;Gt++)_t[Gt].enabled&&this._enabledFilters.push(_t[Gt])}var Xt=_t&&this._enabledFilters&&this._enabledFilters.length||Et&&(!Et.isMaskData||Et.enabled&&(Et.autoDetect||Et.type!==st.NONE));if(Xt&&rt.batch.flush(),_t&&this._enabledFilters&&this._enabledFilters.length&&rt.filter.push(this,this._enabledFilters),Et&&rt.mask.push(this,this._mask),this.cullable)this._renderWithCulling(rt);else{this._render(rt),Gt=0;for(var Jt=this.children.length;Gt<Jt;++Gt)this.children[Gt].render(rt)}Xt&&rt.batch.flush(),Et&&rt.mask.pop(this),_t&&this._enabledFilters&&this._enabledFilters.length&&rt.filter.pop()},pt.prototype._render=function(rt){},pt.prototype.destroy=function(rt){Z.prototype.destroy.call(this),this.sortDirty=!1;var _t=typeof rt=="boolean"?rt:rt&&rt.children,Et=this.removeChildren(0,this.children.length);if(_t)for(var Gt=0;Gt<Et.length;++Gt)Et[Gt].destroy(rt)},Object.defineProperty(pt.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(rt){var _t=this.getLocalBounds().width;this.scale.x=_t!==0?rt/_t:1,this._width=rt},enumerable:!1,configurable:!0}),Object.defineProperty(pt.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(rt){var _t=this.getLocalBounds().height;this.scale.y=_t!==0?rt/_t:1,this._height=rt},enumerable:!1,configurable:!0}),pt}(ft);Dt.prototype.containerUpdateTransform=Dt.prototype.updateTransform},function(b,E,v){var O=Object.prototype.hasOwnProperty,S="~";function I(){}function D(X,et,ut){this.fn=X,this.context=et,this.once=ut||!1}function F(X,et,ut,Rt,St){if(typeof ut!="function")throw new TypeError("The listener must be a function");var L=new D(ut,Rt||X,St),R=S?S+et:et;return X._events[R]?X._events[R].fn?X._events[R]=[X._events[R],L]:X._events[R].push(L):(X._events[R]=L,X._eventsCount++),X}function z(X,et){--X._eventsCount==0?X._events=new I:delete X._events[et]}function J(){this._events=new I,this._eventsCount=0}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(S=!1)),J.prototype.eventNames=function(){var X,et,ut=[];if(this._eventsCount===0)return ut;for(et in X=this._events)O.call(X,et)&&ut.push(S?et.slice(1):et);return Object.getOwnPropertySymbols?ut.concat(Object.getOwnPropertySymbols(X)):ut},J.prototype.listeners=function(X){var et=S?S+X:X,ut=this._events[et];if(!ut)return[];if(ut.fn)return[ut.fn];for(var Rt=0,St=ut.length,L=new Array(St);Rt<St;Rt++)L[Rt]=ut[Rt].fn;return L},J.prototype.listenerCount=function(X){var et=S?S+X:X,ut=this._events[et];return ut?ut.fn?1:ut.length:0},J.prototype.emit=function(X,et,ut,Rt,St,L){var R=S?S+X:X;if(!this._events[R])return!1;var U,W,P=this._events[R],j=arguments.length;if(P.fn){switch(P.once&&this.removeListener(X,P.fn,void 0,!0),j){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,et),!0;case 3:return P.fn.call(P.context,et,ut),!0;case 4:return P.fn.call(P.context,et,ut,Rt),!0;case 5:return P.fn.call(P.context,et,ut,Rt,St),!0;case 6:return P.fn.call(P.context,et,ut,Rt,St,L),!0}for(W=1,U=new Array(j-1);W<j;W++)U[W-1]=arguments[W];P.fn.apply(P.context,U)}else{var $,H=P.length;for(W=0;W<H;W++)switch(P[W].once&&this.removeListener(X,P[W].fn,void 0,!0),j){case 1:P[W].fn.call(P[W].context);break;case 2:P[W].fn.call(P[W].context,et);break;case 3:P[W].fn.call(P[W].context,et,ut);break;case 4:P[W].fn.call(P[W].context,et,ut,Rt);break;default:if(!U)for($=1,U=new Array(j-1);$<j;$++)U[$-1]=arguments[$];P[W].fn.apply(P[W].context,U)}}return!0},J.prototype.on=function(X,et,ut){return F(this,X,et,ut,!1)},J.prototype.once=function(X,et,ut){return F(this,X,et,ut,!0)},J.prototype.removeListener=function(X,et,ut,Rt){var St=S?S+X:X;if(!this._events[St])return this;if(!et)return z(this,St),this;var L=this._events[St];if(L.fn)L.fn!==et||Rt&&!L.once||ut&&L.context!==ut||z(this,St);else{for(var R=0,U=[],W=L.length;R<W;R++)(L[R].fn!==et||Rt&&!L[R].once||ut&&L[R].context!==ut)&&U.push(L[R]);U.length?this._events[St]=U.length===1?U[0]:U:z(this,St)}return this},J.prototype.removeAllListeners=function(X){var et;return X?(et=S?S+X:X,this._events[et]&&z(this,et)):(this._events=new I,this._eventsCount=0),this},J.prototype.off=J.prototype.removeListener,J.prototype.addListener=J.prototype.on,J.prefixed=S,J.EventEmitter=J,b.exports=J},function(b,E,v){v.d(E,"a",function(){return D}),v.d(E,"b",function(){return F}),v.d(E,"c",function(){return O});var O,S=v(4);/*!
 * @pixi/ticker - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */S.b.TARGET_FPMS=.06,function(z){z[z.INTERACTION=50]="INTERACTION",z[z.HIGH=25]="HIGH",z[z.NORMAL=0]="NORMAL",z[z.LOW=-25]="LOW",z[z.UTILITY=-50]="UTILITY"}(O||(O={}));var I=function(){function z(J,X,et,ut){X===void 0&&(X=null),et===void 0&&(et=0),ut===void 0&&(ut=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=J,this.context=X,this.priority=et,this.once=ut}return z.prototype.match=function(J,X){return X===void 0&&(X=null),this.fn===J&&this.context===X},z.prototype.emit=function(J){this.fn&&(this.context?this.fn.call(this.context,J):this.fn(J));var X=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),X},z.prototype.connect=function(J){this.previous=J,J.next&&(J.next.previous=this),this.next=J.next,J.next=this},z.prototype.destroy=function(J){J===void 0&&(J=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var X=this.next;return this.next=J?null:X,this.previous=null,X},z}(),D=function(){function z(){var J=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new I(null,null,1/0),this.deltaMS=1/S.b.TARGET_FPMS,this.elapsedMS=1/S.b.TARGET_FPMS,this._tick=function(X){J._requestId=null,J.started&&(J.update(X),J.started&&J._requestId===null&&J._head.next&&(J._requestId=requestAnimationFrame(J._tick)))}}return z.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},z.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},z.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},z.prototype.add=function(J,X,et){return et===void 0&&(et=O.NORMAL),this._addListener(new I(J,X,et))},z.prototype.addOnce=function(J,X,et){return et===void 0&&(et=O.NORMAL),this._addListener(new I(J,X,et,!0))},z.prototype._addListener=function(J){var X=this._head.next,et=this._head;if(X){for(;X;){if(J.priority>X.priority){J.connect(et);break}et=X,X=X.next}J.previous||J.connect(et)}else J.connect(et);return this._startIfPossible(),this},z.prototype.remove=function(J,X){for(var et=this._head.next;et;)et=et.match(J,X)?et.destroy():et.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(z.prototype,"count",{get:function(){if(!this._head)return 0;for(var J=0,X=this._head;X=X.next;)J++;return J},enumerable:!1,configurable:!0}),z.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},z.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},z.prototype.destroy=function(){if(!this._protected){this.stop();for(var J=this._head.next;J;)J=J.destroy(!0);this._head.destroy(),this._head=null}},z.prototype.update=function(J){var X;if(J===void 0&&(J=performance.now()),J>this.lastTime){if((X=this.elapsedMS=J-this.lastTime)>this._maxElapsedMS&&(X=this._maxElapsedMS),X*=this.speed,this._minElapsedMS){var et=J-this._lastFrame|0;if(et<this._minElapsedMS)return;this._lastFrame=J-et%this._minElapsedMS}this.deltaMS=X,this.deltaTime=this.deltaMS*S.b.TARGET_FPMS;for(var ut=this._head,Rt=ut.next;Rt;)Rt=Rt.emit(this.deltaTime);ut.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=J},Object.defineProperty(z.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(J){var X=Math.min(this.maxFPS,J),et=Math.min(Math.max(0,X)/1e3,S.b.TARGET_FPMS);this._maxElapsedMS=1/et},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(J){if(J===0)this._minElapsedMS=0;else{var X=Math.max(this.minFPS,J);this._minElapsedMS=1/(X/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(z,"shared",{get:function(){if(!z._shared){var J=z._shared=new z;J.autoStart=!0,J._protected=!0}return z._shared},enumerable:!1,configurable:!0}),Object.defineProperty(z,"system",{get:function(){if(!z._system){var J=z._system=new z;J.autoStart=!0,J._protected=!0}return z._system},enumerable:!1,configurable:!0}),z}(),F=function(){function z(){}return z.init=function(J){var X=this;J=Object.assign({autoStart:!0,sharedTicker:!1},J),Object.defineProperty(this,"ticker",{set:function(et){this._ticker&&this._ticker.remove(this.render,this),this._ticker=et,et&&et.add(this.render,this,O.LOW)},get:function(){return this._ticker}}),this.stop=function(){X._ticker.stop()},this.start=function(){X._ticker.start()},this._ticker=null,this.ticker=J.sharedTicker?D.shared:new D,J.autoStart&&this.start()},z.destroy=function(){if(this._ticker){var J=this._ticker;this.ticker=null,J.destroy()}},z}()},function(b,E,v){v.d(E,"a",function(){return St}),v.d(E,"b",function(){return R}),v.d(E,"c",function(){return L});var O=v(2),S=v(1),I=v(0),D=v(5),F=v(4),z=v(3),J=function(U,W){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,j){P.__proto__=j}||function(P,j){for(var $ in j)j.hasOwnProperty($)&&(P[$]=j[$])})(U,W)};function X(U,W){function P(){this.constructor=U}J(U,W),U.prototype=W===null?Object.create(W):(P.prototype=W.prototype,new P)}var et=function(){function U(W,P){this.uvBuffer=W,this.uvMatrix=P,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return U.prototype.update=function(W){if(W||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var P=this.uvBuffer.data;this.data&&this.data.length===P.length||(this.data=new Float32Array(P.length)),this.uvMatrix.multiplyUvs(P,this.data),this._updateID++}},U}(),ut=new S.g,Rt=new S.h,St=function(U){function W(P,j,$,H){H===void 0&&(H=I.f.TRIANGLES);var Nt=U.call(this)||this;return Nt.geometry=P,Nt.shader=j,Nt.state=$||O.s.for2d(),Nt.drawMode=H,Nt.start=0,Nt.size=0,Nt.uvs=null,Nt.indices=null,Nt.vertexData=new Float32Array(1),Nt.vertexDirty=-1,Nt._transformID=-1,Nt._roundPixels=F.b.ROUND_PIXELS,Nt.batchUvs=null,Nt}return X(W,U),Object.defineProperty(W.prototype,"geometry",{get:function(){return this._geometry},set:function(P){this._geometry!==P&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=P,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"material",{get:function(){return this.shader},set:function(P){this.shader=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(P){this.state.blendMode=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(P){this._roundPixels!==P&&(this._transformID=-1),this._roundPixels=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(P){this.shader.tint=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(P){this.shader.texture=P},enumerable:!1,configurable:!0}),W.prototype._render=function(P){var j=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===I.f.TRIANGLES&&j.length<2*W.BATCHABLE_SIZE?this._renderToBatch(P):this._renderDefault(P)},W.prototype._renderDefault=function(P){var j=this.shader;j.alpha=this.worldAlpha,j.update&&j.update(),P.batch.flush(),j.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),P.shader.bind(j),P.state.set(this.state),P.geometry.bind(this.geometry,j),P.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},W.prototype._renderToBatch=function(P){var j=this.geometry,$=this.shader;$.uvMatrix&&($.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=j.indexBuffer.data,this._tintRGB=$._tintRGB,this._texture=$.texture;var H=this.material.pluginName;P.batch.setObjectRenderer(P.plugins[H]),P.plugins[H].render(this)},W.prototype.calculateVertices=function(){var P=this.geometry.buffers[0],j=P.data,$=P._updateID;if($!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==j.length&&(this.vertexData=new Float32Array(j.length));for(var H=this.transform.worldTransform,Nt=H.a,Vt=H.b,st=H.c,V=H.d,B=H.tx,ft=H.ty,tt=this.vertexData,vt=0;vt<tt.length/2;vt++){var Dt=j[2*vt],Z=j[2*vt+1];tt[2*vt]=Nt*Dt+st*Z+B,tt[2*vt+1]=Vt*Dt+V*Z+ft}if(this._roundPixels){var pt=F.b.RESOLUTION;for(vt=0;vt<tt.length;++vt)tt[vt]=Math.round((tt[vt]*pt|0)/pt)}this.vertexDirty=$}},W.prototype.calculateUvs=function(){var P=this.geometry.buffers[1],j=this.shader;j.uvMatrix.isSimple?this.uvs=P.data:(this.batchUvs||(this.batchUvs=new et(P,j.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},W.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},W.prototype.containsPoint=function(P){if(!this.getBounds().contains(P.x,P.y))return!1;this.worldTransform.applyInverse(P,ut);for(var j=this.geometry.getBuffer("aVertexPosition").data,$=Rt.points,H=this.geometry.getIndex().data,Nt=H.length,Vt=this.drawMode===4?3:1,st=0;st+2<Nt;st+=Vt){var V=2*H[st],B=2*H[st+1],ft=2*H[st+2];if($[0]=j[V],$[1]=j[V+1],$[2]=j[B],$[3]=j[B+1],$[4]=j[ft],$[5]=j[ft+1],Rt.contains(ut.x,ut.y))return!0}return!1},W.prototype.destroy=function(P){U.prototype.destroy.call(this,P),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},W.BATCHABLE_SIZE=100,W}(D.b),L=function(U){function W(P,j){var $=this,H={uSampler:P,alpha:1,uTextureMatrix:S.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(j=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},j)).uniforms&&Object.assign(H,j.uniforms),($=U.call(this,j.program||O.n.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),H)||this)._colorDirty=!1,$.uvMatrix=new O.u(P),$.batchable=j.program===void 0,$.pluginName=j.pluginName,$.tint=j.tint,$.alpha=j.alpha,$}return X(W,U),Object.defineProperty(W.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(P){this.uniforms.uSampler!==P&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!P.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=P,this.uvMatrix.texture=P)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"alpha",{get:function(){return this._alpha},set:function(P){P!==this._alpha&&(this._alpha=P,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"tint",{get:function(){return this._tint},set:function(P){P!==this._tint&&(this._tint=P,this._tintRGB=(P>>16)+(65280&P)+((255&P)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),W.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var P=this.texture.baseTexture;Object(z.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,P.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},W}(O.r),R=function(U){function W(P,j,$){var H=U.call(this)||this,Nt=new O.h(P),Vt=new O.h(j,!0),st=new O.h($,!0,!0);return H.addAttribute("aVertexPosition",Nt,2,!1,I.r.FLOAT).addAttribute("aTextureCoord",Vt,2,!1,I.r.FLOAT).addIndex(st),H._updateId=-1,H}return X(W,U),Object.defineProperty(W.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),W}(O.l)},function(b,E){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,E,v){v.d(E,"a",function(){return Rt}),v.d(E,"b",function(){return St});var O=v(2),S=v(3),I=v(1),D=v(0),F=v(4),z=function(R,U){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(W,P){W.__proto__=P}||function(W,P){for(var j in P)P.hasOwnProperty(j)&&(W[j]=P[j])})(R,U)},J=function(){function R(U){this._foundShapes=[],this.renderer=U}return R.prototype.pushMask=function(U){var W=this.renderer,P=U.maskObject||U;W.context.save();var j=this._foundShapes;if(this.recursiveFindShapes(P,j),j.length>0){var $=W.context;$.beginPath();for(var H=0;H<j.length;H++){var Nt=j[H],Vt=Nt.transform.worldTransform;this.renderer.setContextTransform(Vt),this.renderGraphicsShape(Nt)}j.length=0,$.clip()}},R.prototype.recursiveFindShapes=function(U,W){U.geometry&&U.geometry.graphicsData&&W.push(U);var P=U.children;if(P)for(var j=0;j<P.length;j++)this.recursiveFindShapes(P[j],W)},R.prototype.renderGraphicsShape=function(U){U.finishPoly();var W=this.renderer.context,P=U.geometry.graphicsData,j=P.length;if(j!==0)for(var $=0;$<j;$++){var H=P[$],Nt=H.shape;if(Nt.type===I.l.POLY){var Vt=Nt.points,st=H.holes,V=void 0,B=void 0,ft=void 0,tt=void 0;W.moveTo(Vt[0],Vt[1]);for(var vt=1;vt<Vt.length/2;vt++)W.lineTo(Vt[2*vt],Vt[2*vt+1]);if(st.length>0){for(V=0,ft=Vt[0],tt=Vt[1],vt=2;vt+2<Vt.length;vt+=2)V+=(Vt[vt]-ft)*(Vt[vt+3]-tt)-(Vt[vt+2]-ft)*(Vt[vt+1]-tt);for(var Dt=0;Dt<st.length;Dt++)if(Vt=st[Dt].shape.points){for(B=0,ft=Vt[0],tt=Vt[1],vt=2;vt+2<Vt.length;vt+=2)B+=(Vt[vt]-ft)*(Vt[vt+3]-tt)-(Vt[vt+2]-ft)*(Vt[vt+1]-tt);if(B*V<0)for(W.moveTo(Vt[0],Vt[1]),vt=2;vt<Vt.length;vt+=2)W.lineTo(Vt[vt],Vt[vt+1]);else for(W.moveTo(Vt[Vt.length-2],Vt[Vt.length-1]),vt=Vt.length-4;vt>=0;vt-=2)W.lineTo(Vt[vt],Vt[vt+1]);st[Dt].shape.closeStroke&&W.closePath()}}Vt[0]===Vt[Vt.length-2]&&Vt[1]===Vt[Vt.length-1]&&W.closePath()}else if(Nt.type===I.l.RECT)W.rect(Nt.x,Nt.y,Nt.width,Nt.height),W.closePath();else if(Nt.type===I.l.CIRC)W.arc(Nt.x,Nt.y,Nt.radius,0,2*Math.PI),W.closePath();else if(Nt.type===I.l.ELIP){var Z=2*Nt.width,pt=2*Nt.height,rt=Nt.x-Z/2,_t=Nt.y-pt/2,Et=Z/2*.5522848,Gt=pt/2*.5522848,Xt=rt+Z,Jt=_t+pt,at=rt+Z/2,_e=_t+pt/2;W.moveTo(rt,_e),W.bezierCurveTo(rt,_e-Gt,at-Et,_t,at,_t),W.bezierCurveTo(at+Et,_t,Xt,_e-Gt,Xt,_e),W.bezierCurveTo(Xt,_e+Gt,at+Et,Jt,at,Jt),W.bezierCurveTo(at-Et,Jt,rt,_e+Gt,rt,_e),W.closePath()}else if(Nt.type===I.l.RREC){var ke=Nt.x,Oe=Nt.y,Ae=Nt.width,ze=Nt.height,$e=Nt.radius,cn=Math.min(Ae,ze)/2;$e=$e>cn?cn:$e,W.moveTo(ke,Oe+$e),W.lineTo(ke,Oe+ze-$e),W.quadraticCurveTo(ke,Oe+ze,ke+$e,Oe+ze),W.lineTo(ke+Ae-$e,Oe+ze),W.quadraticCurveTo(ke+Ae,Oe+ze,ke+Ae,Oe+ze-$e),W.lineTo(ke+Ae,Oe+$e),W.quadraticCurveTo(ke+Ae,Oe,ke+Ae-$e,Oe),W.lineTo(ke+$e,Oe),W.quadraticCurveTo(ke,Oe,ke,Oe+$e),W.closePath()}}},R.prototype.popMask=function(U){U.context.restore(),U.invalidateBlendMode()},R.prototype.destroy=function(){},R}();function X(R){var U=document.createElement("canvas");U.width=6,U.height=1;var W=U.getContext("2d");return W.fillStyle=R,W.fillRect(0,0,6,1),U}function et(){if(typeof document=="undefined")return!1;var R=X("#ff00ff"),U=X("#ffff00"),W=document.createElement("canvas");W.width=6,W.height=1;var P=W.getContext("2d");P.globalCompositeOperation="multiply",P.drawImage(R,0,0),P.drawImage(U,2,0);var j=P.getImageData(2,0,1,1);if(!j)return!1;var $=j.data;return $[0]===255&&$[1]===0&&$[2]===0}var ut=new I.d,Rt=function(R){function U(W){var P,j=R.call(this,D.n.CANVAS,W)||this;if(j.refresh=!0,j.maskManager=new J(j),j.smoothProperty="imageSmoothingEnabled",j.blendModes=(P===void 0&&(P=[]),et()?(P[D.b.NORMAL]="source-over",P[D.b.ADD]="lighter",P[D.b.MULTIPLY]="multiply",P[D.b.SCREEN]="screen",P[D.b.OVERLAY]="overlay",P[D.b.DARKEN]="darken",P[D.b.LIGHTEN]="lighten",P[D.b.COLOR_DODGE]="color-dodge",P[D.b.COLOR_BURN]="color-burn",P[D.b.HARD_LIGHT]="hard-light",P[D.b.SOFT_LIGHT]="soft-light",P[D.b.DIFFERENCE]="difference",P[D.b.EXCLUSION]="exclusion",P[D.b.HUE]="hue",P[D.b.SATURATION]="saturate",P[D.b.COLOR]="color",P[D.b.LUMINOSITY]="luminosity"):(P[D.b.NORMAL]="source-over",P[D.b.ADD]="lighter",P[D.b.MULTIPLY]="source-over",P[D.b.SCREEN]="source-over",P[D.b.OVERLAY]="source-over",P[D.b.DARKEN]="source-over",P[D.b.LIGHTEN]="source-over",P[D.b.COLOR_DODGE]="source-over",P[D.b.COLOR_BURN]="source-over",P[D.b.HARD_LIGHT]="source-over",P[D.b.SOFT_LIGHT]="source-over",P[D.b.DIFFERENCE]="source-over",P[D.b.EXCLUSION]="source-over",P[D.b.HUE]="source-over",P[D.b.SATURATION]="source-over",P[D.b.COLOR]="source-over",P[D.b.LUMINOSITY]="source-over"),P[D.b.NORMAL_NPM]=P[D.b.NORMAL],P[D.b.ADD_NPM]=P[D.b.ADD],P[D.b.SCREEN_NPM]=P[D.b.SCREEN],P[D.b.SRC_IN]="source-in",P[D.b.SRC_OUT]="source-out",P[D.b.SRC_ATOP]="source-atop",P[D.b.DST_OVER]="destination-over",P[D.b.DST_IN]="destination-in",P[D.b.DST_OUT]="destination-out",P[D.b.DST_ATOP]="destination-atop",P[D.b.XOR]="xor",P[D.b.SUBTRACT]="source-over",P),j.renderingToScreen=!1,j._activeBlendMode=null,j._projTransform=null,j._outerBlend=!1,j.rootContext=j.view.getContext("2d",{alpha:j.useContextAlpha}),j.context=j.rootContext,!j.rootContext.imageSmoothingEnabled){var $=j.rootContext;$.webkitImageSmoothingEnabled?j.smoothProperty="webkitImageSmoothingEnabled":$.mozImageSmoothingEnabled?j.smoothProperty="mozImageSmoothingEnabled":$.oImageSmoothingEnabled?j.smoothProperty="oImageSmoothingEnabled":$.msImageSmoothingEnabled&&(j.smoothProperty="msImageSmoothingEnabled")}return j.initPlugins(U.__plugins),Object(S.sayHello)("Canvas"),j.resize(j.options.width,j.options.height),j}return function(W,P){function j(){this.constructor=W}z(W,P),W.prototype=P===null?Object.create(P):(j.prototype=P.prototype,new j)}(U,R),U.prototype.addSystem=function(){return this},U.prototype.render=function(W,P){if(this.view){var j,$,H,Nt;P&&(P instanceof O.p||P instanceof O.b?(Object(S.deprecation)("6.0.0","CanvasRenderer#render arguments changed, use options instead."),j=P,$=arguments[2],H=arguments[3],Nt=arguments[4]):(j=P.renderTexture,$=P.clear,H=P.transform,Nt=P.skipUpdateTransform)),this.renderingToScreen=!j,this.emit("prerender");var Vt=this.resolution;j?((j=j.castToBaseTexture())._canvasRenderTarget||(j._canvasRenderTarget=new S.CanvasRenderTarget(j.width,j.height,j.resolution),j.resource=new O.j(j._canvasRenderTarget.canvas),j.valid=!0),this.context=j._canvasRenderTarget.context,this.resolution=j._canvasRenderTarget.resolution):this.context=this.rootContext;var st=this.context;if(this._projTransform=H||null,j||(this._lastObjectRendered=W),!Nt){var V=W.enableTempParent();W.updateTransform(),W.disableTempParent(V)}if(st.save(),st.setTransform(1,0,0,1,0,0),st.globalAlpha=1,this._activeBlendMode=D.b.NORMAL,this._outerBlend=!1,st.globalCompositeOperation=this.blendModes[D.b.NORMAL],$!==void 0?$:this.clearBeforeRender)if(this.renderingToScreen)st.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(st.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,st.fillStyle=this._backgroundColorString,st.fillRect(0,0,this.width,this.height),st.globalAlpha=1);else{(j=j)._canvasRenderTarget.clear();var B=j.clearColor;B[3]>0&&(st.globalAlpha=this.useContextAlpha?B[3]:1,st.fillStyle=Object(S.hex2string)(Object(S.rgb2hex)(B)),st.fillRect(0,0,j.realWidth,j.realHeight),st.globalAlpha=1)}var ft=this.context;this.context=st,W.renderCanvas(this),this.context=ft,st.restore(),this.resolution=Vt,this._projTransform=null,this.emit("postrender")}},U.prototype.setContextTransform=function(W,P,j){var $=W,H=this._projTransform,Nt=this.resolution;j=j||Nt,H&&(($=ut).copyFrom(W),$.prepend(H)),P?this.context.setTransform($.a*j,$.b*j,$.c*j,$.d*j,$.tx*Nt|0,$.ty*Nt|0):this.context.setTransform($.a*j,$.b*j,$.c*j,$.d*j,$.tx*Nt,$.ty*Nt)},U.prototype.clear=function(W,P){W===void 0&&(W=this._backgroundColorString),P===void 0&&(P=this.backgroundAlpha);var j=this.context;j.clearRect(0,0,this.width,this.height),W&&(j.globalAlpha=this.useContextAlpha?P:1,j.fillStyle=W,j.fillRect(0,0,this.width,this.height),j.globalAlpha=1)},U.prototype.setBlendMode=function(W,P){var j=W===D.b.SRC_IN||W===D.b.SRC_OUT||W===D.b.DST_IN||W===D.b.DST_ATOP;!P&&j&&(W=D.b.NORMAL),this._activeBlendMode!==W&&(this._activeBlendMode=W,this._outerBlend=j,this.context.globalCompositeOperation=this.blendModes[W])},U.prototype.destroy=function(W){R.prototype.destroy.call(this,W),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},U.prototype.resize=function(W,P){R.prototype.resize.call(this,W,P),this.smoothProperty&&(this.rootContext[this.smoothProperty]=F.b.SCALE_MODE===D.p.LINEAR)},U.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},U.registerPlugin=function(W,P){U.__plugins=U.__plugins||{},U.__plugins[W]=P},U}(O.a),St={canvas:null,getTintedCanvas:function(R,U){var W=R.texture,P="#"+("00000"+(0|(U=St.roundColor(U))).toString(16)).slice(-6);W.tintCache=W.tintCache||{};var j,$=W.tintCache[P];if($){if($.tintId===W._updateID)return W.tintCache[P];j=W.tintCache[P]}else j=document.createElement("canvas");if(St.tintMethod(W,U,j),j.tintId=W._updateID,St.convertTintToImage){var H=new Image;H.src=j.toDataURL(),W.tintCache[P]=H}else W.tintCache[P]=j;return j},getTintedPattern:function(R,U){var W="#"+("00000"+(0|(U=St.roundColor(U))).toString(16)).slice(-6);R.patternCache=R.patternCache||{};var P=R.patternCache[W];return P&&P.tintId===R._updateID||(St.canvas||(St.canvas=document.createElement("canvas")),St.tintMethod(R,U,St.canvas),(P=St.canvas.getContext("2d").createPattern(St.canvas,"repeat")).tintId=R._updateID,R.patternCache[W]=P),P},tintWithMultiply:function(R,U,W){var P=W.getContext("2d"),j=R._frame.clone(),$=R.baseTexture.resolution;j.x*=$,j.y*=$,j.width*=$,j.height*=$,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.fillStyle="#"+("00000"+(0|U).toString(16)).slice(-6),P.fillRect(0,0,j.width,j.height),P.globalCompositeOperation="multiply";var H=R.baseTexture.getDrawableSource();P.drawImage(H,j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.globalCompositeOperation="destination-atop",P.drawImage(H,j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore()},tintWithOverlay:function(R,U,W){var P=W.getContext("2d"),j=R._frame.clone(),$=R.baseTexture.resolution;j.x*=$,j.y*=$,j.width*=$,j.height*=$,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.globalCompositeOperation="copy",P.fillStyle="#"+("00000"+(0|U).toString(16)).slice(-6),P.fillRect(0,0,j.width,j.height),P.globalCompositeOperation="destination-atop",P.drawImage(R.baseTexture.getDrawableSource(),j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore()},tintWithPerPixel:function(R,U,W){var P=W.getContext("2d"),j=R._frame.clone(),$=R.baseTexture.resolution;j.x*=$,j.y*=$,j.width*=$,j.height*=$,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.globalCompositeOperation="copy",P.drawImage(R.baseTexture.getDrawableSource(),j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore();for(var H=Object(S.hex2rgb)(U),Nt=H[0],Vt=H[1],st=H[2],V=P.getImageData(0,0,j.width,j.height),B=V.data,ft=0;ft<B.length;ft+=4)B[ft+0]*=Nt,B[ft+1]*=Vt,B[ft+2]*=st;P.putImageData(V,0,0)},roundColor:function(R){var U=St.cacheStepsPerColorChannel,W=Object(S.hex2rgb)(R);return W[0]=Math.min(255,W[0]/U*U),W[1]=Math.min(255,W[1]/U*U),W[2]=Math.min(255,W[2]/U*U),Object(S.rgb2hex)(W)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:et(),tintMethod:null};St.tintMethod=St.canUseMultiply?St.tintWithMultiply:St.tintWithPerPixel;var L=O.q.create;O.q.create=function(R){if(!(R&&R.forceCanvas))try{return L(R)}catch{}return new Rt(R)},O.c.prototype.getDrawableSource=function(){var R=this.resource;return R?R.bitmap||R.source:null},O.b.prototype._canvasRenderTarget=null,O.t.prototype.patternCache=null,O.t.prototype.tintCache=null},function(b,E){b.exports=function(v){return v===void 0}},function(b,E,v){v.d(E,"a",function(){return O});/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var O=function(){function S(I){this.items=[],this._name=I,this._aliasCount=0}return S.prototype.emit=function(I,D,F,z,J,X,et,ut){if(arguments.length>8)throw new Error("max arguments reached");var Rt=this,St=Rt.name,L=Rt.items;this._aliasCount++;for(var R=0,U=L.length;R<U;R++)L[R][St](I,D,F,z,J,X,et,ut);return L===this.items&&this._aliasCount--,this},S.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},S.prototype.add=function(I){return I[this._name]&&(this.ensureNonAliasedItems(),this.remove(I),this.items.push(I)),this},S.prototype.remove=function(I){var D=this.items.indexOf(I);return D!==-1&&(this.ensureNonAliasedItems(),this.items.splice(D,1)),this},S.prototype.contains=function(I){return this.items.indexOf(I)!==-1},S.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},S.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(S.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),S}();Object.defineProperties(O.prototype,{dispatch:{value:O.prototype.emit},run:{value:O.prototype.emit}})},function(b,E,v){var O=v(20),S=v(15);b.exports=function(I){return typeof I=="number"||S(I)&&O(I)=="[object Number]"}},function(b,E,v){var O=v(51),S=typeof self=="object"&&self&&self.Object===Object&&self,I=O||S||Function("return this")();b.exports=I},function(b,E){b.exports=function(v){return v!=null&&typeof v=="object"}},function(b,E,v){v.d(E,"a",function(){return Rt}),v.d(E,"b",function(){return ut}),v.d(E,"c",function(){return X});var O=v(8),S=v(0),I=v(2),D=function(St,L){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,U){R.__proto__=U}||function(R,U){for(var W in U)U.hasOwnProperty(W)&&(R[W]=U[W])})(St,L)};function F(St,L){function R(){this.constructor=St}D(St,L),St.prototype=L===null?Object.create(L):(R.prototype=L.prototype,new R)}var z=function(St){function L(R,U,W,P){R===void 0&&(R=100),U===void 0&&(U=100),W===void 0&&(W=10),P===void 0&&(P=10);var j=St.call(this)||this;return j.segWidth=W,j.segHeight=P,j.width=R,j.height=U,j.build(),j}return F(L,St),L.prototype.build=function(){for(var R=this.segWidth*this.segHeight,U=[],W=[],P=[],j=this.segWidth-1,$=this.segHeight-1,H=this.width/j,Nt=this.height/$,Vt=0;Vt<R;Vt++){var st=Vt%this.segWidth,V=Vt/this.segWidth|0;U.push(st*H,V*Nt),W.push(st/j,V/$)}var B=j*$;for(Vt=0;Vt<B;Vt++){var ft=Vt%j,tt=Vt/j|0,vt=tt*this.segWidth+ft,Dt=tt*this.segWidth+ft+1,Z=(tt+1)*this.segWidth+ft,pt=(tt+1)*this.segWidth+ft+1;P.push(vt,Dt,Z,Dt,pt,Z)}this.buffers[0].data=new Float32Array(U),this.buffers[1].data=new Float32Array(W),this.indexBuffer.data=new Uint16Array(P),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},L}(O.b),J=function(St){function L(R,U,W){R===void 0&&(R=200),W===void 0&&(W=0);var P=St.call(this,new Float32Array(4*U.length),new Float32Array(4*U.length),new Uint16Array(6*(U.length-1)))||this;return P.points=U,P._width=R,P.textureScale=W,P.build(),P}return F(L,St),Object.defineProperty(L.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),L.prototype.build=function(){var R=this.points;if(R){var U=this.getBuffer("aVertexPosition"),W=this.getBuffer("aTextureCoord"),P=this.getIndex();if(!(R.length<1)){U.data.length/4!==R.length&&(U.data=new Float32Array(4*R.length),W.data=new Float32Array(4*R.length),P.data=new Uint16Array(6*(R.length-1)));var j=W.data,$=P.data;j[0]=0,j[1]=0,j[2]=0,j[3]=1;for(var H=0,Nt=R[0],Vt=this._width*this.textureScale,st=R.length,V=0;V<st;V++){var B=4*V;if(this.textureScale>0){var ft=Nt.x-R[V].x,tt=Nt.y-R[V].y,vt=Math.sqrt(ft*ft+tt*tt);Nt=R[V],H+=vt/Vt}else H=V/(st-1);j[B]=H,j[B+1]=0,j[B+2]=H,j[B+3]=1}var Dt=0;for(V=0;V<st-1;V++)B=2*V,$[Dt++]=B,$[Dt++]=B+1,$[Dt++]=B+2,$[Dt++]=B+2,$[Dt++]=B+1,$[Dt++]=B+3;W.update(),P.update(),this.updateVertices()}}},L.prototype.updateVertices=function(){var R=this.points;if(!(R.length<1)){for(var U,W=R[0],P=0,j=0,$=this.buffers[0].data,H=R.length,Nt=0;Nt<H;Nt++){var Vt=R[Nt],st=4*Nt;j=-((U=Nt<R.length-1?R[Nt+1]:Vt).x-W.x),P=U.y-W.y;var V=Math.sqrt(P*P+j*j),B=this.textureScale>0?this.textureScale*this._width/2:this._width/2;P/=V,j/=V,P*=B,j*=B,$[st]=Vt.x+P,$[st+1]=Vt.y+j,$[st+2]=Vt.x-P,$[st+3]=Vt.y-j,W=Vt}this.buffers[0].update()}},L.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},L}(O.b),X=function(St){function L(R,U,W){W===void 0&&(W=0);var P=this,j=new J(R.height,U,W),$=new O.c(R);return W>0&&(R.baseTexture.wrapMode=S.s.REPEAT),(P=St.call(this,j,$)||this).autoUpdate=!0,P}return F(L,St),L.prototype._render=function(R){var U=this.geometry;(this.autoUpdate||U._width!==this.shader.texture.height)&&(U._width=this.shader.texture.height,U.update()),St.prototype._render.call(this,R)},L}(O.a),et=function(St){function L(R,U,W){var P=this,j=new z(R.width,R.height,U,W),$=new O.c(I.t.WHITE);return(P=St.call(this,j,$)||this).texture=R,P.autoResize=!0,P}return F(L,St),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var R=this.geometry,U=this.shader.texture,W=U.width,P=U.height;!this.autoResize||R.width===W&&R.height===P||(R.width=this.shader.texture.width,R.height=this.shader.texture.height,R.build())},Object.defineProperty(L.prototype,"texture",{get:function(){return this.shader.texture},set:function(R){this.shader.texture!==R&&(this.shader.texture=R,this._textureID=-1,R.baseTexture.valid?this.textureUpdated():R.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),L.prototype._render=function(R){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),St.prototype._render.call(this,R)},L.prototype.destroy=function(R){this.shader.texture.off("update",this.textureUpdated,this),St.prototype.destroy.call(this,R)},L}(O.a),ut=function(St){function L(R,U,W,P,j){R===void 0&&(R=I.t.EMPTY);var $=this,H=new O.b(U,W,P);H.getBuffer("aVertexPosition").static=!1;var Nt=new O.c(R);return($=St.call(this,H,Nt,null,j)||this).autoUpdate=!0,$}return F(L,St),Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(R){this.geometry.getBuffer("aVertexPosition").data=R},enumerable:!1,configurable:!0}),L.prototype._render=function(R){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),St.prototype._render.call(this,R)},L}(O.a),Rt=function(St){function L(R,U,W,P,j){U===void 0&&(U=10),W===void 0&&(W=10),P===void 0&&(P=10),j===void 0&&(j=10);var $=St.call(this,I.t.WHITE,4,4)||this;return $._origWidth=R.orig.width,$._origHeight=R.orig.height,$._width=$._origWidth,$._height=$._origHeight,$._leftWidth=U,$._rightWidth=P,$._topHeight=W,$._bottomHeight=j,$.texture=R,$}return F(L,St),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(R){this.geometry.getBuffer("aVertexPosition").data=R},enumerable:!1,configurable:!0}),L.prototype.updateHorizontalVertices=function(){var R=this.vertices,U=this._getMinScale();R[9]=R[11]=R[13]=R[15]=this._topHeight*U,R[17]=R[19]=R[21]=R[23]=this._height-this._bottomHeight*U,R[25]=R[27]=R[29]=R[31]=this._height},L.prototype.updateVerticalVertices=function(){var R=this.vertices,U=this._getMinScale();R[2]=R[10]=R[18]=R[26]=this._leftWidth*U,R[4]=R[12]=R[20]=R[28]=this._width-this._rightWidth*U,R[6]=R[14]=R[22]=R[30]=this._width},L.prototype._getMinScale=function(){var R=this._leftWidth+this._rightWidth,U=this._width>R?1:this._width/R,W=this._topHeight+this._bottomHeight,P=this._height>W?1:this._height/W;return Math.min(U,P)},Object.defineProperty(L.prototype,"width",{get:function(){return this._width},set:function(R){this._width=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"height",{get:function(){return this._height},set:function(R){this._height=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(R){this._leftWidth=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(R){this._rightWidth=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"topHeight",{get:function(){return this._topHeight},set:function(R){this._topHeight=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(R){this._bottomHeight=R,this._refresh()},enumerable:!1,configurable:!0}),L.prototype._refresh=function(){var R=this.texture,U=this.geometry.buffers[1].data;this._origWidth=R.orig.width,this._origHeight=R.orig.height;var W=1/this._origWidth,P=1/this._origHeight;U[0]=U[8]=U[16]=U[24]=0,U[1]=U[3]=U[5]=U[7]=0,U[6]=U[14]=U[22]=U[30]=1,U[25]=U[27]=U[29]=U[31]=1,U[2]=U[10]=U[18]=U[26]=W*this._leftWidth,U[4]=U[12]=U[20]=U[28]=1-W*this._rightWidth,U[9]=U[11]=U[13]=U[15]=P*this._topHeight,U[17]=U[19]=U[21]=U[23]=1-P*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},L}(et)},function(b,E){var v;v=function(){return this}();try{v=v||new Function("return this")()}catch{typeof window=="object"&&(v=window)}b.exports=v},function(b,E,v){var O;(function(S){function I(P,j){var $=(65535&P)+(65535&j);return(P>>16)+(j>>16)+($>>16)<<16|65535&$}function D(P,j,$,H,Nt,Vt){return I((st=I(I(j,P),I(H,Vt)))<<(V=Nt)|st>>>32-V,$);var st,V}function F(P,j,$,H,Nt,Vt,st){return D(j&$|~j&H,P,j,Nt,Vt,st)}function z(P,j,$,H,Nt,Vt,st){return D(j&H|$&~H,P,j,Nt,Vt,st)}function J(P,j,$,H,Nt,Vt,st){return D(j^$^H,P,j,Nt,Vt,st)}function X(P,j,$,H,Nt,Vt,st){return D($^(j|~H),P,j,Nt,Vt,st)}function et(P,j){var $,H,Nt,Vt,st;P[j>>5]|=128<<j%32,P[14+(j+64>>>9<<4)]=j;var V=1732584193,B=-271733879,ft=-1732584194,tt=271733878;for($=0;$<P.length;$+=16)H=V,Nt=B,Vt=ft,st=tt,V=F(V,B,ft,tt,P[$],7,-680876936),tt=F(tt,V,B,ft,P[$+1],12,-389564586),ft=F(ft,tt,V,B,P[$+2],17,606105819),B=F(B,ft,tt,V,P[$+3],22,-1044525330),V=F(V,B,ft,tt,P[$+4],7,-176418897),tt=F(tt,V,B,ft,P[$+5],12,1200080426),ft=F(ft,tt,V,B,P[$+6],17,-1473231341),B=F(B,ft,tt,V,P[$+7],22,-45705983),V=F(V,B,ft,tt,P[$+8],7,1770035416),tt=F(tt,V,B,ft,P[$+9],12,-1958414417),ft=F(ft,tt,V,B,P[$+10],17,-42063),B=F(B,ft,tt,V,P[$+11],22,-1990404162),V=F(V,B,ft,tt,P[$+12],7,1804603682),tt=F(tt,V,B,ft,P[$+13],12,-40341101),ft=F(ft,tt,V,B,P[$+14],17,-1502002290),V=z(V,B=F(B,ft,tt,V,P[$+15],22,1236535329),ft,tt,P[$+1],5,-165796510),tt=z(tt,V,B,ft,P[$+6],9,-1069501632),ft=z(ft,tt,V,B,P[$+11],14,643717713),B=z(B,ft,tt,V,P[$],20,-373897302),V=z(V,B,ft,tt,P[$+5],5,-701558691),tt=z(tt,V,B,ft,P[$+10],9,38016083),ft=z(ft,tt,V,B,P[$+15],14,-660478335),B=z(B,ft,tt,V,P[$+4],20,-405537848),V=z(V,B,ft,tt,P[$+9],5,568446438),tt=z(tt,V,B,ft,P[$+14],9,-1019803690),ft=z(ft,tt,V,B,P[$+3],14,-187363961),B=z(B,ft,tt,V,P[$+8],20,1163531501),V=z(V,B,ft,tt,P[$+13],5,-1444681467),tt=z(tt,V,B,ft,P[$+2],9,-51403784),ft=z(ft,tt,V,B,P[$+7],14,1735328473),V=J(V,B=z(B,ft,tt,V,P[$+12],20,-1926607734),ft,tt,P[$+5],4,-378558),tt=J(tt,V,B,ft,P[$+8],11,-2022574463),ft=J(ft,tt,V,B,P[$+11],16,1839030562),B=J(B,ft,tt,V,P[$+14],23,-35309556),V=J(V,B,ft,tt,P[$+1],4,-1530992060),tt=J(tt,V,B,ft,P[$+4],11,1272893353),ft=J(ft,tt,V,B,P[$+7],16,-155497632),B=J(B,ft,tt,V,P[$+10],23,-1094730640),V=J(V,B,ft,tt,P[$+13],4,681279174),tt=J(tt,V,B,ft,P[$],11,-358537222),ft=J(ft,tt,V,B,P[$+3],16,-722521979),B=J(B,ft,tt,V,P[$+6],23,76029189),V=J(V,B,ft,tt,P[$+9],4,-640364487),tt=J(tt,V,B,ft,P[$+12],11,-421815835),ft=J(ft,tt,V,B,P[$+15],16,530742520),V=X(V,B=J(B,ft,tt,V,P[$+2],23,-995338651),ft,tt,P[$],6,-198630844),tt=X(tt,V,B,ft,P[$+7],10,1126891415),ft=X(ft,tt,V,B,P[$+14],15,-1416354905),B=X(B,ft,tt,V,P[$+5],21,-57434055),V=X(V,B,ft,tt,P[$+12],6,1700485571),tt=X(tt,V,B,ft,P[$+3],10,-1894986606),ft=X(ft,tt,V,B,P[$+10],15,-1051523),B=X(B,ft,tt,V,P[$+1],21,-2054922799),V=X(V,B,ft,tt,P[$+8],6,1873313359),tt=X(tt,V,B,ft,P[$+15],10,-30611744),ft=X(ft,tt,V,B,P[$+6],15,-1560198380),B=X(B,ft,tt,V,P[$+13],21,1309151649),V=X(V,B,ft,tt,P[$+4],6,-145523070),tt=X(tt,V,B,ft,P[$+11],10,-1120210379),ft=X(ft,tt,V,B,P[$+2],15,718787259),B=X(B,ft,tt,V,P[$+9],21,-343485551),V=I(V,H),B=I(B,Nt),ft=I(ft,Vt),tt=I(tt,st);return[V,B,ft,tt]}function ut(P){var j,$="",H=32*P.length;for(j=0;j<H;j+=8)$+=String.fromCharCode(P[j>>5]>>>j%32&255);return $}function Rt(P){var j,$=[];for($[(P.length>>2)-1]=void 0,j=0;j<$.length;j+=1)$[j]=0;var H=8*P.length;for(j=0;j<H;j+=8)$[j>>5]|=(255&P.charCodeAt(j/8))<<j%32;return $}function St(P){var j,$,H="";for($=0;$<P.length;$+=1)j=P.charCodeAt($),H+="0123456789abcdef".charAt(j>>>4&15)+"0123456789abcdef".charAt(15&j);return H}function L(P){return unescape(encodeURIComponent(P))}function R(P){return function(j){return ut(et(Rt(j),8*j.length))}(L(P))}function U(P,j){return function($,H){var Nt,Vt,st=Rt($),V=[],B=[];for(V[15]=B[15]=void 0,st.length>16&&(st=et(st,8*$.length)),Nt=0;Nt<16;Nt+=1)V[Nt]=909522486^st[Nt],B[Nt]=1549556828^st[Nt];return Vt=et(V.concat(Rt(H)),512+8*H.length),ut(et(B.concat(Vt),640))}(L(P),L(j))}function W(P,j,$){return j?$?U(j,P):St(U(j,P)):$?R(P):St(R(P))}(O=function(){return W}.call(E,v,E,b))===void 0||(b.exports=O)})()},function(b,E){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,E,v){var O=v(25),S=v(137),I=v(138),D=O?O.toStringTag:void 0;b.exports=function(F){return F==null?F===void 0?"[object Undefined]":"[object Null]":D&&D in Object(F)?S(F):I(F)}},function(b,E){b.exports=function(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}},function(b,E,v){var O=v(162),S=v(165);b.exports=function(I,D){var F=S(I,D);return O(F)?F:void 0}},function(b,E,v){(function(O){b.exports=function S(I,D,F){function z(et,ut){if(!D[et]){if(!I[et]){if(J)return J(et,!0);var Rt=new Error("Cannot find module '"+et+"'");throw Rt.code="MODULE_NOT_FOUND",Rt}var St=D[et]={exports:{}};I[et][0].call(St.exports,function(L){var R=I[et][1][L];return z(R||L)},St,St.exports,S,I,D,F)}return D[et].exports}for(var J=!1,X=0;X<F.length;X++)z(F[X]);return z}({1:[function(S,I,D){(function(F){var z,J,X=F.MutationObserver||F.WebKitMutationObserver;if(X){var et=0,ut=new X(R),Rt=F.document.createTextNode("");ut.observe(Rt,{characterData:!0}),z=function(){Rt.data=et=++et%2}}else if(F.setImmediate||F.MessageChannel===void 0)z="document"in F&&"onreadystatechange"in F.document.createElement("script")?function(){var U=F.document.createElement("script");U.onreadystatechange=function(){R(),U.onreadystatechange=null,U.parentNode.removeChild(U),U=null},F.document.documentElement.appendChild(U)}:function(){setTimeout(R,0)};else{var St=new F.MessageChannel;St.port1.onmessage=R,z=function(){St.port2.postMessage(0)}}var L=[];function R(){var U,W;J=!0;for(var P=L.length;P;){for(W=L,L=[],U=-1;++U<P;)W[U]();P=L.length}J=!1}I.exports=function(U){L.push(U)!==1||J||z()}}).call(this,O!==void 0?O:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(S,I,D){var F=S(1);function z(){}var J={},X=["REJECTED"],et=["FULFILLED"],ut=["PENDING"];function Rt(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=ut,this.queue=[],this.outcome=void 0,P!==z&&U(this,P)}function St(P,j,$){this.promise=P,typeof j=="function"&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),typeof $=="function"&&(this.onRejected=$,this.callRejected=this.otherCallRejected)}function L(P,j,$){F(function(){var H;try{H=j($)}catch(Nt){return J.reject(P,Nt)}H===P?J.reject(P,new TypeError("Cannot resolve promise with itself")):J.resolve(P,H)})}function R(P){var j=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof j=="function")return function(){j.apply(P,arguments)}}function U(P,j){var $=!1;function H(st){$||($=!0,J.reject(P,st))}function Nt(st){$||($=!0,J.resolve(P,st))}var Vt=W(function(){j(Nt,H)});Vt.status==="error"&&H(Vt.value)}function W(P,j){var $={};try{$.value=P(j),$.status="success"}catch(H){$.status="error",$.value=H}return $}I.exports=Rt,Rt.prototype.catch=function(P){return this.then(null,P)},Rt.prototype.then=function(P,j){if(typeof P!="function"&&this.state===et||typeof j!="function"&&this.state===X)return this;var $=new this.constructor(z);return this.state!==ut?L($,this.state===et?P:j,this.outcome):this.queue.push(new St($,P,j)),$},St.prototype.callFulfilled=function(P){J.resolve(this.promise,P)},St.prototype.otherCallFulfilled=function(P){L(this.promise,this.onFulfilled,P)},St.prototype.callRejected=function(P){J.reject(this.promise,P)},St.prototype.otherCallRejected=function(P){L(this.promise,this.onRejected,P)},J.resolve=function(P,j){var $=W(R,j);if($.status==="error")return J.reject(P,$.value);var H=$.value;if(H)U(P,H);else{P.state=et,P.outcome=j;for(var Nt=-1,Vt=P.queue.length;++Nt<Vt;)P.queue[Nt].callFulfilled(j)}return P},J.reject=function(P,j){P.state=X,P.outcome=j;for(var $=-1,H=P.queue.length;++$<H;)P.queue[$].callRejected(j);return P},Rt.resolve=function(P){return P instanceof this?P:J.resolve(new this(z),P)},Rt.reject=function(P){var j=new this(z);return J.reject(j,P)},Rt.all=function(P){var j=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=P.length,H=!1;if(!$)return this.resolve([]);for(var Nt=new Array($),Vt=0,st=-1,V=new this(z);++st<$;)B(P[st],st);return V;function B(ft,tt){j.resolve(ft).then(function(vt){Nt[tt]=vt,++Vt!==$||H||(H=!0,J.resolve(V,Nt))},function(vt){H||(H=!0,J.reject(V,vt))})}},Rt.race=function(P){var j=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=P.length,H=!1;if(!$)return this.resolve([]);for(var Nt,Vt=-1,st=new this(z);++Vt<$;)Nt=P[Vt],j.resolve(Nt).then(function(V){H||(H=!0,J.resolve(st,V))},function(V){H||(H=!0,J.reject(st,V))});return st}},{1:1}],3:[function(S,I,D){(function(F){typeof F.Promise!="function"&&(F.Promise=S(2))}).call(this,O!==void 0?O:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(S,I,D){var F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(yt){return typeof yt}:function(yt){return yt&&typeof Symbol=="function"&&yt.constructor===Symbol&&yt!==Symbol.prototype?"symbol":typeof yt},z=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function J(yt,wt){yt=yt||[],wt=wt||{};try{return new Blob(yt,wt)}catch(Wt){if(Wt.name!=="TypeError")throw Wt;for(var It=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Qt=0;Qt<yt.length;Qt+=1)It.append(yt[Qt]);return It.getBlob(wt.type)}}typeof Promise=="undefined"&&S(3);var X=Promise;function et(yt,wt){wt&&yt.then(function(It){wt(null,It)},function(It){wt(It)})}function ut(yt,wt,It){typeof wt=="function"&&yt.then(wt),typeof It=="function"&&yt.catch(It)}function Rt(yt){return typeof yt!="string"&&(console.warn(yt+" used as a key, but it is not a string."),yt=String(yt)),yt}function St(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L=void 0,R={},U=Object.prototype.toString;function W(yt){return typeof L=="boolean"?X.resolve(L):function(wt){return new X(function(It){var Qt=wt.transaction("local-forage-detect-blob-support","readwrite"),Wt=J([""]);Qt.objectStore("local-forage-detect-blob-support").put(Wt,"key"),Qt.onabort=function(Zt){Zt.preventDefault(),Zt.stopPropagation(),It(!1)},Qt.oncomplete=function(){var Zt=navigator.userAgent.match(/Chrome\/(\d+)/),oe=navigator.userAgent.match(/Edge\//);It(oe||!Zt||parseInt(Zt[1],10)>=43)}}).catch(function(){return!1})}(yt).then(function(wt){return L=wt})}function P(yt){var wt=R[yt.name],It={};It.promise=new X(function(Qt,Wt){It.resolve=Qt,It.reject=Wt}),wt.deferredOperations.push(It),wt.dbReady?wt.dbReady=wt.dbReady.then(function(){return It.promise}):wt.dbReady=It.promise}function j(yt){var wt=R[yt.name].deferredOperations.pop();if(wt)return wt.resolve(),wt.promise}function $(yt,wt){var It=R[yt.name].deferredOperations.pop();if(It)return It.reject(wt),It.promise}function H(yt,wt){return new X(function(It,Qt){if(R[yt.name]=R[yt.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},yt.db){if(!wt)return It(yt.db);P(yt),yt.db.close()}var Wt=[yt.name];wt&&Wt.push(yt.version);var Zt=z.open.apply(z,Wt);wt&&(Zt.onupgradeneeded=function(oe){var Me=Zt.result;try{Me.createObjectStore(yt.storeName),oe.oldVersion<=1&&Me.createObjectStore("local-forage-detect-blob-support")}catch(Se){if(Se.name!=="ConstraintError")throw Se;console.warn('The database "'+yt.name+'" has been upgraded from version '+oe.oldVersion+" to version "+oe.newVersion+', but the storage "'+yt.storeName+'" already exists.')}}),Zt.onerror=function(oe){oe.preventDefault(),Qt(Zt.error)},Zt.onsuccess=function(){var oe=Zt.result;oe.onversionchange=function(Me){Me.target.close()},It(oe),j(yt)}})}function Nt(yt){return H(yt,!1)}function Vt(yt){return H(yt,!0)}function st(yt,wt){if(!yt.db)return!0;var It=!yt.db.objectStoreNames.contains(yt.storeName),Qt=yt.version<yt.db.version,Wt=yt.version>yt.db.version;if(Qt&&(yt.version!==wt&&console.warn('The database "'+yt.name+`" can't be downgraded from version `+yt.db.version+" to version "+yt.version+"."),yt.version=yt.db.version),Wt||It){if(It){var Zt=yt.db.version+1;Zt>yt.version&&(yt.version=Zt)}return!0}return!1}function V(yt){return J([function(wt){for(var It=wt.length,Qt=new ArrayBuffer(It),Wt=new Uint8Array(Qt),Zt=0;Zt<It;Zt++)Wt[Zt]=wt.charCodeAt(Zt);return Qt}(atob(yt.data))],{type:yt.type})}function B(yt){return yt&&yt.__local_forage_encoded_blob}function ft(yt){var wt=this,It=wt._initReady().then(function(){var Qt=R[wt._dbInfo.name];if(Qt&&Qt.dbReady)return Qt.dbReady});return ut(It,yt,yt),It}function tt(yt,wt,It,Qt){Qt===void 0&&(Qt=1);try{var Wt=yt.db.transaction(yt.storeName,wt);It(null,Wt)}catch(Zt){if(Qt>0&&(!yt.db||Zt.name==="InvalidStateError"||Zt.name==="NotFoundError"))return X.resolve().then(function(){if(!yt.db||Zt.name==="NotFoundError"&&!yt.db.objectStoreNames.contains(yt.storeName)&&yt.version<=yt.db.version)return yt.db&&(yt.version=yt.db.version+1),Vt(yt)}).then(function(){return function(oe){P(oe);for(var Me=R[oe.name],Se=Me.forages,Ee=0;Ee<Se.length;Ee++){var Ve=Se[Ee];Ve._dbInfo.db&&(Ve._dbInfo.db.close(),Ve._dbInfo.db=null)}return oe.db=null,Nt(oe).then(function(en){return oe.db=en,st(oe)?Vt(oe):en}).then(function(en){oe.db=Me.db=en;for(var dn=0;dn<Se.length;dn++)Se[dn]._dbInfo.db=en}).catch(function(en){throw $(oe,en),en})}(yt).then(function(){tt(yt,wt,It,Qt-1)})}).catch(It);It(Zt)}}var vt={_driver:"asyncStorage",_initStorage:function(yt){var wt=this,It={db:null};if(yt)for(var Qt in yt)It[Qt]=yt[Qt];var Wt=R[It.name];Wt||(Wt={forages:[],db:null,dbReady:null,deferredOperations:[]},R[It.name]=Wt),Wt.forages.push(wt),wt._initReady||(wt._initReady=wt.ready,wt.ready=ft);var Zt=[];function oe(){return X.resolve()}for(var Me=0;Me<Wt.forages.length;Me++){var Se=Wt.forages[Me];Se!==wt&&Zt.push(Se._initReady().catch(oe))}var Ee=Wt.forages.slice(0);return X.all(Zt).then(function(){return It.db=Wt.db,Nt(It)}).then(function(Ve){return It.db=Ve,st(It,wt._defaultConfig.version)?Vt(It):Ve}).then(function(Ve){It.db=Wt.db=Ve,wt._dbInfo=It;for(var en=0;en<Ee.length;en++){var dn=Ee[en];dn!==wt&&(dn._dbInfo.db=It.db,dn._dbInfo.version=It.version)}})},_support:function(){try{if(!z||!z.open)return!1;var yt=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),wt=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!yt||wt)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(yt,wt){var It=this,Qt=new X(function(Wt,Zt){It.ready().then(function(){tt(It._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Se=Me.objectStore(It._dbInfo.storeName).openCursor(),Ee=1;Se.onsuccess=function(){var Ve=Se.result;if(Ve){var en=Ve.value;B(en)&&(en=V(en));var dn=yt(en,Ve.key,Ee++);dn!==void 0?Wt(dn):Ve.continue()}else Wt()},Se.onerror=function(){Zt(Se.error)}}catch(Ve){Zt(Ve)}})}).catch(Zt)});return et(Qt,wt),Qt},getItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=new X(function(Wt,Zt){It.ready().then(function(){tt(It._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Se=Me.objectStore(It._dbInfo.storeName).get(yt);Se.onsuccess=function(){var Ee=Se.result;Ee===void 0&&(Ee=null),B(Ee)&&(Ee=V(Ee)),Wt(Ee)},Se.onerror=function(){Zt(Se.error)}}catch(Ee){Zt(Ee)}})}).catch(Zt)});return et(Qt,wt),Qt},setItem:function(yt,wt,It){var Qt=this;yt=Rt(yt);var Wt=new X(function(Zt,oe){var Me;Qt.ready().then(function(){return Me=Qt._dbInfo,U.call(wt)==="[object Blob]"?W(Me.db).then(function(Se){return Se?wt:(Ee=wt,new X(function(Ve,en){var dn=new FileReader;dn.onerror=en,dn.onloadend=function(Tn){var yn=btoa(Tn.target.result||"");Ve({__local_forage_encoded_blob:!0,data:yn,type:Ee.type})},dn.readAsBinaryString(Ee)}));var Ee}):wt}).then(function(Se){tt(Qt._dbInfo,"readwrite",function(Ee,Ve){if(Ee)return oe(Ee);try{var en=Ve.objectStore(Qt._dbInfo.storeName);Se===null&&(Se=void 0);var dn=en.put(Se,yt);Ve.oncomplete=function(){Se===void 0&&(Se=null),Zt(Se)},Ve.onabort=Ve.onerror=function(){var Tn=dn.error?dn.error:dn.transaction.error;oe(Tn)}}catch(Tn){oe(Tn)}})}).catch(oe)});return et(Wt,It),Wt},removeItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=new X(function(Wt,Zt){It.ready().then(function(){tt(It._dbInfo,"readwrite",function(oe,Me){if(oe)return Zt(oe);try{var Se=Me.objectStore(It._dbInfo.storeName).delete(yt);Me.oncomplete=function(){Wt()},Me.onerror=function(){Zt(Se.error)},Me.onabort=function(){var Ee=Se.error?Se.error:Se.transaction.error;Zt(Ee)}}catch(Ee){Zt(Ee)}})}).catch(Zt)});return et(Qt,wt),Qt},clear:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){tt(wt._dbInfo,"readwrite",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(wt._dbInfo.storeName).clear();oe.oncomplete=function(){Qt()},oe.onabort=oe.onerror=function(){var Se=Me.error?Me.error:Me.transaction.error;Wt(Se)}}catch(Se){Wt(Se)}})}).catch(Wt)});return et(It,yt),It},length:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){tt(wt._dbInfo,"readonly",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(wt._dbInfo.storeName).count();Me.onsuccess=function(){Qt(Me.result)},Me.onerror=function(){Wt(Me.error)}}catch(Se){Wt(Se)}})}).catch(Wt)});return et(It,yt),It},key:function(yt,wt){var It=this,Qt=new X(function(Wt,Zt){yt<0?Wt(null):It.ready().then(function(){tt(It._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Se=Me.objectStore(It._dbInfo.storeName),Ee=!1,Ve=Se.openKeyCursor();Ve.onsuccess=function(){var en=Ve.result;en?yt===0||Ee?Wt(en.key):(Ee=!0,en.advance(yt)):Wt(null)},Ve.onerror=function(){Zt(Ve.error)}}catch(en){Zt(en)}})}).catch(Zt)});return et(Qt,wt),Qt},keys:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){tt(wt._dbInfo,"readonly",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(wt._dbInfo.storeName).openKeyCursor(),Se=[];Me.onsuccess=function(){var Ee=Me.result;Ee?(Se.push(Ee.key),Ee.continue()):Qt(Se)},Me.onerror=function(){Wt(Me.error)}}catch(Ee){Wt(Ee)}})}).catch(Wt)});return et(It,yt),It},dropInstance:function(yt,wt){wt=St.apply(this,arguments);var It=this.config();(yt=typeof yt!="function"&&yt||{}).name||(yt.name=yt.name||It.name,yt.storeName=yt.storeName||It.storeName);var Qt,Wt=this;if(yt.name){var Zt=yt.name===It.name&&Wt._dbInfo.db,oe=Zt?X.resolve(Wt._dbInfo.db):Nt(yt).then(function(Me){var Se=R[yt.name],Ee=Se.forages;Se.db=Me;for(var Ve=0;Ve<Ee.length;Ve++)Ee[Ve]._dbInfo.db=Me;return Me});Qt=yt.storeName?oe.then(function(Me){if(Me.objectStoreNames.contains(yt.storeName)){var Se=Me.version+1;P(yt);var Ee=R[yt.name],Ve=Ee.forages;Me.close();for(var en=0;en<Ve.length;en++){var dn=Ve[en];dn._dbInfo.db=null,dn._dbInfo.version=Se}return new X(function(Tn,yn){var Xn=z.open(yt.name,Se);Xn.onerror=function(Pn){Xn.result.close(),yn(Pn)},Xn.onupgradeneeded=function(){Xn.result.deleteObjectStore(yt.storeName)},Xn.onsuccess=function(){var Pn=Xn.result;Pn.close(),Tn(Pn)}}).then(function(Tn){Ee.db=Tn;for(var yn=0;yn<Ve.length;yn++){var Xn=Ve[yn];Xn._dbInfo.db=Tn,j(Xn._dbInfo)}}).catch(function(Tn){throw($(yt,Tn)||X.resolve()).catch(function(){}),Tn})}}):oe.then(function(Me){P(yt);var Se=R[yt.name],Ee=Se.forages;Me.close();for(var Ve=0;Ve<Ee.length;Ve++)Ee[Ve]._dbInfo.db=null;return new X(function(en,dn){var Tn=z.deleteDatabase(yt.name);Tn.onerror=function(){var yn=Tn.result;yn&&yn.close(),dn(Tn.error)},Tn.onblocked=function(){console.warn('dropInstance blocked for database "'+yt.name+'" until all open connections are closed')},Tn.onsuccess=function(){var yn=Tn.result;yn&&yn.close(),en(yn)}}).then(function(en){Se.db=en;for(var dn=0;dn<Ee.length;dn++)j(Ee[dn]._dbInfo)}).catch(function(en){throw($(yt,en)||X.resolve()).catch(function(){}),en})})}else Qt=X.reject("Invalid arguments");return et(Qt,wt),Qt}},Dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=/^~~local_forage_type~([^~]+)~/,pt=9,rt=pt+4,_t=Object.prototype.toString;function Et(yt){var wt,It,Qt,Wt,Zt,oe=.75*yt.length,Me=yt.length,Se=0;yt[yt.length-1]==="="&&(oe--,yt[yt.length-2]==="="&&oe--);var Ee=new ArrayBuffer(oe),Ve=new Uint8Array(Ee);for(wt=0;wt<Me;wt+=4)It=Dt.indexOf(yt[wt]),Qt=Dt.indexOf(yt[wt+1]),Wt=Dt.indexOf(yt[wt+2]),Zt=Dt.indexOf(yt[wt+3]),Ve[Se++]=It<<2|Qt>>4,Ve[Se++]=(15&Qt)<<4|Wt>>2,Ve[Se++]=(3&Wt)<<6|63&Zt;return Ee}function Gt(yt){var wt,It=new Uint8Array(yt),Qt="";for(wt=0;wt<It.length;wt+=3)Qt+=Dt[It[wt]>>2],Qt+=Dt[(3&It[wt])<<4|It[wt+1]>>4],Qt+=Dt[(15&It[wt+1])<<2|It[wt+2]>>6],Qt+=Dt[63&It[wt+2]];return It.length%3==2?Qt=Qt.substring(0,Qt.length-1)+"=":It.length%3==1&&(Qt=Qt.substring(0,Qt.length-2)+"=="),Qt}var Xt={serialize:function(yt,wt){var It="";if(yt&&(It=_t.call(yt)),yt&&(It==="[object ArrayBuffer]"||yt.buffer&&_t.call(yt.buffer)==="[object ArrayBuffer]")){var Qt,Wt="__lfsc__:";yt instanceof ArrayBuffer?(Qt=yt,Wt+="arbf"):(Qt=yt.buffer,It==="[object Int8Array]"?Wt+="si08":It==="[object Uint8Array]"?Wt+="ui08":It==="[object Uint8ClampedArray]"?Wt+="uic8":It==="[object Int16Array]"?Wt+="si16":It==="[object Uint16Array]"?Wt+="ur16":It==="[object Int32Array]"?Wt+="si32":It==="[object Uint32Array]"?Wt+="ui32":It==="[object Float32Array]"?Wt+="fl32":It==="[object Float64Array]"?Wt+="fl64":wt(new Error("Failed to get type for BinaryArray"))),wt(Wt+Gt(Qt))}else if(It==="[object Blob]"){var Zt=new FileReader;Zt.onload=function(){var oe="~~local_forage_type~"+yt.type+"~"+Gt(this.result);wt("__lfsc__:blob"+oe)},Zt.readAsArrayBuffer(yt)}else try{wt(JSON.stringify(yt))}catch(oe){console.error("Couldn't convert value into a JSON string: ",yt),wt(null,oe)}},deserialize:function(yt){if(yt.substring(0,pt)!=="__lfsc__:")return JSON.parse(yt);var wt,It=yt.substring(rt),Qt=yt.substring(pt,rt);if(Qt==="blob"&&Z.test(It)){var Wt=It.match(Z);wt=Wt[1],It=It.substring(Wt[0].length)}var Zt=Et(It);switch(Qt){case"arbf":return Zt;case"blob":return J([Zt],{type:wt});case"si08":return new Int8Array(Zt);case"ui08":return new Uint8Array(Zt);case"uic8":return new Uint8ClampedArray(Zt);case"si16":return new Int16Array(Zt);case"ur16":return new Uint16Array(Zt);case"si32":return new Int32Array(Zt);case"ui32":return new Uint32Array(Zt);case"fl32":return new Float32Array(Zt);case"fl64":return new Float64Array(Zt);default:throw new Error("Unkown type: "+Qt)}},stringToBuffer:Et,bufferToString:Gt};function Jt(yt,wt,It,Qt){yt.executeSql("CREATE TABLE IF NOT EXISTS "+wt.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],It,Qt)}function at(yt,wt,It,Qt,Wt,Zt){yt.executeSql(It,Qt,Wt,function(oe,Me){Me.code===Me.SYNTAX_ERR?oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[wt.storeName],function(Se,Ee){Ee.rows.length?Zt(Se,Me):Jt(Se,wt,function(){Se.executeSql(It,Qt,Wt,Zt)},Zt)},Zt):Zt(oe,Me)},Zt)}function _e(yt,wt,It,Qt){var Wt=this;yt=Rt(yt);var Zt=new X(function(oe,Me){Wt.ready().then(function(){wt===void 0&&(wt=null);var Se=wt,Ee=Wt._dbInfo;Ee.serializer.serialize(wt,function(Ve,en){en?Me(en):Ee.db.transaction(function(dn){at(dn,Ee,"INSERT OR REPLACE INTO "+Ee.storeName+" (key, value) VALUES (?, ?)",[yt,Ve],function(){oe(Se)},function(Tn,yn){Me(yn)})},function(dn){if(dn.code===dn.QUOTA_ERR){if(Qt>0)return void oe(_e.apply(Wt,[yt,Se,It,Qt-1]));Me(dn)}})})}).catch(Me)});return et(Zt,It),Zt}function ke(yt){return new X(function(wt,It){yt.transaction(function(Qt){Qt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Wt,Zt){for(var oe=[],Me=0;Me<Zt.rows.length;Me++)oe.push(Zt.rows.item(Me).name);wt({db:yt,storeNames:oe})},function(Wt,Zt){It(Zt)})},function(Qt){It(Qt)})})}var Oe={_driver:"webSQLStorage",_initStorage:function(yt){var wt=this,It={db:null};if(yt)for(var Qt in yt)It[Qt]=typeof yt[Qt]!="string"?yt[Qt].toString():yt[Qt];var Wt=new X(function(Zt,oe){try{It.db=openDatabase(It.name,String(It.version),It.description,It.size)}catch(Me){return oe(Me)}It.db.transaction(function(Me){Jt(Me,It,function(){wt._dbInfo=It,Zt()},function(Se,Ee){oe(Ee)})},oe)});return It.serializer=Xt,Wt},_support:typeof openDatabase=="function",iterate:function(yt,wt){var It=this,Qt=new X(function(Wt,Zt){It.ready().then(function(){var oe=It._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName,[],function(Se,Ee){for(var Ve=Ee.rows,en=Ve.length,dn=0;dn<en;dn++){var Tn=Ve.item(dn),yn=Tn.value;if(yn&&(yn=oe.serializer.deserialize(yn)),(yn=yt(yn,Tn.key,dn+1))!==void 0)return void Wt(yn)}Wt()},function(Se,Ee){Zt(Ee)})})}).catch(Zt)});return et(Qt,wt),Qt},getItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=new X(function(Wt,Zt){It.ready().then(function(){var oe=It._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName+" WHERE key = ? LIMIT 1",[yt],function(Se,Ee){var Ve=Ee.rows.length?Ee.rows.item(0).value:null;Ve&&(Ve=oe.serializer.deserialize(Ve)),Wt(Ve)},function(Se,Ee){Zt(Ee)})})}).catch(Zt)});return et(Qt,wt),Qt},setItem:function(yt,wt,It){return _e.apply(this,[yt,wt,It,1])},removeItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=new X(function(Wt,Zt){It.ready().then(function(){var oe=It._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"DELETE FROM "+oe.storeName+" WHERE key = ?",[yt],function(){Wt()},function(Se,Ee){Zt(Ee)})})}).catch(Zt)});return et(Qt,wt),Qt},clear:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){var Zt=wt._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"DELETE FROM "+Zt.storeName,[],function(){Qt()},function(Me,Se){Wt(Se)})})}).catch(Wt)});return et(It,yt),It},length:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){var Zt=wt._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"SELECT COUNT(key) as c FROM "+Zt.storeName,[],function(Me,Se){var Ee=Se.rows.item(0).c;Qt(Ee)},function(Me,Se){Wt(Se)})})}).catch(Wt)});return et(It,yt),It},key:function(yt,wt){var It=this,Qt=new X(function(Wt,Zt){It.ready().then(function(){var oe=It._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT key FROM "+oe.storeName+" WHERE id = ? LIMIT 1",[yt+1],function(Se,Ee){var Ve=Ee.rows.length?Ee.rows.item(0).key:null;Wt(Ve)},function(Se,Ee){Zt(Ee)})})}).catch(Zt)});return et(Qt,wt),Qt},keys:function(yt){var wt=this,It=new X(function(Qt,Wt){wt.ready().then(function(){var Zt=wt._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"SELECT key FROM "+Zt.storeName,[],function(Me,Se){for(var Ee=[],Ve=0;Ve<Se.rows.length;Ve++)Ee.push(Se.rows.item(Ve).key);Qt(Ee)},function(Me,Se){Wt(Se)})})}).catch(Wt)});return et(It,yt),It},dropInstance:function(yt,wt){wt=St.apply(this,arguments);var It=this.config();(yt=typeof yt!="function"&&yt||{}).name||(yt.name=yt.name||It.name,yt.storeName=yt.storeName||It.storeName);var Qt,Wt=this;return et(Qt=yt.name?new X(function(Zt){var oe;oe=yt.name===It.name?Wt._dbInfo.db:openDatabase(yt.name,"","",0),yt.storeName?Zt({db:oe,storeNames:[yt.storeName]}):Zt(ke(oe))}).then(function(Zt){return new X(function(oe,Me){Zt.db.transaction(function(Se){function Ee(Tn){return new X(function(yn,Xn){Se.executeSql("DROP TABLE IF EXISTS "+Tn,[],function(){yn()},function(Pn,zi){Xn(zi)})})}for(var Ve=[],en=0,dn=Zt.storeNames.length;en<dn;en++)Ve.push(Ee(Zt.storeNames[en]));X.all(Ve).then(function(){oe()}).catch(function(Tn){Me(Tn)})},function(Se){Me(Se)})})}):X.reject("Invalid arguments"),wt),Qt}};function Ae(yt,wt){var It=yt.name+"/";return yt.storeName!==wt.storeName&&(It+=yt.storeName+"/"),It}function ze(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var $e={_driver:"localStorageWrapper",_initStorage:function(yt){var wt={};if(yt)for(var It in yt)wt[It]=yt[It];return wt.keyPrefix=Ae(yt,this._defaultConfig),ze()?(this._dbInfo=wt,wt.serializer=Xt,X.resolve()):X.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(yt,wt){var It=this,Qt=It.ready().then(function(){for(var Wt=It._dbInfo,Zt=Wt.keyPrefix,oe=Zt.length,Me=localStorage.length,Se=1,Ee=0;Ee<Me;Ee++){var Ve=localStorage.key(Ee);if(Ve.indexOf(Zt)===0){var en=localStorage.getItem(Ve);if(en&&(en=Wt.serializer.deserialize(en)),(en=yt(en,Ve.substring(oe),Se++))!==void 0)return en}}});return et(Qt,wt),Qt},getItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=It.ready().then(function(){var Wt=It._dbInfo,Zt=localStorage.getItem(Wt.keyPrefix+yt);return Zt&&(Zt=Wt.serializer.deserialize(Zt)),Zt});return et(Qt,wt),Qt},setItem:function(yt,wt,It){var Qt=this;yt=Rt(yt);var Wt=Qt.ready().then(function(){wt===void 0&&(wt=null);var Zt=wt;return new X(function(oe,Me){var Se=Qt._dbInfo;Se.serializer.serialize(wt,function(Ee,Ve){if(Ve)Me(Ve);else try{localStorage.setItem(Se.keyPrefix+yt,Ee),oe(Zt)}catch(en){en.name!=="QuotaExceededError"&&en.name!=="NS_ERROR_DOM_QUOTA_REACHED"||Me(en),Me(en)}})})});return et(Wt,It),Wt},removeItem:function(yt,wt){var It=this;yt=Rt(yt);var Qt=It.ready().then(function(){var Wt=It._dbInfo;localStorage.removeItem(Wt.keyPrefix+yt)});return et(Qt,wt),Qt},clear:function(yt){var wt=this,It=wt.ready().then(function(){for(var Qt=wt._dbInfo.keyPrefix,Wt=localStorage.length-1;Wt>=0;Wt--){var Zt=localStorage.key(Wt);Zt.indexOf(Qt)===0&&localStorage.removeItem(Zt)}});return et(It,yt),It},length:function(yt){var wt=this.keys().then(function(It){return It.length});return et(wt,yt),wt},key:function(yt,wt){var It=this,Qt=It.ready().then(function(){var Wt,Zt=It._dbInfo;try{Wt=localStorage.key(yt)}catch{Wt=null}return Wt&&(Wt=Wt.substring(Zt.keyPrefix.length)),Wt});return et(Qt,wt),Qt},keys:function(yt){var wt=this,It=wt.ready().then(function(){for(var Qt=wt._dbInfo,Wt=localStorage.length,Zt=[],oe=0;oe<Wt;oe++){var Me=localStorage.key(oe);Me.indexOf(Qt.keyPrefix)===0&&Zt.push(Me.substring(Qt.keyPrefix.length))}return Zt});return et(It,yt),It},dropInstance:function(yt,wt){if(wt=St.apply(this,arguments),!(yt=typeof yt!="function"&&yt||{}).name){var It=this.config();yt.name=yt.name||It.name,yt.storeName=yt.storeName||It.storeName}var Qt,Wt=this;return et(Qt=yt.name?new X(function(Zt){yt.storeName?Zt(Ae(yt,Wt._defaultConfig)):Zt(yt.name+"/")}).then(function(Zt){for(var oe=localStorage.length-1;oe>=0;oe--){var Me=localStorage.key(oe);Me.indexOf(Zt)===0&&localStorage.removeItem(Me)}}):X.reject("Invalid arguments"),wt),Qt}},cn=function(yt,wt){for(var It,Qt,Wt=yt.length,Zt=0;Zt<Wt;){if((It=yt[Zt])===(Qt=wt)||typeof It=="number"&&typeof Qt=="number"&&isNaN(It)&&isNaN(Qt))return!0;Zt++}return!1},Ue=Array.isArray||function(yt){return Object.prototype.toString.call(yt)==="[object Array]"},Ge={},Rn={},re={INDEXEDDB:vt,WEBSQL:Oe,LOCALSTORAGE:$e},pe=[re.INDEXEDDB._driver,re.WEBSQL._driver,re.LOCALSTORAGE._driver],we=["dropInstance"],ln=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(we),In={description:"",driver:pe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Zn(yt,wt){yt[wt]=function(){var It=arguments;return yt.ready().then(function(){return yt[wt].apply(yt,It)})}}function pi(){for(var yt=1;yt<arguments.length;yt++){var wt=arguments[yt];if(wt)for(var It in wt)wt.hasOwnProperty(It)&&(Ue(wt[It])?arguments[0][It]=wt[It].slice():arguments[0][It]=wt[It])}return arguments[0]}var tn=new(function(){function yt(wt){for(var It in function(Zt,oe){if(!(Zt instanceof oe))throw new TypeError("Cannot call a class as a function")}(this,yt),re)if(re.hasOwnProperty(It)){var Qt=re[It],Wt=Qt._driver;this[It]=Wt,Ge[Wt]||this.defineDriver(Qt)}this._defaultConfig=pi({},In),this._config=pi({},this._defaultConfig,wt),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return yt.prototype.config=function(wt){if((wt===void 0?"undefined":F(wt))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var It in wt){if(It==="storeName"&&(wt[It]=wt[It].replace(/\W/g,"_")),It==="version"&&typeof wt[It]!="number")return new Error("Database version must be a number.");this._config[It]=wt[It]}return!("driver"in wt)||!wt.driver||this.setDriver(this._config.driver)}return typeof wt=="string"?this._config[wt]:this._config},yt.prototype.defineDriver=function(wt,It,Qt){var Wt=new X(function(Zt,oe){try{var Me=wt._driver,Se=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!wt._driver)return void oe(Se);for(var Ee=ln.concat("_initStorage"),Ve=0,en=Ee.length;Ve<en;Ve++){var dn=Ee[Ve];if((!cn(we,dn)||wt[dn])&&typeof wt[dn]!="function")return void oe(Se)}(function(){for(var yn=function(fo){return function(){var io=new Error("Method "+fo+" is not implemented by the current driver"),Fn=X.reject(io);return et(Fn,arguments[arguments.length-1]),Fn}},Xn=0,Pn=we.length;Xn<Pn;Xn++){var zi=we[Xn];wt[zi]||(wt[zi]=yn(zi))}})();var Tn=function(yn){Ge[Me]&&console.info("Redefining LocalForage driver: "+Me),Ge[Me]=wt,Rn[Me]=yn,Zt()};"_support"in wt?wt._support&&typeof wt._support=="function"?wt._support().then(Tn,oe):Tn(!!wt._support):Tn(!0)}catch(yn){oe(yn)}});return ut(Wt,It,Qt),Wt},yt.prototype.driver=function(){return this._driver||null},yt.prototype.getDriver=function(wt,It,Qt){var Wt=Ge[wt]?X.resolve(Ge[wt]):X.reject(new Error("Driver not found."));return ut(Wt,It,Qt),Wt},yt.prototype.getSerializer=function(wt){var It=X.resolve(Xt);return ut(It,wt),It},yt.prototype.ready=function(wt){var It=this,Qt=It._driverSet.then(function(){return It._ready===null&&(It._ready=It._initDriver()),It._ready});return ut(Qt,wt,wt),Qt},yt.prototype.setDriver=function(wt,It,Qt){var Wt=this;Ue(wt)||(wt=[wt]);var Zt=this._getSupportedDrivers(wt);function oe(){Wt._config.driver=Wt.driver()}function Me(Ee){return Wt._extend(Ee),oe(),Wt._ready=Wt._initStorage(Wt._config),Wt._ready}var Se=this._driverSet!==null?this._driverSet.catch(function(){return X.resolve()}):X.resolve();return this._driverSet=Se.then(function(){var Ee=Zt[0];return Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(Ee).then(function(Ve){Wt._driver=Ve._driver,oe(),Wt._wrapLibraryMethodsWithReady(),Wt._initDriver=function(en){return function(){var dn=0;return function Tn(){for(;dn<en.length;){var yn=en[dn];return dn++,Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(yn).then(Me).catch(Tn)}oe();var Xn=new Error("No available storage method found.");return Wt._driverSet=X.reject(Xn),Wt._driverSet}()}}(Zt)})}).catch(function(){oe();var Ee=new Error("No available storage method found.");return Wt._driverSet=X.reject(Ee),Wt._driverSet}),ut(this._driverSet,It,Qt),this._driverSet},yt.prototype.supports=function(wt){return!!Rn[wt]},yt.prototype._extend=function(wt){pi(this,wt)},yt.prototype._getSupportedDrivers=function(wt){for(var It=[],Qt=0,Wt=wt.length;Qt<Wt;Qt++){var Zt=wt[Qt];this.supports(Zt)&&It.push(Zt)}return It},yt.prototype._wrapLibraryMethodsWithReady=function(){for(var wt=0,It=ln.length;wt<It;wt++)Zn(this,ln[wt])},yt.prototype.createInstance=function(wt){return new yt(wt)},yt}());I.exports=tn},{3:3}]},{},[4])(4)}).call(this,v(17))},function(b,E,v){var O=v(21),S=v(200),I=v(201),D=Math.max,F=Math.min;b.exports=function(z,J,X){var et,ut,Rt,St,L,R,U=0,W=!1,P=!1,j=!0;if(typeof z!="function")throw new TypeError("Expected a function");function $(B){var ft=et,tt=ut;return et=ut=void 0,U=B,St=z.apply(tt,ft)}function H(B){return U=B,L=setTimeout(Vt,J),W?$(B):St}function Nt(B){var ft=B-R;return R===void 0||ft>=J||ft<0||P&&B-U>=Rt}function Vt(){var B=S();if(Nt(B))return st(B);L=setTimeout(Vt,function(ft){var tt=J-(ft-R);return P?F(tt,Rt-(ft-U)):tt}(B))}function st(B){return L=void 0,j&&et?$(B):(et=ut=void 0,St)}function V(){var B=S(),ft=Nt(B);if(et=arguments,ut=this,R=B,ft){if(L===void 0)return H(R);if(P)return clearTimeout(L),L=setTimeout(Vt,J),$(R)}return L===void 0&&(L=setTimeout(Vt,J)),St}return J=I(J)||0,O(X)&&(W=!!X.leading,Rt=(P="maxWait"in X)?D(I(X.maxWait)||0,J):Rt,j="trailing"in X?!!X.trailing:j),V.cancel=function(){L!==void 0&&clearTimeout(L),U=0,et=R=ut=L=void 0},V.flush=function(){return L===void 0?St:st(S())},V}},function(b,E,v){var O=v(14).Symbol;b.exports=O},function(b,E){b.exports=function(v){return v.webpackPolyfill||(v.deprecate=function(){},v.paths=[],v.children||(v.children=[]),Object.defineProperty(v,"loaded",{enumerable:!0,get:function(){return v.l}}),Object.defineProperty(v,"id",{enumerable:!0,get:function(){return v.i}}),v.webpackPolyfill=1),v}},function(b,E,v){var O=v(152),S=v(153),I=v(154),D=v(155),F=v(156);function z(J){var X=-1,et=J==null?0:J.length;for(this.clear();++X<et;){var ut=J[X];this.set(ut[0],ut[1])}}z.prototype.clear=O,z.prototype.delete=S,z.prototype.get=I,z.prototype.has=D,z.prototype.set=F,b.exports=z},function(b,E,v){var O=v(37);b.exports=function(S,I){for(var D=S.length;D--;)if(O(S[D][0],I))return D;return-1}},function(b,E,v){var O=v(22)(Object,"create");b.exports=O},function(b,E,v){var O=v(174);b.exports=function(S,I){var D=S.__data__;return O(I)?D[typeof I=="string"?"string":"hash"]:D.map}},function(b,E){var v=Array.isArray;b.exports=v},function(b,E,v){var O=v(196),S=v(38),I=v(197),D=v(198),F=v(199),z=v(20),J=v(55),X=J(O),et=J(S),ut=J(I),Rt=J(D),St=J(F),L=z;(O&&L(new O(new ArrayBuffer(1)))!="[object DataView]"||S&&L(new S)!="[object Map]"||I&&L(I.resolve())!="[object Promise]"||D&&L(new D)!="[object Set]"||F&&L(new F)!="[object WeakMap]")&&(L=function(R){var U=z(R),W=U=="[object Object]"?R.constructor:void 0,P=W?J(W):"";if(P)switch(P){case X:return"[object DataView]";case et:return"[object Map]";case ut:return"[object Promise]";case Rt:return"[object Set]";case St:return"[object WeakMap]"}return U}),b.exports=L},function(b,E,v){var O=v(68),S=v(69);b.exports=function(I,D,F,z){var J=!F;F||(F={});for(var X=-1,et=D.length;++X<et;){var ut=D[X],Rt=z?z(F[ut],I[ut],ut,F,I):void 0;Rt===void 0&&(Rt=I[ut]),J?S(F,ut,Rt):O(F,ut,Rt)}return F}},function(b,E,v){var O=v(20),S=v(21);b.exports=function(I){if(!S(I))return!1;var D=O(I);return D=="[object Function]"||D=="[object GeneratorFunction]"||D=="[object AsyncFunction]"||D=="[object Proxy]"}},function(b,E,v){(function(O){v.d(E,"a",function(){return Uh});var S=v(4),I=v(0),D=v(10),F=v(8),z=v(16),J=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:O!==void 0?O:typeof self!="undefined"?self:{};function X(T,d,c){return T(c={path:d,exports:{},require:function(f,A){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(A==null&&c.path)}},c.exports),c.exports}var et=X(function(T){var d=Object.prototype.hasOwnProperty,c="~";function f(){}function A(dt,Pt,kt){this.fn=dt,this.context=Pt,this.once=kt||!1}function k(dt,Pt,kt,he,te){if(typeof kt!="function")throw new TypeError("The listener must be a function");var me=new A(kt,he||dt,te),xe=c?c+Pt:Pt;return dt._events[xe]?dt._events[xe].fn?dt._events[xe]=[dt._events[xe],me]:dt._events[xe].push(me):(dt._events[xe]=me,dt._eventsCount++),dt}function K(dt,Pt){--dt._eventsCount==0?dt._events=new f:delete dt._events[Pt]}function ot(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(c=!1)),ot.prototype.eventNames=function(){var dt,Pt,kt=[];if(this._eventsCount===0)return kt;for(Pt in dt=this._events)d.call(dt,Pt)&&kt.push(c?Pt.slice(1):Pt);return Object.getOwnPropertySymbols?kt.concat(Object.getOwnPropertySymbols(dt)):kt},ot.prototype.listeners=function(dt){var Pt=c?c+dt:dt,kt=this._events[Pt];if(!kt)return[];if(kt.fn)return[kt.fn];for(var he=0,te=kt.length,me=new Array(te);he<te;he++)me[he]=kt[he].fn;return me},ot.prototype.listenerCount=function(dt){var Pt=c?c+dt:dt,kt=this._events[Pt];return kt?kt.fn?1:kt.length:0},ot.prototype.emit=function(dt,Pt,kt,he,te,me){var xe=arguments,Be=c?c+dt:dt;if(!this._events[Be])return!1;var qe,Ye,Je=this._events[Be],je=arguments.length;if(Je.fn){switch(Je.once&&this.removeListener(dt,Je.fn,void 0,!0),je){case 1:return Je.fn.call(Je.context),!0;case 2:return Je.fn.call(Je.context,Pt),!0;case 3:return Je.fn.call(Je.context,Pt,kt),!0;case 4:return Je.fn.call(Je.context,Pt,kt,he),!0;case 5:return Je.fn.call(Je.context,Pt,kt,he,te),!0;case 6:return Je.fn.call(Je.context,Pt,kt,he,te,me),!0}for(Ye=1,qe=new Array(je-1);Ye<je;Ye++)qe[Ye-1]=xe[Ye];Je.fn.apply(Je.context,qe)}else{var pn,_n=Je.length;for(Ye=0;Ye<_n;Ye++)switch(Je[Ye].once&&this.removeListener(dt,Je[Ye].fn,void 0,!0),je){case 1:Je[Ye].fn.call(Je[Ye].context);break;case 2:Je[Ye].fn.call(Je[Ye].context,Pt);break;case 3:Je[Ye].fn.call(Je[Ye].context,Pt,kt);break;case 4:Je[Ye].fn.call(Je[Ye].context,Pt,kt,he);break;default:if(!qe)for(pn=1,qe=new Array(je-1);pn<je;pn++)qe[pn-1]=xe[pn];Je[Ye].fn.apply(Je[Ye].context,qe)}}return!0},ot.prototype.on=function(dt,Pt,kt){return k(this,dt,Pt,kt,!1)},ot.prototype.once=function(dt,Pt,kt){return k(this,dt,Pt,kt,!0)},ot.prototype.removeListener=function(dt,Pt,kt,he){var te=c?c+dt:dt;if(!this._events[te])return this;if(!Pt)return K(this,te),this;var me=this._events[te];if(me.fn)me.fn!==Pt||he&&!me.once||kt&&me.context!==kt||K(this,te);else{for(var xe=0,Be=[],qe=me.length;xe<qe;xe++)(me[xe].fn!==Pt||he&&!me[xe].once||kt&&me[xe].context!==kt)&&Be.push(me[xe]);Be.length?this._events[te]=Be.length===1?Be[0]:Be:K(this,te)}return this},ot.prototype.removeAllListeners=function(dt){var Pt;return dt?(Pt=c?c+dt:dt,this._events[Pt]&&K(this,Pt)):(this._events=new f,this._eventsCount=0),this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.addListener=ot.prototype.on,ot.prefixed=c,ot.EventEmitter=ot,T.exports=ot}),ut=X(function(T,d){(function(c){var f=d&&!d.nodeType&&d,A=T&&!T.nodeType&&T,k=typeof J=="object"&&J;k.global!==k&&k.window!==k&&k.self!==k||(c=k);var K,ot,dt=2147483647,Pt=/^xn--/,kt=/[^\x20-\x7E]/,he=/[\x2E\u3002\uFF0E\uFF61]/g,te={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},me=Math.floor,xe=String.fromCharCode;function Be(Xe){throw RangeError(te[Xe])}function qe(Xe,an){for(var bn=Xe.length,Gn=[];bn--;)Gn[bn]=an(Xe[bn]);return Gn}function Ye(Xe,an){var bn=Xe.split("@"),Gn="";return bn.length>1&&(Gn=bn[0]+"@",Xe=bn[1]),Gn+qe((Xe=Xe.replace(he,".")).split("."),an).join(".")}function Je(Xe){for(var an,bn,Gn=[],qn=0,wi=Xe.length;qn<wi;)(an=Xe.charCodeAt(qn++))>=55296&&an<=56319&&qn<wi?(64512&(bn=Xe.charCodeAt(qn++)))==56320?Gn.push(((1023&an)<<10)+(1023&bn)+65536):(Gn.push(an),qn--):Gn.push(an);return Gn}function je(Xe){return qe(Xe,function(an){var bn="";return an>65535&&(bn+=xe((an-=65536)>>>10&1023|55296),an=56320|1023&an),bn+=xe(an)}).join("")}function pn(Xe,an){return Xe+22+75*(Xe<26)-((an!=0)<<5)}function _n(Xe,an,bn){var Gn=0;for(Xe=bn?me(Xe/700):Xe>>1,Xe+=me(Xe/an);Xe>455;Gn+=36)Xe=me(Xe/35);return me(Gn+36*Xe/(Xe+38))}function Un(Xe){var an,bn,Gn,qn,wi,$n,vi,Ri,Ji,ki,ni,Ei=[],Ui=Xe.length,Gi=0,$i=128,ii=72;for((bn=Xe.lastIndexOf("-"))<0&&(bn=0),Gn=0;Gn<bn;++Gn)Xe.charCodeAt(Gn)>=128&&Be("not-basic"),Ei.push(Xe.charCodeAt(Gn));for(qn=bn>0?bn+1:0;qn<Ui;){for(wi=Gi,$n=1,vi=36;qn>=Ui&&Be("invalid-input"),((Ri=(ni=Xe.charCodeAt(qn++))-48<10?ni-22:ni-65<26?ni-65:ni-97<26?ni-97:36)>=36||Ri>me((dt-Gi)/$n))&&Be("overflow"),Gi+=Ri*$n,!(Ri<(Ji=vi<=ii?1:vi>=ii+26?26:vi-ii));vi+=36)$n>me(dt/(ki=36-Ji))&&Be("overflow"),$n*=ki;ii=_n(Gi-wi,an=Ei.length+1,wi==0),me(Gi/an)>dt-$i&&Be("overflow"),$i+=me(Gi/an),Gi%=an,Ei.splice(Gi++,0,$i)}return je(Ei)}function Dn(Xe){var an,bn,Gn,qn,wi,$n,vi,Ri,Ji,ki,ni,Ei,Ui,Gi,$i,ii=[];for(Ei=(Xe=Je(Xe)).length,an=128,bn=0,wi=72,$n=0;$n<Ei;++$n)(ni=Xe[$n])<128&&ii.push(xe(ni));for(Gn=qn=ii.length,qn&&ii.push("-");Gn<Ei;){for(vi=dt,$n=0;$n<Ei;++$n)(ni=Xe[$n])>=an&&ni<vi&&(vi=ni);for(vi-an>me((dt-bn)/(Ui=Gn+1))&&Be("overflow"),bn+=(vi-an)*Ui,an=vi,$n=0;$n<Ei;++$n)if((ni=Xe[$n])<an&&++bn>dt&&Be("overflow"),ni==an){for(Ri=bn,Ji=36;!(Ri<(ki=Ji<=wi?1:Ji>=wi+26?26:Ji-wi));Ji+=36)$i=Ri-ki,Gi=36-ki,ii.push(xe(pn(ki+$i%Gi,0))),Ri=me($i/Gi);ii.push(xe(pn(Ri,0))),wi=_n(bn,Ui,Gn==qn),bn=0,++Gn}++bn,++an}return ii.join("")}if(K={version:"1.3.2",ucs2:{decode:Je,encode:je},decode:Un,encode:Dn,toASCII:function(Xe){return Ye(Xe,function(an){return kt.test(an)?"xn--"+Dn(an):an})},toUnicode:function(Xe){return Ye(Xe,function(an){return Pt.test(an)?Un(an.slice(4).toLowerCase()):an})}},f&&A)if(T.exports==f)A.exports=K;else for(ot in K)K.hasOwnProperty(ot)&&(f[ot]=K[ot]);else c.punycode=K})(J)}),Rt=function(T){return typeof T=="string"},St=function(T){return typeof T=="object"&&T!==null},L=function(T){return T===null},R=function(T){return T==null};function U(T,d){return Object.prototype.hasOwnProperty.call(T,d)}var W=function(T,d,c,f){d=d||"&",c=c||"=";var A={};if(typeof T!="string"||T.length===0)return A;var k=/\+/g;T=T.split(d);var K=1e3;f&&typeof f.maxKeys=="number"&&(K=f.maxKeys);var ot=T.length;K>0&&ot>K&&(ot=K);for(var dt=0;dt<ot;++dt){var Pt,kt,he,te,me=T[dt].replace(k,"%20"),xe=me.indexOf(c);xe>=0?(Pt=me.substr(0,xe),kt=me.substr(xe+1)):(Pt=me,kt=""),he=decodeURIComponent(Pt),te=decodeURIComponent(kt),U(A,he)?Array.isArray(A[he])?A[he].push(te):A[he]=[A[he],te]:A[he]=te}return A},P=function(T){switch(typeof T){case"string":return T;case"boolean":return T?"true":"false";case"number":return isFinite(T)?T:"";default:return""}},j=function(T,d,c,f){return d=d||"&",c=c||"=",T===null&&(T=void 0),typeof T=="object"?Object.keys(T).map(function(A){var k=encodeURIComponent(P(A))+c;return Array.isArray(T[A])?T[A].map(function(K){return k+encodeURIComponent(P(K))}).join(d):k+encodeURIComponent(P(T[A]))}).join(d):f?encodeURIComponent(P(f))+c+encodeURIComponent(P(T)):""},$=X(function(T,d){d.decode=d.parse=W,d.encode=d.stringify=j}),H=Xt,Nt=function(T,d){return Xt(T,!1,!0).resolve(d)},Vt=function(T){return Rt(T)&&(T=Xt(T)),T instanceof st?T.format():st.prototype.format.call(T)};function st(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var V=/^([a-z0-9.+-]+:)/i,B=/:[0-9]*$/,ft=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,tt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),vt=["'"].concat(tt),Dt=["%","/","?",";","#"].concat(vt),Z=["/","?","#"],pt=/^[+a-z0-9A-Z_-]{0,63}$/,rt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_t={javascript:!0,"javascript:":!0},Et={javascript:!0,"javascript:":!0},Gt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Xt(T,d,c){if(T&&St(T)&&T instanceof st)return T;var f=new st;return f.parse(T,d,c),f}st.prototype.parse=function(T,d,c){if(!Rt(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var f=T.indexOf("?"),A=f!==-1&&f<T.indexOf("#")?"?":"#",k=T.split(A);k[0]=k[0].replace(/\\/g,"/");var K=T=k.join(A);if(K=K.trim(),!c&&T.split("#").length===1){var ot=ft.exec(K);if(ot)return this.path=K,this.href=K,this.pathname=ot[1],ot[2]?(this.search=ot[2],this.query=d?$.parse(this.search.substr(1)):this.search.substr(1)):d&&(this.search="",this.query={}),this}var dt=V.exec(K);if(dt){var Pt=(dt=dt[0]).toLowerCase();this.protocol=Pt,K=K.substr(dt.length)}if(c||dt||K.match(/^\/\/[^@\/]+@[^@\/]+/)){var kt=K.substr(0,2)==="//";!kt||dt&&Et[dt]||(K=K.substr(2),this.slashes=!0)}if(!Et[dt]&&(kt||dt&&!Gt[dt])){for(var he,te,me=-1,xe=0;xe<Z.length;xe++)(Be=K.indexOf(Z[xe]))!==-1&&(me===-1||Be<me)&&(me=Be);for((te=me===-1?K.lastIndexOf("@"):K.lastIndexOf("@",me))!==-1&&(he=K.slice(0,te),K=K.slice(te+1),this.auth=decodeURIComponent(he)),me=-1,xe=0;xe<Dt.length;xe++){var Be;(Be=K.indexOf(Dt[xe]))!==-1&&(me===-1||Be<me)&&(me=Be)}me===-1&&(me=K.length),this.host=K.slice(0,me),K=K.slice(me),this.parseHost(),this.hostname=this.hostname||"";var qe=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!qe)for(var Ye=this.hostname.split(/\./),Je=(xe=0,Ye.length);xe<Je;xe++){var je=Ye[xe];if(je&&!je.match(pt)){for(var pn="",_n=0,Un=je.length;_n<Un;_n++)je.charCodeAt(_n)>127?pn+="x":pn+=je[_n];if(!pn.match(pt)){var Dn=Ye.slice(0,xe),Xe=Ye.slice(xe+1),an=je.match(rt);an&&(Dn.push(an[1]),Xe.unshift(an[2])),Xe.length&&(K="/"+Xe.join(".")+K),this.hostname=Dn.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),qe||(this.hostname=ut.toASCII(this.hostname));var bn=this.port?":"+this.port:"",Gn=this.hostname||"";this.host=Gn+bn,this.href+=this.host,qe&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),K[0]!=="/"&&(K="/"+K))}if(!_t[Pt])for(xe=0,Je=vt.length;xe<Je;xe++){var qn=vt[xe];if(K.indexOf(qn)!==-1){var wi=encodeURIComponent(qn);wi===qn&&(wi=escape(qn)),K=K.split(qn).join(wi)}}var $n=K.indexOf("#");$n!==-1&&(this.hash=K.substr($n),K=K.slice(0,$n));var vi=K.indexOf("?");if(vi!==-1?(this.search=K.substr(vi),this.query=K.substr(vi+1),d&&(this.query=$.parse(this.query)),K=K.slice(0,vi)):d&&(this.search="",this.query={}),K&&(this.pathname=K),Gt[Pt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){bn=this.pathname||"";var Ri=this.search||"";this.path=bn+Ri}return this.href=this.format(),this},st.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var d=this.protocol||"",c=this.pathname||"",f=this.hash||"",A=!1,k="";this.host?A=T+this.host:this.hostname&&(A=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(A+=":"+this.port)),this.query&&St(this.query)&&Object.keys(this.query).length&&(k=$.stringify(this.query));var K=this.search||k&&"?"+k||"";return d&&d.substr(-1)!==":"&&(d+=":"),this.slashes||(!d||Gt[d])&&A!==!1?(A="//"+(A||""),c&&c.charAt(0)!=="/"&&(c="/"+c)):A||(A=""),f&&f.charAt(0)!=="#"&&(f="#"+f),K&&K.charAt(0)!=="?"&&(K="?"+K),d+A+(c=c.replace(/[?#]/g,function(ot){return encodeURIComponent(ot)}))+(K=K.replace("#","%23"))+f},st.prototype.resolve=function(T){return this.resolveObject(Xt(T,!1,!0)).format()},st.prototype.resolveObject=function(T){if(Rt(T)){var d=new st;d.parse(T,!1,!0),T=d}for(var c=new st,f=Object.keys(this),A=0;A<f.length;A++){var k=f[A];c[k]=this[k]}if(c.hash=T.hash,T.href==="")return c.href=c.format(),c;if(T.slashes&&!T.protocol){for(var K=Object.keys(T),ot=0;ot<K.length;ot++){var dt=K[ot];dt!=="protocol"&&(c[dt]=T[dt])}return Gt[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c}if(T.protocol&&T.protocol!==c.protocol){if(!Gt[T.protocol]){for(var Pt=Object.keys(T),kt=0;kt<Pt.length;kt++){var he=Pt[kt];c[he]=T[he]}return c.href=c.format(),c}if(c.protocol=T.protocol,T.host||Et[T.protocol])c.pathname=T.pathname;else{for(var te=(T.pathname||"").split("/");te.length&&!(T.host=te.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),te[0]!==""&&te.unshift(""),te.length<2&&te.unshift(""),c.pathname=te.join("/")}if(c.search=T.search,c.query=T.query,c.host=T.host||"",c.auth=T.auth,c.hostname=T.hostname||T.host,c.port=T.port,c.pathname||c.search){var me=c.pathname||"",xe=c.search||"";c.path=me+xe}return c.slashes=c.slashes||T.slashes,c.href=c.format(),c}var Be=c.pathname&&c.pathname.charAt(0)==="/",qe=T.host||T.pathname&&T.pathname.charAt(0)==="/",Ye=qe||Be||c.host&&T.pathname,Je=Ye,je=c.pathname&&c.pathname.split("/")||[],pn=(te=T.pathname&&T.pathname.split("/")||[],c.protocol&&!Gt[c.protocol]);if(pn&&(c.hostname="",c.port=null,c.host&&(je[0]===""?je[0]=c.host:je.unshift(c.host)),c.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(te[0]===""?te[0]=T.host:te.unshift(T.host)),T.host=null),Ye=Ye&&(te[0]===""||je[0]==="")),qe)c.host=T.host||T.host===""?T.host:c.host,c.hostname=T.hostname||T.hostname===""?T.hostname:c.hostname,c.search=T.search,c.query=T.query,je=te;else if(te.length)je||(je=[]),je.pop(),je=je.concat(te),c.search=T.search,c.query=T.query;else if(!R(T.search))return pn&&(c.hostname=c.host=je.shift(),(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),c.search=T.search,c.query=T.query,L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c;if(!je.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var _n=je.slice(-1)[0],Un=(c.host||T.host||je.length>1)&&(_n==="."||_n==="..")||_n==="",Dn=0,Xe=je.length;Xe>=0;Xe--)(_n=je[Xe])==="."?je.splice(Xe,1):_n===".."?(je.splice(Xe,1),Dn++):Dn&&(je.splice(Xe,1),Dn--);if(!Ye&&!Je)for(;Dn--;Dn)je.unshift("..");!Ye||je[0]===""||je[0]&&je[0].charAt(0)==="/"||je.unshift(""),Un&&je.join("/").substr(-1)!=="/"&&je.push("");var an,bn=je[0]===""||je[0]&&je[0].charAt(0)==="/";return pn&&(c.hostname=c.host=bn?"":je.length?je.shift():"",(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),(Ye=Ye||c.host&&je.length)&&!bn&&je.unshift(""),je.length?c.pathname=je.join("/"):(c.pathname=null,c.path=null),L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=T.auth||c.auth,c.slashes=c.slashes||T.slashes,c.href=c.format(),c},st.prototype.parseHost=function(){var T=this.host,d=B.exec(T);d&&((d=d[0])!==":"&&(this.port=d.substr(1)),T=T.substr(0,T.length-d.length)),T&&(this.hostname=T)};/*!
 * @pixi/utils - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Jt={parse:H,format:Vt,resolve:Nt};S.b.RETINA_PREFIX=/@([0-9\.]+)x/,S.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var at,_e=!1,ke=function(){for(var T=[],d=[],c=0;c<32;c++)T[c]=c,d[c]=c;T[I.b.NORMAL_NPM]=I.b.NORMAL,T[I.b.ADD_NPM]=I.b.ADD,T[I.b.SCREEN_NPM]=I.b.SCREEN,d[I.b.NORMAL]=I.b.NORMAL_NPM,d[I.b.ADD]=I.b.ADD_NPM,d[I.b.SCREEN]=I.b.SCREEN_NPM;var f=[];return f.push(d),f.push(T),f}();function Oe(T){if(T.BYTES_PER_ELEMENT===4)return T instanceof Float32Array?"Float32Array":T instanceof Uint32Array?"Uint32Array":"Int32Array";if(T.BYTES_PER_ELEMENT===2){if(T instanceof Uint16Array)return"Uint16Array"}else if(T.BYTES_PER_ELEMENT===1&&T instanceof Uint8Array)return"Uint8Array";return null}function Ae(T){return T+=T===0?1:0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,(T|=T>>>16)+1}function ze(T){return!(T&T-1||!T)}function $e(T){var d=(T>65535?1:0)<<4,c=((T>>>=d)>255?1:0)<<3;return d|=c,d|=c=((T>>>=c)>15?1:0)<<2,(d|=c=((T>>>=c)>3?1:0)<<1)|(T>>>=c)>>1}var cn=0;function Ue(){return++cn}var Ge={};function Rn(T,d,c){if(c===void 0&&(c=3),!Ge[d]){var f=new Error().stack;f===void 0?console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T):(f=f.split(`
`).splice(c).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",d+`
Deprecated since v`+T),console.warn(f),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T),console.warn(f))),Ge[d]=!0}}var re,pe={},we=Object.create(null),ln=Object.create(null);function In(T,d){if(d===void 0&&(d=globalThis.location),T.indexOf("data:")===0)return"";d=d||globalThis.location,re||(re=document.createElement("a")),re.href=T;var c=Jt.parse(re.href),f=!c.port&&d.port===""||c.port===d.port;return c.hostname===d.hostname&&f&&c.protocol===d.protocol?"":"anonymous"}function Zn(T,d){var c=S.b.RETINA_PREFIX.exec(T);return c?parseFloat(c[1]):d!==void 0?d:1}/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(){function T(d,c,f){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=f||S.b.RESOLUTION,this.resize(d,c)}T.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},T.prototype.resize=function(d,c){this.canvas.width=Math.round(d*this.resolution),this.canvas.height=Math.round(c*this.resolution)},T.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(T.prototype,"width",{get:function(){return this.canvas.width},set:function(d){this.canvas.width=Math.round(d)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this.canvas.height},set:function(d){this.canvas.height=Math.round(d)},enumerable:!1,configurable:!0})})();var pi,tn=function(){function T(d){this.items=[],this._name=d,this._aliasCount=0}return T.prototype.emit=function(d,c,f,A,k,K,ot,dt){if(arguments.length>8)throw new Error("max arguments reached");var Pt=this,kt=Pt.name,he=Pt.items;this._aliasCount++;for(var te=0,me=he.length;te<me;te++)he[te][kt](d,c,f,A,k,K,ot,dt);return he===this.items&&this._aliasCount--,this},T.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},T.prototype.add=function(d){return d[this._name]&&(this.ensureNonAliasedItems(),this.remove(d),this.items.push(d)),this},T.prototype.remove=function(d){var c=this.items.indexOf(d);return c!==-1&&(this.ensureNonAliasedItems(),this.items.splice(c,1)),this},T.prototype.contains=function(d){return this.items.indexOf(d)!==-1},T.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},T.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(T.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),T}();Object.defineProperties(tn.prototype,{dispatch:{value:tn.prototype.emit},run:{value:tn.prototype.emit}}),S.b.TARGET_FPMS=.06,function(T){T[T.INTERACTION=50]="INTERACTION",T[T.HIGH=25]="HIGH",T[T.NORMAL=0]="NORMAL",T[T.LOW=-25]="LOW",T[T.UTILITY=-50]="UTILITY"}(pi||(pi={}));var yt,wt=function(){function T(d,c,f,A){c===void 0&&(c=null),f===void 0&&(f=0),A===void 0&&(A=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=d,this.context=c,this.priority=f,this.once=A}return T.prototype.match=function(d,c){return c===void 0&&(c=null),this.fn===d&&this.context===c},T.prototype.emit=function(d){this.fn&&(this.context?this.fn.call(this.context,d):this.fn(d));var c=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),c},T.prototype.connect=function(d){this.previous=d,d.next&&(d.next.previous=this),this.next=d.next,d.next=this},T.prototype.destroy=function(d){d===void 0&&(d=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var c=this.next;return this.next=d?null:c,this.previous=null,c},T}(),It=function(){function T(){var d=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new wt(null,null,1/0),this.deltaMS=1/S.b.TARGET_FPMS,this.elapsedMS=1/S.b.TARGET_FPMS,this._tick=function(c){d._requestId=null,d.started&&(d.update(c),d.started&&d._requestId===null&&d._head.next&&(d._requestId=requestAnimationFrame(d._tick)))}}return T.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},T.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},T.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},T.prototype.add=function(d,c,f){return f===void 0&&(f=pi.NORMAL),this._addListener(new wt(d,c,f))},T.prototype.addOnce=function(d,c,f){return f===void 0&&(f=pi.NORMAL),this._addListener(new wt(d,c,f,!0))},T.prototype._addListener=function(d){var c=this._head.next,f=this._head;if(c){for(;c;){if(d.priority>c.priority){d.connect(f);break}f=c,c=c.next}d.previous||d.connect(f)}else d.connect(f);return this._startIfPossible(),this},T.prototype.remove=function(d,c){for(var f=this._head.next;f;)f=f.match(d,c)?f.destroy():f.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(T.prototype,"count",{get:function(){if(!this._head)return 0;for(var d=0,c=this._head;c=c.next;)d++;return d},enumerable:!1,configurable:!0}),T.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},T.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},T.prototype.destroy=function(){if(!this._protected){this.stop();for(var d=this._head.next;d;)d=d.destroy(!0);this._head.destroy(),this._head=null}},T.prototype.update=function(d){var c;if(d===void 0&&(d=performance.now()),d>this.lastTime){if((c=this.elapsedMS=d-this.lastTime)>this._maxElapsedMS&&(c=this._maxElapsedMS),c*=this.speed,this._minElapsedMS){var f=d-this._lastFrame|0;if(f<this._minElapsedMS)return;this._lastFrame=d-f%this._minElapsedMS}this.deltaMS=c,this.deltaTime=this.deltaMS*S.b.TARGET_FPMS;for(var A=this._head,k=A.next;k;)k=k.emit(this.deltaTime);A.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=d},Object.defineProperty(T.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(d){var c=Math.min(this.maxFPS,d),f=Math.min(Math.max(0,c)/1e3,S.b.TARGET_FPMS);this._maxElapsedMS=1/f},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(d){if(d===0)this._minElapsedMS=0;else{var c=Math.max(this.minFPS,d);this._minElapsedMS=1/(c/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(T,"shared",{get:function(){if(!T._shared){var d=T._shared=new T;d.autoStart=!0,d._protected=!0}return T._shared},enumerable:!1,configurable:!0}),Object.defineProperty(T,"system",{get:function(){if(!T._system){var d=T._system=new T;d.autoStart=!0,d._protected=!0}return T._system},enumerable:!1,configurable:!0}),T}(),Qt=2*Math.PI;(function(T){T[T.POLY=0]="POLY",T[T.RECT=1]="RECT",T[T.CIRC=2]="CIRC",T[T.ELIP=3]="ELIP",T[T.RREC=4]="RREC"})(yt||(yt={}));var Wt=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this.x=0,this.y=0,this.x=d,this.y=c}return T.prototype.clone=function(){return new T(this.x,this.y)},T.prototype.copyFrom=function(d){return this.set(d.x,d.y),this},T.prototype.copyTo=function(d){return d.set(this.x,this.y),d},T.prototype.equals=function(d){return d.x===this.x&&d.y===this.y},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x=d,this.y=c,this},T.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},T}(),Zt=[new Wt,new Wt,new Wt,new Wt],oe=function(){function T(d,c,f,A){d===void 0&&(d=0),c===void 0&&(c=0),f===void 0&&(f=0),A===void 0&&(A=0),this.x=Number(d),this.y=Number(c),this.width=Number(f),this.height=Number(A),this.type=yt.RECT}return Object.defineProperty(T.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(T,"EMPTY",{get:function(){return new T(0,0,0,0)},enumerable:!1,configurable:!0}),T.prototype.clone=function(){return new T(this.x,this.y,this.width,this.height)},T.prototype.copyFrom=function(d){return this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this},T.prototype.copyTo=function(d){return d.x=this.x,d.y=this.y,d.width=this.width,d.height=this.height,d},T.prototype.contains=function(d,c){return!(this.width<=0||this.height<=0)&&d>=this.x&&d<this.x+this.width&&c>=this.y&&c<this.y+this.height},T.prototype.intersects=function(d,c){if(!c){var f=this.x<d.x?d.x:this.x;if((this.right>d.right?d.right:this.right)<=f)return!1;var A=this.y<d.y?d.y:this.y;return(this.bottom>d.bottom?d.bottom:this.bottom)>A}var k=this.left,K=this.right,ot=this.top,dt=this.bottom;if(K<=k||dt<=ot)return!1;var Pt=Zt[0].set(d.left,d.top),kt=Zt[1].set(d.left,d.bottom),he=Zt[2].set(d.right,d.top),te=Zt[3].set(d.right,d.bottom);if(he.x<=Pt.x||kt.y<=Pt.y)return!1;var me=Math.sign(c.a*c.d-c.b*c.c);if(me===0||(c.apply(Pt,Pt),c.apply(kt,kt),c.apply(he,he),c.apply(te,te),Math.max(Pt.x,kt.x,he.x,te.x)<=k||Math.min(Pt.x,kt.x,he.x,te.x)>=K||Math.max(Pt.y,kt.y,he.y,te.y)<=ot||Math.min(Pt.y,kt.y,he.y,te.y)>=dt))return!1;var xe=me*(kt.y-Pt.y),Be=me*(Pt.x-kt.x),qe=xe*k+Be*ot,Ye=xe*K+Be*ot,Je=xe*k+Be*dt,je=xe*K+Be*dt;if(Math.max(qe,Ye,Je,je)<=xe*Pt.x+Be*Pt.y||Math.min(qe,Ye,Je,je)>=xe*te.x+Be*te.y)return!1;var pn=me*(Pt.y-he.y),_n=me*(he.x-Pt.x),Un=pn*k+_n*ot,Dn=pn*K+_n*ot,Xe=pn*k+_n*dt,an=pn*K+_n*dt;return!(Math.max(Un,Dn,Xe,an)<=pn*Pt.x+_n*Pt.y||Math.min(Un,Dn,Xe,an)>=pn*te.x+_n*te.y)},T.prototype.pad=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x-=d,this.y-=c,this.width+=2*d,this.height+=2*c,this},T.prototype.fit=function(d){var c=Math.max(this.x,d.x),f=Math.min(this.x+this.width,d.x+d.width),A=Math.max(this.y,d.y),k=Math.min(this.y+this.height,d.y+d.height);return this.x=c,this.width=Math.max(f-c,0),this.y=A,this.height=Math.max(k-A,0),this},T.prototype.ceil=function(d,c){d===void 0&&(d=1),c===void 0&&(c=.001);var f=Math.ceil((this.x+this.width-c)*d)/d,A=Math.ceil((this.y+this.height-c)*d)/d;return this.x=Math.floor((this.x+c)*d)/d,this.y=Math.floor((this.y+c)*d)/d,this.width=f-this.x,this.height=A-this.y,this},T.prototype.enlarge=function(d){var c=Math.min(this.x,d.x),f=Math.max(this.x+this.width,d.x+d.width),A=Math.min(this.y,d.y),k=Math.max(this.y+this.height,d.y+d.height);return this.x=c,this.width=f-c,this.y=A,this.height=k-A,this},T.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},T}(),Me=function(){function T(d,c,f,A){f===void 0&&(f=0),A===void 0&&(A=0),this._x=f,this._y=A,this.cb=d,this.scope=c}return T.prototype.clone=function(d,c){return d===void 0&&(d=this.cb),c===void 0&&(c=this.scope),new T(d,c,this._x,this._y)},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this._x===d&&this._y===c||(this._x=d,this._y=c,this.cb.call(this.scope)),this},T.prototype.copyFrom=function(d){return this._x===d.x&&this._y===d.y||(this._x=d.x,this._y=d.y,this.cb.call(this.scope)),this},T.prototype.copyTo=function(d){return d.set(this._x,this._y),d},T.prototype.equals=function(d){return d.x===this._x&&d.y===this._y},T.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(T.prototype,"x",{get:function(){return this._x},set:function(d){this._x!==d&&(this._x=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"y",{get:function(){return this._y},set:function(d){this._y!==d&&(this._y=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),T}(),Se=function(){function T(d,c,f,A,k,K){d===void 0&&(d=1),c===void 0&&(c=0),f===void 0&&(f=0),A===void 0&&(A=1),k===void 0&&(k=0),K===void 0&&(K=0),this.array=null,this.a=d,this.b=c,this.c=f,this.d=A,this.tx=k,this.ty=K}return T.prototype.fromArray=function(d){this.a=d[0],this.b=d[1],this.c=d[3],this.d=d[4],this.tx=d[2],this.ty=d[5]},T.prototype.set=function(d,c,f,A,k,K){return this.a=d,this.b=c,this.c=f,this.d=A,this.tx=k,this.ty=K,this},T.prototype.toArray=function(d,c){this.array||(this.array=new Float32Array(9));var f=c||this.array;return d?(f[0]=this.a,f[1]=this.b,f[2]=0,f[3]=this.c,f[4]=this.d,f[5]=0,f[6]=this.tx,f[7]=this.ty,f[8]=1):(f[0]=this.a,f[1]=this.c,f[2]=this.tx,f[3]=this.b,f[4]=this.d,f[5]=this.ty,f[6]=0,f[7]=0,f[8]=1),f},T.prototype.apply=function(d,c){c=c||new Wt;var f=d.x,A=d.y;return c.x=this.a*f+this.c*A+this.tx,c.y=this.b*f+this.d*A+this.ty,c},T.prototype.applyInverse=function(d,c){c=c||new Wt;var f=1/(this.a*this.d+this.c*-this.b),A=d.x,k=d.y;return c.x=this.d*f*A+-this.c*f*k+(this.ty*this.c-this.tx*this.d)*f,c.y=this.a*f*k+-this.b*f*A+(-this.ty*this.a+this.tx*this.b)*f,c},T.prototype.translate=function(d,c){return this.tx+=d,this.ty+=c,this},T.prototype.scale=function(d,c){return this.a*=d,this.d*=c,this.c*=d,this.b*=c,this.tx*=d,this.ty*=c,this},T.prototype.rotate=function(d){var c=Math.cos(d),f=Math.sin(d),A=this.a,k=this.c,K=this.tx;return this.a=A*c-this.b*f,this.b=A*f+this.b*c,this.c=k*c-this.d*f,this.d=k*f+this.d*c,this.tx=K*c-this.ty*f,this.ty=K*f+this.ty*c,this},T.prototype.append=function(d){var c=this.a,f=this.b,A=this.c,k=this.d;return this.a=d.a*c+d.b*A,this.b=d.a*f+d.b*k,this.c=d.c*c+d.d*A,this.d=d.c*f+d.d*k,this.tx=d.tx*c+d.ty*A+this.tx,this.ty=d.tx*f+d.ty*k+this.ty,this},T.prototype.setTransform=function(d,c,f,A,k,K,ot,dt,Pt){return this.a=Math.cos(ot+Pt)*k,this.b=Math.sin(ot+Pt)*k,this.c=-Math.sin(ot-dt)*K,this.d=Math.cos(ot-dt)*K,this.tx=d-(f*this.a+A*this.c),this.ty=c-(f*this.b+A*this.d),this},T.prototype.prepend=function(d){var c=this.tx;if(d.a!==1||d.b!==0||d.c!==0||d.d!==1){var f=this.a,A=this.c;this.a=f*d.a+this.b*d.c,this.b=f*d.b+this.b*d.d,this.c=A*d.a+this.d*d.c,this.d=A*d.b+this.d*d.d}return this.tx=c*d.a+this.ty*d.c+d.tx,this.ty=c*d.b+this.ty*d.d+d.ty,this},T.prototype.decompose=function(d){var c=this.a,f=this.b,A=this.c,k=this.d,K=d.pivot,ot=-Math.atan2(-A,k),dt=Math.atan2(f,c),Pt=Math.abs(ot+dt);return Pt<1e-5||Math.abs(Qt-Pt)<1e-5?(d.rotation=dt,d.skew.x=d.skew.y=0):(d.rotation=0,d.skew.x=ot,d.skew.y=dt),d.scale.x=Math.sqrt(c*c+f*f),d.scale.y=Math.sqrt(A*A+k*k),d.position.x=this.tx+(K.x*c+K.y*A),d.position.y=this.ty+(K.x*f+K.y*k),d},T.prototype.invert=function(){var d=this.a,c=this.b,f=this.c,A=this.d,k=this.tx,K=d*A-c*f;return this.a=A/K,this.b=-c/K,this.c=-f/K,this.d=d/K,this.tx=(f*this.ty-A*k)/K,this.ty=-(d*this.ty-c*k)/K,this},T.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},T.prototype.clone=function(){var d=new T;return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyTo=function(d){return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyFrom=function(d){return this.a=d.a,this.b=d.b,this.c=d.c,this.d=d.d,this.tx=d.tx,this.ty=d.ty,this},T.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(T,"IDENTITY",{get:function(){return new T},enumerable:!1,configurable:!0}),Object.defineProperty(T,"TEMP_MATRIX",{get:function(){return new T},enumerable:!1,configurable:!0}),T}(),Ee=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ve=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],en=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],dn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Tn=[],yn=[],Xn=Math.sign;(function(){for(var T=0;T<16;T++){var d=[];Tn.push(d);for(var c=0;c<16;c++)for(var f=Xn(Ee[T]*Ee[c]+en[T]*Ve[c]),A=Xn(Ve[T]*Ee[c]+dn[T]*Ve[c]),k=Xn(Ee[T]*en[c]+en[T]*dn[c]),K=Xn(Ve[T]*en[c]+dn[T]*dn[c]),ot=0;ot<16;ot++)if(Ee[ot]===f&&Ve[ot]===A&&en[ot]===k&&dn[ot]===K){d.push(ot);break}}for(T=0;T<16;T++){var dt=new Se;dt.set(Ee[T],Ve[T],en[T],dn[T],0,0),yn.push(dt)}})();var Pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(T){return Ee[T]},uY:function(T){return Ve[T]},vX:function(T){return en[T]},vY:function(T){return dn[T]},inv:function(T){return 8&T?15&T:7&-T},add:function(T,d){return Tn[T][d]},sub:function(T,d){return Tn[T][Pn.inv(d)]},rotate180:function(T){return 4^T},isVertical:function(T){return(3&T)==2},byDirection:function(T,d){return 2*Math.abs(T)<=Math.abs(d)?d>=0?Pn.S:Pn.N:2*Math.abs(d)<=Math.abs(T)?T>0?Pn.E:Pn.W:d>0?T>0?Pn.SE:Pn.SW:T>0?Pn.NE:Pn.NW},matrixAppendRotationInv:function(T,d,c,f){c===void 0&&(c=0),f===void 0&&(f=0);var A=yn[Pn.inv(d)];A.tx=c,A.ty=f,T.append(A)}};(function(){function T(){this.worldTransform=new Se,this.localTransform=new Se,this.position=new Me(this.onChange,this,0,0),this.scale=new Me(this.onChange,this,1,1),this.pivot=new Me(this.onChange,this,0,0),this.skew=new Me(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}T.prototype.onChange=function(){this._localID++},T.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},T.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},T.prototype.updateLocalTransform=function(){var d=this.localTransform;this._localID!==this._currentLocalID&&(d.a=this._cx*this.scale.x,d.b=this._sx*this.scale.x,d.c=this._cy*this.scale.y,d.d=this._sy*this.scale.y,d.tx=this.position.x-(this.pivot.x*d.a+this.pivot.y*d.c),d.ty=this.position.y-(this.pivot.x*d.b+this.pivot.y*d.d),this._currentLocalID=this._localID,this._parentID=-1)},T.prototype.updateTransform=function(d){var c=this.localTransform;if(this._localID!==this._currentLocalID&&(c.a=this._cx*this.scale.x,c.b=this._sx*this.scale.x,c.c=this._cy*this.scale.y,c.d=this._sy*this.scale.y,c.tx=this.position.x-(this.pivot.x*c.a+this.pivot.y*c.c),c.ty=this.position.y-(this.pivot.x*c.b+this.pivot.y*c.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==d._worldID){var f=d.worldTransform,A=this.worldTransform;A.a=c.a*f.a+c.b*f.c,A.b=c.a*f.b+c.b*f.d,A.c=c.c*f.a+c.d*f.c,A.d=c.c*f.b+c.d*f.d,A.tx=c.tx*f.a+c.ty*f.c+f.tx,A.ty=c.tx*f.b+c.ty*f.d+f.ty,this._parentID=d._worldID,this._worldID++}},T.prototype.setFromMatrix=function(d){d.decompose(this),this._localID++},Object.defineProperty(T.prototype,"rotation",{get:function(){return this._rotation},set:function(d){this._rotation!==d&&(this._rotation=d,this.updateSkew())},enumerable:!1,configurable:!0}),T.IDENTITY=new T})(),S.b.PREFER_ENV=S.a.any?I.g.WEBGL:I.g.WEBGL2,S.b.STRICT_TEXTURE_CACHE=!1;var zi=[];function fo(T,d){if(!T)return null;var c="";if(typeof T=="string"){var f=/\.(\w{3,4})(?:$|\?|#)/i.exec(T);f&&(c=f[1].toLowerCase())}for(var A=zi.length-1;A>=0;--A){var k=zi[A];if(k.test&&k.test(T,c))return new k(T,d)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var io=function(T,d){return(io=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var A in f)f.hasOwnProperty(A)&&(c[A]=f[A])})(T,d)};function Fn(T,d){function c(){this.constructor=T}io(T,d),T.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}var Yo=function(){return(Yo=Object.assign||function(T){for(var d,c=arguments,f=1,A=arguments.length;f<A;f++)for(var k in d=c[f])Object.prototype.hasOwnProperty.call(d,k)&&(T[k]=d[k]);return T}).apply(this,arguments)},ro=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this._width=d,this._height=c,this.destroyed=!1,this.internal=!1,this.onResize=new tn("setRealSize"),this.onUpdate=new tn("update"),this.onError=new tn("onError")}return T.prototype.bind=function(d){this.onResize.add(d),this.onUpdate.add(d),this.onError.add(d),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},T.prototype.unbind=function(d){this.onResize.remove(d),this.onUpdate.remove(d),this.onError.remove(d)},T.prototype.resize=function(d,c){d===this._width&&c===this._height||(this._width=d,this._height=c,this.onResize.emit(d,c))},Object.defineProperty(T.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),T.prototype.update=function(){this.destroyed||this.onUpdate.emit()},T.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(T.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),T.prototype.style=function(d,c,f){return!1},T.prototype.dispose=function(){},T.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},T.test=function(d,c){return!1},T}(),mo=function(T){function d(c,f){var A=this,k=f||{},K=k.width,ot=k.height;if(!K||!ot)throw new Error("BufferResource width or height invalid");return(A=T.call(this,K,ot)||this).data=c,A}return Fn(d,T),d.prototype.upload=function(c,f,A){var k=c.gl;k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK);var K=f.realWidth,ot=f.realHeight;return A.width===K&&A.height===ot?k.texSubImage2D(f.target,0,0,0,K,ot,f.format,A.type,this.data):(A.width=K,A.height=ot,k.texImage2D(f.target,0,A.internalFormat,K,ot,0,f.format,A.type,this.data)),!0},d.prototype.dispose=function(){this.data=null},d.test=function(c){return c instanceof Float32Array||c instanceof Uint8Array||c instanceof Uint32Array},d}(ro),kn={scaleMode:I.p.NEAREST,format:I.h.RGBA,alphaMode:I.a.NPM},jn=function(T){function d(c,f){c===void 0&&(c=null),f===void 0&&(f=null);var A=T.call(this)||this,k=(f=f||{}).alphaMode,K=f.mipmap,ot=f.anisotropicLevel,dt=f.scaleMode,Pt=f.width,kt=f.height,he=f.wrapMode,te=f.format,me=f.type,xe=f.target,Be=f.resolution,qe=f.resourceOptions;return!c||c instanceof ro||((c=fo(c,qe)).internal=!0),A.resolution=Be||S.b.RESOLUTION,A.width=Math.round((Pt||0)*A.resolution)/A.resolution,A.height=Math.round((kt||0)*A.resolution)/A.resolution,A._mipmap=K!==void 0?K:S.b.MIPMAP_TEXTURES,A.anisotropicLevel=ot!==void 0?ot:S.b.ANISOTROPIC_LEVEL,A._wrapMode=he||S.b.WRAP_MODE,A._scaleMode=dt!==void 0?dt:S.b.SCALE_MODE,A.format=te||I.h.RGBA,A.type=me||I.r.UNSIGNED_BYTE,A.target=xe||I.q.TEXTURE_2D,A.alphaMode=k!==void 0?k:I.a.UNPACK,A.uid=Ue(),A.touched=0,A.isPowerOfTwo=!1,A._refreshPOT(),A._glTextures={},A.dirtyId=0,A.dirtyStyleId=0,A.cacheId=null,A.valid=Pt>0&&kt>0,A.textureCacheIds=[],A.destroyed=!1,A.resource=null,A._batchEnabled=0,A._batchLocation=0,A.parentTextureArray=null,A.setResource(c),A}return Fn(d,T),Object.defineProperty(d.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mipmap",{get:function(){return this._mipmap},set:function(c){this._mipmap!==c&&(this._mipmap=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(c){this._scaleMode!==c&&(this._scaleMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(c){this._wrapMode!==c&&(this._wrapMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),d.prototype.setStyle=function(c,f){var A;return c!==void 0&&c!==this.scaleMode&&(this.scaleMode=c,A=!0),f!==void 0&&f!==this.mipmap&&(this.mipmap=f,A=!0),A&&this.dirtyStyleId++,this},d.prototype.setSize=function(c,f,A){return A=A||this.resolution,this.setRealSize(c*A,f*A,A)},d.prototype.setRealSize=function(c,f,A){return this.resolution=A||this.resolution,this.width=Math.round(c)/this.resolution,this.height=Math.round(f)/this.resolution,this._refreshPOT(),this.update(),this},d.prototype._refreshPOT=function(){this.isPowerOfTwo=ze(this.realWidth)&&ze(this.realHeight)},d.prototype.setResolution=function(c){var f=this.resolution;return f===c||(this.resolution=c,this.valid&&(this.width=Math.round(this.width*f)/c,this.height=Math.round(this.height*f)/c,this.emit("update",this)),this._refreshPOT()),this},d.prototype.setResource=function(c){if(this.resource===c)return this;if(this.resource)throw new Error("Resource can be set only once");return c.bind(this),this.resource=c,this},d.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},d.prototype.onError=function(c){this.emit("error",this,c)},d.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ln[this.cacheId],delete we[this.cacheId],this.cacheId=null),this.dispose(),d.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},d.prototype.dispose=function(){this.emit("dispose",this)},d.prototype.castToBaseTexture=function(){return this},d.from=function(c,f,A){A===void 0&&(A=S.b.STRICT_TEXTURE_CACHE);var k=typeof c=="string",K=null;if(k)K=c;else{if(!c._pixiId){var ot=f&&f.pixiIdPrefix||"pixiid";c._pixiId=ot+"_"+Ue()}K=c._pixiId}var dt=ln[K];if(k&&A&&!dt)throw new Error('The cacheId "'+K+'" does not exist in BaseTextureCache.');return dt||((dt=new d(c,f)).cacheId=K,d.addToCache(dt,K)),dt},d.fromBuffer=function(c,f,A,k){c=c||new Float32Array(f*A*4);var K=new mo(c,{width:f,height:A}),ot=c instanceof Float32Array?I.r.FLOAT:I.r.UNSIGNED_BYTE;return new d(K,Object.assign(kn,k||{width:f,height:A,type:ot}))},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),ln[f]&&console.warn("BaseTexture added to the cache with an id ["+f+"] that already had an entry"),ln[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=ln[c];if(f){var A=f.textureCacheIds.indexOf(c);return A>-1&&f.textureCacheIds.splice(A,1),delete ln[c],f}}else if(c&&c.textureCacheIds){for(var k=0;k<c.textureCacheIds.length;++k)delete ln[c.textureCacheIds[k]];return c.textureCacheIds.length=0,c}return null},d._globalBatch=0,d}(et),Ki=function(T){function d(c,f){var A=this,k=f||{},K=k.width,ot=k.height;(A=T.call(this,K,ot)||this).items=[],A.itemDirtyIds=[];for(var dt=0;dt<c;dt++){var Pt=new jn;A.items.push(Pt),A.itemDirtyIds.push(-2)}return A.length=c,A._load=null,A.baseTexture=null,A}return Fn(d,T),d.prototype.initFromArray=function(c,f){for(var A=0;A<this.length;A++)c[A]&&(c[A].castToBaseTexture?this.addBaseTextureAt(c[A].castToBaseTexture(),A):c[A]instanceof ro?this.addResourceAt(c[A],A):this.addResourceAt(fo(c[A],f),A))},d.prototype.dispose=function(){for(var c=0,f=this.length;c<f;c++)this.items[c].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},d.prototype.addResourceAt=function(c,f){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");return c.valid&&!this.valid&&this.resize(c.width,c.height),this.items[f].setResource(c),this},d.prototype.bind=function(c){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");T.prototype.bind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=c,this.items[f].on("update",c.update,c)},d.prototype.unbind=function(c){T.prototype.unbind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=null,this.items[f].off("update",c.update,c)},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.items.map(function(A){return A.resource}).filter(function(A){return A}).map(function(A){return A.load()});return this._load=Promise.all(f).then(function(){var A=c.items[0],k=A.realWidth,K=A.realHeight;return c.resize(k,K),Promise.resolve(c)}),this._load},d}(ro),Wr=function(T){function d(c,f){var A,k,K=this,ot=f||{},dt=ot.width,Pt=ot.height;return Array.isArray(c)?(A=c,k=c.length):k=c,K=T.call(this,k,{width:dt,height:Pt})||this,A&&K.initFromArray(A,f),K}return Fn(d,T),d.prototype.addBaseTextureAt=function(c,f){if(!c.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(c.resource,f),this},d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=I.q.TEXTURE_2D_ARRAY},d.prototype.upload=function(c,f,A){var k=this.length,K=this.itemDirtyIds,ot=this.items,dt=c.gl;A.dirtyId<0&&dt.texImage3D(dt.TEXTURE_2D_ARRAY,0,A.internalFormat,this._width,this._height,k,0,f.format,A.type,null);for(var Pt=0;Pt<k;Pt++){var kt=ot[Pt];K[Pt]<kt.dirtyId&&(K[Pt]=kt.dirtyId,kt.valid&&dt.texSubImage3D(dt.TEXTURE_2D_ARRAY,0,0,0,Pt,kt.resource.width,kt.resource.height,1,f.format,A.type,kt.resource.source))}return!0},d}(Ki),Mi=function(T){function d(c){var f=this,A=c,k=A.naturalWidth||A.videoWidth||A.width,K=A.naturalHeight||A.videoHeight||A.height;return(f=T.call(this,k,K)||this).source=c,f.noSubImage=!1,f}return Fn(d,T),d.crossOrigin=function(c,f,A){A===void 0&&f.indexOf("data:")!==0?c.crossOrigin=In(f):A!==!1&&(c.crossOrigin=typeof A=="string"?A:"anonymous")},d.prototype.upload=function(c,f,A,k){var K=c.gl,ot=f.realWidth,dt=f.realHeight;if((k=k||this.source)instanceof HTMLImageElement){if(!k.complete||k.naturalWidth===0)return!1}else if(k instanceof HTMLVideoElement&&k.readyState<=1)return!1;return K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK),this.noSubImage||f.target!==K.TEXTURE_2D||A.width!==ot||A.height!==dt?(A.width=ot,A.height=dt,K.texImage2D(f.target,0,A.internalFormat,f.format,A.type,k)):K.texSubImage2D(K.TEXTURE_2D,0,0,0,f.format,A.type,k),!0},d.prototype.update=function(){if(!this.destroyed){var c=this.source,f=c.naturalWidth||c.videoWidth||c.width,A=c.naturalHeight||c.videoHeight||c.height;this.resize(f,A),T.prototype.update.call(this)}},d.prototype.dispose=function(){this.source=null},d}(ro),Sr=function(T){function d(c){return T.call(this,c)||this}return Fn(d,T),d.test=function(c){var f=globalThis.OffscreenCanvas;return!!(f&&c instanceof f)||globalThis.HTMLCanvasElement&&c instanceof HTMLCanvasElement},d}(Mi),Lr=function(T){function d(c,f){var A=this,k=f||{},K=k.width,ot=k.height,dt=k.autoLoad,Pt=k.linkBaseTexture;if(c&&c.length!==d.SIDES)throw new Error("Invalid length. Got "+c.length+", expected 6");A=T.call(this,6,{width:K,height:ot})||this;for(var kt=0;kt<d.SIDES;kt++)A.items[kt].target=I.q.TEXTURE_CUBE_MAP_POSITIVE_X+kt;return A.linkBaseTexture=Pt!==!1,c&&A.initFromArray(c,f),dt!==!1&&A.load(),A}return Fn(d,T),d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=I.q.TEXTURE_CUBE_MAP},d.prototype.addBaseTextureAt=function(c,f,A){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");if(!this.linkBaseTexture||c.parentTextureArray||Object.keys(c._glTextures).length>0){if(!c.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(c.resource,f)}else c.target=I.q.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.parentTextureArray=this.baseTexture,this.items[f]=c;return c.valid&&!this.valid&&this.resize(c.realWidth,c.realHeight),this.items[f]=c,this},d.prototype.upload=function(c,f,A){for(var k=this.itemDirtyIds,K=0;K<d.SIDES;K++){var ot=this.items[K];k[K]<ot.dirtyId&&(ot.valid&&ot.resource?(ot.resource.upload(c,ot,A),k[K]=ot.dirtyId):k[K]<-1&&(c.gl.texImage2D(ot.target,0,A.internalFormat,f.realWidth,f.realHeight,0,f.format,A.type,null),k[K]=-1))}return!0},d.test=function(c){return Array.isArray(c)&&c.length===d.SIDES},d.SIDES=6,d}(Ki),qo=function(T){function d(c,f){var A=this;if(f=f||{},!(c instanceof HTMLImageElement)){var k=new Image;Mi.crossOrigin(k,c,f.crossorigin),k.src=c,c=k}return A=T.call(this,c)||this,!c.complete&&A._width&&A._height&&(A._width=0,A._height=0),A.url=c.src,A._process=null,A.preserveBitmap=!1,A.createBitmap=(f.createBitmap!==void 0?f.createBitmap:S.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,A.alphaMode=typeof f.alphaMode=="number"?f.alphaMode:null,A.bitmap=null,A._load=null,f.autoLoad!==!1&&A.load(),A}return Fn(d,T),d.prototype.load=function(c){var f=this;return this._load||(c!==void 0&&(this.createBitmap=c),this._load=new Promise(function(A,k){var K=f.source;f.url=K.src;var ot=function(){f.destroyed||(K.onload=null,K.onerror=null,f.resize(K.width,K.height),f._load=null,f.createBitmap?A(f.process()):A(f))};K.complete&&K.src?ot():(K.onload=ot,K.onerror=function(dt){k(dt),f.onError.emit(dt)})})),this._load},d.prototype.process=function(){var c=this,f=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var A=globalThis.createImageBitmap,k=!f.crossOrigin||f.crossOrigin==="anonymous";return this._process=fetch(f.src,{mode:k?"cors":"no-cors"}).then(function(K){return K.blob()}).then(function(K){return A(K,0,0,f.width,f.height,{premultiplyAlpha:c.alphaMode===I.a.UNPACK?"premultiply":"none"})}).then(function(K){return c.destroyed?Promise.reject():(c.bitmap=K,c.update(),c._process=null,Promise.resolve(c))}),this._process},d.prototype.upload=function(c,f,A){if(typeof this.alphaMode=="number"&&(f.alphaMode=this.alphaMode),!this.createBitmap)return T.prototype.upload.call(this,c,f,A);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(T.prototype.upload.call(this,c,f,A,this.bitmap),!this.preserveBitmap){var k=!0,K=f._glTextures;for(var ot in K){var dt=K[ot];if(dt!==A&&dt.dirtyId!==f.dirtyId){k=!1;break}}k&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},d.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,T.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},d.test=function(c){return typeof c=="string"||c instanceof HTMLImageElement},d}(Mi),Jo=function(T){function d(c,f){var A=this;return f=f||{},(A=T.call(this,document.createElement("canvas"))||this)._width=0,A._height=0,A.svg=c,A.scale=f.scale||1,A._overrideWidth=f.width,A._overrideHeight=f.height,A._resolve=null,A._crossorigin=f.crossorigin,A._load=null,f.autoLoad!==!1&&A.load(),A}return Fn(d,T),d.prototype.load=function(){var c=this;return this._load||(this._load=new Promise(function(f){if(c._resolve=function(){c.resize(c.source.width,c.source.height),f(c)},d.SVG_XML.test(c.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");c.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c.svg)))}c._loadSvg()})),this._load},d.prototype._loadSvg=function(){var c=this,f=new Image;Mi.crossOrigin(f,this.svg,this._crossorigin),f.src=this.svg,f.onerror=function(A){c._resolve&&(f.onerror=null,c.onError.emit(A))},f.onload=function(){if(c._resolve){var A=f.width,k=f.height;if(!A||!k)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var K=A*c.scale,ot=k*c.scale;(c._overrideWidth||c._overrideHeight)&&(K=c._overrideWidth||c._overrideHeight/k*A,ot=c._overrideHeight||c._overrideWidth/A*k),K=Math.round(K),ot=Math.round(ot);var dt=c.source;dt.width=K,dt.height=ot,dt._pixiId="canvas_"+Ue(),dt.getContext("2d").drawImage(f,0,0,A,k,0,0,K,ot),c._resolve(),c._resolve=null}}},d.getSize=function(c){var f=d.SVG_SIZE.exec(c),A={};return f&&(A[f[1]]=Math.round(parseFloat(f[3])),A[f[5]]=Math.round(parseFloat(f[7]))),A},d.prototype.dispose=function(){T.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},d.test=function(c,f){return f==="svg"||typeof c=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(c)||typeof c=="string"&&d.SVG_XML.test(c)},d.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,d.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,d}(Mi),go=function(T){function d(c,f){var A=this;if(f=f||{},!(c instanceof HTMLVideoElement)){var k=document.createElement("video");k.setAttribute("preload","auto"),k.setAttribute("webkit-playsinline",""),k.setAttribute("playsinline",""),typeof c=="string"&&(c=[c]);var K=c[0].src||c[0];Mi.crossOrigin(k,K,f.crossorigin);for(var ot=0;ot<c.length;++ot){var dt=document.createElement("source"),Pt=c[ot],kt=Pt.src,he=Pt.mime,te=(kt=kt||c[ot]).split("?").shift().toLowerCase(),me=te.slice(te.lastIndexOf(".")+1);he=he||d.MIME_TYPES[me]||"video/"+me,dt.src=kt,dt.type=he,k.appendChild(dt)}c=k}return(A=T.call(this,c)||this).noSubImage=!0,A._autoUpdate=!0,A._isConnectedToTicker=!1,A._updateFPS=f.updateFPS||0,A._msToNextUpdate=0,A.autoPlay=f.autoPlay!==!1,A._load=null,A._resolve=null,A._onCanPlay=A._onCanPlay.bind(A),A._onError=A._onError.bind(A),f.autoLoad!==!1&&A.load(),A}return Fn(d,T),d.prototype.update=function(c){if(!this.destroyed){var f=It.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-f),(!this._updateFPS||this._msToNextUpdate<=0)&&(T.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.source;return(f.readyState===f.HAVE_ENOUGH_DATA||f.readyState===f.HAVE_FUTURE_DATA)&&f.width&&f.height&&(f.complete=!0),f.addEventListener("play",this._onPlayStart.bind(this)),f.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(f.addEventListener("canplay",this._onCanPlay),f.addEventListener("canplaythrough",this._onCanPlay),f.addEventListener("error",this._onError,!0)),this._load=new Promise(function(A){c.valid?A(c):(c._resolve=A,f.load())}),this._load},d.prototype._onError=function(c){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(c)},d.prototype._isSourcePlaying=function(){var c=this.source;return c.currentTime>0&&c.paused===!1&&c.ended===!1&&c.readyState>2},d.prototype._isSourceReady=function(){var c=this.source;return c.readyState===3||c.readyState===4},d.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(It.shared.add(this.update,this),this._isConnectedToTicker=!0)},d.prototype._onPlayStop=function(){this._isConnectedToTicker&&(It.shared.remove(this.update,this),this._isConnectedToTicker=!1)},d.prototype._onCanPlay=function(){var c=this.source;c.removeEventListener("canplay",this._onCanPlay),c.removeEventListener("canplaythrough",this._onCanPlay);var f=this.valid;this.resize(c.videoWidth,c.videoHeight),!f&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&c.play()},d.prototype.dispose=function(){this._isConnectedToTicker&&(It.shared.remove(this.update,this),this._isConnectedToTicker=!1);var c=this.source;c&&(c.removeEventListener("error",this._onError,!0),c.pause(),c.src="",c.load()),T.prototype.dispose.call(this)},Object.defineProperty(d.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(c){c!==this._autoUpdate&&(this._autoUpdate=c,!this._autoUpdate&&this._isConnectedToTicker?(It.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(It.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(c){c!==this._updateFPS&&(this._updateFPS=c)},enumerable:!1,configurable:!0}),d.test=function(c,f){return globalThis.HTMLVideoElement&&c instanceof HTMLVideoElement||d.TYPES.indexOf(f)>-1},d.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],d.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},d}(Mi),vo=function(T){function d(c){return T.call(this,c)||this}return Fn(d,T),d.test=function(c){return!!globalThis.createImageBitmap&&c instanceof ImageBitmap},d}(Mi);zi.push(qo,vo,Sr,go,Jo,mo,Lr,Wr);var ui=function(T){function d(){return T!==null&&T.apply(this,arguments)||this}return Fn(d,T),d.prototype.upload=function(c,f,A){var k=c.gl;k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK);var K=f.realWidth,ot=f.realHeight;return A.width===K&&A.height===ot?k.texSubImage2D(f.target,0,0,0,K,ot,f.format,A.type,this.data):(A.width=K,A.height=ot,k.texImage2D(f.target,0,A.internalFormat,K,ot,0,f.format,A.type,this.data)),!0},d}(mo),Zo=function(){function T(d,c){this.width=Math.round(d||100),this.height=Math.round(c||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new tn("disposeFramebuffer"),this.multisample=I.l.NONE}return Object.defineProperty(T.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),T.prototype.addColorTexture=function(d,c){return d===void 0&&(d=0),this.colorTextures[d]=c||new jn(null,{scaleMode:I.p.NEAREST,resolution:1,mipmap:I.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.addDepthTexture=function(d){return this.depthTexture=d||new jn(new ui(null,{width:this.width,height:this.height}),{scaleMode:I.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:I.k.OFF,format:I.h.DEPTH_COMPONENT,type:I.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.resize=function(d,c){if(d=Math.round(d),c=Math.round(c),d!==this.width||c!==this.height){this.width=d,this.height=c,this.dirtyId++,this.dirtySize++;for(var f=0;f<this.colorTextures.length;f++){var A=this.colorTextures[f],k=A.resolution;A.setSize(d/k,c/k)}this.depthTexture&&(k=this.depthTexture.resolution,this.depthTexture.setSize(d/k,c/k))}},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},T}(),Ci=function(T){function d(c){c===void 0&&(c={});var f=this;if(typeof c=="number"){var A=arguments[0],k=arguments[1],K=arguments[2],ot=arguments[3];c={width:A,height:k,scaleMode:K,resolution:ot}}return c.width=c.width||100,c.height=c.height||100,c.multisample=c.multisample!==void 0?c.multisample:I.l.NONE,(f=T.call(this,null,c)||this).mipmap=I.k.OFF,f.valid=!0,f.clearColor=[0,0,0,0],f.framebuffer=new Zo(f.realWidth,f.realHeight).addColorTexture(0,f),f.framebuffer.multisample=c.multisample,f.maskStack=[],f.filterStack=[{}],f}return Fn(d,T),d.prototype.resize=function(c,f){this.framebuffer.resize(c*this.resolution,f*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},d.prototype.dispose=function(){this.framebuffer.dispose(),T.prototype.dispose.call(this)},d.prototype.destroy=function(){T.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},d}(jn),mr=function(){function T(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return T.prototype.set=function(d,c,f){var A=c.width,k=c.height;if(f){var K=d.width/2/A,ot=d.height/2/k,dt=d.x/A+K,Pt=d.y/k+ot;f=Pn.add(f,Pn.NW),this.x0=dt+K*Pn.uX(f),this.y0=Pt+ot*Pn.uY(f),f=Pn.add(f,2),this.x1=dt+K*Pn.uX(f),this.y1=Pt+ot*Pn.uY(f),f=Pn.add(f,2),this.x2=dt+K*Pn.uX(f),this.y2=Pt+ot*Pn.uY(f),f=Pn.add(f,2),this.x3=dt+K*Pn.uX(f),this.y3=Pt+ot*Pn.uY(f)}else this.x0=d.x/A,this.y0=d.y/k,this.x1=(d.x+d.width)/A,this.y1=d.y/k,this.x2=(d.x+d.width)/A,this.y2=(d.y+d.height)/k,this.x3=d.x/A,this.y3=(d.y+d.height)/k;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},T.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},T}(),Oi=new mr;function Dr(T){T.destroy=function(){},T.on=function(){},T.once=function(){},T.emit=function(){}}var _o=function(T){function d(c,f,A,k,K,ot){var dt=T.call(this)||this;if(dt.noFrame=!1,f||(dt.noFrame=!0,f=new oe(0,0,1,1)),c instanceof d&&(c=c.baseTexture),dt.baseTexture=c,dt._frame=f,dt.trim=k,dt.valid=!1,dt._uvs=Oi,dt.uvMatrix=null,dt.orig=A||f,dt._rotate=Number(K||0),K===!0)dt._rotate=2;else if(dt._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return dt.defaultAnchor=ot?new Wt(ot.x,ot.y):new Wt(0,0),dt._updateID=0,dt.textureCacheIds=[],c.valid?dt.noFrame?c.valid&&dt.onBaseTextureUpdated(c):dt.frame=f:c.once("loaded",dt.onBaseTextureUpdated,dt),dt.noFrame&&c.on("update",dt.onBaseTextureUpdated,dt),dt}return Fn(d,T),d.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},d.prototype.onBaseTextureUpdated=function(c){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=c.width,this._frame.height=c.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},d.prototype.destroy=function(c){if(this.baseTexture){if(c){var f=this.baseTexture.resource;f&&f.url&&we[f.url]&&d.removeFromCache(f.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,d.removeFromCache(this),this.textureCacheIds=null},d.prototype.clone=function(){var c=this._frame.clone(),f=this._frame===this.orig?c:this.orig.clone(),A=new d(this.baseTexture,!this.noFrame&&c,f,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(A._frame=c),A},d.prototype.updateUvs=function(){this._uvs===Oi&&(this._uvs=new mr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},d.from=function(c,f,A){f===void 0&&(f={}),A===void 0&&(A=S.b.STRICT_TEXTURE_CACHE);var k=typeof c=="string",K=null;if(k)K=c;else if(c instanceof jn){if(!c.cacheId){var ot=f&&f.pixiIdPrefix||"pixiid";c.cacheId=ot+"-"+Ue(),jn.addToCache(c,c.cacheId)}K=c.cacheId}else c._pixiId||(ot=f&&f.pixiIdPrefix||"pixiid",c._pixiId=ot+"_"+Ue()),K=c._pixiId;var dt=we[K];if(k&&A&&!dt)throw new Error('The cacheId "'+K+'" does not exist in TextureCache.');return dt||c instanceof jn?!dt&&c instanceof jn&&(dt=new d(c),d.addToCache(dt,K)):(f.resolution||(f.resolution=Zn(c)),(dt=new d(new jn(c,f))).baseTexture.cacheId=K,jn.addToCache(dt.baseTexture,K),d.addToCache(dt,K)),dt},d.fromURL=function(c,f){var A=Object.assign({autoLoad:!1},f==null?void 0:f.resourceOptions),k=d.from(c,Object.assign({resourceOptions:A},f),!1),K=k.baseTexture.resource;return k.baseTexture.valid?Promise.resolve(k):K.load().then(function(){return Promise.resolve(k)})},d.fromBuffer=function(c,f,A,k){return new d(jn.fromBuffer(c,f,A,k))},d.fromLoader=function(c,f,A,k){var K=new jn(c,Object.assign({scaleMode:S.b.SCALE_MODE,resolution:Zn(f)},k)),ot=K.resource;ot instanceof qo&&(ot.url=f);var dt=new d(K);return A||(A=f),jn.addToCache(dt.baseTexture,A),d.addToCache(dt,A),A!==f&&(jn.addToCache(dt.baseTexture,f),d.addToCache(dt,f)),dt.baseTexture.valid?Promise.resolve(dt):new Promise(function(Pt){dt.baseTexture.once("loaded",function(){return Pt(dt)})})},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),we[f]&&console.warn("Texture added to the cache with an id ["+f+"] that already had an entry"),we[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=we[c];if(f){var A=f.textureCacheIds.indexOf(c);return A>-1&&f.textureCacheIds.splice(A,1),delete we[c],f}}else if(c&&c.textureCacheIds){for(var k=0;k<c.textureCacheIds.length;++k)we[c.textureCacheIds[k]]===c&&delete we[c.textureCacheIds[k]];return c.textureCacheIds.length=0,c}return null},Object.defineProperty(d.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"frame",{get:function(){return this._frame},set:function(c){this._frame=c,this.noFrame=!1;var f=c.x,A=c.y,k=c.width,K=c.height,ot=f+k>this.baseTexture.width,dt=A+K>this.baseTexture.height;if(ot||dt){var Pt=ot&&dt?"and":"or",kt="X: "+f+" + "+k+" = "+(f+k)+" > "+this.baseTexture.width,he="Y: "+A+" + "+K+" = "+(A+K)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+kt+" "+Pt+" "+he)}this.valid=k&&K&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=c),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"rotate",{get:function(){return this._rotate},set:function(c){this._rotate=c,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),d.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(d,"EMPTY",{get:function(){return d._EMPTY||(d._EMPTY=new d(new jn),Dr(d._EMPTY),Dr(d._EMPTY.baseTexture)),d._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(d,"WHITE",{get:function(){if(!d._WHITE){var c=document.createElement("canvas"),f=c.getContext("2d");c.width=16,c.height=16,f.fillStyle="white",f.fillRect(0,0,16,16),d._WHITE=new d(new jn(new Sr(c))),Dr(d._WHITE),Dr(d._WHITE.baseTexture)}return d._WHITE},enumerable:!1,configurable:!0}),d}(et),oo=function(T){function d(c,f){var A=T.call(this,c,f)||this;return A.valid=!0,A.filterFrame=null,A.filterPoolKey=null,A.updateUvs(),A}return Fn(d,T),Object.defineProperty(d.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(c){this.framebuffer.multisample=c},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f,A){A===void 0&&(A=!0);var k=this.baseTexture.resolution,K=Math.round(c*k)/k,ot=Math.round(f*k)/k;this.valid=K>0&&ot>0,this._frame.width=this.orig.width=K,this._frame.height=this.orig.height=ot,A&&this.baseTexture.resize(K,ot),this.updateUvs()},d.prototype.setResolution=function(c){var f=this.baseTexture;f.resolution!==c&&(f.setResolution(c),this.resize(f.width,f.height,!1))},d.create=function(c){for(var f=arguments,A=[],k=1;k<arguments.length;k++)A[k-1]=f[k];return typeof c=="number"&&(Rn("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),c={width:c,height:A[0],scaleMode:A[1],resolution:A[2]}),new d(new Ci(c))},d}(_o),yo=function(){function T(d){this.texturePool={},this.textureOptions=d||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return T.prototype.createTexture=function(d,c,f){f===void 0&&(f=I.l.NONE);var A=new Ci(Object.assign({width:d,height:c,resolution:1,multisample:f},this.textureOptions));return new oo(A)},T.prototype.getOptimalTexture=function(d,c,f,A){var k;f===void 0&&(f=1),A===void 0&&(A=I.l.NONE),d=Math.ceil(d*f-1e-6),c=Math.ceil(c*f-1e-6),this.enableFullScreen&&d===this._pixelsWidth&&c===this._pixelsHeight?k=A>1?-A:-1:(k=((65535&(d=Ae(d)))<<16|65535&(c=Ae(c)))>>>0,A>1&&(k+=4294967296*A)),this.texturePool[k]||(this.texturePool[k]=[]);var K=this.texturePool[k].pop();return K||(K=this.createTexture(d,c,A)),K.filterPoolKey=k,K.setResolution(f),K},T.prototype.getFilterTexture=function(d,c,f){var A=this.getOptimalTexture(d.width,d.height,c||d.resolution,f||I.l.NONE);return A.filterFrame=d.filterFrame,A},T.prototype.returnTexture=function(d){var c=d.filterPoolKey;d.filterFrame=null,this.texturePool[c].push(d)},T.prototype.returnFilterTexture=function(d){this.returnTexture(d)},T.prototype.clear=function(d){if(d=d!==!1)for(var c in this.texturePool){var f=this.texturePool[c];if(f)for(var A=0;A<f.length;A++)f[A].destroy(!0)}this.texturePool={}},T.prototype.setScreenSize=function(d){if(d.width!==this._pixelsWidth||d.height!==this._pixelsHeight){for(var c in this.enableFullScreen=d.width>0&&d.height>0,this.texturePool)if(Number(c)<0){var f=this.texturePool[c];if(f)for(var A=0;A<f.length;A++)f[A].destroy(!0);this.texturePool[c]=[]}this._pixelsWidth=d.width,this._pixelsHeight=d.height}},T.SCREEN_KEY=-1,T}(),fn=function(){function T(d,c,f,A,k,K,ot){c===void 0&&(c=0),f===void 0&&(f=!1),A===void 0&&(A=I.r.FLOAT),this.buffer=d,this.size=c,this.normalized=f,this.type=A,this.stride=k,this.start=K,this.instance=ot}return T.prototype.destroy=function(){this.buffer=null},T.from=function(d,c,f,A,k){return new T(d,c,f,A,k)},T}(),Qi=0,Mn=function(){function T(d,c,f){c===void 0&&(c=!0),f===void 0&&(f=!1),this.data=d||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=f,this.static=c,this.id=Qi++,this.disposeRunner=new tn("disposeBuffer")}return T.prototype.update=function(d){d instanceof Array&&(d=new Float32Array(d)),this.data=d||this.data,this._updateID++},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(T.prototype,"index",{get:function(){return this.type===I.d.ELEMENT_ARRAY_BUFFER},set:function(d){this.type=d?I.d.ELEMENT_ARRAY_BUFFER:I.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),T.from=function(d){return d instanceof Array&&(d=new Float32Array(d)),new T(d)},T}(),xo={Float32Array,Uint32Array,Int32Array,Uint8Array},Yn={5126:4,5123:2,5121:1},vs=0,ea={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},bo=function(){function T(d,c){d===void 0&&(d=[]),c===void 0&&(c={}),this.buffers=d,this.indexBuffer=null,this.attributes=c,this.glVertexArrayObjects={},this.id=vs++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new tn("disposeGeometry"),this.refCount=0}return T.prototype.addAttribute=function(d,c,f,A,k,K,ot,dt){if(f===void 0&&(f=0),A===void 0&&(A=!1),dt===void 0&&(dt=!1),!c)throw new Error("You must pass a buffer when creating an attribute");c instanceof Mn||(c instanceof Array&&(c=new Float32Array(c)),c=new Mn(c));var Pt=d.split("|");if(Pt.length>1){for(var kt=0;kt<Pt.length;kt++)this.addAttribute(Pt[kt],c,f,A,k);return this}var he=this.buffers.indexOf(c);return he===-1&&(this.buffers.push(c),he=this.buffers.length-1),this.attributes[d]=new fn(he,f,A,k,K,ot,dt),this.instanced=this.instanced||dt,this},T.prototype.getAttribute=function(d){return this.attributes[d]},T.prototype.getBuffer=function(d){return this.buffers[this.getAttribute(d).buffer]},T.prototype.addIndex=function(d){return d instanceof Mn||(d instanceof Array&&(d=new Uint16Array(d)),d=new Mn(d)),d.type=I.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=d,this.buffers.indexOf(d)===-1&&this.buffers.push(d),this},T.prototype.getIndex=function(){return this.indexBuffer},T.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var d,c=[],f=[],A=new Mn;for(d in this.attributes){var k=this.attributes[d],K=this.buffers[k.buffer];c.push(K.data),f.push(k.size*Yn[k.type]/4),k.buffer=0}for(A.data=function(ot,dt){for(var Pt=0,kt=0,he={},te=0;te<ot.length;te++)kt+=dt[te],Pt+=ot[te].length;var me=new ArrayBuffer(4*Pt),xe=null,Be=0;for(te=0;te<ot.length;te++){var qe=dt[te],Ye=ot[te],Je=Oe(Ye);he[Je]||(he[Je]=new xo[Je](me)),xe=he[Je];for(var je=0;je<Ye.length;je++)xe[(je/qe|0)*kt+Be+je%qe]=Ye[je];Be+=qe}return new Float32Array(me)}(c,f),d=0;d<this.buffers.length;d++)this.buffers[d]!==this.indexBuffer&&this.buffers[d].destroy();return this.buffers=[A],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},T.prototype.getSize=function(){for(var d in this.attributes){var c=this.attributes[d];return this.buffers[c.buffer].data.length/(c.stride/4||c.size)}return 0},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},T.prototype.clone=function(){for(var d=new T,c=0;c<this.buffers.length;c++)d.buffers[c]=new Mn(this.buffers[c].data.slice(0));for(var c in this.attributes){var f=this.attributes[c];d.attributes[c]=new fn(f.buffer,f.size,f.normalized,f.type,f.stride,f.start,f.instance)}return this.indexBuffer&&(d.indexBuffer=d.buffers[this.buffers.indexOf(this.indexBuffer)],d.indexBuffer.type=I.d.ELEMENT_ARRAY_BUFFER),d},T.merge=function(d){for(var c,f=new T,A=[],k=[],K=[],ot=0;ot<d.length;ot++){c=d[ot];for(var dt=0;dt<c.buffers.length;dt++)k[dt]=k[dt]||0,k[dt]+=c.buffers[dt].data.length,K[dt]=0}for(ot=0;ot<c.buffers.length;ot++)A[ot]=new ea[Oe(c.buffers[ot].data)](k[ot]),f.buffers[ot]=new Mn(A[ot]);for(ot=0;ot<d.length;ot++)for(c=d[ot],dt=0;dt<c.buffers.length;dt++)A[dt].set(c.buffers[dt].data,K[dt]),K[dt]+=c.buffers[dt].data.length;if(f.attributes=c.attributes,c.indexBuffer){f.indexBuffer=f.buffers[c.buffers.indexOf(c.indexBuffer)],f.indexBuffer.type=I.d.ELEMENT_ARRAY_BUFFER;var Pt=0,kt=0,he=0,te=0;for(ot=0;ot<c.buffers.length;ot++)if(c.buffers[ot]!==c.indexBuffer){te=ot;break}for(var ot in c.attributes){var me=c.attributes[ot];(0|me.buffer)===te&&(kt+=me.size*Yn[me.type]/4)}for(ot=0;ot<d.length;ot++){var xe=d[ot].indexBuffer.data;for(dt=0;dt<xe.length;dt++)f.indexBuffer.data[dt+he]+=Pt;Pt+=d[ot].buffers[te].data.length/kt,he+=xe.length}}return f},T}(),An=function(T){function d(){var c=T.call(this)||this;return c.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),c}return Fn(d,T),d}(bo),_s=function(T){function d(){var c=T.call(this)||this;return c.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),c.uvs=new Float32Array([0,0,1,0,1,1,0,1]),c.vertexBuffer=new Mn(c.vertices),c.uvBuffer=new Mn(c.uvs),c.addAttribute("aVertexPosition",c.vertexBuffer).addAttribute("aTextureCoord",c.uvBuffer).addIndex([0,1,2,0,2,3]),c}return Fn(d,T),d.prototype.map=function(c,f){var A=0,k=0;return this.uvs[0]=A,this.uvs[1]=k,this.uvs[2]=A+f.width/c.width,this.uvs[3]=k,this.uvs[4]=A+f.width/c.width,this.uvs[5]=k+f.height/c.height,this.uvs[6]=A,this.uvs[7]=k+f.height/c.height,A=f.x,k=f.y,this.vertices[0]=A,this.vertices[1]=k,this.vertices[2]=A+f.width,this.vertices[3]=k,this.vertices[4]=A+f.width,this.vertices[5]=k+f.height,this.vertices[6]=A,this.vertices[7]=k+f.height,this.invalidate(),this},d.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},d}(bo),Ko=0,bi=function(){function T(d,c,f){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Ko++,this.static=!!c,this.ubo=!!f,d instanceof Mn?(this.buffer=d,this.buffer.type=I.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=d,this.ubo&&(this.buffer=new Mn(new Float32Array(1)),this.buffer.type=I.d.UNIFORM_BUFFER,this.autoManage=!0))}return T.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},T.prototype.add=function(d,c,f){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[d]=new T(c,f)},T.from=function(d,c,f){return new T(d,c,f)},T.uboFrom=function(d,c){return new T(d,c==null||c,!0)},T}(),Qo=function(){function T(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=I.l.NONE,this.sourceFrame=new oe,this.destinationFrame=new oe,this.bindingSourceFrame=new oe,this.bindingDestinationFrame=new oe,this.filters=[],this.transform=null}return T.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},T}(),gr=[new Wt,new Wt,new Wt,new Wt],Ni=new Se,so=function(){function T(d){this.renderer=d,this.defaultFilterStack=[{}],this.texturePool=new yo,this.texturePool.setScreenSize(d.view),this.statePool=[],this.quad=new An,this.quadUv=new _s,this.tempRect=new oe,this.activeState={},this.globalUniforms=new bi({outputFrame:new oe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return T.prototype.push=function(d,c){for(var f,A,k=this.renderer,K=this.defaultFilterStack,ot=this.statePool.pop()||new Qo,dt=this.renderer.renderTexture,Pt=c[0].resolution,kt=c[0].multisample,he=c[0].padding,te=c[0].autoFit,me=(f=c[0].legacy)===null||f===void 0||f,xe=1;xe<c.length;xe++){var Be=c[xe];Pt=Math.min(Pt,Be.resolution),kt=Math.min(kt,Be.multisample),he=this.useMaxPadding?Math.max(he,Be.padding):he+Be.padding,te=te&&Be.autoFit,me=me||(A=Be.legacy)===null||A===void 0||A}K.length===1&&(this.defaultFilterStack[0].renderTexture=dt.current),K.push(ot),ot.resolution=Pt,ot.multisample=kt,ot.legacy=me,ot.target=d,ot.sourceFrame.copyFrom(d.filterArea||d.getBounds(!0)),ot.sourceFrame.pad(he);var qe=this.tempRect.copyFrom(dt.sourceFrame);k.projection.transform&&this.transformAABB(Ni.copyFrom(k.projection.transform).invert(),qe),te?(ot.sourceFrame.fit(qe),(ot.sourceFrame.width<=0||ot.sourceFrame.height<=0)&&(ot.sourceFrame.width=0,ot.sourceFrame.height=0)):ot.sourceFrame.intersects(qe)||(ot.sourceFrame.width=0,ot.sourceFrame.height=0),this.roundFrame(ot.sourceFrame,dt.current?dt.current.resolution:k.resolution,dt.sourceFrame,dt.destinationFrame,k.projection.transform),ot.renderTexture=this.getOptimalFilterTexture(ot.sourceFrame.width,ot.sourceFrame.height,Pt,kt),ot.filters=c,ot.destinationFrame.width=ot.renderTexture.width,ot.destinationFrame.height=ot.renderTexture.height;var Ye=this.tempRect;Ye.x=0,Ye.y=0,Ye.width=ot.sourceFrame.width,Ye.height=ot.sourceFrame.height,ot.renderTexture.filterFrame=ot.sourceFrame,ot.bindingSourceFrame.copyFrom(dt.sourceFrame),ot.bindingDestinationFrame.copyFrom(dt.destinationFrame),ot.transform=k.projection.transform,k.projection.transform=null,dt.bind(ot.renderTexture,ot.sourceFrame,Ye),k.framebuffer.clear(0,0,0,0)},T.prototype.pop=function(){var d=this.defaultFilterStack,c=d.pop(),f=c.filters;this.activeState=c;var A=this.globalUniforms.uniforms;A.outputFrame=c.sourceFrame,A.resolution=c.resolution;var k=A.inputSize,K=A.inputPixel,ot=A.inputClamp;if(k[0]=c.destinationFrame.width,k[1]=c.destinationFrame.height,k[2]=1/k[0],k[3]=1/k[1],K[0]=Math.round(k[0]*c.resolution),K[1]=Math.round(k[1]*c.resolution),K[2]=1/K[0],K[3]=1/K[1],ot[0]=.5*K[2],ot[1]=.5*K[3],ot[2]=c.sourceFrame.width*k[2]-.5*K[2],ot[3]=c.sourceFrame.height*k[3]-.5*K[3],c.legacy){var dt=A.filterArea;dt[0]=c.destinationFrame.width,dt[1]=c.destinationFrame.height,dt[2]=c.sourceFrame.x,dt[3]=c.sourceFrame.y,A.filterClamp=A.inputClamp}this.globalUniforms.update();var Pt=d[d.length-1];if(this.renderer.framebuffer.blit(),f.length===1)f[0].apply(this,c.renderTexture,Pt.renderTexture,I.e.BLEND,c),this.returnFilterTexture(c.renderTexture);else{var kt=c.renderTexture,he=this.getOptimalFilterTexture(kt.width,kt.height,c.resolution);he.filterFrame=kt.filterFrame;var te=0;for(te=0;te<f.length-1;++te){te===1&&c.multisample>1&&((he=this.getOptimalFilterTexture(kt.width,kt.height,c.resolution)).filterFrame=kt.filterFrame),f[te].apply(this,kt,he,I.e.CLEAR,c);var me=kt;kt=he,he=me}f[te].apply(this,kt,Pt.renderTexture,I.e.BLEND,c),te>1&&c.multisample>1&&this.returnFilterTexture(c.renderTexture),this.returnFilterTexture(kt),this.returnFilterTexture(he)}c.clear(),this.statePool.push(c)},T.prototype.bindAndClear=function(d,c){c===void 0&&(c=I.e.CLEAR);var f=this.renderer,A=f.renderTexture,k=f.state;if(d===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,d&&d.filterFrame){var K=this.tempRect;K.x=0,K.y=0,K.width=d.filterFrame.width,K.height=d.filterFrame.height,A.bind(d,d.filterFrame,K)}else d!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?A.bind(d):this.renderer.renderTexture.bind(d,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var ot=1&k.stateId||this.forceClear;(c===I.e.CLEAR||c===I.e.BLIT&&ot)&&this.renderer.framebuffer.clear(0,0,0,0)},T.prototype.applyFilter=function(d,c,f,A){var k=this.renderer;k.state.set(d.state),this.bindAndClear(f,A),d.uniforms.uSampler=c,d.uniforms.filterGlobals=this.globalUniforms,k.shader.bind(d),d.legacy=!!d.program.attributeData.aTextureCoord,d.legacy?(this.quadUv.map(c._frame,c.filterFrame),k.geometry.bind(this.quadUv),k.geometry.draw(I.f.TRIANGLES)):(k.geometry.bind(this.quad),k.geometry.draw(I.f.TRIANGLE_STRIP))},T.prototype.calculateSpriteMatrix=function(d,c){var f=this.activeState,A=f.sourceFrame,k=f.destinationFrame,K=c._texture.orig,ot=d.set(k.width,0,0,k.height,A.x,A.y),dt=c.worldTransform.copyTo(Se.TEMP_MATRIX);return dt.invert(),ot.prepend(dt),ot.scale(1/K.width,1/K.height),ot.translate(c.anchor.x,c.anchor.y),ot},T.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},T.prototype.getOptimalFilterTexture=function(d,c,f,A){return f===void 0&&(f=1),A===void 0&&(A=I.l.NONE),this.texturePool.getOptimalTexture(d,c,f,A)},T.prototype.getFilterTexture=function(d,c,f){if(typeof d=="number"){var A=d;d=c,c=A}d=d||this.activeState.renderTexture;var k=this.texturePool.getOptimalTexture(d.width,d.height,c||d.resolution,f||I.l.NONE);return k.filterFrame=d.filterFrame,k},T.prototype.returnFilterTexture=function(d){this.texturePool.returnTexture(d)},T.prototype.emptyPool=function(){this.texturePool.clear(!0)},T.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},T.prototype.transformAABB=function(d,c){var f=gr[0],A=gr[1],k=gr[2],K=gr[3];f.set(c.left,c.top),A.set(c.left,c.bottom),k.set(c.right,c.top),K.set(c.right,c.bottom),d.apply(f,f),d.apply(A,A),d.apply(k,k),d.apply(K,K);var ot=Math.min(f.x,A.x,k.x,K.x),dt=Math.min(f.y,A.y,k.y,K.y),Pt=Math.max(f.x,A.x,k.x,K.x),kt=Math.max(f.y,A.y,k.y,K.y);c.x=ot,c.y=dt,c.width=Pt-ot,c.height=kt-dt},T.prototype.roundFrame=function(d,c,f,A,k){if(!(d.width<=0||d.height<=0||f.width<=0||f.height<=0)){if(k){var K=k.a,ot=k.b,dt=k.c,Pt=k.d;if((Math.abs(ot)>1e-4||Math.abs(dt)>1e-4)&&(Math.abs(K)>1e-4||Math.abs(Pt)>1e-4))return}(k=k?Ni.copyFrom(k):Ni.identity()).translate(-f.x,-f.y).scale(A.width/f.width,A.height/f.height).translate(A.x,A.y),this.transformAABB(k,d),d.ceil(c),this.transformAABB(k.invert(),d)}},T}(),fi=function(){function T(d){this.renderer=d}return T.prototype.flush=function(){},T.prototype.destroy=function(){this.renderer=null},T.prototype.start=function(){},T.prototype.stop=function(){this.flush()},T.prototype.render=function(d){},T}(),Wn=function(){function T(d){this.renderer=d,this.emptyRenderer=new fi(d),this.currentRenderer=this.emptyRenderer}return T.prototype.setObjectRenderer=function(d){this.currentRenderer!==d&&(this.currentRenderer.stop(),this.currentRenderer=d,this.currentRenderer.start())},T.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.copyBoundTextures=function(d,c){for(var f=this.renderer.texture.boundTextures,A=c-1;A>=0;--A)d[A]=f[A]||null,d[A]&&(d[A]._batchLocation=A)},T.prototype.boundArray=function(d,c,f,A){for(var k=d.elements,K=d.ids,ot=d.count,dt=0,Pt=0;Pt<ot;Pt++){var kt=k[Pt],he=kt._batchLocation;if(he>=0&&he<A&&c[he]===kt)K[Pt]=he;else for(;dt<A;){var te=c[dt];if(!te||te._batchEnabled!==f||te._batchLocation!==dt){K[Pt]=dt,kt._batchLocation=dt,c[dt]=kt;break}dt++}}},T.prototype.destroy=function(){this.renderer=null},T}(),To=0,Fr=function(){function T(d){this.renderer=d,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),d.view.addEventListener("webglcontextlost",this.handleContextLost,!1),d.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(T.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),T.prototype.contextChange=function(d){this.gl=d,this.renderer.gl=d,this.renderer.CONTEXT_UID=To++,d.isContextLost()&&d.getExtension("WEBGL_lose_context")&&d.getExtension("WEBGL_lose_context").restoreContext()},T.prototype.initFromContext=function(d){this.gl=d,this.validateContext(d),this.renderer.gl=d,this.renderer.CONTEXT_UID=To++,this.renderer.runners.contextChange.emit(d)},T.prototype.initFromOptions=function(d){var c=this.createContext(this.renderer.view,d);this.initFromContext(c)},T.prototype.createContext=function(d,c){var f;if(S.b.PREFER_ENV>=I.g.WEBGL2&&(f=d.getContext("webgl2",c)),f)this.webGLVersion=2;else if(this.webGLVersion=1,!(f=d.getContext("webgl",c)||d.getContext("experimental-webgl",c)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=f,this.getExtensions(),this.gl},T.prototype.getExtensions=function(){var d=this.gl,c={anisotropicFiltering:d.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),s3tc:d.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:d.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:d.getExtension("WEBGL_compressed_texture_etc"),etc1:d.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:d.getExtension("WEBGL_compressed_texture_pvrtc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:d.getExtension("WEBGL_compressed_texture_atc"),astc:d.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,c,{drawBuffers:d.getExtension("WEBGL_draw_buffers"),depthTexture:d.getExtension("WEBGL_depth_texture"),loseContext:d.getExtension("WEBGL_lose_context"),vertexArrayObject:d.getExtension("OES_vertex_array_object")||d.getExtension("MOZ_OES_vertex_array_object")||d.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:d.getExtension("OES_element_index_uint"),floatTexture:d.getExtension("OES_texture_float"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),textureHalfFloat:d.getExtension("OES_texture_half_float"),textureHalfFloatLinear:d.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,c,{colorBufferFloat:d.getExtension("EXT_color_buffer_float")})},T.prototype.handleContextLost=function(d){d.preventDefault()},T.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},T.prototype.destroy=function(){var d=this.renderer.view;this.renderer=null,d.removeEventListener("webglcontextlost",this.handleContextLost),d.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},T.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},T.prototype.validateContext=function(d){var c=d.getContextAttributes(),f="WebGL2RenderingContext"in globalThis&&d instanceof globalThis.WebGL2RenderingContext;f&&(this.webGLVersion=2),c&&!c.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var A=f||!!d.getExtension("OES_element_index_uint");this.supports.uint32Indices=A,A||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},T}(),wo=function(T){this.framebuffer=T,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=I.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},Ar=new oe,Mr=function(){function T(d){this.renderer=d,this.managedFramebuffers=[],this.unknownFramebuffer=new Zo(10,10),this.msaaSamples=null}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new oe,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var c=this.renderer.context.extensions.drawBuffers,f=this.renderer.context.extensions.depthTexture;S.b.PREFER_ENV===I.g.WEBGL_LEGACY&&(c=null,f=null),c?d.drawBuffers=function(A){return c.drawBuffersWEBGL(A)}:(this.hasMRT=!1,d.drawBuffers=function(){}),f||(this.writeDepthTexture=!1)}else this.msaaSamples=d.getInternalformatParameter(d.RENDERBUFFER,d.RGBA8,d.SAMPLES)},T.prototype.bind=function(d,c,f){f===void 0&&(f=0);var A=this.gl;if(d){var k=d.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(d);this.current!==d&&(this.current=d,A.bindFramebuffer(A.FRAMEBUFFER,k.framebuffer)),k.mipLevel!==f&&(d.dirtyId++,d.dirtyFormat++,k.mipLevel=f),k.dirtyId!==d.dirtyId&&(k.dirtyId=d.dirtyId,k.dirtyFormat!==d.dirtyFormat?(k.dirtyFormat=d.dirtyFormat,k.dirtySize=d.dirtySize,this.updateFramebuffer(d,f)):k.dirtySize!==d.dirtySize&&(k.dirtySize=d.dirtySize,this.resizeFramebuffer(d)));for(var K=0;K<d.colorTextures.length;K++){var ot=d.colorTextures[K];this.renderer.texture.unbind(ot.parentTextureArray||ot)}if(d.depthTexture&&this.renderer.texture.unbind(d.depthTexture),c){var dt=c.width>>f,Pt=c.height>>f,kt=dt/c.width;this.setViewport(c.x*kt,c.y*kt,dt,Pt)}else dt=d.width>>f,Pt=d.height>>f,this.setViewport(0,0,dt,Pt)}else this.current&&(this.current=null,A.bindFramebuffer(A.FRAMEBUFFER,null)),c?this.setViewport(c.x,c.y,c.width,c.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},T.prototype.setViewport=function(d,c,f,A){var k=this.viewport;d=Math.round(d),c=Math.round(c),f=Math.round(f),A=Math.round(A),k.width===f&&k.height===A&&k.x===d&&k.y===c||(k.x=d,k.y=c,k.width=f,k.height=A,this.gl.viewport(d,c,f,A))},Object.defineProperty(T.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),T.prototype.clear=function(d,c,f,A,k){k===void 0&&(k=I.c.COLOR|I.c.DEPTH);var K=this.gl;K.clearColor(d,c,f,A),K.clear(k)},T.prototype.initFramebuffer=function(d){var c=this.gl,f=new wo(c.createFramebuffer());return f.multisample=this.detectSamples(d.multisample),d.glFramebuffers[this.CONTEXT_UID]=f,this.managedFramebuffers.push(d),d.disposeRunner.add(this),f},T.prototype.resizeFramebuffer=function(d){var c=this.gl,f=d.glFramebuffers[this.CONTEXT_UID];f.msaaBuffer&&(c.bindRenderbuffer(c.RENDERBUFFER,f.msaaBuffer),c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.RGBA8,d.width,d.height)),f.stencil&&(c.bindRenderbuffer(c.RENDERBUFFER,f.stencil),f.msaaBuffer?c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.DEPTH24_STENCIL8,d.width,d.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,d.width,d.height));var A=d.colorTextures,k=A.length;c.drawBuffers||(k=Math.min(k,1));for(var K=0;K<k;K++){var ot=A[K],dt=ot.parentTextureArray||ot;this.renderer.texture.bind(dt,0)}d.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(d.depthTexture,0)},T.prototype.updateFramebuffer=function(d,c){var f=this.gl,A=d.glFramebuffers[this.CONTEXT_UID],k=d.colorTextures,K=k.length;f.drawBuffers||(K=Math.min(K,1)),A.multisample>1&&this.canMultisampleFramebuffer(d)?(A.msaaBuffer=A.msaaBuffer||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,A.msaaBuffer),f.renderbufferStorageMultisample(f.RENDERBUFFER,A.multisample,f.RGBA8,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.RENDERBUFFER,A.msaaBuffer)):A.msaaBuffer&&(f.deleteRenderbuffer(A.msaaBuffer),A.msaaBuffer=null,A.blitFramebuffer&&(A.blitFramebuffer.dispose(),A.blitFramebuffer=null));for(var ot=[],dt=0;dt<K;dt++){var Pt=k[dt],kt=Pt.parentTextureArray||Pt;this.renderer.texture.bind(kt,0),dt===0&&A.msaaBuffer||(f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+dt,Pt.target,kt._glTextures[this.CONTEXT_UID].texture,c),ot.push(f.COLOR_ATTACHMENT0+dt))}if(ot.length>1&&f.drawBuffers(ot),d.depthTexture&&this.writeDepthTexture){var he=d.depthTexture;this.renderer.texture.bind(he,0),f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,he._glTextures[this.CONTEXT_UID].texture,c)}!d.stencil&&!d.depth||d.depthTexture&&this.writeDepthTexture?A.stencil&&(f.deleteRenderbuffer(A.stencil),A.stencil=null):(A.stencil=A.stencil||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,A.stencil),A.msaaBuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,A.multisample,f.DEPTH24_STENCIL8,d.width,d.height):f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,A.stencil))},T.prototype.canMultisampleFramebuffer=function(d){return this.renderer.context.webGLVersion!==1&&d.colorTextures.length<=1&&!d.depthTexture},T.prototype.detectSamples=function(d){var c=this.msaaSamples,f=I.l.NONE;if(d<=1||c===null)return f;for(var A=0;A<c.length;A++)if(c[A]<=d){f=c[A];break}return f===1&&(f=I.l.NONE),f},T.prototype.blit=function(d,c,f){var A=this.current,k=this.renderer,K=this.gl,ot=this.CONTEXT_UID;if(k.context.webGLVersion===2&&A){var dt=A.glFramebuffers[ot];if(dt){if(!d){if(!dt.msaaBuffer)return;var Pt=A.colorTextures[0];if(!Pt)return;dt.blitFramebuffer||(dt.blitFramebuffer=new Zo(A.width,A.height),dt.blitFramebuffer.addColorTexture(0,Pt)),(d=dt.blitFramebuffer).colorTextures[0]!==Pt&&(d.colorTextures[0]=Pt,d.dirtyId++,d.dirtyFormat++),d.width===A.width&&d.height===A.height||(d.width=A.width,d.height=A.height,d.dirtyId++,d.dirtySize++)}c||((c=Ar).width=A.width,c.height=A.height),f||(f=c);var kt=c.width===f.width&&c.height===f.height;this.bind(d),K.bindFramebuffer(K.READ_FRAMEBUFFER,dt.framebuffer),K.blitFramebuffer(c.left,c.top,c.right,c.bottom,f.left,f.top,f.right,f.bottom,K.COLOR_BUFFER_BIT,kt?K.NEAREST:K.LINEAR)}}},T.prototype.disposeFramebuffer=function(d,c){var f=d.glFramebuffers[this.CONTEXT_UID],A=this.gl;if(f){delete d.glFramebuffers[this.CONTEXT_UID];var k=this.managedFramebuffers.indexOf(d);k>=0&&this.managedFramebuffers.splice(k,1),d.disposeRunner.remove(this),c||(A.deleteFramebuffer(f.framebuffer),f.msaaBuffer&&A.deleteRenderbuffer(f.msaaBuffer),f.stencil&&A.deleteRenderbuffer(f.stencil)),f.blitFramebuffer&&f.blitFramebuffer.dispose()}},T.prototype.disposeAll=function(d){var c=this.managedFramebuffers;this.managedFramebuffers=[];for(var f=0;f<c.length;f++)this.disposeFramebuffer(c[f],d)},T.prototype.forceStencil=function(){var d=this.current;if(d){var c=d.glFramebuffers[this.CONTEXT_UID];if(c&&!c.stencil){d.stencil=!0;var f=d.width,A=d.height,k=this.gl,K=k.createRenderbuffer();k.bindRenderbuffer(k.RENDERBUFFER,K),c.msaaBuffer?k.renderbufferStorageMultisample(k.RENDERBUFFER,c.multisample,k.DEPTH24_STENCIL8,f,A):k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_STENCIL,f,A),c.stencil=K,k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,K)}}},T.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new oe},T.prototype.destroy=function(){this.renderer=null},T}(),or={5126:4,5123:2,5121:1},Eo=function(){function T(d){this.renderer=d,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return T.prototype.contextChange=function(){this.disposeAll(!0);var d=this.gl=this.renderer.gl,c=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,c.webGLVersion!==2){var f=this.renderer.context.extensions.vertexArrayObject;S.b.PREFER_ENV===I.g.WEBGL_LEGACY&&(f=null),f?(d.createVertexArray=function(){return f.createVertexArrayOES()},d.bindVertexArray=function(k){return f.bindVertexArrayOES(k)},d.deleteVertexArray=function(k){return f.deleteVertexArrayOES(k)}):(this.hasVao=!1,d.createVertexArray=function(){return null},d.bindVertexArray=function(){return null},d.deleteVertexArray=function(){return null})}if(c.webGLVersion!==2){var A=d.getExtension("ANGLE_instanced_arrays");A?(d.vertexAttribDivisor=function(k,K){return A.vertexAttribDivisorANGLE(k,K)},d.drawElementsInstanced=function(k,K,ot,dt,Pt){return A.drawElementsInstancedANGLE(k,K,ot,dt,Pt)},d.drawArraysInstanced=function(k,K,ot,dt){return A.drawArraysInstancedANGLE(k,K,ot,dt)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=c.webGLVersion===2||!!c.extensions.uint32ElementIndex},T.prototype.bind=function(d,c){c=c||this.renderer.shader.shader;var f=this.gl,A=d.glVertexArrayObjects[this.CONTEXT_UID],k=!1;A||(this.managedGeometries[d.id]=d,d.disposeRunner.add(this),d.glVertexArrayObjects[this.CONTEXT_UID]=A={},k=!0);var K=A[c.program.id]||this.initGeometryVao(d,c,k);this._activeGeometry=d,this._activeVao!==K&&(this._activeVao=K,this.hasVao?f.bindVertexArray(K):this.activateVao(d,c.program)),this.updateBuffers()},T.prototype.reset=function(){this.unbind()},T.prototype.updateBuffers=function(){for(var d=this._activeGeometry,c=this.renderer.buffer,f=0;f<d.buffers.length;f++){var A=d.buffers[f];c.update(A)}},T.prototype.checkCompatibility=function(d,c){var f=d.attributes,A=c.attributeData;for(var k in A)if(!f[k])throw new Error('shader and geometry incompatible, geometry missing the "'+k+'" attribute')},T.prototype.getSignature=function(d,c){var f=d.attributes,A=c.attributeData,k=["g",d.id];for(var K in f)A[K]&&k.push(K,A[K].location);return k.join("-")},T.prototype.initGeometryVao=function(d,c,f){f===void 0&&(f=!0);var A=this.gl,k=this.CONTEXT_UID,K=this.renderer.buffer,ot=c.program;ot.glPrograms[k]||this.renderer.shader.generateProgram(c),this.checkCompatibility(d,ot);var dt=this.getSignature(d,ot),Pt=d.glVertexArrayObjects[this.CONTEXT_UID],kt=Pt[dt];if(kt)return Pt[ot.id]=kt,kt;var he=d.buffers,te=d.attributes,me={},xe={};for(var Be in he)me[Be]=0,xe[Be]=0;for(var Be in te)!te[Be].size&&ot.attributeData[Be]?te[Be].size=ot.attributeData[Be].size:te[Be].size||console.warn("PIXI Geometry attribute '"+Be+"' size cannot be determined (likely the bound shader does not have the attribute)"),me[te[Be].buffer]+=te[Be].size*or[te[Be].type];for(var Be in te){var qe=te[Be],Ye=qe.size;qe.stride===void 0&&(me[qe.buffer]===Ye*or[qe.type]?qe.stride=0:qe.stride=me[qe.buffer]),qe.start===void 0&&(qe.start=xe[qe.buffer],xe[qe.buffer]+=Ye*or[qe.type])}kt=A.createVertexArray(),A.bindVertexArray(kt);for(var Je=0;Je<he.length;Je++){var je=he[Je];K.bind(je),f&&je._glBuffers[k].refCount++}return this.activateVao(d,ot),this._activeVao=kt,Pt[ot.id]=kt,Pt[dt]=kt,kt},T.prototype.disposeGeometry=function(d,c){var f;if(this.managedGeometries[d.id]){delete this.managedGeometries[d.id];var A=d.glVertexArrayObjects[this.CONTEXT_UID],k=this.gl,K=d.buffers,ot=(f=this.renderer)===null||f===void 0?void 0:f.buffer;if(d.disposeRunner.remove(this),A){if(ot)for(var dt=0;dt<K.length;dt++){var Pt=K[dt]._glBuffers[this.CONTEXT_UID];Pt&&(Pt.refCount--,Pt.refCount!==0||c||ot.dispose(K[dt],c))}if(!c){for(var kt in A)if(kt[0]==="g"){var he=A[kt];this._activeVao===he&&this.unbind(),k.deleteVertexArray(he)}}delete d.glVertexArrayObjects[this.CONTEXT_UID]}}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedGeometries),f=0;f<c.length;f++)this.disposeGeometry(this.managedGeometries[c[f]],d)},T.prototype.activateVao=function(d,c){var f=this.gl,A=this.CONTEXT_UID,k=this.renderer.buffer,K=d.buffers,ot=d.attributes;d.indexBuffer&&k.bind(d.indexBuffer);var dt=null;for(var Pt in ot){var kt=ot[Pt],he=K[kt.buffer],te=he._glBuffers[A];if(c.attributeData[Pt]){dt!==te&&(k.bind(he),dt=te);var me=c.attributeData[Pt].location;if(f.enableVertexAttribArray(me),f.vertexAttribPointer(me,kt.size,kt.type||f.FLOAT,kt.normalized,kt.stride,kt.start),kt.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");f.vertexAttribDivisor(me,1)}}}},T.prototype.draw=function(d,c,f,A){var k=this.gl,K=this._activeGeometry;if(K.indexBuffer){var ot=K.indexBuffer.data.BYTES_PER_ELEMENT,dt=ot===2?k.UNSIGNED_SHORT:k.UNSIGNED_INT;ot===2||ot===4&&this.canUseUInt32ElementIndex?K.instanced?k.drawElementsInstanced(d,c||K.indexBuffer.data.length,dt,(f||0)*ot,A||1):k.drawElements(d,c||K.indexBuffer.data.length,dt,(f||0)*ot):console.warn("unsupported index buffer type: uint32")}else K.instanced?k.drawArraysInstanced(d,f,c||K.getSize(),A||1):k.drawArrays(d,f,c||K.getSize());return this},T.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},T.prototype.destroy=function(){this.renderer=null},T}(),So=function(){function T(d){d===void 0&&(d=null),this.type=I.j.NONE,this.autoDetect=!0,this.maskObject=d||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=S.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(T.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(d){d?this._filters?this._filters[0]=d:this._filters=[d]:this._filters=null},enumerable:!1,configurable:!0}),T.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=I.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},T.prototype.copyCountersOrReset=function(d){d?(this._stencilCounter=d._stencilCounter,this._scissorCounter=d._scissorCounter,this._scissorRect=d._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},T}();function Ao(T,d,c){var f=T.createShader(d);return T.shaderSource(f,c),T.compileShader(f),f}function Y(T,d){var c=T.getShaderSource(d).split(`
`).map(function(Pt,kt){return kt+": "+Pt}),f=T.getShaderInfoLog(d),A=f.split(`
`),k={},K=A.map(function(Pt){return parseFloat(Pt.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(Pt){return!(!Pt||k[Pt])&&(k[Pt]=!0,!0)}),ot=[""];K.forEach(function(Pt){c[Pt-1]="%c"+c[Pt-1]+"%c",ot.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var dt=c.join(`
`);ot[0]=dt,console.error(f),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,ot),console.groupEnd()}function g(T){for(var d=new Array(T),c=0;c<d.length;c++)d[c]=!1;return d}function m(T,d){switch(T){case"float":return 0;case"vec2":return new Float32Array(2*d);case"vec3":return new Float32Array(3*d);case"vec4":return new Float32Array(4*d);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*d);case"ivec3":return new Int32Array(3*d);case"ivec4":return new Int32Array(4*d);case"uvec2":return new Uint32Array(2*d);case"uvec3":return new Uint32Array(3*d);case"uvec4":return new Uint32Array(4*d);case"bool":return!1;case"bvec2":return g(2*d);case"bvec3":return g(3*d);case"bvec4":return g(4*d);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var y,N={},q=N;function ht(){if(!y){y=I.m.MEDIUM;var T=function(){if(q===N||q&&q.isContextLost()){var c=document.createElement("canvas"),f=void 0;S.b.PREFER_ENV>=I.g.WEBGL2&&(f=c.getContext("webgl2",{})),f||((f=c.getContext("webgl",{})||c.getContext("experimental-webgl",{}))?f.getExtension("WEBGL_draw_buffers"):f=null),q=f}return q}();if(T&&T.getShaderPrecisionFormat){var d=T.getShaderPrecisionFormat(T.FRAGMENT_SHADER,T.HIGH_FLOAT);y=d.precision?I.m.HIGH:I.m.MEDIUM}}return y}function xt(T,d,c){if(T.substring(0,9)!=="precision"){var f=d;return d===I.m.HIGH&&c!==I.m.HIGH&&(f=I.m.MEDIUM),"precision "+f+` float;
`+T}return c!==I.m.HIGH&&T.substring(0,15)==="precision highp"?T.replace("precision highp","precision mediump"):T}var Tt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Kt(T){return Tt[T]}var ee=null,Fe={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Te(T,d){if(!ee){var c=Object.keys(Fe);ee={};for(var f=0;f<c.length;++f){var A=c[f];ee[T[A]]=Fe[A]}}return ee[d]}var Qe=[{test:function(T){return T.type==="float"&&T.size===1},code:function(T){return`
            if(uv["`+T+'"] !== ud["'+T+`"].value)
            {
                ud["`+T+'"].value = uv["'+T+`"]
                gl.uniform1f(ud["`+T+'"].location, uv["'+T+`"])
            }
            `}},{test:function(T){return(T.type==="sampler2D"||T.type==="samplerCube"||T.type==="sampler2DArray")&&T.size===1&&!T.isArray},code:function(T){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+T+`"], t);

            if(ud["`+T+`"].value !== t)
            {
                ud["`+T+`"].value = t;
                gl.uniform1i(ud["`+T+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(T,d){return T.type==="mat3"&&T.size===1&&d.a!==void 0},code:function(T){return`
            gl.uniformMatrix3fv(ud["`+T+'"].location, false, uv["'+T+`"].toArray(true));
            `},codeUbo:function(T){return`
                var `+T+"_matrix = uv."+T+`.toArray(true);

                data[offset] = `+T+`_matrix[0];
                data[offset+1] = `+T+`_matrix[1];
                data[offset+2] = `+T+`_matrix[2];
        
                data[offset + 4] = `+T+`_matrix[3];
                data[offset + 5] = `+T+`_matrix[4];
                data[offset + 6] = `+T+`_matrix[5];
        
                data[offset + 8] = `+T+`_matrix[6];
                data[offset + 9] = `+T+`_matrix[7];
                data[offset + 10] = `+T+`_matrix[8];
            `}},{test:function(T,d){return T.type==="vec2"&&T.size===1&&d.x!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+T+`"].location, v.x, v.y);
                }`},codeUbo:function(T){return`
                v = uv.`+T+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(T){return T.type==="vec2"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+T+`"].location, v[0], v[1]);
                }
            `}},{test:function(T,d){return T.type==="vec4"&&T.size===1&&d.width!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+T+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(T){return`
                    v = uv.`+T+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(T){return T.type==="vec4"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+T+`"].location, v[0], v[1], v[2], v[3])
                }`}}],hn={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},vn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},un,Kn=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function mi(T){for(var d="",c=0;c<T;++c)c>0&&(d+=`
else `),c<T-1&&(d+="if(test == "+c+".0){}");return d}var gi=0,ei={},Di=function(){function T(d,c,f){f===void 0&&(f="pixi-shader"),this.id=gi++,this.vertexSrc=d||T.defaultVertexSrc,this.fragmentSrc=c||T.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(f=f.replace(/\s+/g,"-"),ei[f]?(ei[f]++,f+="-"+ei[f]):ei[f]=1,this.vertexSrc="#define SHADER_NAME "+f+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+f+`
`+this.fragmentSrc,this.vertexSrc=xt(this.vertexSrc,S.b.PRECISION_VERTEX,I.m.HIGH),this.fragmentSrc=xt(this.fragmentSrc,S.b.PRECISION_FRAGMENT,ht())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(T,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),T.from=function(d,c,f){var A=d+c,k=pe[A];return k||(pe[A]=k=new T(d,c,f)),k},T}(),Fi=function(){function T(d,c){this.uniformBindCount=0,this.program=d,this.uniformGroup=c?c instanceof bi?c:new bi(c):new bi({})}return T.prototype.checkUniformExists=function(d,c){if(c.uniforms[d])return!0;for(var f in c.uniforms){var A=c.uniforms[f];if(A.group&&this.checkUniformExists(d,A))return!0}return!1},T.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(T.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),T.from=function(d,c,f){return new T(Di.from(d,c),f)},T}(),hi=function(){function T(){this.data=0,this.blendMode=I.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(T.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(d){!!(1&this.data)!==d&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(d){!!(2&this.data)!==d&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(d){!!(4&this.data)!==d&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(d){!!(8&this.data)!==d&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(d){!!(32&this.data)!==d&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(d){!!(16&this.data)!==d&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"blendMode",{get:function(){return this._blendMode},set:function(d){this.blend=d!==I.b.NONE,this._blendMode=d},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(d){this.offsets=!!d,this._polygonOffset=d},enumerable:!1,configurable:!0}),T.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},T.for2d=function(){var d=new T;return d.depthTest=!1,d.blend=!0,d},T}(),Ti=function(T){function d(c,f,A){var k=this,K=Di.from(c||d.defaultVertexSrc,f||d.defaultFragmentSrc);return(k=T.call(this,K,A)||this).padding=0,k.resolution=S.b.FILTER_RESOLUTION,k.multisample=S.b.FILTER_MULTISAMPLE,k.enabled=!0,k.autoFit=!0,k.state=new hi,k}return Fn(d,T),d.prototype.apply=function(c,f,A,k,K){c.applyFilter(this,f,A,k)},Object.defineProperty(d.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(c){this.state.blendMode=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"resolution",{get:function(){return this._resolution},set:function(c){this._resolution=c},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),d}(Fi),vr=new Se,Br=function(){function T(d,c){this._texture=d,this.mapCoord=new Se,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=c===void 0?.5:c,this.isSimple=!1}return Object.defineProperty(T.prototype,"texture",{get:function(){return this._texture},set:function(d){this._texture=d,this._textureID=-1},enumerable:!1,configurable:!0}),T.prototype.multiplyUvs=function(d,c){c===void 0&&(c=d);for(var f=this.mapCoord,A=0;A<d.length;A+=2){var k=d[A],K=d[A+1];c[A]=k*f.a+K*f.c+f.tx,c[A+1]=k*f.b+K*f.d+f.ty}return c},T.prototype.update=function(d){var c=this._texture;if(!c||!c.valid||!d&&this._textureID===c._updateID)return!1;this._textureID=c._updateID,this._updateID++;var f=c._uvs;this.mapCoord.set(f.x1-f.x0,f.y1-f.y0,f.x3-f.x0,f.y3-f.y0,f.x0,f.y0);var A=c.orig,k=c.trim;k&&(vr.set(A.width/k.width,0,0,A.height/k.height,-k.x/k.width,-k.y/k.height),this.mapCoord.append(vr));var K=c.baseTexture,ot=this.uClampFrame,dt=this.clampMargin/K.resolution,Pt=this.clampOffset;return ot[0]=(c._frame.x+dt+Pt)/K.width,ot[1]=(c._frame.y+dt+Pt)/K.height,ot[2]=(c._frame.x+c._frame.width-dt+Pt)/K.width,ot[3]=(c._frame.y+c._frame.height-dt+Pt)/K.height,this.uClampOffset[0]=Pt/K.realWidth,this.uClampOffset[1]=Pt/K.realHeight,this.isSimple=c._frame.width===K.width&&c._frame.height===K.height&&c.rotate===0,!0},T}(),$o=function(T){function d(c,f,A){var k=this,K=null;return typeof c!="string"&&f===void 0&&A===void 0&&(K=c,c=void 0,f=void 0,A=void 0),(k=T.call(this,c||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,f||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,A)||this).maskSprite=K,k.maskMatrix=new Se,k}return Fn(d,T),Object.defineProperty(d.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(c){this._maskSprite=c,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),d.prototype.apply=function(c,f,A,k){var K=this._maskSprite,ot=K._texture;ot.valid&&(ot.uvMatrix||(ot.uvMatrix=new Br(ot,0)),ot.uvMatrix.update(),this.uniforms.npmAlpha=ot.baseTexture.alphaMode?0:1,this.uniforms.mask=ot,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,K).prepend(ot.uvMatrix.mapCoord),this.uniforms.alpha=K.worldAlpha,this.uniforms.maskClamp=ot.uvMatrix.uClampFrame,c.applyFilter(this,f,A,k))},d}(Ti),ts=function(){function T(d){this.renderer=d,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return T.prototype.setMaskStack=function(d){this.maskStack=d,this.renderer.scissor.setMaskStack(d),this.renderer.stencil.setMaskStack(d)},T.prototype.push=function(d,c){var f=c;if(!f.isMaskData){var A=this.maskDataPool.pop()||new So;A.pooled=!0,A.maskObject=c,f=A}var k=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(f.copyCountersOrReset(k),f.autoDetect&&this.detect(f),f._target=d,f.type!==I.j.SPRITE&&this.maskStack.push(f),f.enabled)switch(f.type){case I.j.SCISSOR:this.renderer.scissor.push(f);break;case I.j.STENCIL:this.renderer.stencil.push(f);break;case I.j.SPRITE:f.copyCountersOrReset(null),this.pushSpriteMask(f)}f.type===I.j.SPRITE&&this.maskStack.push(f)},T.prototype.pop=function(d){var c=this.maskStack.pop();if(c&&c._target===d){if(c.enabled)switch(c.type){case I.j.SCISSOR:this.renderer.scissor.pop();break;case I.j.STENCIL:this.renderer.stencil.pop(c.maskObject);break;case I.j.SPRITE:this.popSpriteMask(c)}if(c.reset(),c.pooled&&this.maskDataPool.push(c),this.maskStack.length!==0){var f=this.maskStack[this.maskStack.length-1];f.type===I.j.SPRITE&&f._filters&&(f._filters[0].maskSprite=f.maskObject)}}},T.prototype.detect=function(d){d.maskObject.isSprite?d.type=I.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(d)?d.type=I.j.SCISSOR:d.type=I.j.STENCIL},T.prototype.pushSpriteMask=function(d){var c,f,A=d.maskObject,k=d._target,K=d._filters;K||(K=this.alphaMaskPool[this.alphaMaskIndex])||(K=this.alphaMaskPool[this.alphaMaskIndex]=[new $o]);var ot,dt,Pt=this.renderer,kt=Pt.renderTexture;if(kt.current){var he=kt.current;ot=d.resolution||he.resolution,dt=(c=d.multisample)!==null&&c!==void 0?c:he.multisample}else ot=d.resolution||Pt.resolution,dt=(f=d.multisample)!==null&&f!==void 0?f:Pt.multisample;K[0].resolution=ot,K[0].multisample=dt,K[0].maskSprite=A;var te=k.filterArea;k.filterArea=A.getBounds(!0),Pt.filter.push(k,K),k.filterArea=te,d._filters||this.alphaMaskIndex++},T.prototype.popSpriteMask=function(d){this.renderer.filter.pop(),d._filters?d._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},T.prototype.destroy=function(){this.renderer=null},T}(),Cr=function(){function T(d){this.renderer=d,this.maskStack=[],this.glConst=0}return T.prototype.getStackLength=function(){return this.maskStack.length},T.prototype.setMaskStack=function(d){var c=this.renderer.gl,f=this.getStackLength();this.maskStack=d;var A=this.getStackLength();A!==f&&(A===0?c.disable(this.glConst):(c.enable(this.glConst),this._useCurrent()))},T.prototype._useCurrent=function(){},T.prototype.destroy=function(){this.renderer=null,this.maskStack=null},T}(),On=new Se,sn=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.SCISSOR_TEST,f}return Fn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._scissorCounter:0},d.prototype.calcScissorRect=function(c){if(!c._scissorRectLocal){var f=c._scissorRect,A=c.maskObject,k=this.renderer,K=k.renderTexture;A.renderable=!0;var ot=A.getBounds();this.roundFrameToPixels(ot,K.current?K.current.resolution:k.resolution,K.sourceFrame,K.destinationFrame,k.projection.transform),A.renderable=!1,f&&ot.fit(f),c._scissorRectLocal=ot}},d.isMatrixRotated=function(c){if(!c)return!1;var f=c.a,A=c.b,k=c.c,K=c.d;return(Math.abs(A)>1e-4||Math.abs(k)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(K)>1e-4)},d.prototype.testScissor=function(c){var f=c.maskObject;if(!f.isFastRect||!f.isFastRect()||d.isMatrixRotated(f.worldTransform)||d.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(c);var A=c._scissorRectLocal;return A.width>0&&A.height>0},d.prototype.roundFrameToPixels=function(c,f,A,k,K){d.isMatrixRotated(K)||((K=K?On.copyFrom(K):On.identity()).translate(-A.x,-A.y).scale(k.width/A.width,k.height/A.height).translate(k.x,k.y),this.renderer.filter.transformAABB(K,c),c.fit(k),c.x=Math.round(c.x*f),c.y=Math.round(c.y*f),c.width=Math.round(c.width*f),c.height=Math.round(c.height*f))},d.prototype.push=function(c){c._scissorRectLocal||this.calcScissorRect(c);var f=this.renderer.gl;c._scissorRect||f.enable(f.SCISSOR_TEST),c._scissorCounter++,c._scissorRect=c._scissorRectLocal,this._useCurrent()},d.prototype.pop=function(){var c=this.renderer.gl;this.getStackLength()>0?this._useCurrent():c.disable(c.SCISSOR_TEST)},d.prototype._useCurrent=function(){var c,f=this.maskStack[this.maskStack.length-1]._scissorRect;c=this.renderer.renderTexture.current?f.y:this.renderer.height-f.height-f.y,this.renderer.gl.scissor(f.x,c,f.width,f.height)},d}(Cr),Rr=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.STENCIL_TEST,f}return Fn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._stencilCounter:0},d.prototype.push=function(c){var f=c.maskObject,A=this.renderer.gl,k=c._stencilCounter;k===0&&(this.renderer.framebuffer.forceStencil(),A.clearStencil(0),A.clear(A.STENCIL_BUFFER_BIT),A.enable(A.STENCIL_TEST)),c._stencilCounter++,A.colorMask(!1,!1,!1,!1),A.stencilFunc(A.EQUAL,k,4294967295),A.stencilOp(A.KEEP,A.KEEP,A.INCR),f.renderable=!0,f.render(this.renderer),this.renderer.batch.flush(),f.renderable=!1,this._useCurrent()},d.prototype.pop=function(c){var f=this.renderer.gl;this.getStackLength()===0?f.disable(f.STENCIL_TEST):(f.colorMask(!1,!1,!1,!1),f.stencilOp(f.KEEP,f.KEEP,f.DECR),c.renderable=!0,c.render(this.renderer),this.renderer.batch.flush(),c.renderable=!1,this._useCurrent())},d.prototype._useCurrent=function(){var c=this.renderer.gl;c.colorMask(!0,!0,!0,!0),c.stencilFunc(c.EQUAL,this.getStackLength(),4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)},d}(Cr),Ch=function(){function T(d){this.renderer=d,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Se,this.transform=null}return T.prototype.update=function(d,c,f,A){this.destinationFrame=d||this.destinationFrame||this.defaultFrame,this.sourceFrame=c||this.sourceFrame||d,this.calculateProjection(this.destinationFrame,this.sourceFrame,f,A),this.transform&&this.projectionMatrix.append(this.transform);var k=this.renderer;k.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,k.globalUniforms.update(),k.shader.shader&&k.shader.syncUniformGroup(k.shader.shader.uniforms.globals)},T.prototype.calculateProjection=function(d,c,f,A){var k=this.projectionMatrix,K=A?-1:1;k.identity(),k.a=1/c.width*2,k.d=K*(1/c.height*2),k.tx=-1-c.x*k.a,k.ty=-K-c.y*k.d},T.prototype.setTransform=function(d){},T.prototype.destroy=function(){this.renderer=null},T}(),ao=new oe,es=new oe,Rh=function(){function T(d){this.renderer=d,this.clearColor=d._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new oe,this.destinationFrame=new oe,this.viewportFrame=new oe}return T.prototype.bind=function(d,c,f){d===void 0&&(d=null);var A,k,K,ot=this.renderer;this.current=d,d?(K=(A=d.baseTexture).resolution,c||(ao.width=d.frame.width,ao.height=d.frame.height,c=ao),f||(es.x=d.frame.x,es.y=d.frame.y,es.width=c.width,es.height=c.height,f=es),k=A.framebuffer):(K=ot.resolution,c||(ao.width=ot.screen.width,ao.height=ot.screen.height,c=ao),f||((f=ao).width=c.width,f.height=c.height));var dt=this.viewportFrame;dt.x=f.x*K,dt.y=f.y*K,dt.width=f.width*K,dt.height=f.height*K,d||(dt.y=ot.view.height-(dt.y+dt.height)),dt.ceil(),this.renderer.framebuffer.bind(k,dt),this.renderer.projection.update(f,c,K,!k),d?this.renderer.mask.setMaskStack(A.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(c),this.destinationFrame.copyFrom(f)},T.prototype.clear=function(d,c){d=this.current?d||this.current.baseTexture.clearColor:d||this.clearColor;var f=this.destinationFrame,A=this.current?this.current.baseTexture:this.renderer.screen,k=f.width!==A.width||f.height!==A.height;if(k){var K=this.viewportFrame,ot=K.x,dt=K.y,Pt=K.width,kt=K.height;ot=Math.round(ot),dt=Math.round(dt),Pt=Math.round(Pt),kt=Math.round(kt),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(ot,dt,Pt,kt)}this.renderer.framebuffer.clear(d[0],d[1],d[2],d[3],c),k&&this.renderer.scissor.pop()},T.prototype.resize=function(){this.bind(null)},T.prototype.reset=function(){this.bind(null)},T.prototype.destroy=function(){this.renderer=null},T}();function Ih(T,d,c,f,A){c.buffer.update(A)}var Ph={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},el={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Oh(T,d){if(!T.autoManage)return{size:0,syncFunc:Ih};for(var c=function(Je){for(var je=Je.map(function(bn){return{data:bn,offset:0,dataLen:0,dirty:0}}),pn=0,_n=0,Un=0,Dn=0;Dn<je.length;Dn++){var Xe=je[Dn];if(pn=el[Xe.data.type],Xe.data.size>1&&(pn=Math.max(pn,16)*Xe.data.size),Xe.dataLen=pn,_n%pn!=0&&_n<16){var an=_n%pn%16;_n+=an,Un+=an}_n+pn>16?(Un=16*Math.ceil(Un/16),Xe.offset=Un,Un+=pn,_n=pn):(Xe.offset=Un,_n+=pn,Un+=pn)}return{uboElements:je,size:Un=16*Math.ceil(Un/16)}}(function(Je,je){var pn=[];for(var _n in Je)je[_n]&&pn.push(je[_n]);return pn.sort(function(Un,Dn){return Un.index-Dn.index}),pn}(T.uniforms,d)),f=c.uboElements,A=c.size,k=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],K=0;K<f.length;K++){for(var ot=f[K],dt=T.uniforms[ot.data.name],Pt=ot.data.name,kt=!1,he=0;he<Qe.length;he++){var te=Qe[he];if(te.codeUbo&&te.test(ot.data,dt)){k.push("offset = "+ot.offset/4+";",Qe[he].codeUbo(ot.data.name,dt)),kt=!0;break}}if(!kt)if(ot.data.size>1){var me=Kt(ot.data.type),xe=Math.max(el[ot.data.type]/16,1),Be=me/xe,qe=(4-Be%4)%4;k.push(`
                cv = ud.`+Pt+`.value;
                v = uv.`+Pt+`;
                offset = `+ot.offset/4+`;

                t = 0;

                for(var i=0; i < `+ot.data.size*xe+`; i++)
                {
                    for(var j = 0; j < `+Be+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+qe+`;
                }

                `)}else{var Ye=Ph[ot.data.type];k.push(`
                cv = ud.`+Pt+`.value;
                v = uv.`+Pt+`;
                offset = `+ot.offset/4+`;
                `+Ye+`;
                `)}}return k.push(`
       renderer.buffer.update(buffer);
    `),{size:A,syncFunc:new Function("ud","uv","renderer","syncData","buffer",k.join(`
`))}}var Nh=function(){function T(d,c){this.program=d,this.uniformData=c,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return T.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},T}();function Lh(T,d){var c=Ao(T,T.VERTEX_SHADER,d.vertexSrc),f=Ao(T,T.FRAGMENT_SHADER,d.fragmentSrc),A=T.createProgram();if(T.attachShader(A,c),T.attachShader(A,f),T.linkProgram(A),T.getProgramParameter(A,T.LINK_STATUS)||function(Pt,kt,he,te){Pt.getProgramParameter(kt,Pt.LINK_STATUS)||(Pt.getShaderParameter(he,Pt.COMPILE_STATUS)||Y(Pt,he),Pt.getShaderParameter(te,Pt.COMPILE_STATUS)||Y(Pt,te),console.error("PixiJS Error: Could not initialize shader."),Pt.getProgramInfoLog(kt)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",Pt.getProgramInfoLog(kt)))}(T,A,c,f),d.attributeData=function(Pt,kt){for(var he={},te=kt.getProgramParameter(Pt,kt.ACTIVE_ATTRIBUTES),me=0;me<te;me++){var xe=kt.getActiveAttrib(Pt,me);if(xe.name.indexOf("gl_")!==0){var Be=Te(kt,xe.type),qe={type:Be,name:xe.name,size:Kt(Be),location:kt.getAttribLocation(Pt,xe.name)};he[xe.name]=qe}}return he}(A,T),d.uniformData=function(Pt,kt){for(var he={},te=kt.getProgramParameter(Pt,kt.ACTIVE_UNIFORMS),me=0;me<te;me++){var xe=kt.getActiveUniform(Pt,me),Be=xe.name.replace(/\[.*?\]$/,""),qe=!!xe.name.match(/\[.*?\]$/),Ye=Te(kt,xe.type);he[Be]={name:Be,index:me,type:Ye,size:xe.size,isArray:qe,value:m(Ye,xe.size)}}return he}(A,T),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(d.vertexSrc)){var k=Object.keys(d.attributeData);k.sort(function(Pt,kt){return Pt>kt?1:-1});for(var K=0;K<k.length;K++)d.attributeData[k[K]].location=K,T.bindAttribLocation(A,K,k[K]);T.linkProgram(A)}T.deleteShader(c),T.deleteShader(f);var ot={};for(var K in d.uniformData){var dt=d.uniformData[K];ot[K]={location:T.getUniformLocation(A,K),value:m(dt.type,dt.size)}}return new Nh(A,ot)}var Dh=0,ys={textureCount:0,uboCount:0},Fh=function(){function T(d){this.destroyed=!1,this.renderer=d,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Dh++}return T.prototype.systemCheck=function(){if(!function(){if(typeof un=="boolean")return un;try{var d=new Function("param1","param2","param3","return param1[param2] === param3;");un=d({a:"b"},"a","b")===!0}catch{un=!1}return un}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},T.prototype.contextChange=function(d){this.gl=d,this.reset()},T.prototype.bind=function(d,c){d.uniforms.globals=this.renderer.globalUniforms;var f=d.program,A=f.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(d);return this.shader=d,this.program!==f&&(this.program=f,this.gl.useProgram(A.program)),c||(ys.textureCount=0,ys.uboCount=0,this.syncUniformGroup(d.uniformGroup,ys)),A},T.prototype.setUniforms=function(d){var c=this.shader.program,f=c.glPrograms[this.renderer.CONTEXT_UID];c.syncUniforms(f.uniformData,d,this.renderer)},T.prototype.syncUniformGroup=function(d,c){var f=this.getGlProgram();d.static&&d.dirtyId===f.uniformDirtyGroups[d.id]||(f.uniformDirtyGroups[d.id]=d.dirtyId,this.syncUniforms(d,f,c))},T.prototype.syncUniforms=function(d,c,f){(d.syncUniforms[this.shader.program.id]||this.createSyncGroups(d))(c.uniformData,d.uniforms,this.renderer,f)},T.prototype.createSyncGroups=function(d){var c=this.getSignature(d,this.shader.program.uniformData,"u");return this.cache[c]||(this.cache[c]=function(f,A){var k,K=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var ot in f.uniforms){var dt=A[ot];if(dt){for(var Pt=f.uniforms[ot],kt=!1,he=0;he<Qe.length;he++)if(Qe[he].test(dt,Pt)){K.push(Qe[he].code(ot,Pt)),kt=!0;break}if(!kt){var te=(dt.size===1?hn:vn)[dt.type].replace("location",'ud["'+ot+'"].location');K.push(`
            cu = ud["`+ot+`"];
            cv = cu.value;
            v = uv["`+ot+`"];
            `+te+";")}}else!((k=f.uniforms[ot])===null||k===void 0)&&k.group&&(f.uniforms[ot].ubo?K.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+ot+", '"+ot+`');
                    `):K.push(`
                        renderer.shader.syncUniformGroup(uv.`+ot+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",K.join(`
`))}(d,this.shader.program.uniformData)),d.syncUniforms[this.shader.program.id]=this.cache[c],d.syncUniforms[this.shader.program.id]},T.prototype.syncUniformBufferGroup=function(d,c){var f=this.getGlProgram();if(!d.static||d.dirtyId!==0||!f.uniformGroups[d.id]){d.dirtyId=0;var A=f.uniformGroups[d.id]||this.createSyncBufferGroup(d,f,c);d.buffer.update(),A(f.uniformData,d.uniforms,this.renderer,ys,d.buffer)}this.renderer.buffer.bindBufferBase(d.buffer,f.uniformBufferBindings[c])},T.prototype.createSyncBufferGroup=function(d,c,f){var A=this.renderer.gl;this.renderer.buffer.bind(d.buffer);var k=this.gl.getUniformBlockIndex(c.program,f);c.uniformBufferBindings[f]=this.shader.uniformBindCount,A.uniformBlockBinding(c.program,k,this.shader.uniformBindCount),this.shader.uniformBindCount++;var K=this.getSignature(d,this.shader.program.uniformData,"ubo"),ot=this._uboCache[K];if(ot||(ot=this._uboCache[K]=Oh(d,this.shader.program.uniformData)),d.autoManage){var dt=new Float32Array(ot.size/4);d.buffer.update(dt)}return c.uniformGroups[d.id]=ot.syncFunc,c.uniformGroups[d.id]},T.prototype.getSignature=function(d,c,f){var A=d.uniforms,k=[f+"-"];for(var K in A)k.push(K),c[K]&&k.push(c[K].type);return k.join("-")},T.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},T.prototype.generateProgram=function(d){var c=this.gl,f=d.program,A=Lh(c,f);return f.glPrograms[this.renderer.CONTEXT_UID]=A,A},T.prototype.reset=function(){this.program=null,this.shader=null},T.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},T}(),Bh=function(){function T(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=I.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new hi,this.defaultState.blend=!0}return T.prototype.contextChange=function(d){this.gl=d,this.blendModes=function(c,f){return f===void 0&&(f=[]),f[I.b.NORMAL]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.ADD]=[c.ONE,c.ONE],f[I.b.MULTIPLY]=[c.DST_COLOR,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SCREEN]=[c.ONE,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.OVERLAY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.DARKEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.LIGHTEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR_DODGE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR_BURN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.HARD_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SOFT_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.DIFFERENCE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.EXCLUSION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.HUE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SATURATION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.LUMINOSITY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.NONE]=[0,0],f[I.b.NORMAL_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.ADD_NPM]=[c.SRC_ALPHA,c.ONE,c.ONE,c.ONE],f[I.b.SCREEN_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SRC_IN]=[c.DST_ALPHA,c.ZERO],f[I.b.SRC_OUT]=[c.ONE_MINUS_DST_ALPHA,c.ZERO],f[I.b.SRC_ATOP]=[c.DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[I.b.DST_OVER]=[c.ONE_MINUS_DST_ALPHA,c.ONE],f[I.b.DST_IN]=[c.ZERO,c.SRC_ALPHA],f[I.b.DST_OUT]=[c.ZERO,c.ONE_MINUS_SRC_ALPHA],f[I.b.DST_ATOP]=[c.ONE_MINUS_DST_ALPHA,c.SRC_ALPHA],f[I.b.XOR]=[c.ONE_MINUS_DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[I.b.SUBTRACT]=[c.ONE,c.ONE,c.ONE,c.ONE,c.FUNC_REVERSE_SUBTRACT,c.FUNC_ADD],f}(d),this.set(this.defaultState),this.reset()},T.prototype.set=function(d){if(d=d||this.defaultState,this.stateId!==d.data){for(var c=this.stateId^d.data,f=0;c;)1&c&&this.map[f].call(this,!!(d.data&1<<f)),c>>=1,f++;this.stateId=d.data}for(f=0;f<this.checks.length;f++)this.checks[f](this,d)},T.prototype.forceState=function(d){d=d||this.defaultState;for(var c=0;c<this.map.length;c++)this.map[c].call(this,!!(d.data&1<<c));for(c=0;c<this.checks.length;c++)this.checks[c](this,d);this.stateId=d.data},T.prototype.setBlend=function(d){this.updateCheck(T.checkBlendMode,d),this.gl[d?"enable":"disable"](this.gl.BLEND)},T.prototype.setOffset=function(d){this.updateCheck(T.checkPolygonOffset,d),this.gl[d?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},T.prototype.setDepthTest=function(d){this.gl[d?"enable":"disable"](this.gl.DEPTH_TEST)},T.prototype.setDepthMask=function(d){this.gl.depthMask(d)},T.prototype.setCullFace=function(d){this.gl[d?"enable":"disable"](this.gl.CULL_FACE)},T.prototype.setFrontFace=function(d){this.gl.frontFace(this.gl[d?"CW":"CCW"])},T.prototype.setBlendMode=function(d){if(d!==this.blendMode){this.blendMode=d;var c=this.blendModes[d],f=this.gl;c.length===2?f.blendFunc(c[0],c[1]):f.blendFuncSeparate(c[0],c[1],c[2],c[3]),c.length===6?(this._blendEq=!0,f.blendEquationSeparate(c[4],c[5])):this._blendEq&&(this._blendEq=!1,f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD))}},T.prototype.setPolygonOffset=function(d,c){this.gl.polygonOffset(d,c)},T.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},T.prototype.updateCheck=function(d,c){var f=this.checks.indexOf(d);c&&f===-1?this.checks.push(d):c||f===-1||this.checks.splice(f,1)},T.checkBlendMode=function(d,c){d.setBlendMode(c.blendMode)},T.checkPolygonOffset=function(d,c){d.setPolygonOffset(1,c.polygonOffset)},T.prototype.destroy=function(){this.gl=null},T}(),nl=function(){function T(d){this.renderer=d,this.count=0,this.checkCount=0,this.maxIdle=S.b.GC_MAX_IDLE,this.checkCountMax=S.b.GC_MAX_CHECK_COUNT,this.mode=S.b.GC_MODE}return T.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==I.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},T.prototype.run=function(){for(var d=this.renderer.texture,c=d.managedTextures,f=!1,A=0;A<c.length;A++){var k=c[A];!k.framebuffer&&this.count-k.touched>this.maxIdle&&(d.destroyTexture(k,!0),c[A]=null,f=!0)}if(f){var K=0;for(A=0;A<c.length;A++)c[A]!==null&&(c[K++]=c[A]);c.length=K}},T.prototype.unload=function(d){var c=this.renderer.texture,f=d._texture;f&&!f.framebuffer&&c.destroyTexture(f);for(var A=d.children.length-1;A>=0;A--)this.unload(d.children[A])},T.prototype.destroy=function(){this.renderer=null},T}(),xs=function(T){this.texture=T,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=I.r.UNSIGNED_BYTE,this.internalFormat=I.h.RGBA,this.samplerType=0},il=function(){function T(d){this.renderer=d,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new jn,this.hasIntegerTextures=!1}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(k){var K,ot,dt,Pt,kt,he,te,me,xe,Be,qe,Ye,Je,je,pn,_n,Un,Dn,Xe,an,bn,Gn,qn;return"WebGL2RenderingContext"in globalThis&&k instanceof globalThis.WebGL2RenderingContext?((K={})[I.r.UNSIGNED_BYTE]=((ot={})[I.h.RGBA]=k.RGBA8,ot[I.h.RGB]=k.RGB8,ot[I.h.RG]=k.RG8,ot[I.h.RED]=k.R8,ot[I.h.RGBA_INTEGER]=k.RGBA8UI,ot[I.h.RGB_INTEGER]=k.RGB8UI,ot[I.h.RG_INTEGER]=k.RG8UI,ot[I.h.RED_INTEGER]=k.R8UI,ot[I.h.ALPHA]=k.ALPHA,ot[I.h.LUMINANCE]=k.LUMINANCE,ot[I.h.LUMINANCE_ALPHA]=k.LUMINANCE_ALPHA,ot),K[I.r.BYTE]=((dt={})[I.h.RGBA]=k.RGBA8_SNORM,dt[I.h.RGB]=k.RGB8_SNORM,dt[I.h.RG]=k.RG8_SNORM,dt[I.h.RED]=k.R8_SNORM,dt[I.h.RGBA_INTEGER]=k.RGBA8I,dt[I.h.RGB_INTEGER]=k.RGB8I,dt[I.h.RG_INTEGER]=k.RG8I,dt[I.h.RED_INTEGER]=k.R8I,dt),K[I.r.UNSIGNED_SHORT]=((Pt={})[I.h.RGBA_INTEGER]=k.RGBA16UI,Pt[I.h.RGB_INTEGER]=k.RGB16UI,Pt[I.h.RG_INTEGER]=k.RG16UI,Pt[I.h.RED_INTEGER]=k.R16UI,Pt[I.h.DEPTH_COMPONENT]=k.DEPTH_COMPONENT16,Pt),K[I.r.SHORT]=((kt={})[I.h.RGBA_INTEGER]=k.RGBA16I,kt[I.h.RGB_INTEGER]=k.RGB16I,kt[I.h.RG_INTEGER]=k.RG16I,kt[I.h.RED_INTEGER]=k.R16I,kt),K[I.r.UNSIGNED_INT]=((he={})[I.h.RGBA_INTEGER]=k.RGBA32UI,he[I.h.RGB_INTEGER]=k.RGB32UI,he[I.h.RG_INTEGER]=k.RG32UI,he[I.h.RED_INTEGER]=k.R32UI,he[I.h.DEPTH_COMPONENT]=k.DEPTH_COMPONENT24,he),K[I.r.INT]=((te={})[I.h.RGBA_INTEGER]=k.RGBA32I,te[I.h.RGB_INTEGER]=k.RGB32I,te[I.h.RG_INTEGER]=k.RG32I,te[I.h.RED_INTEGER]=k.R32I,te),K[I.r.FLOAT]=((me={})[I.h.RGBA]=k.RGBA32F,me[I.h.RGB]=k.RGB32F,me[I.h.RG]=k.RG32F,me[I.h.RED]=k.R32F,me[I.h.DEPTH_COMPONENT]=k.DEPTH_COMPONENT32F,me),K[I.r.HALF_FLOAT]=((xe={})[I.h.RGBA]=k.RGBA16F,xe[I.h.RGB]=k.RGB16F,xe[I.h.RG]=k.RG16F,xe[I.h.RED]=k.R16F,xe),K[I.r.UNSIGNED_SHORT_5_6_5]=((Be={})[I.h.RGB]=k.RGB565,Be),K[I.r.UNSIGNED_SHORT_4_4_4_4]=((qe={})[I.h.RGBA]=k.RGBA4,qe),K[I.r.UNSIGNED_SHORT_5_5_5_1]=((Ye={})[I.h.RGBA]=k.RGB5_A1,Ye),K[I.r.UNSIGNED_INT_2_10_10_10_REV]=((Je={})[I.h.RGBA]=k.RGB10_A2,Je[I.h.RGBA_INTEGER]=k.RGB10_A2UI,Je),K[I.r.UNSIGNED_INT_10F_11F_11F_REV]=((je={})[I.h.RGB]=k.R11F_G11F_B10F,je),K[I.r.UNSIGNED_INT_5_9_9_9_REV]=((pn={})[I.h.RGB]=k.RGB9_E5,pn),K[I.r.UNSIGNED_INT_24_8]=((_n={})[I.h.DEPTH_STENCIL]=k.DEPTH24_STENCIL8,_n),K[I.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((Un={})[I.h.DEPTH_STENCIL]=k.DEPTH32F_STENCIL8,Un),qn=K):((Dn={})[I.r.UNSIGNED_BYTE]=((Xe={})[I.h.RGBA]=k.RGBA,Xe[I.h.RGB]=k.RGB,Xe[I.h.ALPHA]=k.ALPHA,Xe[I.h.LUMINANCE]=k.LUMINANCE,Xe[I.h.LUMINANCE_ALPHA]=k.LUMINANCE_ALPHA,Xe),Dn[I.r.UNSIGNED_SHORT_5_6_5]=((an={})[I.h.RGB]=k.RGB,an),Dn[I.r.UNSIGNED_SHORT_4_4_4_4]=((bn={})[I.h.RGBA]=k.RGBA,bn),Dn[I.r.UNSIGNED_SHORT_5_5_5_1]=((Gn={})[I.h.RGBA]=k.RGBA,Gn),qn=Dn),qn}(d);var c=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=c;for(var f=0;f<c;f++)this.boundTextures[f]=null;this.emptyTextures={};var A=new xs(d.createTexture());for(d.bindTexture(d.TEXTURE_2D,A.texture),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[d.TEXTURE_2D]=A,this.emptyTextures[d.TEXTURE_CUBE_MAP]=new xs(d.createTexture()),d.bindTexture(d.TEXTURE_CUBE_MAP,this.emptyTextures[d.TEXTURE_CUBE_MAP].texture),f=0;f<6;f++)d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,null);for(d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR),f=0;f<this.boundTextures.length;f++)this.bind(null,f)},T.prototype.bind=function(d,c){c===void 0&&(c=0);var f=this.gl;if((d=d==null?void 0:d.castToBaseTexture())&&d.valid&&!d.parentTextureArray){d.touched=this.renderer.textureGC.count;var A=d._glTextures[this.CONTEXT_UID]||this.initTexture(d);this.boundTextures[c]!==d&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(d.target,A.texture)),A.dirtyId!==d.dirtyId&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),this.updateTexture(d)),this.boundTextures[c]=d}else this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(f.TEXTURE_2D,this.emptyTextures[f.TEXTURE_2D].texture),this.boundTextures[c]=null},T.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var d=0;d<this.boundTextures.length;d++)this.boundTextures[d]=this.unknownTexture},T.prototype.unbind=function(d){var c=this.gl,f=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var A=0;A<f.length;A++)f[A]===this.unknownTexture&&this.bind(null,A)}for(A=0;A<f.length;A++)f[A]===d&&(this.currentLocation!==A&&(c.activeTexture(c.TEXTURE0+A),this.currentLocation=A),c.bindTexture(d.target,this.emptyTextures[d.target].texture),f[A]=null)},T.prototype.ensureSamplerType=function(d){var c=this.boundTextures,f=this.hasIntegerTextures,A=this.CONTEXT_UID;if(f)for(var k=d-1;k>=0;--k){var K=c[k];K&&K._glTextures[A].samplerType!==I.o.FLOAT&&this.renderer.texture.unbind(K)}},T.prototype.initTexture=function(d){var c=new xs(this.gl.createTexture());return c.dirtyId=-1,d._glTextures[this.CONTEXT_UID]=c,this.managedTextures.push(d),d.on("dispose",this.destroyTexture,this),c},T.prototype.initTextureType=function(d,c){var f,A;c.internalFormat=(A=(f=this.internalFormats[d.type])===null||f===void 0?void 0:f[d.format])!==null&&A!==void 0?A:d.format,this.webGLVersion===2&&d.type===I.r.HALF_FLOAT?c.type=this.gl.HALF_FLOAT:c.type=d.type},T.prototype.updateTexture=function(d){var c=d._glTextures[this.CONTEXT_UID];if(c){var f=this.renderer;if(this.initTextureType(d,c),d.resource&&d.resource.upload(f,d,c))c.samplerType!==I.o.FLOAT&&(this.hasIntegerTextures=!0);else{var A=d.realWidth,k=d.realHeight,K=f.gl;(c.width!==A||c.height!==k||c.dirtyId<0)&&(c.width=A,c.height=k,K.texImage2D(d.target,0,c.internalFormat,A,k,0,d.format,c.type,null))}d.dirtyStyleId!==c.dirtyStyleId&&this.updateTextureStyle(d),c.dirtyId=d.dirtyId}},T.prototype.destroyTexture=function(d,c){var f=this.gl;if((d=d.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(d),f.deleteTexture(d._glTextures[this.CONTEXT_UID].texture),d.off("dispose",this.destroyTexture,this),delete d._glTextures[this.CONTEXT_UID],!c)){var A=this.managedTextures.indexOf(d);A!==-1&&function(k,K,ot){var dt,Pt=k.length;if(!(K>=Pt||ot===0)){var kt=Pt-(ot=K+ot>Pt?Pt-K:ot);for(dt=K;dt<kt;++dt)k[dt]=k[dt+ot];k.length=kt}}(this.managedTextures,A,1)}},T.prototype.updateTextureStyle=function(d){var c=d._glTextures[this.CONTEXT_UID];c&&(d.mipmap!==I.k.POW2&&this.webGLVersion===2||d.isPowerOfTwo?c.mipmap=d.mipmap>=1:c.mipmap=!1,this.webGLVersion===2||d.isPowerOfTwo?c.wrapMode=d.wrapMode:c.wrapMode=I.s.CLAMP,d.resource&&d.resource.style(this.renderer,d,c)||this.setStyle(d,c),c.dirtyStyleId=d.dirtyStyleId)},T.prototype.setStyle=function(d,c){var f=this.gl;if(c.mipmap&&d.mipmap!==I.k.ON_MANUAL&&f.generateMipmap(d.target),f.texParameteri(d.target,f.TEXTURE_WRAP_S,c.wrapMode),f.texParameteri(d.target,f.TEXTURE_WRAP_T,c.wrapMode),c.mipmap){f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR_MIPMAP_LINEAR:f.NEAREST_MIPMAP_NEAREST);var A=this.renderer.context.extensions.anisotropicFiltering;if(A&&d.anisotropicLevel>0&&d.scaleMode===I.p.LINEAR){var k=Math.min(d.anisotropicLevel,f.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT));f.texParameterf(d.target,A.TEXTURE_MAX_ANISOTROPY_EXT,k)}}else f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR:f.NEAREST);f.texParameteri(d.target,f.TEXTURE_MAG_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR:f.NEAREST)},T.prototype.destroy=function(){this.renderer=null},T}(),na=new Se,kh=function(T){function d(c,f){c===void 0&&(c=I.n.UNKNOWN);var A=T.call(this)||this;return f=Object.assign({},S.b.RENDER_OPTIONS,f),A.options=f,A.type=c,A.screen=new oe(0,0,f.width,f.height),A.view=f.view||document.createElement("canvas"),A.resolution=f.resolution||S.b.RESOLUTION,A.useContextAlpha=f.useContextAlpha,A.autoDensity=!!f.autoDensity,A.preserveDrawingBuffer=f.preserveDrawingBuffer,A.clearBeforeRender=f.clearBeforeRender,A._backgroundColor=0,A._backgroundColorRgba=[0,0,0,1],A._backgroundColorString="#000000",A.backgroundColor=f.backgroundColor||A._backgroundColor,A.backgroundAlpha=f.backgroundAlpha,f.transparent!==void 0&&(Rn("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),A.useContextAlpha=f.transparent,A.backgroundAlpha=f.transparent?0:1),A._lastObjectRendered=null,A.plugins={},A}return Fn(d,T),d.prototype.initPlugins=function(c){for(var f in c)this.plugins[f]=new c[f](this)},Object.defineProperty(d.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f){this.view.width=Math.round(c*this.resolution),this.view.height=Math.round(f*this.resolution);var A=this.view.width/this.resolution,k=this.view.height/this.resolution;this.screen.width=A,this.screen.height=k,this.autoDensity&&(this.view.style.width=A+"px",this.view.style.height=k+"px"),this.emit("resize",A,k)},d.prototype.generateTexture=function(c,f,A,k){f===void 0&&(f={}),typeof f=="number"&&(Rn("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),f={scaleMode:f,resolution:A,region:k});var K=f.region,ot=function(Pt,kt){var he={};for(var te in Pt)Object.prototype.hasOwnProperty.call(Pt,te)&&kt.indexOf(te)<0&&(he[te]=Pt[te]);if(Pt!=null&&typeof Object.getOwnPropertySymbols=="function"){var me=0;for(te=Object.getOwnPropertySymbols(Pt);me<te.length;me++)kt.indexOf(te[me])<0&&(he[te[me]]=Pt[te[me]])}return he}(f,["region"]);(k=K||c.getLocalBounds(null,!0)).width===0&&(k.width=1),k.height===0&&(k.height=1);var dt=oo.create(Yo({width:k.width,height:k.height},ot));return na.tx=-k.x,na.ty=-k.y,this.render(c,{renderTexture:dt,clear:!1,transform:na,skipUpdateTransform:!!c.parent}),dt},d.prototype.destroy=function(c){for(var f in this.plugins)this.plugins[f].destroy(),this.plugins[f]=null;c&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=I.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(d.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(c){var f;this._backgroundColor=c,this._backgroundColorString=(f=c.toString(16),"#"+(f="000000".substring(0,6-f.length)+f)),function(A,k){k===void 0&&(k=[]),k[0]=(A>>16&255)/255,k[1]=(A>>8&255)/255,k[2]=(255&A)/255}(c,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(c){this._backgroundColorRgba[3]=c},enumerable:!1,configurable:!0}),d}(et),rl=function(T){this.buffer=T||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},ol=function(){function T(d){this.renderer=d,this.managedBuffers={},this.boundBufferBases={}}return T.prototype.destroy=function(){this.renderer=null},T.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},T.prototype.bind=function(d){var c=this.gl,f=this.CONTEXT_UID,A=d._glBuffers[f]||this.createGLBuffer(d);c.bindBuffer(d.type,A.buffer)},T.prototype.bindBufferBase=function(d,c){var f=this.gl,A=this.CONTEXT_UID;if(this.boundBufferBases[c]!==d){var k=d._glBuffers[A]||this.createGLBuffer(d);this.boundBufferBases[c]=d,f.bindBufferBase(f.UNIFORM_BUFFER,c,k.buffer)}},T.prototype.bindBufferRange=function(d,c,f){var A=this.gl,k=this.CONTEXT_UID;f=f||0;var K=d._glBuffers[k]||this.createGLBuffer(d);A.bindBufferRange(A.UNIFORM_BUFFER,c||0,K.buffer,256*f,256)},T.prototype.update=function(d){var c=this.gl,f=this.CONTEXT_UID,A=d._glBuffers[f];if(d._updateID!==A.updateID)if(A.updateID=d._updateID,c.bindBuffer(d.type,A.buffer),A.byteLength>=d.data.byteLength)c.bufferSubData(d.type,0,d.data);else{var k=d.static?c.STATIC_DRAW:c.DYNAMIC_DRAW;A.byteLength=d.data.byteLength,c.bufferData(d.type,d.data,k)}},T.prototype.dispose=function(d,c){if(this.managedBuffers[d.id]){delete this.managedBuffers[d.id];var f=d._glBuffers[this.CONTEXT_UID],A=this.gl;d.disposeRunner.remove(this),f&&(c||A.deleteBuffer(f.buffer),delete d._glBuffers[this.CONTEXT_UID])}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedBuffers),f=0;f<c.length;f++)this.dispose(this.managedBuffers[c[f]],d)},T.prototype.createGLBuffer=function(d){var c=this.CONTEXT_UID,f=this.gl;return d._glBuffers[c]=new rl(f.createBuffer()),this.managedBuffers[d.id]=d,d.disposeRunner.add(this),d._glBuffers[c]},T}();(function(T){function d(c){var f=T.call(this,I.n.WEBGL,c)||this;return c=f.options,f.gl=null,f.CONTEXT_UID=0,f.runners={destroy:new tn("destroy"),contextChange:new tn("contextChange"),reset:new tn("reset"),update:new tn("update"),postrender:new tn("postrender"),prerender:new tn("prerender"),resize:new tn("resize")},f.runners.contextChange.add(f),f.globalUniforms=new bi({projectionMatrix:new Se},!0),f.addSystem(ts,"mask").addSystem(Fr,"context").addSystem(Bh,"state").addSystem(Fh,"shader").addSystem(il,"texture").addSystem(ol,"buffer").addSystem(Eo,"geometry").addSystem(Mr,"framebuffer").addSystem(sn,"scissor").addSystem(Rr,"stencil").addSystem(Ch,"projection").addSystem(nl,"textureGC").addSystem(so,"filter").addSystem(Rh,"renderTexture").addSystem(Wn,"batch"),f.initPlugins(d.__plugins),f.multisample=void 0,c.context?f.context.initFromContext(c.context):f.context.initFromOptions({alpha:!!f.useContextAlpha,antialias:c.antialias,premultipliedAlpha:f.useContextAlpha&&f.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer,powerPreference:f.options.powerPreference}),f.renderingToScreen=!0,function(A){var k;if(!_e){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var K=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+A+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(k=globalThis.console).log.apply(k,K)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+A+" - http://www.pixijs.com/");_e=!0}}(f.context.webGLVersion===2?"WebGL 2":"WebGL 1"),f.resize(f.options.width,f.options.height),f}Fn(d,T),d.create=function(c){if(at===void 0&&(at=function(){var f={stencil:!0,failIfMajorPerformanceCaveat:S.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var A=document.createElement("canvas"),k=A.getContext("webgl",f)||A.getContext("experimental-webgl",f),K=!(!k||!k.getContextAttributes().stencil);if(k){var ot=k.getExtension("WEBGL_lose_context");ot&&ot.loseContext()}return k=null,K}catch{return!1}}()),at)return new d(c);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},d.prototype.contextChange=function(){var c,f=this.gl;if(this.context.webGLVersion===1){var A=f.getParameter(f.FRAMEBUFFER_BINDING);f.bindFramebuffer(f.FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.FRAMEBUFFER,A)}else A=f.getParameter(f.DRAW_FRAMEBUFFER_BINDING),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,A);c>=I.l.HIGH?this.multisample=I.l.HIGH:c>=I.l.MEDIUM?this.multisample=I.l.MEDIUM:c>=I.l.LOW?this.multisample=I.l.LOW:this.multisample=I.l.NONE},d.prototype.addSystem=function(c,f){var A=new c(this);if(this[f])throw new Error('Whoops! The name "'+f+'" is already in use');for(var k in this[f]=A,this.runners)this.runners[k].add(A);return this},d.prototype.render=function(c,f){var A,k,K,ot;if(f&&(f instanceof oo?(Rn("6.0.0","Renderer#render arguments changed, use options instead."),A=f,k=arguments[2],K=arguments[3],ot=arguments[4]):(A=f.renderTexture,k=f.clear,K=f.transform,ot=f.skipUpdateTransform)),this.renderingToScreen=!A,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=K,!this.context.isLost){if(A||(this._lastObjectRendered=c),!ot){var dt=c.enableTempParent();c.updateTransform(),c.disableTempParent(dt)}this.renderTexture.bind(A),this.batch.currentRenderer.start(),(k!==void 0?k:this.clearBeforeRender)&&this.renderTexture.clear(),c.render(this),this.batch.currentRenderer.flush(),A&&A.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},d.prototype.generateTexture=function(c,f,A,k){f===void 0&&(f={});var K=T.prototype.generateTexture.call(this,c,f,A,k);return this.framebuffer.blit(),K},d.prototype.resize=function(c,f){T.prototype.resize.call(this,c,f),this.runners.resize.emit(this.screen.height,this.screen.width)},d.prototype.reset=function(){return this.runners.reset.emit(),this},d.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},d.prototype.destroy=function(c){for(var f in this.runners.destroy.emit(),this.runners)this.runners[f].destroy();T.prototype.destroy.call(this,c),this.gl=null},Object.defineProperty(d.prototype,"extract",{get:function(){return Rn("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),d.registerPlugin=function(c,f){d.__plugins=d.__plugins||{},d.__plugins[c]=f}})(kh);var sl=function(){this.texArray=null,this.blend=0,this.type=I.f.TRIANGLES,this.start=0,this.size=0,this.data=null},al=function(){function T(){this.elements=[],this.ids=[],this.count=0}return T.prototype.clear=function(){for(var d=0;d<this.count;d++)this.elements[d]=null;this.count=0},T}(),ll=function(){function T(d){typeof d=="number"?this.rawBinaryData=new ArrayBuffer(d):d instanceof Uint8Array?this.rawBinaryData=d.buffer:this.rawBinaryData=d,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(T.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),T.prototype.view=function(d){return this[d+"View"]},T.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},T.sizeOf=function(d){switch(d){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(d+" isn't a valid view type")}},T}(),hl=function(T){function d(c){var f=T.call(this,c)||this;return f.shaderGenerator=null,f.geometryClass=null,f.vertexSize=null,f.state=hi.for2d(),f.size=4*S.b.SPRITE_BATCH_SIZE,f._vertexCount=0,f._indexCount=0,f._bufferedElements=[],f._bufferedTextures=[],f._bufferSize=0,f._shader=null,f._packedGeometries=[],f._packedGeometryPoolSize=2,f._flushId=0,f._aBuffers={},f._iBuffers={},f.MAX_TEXTURES=1,f.renderer.on("prerender",f.onPrerender,f),c.runners.contextChange.add(f),f._dcIndex=0,f._aIndex=0,f._iIndex=0,f._attributeBuffer=null,f._indexBuffer=null,f._tempBoundTextures=[],f}return Fn(d,T),d.prototype.contextChange=function(){var c=this.renderer.gl;S.b.PREFER_ENV===I.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),S.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(A,k){if(A===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var K=k.createShader(k.FRAGMENT_SHADER);;){var ot=Kn.replace(/%forloop%/gi,mi(A));if(k.shaderSource(K,ot),k.compileShader(K),k.getShaderParameter(K,k.COMPILE_STATUS))break;A=A/2|0}return A}(this.MAX_TEXTURES,c)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var f=0;f<this._packedGeometryPoolSize;f++)this._packedGeometries[f]=new this.geometryClass;this.initFlushBuffers()},d.prototype.initFlushBuffers=function(){for(var c=d._drawCallPool,f=d._textureArrayPool,A=this.size/4,k=Math.floor(A/this.MAX_TEXTURES)+1;c.length<A;)c.push(new sl);for(;f.length<k;)f.push(new al);for(var K=0;K<this.MAX_TEXTURES;K++)this._tempBoundTextures[K]=null},d.prototype.onPrerender=function(){this._flushId=0},d.prototype.render=function(c){c._texture.valid&&(this._vertexCount+c.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=c.vertexData.length/2,this._indexCount+=c.indices.length,this._bufferedTextures[this._bufferSize]=c._texture.baseTexture,this._bufferedElements[this._bufferSize++]=c)},d.prototype.buildTexturesAndDrawCalls=function(){var c=this._bufferedTextures,f=this.MAX_TEXTURES,A=d._textureArrayPool,k=this.renderer.batch,K=this._tempBoundTextures,ot=this.renderer.textureGC.count,dt=++jn._globalBatch,Pt=0,kt=A[0],he=0;k.copyBoundTextures(K,f);for(var te=0;te<this._bufferSize;++te){var me=c[te];c[te]=null,me._batchEnabled!==dt&&(kt.count>=f&&(k.boundArray(kt,K,dt,f),this.buildDrawCalls(kt,he,te),he=te,kt=A[++Pt],++dt),me._batchEnabled=dt,me.touched=ot,kt.elements[kt.count++]=me)}for(kt.count>0&&(k.boundArray(kt,K,dt,f),this.buildDrawCalls(kt,he,this._bufferSize),++Pt,++dt),te=0;te<K.length;te++)K[te]=null;jn._globalBatch=dt},d.prototype.buildDrawCalls=function(c,f,A){var k=this._bufferedElements,K=this._attributeBuffer,ot=this._indexBuffer,dt=this.vertexSize,Pt=d._drawCallPool,kt=this._dcIndex,he=this._aIndex,te=this._iIndex,me=Pt[kt];me.start=this._iIndex,me.texArray=c;for(var xe=f;xe<A;++xe){var Be=k[xe],qe=Be._texture.baseTexture,Ye=ke[qe.alphaMode?1:0][Be.blendMode];k[xe]=null,f<xe&&me.blend!==Ye&&(me.size=te-me.start,f=xe,(me=Pt[++kt]).texArray=c,me.start=te),this.packInterleavedGeometry(Be,K,ot,he,te),he+=Be.vertexData.length/2*dt,te+=Be.indices.length,me.blend=Ye}f<A&&(me.size=te-me.start,++kt),this._dcIndex=kt,this._aIndex=he,this._iIndex=te},d.prototype.bindAndClearTexArray=function(c){for(var f=this.renderer.texture,A=0;A<c.count;A++)f.bind(c.elements[A],c.ids[A]),c.elements[A]=null;c.count=0},d.prototype.updateGeometry=function(){var c=this._packedGeometries,f=this._attributeBuffer,A=this._indexBuffer;S.b.CAN_UPLOAD_SAME_BUFFER?(c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(A),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,c[this._flushId]=new this.geometryClass),c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(A),this.renderer.geometry.bind(c[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},d.prototype.drawBatches=function(){for(var c=this._dcIndex,f=this.renderer,A=f.gl,k=f.state,K=d._drawCallPool,ot=null,dt=0;dt<c;dt++){var Pt=K[dt],kt=Pt.texArray,he=Pt.type,te=Pt.size,me=Pt.start,xe=Pt.blend;ot!==kt&&(ot=kt,this.bindAndClearTexArray(kt)),this.state.blendMode=xe,k.set(this.state),A.drawElements(he,te,A.UNSIGNED_SHORT,2*me)}},d.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},d.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),S.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},d.prototype.stop=function(){this.flush()},d.prototype.destroy=function(){for(var c=0;c<this._packedGeometryPoolSize;c++)this._packedGeometries[c]&&this._packedGeometries[c].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),T.prototype.destroy.call(this)},d.prototype.getAttributeBuffer=function(c){var f=Ae(Math.ceil(c/8)),A=$e(f),k=8*f;this._aBuffers.length<=A&&(this._iBuffers.length=A+1);var K=this._aBuffers[k];return K||(this._aBuffers[k]=K=new ll(k*this.vertexSize*4)),K},d.prototype.getIndexBuffer=function(c){var f=Ae(Math.ceil(c/12)),A=$e(f),k=12*f;this._iBuffers.length<=A&&(this._iBuffers.length=A+1);var K=this._iBuffers[A];return K||(this._iBuffers[A]=K=new Uint16Array(k)),K},d.prototype.packInterleavedGeometry=function(c,f,A,k,K){for(var ot=f.uint32View,dt=f.float32View,Pt=k/this.vertexSize,kt=c.uvs,he=c.indices,te=c.vertexData,me=c._texture.baseTexture._batchLocation,xe=Math.min(c.worldAlpha,1),Be=xe<1&&c._texture.baseTexture.alphaMode?function(Ye,Je){if(Je===1)return(255*Je<<24)+Ye;if(Je===0)return 0;var je=Ye>>16&255,pn=Ye>>8&255,_n=255&Ye;return(255*Je<<24)+((je=je*Je+.5|0)<<16)+((pn=pn*Je+.5|0)<<8)+(_n=_n*Je+.5|0)}(c._tintRGB,xe):c._tintRGB+(255*xe<<24),qe=0;qe<te.length;qe+=2)dt[k++]=te[qe],dt[k++]=te[qe+1],dt[k++]=kt[qe],dt[k++]=kt[qe+1],ot[k++]=Be,dt[k++]=me;for(qe=0;qe<he.length;qe++)A[K++]=Pt+he[qe]},d._drawCallPool=[],d._textureArrayPool=[],d}(fi),Mo=function(){function T(d,c){if(this.vertexSrc=d,this.fragTemplate=c,this.programCache={},this.defaultGroupCache={},c.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(c.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return T.prototype.generateShader=function(d){if(!this.programCache[d]){for(var c=new Int32Array(d),f=0;f<d;f++)c[f]=f;this.defaultGroupCache[d]=bi.from({uSamplers:c},!0);var A=this.fragTemplate;A=(A=A.replace(/%count%/gi,""+d)).replace(/%forloop%/gi,this.generateSampleSrc(d)),this.programCache[d]=new Di(this.vertexSrc,A)}var k={tint:new Float32Array([1,1,1,1]),translationMatrix:new Se,default:this.defaultGroupCache[d]};return new Fi(this.programCache[d],k)},T.prototype.generateSampleSrc=function(d){var c="";c+=`
`,c+=`
`;for(var f=0;f<d;f++)f>0&&(c+=`
else `),f<d-1&&(c+="if(vTextureId < "+f+".5)"),c+=`
{`,c+=`
	color = texture2D(uSamplers[`+f+"], vTextureCoord);",c+=`
}`;return c+=`
`,c+=`
`},T}(),qi=function(T){function d(c){c===void 0&&(c=!1);var f=T.call(this)||this;return f._buffer=new Mn(null,c,!1),f._indexBuffer=new Mn(null,c,!0),f.addAttribute("aVertexPosition",f._buffer,2,!1,I.r.FLOAT).addAttribute("aTextureCoord",f._buffer,2,!1,I.r.FLOAT).addAttribute("aColor",f._buffer,4,!0,I.r.UNSIGNED_BYTE).addAttribute("aTextureId",f._buffer,1,!0,I.r.FLOAT).addIndex(f._indexBuffer),f}return Fn(d,T),d}(bo),Bi=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,ia=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;(function(){function T(){}return T.create=function(d){var c=Object.assign({vertex:Bi,fragment:ia,geometryClass:qi,vertexSize:6},d),f=c.vertex,A=c.fragment,k=c.vertexSize,K=c.geometryClass;return function(ot){function dt(Pt){var kt=ot.call(this,Pt)||this;return kt.shaderGenerator=new Mo(f,A),kt.geometryClass=K,kt.vertexSize=k,kt}return Fn(dt,ot),dt}(hl)},Object.defineProperty(T,"defaultVertexSrc",{get:function(){return Bi},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentTemplate",{get:function(){return ia},enumerable:!1,configurable:!0}),T})().create();var Uh=function(){function T(d){this.renderer=d}return T.prototype.render=function(d){var c=this.renderer,f=d.worldTransform;c.context.globalAlpha=d.worldAlpha,c.setBlendMode(d.blendMode),c.setContextTransform(f,d.roundPixels),d.drawMode!==I.f.TRIANGLES?this._renderTriangleMesh(d):this._renderTriangles(d)},T.prototype._renderTriangleMesh=function(d){for(var c=d.geometry.buffers[0].data.length,f=0;f<c-2;f++){var A=2*f;this._renderDrawTriangle(d,A,A+2,A+4)}},T.prototype._renderTriangles=function(d){for(var c=d.geometry.getIndex().data,f=c.length,A=0;A<f;A+=3){var k=2*c[A],K=2*c[A+1],ot=2*c[A+2];this._renderDrawTriangle(d,k,K,ot)}},T.prototype._renderDrawTriangle=function(d,c,f,A){var k=this.renderer.context,K=d.geometry.buffers[0].data,ot=d.uvs,dt=d.texture;if(dt.valid){var Pt=d.tint!==16777215,kt=dt.baseTexture,he=kt.width,te=kt.height;Pt&&d._cachedTint!==d.tint&&(d._cachedTint=d.tint,d._cachedTexture=d._cachedTexture||new _o(kt),d._tintedCanvas=D.b.getTintedCanvas({texture:d._cachedTexture},d.tint));var me=Pt?d._tintedCanvas:kt.getDrawableSource(),xe=ot[c]*kt.width,Be=ot[f]*kt.width,qe=ot[A]*kt.width,Ye=ot[c+1]*kt.height,Je=ot[f+1]*kt.height,je=ot[A+1]*kt.height,pn=K[c],_n=K[f],Un=K[A],Dn=K[c+1],Xe=K[f+1],an=K[A+1],bn=d.canvasPadding/this.renderer.resolution;if(bn>0){var Gn=d.worldTransform,qn=Gn.a,wi=Gn.b,$n=Gn.c,vi=Gn.d,Ri=(pn+_n+Un)/3,Ji=(Dn+Xe+an)/3,ki=pn-Ri,ni=Dn-Ji,Ei=qn*ki+$n*ni,Ui=wi*ki+vi*ni,Gi=Math.sqrt(Ei*Ei+Ui*Ui),$i=1+bn/Gi;pn=Ri+ki*$i,Dn=Ji+ni*$i,Ei=qn*(ki=_n-Ri)+$n*(ni=Xe-Ji),Ui=wi*ki+vi*ni,_n=Ri+ki*($i=1+bn/(Gi=Math.sqrt(Ei*Ei+Ui*Ui))),Xe=Ji+ni*$i,Ei=qn*(ki=Un-Ri)+$n*(ni=an-Ji),Ui=wi*ki+vi*ni,Un=Ri+ki*($i=1+bn/(Gi=Math.sqrt(Ei*Ei+Ui*Ui))),an=Ji+ni*$i}k.save(),k.beginPath(),k.moveTo(pn,Dn),k.lineTo(_n,Xe),k.lineTo(Un,an),k.closePath(),k.clip();var ii=xe*Je+Ye*qe+Be*je-Je*qe-Ye*Be-xe*je,cl=pn*Je+Ye*Un+_n*je-Je*Un-Ye*_n-pn*je,Gh=xe*_n+pn*qe+Be*Un-_n*qe-pn*Be-xe*Un,dl=xe*Je*Un+Ye*_n*qe+pn*Be*je-pn*Je*qe-Ye*Be*Un-xe*_n*je,pl=Dn*Je+Ye*an+Xe*je-Je*an-Ye*Xe-Dn*je,ns=xe*Xe+Dn*qe+Be*an-Xe*qe-Dn*Be-xe*an,Hh=xe*Je*an+Ye*Xe*qe+Dn*Be*je-Dn*Je*qe-Ye*Be*an-xe*Xe*je;k.transform(cl/ii,pl/ii,Gh/ii,ns/ii,dl/ii,Hh/ii),k.drawImage(me,0,0,he*kt.resolution,te*kt.resolution,0,0,he,te),k.restore(),this.renderer.invalidateBlendMode()}},T.prototype.renderMeshFlat=function(d){var c=this.renderer.context,f=d.geometry.getBuffer("aVertexPosition").data,A=f.length/2;c.beginPath();for(var k=1;k<A-2;++k){var K=2*k,ot=f[K],dt=f[K+1],Pt=f[K+2],kt=f[K+3],he=f[K+4],te=f[K+5];c.moveTo(ot,dt),c.lineTo(Pt,kt),c.lineTo(he,te)}c.fillStyle="#FF0000",c.fill(),c.closePath()},T.prototype.destroy=function(){this.renderer=null},T}();S.b.MESH_CANVAS_PADDING=0,F.c.prototype._renderCanvas=function(T,d){T.plugins.mesh.render(d)},z.a.prototype._cachedTint=16777215,z.a.prototype._tintedCanvas=null,z.a.prototype._canvasUvs=null,z.a.prototype._renderCanvas=function(T){var d=T.context,c=this.worldTransform,f=this.tint!==16777215,A=this.texture;if(A.valid){f&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=D.b.getTintedCanvas(this,this.tint));var k=f?this._tintedCanvas:A.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var K=this.vertices,ot=this._canvasUvs,dt=f?0:A.frame.x,Pt=f?0:A.frame.y,kt=dt+A.frame.width,he=Pt+A.frame.height;ot[0]=dt,ot[1]=dt+this._leftWidth,ot[2]=kt-this._rightWidth,ot[3]=kt,ot[4]=Pt,ot[5]=Pt+this._topHeight,ot[6]=he-this._bottomHeight,ot[7]=he;for(var te=0;te<8;te++)ot[te]*=A.baseTexture.resolution;d.globalAlpha=this.worldAlpha,T.setBlendMode(this.blendMode),T.setContextTransform(c,this.roundPixels);for(var me=0;me<3;me++)for(var xe=0;xe<3;xe++){var Be=2*xe+8*me,qe=Math.max(1,ot[xe+1]-ot[xe]),Ye=Math.max(1,ot[me+5]-ot[me+4]),Je=Math.max(1,K[Be+10]-K[Be]),je=Math.max(1,K[Be+11]-K[Be+1]);d.drawImage(k,ot[xe],ot[me+4],qe,Ye,K[Be],K[Be+1],Je,je)}}};var ul=!1;F.a.prototype._cachedTint=16777215,F.a.prototype._tintedCanvas=null,F.a.prototype._cachedTexture=null,F.a.prototype._renderCanvas=function(T){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(T,this):ul||(ul=!0,globalThis.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},F.a.prototype._canvasPadding=null,Object.defineProperty(F.a.prototype,"canvasPadding",{get:function(){return this._canvasPadding!==null?this._canvasPadding:S.b.MESH_CANVAS_PADDING},set:function(T){this._canvasPadding=T}}),z.b.prototype._renderCanvas=function(T){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)},z.c.prototype._renderCanvas=function(T){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)}}).call(this,v(17))},function(b,E,v){var O=v(143),S=v(144);function I(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}E.parse=P,E.resolve=function(j,$){return P(j,!1,!0).resolve($)},E.resolveObject=function(j,$){return j?P(j,!1,!0).resolveObject($):$},E.format=function(j){return S.isString(j)&&(j=P(j)),j instanceof I?j.format():I.prototype.format.call(j)},E.Url=I;var D=/^([a-z0-9.+-]+:)/i,F=/:[0-9]*$/,z=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,J=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),X=["'"].concat(J),et=["%","/","?",";","#"].concat(X),ut=["/","?","#"],Rt=/^[+a-z0-9A-Z_-]{0,63}$/,St=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,L={javascript:!0,"javascript:":!0},R={javascript:!0,"javascript:":!0},U={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},W=v(145);function P(j,$,H){if(j&&S.isObject(j)&&j instanceof I)return j;var Nt=new I;return Nt.parse(j,$,H),Nt}I.prototype.parse=function(j,$,H){if(!S.isString(j))throw new TypeError("Parameter 'url' must be a string, not "+typeof j);var Nt=j.indexOf("?"),Vt=Nt!==-1&&Nt<j.indexOf("#")?"?":"#",st=j.split(Vt);st[0]=st[0].replace(/\\/g,"/");var V=j=st.join(Vt);if(V=V.trim(),!H&&j.split("#").length===1){var B=z.exec(V);if(B)return this.path=V,this.href=V,this.pathname=B[1],B[2]?(this.search=B[2],this.query=$?W.parse(this.search.substr(1)):this.search.substr(1)):$&&(this.search="",this.query={}),this}var ft=D.exec(V);if(ft){var tt=(ft=ft[0]).toLowerCase();this.protocol=tt,V=V.substr(ft.length)}if(H||ft||V.match(/^\/\/[^@\/]+@[^@\/]+/)){var vt=V.substr(0,2)==="//";!vt||ft&&R[ft]||(V=V.substr(2),this.slashes=!0)}if(!R[ft]&&(vt||ft&&!U[ft])){for(var Dt,Z,pt=-1,rt=0;rt<ut.length;rt++)(_t=V.indexOf(ut[rt]))!==-1&&(pt===-1||_t<pt)&&(pt=_t);for((Z=pt===-1?V.lastIndexOf("@"):V.lastIndexOf("@",pt))!==-1&&(Dt=V.slice(0,Z),V=V.slice(Z+1),this.auth=decodeURIComponent(Dt)),pt=-1,rt=0;rt<et.length;rt++){var _t;(_t=V.indexOf(et[rt]))!==-1&&(pt===-1||_t<pt)&&(pt=_t)}pt===-1&&(pt=V.length),this.host=V.slice(0,pt),V=V.slice(pt),this.parseHost(),this.hostname=this.hostname||"";var Et=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Et)for(var Gt=this.hostname.split(/\./),Xt=(rt=0,Gt.length);rt<Xt;rt++){var Jt=Gt[rt];if(Jt&&!Jt.match(Rt)){for(var at="",_e=0,ke=Jt.length;_e<ke;_e++)Jt.charCodeAt(_e)>127?at+="x":at+=Jt[_e];if(!at.match(Rt)){var Oe=Gt.slice(0,rt),Ae=Gt.slice(rt+1),ze=Jt.match(St);ze&&(Oe.push(ze[1]),Ae.unshift(ze[2])),Ae.length&&(V="/"+Ae.join(".")+V),this.hostname=Oe.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Et||(this.hostname=O.toASCII(this.hostname));var $e=this.port?":"+this.port:"",cn=this.hostname||"";this.host=cn+$e,this.href+=this.host,Et&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),V[0]!=="/"&&(V="/"+V))}if(!L[tt])for(rt=0,Xt=X.length;rt<Xt;rt++){var Ue=X[rt];if(V.indexOf(Ue)!==-1){var Ge=encodeURIComponent(Ue);Ge===Ue&&(Ge=escape(Ue)),V=V.split(Ue).join(Ge)}}var Rn=V.indexOf("#");Rn!==-1&&(this.hash=V.substr(Rn),V=V.slice(0,Rn));var re=V.indexOf("?");if(re!==-1?(this.search=V.substr(re),this.query=V.substr(re+1),$&&(this.query=W.parse(this.query)),V=V.slice(0,re)):$&&(this.search="",this.query={}),V&&(this.pathname=V),U[tt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){$e=this.pathname||"";var pe=this.search||"";this.path=$e+pe}return this.href=this.format(),this},I.prototype.format=function(){var j=this.auth||"";j&&(j=(j=encodeURIComponent(j)).replace(/%3A/i,":"),j+="@");var $=this.protocol||"",H=this.pathname||"",Nt=this.hash||"",Vt=!1,st="";this.host?Vt=j+this.host:this.hostname&&(Vt=j+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(Vt+=":"+this.port)),this.query&&S.isObject(this.query)&&Object.keys(this.query).length&&(st=W.stringify(this.query));var V=this.search||st&&"?"+st||"";return $&&$.substr(-1)!==":"&&($+=":"),this.slashes||(!$||U[$])&&Vt!==!1?(Vt="//"+(Vt||""),H&&H.charAt(0)!=="/"&&(H="/"+H)):Vt||(Vt=""),Nt&&Nt.charAt(0)!=="#"&&(Nt="#"+Nt),V&&V.charAt(0)!=="?"&&(V="?"+V),$+Vt+(H=H.replace(/[?#]/g,function(B){return encodeURIComponent(B)}))+(V=V.replace("#","%23"))+Nt},I.prototype.resolve=function(j){return this.resolveObject(P(j,!1,!0)).format()},I.prototype.resolveObject=function(j){if(S.isString(j)){var $=new I;$.parse(j,!1,!0),j=$}for(var H=new I,Nt=Object.keys(this),Vt=0;Vt<Nt.length;Vt++){var st=Nt[Vt];H[st]=this[st]}if(H.hash=j.hash,j.href==="")return H.href=H.format(),H;if(j.slashes&&!j.protocol){for(var V=Object.keys(j),B=0;B<V.length;B++){var ft=V[B];ft!=="protocol"&&(H[ft]=j[ft])}return U[H.protocol]&&H.hostname&&!H.pathname&&(H.path=H.pathname="/"),H.href=H.format(),H}if(j.protocol&&j.protocol!==H.protocol){if(!U[j.protocol]){for(var tt=Object.keys(j),vt=0;vt<tt.length;vt++){var Dt=tt[vt];H[Dt]=j[Dt]}return H.href=H.format(),H}if(H.protocol=j.protocol,j.host||R[j.protocol])H.pathname=j.pathname;else{for(var Z=(j.pathname||"").split("/");Z.length&&!(j.host=Z.shift()););j.host||(j.host=""),j.hostname||(j.hostname=""),Z[0]!==""&&Z.unshift(""),Z.length<2&&Z.unshift(""),H.pathname=Z.join("/")}if(H.search=j.search,H.query=j.query,H.host=j.host||"",H.auth=j.auth,H.hostname=j.hostname||j.host,H.port=j.port,H.pathname||H.search){var pt=H.pathname||"",rt=H.search||"";H.path=pt+rt}return H.slashes=H.slashes||j.slashes,H.href=H.format(),H}var _t=H.pathname&&H.pathname.charAt(0)==="/",Et=j.host||j.pathname&&j.pathname.charAt(0)==="/",Gt=Et||_t||H.host&&j.pathname,Xt=Gt,Jt=H.pathname&&H.pathname.split("/")||[],at=(Z=j.pathname&&j.pathname.split("/")||[],H.protocol&&!U[H.protocol]);if(at&&(H.hostname="",H.port=null,H.host&&(Jt[0]===""?Jt[0]=H.host:Jt.unshift(H.host)),H.host="",j.protocol&&(j.hostname=null,j.port=null,j.host&&(Z[0]===""?Z[0]=j.host:Z.unshift(j.host)),j.host=null),Gt=Gt&&(Z[0]===""||Jt[0]==="")),Et)H.host=j.host||j.host===""?j.host:H.host,H.hostname=j.hostname||j.hostname===""?j.hostname:H.hostname,H.search=j.search,H.query=j.query,Jt=Z;else if(Z.length)Jt||(Jt=[]),Jt.pop(),Jt=Jt.concat(Z),H.search=j.search,H.query=j.query;else if(!S.isNullOrUndefined(j.search))return at&&(H.hostname=H.host=Jt.shift(),(ze=!!(H.host&&H.host.indexOf("@")>0)&&H.host.split("@"))&&(H.auth=ze.shift(),H.host=H.hostname=ze.shift())),H.search=j.search,H.query=j.query,S.isNull(H.pathname)&&S.isNull(H.search)||(H.path=(H.pathname?H.pathname:"")+(H.search?H.search:"")),H.href=H.format(),H;if(!Jt.length)return H.pathname=null,H.search?H.path="/"+H.search:H.path=null,H.href=H.format(),H;for(var _e=Jt.slice(-1)[0],ke=(H.host||j.host||Jt.length>1)&&(_e==="."||_e==="..")||_e==="",Oe=0,Ae=Jt.length;Ae>=0;Ae--)(_e=Jt[Ae])==="."?Jt.splice(Ae,1):_e===".."?(Jt.splice(Ae,1),Oe++):Oe&&(Jt.splice(Ae,1),Oe--);if(!Gt&&!Xt)for(;Oe--;Oe)Jt.unshift("..");!Gt||Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/"||Jt.unshift(""),ke&&Jt.join("/").substr(-1)!=="/"&&Jt.push("");var ze,$e=Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/";return at&&(H.hostname=H.host=$e?"":Jt.length?Jt.shift():"",(ze=!!(H.host&&H.host.indexOf("@")>0)&&H.host.split("@"))&&(H.auth=ze.shift(),H.host=H.hostname=ze.shift())),(Gt=Gt||H.host&&Jt.length)&&!$e&&Jt.unshift(""),Jt.length?H.pathname=Jt.join("/"):(H.pathname=null,H.path=null),S.isNull(H.pathname)&&S.isNull(H.search)||(H.path=(H.pathname?H.pathname:"")+(H.search?H.search:"")),H.auth=j.auth||H.auth,H.slashes=H.slashes||j.slashes,H.href=H.format(),H},I.prototype.parseHost=function(){var j=this.host,$=F.exec(j);$&&(($=$[0])!==":"&&(this.port=$.substr(1)),j=j.substr(0,j.length-$.length)),j&&(this.hostname=j)}},function(b,E){b.exports=function(v,O){return v===O||v!=v&&O!=O}},function(b,E,v){var O=v(22)(v(14),"Map");b.exports=O},function(b,E,v){var O=v(187),S=v(62),I=Object.prototype.propertyIsEnumerable,D=Object.getOwnPropertySymbols,F=D?function(z){return z==null?[]:(z=Object(z),O(D(z),function(J){return I.call(z,J)}))}:S;b.exports=F},function(b,E,v){var O=v(63),S=v(194),I=v(67);b.exports=function(D){return I(D)?O(D):S(D)}},function(b,E,v){(function(O){var S=v(14),I=v(191),D=E&&!E.nodeType&&E,F=D&&typeof O=="object"&&O&&!O.nodeType&&O,z=F&&F.exports===D?S.Buffer:void 0,J=(z?z.isBuffer:void 0)||I;O.exports=J}).call(this,v(26)(b))},function(b,E){b.exports=function(v){return function(O){return v(O)}}},function(b,E,v){(function(O){var S=v(51),I=E&&!E.nodeType&&E,D=I&&typeof O=="object"&&O&&!O.nodeType&&O,F=D&&D.exports===I&&S.process,z=function(){try{var J=D&&D.require&&D.require("util").types;return J||F&&F.binding&&F.binding("util")}catch{}}();O.exports=z}).call(this,v(26)(b))},function(b,E){var v=Object.prototype;b.exports=function(O){var S=O&&O.constructor;return O===(typeof S=="function"&&S.prototype||v)}},function(b,E,v){var O=v(63),S=v(210),I=v(67);b.exports=function(D){return I(D)?O(D,!0):S(D)}},function(b,E,v){var O=v(58);b.exports=function(S){var I=new S.constructor(S.byteLength);return new O(I).set(new O(S)),I}},function(b,E){b.exports=`#define PI 3.14159265
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vUv = uv;
	float pixelHeight = (galleryHeight * 1.2) + 8.0;
	float pixelY = (pixelHeight * 0.5) - position.y;
	vPixelY = pixelY;
	vec4 newPosition = vec4(position, 1.0);
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D galleryTexture;
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vec4 color;
	if ((vPixelY >= 0.0) && (vPixelY <= galleryHeight)) {
		color = texture2D(galleryTexture, vec2(vUv.x, 1.0 - (vPixelY / galleryHeight)));
	}
	else if ((vPixelY > galleryHeight) && (vPixelY < (galleryHeight + 8.0))) {
		color = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		float alpha = 1.0 - ((vPixelY - (galleryHeight + 8.0)) / (galleryHeight * 0.2));
		color = texture2D(galleryTexture, vec2(vUv.x, ((vPixelY - galleryHeight) + 8.0) / galleryHeight));
		color.a = alpha;
		vec4 shadow = vec4(0.0, 0.0, 0.0, 1.0);
		color = blendSrcOver(color, shadow);
	}
	gl_FragColor = color;
}
`},function(b,E,v){var O=v(148);b.exports=function(S,I){I=I||{};var D=new O,F=I.inPlace||!1,z=S.map(function(X){return F?X:{width:X.width,height:X.height,item:X}});z=z.sort(function(X,et){return et.width*et.height-X.width*X.height}),D.fit(z);var J={width:z.reduce(function(X,et){return Math.max(X,et.x+et.width)},0),height:z.reduce(function(X,et){return Math.max(X,et.y+et.height)},0)};return F||(J.items=z),J}},function(b,E,v){var O=v(205);b.exports=function(S){return O(S,5)}},function(b,E,v){(function(O){var S=typeof O=="object"&&O&&O.Object===Object&&O;b.exports=S}).call(this,v(17))},function(b,E,v){var O=Object.prototype.hasOwnProperty,S="~";function I(){}function D(X,et,ut){this.fn=X,this.context=et,this.once=ut||!1}function F(X,et,ut,Rt,St){if(typeof ut!="function")throw new TypeError("The listener must be a function");var L=new D(ut,Rt||X,St),R=S?S+et:et;return X._events[R]?X._events[R].fn?X._events[R]=[X._events[R],L]:X._events[R].push(L):(X._events[R]=L,X._eventsCount++),X}function z(X,et){--X._eventsCount==0?X._events=new I:delete X._events[et]}function J(){this._events=new I,this._eventsCount=0}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(S=!1)),J.prototype.eventNames=function(){var X,et,ut=[];if(this._eventsCount===0)return ut;for(et in X=this._events)O.call(X,et)&&ut.push(S?et.slice(1):et);return Object.getOwnPropertySymbols?ut.concat(Object.getOwnPropertySymbols(X)):ut},J.prototype.listeners=function(X){var et=S?S+X:X,ut=this._events[et];if(!ut)return[];if(ut.fn)return[ut.fn];for(var Rt=0,St=ut.length,L=new Array(St);Rt<St;Rt++)L[Rt]=ut[Rt].fn;return L},J.prototype.listenerCount=function(X){var et=S?S+X:X,ut=this._events[et];return ut?ut.fn?1:ut.length:0},J.prototype.emit=function(X,et,ut,Rt,St,L){var R=S?S+X:X;if(!this._events[R])return!1;var U,W,P=this._events[R],j=arguments.length;if(P.fn){switch(P.once&&this.removeListener(X,P.fn,void 0,!0),j){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,et),!0;case 3:return P.fn.call(P.context,et,ut),!0;case 4:return P.fn.call(P.context,et,ut,Rt),!0;case 5:return P.fn.call(P.context,et,ut,Rt,St),!0;case 6:return P.fn.call(P.context,et,ut,Rt,St,L),!0}for(W=1,U=new Array(j-1);W<j;W++)U[W-1]=arguments[W];P.fn.apply(P.context,U)}else{var $,H=P.length;for(W=0;W<H;W++)switch(P[W].once&&this.removeListener(X,P[W].fn,void 0,!0),j){case 1:P[W].fn.call(P[W].context);break;case 2:P[W].fn.call(P[W].context,et);break;case 3:P[W].fn.call(P[W].context,et,ut);break;case 4:P[W].fn.call(P[W].context,et,ut,Rt);break;default:if(!U)for($=1,U=new Array(j-1);$<j;$++)U[$-1]=arguments[$];P[W].fn.apply(P[W].context,U)}}return!0},J.prototype.on=function(X,et,ut){return F(this,X,et,ut,!1)},J.prototype.once=function(X,et,ut){return F(this,X,et,ut,!0)},J.prototype.removeListener=function(X,et,ut,Rt){var St=S?S+X:X;if(!this._events[St])return this;if(!et)return z(this,St),this;var L=this._events[St];if(L.fn)L.fn!==et||Rt&&!L.once||ut&&L.context!==ut||z(this,St);else{for(var R=0,U=[],W=L.length;R<W;R++)(L[R].fn!==et||Rt&&!L[R].once||ut&&L[R].context!==ut)&&U.push(L[R]);U.length?this._events[St]=U.length===1?U[0]:U:z(this,St)}return this},J.prototype.removeAllListeners=function(X){var et;return X?(et=S?S+X:X,this._events[et]&&z(this,et)):(this._events=new I,this._eventsCount=0),this},J.prototype.off=J.prototype.removeListener,J.prototype.addListener=J.prototype.on,J.prefixed=S,J.EventEmitter=J,b.exports=J},function(b,E,v){function O(tt,vt,Dt){Dt=Dt||2;var Z,pt,rt,_t,Et,Gt,Xt,Jt=vt&&vt.length,at=Jt?vt[0]*Dt:tt.length,_e=S(tt,0,at,Dt,!0),ke=[];if(!_e||_e.next===_e.prev)return ke;if(Jt&&(_e=function(Ae,ze,$e,cn){var Ue,Ge,Rn,re,pe,we=[];for(Ue=0,Ge=ze.length;Ue<Ge;Ue++)Rn=ze[Ue]*cn,re=Ue<Ge-1?ze[Ue+1]*cn:Ae.length,(pe=S(Ae,Rn,re,cn,!1))===pe.next&&(pe.steiner=!0),we.push(L(pe));for(we.sort(et),Ue=0;Ue<we.length;Ue++)$e=ut(we[Ue],$e);return $e}(tt,vt,_e,Dt)),tt.length>80*Dt){Z=rt=tt[0],pt=_t=tt[1];for(var Oe=Dt;Oe<at;Oe+=Dt)(Et=tt[Oe])<Z&&(Z=Et),(Gt=tt[Oe+1])<pt&&(pt=Gt),Et>rt&&(rt=Et),Gt>_t&&(_t=Gt);Xt=(Xt=Math.max(rt-Z,_t-pt))!==0?32767/Xt:0}return D(_e,ke,Dt,Z,pt,Xt,0),ke}function S(tt,vt,Dt,Z,pt){var rt,_t;if(pt===ft(tt,vt,Dt,Z)>0)for(rt=vt;rt<Dt;rt+=Z)_t=st(rt,tt[rt],tt[rt+1],_t);else for(rt=Dt-Z;rt>=vt;rt-=Z)_t=st(rt,tt[rt],tt[rt+1],_t);return _t&&P(_t,_t.next)&&(V(_t),_t=_t.next),_t}function I(tt,vt){if(!tt)return tt;vt||(vt=tt);var Dt,Z=tt;do if(Dt=!1,Z.steiner||!P(Z,Z.next)&&W(Z.prev,Z,Z.next)!==0)Z=Z.next;else{if(V(Z),(Z=vt=Z.prev)===Z.next)break;Dt=!0}while(Dt||Z!==vt);return vt}function D(tt,vt,Dt,Z,pt,rt,_t){if(tt){!_t&&rt&&function(Jt,at,_e,ke){var Oe=Jt;do Oe.z===0&&(Oe.z=St(Oe.x,Oe.y,at,_e,ke)),Oe.prevZ=Oe.prev,Oe.nextZ=Oe.next,Oe=Oe.next;while(Oe!==Jt);Oe.prevZ.nextZ=null,Oe.prevZ=null,function(Ae){var ze,$e,cn,Ue,Ge,Rn,re,pe,we=1;do{for($e=Ae,Ae=null,Ge=null,Rn=0;$e;){for(Rn++,cn=$e,re=0,ze=0;ze<we&&(re++,cn=cn.nextZ);ze++);for(pe=we;re>0||pe>0&&cn;)re!==0&&(pe===0||!cn||$e.z<=cn.z)?(Ue=$e,$e=$e.nextZ,re--):(Ue=cn,cn=cn.nextZ,pe--),Ge?Ge.nextZ=Ue:Ae=Ue,Ue.prevZ=Ge,Ge=Ue;$e=cn}Ge.nextZ=null,we*=2}while(Rn>1)}(Oe)}(tt,Z,pt,rt);for(var Et,Gt,Xt=tt;tt.prev!==tt.next;)if(Et=tt.prev,Gt=tt.next,rt?z(tt,Z,pt,rt):F(tt))vt.push(Et.i/Dt|0),vt.push(tt.i/Dt|0),vt.push(Gt.i/Dt|0),V(tt),tt=Gt.next,Xt=Gt.next;else if((tt=Gt)===Xt){_t?_t===1?D(tt=J(I(tt),vt,Dt),vt,Dt,Z,pt,rt,2):_t===2&&X(tt,vt,Dt,Z,pt,rt):D(I(tt),vt,Dt,Z,pt,rt,1);break}}}function F(tt){var vt=tt.prev,Dt=tt,Z=tt.next;if(W(vt,Dt,Z)>=0)return!1;for(var pt=vt.x,rt=Dt.x,_t=Z.x,Et=vt.y,Gt=Dt.y,Xt=Z.y,Jt=pt<rt?pt<_t?pt:_t:rt<_t?rt:_t,at=Et<Gt?Et<Xt?Et:Xt:Gt<Xt?Gt:Xt,_e=pt>rt?pt>_t?pt:_t:rt>_t?rt:_t,ke=Et>Gt?Et>Xt?Et:Xt:Gt>Xt?Gt:Xt,Oe=Z.next;Oe!==vt;){if(Oe.x>=Jt&&Oe.x<=_e&&Oe.y>=at&&Oe.y<=ke&&R(pt,Et,rt,Gt,_t,Xt,Oe.x,Oe.y)&&W(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.next}return!0}function z(tt,vt,Dt,Z){var pt=tt.prev,rt=tt,_t=tt.next;if(W(pt,rt,_t)>=0)return!1;for(var Et=pt.x,Gt=rt.x,Xt=_t.x,Jt=pt.y,at=rt.y,_e=_t.y,ke=Et<Gt?Et<Xt?Et:Xt:Gt<Xt?Gt:Xt,Oe=Jt<at?Jt<_e?Jt:_e:at<_e?at:_e,Ae=Et>Gt?Et>Xt?Et:Xt:Gt>Xt?Gt:Xt,ze=Jt>at?Jt>_e?Jt:_e:at>_e?at:_e,$e=St(ke,Oe,vt,Dt,Z),cn=St(Ae,ze,vt,Dt,Z),Ue=tt.prevZ,Ge=tt.nextZ;Ue&&Ue.z>=$e&&Ge&&Ge.z<=cn;){if(Ue.x>=ke&&Ue.x<=Ae&&Ue.y>=Oe&&Ue.y<=ze&&Ue!==pt&&Ue!==_t&&R(Et,Jt,Gt,at,Xt,_e,Ue.x,Ue.y)&&W(Ue.prev,Ue,Ue.next)>=0||(Ue=Ue.prevZ,Ge.x>=ke&&Ge.x<=Ae&&Ge.y>=Oe&&Ge.y<=ze&&Ge!==pt&&Ge!==_t&&R(Et,Jt,Gt,at,Xt,_e,Ge.x,Ge.y)&&W(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;Ue&&Ue.z>=$e;){if(Ue.x>=ke&&Ue.x<=Ae&&Ue.y>=Oe&&Ue.y<=ze&&Ue!==pt&&Ue!==_t&&R(Et,Jt,Gt,at,Xt,_e,Ue.x,Ue.y)&&W(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.prevZ}for(;Ge&&Ge.z<=cn;){if(Ge.x>=ke&&Ge.x<=Ae&&Ge.y>=Oe&&Ge.y<=ze&&Ge!==pt&&Ge!==_t&&R(Et,Jt,Gt,at,Xt,_e,Ge.x,Ge.y)&&W(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function J(tt,vt,Dt){var Z=tt;do{var pt=Z.prev,rt=Z.next.next;!P(pt,rt)&&j(pt,Z,Z.next,rt)&&Nt(pt,rt)&&Nt(rt,pt)&&(vt.push(pt.i/Dt|0),vt.push(Z.i/Dt|0),vt.push(rt.i/Dt|0),V(Z),V(Z.next),Z=tt=rt),Z=Z.next}while(Z!==tt);return I(Z)}function X(tt,vt,Dt,Z,pt,rt){var _t=tt;do{for(var Et=_t.next.next;Et!==_t.prev;){if(_t.i!==Et.i&&U(_t,Et)){var Gt=Vt(_t,Et);return _t=I(_t,_t.next),Gt=I(Gt,Gt.next),D(_t,vt,Dt,Z,pt,rt,0),void D(Gt,vt,Dt,Z,pt,rt,0)}Et=Et.next}_t=_t.next}while(_t!==tt)}function et(tt,vt){return tt.x-vt.x}function ut(tt,vt){var Dt=function(pt,rt){var _t,Et=rt,Gt=pt.x,Xt=pt.y,Jt=-1/0;do{if(Xt<=Et.y&&Xt>=Et.next.y&&Et.next.y!==Et.y){var at=Et.x+(Xt-Et.y)*(Et.next.x-Et.x)/(Et.next.y-Et.y);if(at<=Gt&&at>Jt&&(Jt=at,_t=Et.x<Et.next.x?Et:Et.next,at===Gt))return _t}Et=Et.next}while(Et!==rt);if(!_t)return null;var _e,ke=_t,Oe=_t.x,Ae=_t.y,ze=1/0;Et=_t;do Gt>=Et.x&&Et.x>=Oe&&Gt!==Et.x&&R(Xt<Ae?Gt:Jt,Xt,Oe,Ae,Xt<Ae?Jt:Gt,Xt,Et.x,Et.y)&&(_e=Math.abs(Xt-Et.y)/(Gt-Et.x),Nt(Et,pt)&&(_e<ze||_e===ze&&(Et.x>_t.x||Et.x===_t.x&&Rt(_t,Et)))&&(_t=Et,ze=_e)),Et=Et.next;while(Et!==ke);return _t}(tt,vt);if(!Dt)return vt;var Z=Vt(Dt,tt);return I(Z,Z.next),I(Dt,Dt.next)}function Rt(tt,vt){return W(tt.prev,tt,vt.prev)<0&&W(vt.next,tt,tt.next)<0}function St(tt,vt,Dt,Z,pt){return(tt=1431655765&((tt=858993459&((tt=252645135&((tt=16711935&((tt=(tt-Dt)*pt|0)|tt<<8))|tt<<4))|tt<<2))|tt<<1))|(vt=1431655765&((vt=858993459&((vt=252645135&((vt=16711935&((vt=(vt-Z)*pt|0)|vt<<8))|vt<<4))|vt<<2))|vt<<1))<<1}function L(tt){var vt=tt,Dt=tt;do(vt.x<Dt.x||vt.x===Dt.x&&vt.y<Dt.y)&&(Dt=vt),vt=vt.next;while(vt!==tt);return Dt}function R(tt,vt,Dt,Z,pt,rt,_t,Et){return(pt-_t)*(vt-Et)>=(tt-_t)*(rt-Et)&&(tt-_t)*(Z-Et)>=(Dt-_t)*(vt-Et)&&(Dt-_t)*(rt-Et)>=(pt-_t)*(Z-Et)}function U(tt,vt){return tt.next.i!==vt.i&&tt.prev.i!==vt.i&&!function(Dt,Z){var pt=Dt;do{if(pt.i!==Dt.i&&pt.next.i!==Dt.i&&pt.i!==Z.i&&pt.next.i!==Z.i&&j(pt,pt.next,Dt,Z))return!0;pt=pt.next}while(pt!==Dt);return!1}(tt,vt)&&(Nt(tt,vt)&&Nt(vt,tt)&&function(Dt,Z){var pt=Dt,rt=!1,_t=(Dt.x+Z.x)/2,Et=(Dt.y+Z.y)/2;do pt.y>Et!=pt.next.y>Et&&pt.next.y!==pt.y&&_t<(pt.next.x-pt.x)*(Et-pt.y)/(pt.next.y-pt.y)+pt.x&&(rt=!rt),pt=pt.next;while(pt!==Dt);return rt}(tt,vt)&&(W(tt.prev,tt,vt.prev)||W(tt,vt.prev,vt))||P(tt,vt)&&W(tt.prev,tt,tt.next)>0&&W(vt.prev,vt,vt.next)>0)}function W(tt,vt,Dt){return(vt.y-tt.y)*(Dt.x-vt.x)-(vt.x-tt.x)*(Dt.y-vt.y)}function P(tt,vt){return tt.x===vt.x&&tt.y===vt.y}function j(tt,vt,Dt,Z){var pt=H(W(tt,vt,Dt)),rt=H(W(tt,vt,Z)),_t=H(W(Dt,Z,tt)),Et=H(W(Dt,Z,vt));return pt!==rt&&_t!==Et||!(pt!==0||!$(tt,Dt,vt))||!(rt!==0||!$(tt,Z,vt))||!(_t!==0||!$(Dt,tt,Z))||!(Et!==0||!$(Dt,vt,Z))}function $(tt,vt,Dt){return vt.x<=Math.max(tt.x,Dt.x)&&vt.x>=Math.min(tt.x,Dt.x)&&vt.y<=Math.max(tt.y,Dt.y)&&vt.y>=Math.min(tt.y,Dt.y)}function H(tt){return tt>0?1:tt<0?-1:0}function Nt(tt,vt){return W(tt.prev,tt,tt.next)<0?W(tt,vt,tt.next)>=0&&W(tt,tt.prev,vt)>=0:W(tt,vt,tt.prev)<0||W(tt,tt.next,vt)<0}function Vt(tt,vt){var Dt=new B(tt.i,tt.x,tt.y),Z=new B(vt.i,vt.x,vt.y),pt=tt.next,rt=vt.prev;return tt.next=vt,vt.prev=tt,Dt.next=pt,pt.prev=Dt,Z.next=Dt,Dt.prev=Z,rt.next=Z,Z.prev=rt,Z}function st(tt,vt,Dt,Z){var pt=new B(tt,vt,Dt);return Z?(pt.next=Z.next,pt.prev=Z,Z.next.prev=pt,Z.next=pt):(pt.prev=pt,pt.next=pt),pt}function V(tt){tt.next.prev=tt.prev,tt.prev.next=tt.next,tt.prevZ&&(tt.prevZ.nextZ=tt.nextZ),tt.nextZ&&(tt.nextZ.prevZ=tt.prevZ)}function B(tt,vt,Dt){this.i=tt,this.x=vt,this.y=Dt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ft(tt,vt,Dt,Z){for(var pt=0,rt=vt,_t=Dt-Z;rt<Dt;rt+=Z)pt+=(tt[_t]-tt[rt])*(tt[rt+1]+tt[_t+1]),_t=rt;return pt}b.exports=O,b.exports.default=O,O.deviation=function(tt,vt,Dt,Z){var pt=vt&&vt.length,rt=pt?vt[0]*Dt:tt.length,_t=Math.abs(ft(tt,0,rt,Dt));if(pt)for(var Et=0,Gt=vt.length;Et<Gt;Et++){var Xt=vt[Et]*Dt,Jt=Et<Gt-1?vt[Et+1]*Dt:tt.length;_t-=Math.abs(ft(tt,Xt,Jt,Dt))}var at=0;for(Et=0;Et<Z.length;Et+=3){var _e=Z[Et]*Dt,ke=Z[Et+1]*Dt,Oe=Z[Et+2]*Dt;at+=Math.abs((tt[_e]-tt[Oe])*(tt[ke+1]-tt[_e+1])-(tt[_e]-tt[ke])*(tt[Oe+1]-tt[_e+1]))}return _t===0&&at===0?0:Math.abs((at-_t)/_t)},O.flatten=function(tt){for(var vt=tt[0][0].length,Dt={vertices:[],holes:[],dimensions:vt},Z=0,pt=0;pt<tt.length;pt++){for(var rt=0;rt<tt[pt].length;rt++)for(var _t=0;_t<vt;_t++)Dt.vertices.push(tt[pt][rt][_t]);pt>0&&(Z+=tt[pt-1].length,Dt.holes.push(Z))}return Dt}},function(b,E,v){var O=v(27),S=v(157),I=v(158),D=v(159),F=v(160),z=v(161);function J(X){var et=this.__data__=new O(X);this.size=et.size}J.prototype.clear=S,J.prototype.delete=I,J.prototype.get=D,J.prototype.has=F,J.prototype.set=z,b.exports=J},function(b,E){var v=Function.prototype.toString;b.exports=function(O){if(O!=null){try{return v.call(O)}catch{}try{return O+""}catch{}}return""}},function(b,E,v){var O=v(166),S=v(173),I=v(175),D=v(176),F=v(177);function z(J){var X=-1,et=J==null?0:J.length;for(this.clear();++X<et;){var ut=J[X];this.set(ut[0],ut[1])}}z.prototype.clear=O,z.prototype.delete=S,z.prototype.get=I,z.prototype.has=D,z.prototype.set=F,b.exports=z},function(b,E,v){var O=v(178),S=v(181),I=v(182);b.exports=function(D,F,z,J,X,et){var ut=1&z,Rt=D.length,St=F.length;if(Rt!=St&&!(ut&&St>Rt))return!1;var L=et.get(D),R=et.get(F);if(L&&R)return L==F&&R==D;var U=-1,W=!0,P=2&z?new O:void 0;for(et.set(D,F),et.set(F,D);++U<Rt;){var j=D[U],$=F[U];if(J)var H=ut?J($,j,U,F,D,et):J(j,$,U,D,F,et);if(H!==void 0){if(H)continue;W=!1;break}if(P){if(!S(F,function(Nt,Vt){if(!I(P,Vt)&&(j===Nt||X(j,Nt,z,J,et)))return P.push(Vt)})){W=!1;break}}else if(j!==$&&!X(j,$,z,J,et)){W=!1;break}}return et.delete(D),et.delete(F),W}},function(b,E,v){var O=v(14).Uint8Array;b.exports=O},function(b,E,v){var O=v(60),S=v(39),I=v(40);b.exports=function(D){return O(D,I,S)}},function(b,E,v){var O=v(61),S=v(31);b.exports=function(I,D,F){var z=D(I);return S(I)?z:O(z,F(I))}},function(b,E){b.exports=function(v,O){for(var S=-1,I=O.length,D=v.length;++S<I;)v[D+S]=O[S];return v}},function(b,E){b.exports=function(){return[]}},function(b,E,v){var O=v(188),S=v(189),I=v(31),D=v(41),F=v(192),z=v(64),J=Object.prototype.hasOwnProperty;b.exports=function(X,et){var ut=I(X),Rt=!ut&&S(X),St=!ut&&!Rt&&D(X),L=!ut&&!Rt&&!St&&z(X),R=ut||Rt||St||L,U=R?O(X.length,String):[],W=U.length;for(var P in X)!et&&!J.call(X,P)||R&&(P=="length"||St&&(P=="offset"||P=="parent")||L&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||F(P,W))||U.push(P);return U}},function(b,E,v){var O=v(193),S=v(42),I=v(43),D=I&&I.isTypedArray,F=D?S(D):O;b.exports=F},function(b,E){b.exports=function(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=9007199254740991}},function(b,E){b.exports=function(v,O){return function(S){return v(O(S))}}},function(b,E,v){var O=v(34),S=v(65);b.exports=function(I){return I!=null&&S(I.length)&&!O(I)}},function(b,E,v){var O=v(69),S=v(37),I=Object.prototype.hasOwnProperty;b.exports=function(D,F,z){var J=D[F];I.call(D,F)&&S(J,z)&&(z!==void 0||F in D)||O(D,F,z)}},function(b,E,v){var O=v(207);b.exports=function(S,I,D){I=="__proto__"&&O?O(S,I,{configurable:!0,enumerable:!0,value:D,writable:!0}):S[I]=D}},function(b,E,v){var O=v(61),S=v(71),I=v(39),D=v(62),F=Object.getOwnPropertySymbols?function(z){for(var J=[];z;)O(J,I(z)),z=S(z);return J}:D;b.exports=F},function(b,E,v){var O=v(66)(Object.getPrototypeOf,Object);b.exports=O},function(b,E){b.exports=`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform float lines[26];
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float direction;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float middleAlpha = 0.0;
	float endAlpha = 0.0;
	float headLength = 0.0;
	if (timePercent < 0.5) {
		middleAlpha = 1.0;
		endAlpha = 1.0 - (timePercent / 0.5);
	}
	else {
		middleAlpha = 1.0 - ((timePercent - 0.5) / 0.5);
		endAlpha = 0.0;
	}
	for (int i = 0; i < 26; i++) {
		float halfDis = lines[i] / 2.0;
		float middle = headLength + halfDis;
		headLength += lines[i];
		if ((direction > 0.9) && (direction < 1.1)) {
			if (abs(vUv.y - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.y - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
		else {
			if (abs(vUv.x - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.x - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
	}
	gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	vec2 uv = vec2(vUv.x, vUv.y);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
vec2 transformTo(vec2 uv, vec2 origin) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(origin.x, (origin.y * height) / width);
}
vec2 offset(float progress[4], float band, float amp, float radius, vec2 centerPosition) {
	vec2 tc = vUv.xy;
	vec2 uv = vec2(0.0, 0.0);
	vec2 p;
	float len;
	vec2 uv_offset;
	float wave_width = band * radius;
	for (int i = 0; i < 4; i += 1) {
		if (progress[i] == -1.0) {
			continue;
		}
		p = tc - centerPosition;
		p.x = (p.x * width) / height;
		len = length(p);
		float current_progress = progress[i];
		float current_radius = radius * current_progress;
		float damp_factor = 1.0;
		if (current_progress > .5) {
			damp_factor = (1.0 - current_progress) * 2.0;
		}
		float cut_factor = clamp((wave_width * damp_factor) - abs(current_radius - len), 0.0, 1.0);
		float waves_factor = (4.0 * len) / radius;
		uv_offset = (((p / len) * cos((waves_factor - (current_progress * 10.0)) * 3.14)) * amp) * cut_factor;
		uv += uv_offset;
	}
	return uv;
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	float progress[4];
	vec2 uv = vUv.xy;
	vec2 uvOffset = vec2(0.0, 0.0);
	vec2 startPosition = vec2(0.5, 0.5);
	float redius = 2.0;
	if (option == 1) {
		startPosition = vec2(0.0, 0.0);
	}
	else if (option == 2) {
		startPosition = vec2(1.0, 0.0);
	}
	else if (option == 3) {
		startPosition = vec2(1.0, 1.0);
	}
	else if (option == 4) {
		startPosition = vec2(0.0, 1.0);
	}
	maxR = length(transformTo(vec2(1.0, 1.0), vec2(0.0, 0.0)));
	if (option == 0) {
		maxR = maxR / 2.0;
		redius = redius / 2.0;
	}
	dist = length(transformTo(uv, startPosition));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	for (int i = 0; i < 4; i++) {
		progress[i] = timePercent + (0.1 * float(i));
		if (progress[i] < 0.0) {
			progress[i] = 0.0;
		}
	}
	uvOffset = offset(progress, 0.2, 0.3, redius, startPosition);
	vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
	vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = option > 1 ? true : false;
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 0.5;
		rectEnd = isRevert ? 0.5 : 1.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 0.5) + 0.5 : 1.0 - (((timePercent - 0.33) / 0.33) * 0.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 0.5 : 0.0;
		rectEnd = isRevert ? 1.0 : 0.5;
	}
	float changAxis = (option % 2) == 0 ? vUv.x : vUv.y;
	if (changAxis >= rectEnd) {
		srcColor.a = isRevert ? 1.0 : 0.0;
	}
	else if (changAxis <= rectStart) {
		srcColor.a = isRevert ? 0.0 : 1.0;
	}
	else {
		srcColor.a = alphaStart + (((changAxis - rectStart) / 0.5) * (alphaEnd - alphaStart));
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 dissolveColor = texture2D(dissolveTexture, vUv);
	if (dissolveColor.r == 0.0) {
		result = srcColor;
	}
	else {
		result = distColor;
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	if (timePercent < 0.5) {
		float stagePercent = timePercent / 0.5;
		result = srcColor + (stagePercent * (1.0 - srcColor));
	}
	else {
		float stagePercent = (timePercent - 0.5) / 0.5;
		result = 1.0 - (stagePercent * (1.0 - distColor));
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (option == 1) {
		if (timePercent < 0.5) {
			srcColor.rgb *= (1.0 - (timePercent * 2.0));
			gl_FragColor = srcColor;
		}
		else {
			distColor.rgb *= ((timePercent - 0.5) * 2.0);
			gl_FragColor = distColor;
		}
	}
	else {
		srcColor.a = 1.0 - timePercent;
		gl_FragColor = blendSrcOver(srcColor, distColor);
	}
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float changeAxis = (option % 2) == 1 ? vUv.x : vUv.y;
	bool changeAxisX = (option % 2) == 1;
	bool isRevert = option > 1;
	float line;
	if (isRevert) {
		line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);
	}
	else {
		line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);
	}
	vec2 uv = vUv.xy;
	if (changeAxis > line) {
		if (changeAxisX) {
			uv.x -= line;
		}
		else {
			uv.y -= line;
		}
	}
	else {
		if (changeAxisX) {
			uv.x += (1.0 - line);
		}
		else {
			uv.y += (1.0 - line);
		}
	}
	if (isRevert) {
		result = changeAxis > line ? texture2D(textureNext, uv) : texture2D(texturePrev, uv);
	}
	else {
		result = changeAxis > line ? texture2D(texturePrev, uv) : texture2D(textureNext, uv);
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool orient;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 rectLeft = direction ? vec2(0.25, 0.0) : vec2(0.25, 0.5);
	vec2 rectRight = direction ? vec2(1, 0.75) : vec2(0.5, 0.75);
	vec2 alphaLeft = vec2(1.0, 1.0);
	vec2 alphaRight = vec2(1.0, 1.0);
	if (timePercent <= 0.333) {
		alphaLeft.y = 1.0 - (timePercent / 0.333);
		alphaRight.x = 1.0 - (timePercent / 0.333);
	}
	else if ((timePercent <= 0.666) && (timePercent > 0.333)) {
		rectLeft.x = direction ? (((timePercent - 0.333) / 0.333) * 0.25) + rectLeft.x : rectLeft.x - (((timePercent - 0.333) / 0.333) * 0.25);
		rectLeft.y = direction ? rectLeft.x - 0.25 : rectLeft.x + 0.25;
		rectRight.y = direction ? rectRight.y - (((timePercent - 0.333) / 0.333) * 0.25) : rectRight.y + (((timePercent - 0.333) / 0.333) * 0.25);
		rectRight.x = direction ? rectRight.y + 0.25 : rectRight.y - 0.25;
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
	}
	else {
		rectLeft = direction ? vec2(0.5, 0.25) : vec2(0.0, 0.25);
		rectRight = direction ? vec2(0.75, 0.5) : vec2(0.75, 1.0);
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
		alphaLeft.x = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
		alphaRight.y = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
	}
	float axis = orient ? vUv.x : vUv.y;
	if (direction) {
		if ((axis < rectLeft.y) || (axis > rectRight.x)) {
			srcColor.a = 0.0;
		}
		else if ((axis > rectLeft.x) && (axis < rectRight.y)) {
			srcColor.a = 1.0;
		}
		else {
			if ((axis < rectLeft.x) && (axis > rectLeft.y)) {
				srcColor.a = alphaLeft.y - (((axis - rectLeft.y) / (rectLeft.x - rectLeft.y)) * (alphaLeft.y - alphaLeft.x));
			}
			else {
				srcColor.a = alphaRight.x - (((rectRight.x - axis) / (rectLeft.x - rectLeft.y)) * (alphaRight.x - alphaRight.y));
			}
		}
	}
	else {
		if ((axis < rectLeft.x) || (axis > rectRight.y)) {
			srcColor.a = 1.0;
		}
		else if ((axis > rectLeft.y) && (axis < rectRight.x)) {
			srcColor.a = 0.0;
		}
		else {
			if ((axis >= rectLeft.x) && (axis <= rectLeft.y)) {
				srcColor.a = alphaLeft.x - (((axis - rectLeft.x) / (rectLeft.y - rectLeft.x)) * (alphaLeft.x - alphaLeft.y));
			}
			else {
				srcColor.a = alphaRight.y - (((rectRight.y - axis) / (rectLeft.y - rectLeft.x)) * (alphaRight.y - alphaRight.x));
			}
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool thruBlk;
varying vec2 vUv;
void main() {
	vec4 uv4 = vec4(vUv.xy, 1.0, 1.0);
	float scale;
	float transform;
	if (timePercent < 0.5) {
		scale = 1.0 - ((timePercent / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	else {
		scale = 0.95 + (((timePercent - 0.5) / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	mat4 matrix = mat4(scale, 0.0, 0.0, 0.0, 0.0, scale, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, transform, transform, 0.0, 1.0);
	vec4 uv = matrix * uv4;
	vec4 srcColor = texture2D(texturePrev, uv.xy);
	vec4 distColor = texture2D(textureNext, uv.xy);
	vec4 result = timePercent < 0.5 ? srcColor : distColor;
	vec3 start;
	vec3 end;
	vec3 middleColor = thruBlk ? vec3(0.0, 0.0, 0.0) : vec3(1.0, 1.0, 1.0);
	if ((timePercent < 0.25) || (timePercent > 0.75)) {
		result *= 1.0;
	}
	else if ((timePercent >= 0.25) && (timePercent <= 0.5)) {
		if (timePercent <= 0.375) {
			start = result.rgb;
			end = start + (((timePercent - 0.25) / 0.125) * (middleColor - result.rgb));
		}
		else {
			start = result.rgb + (((timePercent - 0.375) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	else if ((timePercent > 0.5) && (timePercent <= 0.75)) {
		if (timePercent < 0.625) {
			start = middleColor - (((timePercent - 0.5) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		else {
			start = result.rgb;
			end = middleColor - (((timePercent - 0.625) / 0.125) * (middleColor - result.rgb));
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x <= lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionX > 0) && (vUv.x >= lineX)) {
		uv.x -= lineX;
	}
	if ((optionY < 0) && (vUv.y <= lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionY > 0) && (vUv.y >= lineY)) {
		uv.y -= lineY;
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x > lineX)) {
		uv.x -= lineX;
	}
	if ((optionX > 0) && (vUv.x < lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionY < 0) && (vUv.y > lineY)) {
		uv.y -= lineY;
	}
	if ((optionY > 0) && (vUv.y < lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 result;
	float resultAlpha;
	if (timePercent < 0.5) {
		result = srcColor.rgb * rgb2yuv;
		result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
		resultAlpha = srcColor.a;
	}
	else {
		result = distColor.rgb * rgb2yuv;
		result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
		resultAlpha = distColor.a;
	}
	result *= yuv2rgb;
	gl_FragColor = vec4(result.rgb, resultAlpha);
}
`},function(b,E){b.exports=`uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute vec2 segment;
attribute float times;
attribute int option;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	vec4 newPosition = vec4(position, 1.0);
	vec2 segmentOrigin = vec2(((segment.x + 0.5) * segmentWidth) - (width * 0.5), (height * 0.5) - ((1.0 * (segment.y + 0.5)) * segmentHeight));
	if (timePercent > times) {
		float percent = (timePercent - times) / 0.7;
		if (percent > 1.0) {
			percent = 1.0;
		}
		if (percent > 0.5) {
			percent += 1.0;
		}
		mat4 matrix = mat4(cos((-1.0 * percent) * 3.14), 0.0, sin((-1.0 * percent) * 3.14), 0.0, 0.0, 1.0, 0.0, 0.0, -sin((-1.0 * percent) * 3.14), 0.0, cos((-1.0 * percent) * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		if (option == 1) {
			matrix = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(percent * 3.14), -sin(percent * 3.14), 0.0, 0.0, sin(percent * 3.13), cos(percent * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		}
		newPosition.x -= segmentOrigin.x;
		newPosition.y -= segmentOrigin.y;
		newPosition = matrix * newPosition;
		newPosition.x += segmentOrigin.x;
		newPosition.y += segmentOrigin.y;
		if (segment.x < (horizontalSegments / 2.0)) {
			fakePercent = percent - (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
		else {
			fakePercent = percent + (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (fakePercent > 0.5) {
		color = distColor;
	}
	if ((fakePercent < 0.5) && (fakePercent > 0.35)) {
		color.a = 0.5;
	}
	gl_FragColor = color;
}
`},function(b,E){b.exports=`#define PI 3.14159265
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	mat4 matrix;
	float stagePercent;
	vec4 newPosition = vec4(position, 1.0);
	float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
	if (selfTimePercent < 0.0) {
		selfTimePercent = 0.0;
	}
	else if (selfTimePercent > 1.0) {
		selfTimePercent = 1.0;
	}
	if (selfTimePercent < (2.0 / 5.0)) {
		stagePercent = selfTimePercent / (2.0 / 5.0);
		newPosition.x -= (0.5 * width);
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 0.5);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
	}
	else if ((selfTimePercent >= (2.0 / 5.0)) && (selfTimePercent < (3.0 / 5.0))) {
		stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);
		newPosition.x -= (0.5 * width);
		newPosition = rotateY((-1.0 * PI) * 0.5) * newPosition;
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 2.0);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= (width * stagePercent);
	}
	else {
		float offset = (((newPosition.x + (0.5 * width)) / width) * 2.0) / 5.0;
		stagePercent = (selfTimePercent - (1.0 / 5.0)) / ((2.0 / 5.0) + offset);
		if (stagePercent > 1.0) {
			stagePercent = 1.0;
		}
		vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
		vvUvv = rotateY(-1.0 * PI) * vvUvv;
		vUv = vvUvv.xy + 0.5;
		newPosition.x -= (0.5 * width);
		matrix = rotateY((((-1.0 * stagePercent) * PI) * 0.5) - (PI * 2.5));
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= width;
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		vUv = uv;
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (timePercent > 0.5) {
		color = distColor;
	}
	if (timePercent < 0.0001) {
		color = srcColor;
	}
	else if (timePercent > 0.9999) {
		color = distColor;
	}
	gl_FragColor = color;
}
`},function(b,E){b.exports=`#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;
uniform float timePercent;
uniform float segmentWidth;
uniform float segments;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	vType = type;
	vec4 newPosition = vec4(position, 1.0);
	float selfPercent = (timePercent - delay) / 0.7;
	rotatePercent = selfPercent;
	if (selfPercent < 0.0) {
		selfPercent = 0.0;
	}
	else if (selfPercent > 1.0) {
		selfPercent = 1.0;
	}
	float offsetX = ((segments * segmentWidth) * 0.5) - ((index + 0.5) * segmentWidth);
	float offsetZ = segmentWidth * 0.5;
	newPosition.x += offsetX;
	newPosition.z += offsetZ;
	newPosition.x *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition.z *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition = rotateY((PI * 0.5) * selfPercent) * newPosition;
	newPosition.x -= offsetX;
	newPosition.z -= offsetZ;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 srcYuv;
	vec3 distYuv;
	if (rotatePercent < 0.5) {
		distYuv = distColor.rgb * rgb2yuv;
		distYuv.r *= (1.0 - (abs(rotatePercent - 0.5) / 0.5));
		distColor = vec4(distYuv * yuv2rgb, distColor.a);
	}
	else {
		srcYuv = distColor.rgb * rgb2yuv;
		srcYuv.r *= (abs(rotatePercent - 0.5) / 0.5);
		srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
	}
	vec4 color = vType < 0.5 ? srcColor : distColor;
	gl_FragColor = color;
}
`},function(b,E){b.exports=`float easeInFloat(float t, float b, float c, float d) {
	t = t / d;
	return ((c * t) * t) + b;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.141592653
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute float isLeft;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vUv = uv;
	float scaleX;
	float transform;
	float displacement;
	vec4 newPosition = vec4(position, 1.0);
	vec4 glPosition = (projectionMatrix * modelViewMatrix) * newPosition;
	float crestCount = 24.0;
	float width = horizontalSegments * segmentWidth;
	float height = verticalSegments * segmentHeight;
	float heightFactor = (newPosition.y + (height * 0.5)) / height;
	float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
	newPosition.y += (height * 0.5);
	newPosition.y *= scaleY;
	newPosition.y -= (height * 0.5);
	newPosition.y += 10.0;
	if ((timePercent > 0.0) && (timePercent < 0.333)) {
		float delay = (1.0 - heightFactor) * 0.1;
		scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
	}
	else if ((timePercent >= 0.333) && (timePercent < 0.5)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if ((timePercent >= 0.5) && (timePercent < 0.583)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if (timePercent >= 0.583) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop + incr;
	}
	if (timePercent > 0.583) {
		displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
	}
	float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
	float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
	float amp = ampBottom + (heightFactor * abs(ampBottom - ampTop));
	float foo = newPosition.x * ((crestCount * PI) / width);
	newPosition.z = (amp * cos(foo + (PI / 2.0))) * 20.0;
	transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
	newPosition.x += transform;
	newPosition.x *= scaleX;
	newPosition.x -= transform;
	newPosition.x += displacement;
	shadow = vec4(0.0, 0.0, 0.0, 0.0);
	if (newPosition.z < 15.0) {
		float alpha = 0.3 * (1.0 - ((newPosition.z + 20.0) / 35.0));
		shadow.a = alpha * amp;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = blendSrcOver(shadow, srcColor);
	gl_FragColor = color;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265
uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float curve;
	float progress = option == 1 ? halfWidth - newPosition.x : newPosition.x + halfWidth;
	float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
	float aEnd = 0.0000009;
	float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
	float zEnd = 0.0;
	float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, progress, 0);
	float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.z -= (((-a * newPosition.y) * newPosition.y) + z);
	float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
	float scaleYEnd = 1.0;
	float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.y += halfHeight;
	newPosition.y *= scaleY;
	float angle = interpolationFloat(0.0, -((2.0 * PI) / 3.0), 0.111, 1.0, timePercent, 1);
	mat4 rotateX = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	newPosition = rotateX * newPosition;
	newPosition.y -= halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
varying float shadowAlpha;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec2 shadowPosition = vec2(position.xy);
	float presetAngle = option == 1 ? 0.77 : 0.27;
	float rotateAngle = PI * presetAngle;
	float min_r = halfWidth * 0.05;
	shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;
	vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);
	float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
	float dis2BaseLine = halfWidth - newPosition.x;
	float dis2Line = line - dis2BaseLine;
	float L = line <= (halfWidth * 2.0) ? line : halfWidth * 2.0;
	float r = L / PI;
	r = r < min_r ? min_r : r;
	float angle = dis2Line / r;
	if (((dis2Line > 0.0) && (dis2Line < (line * 0.5))) && (r > min_r)) {
		shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
	}
	else {
		shadowAlpha = 0.0;
	}
	if (dis2BaseLine < line) {
		newPosition.x = ((sin(angle) * r) + halfWidth) - line;
		newPosition.z = (r - (cos(angle) * r)) * 0.5;
	}
	vec2 finalPosition = vec2(newPosition.xy);
	finalPosition = rotateOrigin(-rotateAngle) * finalPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateX(float angle) {
	return mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float progress = option == 0 ? halfWidth - newPosition.x : halfWidth + newPosition.x;
	float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, progress, 0);
	float arc = halfHeight - newPosition.y;
	float L;
	if (timePercent < 0.8) {
		L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
	}
	else {
		L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
	}
	float r = L / (2.0 * PI);
	float angle = PI - (arc / r);
	float y = sin(angle) * r;
	float z = cos(angle) * r;
	newPosition.y = halfHeight - y;
	newPosition.z = (z + r) * 0.45;
	float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(rotateAngle) * newPosition;
	newPosition.y += halfHeight;
	float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate1) * newPosition;
	newPosition.y += halfHeight;
	float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate2) * newPosition;
	newPosition.y += halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);
	gl_FragColor = blendSrcOver(shadow, distColor);
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float shadowAngle = PI / 6.0;
	float clockAngle;
	vec2 a;
	vec2 b = transform(vUv);
	float angle;
	if (timePercent < 0.5) {
		a = vec2(0.0, 0.5);
		clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
		if (b.x > 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 1.0;
		}
	}
	else {
		a = vec2(0.0, -0.5);
		clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
		if (b.x <= 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 0.0;
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uv = vUv;
	bool useSrc = false;
	vec2 row;
	float delay = 0.02;
	bool isVert = bool(option);
	int segmentCount = isVert ? 10 : 7;
	float axis = isVert ? uv.y : uv.x;
	float compareAxis = isVert ? uv.x : uv.y;
	for (int i = 0; i < segmentCount; i++) {
		float fi = float(i);
		row.r = (fi * 1.0) / float(segmentCount);
		row.g = (float(i + 1) * 1.0) / float(segmentCount);
		if ((compareAxis <= row.g) && (compareAxis > row.r)) {
			if ((i % 2) == 0) {
				float line = interpolationFloat(0.0, 1.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					useSrc = false;
				}
				else {
					axis -= line;
					useSrc = true;
				}
			}
			else {
				float line = interpolationFloat(1.0, 0.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					axis = (1.0 - line) + axis;
					useSrc = true;
				}
				else {
					useSrc = false;
				}
			}
			break;
		}
	}
	if (isVert) {
		uv.y = axis;
	}
	else {
		uv.x = axis;
	}
	vec4 srcColor = texture2D(texturePrev, uv);
	vec4 distColor = texture2D(textureNext, uv);
	gl_FragColor = useSrc ? srcColor : distColor;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uvSrc = vUv;
	vec2 uvDist = vUv;
	float scaleSrc = option == 1 ? interpolationFloat(1.0, 2.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
	float scaleDist = option == 1 ? interpolationFloat(0.1, 1.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
	uvSrc -= 0.5;
	uvSrc *= scaleSrc;
	uvSrc += 0.5;
	uvDist -= 0.5;
	uvDist *= scaleDist;
	uvDist += 0.5;
	vec4 srcColor = texture2D(texturePrev, uvSrc);
	srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
	vec4 distColor;
	if ((((uvDist.x > 1.0) || (uvDist.x < 0.0)) || (uvDist.y > 1.0)) || (uvDist.y < 0.0)) {
		distColor = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		distColor = texture2D(textureNext, uvDist);
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateY(float angle) {
	if (option == 1) {
		angle *= -1.0;
	}
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float stageOneAngle = PI / 14.0;
	float stageTwoAngle = (PI * 12.0) / 14.0;
	float stage_1 = 0.1;
	float stage_2 = 0.8;
	if (timePercent < 0.5) {
		newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
	}
	else {
		newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
	}
	if (timePercent < stage_1) {
		float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
		newPosition.x += halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x -= halfWidth;
	}
	else if ((timePercent >= stage_1) && (timePercent < stage_2)) {
		if (timePercent > 0.5) {
			newPosition *= rotateY(PI);
		}
		float offset = halfWidth - (sin((PI * 0.5) - stageOneAngle) * halfWidth);
		float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
		newPosition *= rotateY(stageOneAngle);
		newPosition.x -= halfWidth;
		newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
	}
	else {
		float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
		newPosition.x -= halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = (option == 3) || (option == 2);
	bool rotateParam = (option == 3) || (option == 1);
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 1.5;
		rectEnd = isRevert ? 0.5 : 2.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 1.5) + 0.5 : 2.0 - (((timePercent - 0.33) / 0.33) * 1.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 1.5 : 0.0;
		rectEnd = isRevert ? 2.0 : 0.5;
	}
	if (!rotateParam) {
		rectStart -= 1.0;
		rectEnd -= 1.0;
	}
	float rotate = rotateParam ? PI * 0.25 : PI * 0.75;
	vec2 rotateUv = vUv * rotateOrigin(rotate);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 startPoint = vec2(rectStart, 0.0) * rotateOrigin(rotate);
	vec2 endPoint = vec2(rectEnd, 0.0) * rotateOrigin(rotate);
	if (rotateParam) {
		if (rotateUv.x >= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x <= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((rotateUv.x - startPoint.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	else {
		if (rotateUv.x <= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x >= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((startPoint.x - rotateUv.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,E){b.exports=`#define PI 3.14159265
attribute float left;
uniform float timePercent;
uniform float offset;
varying vec2 vUv;
uniform float option;
void main() {
	vUv = uv;
	float angle;
	if (left > 0.0) {
		angle = (PI / 6.0) * timePercent;
	}
	else {
		angle = (-PI / 6.0) * timePercent;
	}
	if (option > 0.5) {
		if (left > 0.0) {
			angle = (-PI / 6.0) * timePercent;
		}
		else {
			angle = (PI / 6.0) * timePercent;
		}
	}
	vec4 newPosition = vec4(position, 1.0);
	mat4 transform;
	mat4 rotateY = mat4(cos(angle), 0.0, -sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, sin(angle), 0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	if (option > 0.5) {
		rotateY = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), -sin(angle), 0.0, 0.0, sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	}
	if (option > 0.5) {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, offset * timePercent, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -offset * timePercent, 0.0, 1.0);
		}
	}
	else {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -offset * timePercent, 0.0, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, offset * timePercent, 0.0, 0.0, 1.0);
		}
	}
	newPosition = transform * newPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,E){b.exports=`uniform sampler2D prevTexture;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 color = texture2D(prevTexture, vUv);
	color.a = 1.0 - timePercent;
	gl_FragColor = color;
}
`},function(b,E,v){(function(O){var S=v(109),I=v(110),D=setTimeout;function F(R){return Boolean(R&&R.length!==void 0)}function z(){}function J(R){if(!(this instanceof J))throw new TypeError("Promises must be constructed via new");if(typeof R!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],L(R,this)}function X(R,U){for(;R._state===3;)R=R._value;R._state!==0?(R._handled=!0,J._immediateFn(function(){var W=R._state===1?U.onFulfilled:U.onRejected;if(W!==null){var P;try{P=W(R._value)}catch(j){return void ut(U.promise,j)}et(U.promise,P)}else(R._state===1?et:ut)(U.promise,R._value)})):R._deferreds.push(U)}function et(R,U){try{if(U===R)throw new TypeError("A promise cannot be resolved with itself.");if(U&&(typeof U=="object"||typeof U=="function")){var W=U.then;if(U instanceof J)return R._state=3,R._value=U,void Rt(R);if(typeof W=="function")return void L((P=W,j=U,function(){P.apply(j,arguments)}),R)}R._state=1,R._value=U,Rt(R)}catch($){ut(R,$)}var P,j}function ut(R,U){R._state=2,R._value=U,Rt(R)}function Rt(R){R._state===2&&R._deferreds.length===0&&J._immediateFn(function(){R._handled||J._unhandledRejectionFn(R._value)});for(var U=0,W=R._deferreds.length;U<W;U++)X(R,R._deferreds[U]);R._deferreds=null}function St(R,U,W){this.onFulfilled=typeof R=="function"?R:null,this.onRejected=typeof U=="function"?U:null,this.promise=W}function L(R,U){var W=!1;try{R(function(P){W||(W=!0,et(U,P))},function(P){W||(W=!0,ut(U,P))})}catch(P){if(W)return;W=!0,ut(U,P)}}J.prototype.catch=function(R){return this.then(null,R)},J.prototype.then=function(R,U){var W=new this.constructor(z);return X(this,new St(R,U,W)),W},J.prototype.finally=S.a,J.all=function(R){return new J(function(U,W){if(!F(R))return W(new TypeError("Promise.all accepts an array"));var P=Array.prototype.slice.call(R);if(P.length===0)return U([]);var j=P.length;function $(Nt,Vt){try{if(Vt&&(typeof Vt=="object"||typeof Vt=="function")){var st=Vt.then;if(typeof st=="function")return void st.call(Vt,function(V){$(Nt,V)},W)}P[Nt]=Vt,--j==0&&U(P)}catch(V){W(V)}}for(var H=0;H<P.length;H++)$(H,P[H])})},J.allSettled=I.a,J.resolve=function(R){return R&&typeof R=="object"&&R.constructor===J?R:new J(function(U){U(R)})},J.reject=function(R){return new J(function(U,W){W(R)})},J.race=function(R){return new J(function(U,W){if(!F(R))return W(new TypeError("Promise.race accepts an array"));for(var P=0,j=R.length;P<j;P++)J.resolve(R[P]).then(U,W)})},J._immediateFn=typeof O=="function"&&function(R){O(R)}||function(R){D(R,0)},J._unhandledRejectionFn=function(R){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",R)},E.a=J}).call(this,v(140).setImmediate)},function(b,E,v){E.a=function(O){var S=this.constructor;return this.then(function(I){return S.resolve(O()).then(function(){return I})},function(I){return S.resolve(O()).then(function(){return S.reject(I)})})}},function(b,E,v){E.a=function(O){return new this(function(S,I){if(!O||O.length===void 0)return I(new TypeError(typeof O+" "+O+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var D=Array.prototype.slice.call(O);if(D.length===0)return S([]);var F=D.length;function z(X,et){if(et&&(typeof et=="object"||typeof et=="function")){var ut=et.then;if(typeof ut=="function")return void ut.call(et,function(Rt){z(X,Rt)},function(Rt){D[X]={status:"rejected",reason:Rt},--F==0&&S(D)})}D[X]={status:"fulfilled",value:et},--F==0&&S(D)}for(var J=0;J<D.length;J++)z(J,D[J])})}},function(b,E,v){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var O=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;function D(F){if(F==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(F)}b.exports=function(){try{if(!Object.assign)return!1;var F=new String("abc");if(F[5]="de",Object.getOwnPropertyNames(F)[0]==="5")return!1;for(var z={},J=0;J<10;J++)z["_"+String.fromCharCode(J)]=J;if(Object.getOwnPropertyNames(z).map(function(et){return z[et]}).join("")!=="0123456789")return!1;var X={};return"abcdefghijklmnopqrst".split("").forEach(function(et){X[et]=et}),Object.keys(Object.assign({},X)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(F,z){for(var J,X,et=D(F),ut=1;ut<arguments.length;ut++){for(var Rt in J=Object(arguments[ut]))S.call(J,Rt)&&(et[Rt]=J[Rt]);if(O){X=O(J);for(var St=0;St<X.length;St++)I.call(J,X[St])&&(et[X[St]]=J[X[St]])}}return et}},function(b,E,v){var O=v(20),S=v(15);b.exports=function(I){return I===!0||I===!1||S(I)&&O(I)=="[object Boolean]"}},function(b,E){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,E){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 uGlowColor;
uniform vec2 uSdfPosition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	vec4 glowColor = vec4(uGlowColor.rgb * uGlowColor.a, uGlowColor.a);
	float a = 1.0;
	if (uSdfIsReady > 0.0) {
		vec2 cod = vec2(filterCoord.x / uShapeFilterArea.z, filterCoord.y / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod + uSdfPosition);
		float dis = sdfColor.a * uSdfMaxDis;
		if ((sdfColor.r <= 0.0) && (dis >= (uRad * 0.5))) {
			a = 1.0 - smoothstep(uRad * 0.5, uRad, dis);
		}
	}
	vec4 resultColor = blendSrcOver(texColor, glowColor);
	resultColor.rgb *= resultColor.a;
	resultColor.rgb *= a;
	resultColor.a *= a;
	gl_FragColor = uSdfIsReady > 0.0 ? resultColor : texColor;
}
`},function(b,E){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	float alpha = texColor.a;
	texColor /= texColor.a;
	if (uSdfIsReady > 0.0) {
		float dx = uShapeFilterArea.x < 0.0 ? -uShapeFilterArea.x : 0.0;
		float dy = uShapeFilterArea.y < 0.0 ? -uShapeFilterArea.y : 0.0;
		vec2 cod = vec2((filterCoord.x + dx) / uShapeFilterArea.z, (filterCoord.y + dy) / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod);
		float dis = sdfColor.a * uSdfMaxDis;
		if (texColor.a > 0.0392156862745098) {
			if (dis <= (uRad / 2.0)) {
				float a = smoothstep(0.0, uRad / 2.0, dis) * 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
			else if ((dis > (uRad / 2.0)) && (dis < (uRad * 1.2))) {
				float a = (smoothstep(uRad / 2.0, uRad * 1.2, dis) * 0.9) + 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
		}
		else {
			texColor.rgba *= 0.0;
		}
	}
	texColor *= alpha;
	gl_FragColor = texColor;
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 uColor;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	if (sourceColor.a == 0.0) {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
	else {
		gl_FragColor = uColor * sourceColor.a;
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform float uStartPos;
uniform float uEndPos;
uniform float uHeight;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	vec2 cod = vTextureCoord * inputSize.xy;
	float startY = uStartPos * uHeight;
	float endY = uEndPos * uHeight;
	if ((cod.y >= startY) && (cod.y <= endY)) {
		float alpha = uStartAlpha - (((cod.y - startY) / (endY - startY)) * (uStartAlpha - uEndAlpha));
		gl_FragColor = sourceColor * alpha;
	}
	else {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
}
`},function(b,E){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	if (texColor.r > 0.0) {
		vec2 translateCoord = vec2(filterCoord.x + 10.0, filterCoord.y);
		vec4 translateColor = texture2D(uSampler, translateCoord * inputSize.zw);
		if (translateColor.a > 0.0) {
			gl_FragColor = texColor;
		}
		else {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	else {
		gl_FragColor = texColor;
	}
}
`},function(b,E,v){var O;(function(S,I){var D="model",F="name",z="type",J="vendor",X="version",et="mobile",ut="tablet",Rt="smarttv",St=function(st){for(var V={},B=0;B<st.length;B++)V[st[B].toUpperCase()]=st[B];return V},L=function(st,V){return typeof st=="string"&&R(V).indexOf(R(st))!==-1},R=function(st){return st.toLowerCase()},U=function(st,V){if(typeof st=="string")return st=st.replace(/^\s\s*/,"").replace(/\s\s*$/,""),V===void 0?st:st.substring(0,255)},W=function(st,V){for(var B,ft,tt,vt,Dt,Z,pt=0;pt<V.length&&!Dt;){var rt=V[pt],_t=V[pt+1];for(B=ft=0;B<rt.length&&!Dt;)if(Dt=rt[B++].exec(st))for(tt=0;tt<_t.length;tt++)Z=Dt[++ft],typeof(vt=_t[tt])=="object"&&vt.length>0?vt.length===2?typeof vt[1]=="function"?this[vt[0]]=vt[1].call(this,Z):this[vt[0]]=vt[1]:vt.length===3?typeof vt[1]!="function"||vt[1].exec&&vt[1].test?this[vt[0]]=Z?Z.replace(vt[1],vt[2]):void 0:this[vt[0]]=Z?vt[1].call(this,Z,vt[2]):void 0:vt.length===4&&(this[vt[0]]=Z?vt[3].call(this,Z.replace(vt[1],vt[2])):void 0):this[vt]=Z||void 0;pt+=2}},P=function(st,V){for(var B in V)if(typeof V[B]=="object"&&V[B].length>0){for(var ft=0;ft<V[B].length;ft++)if(L(V[B][ft],st))return B==="?"?void 0:B}else if(L(V[B],st))return B==="?"?void 0:B;return st},j={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},$={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[X,[F,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[X,[F,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[F,X],[/opios[\/ ]+([\w\.]+)/i],[X,[F,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[X,[F,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[F,X],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[X,[F,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[X,[F,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[X,[F,"WeChat"]],[/konqueror\/([\w\.]+)/i],[X,[F,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[X,[F,"IE"]],[/yabrowser\/([\w\.]+)/i],[X,[F,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[F,/(.+)/,"$1 Secure Browser"],X],[/\bfocus\/([\w\.]+)/i],[X,[F,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[X,[F,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[X,[F,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[X,[F,"Dolphin"]],[/coast\/([\w\.]+)/i],[X,[F,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[X,[F,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[X,[F,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[F,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[F,/(.+)/,"$1 Browser"],X],[/(comodo_dragon)\/([\w\.]+)/i],[[F,/_/g," "],X],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[F,X],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[F],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[F,"Facebook"],X],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[F,X],[/\bgsa\/([\w\.]+) .*safari\//i],[X,[F,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[X,[F,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[F,"Chrome WebView"],X],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[X,[F,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[F,X],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[X,[F,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[X,F],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[F,[X,P,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[F,X],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[F,"Netscape"],X],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[X,[F,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[F,X]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",R]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",R]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",R]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[D,[J,"Samsung"],[z,ut]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[D,[J,"Samsung"],[z,et]],[/\((ip(?:hone|od)[\w ]*);/i],[D,[J,"Apple"],[z,et]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[D,[J,"Apple"],[z,ut]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[D,[J,"Huawei"],[z,ut]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[D,[J,"Huawei"],[z,et]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[D,/_/g," "],[J,"Xiaomi"],[z,et]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[D,/_/g," "],[J,"Xiaomi"],[z,ut]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[D,[J,"OPPO"],[z,et]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[D,[J,"Vivo"],[z,et]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[D,[J,"Realme"],[z,et]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[D,[J,"Motorola"],[z,et]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[D,[J,"Motorola"],[z,ut]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[D,[J,"LG"],[z,ut]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[D,[J,"LG"],[z,et]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[D,[J,"Lenovo"],[z,ut]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[D,/_/g," "],[J,"Nokia"],[z,et]],[/(pixel c)\b/i],[D,[J,"Google"],[z,ut]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[D,[J,"Google"],[z,et]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[D,[J,"Sony"],[z,et]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[D,"Xperia Tablet"],[J,"Sony"],[z,ut]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[D,[J,"OnePlus"],[z,et]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[D,[J,"Amazon"],[z,ut]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[D,/(.+)/g,"Fire Phone $1"],[J,"Amazon"],[z,et]],[/(playbook);[-\w\),; ]+(rim)/i],[D,J,[z,ut]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[D,[J,"BlackBerry"],[z,et]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[D,[J,"ASUS"],[z,ut]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[D,[J,"ASUS"],[z,et]],[/(nexus 9)/i],[D,[J,"HTC"],[z,ut]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[J,[D,/_/g," "],[z,et]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[D,[J,"Acer"],[z,ut]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[D,[J,"Meizu"],[z,et]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[D,[J,"Sharp"],[z,et]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[J,D,[z,et]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[J,D,[z,ut]],[/(surface duo)/i],[D,[J,"Microsoft"],[z,ut]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[D,[J,"Fairphone"],[z,et]],[/(u304aa)/i],[D,[J,"AT&T"],[z,et]],[/\bsie-(\w*)/i],[D,[J,"Siemens"],[z,et]],[/\b(rct\w+) b/i],[D,[J,"RCA"],[z,ut]],[/\b(venue[\d ]{2,7}) b/i],[D,[J,"Dell"],[z,ut]],[/\b(q(?:mv|ta)\w+) b/i],[D,[J,"Verizon"],[z,ut]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[D,[J,"Barnes & Noble"],[z,ut]],[/\b(tm\d{3}\w+) b/i],[D,[J,"NuVision"],[z,ut]],[/\b(k88) b/i],[D,[J,"ZTE"],[z,ut]],[/\b(nx\d{3}j) b/i],[D,[J,"ZTE"],[z,et]],[/\b(gen\d{3}) b.+49h/i],[D,[J,"Swiss"],[z,et]],[/\b(zur\d{3}) b/i],[D,[J,"Swiss"],[z,ut]],[/\b((zeki)?tb.*\b) b/i],[D,[J,"Zeki"],[z,ut]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[J,"Dragon Touch"],D,[z,ut]],[/\b(ns-?\w{0,9}) b/i],[D,[J,"Insignia"],[z,ut]],[/\b((nxa|next)-?\w{0,9}) b/i],[D,[J,"NextBook"],[z,ut]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[J,"Voice"],D,[z,et]],[/\b(lvtel\-)?(v1[12]) b/i],[[J,"LvTel"],D,[z,et]],[/\b(ph-1) /i],[D,[J,"Essential"],[z,et]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[D,[J,"Envizen"],[z,ut]],[/\b(trio[-\w\. ]+) b/i],[D,[J,"MachSpeed"],[z,ut]],[/\btu_(1491) b/i],[D,[J,"Rotor"],[z,ut]],[/(shield[\w ]+) b/i],[D,[J,"Nvidia"],[z,ut]],[/(sprint) (\w+)/i],[J,D,[z,et]],[/(kin\.[onetw]{3})/i],[[D,/\./g," "],[J,"Microsoft"],[z,et]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[D,[J,"Zebra"],[z,ut]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[D,[J,"Zebra"],[z,et]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[J,D,[z,"console"]],[/droid.+; (shield) bui/i],[D,[J,"Nvidia"],[z,"console"]],[/(playstation [345portablevi]+)/i],[D,[J,"Sony"],[z,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[D,[J,"Microsoft"],[z,"console"]],[/smart-tv.+(samsung)/i],[J,[z,Rt]],[/hbbtv.+maple;(\d+)/i],[[D,/^/,"SmartTV"],[J,"Samsung"],[z,Rt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[J,"LG"],[z,Rt]],[/(apple) ?tv/i],[J,[D,"Apple TV"],[z,Rt]],[/crkey/i],[[D,"Chromecast"],[J,"Google"],[z,Rt]],[/droid.+aft(\w)( bui|\))/i],[D,[J,"Amazon"],[z,Rt]],[/\(dtv[\);].+(aquos)/i],[D,[J,"Sharp"],[z,Rt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[J,U],[D,U],[z,Rt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[z,Rt]],[/((pebble))app/i],[J,D,[z,"wearable"]],[/droid.+; (glass) \d/i],[D,[J,"Google"],[z,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[D,[J,"Zebra"],[z,"wearable"]],[/(quest( 2)?)/i],[D,[J,"Facebook"],[z,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[J,[z,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[D,[z,et]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[D,[z,ut]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[z,ut]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[z,et]],[/(android[-\w\. ]{0,9});.+buil/i],[D,[J,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[X,[F,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[X,[F,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[F,X],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[X,F]],os:[[/microsoft (windows) (vista|xp)/i],[F,X],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[F,[X,P,j]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[F,"Windows"],[X,P,j]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[X,/_/g,"."],[F,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[F,"Mac OS"],[X,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[X,F],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[F,X],[/\(bb(10);/i],[X,[F,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[X,[F,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[X,[F,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[X,[F,"webOS"]],[/crkey\/([\d\.]+)/i],[X,[F,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[F,"Chromium OS"],X],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[F,X],[/(sunos) ?([\w\.\d]*)/i],[[F,"Solaris"],X],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[F,X]]},H=function(st,V){if(typeof st=="object"&&(V=st,st=void 0),!(this instanceof H))return new H(st,V).getResult();var B=st||(S!==void 0&&S.navigator&&S.navigator.userAgent?S.navigator.userAgent:""),ft=V?function(tt,vt){var Dt={};for(var Z in tt)vt[Z]&&vt[Z].length%2==0?Dt[Z]=vt[Z].concat(tt[Z]):Dt[Z]=tt[Z];return Dt}($,V):$;return this.getBrowser=function(){var tt,vt={};return vt[F]=void 0,vt[X]=void 0,W.call(vt,B,ft.browser),vt.major=typeof(tt=vt.version)=="string"?tt.replace(/[^\d\.]/g,"").split(".")[0]:void 0,vt},this.getCPU=function(){var tt={architecture:void 0};return W.call(tt,B,ft.cpu),tt},this.getDevice=function(){var tt={vendor:void 0,model:void 0,type:void 0};return W.call(tt,B,ft.device),tt},this.getEngine=function(){var tt={name:void 0,version:void 0};return W.call(tt,B,ft.engine),tt},this.getOS=function(){var tt={name:void 0,version:void 0};return W.call(tt,B,ft.os),tt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return B},this.setUA=function(tt){return B=typeof tt=="string"&&tt.length>255?U(tt,255):tt,this},this.setUA(B),this};H.VERSION="1.0.2",H.BROWSER=St([F,X,"major"]),H.CPU=St(["architecture"]),H.DEVICE=St([D,J,z,"console",et,Rt,ut,"wearable","embedded"]),H.ENGINE=H.OS=St([F,X]),E!==void 0?(b!==void 0&&b.exports&&(E=b.exports=H),E.UAParser=H):v(149)?(O=function(){return H}.call(E,v,E,b))===void 0||(b.exports=O):S!==void 0&&(S.UAParser=H);var Nt=S!==void 0&&(S.jQuery||S.Zepto);if(Nt&&!Nt.ua){var Vt=new H;Nt.ua=Vt.getResult(),Nt.ua.get=function(){return Vt.getUA()},Nt.ua.set=function(st){Vt.setUA(st);var V=Vt.getResult();for(var B in V)Nt.ua[B]=V[B]}}})(typeof window=="object"?window:this)},function(b,E,v){(function(O){var S;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var I=function(){this.init()};I.prototype={init:function(){var L=this||D;return L._counter=1e3,L._html5AudioPool=[],L.html5PoolSize=10,L._codecs={},L._howls=[],L._muted=!1,L._volume=1,L._canPlayEvent="canplaythrough",L._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,L.masterGain=null,L.noAudio=!1,L.usingWebAudio=!0,L.autoSuspend=!0,L.ctx=null,L.autoUnlock=!0,L._setup(),L},volume:function(L){var R=this||D;if(L=parseFloat(L),R.ctx||St(),L!==void 0&&L>=0&&L<=1){if(R._volume=L,R._muted)return R;R.usingWebAudio&&R.masterGain.gain.setValueAtTime(L,D.ctx.currentTime);for(var U=0;U<R._howls.length;U++)if(!R._howls[U]._webAudio)for(var W=R._howls[U]._getSoundIds(),P=0;P<W.length;P++){var j=R._howls[U]._soundById(W[P]);j&&j._node&&(j._node.volume=j._volume*L)}return R}return R._volume},mute:function(L){var R=this||D;R.ctx||St(),R._muted=L,R.usingWebAudio&&R.masterGain.gain.setValueAtTime(L?0:R._volume,D.ctx.currentTime);for(var U=0;U<R._howls.length;U++)if(!R._howls[U]._webAudio)for(var W=R._howls[U]._getSoundIds(),P=0;P<W.length;P++){var j=R._howls[U]._soundById(W[P]);j&&j._node&&(j._node.muted=!!L||j._muted)}return R},stop:function(){for(var L=this||D,R=0;R<L._howls.length;R++)L._howls[R].stop();return L},unload:function(){for(var L=this||D,R=L._howls.length-1;R>=0;R--)L._howls[R].unload();return L.usingWebAudio&&L.ctx&&L.ctx.close!==void 0&&(L.ctx.close(),L.ctx=null,St()),L},codecs:function(L){return(this||D)._codecs[L.replace(/^x-/,"")]},_setup:function(){var L=this||D;if(L.state=L.ctx&&L.ctx.state||"suspended",L._autoSuspend(),!L.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(L._canPlayEvent="canplay")}catch{L.noAudio=!0}else L.noAudio=!0;try{new Audio().muted&&(L.noAudio=!0)}catch{}return L.noAudio||L._setupCodecs(),L},_setupCodecs:function(){var L=this||D,R=null;try{R=typeof Audio!="undefined"?new Audio:null}catch{return L}if(!R||typeof R.canPlayType!="function")return L;var U=R.canPlayType("audio/mpeg;").replace(/^no$/,""),W=L._navigator?L._navigator.userAgent:"",P=W.match(/OPR\/([0-6].)/g),j=P&&parseInt(P[0].split("/")[1],10)<33,$=W.indexOf("Safari")!==-1&&W.indexOf("Chrome")===-1,H=W.match(/Version\/(.*?) /),Nt=$&&H&&parseInt(H[1],10)<15;return L._codecs={mp3:!(j||!U&&!R.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!U,opus:!!R.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!R.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!R.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(R.canPlayType('audio/wav; codecs="1"')||R.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!R.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!R.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(R.canPlayType("audio/x-m4a;")||R.canPlayType("audio/m4a;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(R.canPlayType("audio/x-m4b;")||R.canPlayType("audio/m4b;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(R.canPlayType("audio/x-mp4;")||R.canPlayType("audio/mp4;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(Nt||!R.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(Nt||!R.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!R.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(R.canPlayType("audio/x-flac;")||R.canPlayType("audio/flac;")).replace(/^no$/,"")},L},_unlockAudio:function(){var L=this||D;if(!L._audioUnlocked&&L.ctx){L._audioUnlocked=!1,L.autoUnlock=!1,L._mobileUnloaded||L.ctx.sampleRate===44100||(L._mobileUnloaded=!0,L.unload()),L._scratchBuffer=L.ctx.createBuffer(1,1,22050);var R=function(U){for(;L._html5AudioPool.length<L.html5PoolSize;)try{var W=new Audio;W._unlocked=!0,L._releaseHtml5Audio(W)}catch{L.noAudio=!0;break}for(var P=0;P<L._howls.length;P++)if(!L._howls[P]._webAudio)for(var j=L._howls[P]._getSoundIds(),$=0;$<j.length;$++){var H=L._howls[P]._soundById(j[$]);H&&H._node&&!H._node._unlocked&&(H._node._unlocked=!0,H._node.load())}L._autoResume();var Nt=L.ctx.createBufferSource();Nt.buffer=L._scratchBuffer,Nt.connect(L.ctx.destination),Nt.start===void 0?Nt.noteOn(0):Nt.start(0),typeof L.ctx.resume=="function"&&L.ctx.resume(),Nt.onended=function(){Nt.disconnect(0),L._audioUnlocked=!0,document.removeEventListener("touchstart",R,!0),document.removeEventListener("touchend",R,!0),document.removeEventListener("click",R,!0),document.removeEventListener("keydown",R,!0);for(var Vt=0;Vt<L._howls.length;Vt++)L._howls[Vt]._emit("unlock")}};return document.addEventListener("touchstart",R,!0),document.addEventListener("touchend",R,!0),document.addEventListener("click",R,!0),document.addEventListener("keydown",R,!0),L}},_obtainHtml5Audio:function(){var L=this||D;if(L._html5AudioPool.length)return L._html5AudioPool.pop();var R=new Audio().play();return R&&typeof Promise!="undefined"&&(R instanceof Promise||typeof R.then=="function")&&R.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(L){var R=this||D;return L._unlocked&&R._html5AudioPool.push(L),R},_autoSuspend:function(){var L=this;if(L.autoSuspend&&L.ctx&&L.ctx.suspend!==void 0&&D.usingWebAudio){for(var R=0;R<L._howls.length;R++)if(L._howls[R]._webAudio){for(var U=0;U<L._howls[R]._sounds.length;U++)if(!L._howls[R]._sounds[U]._paused)return L}return L._suspendTimer&&clearTimeout(L._suspendTimer),L._suspendTimer=setTimeout(function(){if(L.autoSuspend){L._suspendTimer=null,L.state="suspending";var W=function(){L.state="suspended",L._resumeAfterSuspend&&(delete L._resumeAfterSuspend,L._autoResume())};L.ctx.suspend().then(W,W)}},3e4),L}},_autoResume:function(){var L=this;if(L.ctx&&L.ctx.resume!==void 0&&D.usingWebAudio)return L.state==="running"&&L.ctx.state!=="interrupted"&&L._suspendTimer?(clearTimeout(L._suspendTimer),L._suspendTimer=null):L.state==="suspended"||L.state==="running"&&L.ctx.state==="interrupted"?(L.ctx.resume().then(function(){L.state="running";for(var R=0;R<L._howls.length;R++)L._howls[R]._emit("resume")}),L._suspendTimer&&(clearTimeout(L._suspendTimer),L._suspendTimer=null)):L.state==="suspending"&&(L._resumeAfterSuspend=!0),L}};var D=new I,F=function(L){L.src&&L.src.length!==0?this.init(L):console.error("An array of source files must be passed with any new Howl.")};F.prototype={init:function(L){var R=this;return D.ctx||St(),R._autoplay=L.autoplay||!1,R._format=typeof L.format!="string"?L.format:[L.format],R._html5=L.html5||!1,R._muted=L.mute||!1,R._loop=L.loop||!1,R._pool=L.pool||5,R._preload=typeof L.preload!="boolean"&&L.preload!=="metadata"||L.preload,R._rate=L.rate||1,R._sprite=L.sprite||{},R._src=typeof L.src!="string"?L.src:[L.src],R._volume=L.volume!==void 0?L.volume:1,R._xhr={method:L.xhr&&L.xhr.method?L.xhr.method:"GET",headers:L.xhr&&L.xhr.headers?L.xhr.headers:null,withCredentials:!(!L.xhr||!L.xhr.withCredentials)&&L.xhr.withCredentials},R._duration=0,R._state="unloaded",R._sounds=[],R._endTimers={},R._queue=[],R._playLock=!1,R._onend=L.onend?[{fn:L.onend}]:[],R._onfade=L.onfade?[{fn:L.onfade}]:[],R._onload=L.onload?[{fn:L.onload}]:[],R._onloaderror=L.onloaderror?[{fn:L.onloaderror}]:[],R._onplayerror=L.onplayerror?[{fn:L.onplayerror}]:[],R._onpause=L.onpause?[{fn:L.onpause}]:[],R._onplay=L.onplay?[{fn:L.onplay}]:[],R._onstop=L.onstop?[{fn:L.onstop}]:[],R._onmute=L.onmute?[{fn:L.onmute}]:[],R._onvolume=L.onvolume?[{fn:L.onvolume}]:[],R._onrate=L.onrate?[{fn:L.onrate}]:[],R._onseek=L.onseek?[{fn:L.onseek}]:[],R._onunlock=L.onunlock?[{fn:L.onunlock}]:[],R._onresume=[],R._webAudio=D.usingWebAudio&&!R._html5,D.ctx!==void 0&&D.ctx&&D.autoUnlock&&D._unlockAudio(),D._howls.push(R),R._autoplay&&R._queue.push({event:"play",action:function(){R.play()}}),R._preload&&R._preload!=="none"&&R.load(),R},load:function(){var L=null;if(D.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var R=0;R<this._src.length;R++){var U,W;if(this._format&&this._format[R])U=this._format[R];else{if(typeof(W=this._src[R])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(U=/^data:audio\/([^;,]+);/i.exec(W))||(U=/\.([^.]+)$/.exec(W.split("?",1)[0])),U&&(U=U[1].toLowerCase())}if(U||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),U&&D.codecs(U)){L=this._src[R];break}}if(L)return this._src=L,this._state="loading",window.location.protocol==="https:"&&L.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new z(this),this._webAudio&&X(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(L,R){var U=this,W=null;if(typeof L=="number")W=L,L=null;else{if(typeof L=="string"&&U._state==="loaded"&&!U._sprite[L])return null;if(L===void 0&&(L="__default",!U._playLock)){for(var P=0,j=0;j<U._sounds.length;j++)U._sounds[j]._paused&&!U._sounds[j]._ended&&(P++,W=U._sounds[j]._id);P===1?L=null:W=null}}var $=W?U._soundById(W):U._inactiveSound();if(!$)return null;if(W&&!L&&(L=$._sprite||"__default"),U._state!=="loaded"){$._sprite=L,$._ended=!1;var H=$._id;return U._queue.push({event:"play",action:function(){U.play(H)}}),H}if(W&&!$._paused)return R||U._loadQueue("play"),$._id;U._webAudio&&D._autoResume();var Nt=Math.max(0,$._seek>0?$._seek:U._sprite[L][0]/1e3),Vt=Math.max(0,(U._sprite[L][0]+U._sprite[L][1])/1e3-Nt),st=1e3*Vt/Math.abs($._rate),V=U._sprite[L][0]/1e3,B=(U._sprite[L][0]+U._sprite[L][1])/1e3;$._sprite=L,$._ended=!1;var ft=function(){$._paused=!1,$._seek=Nt,$._start=V,$._stop=B,$._loop=!(!$._loop&&!U._sprite[L][2])};if(!(Nt>=B)){var tt=$._node;if(U._webAudio){var vt=function(){U._playLock=!1,ft(),U._refreshBuffer($);var rt=$._muted||U._muted?0:$._volume;tt.gain.setValueAtTime(rt,D.ctx.currentTime),$._playStart=D.ctx.currentTime,tt.bufferSource.start===void 0?$._loop?tt.bufferSource.noteGrainOn(0,Nt,86400):tt.bufferSource.noteGrainOn(0,Nt,Vt):$._loop?tt.bufferSource.start(0,Nt,86400):tt.bufferSource.start(0,Nt,Vt),st!==1/0&&(U._endTimers[$._id]=setTimeout(U._ended.bind(U,$),st)),R||setTimeout(function(){U._emit("play",$._id),U._loadQueue()},0)};D.state==="running"&&D.ctx.state!=="interrupted"?vt():(U._playLock=!0,U.once("resume",vt),U._clearTimer($._id))}else{var Dt=function(){tt.currentTime=Nt,tt.muted=$._muted||U._muted||D._muted||tt.muted,tt.volume=$._volume*D.volume(),tt.playbackRate=$._rate;try{var rt=tt.play();if(rt&&typeof Promise!="undefined"&&(rt instanceof Promise||typeof rt.then=="function")?(U._playLock=!0,ft(),rt.then(function(){U._playLock=!1,tt._unlocked=!0,R?U._loadQueue():U._emit("play",$._id)}).catch(function(){U._playLock=!1,U._emit("playerror",$._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),$._ended=!0,$._paused=!0})):R||(U._playLock=!1,ft(),U._emit("play",$._id)),tt.playbackRate=$._rate,tt.paused)return void U._emit("playerror",$._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");L!=="__default"||$._loop?U._endTimers[$._id]=setTimeout(U._ended.bind(U,$),st):(U._endTimers[$._id]=function(){U._ended($),tt.removeEventListener("ended",U._endTimers[$._id],!1)},tt.addEventListener("ended",U._endTimers[$._id],!1))}catch(_t){U._emit("playerror",$._id,_t)}};tt.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(tt.src=U._src,tt.load());var Z=window&&window.ejecta||!tt.readyState&&D._navigator.isCocoonJS;if(tt.readyState>=3||Z)Dt();else{U._playLock=!0,U._state="loading";var pt=function(){U._state="loaded",Dt(),tt.removeEventListener(D._canPlayEvent,pt,!1)};tt.addEventListener(D._canPlayEvent,pt,!1),U._clearTimer($._id)}}return $._id}U._ended($)},pause:function(L){var R=this;if(R._state!=="loaded"||R._playLock)return R._queue.push({event:"pause",action:function(){R.pause(L)}}),R;for(var U=R._getSoundIds(L),W=0;W<U.length;W++){R._clearTimer(U[W]);var P=R._soundById(U[W]);if(P&&!P._paused&&(P._seek=R.seek(U[W]),P._rateSeek=0,P._paused=!0,R._stopFade(U[W]),P._node))if(R._webAudio){if(!P._node.bufferSource)continue;P._node.bufferSource.stop===void 0?P._node.bufferSource.noteOff(0):P._node.bufferSource.stop(0),R._cleanBuffer(P._node)}else isNaN(P._node.duration)&&P._node.duration!==1/0||P._node.pause();arguments[1]||R._emit("pause",P?P._id:null)}return R},stop:function(L,R){var U=this;if(U._state!=="loaded"||U._playLock)return U._queue.push({event:"stop",action:function(){U.stop(L)}}),U;for(var W=U._getSoundIds(L),P=0;P<W.length;P++){U._clearTimer(W[P]);var j=U._soundById(W[P]);j&&(j._seek=j._start||0,j._rateSeek=0,j._paused=!0,j._ended=!0,U._stopFade(W[P]),j._node&&(U._webAudio?j._node.bufferSource&&(j._node.bufferSource.stop===void 0?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),U._cleanBuffer(j._node)):isNaN(j._node.duration)&&j._node.duration!==1/0||(j._node.currentTime=j._start||0,j._node.pause(),j._node.duration===1/0&&U._clearSound(j._node))),R||U._emit("stop",j._id))}return U},mute:function(L,R){var U=this;if(U._state!=="loaded"||U._playLock)return U._queue.push({event:"mute",action:function(){U.mute(L,R)}}),U;if(R===void 0){if(typeof L!="boolean")return U._muted;U._muted=L}for(var W=U._getSoundIds(R),P=0;P<W.length;P++){var j=U._soundById(W[P]);j&&(j._muted=L,j._interval&&U._stopFade(j._id),U._webAudio&&j._node?j._node.gain.setValueAtTime(L?0:j._volume,D.ctx.currentTime):j._node&&(j._node.muted=!!D._muted||L),U._emit("mute",j._id))}return U},volume:function(){var L,R,U,W=this,P=arguments;if(P.length===0)return W._volume;if(P.length===1||P.length===2&&P[1]===void 0){var j=W._getSoundIds(),$=j.indexOf(P[0]);$>=0?R=parseInt(P[0],10):L=parseFloat(P[0])}else P.length>=2&&(L=parseFloat(P[0]),R=parseInt(P[1],10));if(!(L!==void 0&&L>=0&&L<=1))return(U=R?W._soundById(R):W._sounds[0])?U._volume:0;if(W._state!=="loaded"||W._playLock)return W._queue.push({event:"volume",action:function(){W.volume.apply(W,P)}}),W;R===void 0&&(W._volume=L),R=W._getSoundIds(R);for(var H=0;H<R.length;H++)(U=W._soundById(R[H]))&&(U._volume=L,P[2]||W._stopFade(R[H]),W._webAudio&&U._node&&!U._muted?U._node.gain.setValueAtTime(L,D.ctx.currentTime):U._node&&!U._muted&&(U._node.volume=L*D.volume()),W._emit("volume",U._id));return W},fade:function(L,R,U,W){var P=this;if(P._state!=="loaded"||P._playLock)return P._queue.push({event:"fade",action:function(){P.fade(L,R,U,W)}}),P;L=Math.min(Math.max(0,parseFloat(L)),1),R=Math.min(Math.max(0,parseFloat(R)),1),U=parseFloat(U),P.volume(L,W);for(var j=P._getSoundIds(W),$=0;$<j.length;$++){var H=P._soundById(j[$]);if(H){if(W||P._stopFade(j[$]),P._webAudio&&!H._muted){var Nt=D.ctx.currentTime,Vt=Nt+U/1e3;H._volume=L,H._node.gain.setValueAtTime(L,Nt),H._node.gain.linearRampToValueAtTime(R,Vt)}P._startFadeInterval(H,L,R,U,j[$],W===void 0)}}return P},_startFadeInterval:function(L,R,U,W,P,j){var $=this,H=R,Nt=U-R,Vt=Math.abs(Nt/.01),st=Math.max(4,Vt>0?W/Vt:W),V=Date.now();L._fadeTo=U,L._interval=setInterval(function(){var B=(Date.now()-V)/W;V=Date.now(),H+=Nt*B,H=Math.round(100*H)/100,H=Nt<0?Math.max(U,H):Math.min(U,H),$._webAudio?L._volume=H:$.volume(H,L._id,!0),j&&($._volume=H),(U<R&&H<=U||U>R&&H>=U)&&(clearInterval(L._interval),L._interval=null,L._fadeTo=null,$.volume(U,L._id),$._emit("fade",L._id))},st)},_stopFade:function(L){var R=this._soundById(L);return R&&R._interval&&(this._webAudio&&R._node.gain.cancelScheduledValues(D.ctx.currentTime),clearInterval(R._interval),R._interval=null,this.volume(R._fadeTo,L),R._fadeTo=null,this._emit("fade",L)),this},loop:function(){var L,R,U,W=this,P=arguments;if(P.length===0)return W._loop;if(P.length===1){if(typeof P[0]!="boolean")return!!(U=W._soundById(parseInt(P[0],10)))&&U._loop;L=P[0],W._loop=L}else P.length===2&&(L=P[0],R=parseInt(P[1],10));for(var j=W._getSoundIds(R),$=0;$<j.length;$++)(U=W._soundById(j[$]))&&(U._loop=L,W._webAudio&&U._node&&U._node.bufferSource&&(U._node.bufferSource.loop=L,L&&(U._node.bufferSource.loopStart=U._start||0,U._node.bufferSource.loopEnd=U._stop,W.playing(j[$])&&(W.pause(j[$],!0),W.play(j[$],!0)))));return W},rate:function(){var L,R,U,W=this,P=arguments;if(P.length===0)R=W._sounds[0]._id;else if(P.length===1){var j=W._getSoundIds(),$=j.indexOf(P[0]);$>=0?R=parseInt(P[0],10):L=parseFloat(P[0])}else P.length===2&&(L=parseFloat(P[0]),R=parseInt(P[1],10));if(typeof L!="number")return(U=W._soundById(R))?U._rate:W._rate;if(W._state!=="loaded"||W._playLock)return W._queue.push({event:"rate",action:function(){W.rate.apply(W,P)}}),W;R===void 0&&(W._rate=L),R=W._getSoundIds(R);for(var H=0;H<R.length;H++)if(U=W._soundById(R[H])){W.playing(R[H])&&(U._rateSeek=W.seek(R[H]),U._playStart=W._webAudio?D.ctx.currentTime:U._playStart),U._rate=L,W._webAudio&&U._node&&U._node.bufferSource?U._node.bufferSource.playbackRate.setValueAtTime(L,D.ctx.currentTime):U._node&&(U._node.playbackRate=L);var Nt=W.seek(R[H]),Vt=(W._sprite[U._sprite][0]+W._sprite[U._sprite][1])/1e3-Nt,st=1e3*Vt/Math.abs(U._rate);!W._endTimers[R[H]]&&U._paused||(W._clearTimer(R[H]),W._endTimers[R[H]]=setTimeout(W._ended.bind(W,U),st)),W._emit("rate",U._id)}return W},seek:function(){var L,R,U=this,W=arguments;if(W.length===0)U._sounds.length&&(R=U._sounds[0]._id);else if(W.length===1){var P=U._getSoundIds(),j=P.indexOf(W[0]);j>=0?R=parseInt(W[0],10):U._sounds.length&&(R=U._sounds[0]._id,L=parseFloat(W[0]))}else W.length===2&&(L=parseFloat(W[0]),R=parseInt(W[1],10));if(R===void 0)return 0;if(typeof L=="number"&&(U._state!=="loaded"||U._playLock))return U._queue.push({event:"seek",action:function(){U.seek.apply(U,W)}}),U;var $=U._soundById(R);if($){if(!(typeof L=="number"&&L>=0)){if(U._webAudio){var H=U.playing(R)?D.ctx.currentTime-$._playStart:0,Nt=$._rateSeek?$._rateSeek-$._seek:0;return $._seek+(Nt+H*Math.abs($._rate))}return $._node.currentTime}var Vt=U.playing(R);Vt&&U.pause(R,!0),$._seek=L,$._ended=!1,U._clearTimer(R),U._webAudio||!$._node||isNaN($._node.duration)||($._node.currentTime=L);var st=function(){Vt&&U.play(R,!0),U._emit("seek",R)};if(Vt&&!U._webAudio){var V=function(){U._playLock?setTimeout(V,0):st()};setTimeout(V,0)}else st()}return U},playing:function(L){if(typeof L=="number"){var R=this._soundById(L);return!!R&&!R._paused}for(var U=0;U<this._sounds.length;U++)if(!this._sounds[U]._paused)return!0;return!1},duration:function(L){var R=this._duration,U=this._soundById(L);return U&&(R=this._sprite[U._sprite][1]/1e3),R},state:function(){return this._state},unload:function(){for(var L=this,R=L._sounds,U=0;U<R.length;U++)R[U]._paused||L.stop(R[U]._id),L._webAudio||(L._clearSound(R[U]._node),R[U]._node.removeEventListener("error",R[U]._errorFn,!1),R[U]._node.removeEventListener(D._canPlayEvent,R[U]._loadFn,!1),R[U]._node.removeEventListener("ended",R[U]._endFn,!1),D._releaseHtml5Audio(R[U]._node)),delete R[U]._node,L._clearTimer(R[U]._id);var W=D._howls.indexOf(L);W>=0&&D._howls.splice(W,1);var P=!0;for(U=0;U<D._howls.length;U++)if(D._howls[U]._src===L._src||L._src.indexOf(D._howls[U]._src)>=0){P=!1;break}return J&&P&&delete J[L._src],D.noAudio=!1,L._state="unloaded",L._sounds=[],L=null,null},on:function(L,R,U,W){var P=this["_on"+L];return typeof R=="function"&&P.push(W?{id:U,fn:R,once:W}:{id:U,fn:R}),this},off:function(L,R,U){var W=this["_on"+L],P=0;if(typeof R=="number"&&(U=R,R=null),R||U)for(P=0;P<W.length;P++){var j=U===W[P].id;if(R===W[P].fn&&j||!R&&j){W.splice(P,1);break}}else if(L)this["_on"+L]=[];else{var $=Object.keys(this);for(P=0;P<$.length;P++)$[P].indexOf("_on")===0&&Array.isArray(this[$[P]])&&(this[$[P]]=[])}return this},once:function(L,R,U){return this.on(L,R,U,1),this},_emit:function(L,R,U){for(var W=this["_on"+L],P=W.length-1;P>=0;P--)W[P].id&&W[P].id!==R&&L!=="load"||(setTimeout(function(j){j.call(this,R,U)}.bind(this,W[P].fn),0),W[P].once&&this.off(L,W[P].fn,W[P].id));return this._loadQueue(L),this},_loadQueue:function(L){if(this._queue.length>0){var R=this._queue[0];R.event===L&&(this._queue.shift(),this._loadQueue()),L||R.action()}return this},_ended:function(L){var R=L._sprite;if(!this._webAudio&&L._node&&!L._node.paused&&!L._node.ended&&L._node.currentTime<L._stop)return setTimeout(this._ended.bind(this,L),100),this;var U=!(!L._loop&&!this._sprite[R][2]);if(this._emit("end",L._id),!this._webAudio&&U&&this.stop(L._id,!0).play(L._id),this._webAudio&&U){this._emit("play",L._id),L._seek=L._start||0,L._rateSeek=0,L._playStart=D.ctx.currentTime;var W=1e3*(L._stop-L._start)/Math.abs(L._rate);this._endTimers[L._id]=setTimeout(this._ended.bind(this,L),W)}return this._webAudio&&!U&&(L._paused=!0,L._ended=!0,L._seek=L._start||0,L._rateSeek=0,this._clearTimer(L._id),this._cleanBuffer(L._node),D._autoSuspend()),this._webAudio||U||this.stop(L._id,!0),this},_clearTimer:function(L){if(this._endTimers[L]){if(typeof this._endTimers[L]!="function")clearTimeout(this._endTimers[L]);else{var R=this._soundById(L);R&&R._node&&R._node.removeEventListener("ended",this._endTimers[L],!1)}delete this._endTimers[L]}return this},_soundById:function(L){for(var R=0;R<this._sounds.length;R++)if(L===this._sounds[R]._id)return this._sounds[R];return null},_inactiveSound:function(){this._drain();for(var L=0;L<this._sounds.length;L++)if(this._sounds[L]._ended)return this._sounds[L].reset();return new z(this)},_drain:function(){var L=this._pool,R=0,U=0;if(!(this._sounds.length<L)){for(U=0;U<this._sounds.length;U++)this._sounds[U]._ended&&R++;for(U=this._sounds.length-1;U>=0;U--){if(R<=L)return;this._sounds[U]._ended&&(this._webAudio&&this._sounds[U]._node&&this._sounds[U]._node.disconnect(0),this._sounds.splice(U,1),R--)}}},_getSoundIds:function(L){if(L===void 0){for(var R=[],U=0;U<this._sounds.length;U++)R.push(this._sounds[U]._id);return R}return[L]},_refreshBuffer:function(L){return L._node.bufferSource=D.ctx.createBufferSource(),L._node.bufferSource.buffer=J[this._src],L._panner?L._node.bufferSource.connect(L._panner):L._node.bufferSource.connect(L._node),L._node.bufferSource.loop=L._loop,L._loop&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop||0),L._node.bufferSource.playbackRate.setValueAtTime(L._rate,D.ctx.currentTime),this},_cleanBuffer:function(L){var R=D._navigator&&D._navigator.vendor.indexOf("Apple")>=0;if(D._scratchBuffer&&L.bufferSource&&(L.bufferSource.onended=null,L.bufferSource.disconnect(0),R))try{L.bufferSource.buffer=D._scratchBuffer}catch{}return L.bufferSource=null,this},_clearSound:function(L){/MSIE |Trident\//.test(D._navigator&&D._navigator.userAgent)||(L.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var z=function(L){this._parent=L,this.init()};z.prototype={init:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,L._sounds.push(this),this.create(),this},create:function(){var L=this._parent,R=D._muted||this._muted||this._parent._muted?0:this._volume;return L._webAudio?(this._node=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),this._node.gain.setValueAtTime(R,D.ctx.currentTime),this._node.paused=!0,this._node.connect(D.masterGain)):D.noAudio||(this._node=D._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(D._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=L._src,this._node.preload=L._preload===!0?"auto":L._preload,this._node.volume=R*D.volume(),this._node.load()),this},reset:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var L=this._parent;L._duration=Math.ceil(10*this._node.duration)/10,Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue()),this._node.removeEventListener(D._canPlayEvent,this._loadFn,!1)},_endListener:function(){var L=this._parent;L._duration===1/0&&(L._duration=Math.ceil(10*this._node.duration)/10,L._sprite.__default[1]===1/0&&(L._sprite.__default[1]=1e3*L._duration),L._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var J={},X=function(L){var R=L._src;if(J[R])return L._duration=J[R].duration,void Rt(L);if(/^data:[^;]+;base64,/.test(R)){for(var U=atob(R.split(",")[1]),W=new Uint8Array(U.length),P=0;P<U.length;++P)W[P]=U.charCodeAt(P);ut(W.buffer,L)}else{var j=new XMLHttpRequest;j.open(L._xhr.method,R,!0),j.withCredentials=L._xhr.withCredentials,j.responseType="arraybuffer",L._xhr.headers&&Object.keys(L._xhr.headers).forEach(function($){j.setRequestHeader($,L._xhr.headers[$])}),j.onload=function(){var $=(j.status+"")[0];$==="0"||$==="2"||$==="3"?ut(j.response,L):L._emit("loaderror",null,"Failed loading audio file with status: "+j.status+".")},j.onerror=function(){L._webAudio&&(L._html5=!0,L._webAudio=!1,L._sounds=[],delete J[R],L.load())},et(j)}},et=function(L){try{L.send()}catch{L.onerror()}},ut=function(L,R){var U=function(){R._emit("loaderror",null,"Decoding audio data failed.")},W=function(P){P&&R._sounds.length>0?(J[R._src]=P,Rt(R,P)):U()};typeof Promise!="undefined"&&D.ctx.decodeAudioData.length===1?D.ctx.decodeAudioData(L).then(W).catch(U):D.ctx.decodeAudioData(L,W,U)},Rt=function(L,R){R&&!L._duration&&(L._duration=R.duration),Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue())},St=function(){if(D.usingWebAudio){try{typeof AudioContext!="undefined"?D.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?D.ctx=new webkitAudioContext:D.usingWebAudio=!1}catch{D.usingWebAudio=!1}D.ctx||(D.usingWebAudio=!1);var L=/iP(hone|od|ad)/.test(D._navigator&&D._navigator.platform),R=D._navigator&&D._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),U=R?parseInt(R[1],10):null;if(L&&U&&U<9){var W=/safari/.test(D._navigator&&D._navigator.userAgent.toLowerCase());D._navigator&&!W&&(D.usingWebAudio=!1)}D.usingWebAudio&&(D.masterGain=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),D.masterGain.gain.setValueAtTime(D._muted?0:D._volume,D.ctx.currentTime),D.masterGain.connect(D.ctx.destination)),D._setup()}};(S=function(){return{Howler:D,Howl:F}}.apply(E,[]))===void 0||(b.exports=S),E.Howler=D,E.Howl=F,O!==void 0?(O.HowlerGlobal=I,O.Howler=D,O.Howl=F,O.Sound=z):typeof window!="undefined"&&(window.HowlerGlobal=I,window.Howler=D,window.Howl=F,window.Sound=z)})(),function(){var I;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(F){if(!this.ctx||!this.ctx.listener)return this;for(var z=this._howls.length-1;z>=0;z--)this._howls[z].stereo(F);return this},HowlerGlobal.prototype.pos=function(F,z,J){return this.ctx&&this.ctx.listener?(z=typeof z!="number"?this._pos[1]:z,J=typeof J!="number"?this._pos[2]:J,typeof F!="number"?this._pos:(this._pos=[F,z,J],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(F,z,J,X,et,ut){if(!this.ctx||!this.ctx.listener)return this;var Rt=this._orientation;return z=typeof z!="number"?Rt[1]:z,J=typeof J!="number"?Rt[2]:J,X=typeof X!="number"?Rt[3]:X,et=typeof et!="number"?Rt[4]:et,ut=typeof ut!="number"?Rt[5]:ut,typeof F!="number"?Rt:(this._orientation=[F,z,J,X,et,ut],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(F,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(z,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(J,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(X,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(et,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(ut,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(F,z,J,X,et,ut),this)},Howl.prototype.init=(I=Howl.prototype.init,function(F){return this._orientation=F.orientation||[1,0,0],this._stereo=F.stereo||null,this._pos=F.pos||null,this._pannerAttr={coneInnerAngle:F.coneInnerAngle!==void 0?F.coneInnerAngle:360,coneOuterAngle:F.coneOuterAngle!==void 0?F.coneOuterAngle:360,coneOuterGain:F.coneOuterGain!==void 0?F.coneOuterGain:0,distanceModel:F.distanceModel!==void 0?F.distanceModel:"inverse",maxDistance:F.maxDistance!==void 0?F.maxDistance:1e4,panningModel:F.panningModel!==void 0?F.panningModel:"HRTF",refDistance:F.refDistance!==void 0?F.refDistance:1,rolloffFactor:F.rolloffFactor!==void 0?F.rolloffFactor:1},this._onstereo=F.onstereo?[{fn:F.onstereo}]:[],this._onpos=F.onpos?[{fn:F.onpos}]:[],this._onorientation=F.onorientation?[{fn:F.onorientation}]:[],I.call(this,F)}),Howl.prototype.stereo=function(F,z){var J=this;if(!J._webAudio)return J;if(J._state!=="loaded")return J._queue.push({event:"stereo",action:function(){J.stereo(F,z)}}),J;var X=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(z===void 0){if(typeof F!="number")return J._stereo;J._stereo=F,J._pos=[F,0,0]}for(var et=J._getSoundIds(z),ut=0;ut<et.length;ut++){var Rt=J._soundById(et[ut]);if(Rt){if(typeof F!="number")return Rt._stereo;Rt._stereo=F,Rt._pos=[F,0,0],Rt._node&&(Rt._pannerAttr.panningModel="equalpower",Rt._panner&&Rt._panner.pan||D(Rt,X),X==="spatial"?Rt._panner.positionX!==void 0?(Rt._panner.positionX.setValueAtTime(F,Howler.ctx.currentTime),Rt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Rt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Rt._panner.setPosition(F,0,0):Rt._panner.pan.setValueAtTime(F,Howler.ctx.currentTime)),J._emit("stereo",Rt._id)}}return J},Howl.prototype.pos=function(F,z,J,X){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"pos",action:function(){et.pos(F,z,J,X)}}),et;if(z=typeof z!="number"?0:z,J=typeof J!="number"?-.5:J,X===void 0){if(typeof F!="number")return et._pos;et._pos=[F,z,J]}for(var ut=et._getSoundIds(X),Rt=0;Rt<ut.length;Rt++){var St=et._soundById(ut[Rt]);if(St){if(typeof F!="number")return St._pos;St._pos=[F,z,J],St._node&&(St._panner&&!St._panner.pan||D(St,"spatial"),St._panner.positionX!==void 0?(St._panner.positionX.setValueAtTime(F,Howler.ctx.currentTime),St._panner.positionY.setValueAtTime(z,Howler.ctx.currentTime),St._panner.positionZ.setValueAtTime(J,Howler.ctx.currentTime)):St._panner.setPosition(F,z,J)),et._emit("pos",St._id)}}return et},Howl.prototype.orientation=function(F,z,J,X){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"orientation",action:function(){et.orientation(F,z,J,X)}}),et;if(z=typeof z!="number"?et._orientation[1]:z,J=typeof J!="number"?et._orientation[2]:J,X===void 0){if(typeof F!="number")return et._orientation;et._orientation=[F,z,J]}for(var ut=et._getSoundIds(X),Rt=0;Rt<ut.length;Rt++){var St=et._soundById(ut[Rt]);if(St){if(typeof F!="number")return St._orientation;St._orientation=[F,z,J],St._node&&(St._panner||(St._pos||(St._pos=et._pos||[0,0,-.5]),D(St,"spatial")),St._panner.orientationX!==void 0?(St._panner.orientationX.setValueAtTime(F,Howler.ctx.currentTime),St._panner.orientationY.setValueAtTime(z,Howler.ctx.currentTime),St._panner.orientationZ.setValueAtTime(J,Howler.ctx.currentTime)):St._panner.setOrientation(F,z,J)),et._emit("orientation",St._id)}}return et},Howl.prototype.pannerAttr=function(){var F,z,J,X=this,et=arguments;if(!X._webAudio)return X;if(et.length===0)return X._pannerAttr;if(et.length===1){if(typeof et[0]!="object")return(J=X._soundById(parseInt(et[0],10)))?J._pannerAttr:X._pannerAttr;F=et[0],z===void 0&&(F.pannerAttr||(F.pannerAttr={coneInnerAngle:F.coneInnerAngle,coneOuterAngle:F.coneOuterAngle,coneOuterGain:F.coneOuterGain,distanceModel:F.distanceModel,maxDistance:F.maxDistance,refDistance:F.refDistance,rolloffFactor:F.rolloffFactor,panningModel:F.panningModel}),X._pannerAttr={coneInnerAngle:F.pannerAttr.coneInnerAngle!==void 0?F.pannerAttr.coneInnerAngle:X._coneInnerAngle,coneOuterAngle:F.pannerAttr.coneOuterAngle!==void 0?F.pannerAttr.coneOuterAngle:X._coneOuterAngle,coneOuterGain:F.pannerAttr.coneOuterGain!==void 0?F.pannerAttr.coneOuterGain:X._coneOuterGain,distanceModel:F.pannerAttr.distanceModel!==void 0?F.pannerAttr.distanceModel:X._distanceModel,maxDistance:F.pannerAttr.maxDistance!==void 0?F.pannerAttr.maxDistance:X._maxDistance,refDistance:F.pannerAttr.refDistance!==void 0?F.pannerAttr.refDistance:X._refDistance,rolloffFactor:F.pannerAttr.rolloffFactor!==void 0?F.pannerAttr.rolloffFactor:X._rolloffFactor,panningModel:F.pannerAttr.panningModel!==void 0?F.pannerAttr.panningModel:X._panningModel})}else et.length===2&&(F=et[0],z=parseInt(et[1],10));for(var ut=X._getSoundIds(z),Rt=0;Rt<ut.length;Rt++)if(J=X._soundById(ut[Rt])){var St=J._pannerAttr;St={coneInnerAngle:F.coneInnerAngle!==void 0?F.coneInnerAngle:St.coneInnerAngle,coneOuterAngle:F.coneOuterAngle!==void 0?F.coneOuterAngle:St.coneOuterAngle,coneOuterGain:F.coneOuterGain!==void 0?F.coneOuterGain:St.coneOuterGain,distanceModel:F.distanceModel!==void 0?F.distanceModel:St.distanceModel,maxDistance:F.maxDistance!==void 0?F.maxDistance:St.maxDistance,refDistance:F.refDistance!==void 0?F.refDistance:St.refDistance,rolloffFactor:F.rolloffFactor!==void 0?F.rolloffFactor:St.rolloffFactor,panningModel:F.panningModel!==void 0?F.panningModel:St.panningModel};var L=J._panner;L?(L.coneInnerAngle=St.coneInnerAngle,L.coneOuterAngle=St.coneOuterAngle,L.coneOuterGain=St.coneOuterGain,L.distanceModel=St.distanceModel,L.maxDistance=St.maxDistance,L.refDistance=St.refDistance,L.rolloffFactor=St.rolloffFactor,L.panningModel=St.panningModel):(J._pos||(J._pos=X._pos||[0,0,-.5]),D(J,"spatial"))}return X},Sound.prototype.init=function(F){return function(){var z=this._parent;this._orientation=z._orientation,this._stereo=z._stereo,this._pos=z._pos,this._pannerAttr=z._pannerAttr,F.call(this),this._stereo?z.stereo(this._stereo):this._pos&&z.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(F){return function(){var z=this._parent;return this._orientation=z._orientation,this._stereo=z._stereo,this._pos=z._pos,this._pannerAttr=z._pannerAttr,this._stereo?z.stereo(this._stereo):this._pos?z.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,z._refreshBuffer(this)),F.call(this)}}(Sound.prototype.reset);var D=function(F,z){(z=z||"spatial")==="spatial"?(F._panner=Howler.ctx.createPanner(),F._panner.coneInnerAngle=F._pannerAttr.coneInnerAngle,F._panner.coneOuterAngle=F._pannerAttr.coneOuterAngle,F._panner.coneOuterGain=F._pannerAttr.coneOuterGain,F._panner.distanceModel=F._pannerAttr.distanceModel,F._panner.maxDistance=F._pannerAttr.maxDistance,F._panner.refDistance=F._pannerAttr.refDistance,F._panner.rolloffFactor=F._pannerAttr.rolloffFactor,F._panner.panningModel=F._pannerAttr.panningModel,F._panner.positionX!==void 0?(F._panner.positionX.setValueAtTime(F._pos[0],Howler.ctx.currentTime),F._panner.positionY.setValueAtTime(F._pos[1],Howler.ctx.currentTime),F._panner.positionZ.setValueAtTime(F._pos[2],Howler.ctx.currentTime)):F._panner.setPosition(F._pos[0],F._pos[1],F._pos[2]),F._panner.orientationX!==void 0?(F._panner.orientationX.setValueAtTime(F._orientation[0],Howler.ctx.currentTime),F._panner.orientationY.setValueAtTime(F._orientation[1],Howler.ctx.currentTime),F._panner.orientationZ.setValueAtTime(F._orientation[2],Howler.ctx.currentTime)):F._panner.setOrientation(F._orientation[0],F._orientation[1],F._orientation[2])):(F._panner=Howler.ctx.createStereoPanner(),F._panner.pan.setValueAtTime(F._stereo,Howler.ctx.currentTime)),F._panner.connect(F._node),F._paused||F._parent.pause(F._id,!0).play(F._id,!0)}}()}).call(this,v(17))},function(b,E){b.exports=`varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform sampler2D uSampler;
void main() {
	vec4 outputColor;
	float percent = vPercent;
	float direction = vDirection;
	if (vTransition < 0.0) {
		percent = 1.0 - percent;
		if ((vDirection > 1.5) && (vDirection < 2.5)) {
			direction = 1.0;
		}
		else if ((vDirection > 0.5) && (vDirection < 1.5)) {
			direction = 2.0;
		}
		else if ((vDirection > 2.5) && (vDirection < 3.5)) {
			direction = 4.0;
		}
		else {
			direction = 3.0;
		}
	}
	if ((direction > 1.5) && (direction < 2.5)) {
		if (vVertexPosition.y >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y >= (1.0 - percent)) && (vVertexPosition.y <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
		}
	}
	else if ((direction > 0.5) && (direction < 1.5)) {
		if (vVertexPosition.y <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y <= percent) && (vVertexPosition.y >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.y - (percent - 0.2)) / 0.2));
		}
	}
	else if ((direction > 2.5) && (direction < 3.5)) {
		if (vVertexPosition.x <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x <= percent) && (vVertexPosition.x >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.x - (percent - 0.2)) / 0.2));
		}
	}
	else {
		if (vVertexPosition.x >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x >= (1.0 - percent)) && (vVertexPosition.x <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
		}
	}
	gl_FragColor = outputColor;
}
`},function(b,E){b.exports=`attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord(vec2 aVertexPosition) {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	vTransition = transition;
	vDirection = direction;
	vPercent = percent;
	vVertexPosition = aVertexPosition;
	vec2 localVertexPosition = aVertexPosition;
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord(localVertexPosition);
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
uniform float transition;
void main() {
	float alpha = (transition * (percent - 0.5)) + 0.5;
	vec4 color1 = texture2D(uSampler, vTextureCoord);
	gl_FragColor = color1 * alpha;
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float barWidth = (option < 0.5 ? uBoundRect.w : uBoundRect.z) / barCount;
	float alphaWidthPercent = 0.03;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.w : uBoundRect.z);
	float selectAxis = option < 0.5 ? -position.y : -position.x;
	float countAxis = floor(selectAxis / barWidth);
	float modAxis = mod(selectAxis, barWidth);
	float timePosition = barWidth * timePercent;
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float horizontalBarWidth = uBoundRect.z / barCount;
	float verticalBarWidth = uBoundRect.w / barCount;
	float alphaWidthPercent = 0.01;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.z : uBoundRect.w);
	float timePosition = horizontalBarWidth * timePercent;
	float countAxisY = floor(-position.y / verticalBarWidth);
	float modAxisY = mod(-position.y, verticalBarWidth);
	float countAxisX = floor(-position.x / horizontalBarWidth);
	float modAxisX = mod(-position.x, horizontalBarWidth);
	float modAxis = modAxisX;
	if (option < 0.5) {
		if (mod(countAxisY, 2.0) > 0.5) {
			countAxisX = floor(((horizontalBarWidth * 0.5) - position.x) / horizontalBarWidth);
			modAxisX = mod((horizontalBarWidth * 0.5) - position.x, horizontalBarWidth);
		}
		modAxis = modAxisX;
	}
	else {
		if (mod(countAxisX, 2.0) > 0.5) {
			countAxisY = floor(((verticalBarWidth * 0.5) - position.y) / verticalBarWidth);
			modAxisY = mod((verticalBarWidth * 0.5) - position.y, verticalBarWidth);
		}
		modAxis = modAxisY;
	}
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	float splitWidth = max(uBoundRect.z, uBoundRect.w) / 3.0;
	vec2 position = mod(filterCoord.xy, splitWidth);
	vec2 loopTime = floor(filterCoord.xy / splitWidth);
	if (loopTime.x > 0.5) {
		position.x = splitWidth - position.x;
	}
	if (loopTime.y > 0.5) {
		position.y = splitWidth - position.y;
	}
	vec4 dissolveColor = texture2D(dissolveSampler, position.xy / splitWidth);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	if (dissolveColor.r < percent) {
		gl_FragColor = outputColor;
	}
	else {
		gl_FragColor = vec4(0, 0, 0, 0);
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	vec4 dissolveColor;
	if (option > 0.5) {
		dissolveColor = texture2D(dissolveSampler, vec2(vTextureCoord.x, 0.0));
	}
	else {
		dissolveColor = texture2D(dissolveSampler, vec2(0.0, vTextureCoord.y));
	}
	if (transition > .0) {
		if (dissolveColor.r < percent) {
			gl_FragColor = outputColor;
		}
		else {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
	}
	else {
		if (dissolveColor.r < percent) {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		else {
			gl_FragColor = outputColor;
		}
	}
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	float radius = sqrt(pow(uBoundRect.z, 2.0) + pow(uBoundRect.w, 2.0)) / 2.0;
	float alphaWidth = 0.1;
	float pointDistance = sqrt(pow(point.x, 2.0) + pow(point.y, 2.0));
	float alphaRadiusFormula;
	if (option > 0.5) {
		if (transition > 0.0) {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * timePercent)) / (alphaWidth * radius));
		}
		else {
			alphaRadiusFormula = (pointDistance - (radius * timePercent)) / (alphaWidth * radius);
		}
	}
	else {
		if (transition > 0.0) {
			alphaRadiusFormula = (pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius);
		}
		else {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius));
		}
	}
	if (option > 0.5) {
		if (pointDistance < (radius * timePercent)) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if (pointDistance < (radius * (timePercent + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
	else {
		if (pointDistance < (radius * (1.0 - timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if (pointDistance < (radius * ((1.0 - timePercent) + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.2;
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 absPoint = abs(point.xy);
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (option < 0.5) {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.x : alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.y : alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
	else {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.x : 1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.y : 1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), (uBoundRect.w / 2.0) - filterCoord.y);
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	float rightTop = (((2.0 * uBoundRect.w) * timePercent) - ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float rightBottom = (((uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	float leftTop = (((2.0 * uBoundRect.w) * timePercent) + ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float leftBottom = (((-uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (-rightTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * rightBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (-leftTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * leftBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
	}
	else {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (rightTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (rightBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (leftTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (leftBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
	}
}
`},function(b,E){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = (outputColor * (1.0 - alphaFormula.x)) * (1.0 - alphaFormula.y);
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * (1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = outputColor;
		}
	}
	else {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = outputColor;
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = outputColor * (1.0 - ((1.0 - alphaFormula.x) * (1.0 - alphaFormula.y)));
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * alphaFormula.x;
			}
			else {
				gl_FragColor = outputColor * alphaFormula.y;
			}
		}
		else {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	float alphaWidth = 0.1;
	float timePercent = percent;
	if (option < 1.5) {
		timePercent = 1.0 - timePercent;
	}
	float axis = (option > 0.5) && (option < 2.5) ? absPoint.y : absPoint.x;
	float compareAxis = (option > 0.5) && (option < 2.5) ? halfRect.y : halfRect.x;
	float alphaColor = abs(((timePercent * compareAxis) - axis) / (alphaWidth * compareAxis));
	vec4 beginColor;
	vec4 endColor;
	if ((option > 1.5) && (option < 3.5)) {
		if (transition < 0.0) {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
		else {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
	}
	else {
		if (transition < 0.0) {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
		else {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
	}
	if (axis < (timePercent * compareAxis)) {
		gl_FragColor = beginColor;
	}
	else if (axis < ((timePercent + alphaWidth) * compareAxis)) {
		gl_FragColor = outputColor * alphaColor;
	}
	else {
		gl_FragColor = endColor;
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x, filterCoord.y);
	if ((option > 0.5) && (option < 1.5)) {
		point = filterCoord.xy;
	}
	else if ((option > 1.5) && (option < 2.5)) {
		point = uBoundRect.zw - point.xy;
	}
	else if ((option > 2.5) && (option < 3.5)) {
		point = vec2(uBoundRect.z - filterCoord.x, filterCoord.y);
	}
	else {
		point = vec2(filterCoord.x, uBoundRect.w - filterCoord.y);
	}
	float squareCount = 16.0;
	float horzBarWidth = uBoundRect.z / squareCount;
	float verticalBarWidth = uBoundRect.w / squareCount;
	float horzCount = floor(point.x / horzBarWidth);
	float verticalCount = floor(point.y / verticalBarWidth);
	float timePercent = (percent * squareCount) * 2.5;
	vec4 alphaStage;
	if (transition > 0.0) {
		alphaStage = vec4(0.2, 0.4, 0.6, 0.8);
	}
	else {
		alphaStage = vec4(0.8, 0.6, 0.4, 0.2);
	}
	if ((horzCount + verticalCount) < (timePercent - 4.0)) {
		gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
	}
	else if ((horzCount + verticalCount) < (timePercent - 3.0)) {
		gl_FragColor = outputColor * alphaStage.w;
	}
	else if ((horzCount + verticalCount) < (timePercent - 2.0)) {
		gl_FragColor = outputColor * alphaStage.z;
	}
	else if ((horzCount + verticalCount) < (timePercent - 1.0)) {
		gl_FragColor = outputColor * alphaStage.y;
	}
	else if ((horzCount + verticalCount) < timePercent) {
		gl_FragColor = outputColor * alphaStage.x;
	}
	else {
		gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	float alphaBarArcWidth = 0.3;
	float timePercent = (percent * PI) * (1.0 + alphaBarArcWidth);
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,E){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	if (point.x < 0.0) {
		arc = (2.0 * PI) - arc;
	}
	arc = arc == 0.0 ? arc : mod(arc, (2.0 * PI) / option);
	float totalAlphaBarArcWidth = 0.75;
	float alphaBarArcWidth = totalAlphaBarArcWidth / option;
	float timePercent = ((percent * PI) * (2.0 + totalAlphaBarArcWidth)) / option;
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,E,v){var O=v(150);b.exports=function(S,I){return O(S,I)}},function(b,E,v){var O=v(25),S=Object.prototype,I=S.hasOwnProperty,D=S.toString,F=O?O.toStringTag:void 0;b.exports=function(z){var J=I.call(z,F),X=z[F];try{z[F]=void 0;var et=!0}catch{}var ut=D.call(z);return et&&(J?z[F]=X:delete z[F]),ut}},function(b,E){var v=Object.prototype.toString;b.exports=function(O){return v.call(O)}},function(b,E,v){(function(O){var S=v(108),I=v(111),D=v.n(I);/*!
 * @pixi/polyfill - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(typeof globalThis=="undefined"&&(typeof self!="undefined"?self.globalThis=self:O!==void 0&&(O.globalThis=O)),globalThis.Promise||(globalThis.Promise=S.a),Object.assign||(Object.assign=D.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!globalThis.performance||!globalThis.performance.now){var F=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-F}}for(var z=Date.now(),J=["ms","moz","webkit","o"],X=0;X<J.length&&!globalThis.requestAnimationFrame;++X){var et=J[X];globalThis.requestAnimationFrame=globalThis[et+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[et+"CancelAnimationFrame"]||globalThis[et+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(ut){if(typeof ut!="function")throw new TypeError(ut+"is not a function");var Rt=Date.now(),St=16+z-Rt;return St<0&&(St=0),z=Rt,globalThis.self.setTimeout(function(){z=Date.now(),ut(performance.now())},St)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(ut){return clearTimeout(ut)}),Math.sign||(Math.sign=function(ut){return(ut=Number(ut))===0||isNaN(ut)?ut:ut>0?1:-1}),Number.isInteger||(Number.isInteger=function(ut){return typeof ut=="number"&&isFinite(ut)&&Math.floor(ut)===ut}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array)}).call(this,v(17))},function(b,E,v){(function(O){var S=O!==void 0&&O||typeof self!="undefined"&&self||window,I=Function.prototype.apply;function D(F,z){this._id=F,this._clearFn=z}E.setTimeout=function(){return new D(I.call(setTimeout,S,arguments),clearTimeout)},E.setInterval=function(){return new D(I.call(setInterval,S,arguments),clearInterval)},E.clearTimeout=E.clearInterval=function(F){F&&F.close()},D.prototype.unref=D.prototype.ref=function(){},D.prototype.close=function(){this._clearFn.call(S,this._id)},E.enroll=function(F,z){clearTimeout(F._idleTimeoutId),F._idleTimeout=z},E.unenroll=function(F){clearTimeout(F._idleTimeoutId),F._idleTimeout=-1},E._unrefActive=E.active=function(F){clearTimeout(F._idleTimeoutId);var z=F._idleTimeout;z>=0&&(F._idleTimeoutId=setTimeout(function(){F._onTimeout&&F._onTimeout()},z))},v(141),E.setImmediate=typeof self!="undefined"&&self.setImmediate||O!==void 0&&O.setImmediate||this&&this.setImmediate,E.clearImmediate=typeof self!="undefined"&&self.clearImmediate||O!==void 0&&O.clearImmediate||this&&this.clearImmediate}).call(this,v(17))},function(b,E,v){(function(O,S){(function(I,D){if(!I.setImmediate){var F,z,J,X,et,ut=1,Rt={},St=!1,L=I.document,R=Object.getPrototypeOf&&Object.getPrototypeOf(I);R=R&&R.setTimeout?R:I,{}.toString.call(I.process)==="[object process]"?F=function(P){S.nextTick(function(){W(P)})}:function(){if(I.postMessage&&!I.importScripts){var P=!0,j=I.onmessage;return I.onmessage=function(){P=!1},I.postMessage("","*"),I.onmessage=j,P}}()?(X="setImmediate$"+Math.random()+"$",et=function(P){P.source===I&&typeof P.data=="string"&&P.data.indexOf(X)===0&&W(+P.data.slice(X.length))},I.addEventListener?I.addEventListener("message",et,!1):I.attachEvent("onmessage",et),F=function(P){I.postMessage(X+P,"*")}):I.MessageChannel?((J=new MessageChannel).port1.onmessage=function(P){W(P.data)},F=function(P){J.port2.postMessage(P)}):L&&"onreadystatechange"in L.createElement("script")?(z=L.documentElement,F=function(P){var j=L.createElement("script");j.onreadystatechange=function(){W(P),j.onreadystatechange=null,z.removeChild(j),j=null},z.appendChild(j)}):F=function(P){setTimeout(W,0,P)},R.setImmediate=function(P){typeof P!="function"&&(P=new Function(""+P));for(var j=new Array(arguments.length-1),$=0;$<j.length;$++)j[$]=arguments[$+1];var H={callback:P,args:j};return Rt[ut]=H,F(ut),ut++},R.clearImmediate=U}function U(P){delete Rt[P]}function W(P){if(St)setTimeout(W,0,P);else{var j=Rt[P];if(j){St=!0;try{(function($){var H=$.callback,Nt=$.args;switch(Nt.length){case 0:H();break;case 1:H(Nt[0]);break;case 2:H(Nt[0],Nt[1]);break;case 3:H(Nt[0],Nt[1],Nt[2]);break;default:H.apply(void 0,Nt)}})(j)}finally{U(P),St=!1}}}}})(typeof self=="undefined"?O===void 0?this:O:self)}).call(this,v(17),v(142))},function(b,E){var v,O,S=b.exports={};function I(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function F(R){if(v===setTimeout)return setTimeout(R,0);if((v===I||!v)&&setTimeout)return v=setTimeout,setTimeout(R,0);try{return v(R,0)}catch{try{return v.call(null,R,0)}catch{return v.call(this,R,0)}}}(function(){try{v=typeof setTimeout=="function"?setTimeout:I}catch{v=I}try{O=typeof clearTimeout=="function"?clearTimeout:D}catch{O=D}})();var z,J=[],X=!1,et=-1;function ut(){X&&z&&(X=!1,z.length?J=z.concat(J):et=-1,J.length&&Rt())}function Rt(){if(!X){var R=F(ut);X=!0;for(var U=J.length;U;){for(z=J,J=[];++et<U;)z&&z[et].run();et=-1,U=J.length}z=null,X=!1,function(W){if(O===clearTimeout)return clearTimeout(W);if((O===D||!O)&&clearTimeout)return O=clearTimeout,clearTimeout(W);try{O(W)}catch{try{return O.call(null,W)}catch{return O.call(this,W)}}}(R)}}function St(R,U){this.fun=R,this.array=U}function L(){}S.nextTick=function(R){var U=new Array(arguments.length-1);if(arguments.length>1)for(var W=1;W<arguments.length;W++)U[W-1]=arguments[W];J.push(new St(R,U)),J.length!==1||X||F(Rt)},St.prototype.run=function(){this.fun.apply(null,this.array)},S.title="browser",S.browser=!0,S.env={},S.argv=[],S.version="",S.versions={},S.on=L,S.addListener=L,S.once=L,S.off=L,S.removeListener=L,S.removeAllListeners=L,S.emit=L,S.prependListener=L,S.prependOnceListener=L,S.listeners=function(R){return[]},S.binding=function(R){throw new Error("process.binding is not supported")},S.cwd=function(){return"/"},S.chdir=function(R){throw new Error("process.chdir is not supported")},S.umask=function(){return 0}},function(b,E,v){(function(O,S){var I;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(D){E&&E.nodeType,O&&O.nodeType;var F=typeof S=="object"&&S;F.global!==F&&F.window!==F&&F.self;var z,J=2147483647,X=/^xn--/,et=/[^\x20-\x7E]/,ut=/[\x2E\u3002\uFF0E\uFF61]/g,Rt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},St=Math.floor,L=String.fromCharCode;function R(st){throw new RangeError(Rt[st])}function U(st,V){for(var B=st.length,ft=[];B--;)ft[B]=V(st[B]);return ft}function W(st,V){var B=st.split("@"),ft="";return B.length>1&&(ft=B[0]+"@",st=B[1]),ft+U((st=st.replace(ut,".")).split("."),V).join(".")}function P(st){for(var V,B,ft=[],tt=0,vt=st.length;tt<vt;)(V=st.charCodeAt(tt++))>=55296&&V<=56319&&tt<vt?(64512&(B=st.charCodeAt(tt++)))==56320?ft.push(((1023&V)<<10)+(1023&B)+65536):(ft.push(V),tt--):ft.push(V);return ft}function j(st){return U(st,function(V){var B="";return V>65535&&(B+=L((V-=65536)>>>10&1023|55296),V=56320|1023&V),B+=L(V)}).join("")}function $(st,V){return st+22+75*(st<26)-((V!=0)<<5)}function H(st,V,B){var ft=0;for(st=B?St(st/700):st>>1,st+=St(st/V);st>455;ft+=36)st=St(st/35);return St(ft+36*st/(st+38))}function Nt(st){var V,B,ft,tt,vt,Dt,Z,pt,rt,_t,Et,Gt=[],Xt=st.length,Jt=0,at=128,_e=72;for((B=st.lastIndexOf("-"))<0&&(B=0),ft=0;ft<B;++ft)st.charCodeAt(ft)>=128&&R("not-basic"),Gt.push(st.charCodeAt(ft));for(tt=B>0?B+1:0;tt<Xt;){for(vt=Jt,Dt=1,Z=36;tt>=Xt&&R("invalid-input"),((pt=(Et=st.charCodeAt(tt++))-48<10?Et-22:Et-65<26?Et-65:Et-97<26?Et-97:36)>=36||pt>St((J-Jt)/Dt))&&R("overflow"),Jt+=pt*Dt,!(pt<(rt=Z<=_e?1:Z>=_e+26?26:Z-_e));Z+=36)Dt>St(J/(_t=36-rt))&&R("overflow"),Dt*=_t;_e=H(Jt-vt,V=Gt.length+1,vt==0),St(Jt/V)>J-at&&R("overflow"),at+=St(Jt/V),Jt%=V,Gt.splice(Jt++,0,at)}return j(Gt)}function Vt(st){var V,B,ft,tt,vt,Dt,Z,pt,rt,_t,Et,Gt,Xt,Jt,at,_e=[];for(Gt=(st=P(st)).length,V=128,B=0,vt=72,Dt=0;Dt<Gt;++Dt)(Et=st[Dt])<128&&_e.push(L(Et));for(ft=tt=_e.length,tt&&_e.push("-");ft<Gt;){for(Z=J,Dt=0;Dt<Gt;++Dt)(Et=st[Dt])>=V&&Et<Z&&(Z=Et);for(Z-V>St((J-B)/(Xt=ft+1))&&R("overflow"),B+=(Z-V)*Xt,V=Z,Dt=0;Dt<Gt;++Dt)if((Et=st[Dt])<V&&++B>J&&R("overflow"),Et==V){for(pt=B,rt=36;!(pt<(_t=rt<=vt?1:rt>=vt+26?26:rt-vt));rt+=36)at=pt-_t,Jt=36-_t,_e.push(L($(_t+at%Jt,0))),pt=St(at/Jt);_e.push(L($(pt,0))),vt=H(B,Xt,ft==tt),B=0,++ft}++B,++V}return _e.join("")}z={version:"1.4.1",ucs2:{decode:P,encode:j},decode:Nt,encode:Vt,toASCII:function(st){return W(st,function(V){return et.test(V)?"xn--"+Vt(V):V})},toUnicode:function(st){return W(st,function(V){return X.test(V)?Nt(V.slice(4).toLowerCase()):V})}},(I=function(){return z}.call(E,v,E,O))===void 0||(O.exports=I)})()}).call(this,v(26)(b),v(17))},function(b,E,v){b.exports={isString:function(O){return typeof O=="string"},isObject:function(O){return typeof O=="object"&&O!==null},isNull:function(O){return O===null},isNullOrUndefined:function(O){return O==null}}},function(b,E,v){E.decode=E.parse=v(146),E.encode=E.stringify=v(147)},function(b,E,v){function O(I,D){return Object.prototype.hasOwnProperty.call(I,D)}b.exports=function(I,D,F,z){D=D||"&",F=F||"=";var J={};if(typeof I!="string"||I.length===0)return J;var X=/\+/g;I=I.split(D);var et=1e3;z&&typeof z.maxKeys=="number"&&(et=z.maxKeys);var ut=I.length;et>0&&ut>et&&(ut=et);for(var Rt=0;Rt<ut;++Rt){var St,L,R,U,W=I[Rt].replace(X,"%20"),P=W.indexOf(F);P>=0?(St=W.substr(0,P),L=W.substr(P+1)):(St=W,L=""),R=decodeURIComponent(St),U=decodeURIComponent(L),O(J,R)?S(J[R])?J[R].push(U):J[R]=[J[R],U]:J[R]=U}return J};var S=Array.isArray||function(I){return Object.prototype.toString.call(I)==="[object Array]"}},function(b,E,v){var O=function(F){switch(typeof F){case"string":return F;case"boolean":return F?"true":"false";case"number":return isFinite(F)?F:"";default:return""}};b.exports=function(F,z,J,X){return z=z||"&",J=J||"=",F===null&&(F=void 0),typeof F=="object"?I(D(F),function(et){var ut=encodeURIComponent(O(et))+J;return S(F[et])?I(F[et],function(Rt){return ut+encodeURIComponent(O(Rt))}).join(z):ut+encodeURIComponent(O(F[et]))}).join(z):X?encodeURIComponent(O(X))+J+encodeURIComponent(O(F)):""};var S=Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"};function I(F,z){if(F.map)return F.map(z);for(var J=[],X=0;X<F.length;X++)J.push(z(F[X],X));return J}var D=Object.keys||function(F){var z=[];for(var J in F)Object.prototype.hasOwnProperty.call(F,J)&&z.push(J);return z}},function(b,E){var v=function(){};v.prototype={fit:function(O){var S,I,D,F,z=O.length,J=z>0?O[0].width:0,X=z>0?O[0].height:0;for(this.root={x:0,y:0,width:J,height:X},S=0;S<z;S++)D=O[S],(I=this.findNode(this.root,D.width,D.height))?(F=this.splitNode(I,D.width,D.height),D.x=F.x,D.y=F.y):(F=this.growNode(D.width,D.height),D.x=F.x,D.y=F.y)},findNode:function(O,S,I){return O.used?this.findNode(O.right,S,I)||this.findNode(O.down,S,I):S<=O.width&&I<=O.height?O:null},splitNode:function(O,S,I){return O.used=!0,O.down={x:O.x,y:O.y+I,width:O.width,height:O.height-I},O.right={x:O.x+S,y:O.y,width:O.width-S,height:I},O},growNode:function(O,S){var I=O<=this.root.width,D=S<=this.root.height,F=D&&this.root.height>=this.root.width+O,z=I&&this.root.width>=this.root.height+S;return F?this.growRight(O,S):z?this.growDown(O,S):D?this.growRight(O,S):I?this.growDown(O,S):null},growRight:function(O,S){var I;return this.root={used:!0,x:0,y:0,width:this.root.width+O,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:O,height:this.root.height}},(I=this.findNode(this.root,O,S))?this.splitNode(I,O,S):null},growDown:function(O,S){var I;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+S,down:{x:0,y:this.root.height,width:this.root.width,height:S},right:this.root},(I=this.findNode(this.root,O,S))?this.splitNode(I,O,S):null}},b.exports=v},function(b,E){(function(v){b.exports=v}).call(this,{})},function(b,E,v){var O=v(151),S=v(15);b.exports=function I(D,F,z,J,X){return D===F||(D==null||F==null||!S(D)&&!S(F)?D!=D&&F!=F:O(D,F,z,J,I,X))}},function(b,E,v){var O=v(54),S=v(57),I=v(183),D=v(186),F=v(32),z=v(31),J=v(41),X=v(64),et="[object Object]",ut=Object.prototype.hasOwnProperty;b.exports=function(Rt,St,L,R,U,W){var P=z(Rt),j=z(St),$=P?"[object Array]":F(Rt),H=j?"[object Array]":F(St),Nt=($=$=="[object Arguments]"?et:$)==et,Vt=(H=H=="[object Arguments]"?et:H)==et,st=$==H;if(st&&J(Rt)){if(!J(St))return!1;P=!0,Nt=!1}if(st&&!Nt)return W||(W=new O),P||X(Rt)?S(Rt,St,L,R,U,W):I(Rt,St,$,L,R,U,W);if(!(1&L)){var V=Nt&&ut.call(Rt,"__wrapped__"),B=Vt&&ut.call(St,"__wrapped__");if(V||B){var ft=V?Rt.value():Rt,tt=B?St.value():St;return W||(W=new O),U(ft,tt,L,R,W)}}return!!st&&(W||(W=new O),D(Rt,St,L,R,U,W))}},function(b,E){b.exports=function(){this.__data__=[],this.size=0}},function(b,E,v){var O=v(28),S=Array.prototype.splice;b.exports=function(I){var D=this.__data__,F=O(D,I);return!(F<0)&&(F==D.length-1?D.pop():S.call(D,F,1),--this.size,!0)}},function(b,E,v){var O=v(28);b.exports=function(S){var I=this.__data__,D=O(I,S);return D<0?void 0:I[D][1]}},function(b,E,v){var O=v(28);b.exports=function(S){return O(this.__data__,S)>-1}},function(b,E,v){var O=v(28);b.exports=function(S,I){var D=this.__data__,F=O(D,S);return F<0?(++this.size,D.push([S,I])):D[F][1]=I,this}},function(b,E,v){var O=v(27);b.exports=function(){this.__data__=new O,this.size=0}},function(b,E){b.exports=function(v){var O=this.__data__,S=O.delete(v);return this.size=O.size,S}},function(b,E){b.exports=function(v){return this.__data__.get(v)}},function(b,E){b.exports=function(v){return this.__data__.has(v)}},function(b,E,v){var O=v(27),S=v(38),I=v(56);b.exports=function(D,F){var z=this.__data__;if(z instanceof O){var J=z.__data__;if(!S||J.length<199)return J.push([D,F]),this.size=++z.size,this;z=this.__data__=new I(J)}return z.set(D,F),this.size=z.size,this}},function(b,E,v){var O=v(34),S=v(163),I=v(21),D=v(55),F=/^\[object .+?Constructor\]$/,z=Function.prototype,J=Object.prototype,X=z.toString,et=J.hasOwnProperty,ut=RegExp("^"+X.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=function(Rt){return!(!I(Rt)||S(Rt))&&(O(Rt)?ut:F).test(D(Rt))}},function(b,E,v){var O,S=v(164),I=(O=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";b.exports=function(D){return!!I&&I in D}},function(b,E,v){var O=v(14)["__core-js_shared__"];b.exports=O},function(b,E){b.exports=function(v,O){return v==null?void 0:v[O]}},function(b,E,v){var O=v(167),S=v(27),I=v(38);b.exports=function(){this.size=0,this.__data__={hash:new O,map:new(I||S),string:new O}}},function(b,E,v){var O=v(168),S=v(169),I=v(170),D=v(171),F=v(172);function z(J){var X=-1,et=J==null?0:J.length;for(this.clear();++X<et;){var ut=J[X];this.set(ut[0],ut[1])}}z.prototype.clear=O,z.prototype.delete=S,z.prototype.get=I,z.prototype.has=D,z.prototype.set=F,b.exports=z},function(b,E,v){var O=v(29);b.exports=function(){this.__data__=O?O(null):{},this.size=0}},function(b,E){b.exports=function(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}},function(b,E,v){var O=v(29),S=Object.prototype.hasOwnProperty;b.exports=function(I){var D=this.__data__;if(O){var F=D[I];return F==="__lodash_hash_undefined__"?void 0:F}return S.call(D,I)?D[I]:void 0}},function(b,E,v){var O=v(29),S=Object.prototype.hasOwnProperty;b.exports=function(I){var D=this.__data__;return O?D[I]!==void 0:S.call(D,I)}},function(b,E,v){var O=v(29);b.exports=function(S,I){var D=this.__data__;return this.size+=this.has(S)?0:1,D[S]=O&&I===void 0?"__lodash_hash_undefined__":I,this}},function(b,E,v){var O=v(30);b.exports=function(S){var I=O(this,S).delete(S);return this.size-=I?1:0,I}},function(b,E){b.exports=function(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}},function(b,E,v){var O=v(30);b.exports=function(S){return O(this,S).get(S)}},function(b,E,v){var O=v(30);b.exports=function(S){return O(this,S).has(S)}},function(b,E,v){var O=v(30);b.exports=function(S,I){var D=O(this,S),F=D.size;return D.set(S,I),this.size+=D.size==F?0:1,this}},function(b,E,v){var O=v(56),S=v(179),I=v(180);function D(F){var z=-1,J=F==null?0:F.length;for(this.__data__=new O;++z<J;)this.add(F[z])}D.prototype.add=D.prototype.push=S,D.prototype.has=I,b.exports=D},function(b,E){b.exports=function(v){return this.__data__.set(v,"__lodash_hash_undefined__"),this}},function(b,E){b.exports=function(v){return this.__data__.has(v)}},function(b,E){b.exports=function(v,O){for(var S=-1,I=v==null?0:v.length;++S<I;)if(O(v[S],S,v))return!0;return!1}},function(b,E){b.exports=function(v,O){return v.has(O)}},function(b,E,v){var O=v(25),S=v(58),I=v(37),D=v(57),F=v(184),z=v(185),J=O?O.prototype:void 0,X=J?J.valueOf:void 0;b.exports=function(et,ut,Rt,St,L,R,U){switch(Rt){case"[object DataView]":if(et.byteLength!=ut.byteLength||et.byteOffset!=ut.byteOffset)return!1;et=et.buffer,ut=ut.buffer;case"[object ArrayBuffer]":return!(et.byteLength!=ut.byteLength||!R(new S(et),new S(ut)));case"[object Boolean]":case"[object Date]":case"[object Number]":return I(+et,+ut);case"[object Error]":return et.name==ut.name&&et.message==ut.message;case"[object RegExp]":case"[object String]":return et==ut+"";case"[object Map]":var W=F;case"[object Set]":var P=1&St;if(W||(W=z),et.size!=ut.size&&!P)return!1;var j=U.get(et);if(j)return j==ut;St|=2,U.set(et,ut);var $=D(W(et),W(ut),St,L,R,U);return U.delete(et),$;case"[object Symbol]":if(X)return X.call(et)==X.call(ut)}return!1}},function(b,E){b.exports=function(v){var O=-1,S=Array(v.size);return v.forEach(function(I,D){S[++O]=[D,I]}),S}},function(b,E){b.exports=function(v){var O=-1,S=Array(v.size);return v.forEach(function(I){S[++O]=I}),S}},function(b,E,v){var O=v(59),S=Object.prototype.hasOwnProperty;b.exports=function(I,D,F,z,J,X){var et=1&F,ut=O(I),Rt=ut.length;if(Rt!=O(D).length&&!et)return!1;for(var St=Rt;St--;){var L=ut[St];if(!(et?L in D:S.call(D,L)))return!1}var R=X.get(I),U=X.get(D);if(R&&U)return R==D&&U==I;var W=!0;X.set(I,D),X.set(D,I);for(var P=et;++St<Rt;){var j=I[L=ut[St]],$=D[L];if(z)var H=et?z($,j,L,D,I,X):z(j,$,L,I,D,X);if(!(H===void 0?j===$||J(j,$,F,z,X):H)){W=!1;break}P||(P=L=="constructor")}if(W&&!P){var Nt=I.constructor,Vt=D.constructor;Nt==Vt||!("constructor"in I)||!("constructor"in D)||typeof Nt=="function"&&Nt instanceof Nt&&typeof Vt=="function"&&Vt instanceof Vt||(W=!1)}return X.delete(I),X.delete(D),W}},function(b,E){b.exports=function(v,O){for(var S=-1,I=v==null?0:v.length,D=0,F=[];++S<I;){var z=v[S];O(z,S,v)&&(F[D++]=z)}return F}},function(b,E){b.exports=function(v,O){for(var S=-1,I=Array(v);++S<v;)I[S]=O(S);return I}},function(b,E,v){var O=v(190),S=v(15),I=Object.prototype,D=I.hasOwnProperty,F=I.propertyIsEnumerable,z=O(function(){return arguments}())?O:function(J){return S(J)&&D.call(J,"callee")&&!F.call(J,"callee")};b.exports=z},function(b,E,v){var O=v(20),S=v(15);b.exports=function(I){return S(I)&&O(I)=="[object Arguments]"}},function(b,E){b.exports=function(){return!1}},function(b,E){var v=/^(?:0|[1-9]\d*)$/;b.exports=function(O,S){var I=typeof O;return!!(S=S==null?9007199254740991:S)&&(I=="number"||I!="symbol"&&v.test(O))&&O>-1&&O%1==0&&O<S}},function(b,E,v){var O=v(20),S=v(65),I=v(15),D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Arguments]"]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object Boolean]"]=D["[object DataView]"]=D["[object Date]"]=D["[object Error]"]=D["[object Function]"]=D["[object Map]"]=D["[object Number]"]=D["[object Object]"]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object WeakMap]"]=!1,b.exports=function(F){return I(F)&&S(F.length)&&!!D[O(F)]}},function(b,E,v){var O=v(44),S=v(195),I=Object.prototype.hasOwnProperty;b.exports=function(D){if(!O(D))return S(D);var F=[];for(var z in Object(D))I.call(D,z)&&z!="constructor"&&F.push(z);return F}},function(b,E,v){var O=v(66)(Object.keys,Object);b.exports=O},function(b,E,v){var O=v(22)(v(14),"DataView");b.exports=O},function(b,E,v){var O=v(22)(v(14),"Promise");b.exports=O},function(b,E,v){var O=v(22)(v(14),"Set");b.exports=O},function(b,E,v){var O=v(22)(v(14),"WeakMap");b.exports=O},function(b,E,v){var O=v(14);b.exports=function(){return O.Date.now()}},function(b,E,v){var O=v(202),S=v(21),I=v(204),D=/^[-+]0x[0-9a-f]+$/i,F=/^0b[01]+$/i,z=/^0o[0-7]+$/i,J=parseInt;b.exports=function(X){if(typeof X=="number")return X;if(I(X))return NaN;if(S(X)){var et=typeof X.valueOf=="function"?X.valueOf():X;X=S(et)?et+"":et}if(typeof X!="string")return X===0?X:+X;X=O(X);var ut=F.test(X);return ut||z.test(X)?J(X.slice(2),ut?2:8):D.test(X)?NaN:+X}},function(b,E,v){var O=v(203),S=/^\s+/;b.exports=function(I){return I&&I.slice(0,O(I)+1).replace(S,"")}},function(b,E){var v=/\s/;b.exports=function(O){for(var S=O.length;S--&&v.test(O.charAt(S)););return S}},function(b,E,v){var O=v(20),S=v(15);b.exports=function(I){return typeof I=="symbol"||S(I)&&O(I)=="[object Symbol]"}},function(b,E,v){var O=v(54),S=v(206),I=v(68),D=v(208),F=v(209),z=v(212),J=v(213),X=v(214),et=v(215),ut=v(59),Rt=v(216),St=v(32),L=v(217),R=v(218),U=v(223),W=v(31),P=v(41),j=v(225),$=v(21),H=v(227),Nt=v(40),Vt=v(45),st={};st["[object Arguments]"]=st["[object Array]"]=st["[object ArrayBuffer]"]=st["[object DataView]"]=st["[object Boolean]"]=st["[object Date]"]=st["[object Float32Array]"]=st["[object Float64Array]"]=st["[object Int8Array]"]=st["[object Int16Array]"]=st["[object Int32Array]"]=st["[object Map]"]=st["[object Number]"]=st["[object Object]"]=st["[object RegExp]"]=st["[object Set]"]=st["[object String]"]=st["[object Symbol]"]=st["[object Uint8Array]"]=st["[object Uint8ClampedArray]"]=st["[object Uint16Array]"]=st["[object Uint32Array]"]=!0,st["[object Error]"]=st["[object Function]"]=st["[object WeakMap]"]=!1,b.exports=function V(B,ft,tt,vt,Dt,Z){var pt,rt=1&ft,_t=2&ft,Et=4&ft;if(tt&&(pt=Dt?tt(B,vt,Dt,Z):tt(B)),pt!==void 0)return pt;if(!$(B))return B;var Gt=W(B);if(Gt){if(pt=L(B),!rt)return J(B,pt)}else{var Xt=St(B),Jt=Xt=="[object Function]"||Xt=="[object GeneratorFunction]";if(P(B))return z(B,rt);if(Xt=="[object Object]"||Xt=="[object Arguments]"||Jt&&!Dt){if(pt=_t||Jt?{}:U(B),!rt)return _t?et(B,F(pt,B)):X(B,D(pt,B))}else{if(!st[Xt])return Dt?B:{};pt=R(B,Xt,rt)}}Z||(Z=new O);var at=Z.get(B);if(at)return at;Z.set(B,pt),H(B)?B.forEach(function(ke){pt.add(V(ke,ft,tt,ke,B,Z))}):j(B)&&B.forEach(function(ke,Oe){pt.set(Oe,V(ke,ft,tt,Oe,B,Z))});var _e=Gt?void 0:(Et?_t?Rt:ut:_t?Vt:Nt)(B);return S(_e||B,function(ke,Oe){_e&&(ke=B[Oe=ke]),I(pt,Oe,V(ke,ft,tt,Oe,B,Z))}),pt}},function(b,E){b.exports=function(v,O){for(var S=-1,I=v==null?0:v.length;++S<I&&O(v[S],S,v)!==!1;);return v}},function(b,E,v){var O=v(22),S=function(){try{var I=O(Object,"defineProperty");return I({},"",{}),I}catch{}}();b.exports=S},function(b,E,v){var O=v(33),S=v(40);b.exports=function(I,D){return I&&O(D,S(D),I)}},function(b,E,v){var O=v(33),S=v(45);b.exports=function(I,D){return I&&O(D,S(D),I)}},function(b,E,v){var O=v(21),S=v(44),I=v(211),D=Object.prototype.hasOwnProperty;b.exports=function(F){if(!O(F))return I(F);var z=S(F),J=[];for(var X in F)(X!="constructor"||!z&&D.call(F,X))&&J.push(X);return J}},function(b,E){b.exports=function(v){var O=[];if(v!=null)for(var S in Object(v))O.push(S);return O}},function(b,E,v){(function(O){var S=v(14),I=E&&!E.nodeType&&E,D=I&&typeof O=="object"&&O&&!O.nodeType&&O,F=D&&D.exports===I?S.Buffer:void 0,z=F?F.allocUnsafe:void 0;O.exports=function(J,X){if(X)return J.slice();var et=J.length,ut=z?z(et):new J.constructor(et);return J.copy(ut),ut}}).call(this,v(26)(b))},function(b,E){b.exports=function(v,O){var S=-1,I=v.length;for(O||(O=Array(I));++S<I;)O[S]=v[S];return O}},function(b,E,v){var O=v(33),S=v(39);b.exports=function(I,D){return O(I,S(I),D)}},function(b,E,v){var O=v(33),S=v(70);b.exports=function(I,D){return O(I,S(I),D)}},function(b,E,v){var O=v(60),S=v(70),I=v(45);b.exports=function(D){return O(D,I,S)}},function(b,E){var v=Object.prototype.hasOwnProperty;b.exports=function(O){var S=O.length,I=new O.constructor(S);return S&&typeof O[0]=="string"&&v.call(O,"index")&&(I.index=O.index,I.input=O.input),I}},function(b,E,v){var O=v(46),S=v(219),I=v(220),D=v(221),F=v(222);b.exports=function(z,J,X){var et=z.constructor;switch(J){case"[object ArrayBuffer]":return O(z);case"[object Boolean]":case"[object Date]":return new et(+z);case"[object DataView]":return S(z,X);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return F(z,X);case"[object Map]":return new et;case"[object Number]":case"[object String]":return new et(z);case"[object RegExp]":return I(z);case"[object Set]":return new et;case"[object Symbol]":return D(z)}}},function(b,E,v){var O=v(46);b.exports=function(S,I){var D=I?O(S.buffer):S.buffer;return new S.constructor(D,S.byteOffset,S.byteLength)}},function(b,E){var v=/\w*$/;b.exports=function(O){var S=new O.constructor(O.source,v.exec(O));return S.lastIndex=O.lastIndex,S}},function(b,E,v){var O=v(25),S=O?O.prototype:void 0,I=S?S.valueOf:void 0;b.exports=function(D){return I?Object(I.call(D)):{}}},function(b,E,v){var O=v(46);b.exports=function(S,I){var D=I?O(S.buffer):S.buffer;return new S.constructor(D,S.byteOffset,S.length)}},function(b,E,v){var O=v(224),S=v(71),I=v(44);b.exports=function(D){return typeof D.constructor!="function"||I(D)?{}:O(S(D))}},function(b,E,v){var O=v(21),S=Object.create,I=function(){function D(){}return function(F){if(!O(F))return{};if(S)return S(F);D.prototype=F;var z=new D;return D.prototype=void 0,z}}();b.exports=I},function(b,E,v){var O=v(226),S=v(42),I=v(43),D=I&&I.isMap,F=D?S(D):O;b.exports=F},function(b,E,v){var O=v(32),S=v(15);b.exports=function(I){return S(I)&&O(I)=="[object Map]"}},function(b,E,v){var O=v(228),S=v(42),I=v(43),D=I&&I.isSet,F=D?S(D):O;b.exports=F},function(b,E,v){var O=v(32),S=v(15);b.exports=function(I){return S(I)&&O(I)=="[object Set]"}},function(b,E,v){v.r(E),v.d(E,"ErrorType",function(){return Vi}),v.d(E,"delay",function(){return _h}),v.d(E,"waitUntil",function(){return qw}),v.d(E,"SLIDE_EVENTS",function(){return lr}),v.d(E,"Slide",function(){return to});const O=[];for(let i=0;i<256;i++)O[i]=(i<16?"0":"")+i.toString(16);function S(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(O[255&i]+O[i>>8&255]+O[i>>16&255]+O[i>>24&255]+"-"+O[255&t]+O[t>>8&255]+"-"+O[t>>16&15|64]+O[t>>24&255]+"-"+O[63&e|128]+O[e>>8&255]+"-"+O[e>>16&255]+O[e>>24&255]+O[255&n]+O[n>>8&255]+O[n>>16&255]+O[n>>24&255]).toUpperCase()}var I=v(23);/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */class D{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const n=this._listeners[t];if(n!==void 0){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const e=this._listeners[t.type];if(e!==void 0){t.target=this;const n=e.slice(0);for(let r=0,o=n.length;r<o;r++)n[r].call(this,t);t.target=null}}}const F=[];for(let i=0;i<256;i++)F[i]=(i<16?"0":"")+i.toString(16);const z=Math.PI/180,J=180/Math.PI;function X(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(F[255&i]+F[i>>8&255]+F[i>>16&255]+F[i>>24&255]+"-"+F[255&t]+F[t>>8&255]+"-"+F[t>>16&15|64]+F[t>>24&255]+"-"+F[63&e|128]+F[e>>8&255]+"-"+F[e>>16&255]+F[e>>24&255]+F[255&n]+F[n>>8&255]+F[n>>16&255]+F[n>>24&255]).toUpperCase()}function et(i,t,e){return Math.max(t,Math.min(e,i))}function ut(i,t){return(i%t+t)%t}function Rt(i,t,e){return(1-e)*i+e*t}function St(i){return(i&i-1)==0&&i!==0}function L(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}class R{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),o=this.x-t.x,s=this.y-t.y;return this.x=o*n-s*r+t.x,this.y=o*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}R.prototype.isVector2=!0;class U{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h){const u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=o,u[5]=l,u[6]=n,u[7]=s,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[3],l=n[6],h=n[1],u=n[4],p=n[7],_=n[2],x=n[5],w=n[8],M=r[0],C=r[3],G=r[6],Q=r[1],nt=r[4],ct=r[7],it=r[2],mt=r[5],lt=r[8];return o[0]=s*M+a*Q+l*it,o[3]=s*C+a*nt+l*mt,o[6]=s*G+a*ct+l*lt,o[1]=h*M+u*Q+p*it,o[4]=h*C+u*nt+p*mt,o[7]=h*G+u*ct+p*lt,o[2]=_*M+x*Q+w*it,o[5]=_*C+x*nt+w*mt,o[8]=_*G+x*ct+w*lt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*s*u-e*a*h-n*o*u+n*a*l+r*o*h-r*s*l}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=u*s-a*h,_=a*l-u*o,x=h*o-s*l,w=e*p+n*_+r*x;if(w===0)return this.set(0,0,0,0,0,0,0,0,0);const M=1/w;return t[0]=p*M,t[1]=(r*h-u*n)*M,t[2]=(a*n-r*s)*M,t[3]=_*M,t[4]=(u*e-r*l)*M,t[5]=(r*o-a*e)*M,t[6]=x*M,t[7]=(n*l-h*e)*M,t[8]=(s*e-n*o)*M,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,o,s,a){const l=Math.cos(o),h=Math.sin(o);return this.set(n*l,n*h,-n*(l*s+h*a)+s+t,-r*h,r*l,-r*(-h*s+l*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],h=r[4],u=r[7];return r[0]=e*o+n*l,r[3]=e*s+n*h,r[6]=e*a+n*u,r[1]=-n*o+e*l,r[4]=-n*s+e*h,r[7]=-n*a+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}let W;U.prototype.isMatrix3=!0;class P{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{W===void 0&&(W=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),W.width=t.width,W.height=t.height;const n=W.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=W}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let j=0;class $ extends D{constructor(t=$.DEFAULT_IMAGE,e=$.DEFAULT_MAPPING,n=1001,r=1001,o=1006,s=1008,a=1023,l=1009,h=1,u=3e3){super(),Object.defineProperty(this,"id",{value:j++}),this.uuid=X(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new R(0,0),this.repeat=new R(1,1),this.center=new R(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new U,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const r=this.image;if(r.uuid===void 0&&(r.uuid=X()),!e&&t.images[r.uuid]===void 0){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(H(r[s].image)):o.push(H(r[s]))}else o=H(r);t.images[r.uuid]={uuid:r.uuid,url:o}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}function H(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?P.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}$.DEFAULT_IMAGE=void 0,$.DEFAULT_MAPPING=300,$.prototype.isTexture=!0;class Nt{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*o,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*o,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*o,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,o;const s=t.elements,a=s[0],l=s[4],h=s[8],u=s[1],p=s[5],_=s[9],x=s[2],w=s[6],M=s[10];if(Math.abs(l-u)<.01&&Math.abs(h-x)<.01&&Math.abs(_-w)<.01){if(Math.abs(l+u)<.1&&Math.abs(h+x)<.1&&Math.abs(_+w)<.1&&Math.abs(a+p+M-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const G=(a+1)/2,Q=(p+1)/2,nt=(M+1)/2,ct=(l+u)/4,it=(h+x)/4,mt=(_+w)/4;return G>Q&&G>nt?G<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(G),r=ct/n,o=it/n):Q>nt?Q<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(Q),n=ct/r,o=mt/r):nt<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(nt),n=it/o,r=mt/o),this.set(n,r,o,e),this}let C=Math.sqrt((w-_)*(w-_)+(h-x)*(h-x)+(u-l)*(u-l));return Math.abs(C)<.001&&(C=1),this.x=(w-_)/C,this.y=(h-x)/C,this.z=(u-l)/C,this.w=Math.acos((a+p+M-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Nt.prototype.isVector4=!0;class Vt extends D{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Nt(0,0,t,e),this.scissorTest=!1,this.viewport=new Nt(0,0,t,e),this.texture=new $(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:1006,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Ac({},this.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Vt.prototype.isWebGLRenderTarget=!0,class extends Vt{constructor(i,t,e){super(i,t);const n=this.texture;this.texture=[];for(let r=0;r<e;r++)this.texture[r]=n.clone()}setSize(i,t,e=1){if(this.width!==i||this.height!==t||this.depth!==e){this.width=i,this.height=t,this.depth=e;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=i,this.texture[n].image.height=t,this.texture[n].image.depth=e;this.dispose()}return this.viewport.set(0,0,i,t),this.scissor.set(0,0,i,t),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.texture.length=0;for(let t=0,e=i.texture.length;t<e;t++)this.texture[t]=i.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class st extends Vt{constructor(t,e,n){super(t,e,n),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}st.prototype.isWebGLMultisampleRenderTarget=!0;class V{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,o,s,a){let l=n[r+0],h=n[r+1],u=n[r+2],p=n[r+3];const _=o[s+0],x=o[s+1],w=o[s+2],M=o[s+3];if(a===0)return t[e+0]=l,t[e+1]=h,t[e+2]=u,void(t[e+3]=p);if(a===1)return t[e+0]=_,t[e+1]=x,t[e+2]=w,void(t[e+3]=M);if(p!==M||l!==_||h!==x||u!==w){let C=1-a;const G=l*_+h*x+u*w+p*M,Q=G>=0?1:-1,nt=1-G*G;if(nt>Number.EPSILON){const it=Math.sqrt(nt),mt=Math.atan2(it,G*Q);C=Math.sin(C*mt)/it,a=Math.sin(a*mt)/it}const ct=a*Q;if(l=l*C+_*ct,h=h*C+x*ct,u=u*C+w*ct,p=p*C+M*ct,C===1-a){const it=1/Math.sqrt(l*l+h*h+u*u+p*p);l*=it,h*=it,u*=it,p*=it}}t[e]=l,t[e+1]=h,t[e+2]=u,t[e+3]=p}static multiplyQuaternionsFlat(t,e,n,r,o,s){const a=n[r],l=n[r+1],h=n[r+2],u=n[r+3],p=o[s],_=o[s+1],x=o[s+2],w=o[s+3];return t[e]=a*w+u*p+l*x-h*_,t[e+1]=l*w+u*_+h*p-a*x,t[e+2]=h*w+u*x+a*_-l*p,t[e+3]=u*w-a*p-l*_-h*x,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,o=t._z,s=t._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(r/2),p=a(o/2),_=l(n/2),x=l(r/2),w=l(o/2);switch(s){case"XYZ":this._x=_*u*p+h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p-_*x*w;break;case"YXZ":this._x=_*u*p+h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p+_*x*w;break;case"ZXY":this._x=_*u*p-h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p-_*x*w;break;case"ZYX":this._x=_*u*p-h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p+_*x*w;break;case"YZX":this._x=_*u*p+h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p-_*x*w;break;case"XZY":this._x=_*u*p-h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p+_*x*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],o=e[8],s=e[1],a=e[5],l=e[9],h=e[2],u=e[6],p=e[10],_=n+a+p;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(u-l)*x,this._y=(o-h)*x,this._z=(s-r)*x}else if(n>a&&n>p){const x=2*Math.sqrt(1+n-a-p);this._w=(u-l)/x,this._x=.25*x,this._y=(r+s)/x,this._z=(o+h)/x}else if(a>p){const x=2*Math.sqrt(1+a-n-p);this._w=(o-h)/x,this._x=(r+s)/x,this._y=.25*x,this._z=(l+u)/x}else{const x=2*Math.sqrt(1+p-n-a);this._w=(s-r)/x,this._x=(o+h)/x,this._y=(l+u)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(et(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,o=t._z,s=t._w,a=e._x,l=e._y,h=e._z,u=e._w;return this._x=n*u+s*a+r*h-o*l,this._y=r*u+s*l+o*a-n*h,this._z=o*u+s*h+n*l-r*a,this._w=s*u-n*a-r*l-o*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,o=this._z,s=this._w;let a=s*t._w+n*t._x+r*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const x=1-e;return this._w=x*s+e*this._w,this._x=x*n+e*this._x,this._y=x*r+e*this._y,this._z=x*o+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),p=Math.sin((1-e)*u)/h,_=Math.sin(e*u)/h;return this._w=s*p+this._w*_,this._x=n*p+this._x*_,this._y=r*p+this._y*_,this._z=o*p+this._z*_,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}V.prototype.isQuaternion=!0;class B{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(tt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(tt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*n+o[6]*r,this.y=o[1]*e+o[4]*n+o[7]*r,this.z=o[2]*e+o[5]*n+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=t.elements,s=1/(o[3]*e+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*n+o[8]*r+o[12])*s,this.y=(o[1]*e+o[5]*n+o[9]*r+o[13])*s,this.z=(o[2]*e+o[6]*n+o[10]*r+o[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,o=t.x,s=t.y,a=t.z,l=t.w,h=l*e+s*r-a*n,u=l*n+a*e-o*r,p=l*r+o*n-s*e,_=-o*e-s*n-a*r;return this.x=h*l+_*-o+u*-a-p*-s,this.y=u*l+_*-s+p*-o-h*-a,this.z=p*l+_*-a+h*-s-u*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r,this.y=o[1]*e+o[5]*n+o[9]*r,this.z=o[2]*e+o[6]*n+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,o=t.z,s=e.x,a=e.y,l=e.z;return this.x=r*l-o*a,this.y=o*s-n*l,this.z=n*a-r*s,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ft.copy(this).projectOnVector(t),this.sub(ft)}reflect(t){return this.sub(ft.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(et(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}B.prototype.isVector3=!0;const ft=new B,tt=new V;class vt{constructor(t=new B(1/0,1/0,1/0),e=new B(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.length;l<h;l+=3){const u=t[l],p=t[l+1],_=t[l+2];u<e&&(e=u),p<n&&(n=p),_<r&&(r=_),u>o&&(o=u),p>s&&(s=p),_>a&&(a=_)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.count;l<h;l++){const u=t.getX(l),p=t.getY(l),_=t.getZ(l);u<e&&(e=u),p<n&&(n=p),_<r&&(r=_),u>o&&(o=u),p>s&&(s=p),_>a&&(a=_)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Z.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),pt.copy(e.boundingBox),pt.applyMatrix4(t.matrixWorld),this.union(pt));const n=t.children;for(let r=0,o=n.length;r<o;r++)this.expandByObject(n[r]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Z),Z.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(at),_e.subVectors(this.max,at),rt.subVectors(t.a,at),_t.subVectors(t.b,at),Et.subVectors(t.c,at),Gt.subVectors(_t,rt),Xt.subVectors(Et,_t),Jt.subVectors(rt,Et);let e=[0,-Gt.z,Gt.y,0,-Xt.z,Xt.y,0,-Jt.z,Jt.y,Gt.z,0,-Gt.x,Xt.z,0,-Xt.x,Jt.z,0,-Jt.x,-Gt.y,Gt.x,0,-Xt.y,Xt.x,0,-Jt.y,Jt.x,0];return!!Ae(e,rt,_t,Et,_e)&&(e=[1,0,0,0,1,0,0,0,1],!!Ae(e,rt,_t,Et,_e)&&(ke.crossVectors(Gt,Xt),e=[ke.x,ke.y,ke.z],Ae(e,rt,_t,Et,_e)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Z.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Z).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Dt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Dt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Dt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Dt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Dt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Dt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Dt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Dt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Dt)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}vt.prototype.isBox3=!0;const Dt=[new B,new B,new B,new B,new B,new B,new B,new B],Z=new B,pt=new vt,rt=new B,_t=new B,Et=new B,Gt=new B,Xt=new B,Jt=new B,at=new B,_e=new B,ke=new B,Oe=new B;function Ae(i,t,e,n,r){for(let o=0,s=i.length-3;o<=s;o+=3){Oe.fromArray(i,o);const a=r.x*Math.abs(Oe.x)+r.y*Math.abs(Oe.y)+r.z*Math.abs(Oe.z),l=t.dot(Oe),h=e.dot(Oe),u=n.dot(Oe);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const ze=new vt,$e=new B,cn=new B,Ue=new B;class Ge{constructor(t=new B,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):ze.setFromPoints(t).getCenter(n);let r=0;for(let o=0,s=t.length;o<s;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Ue.subVectors(t,this.center);const e=Ue.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=.5*(n-this.radius);this.center.add(Ue.multiplyScalar(r/n)),this.radius+=r}return this}union(t){return cn.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint($e.copy(t.center).add(cn)),this.expandByPoint($e.copy(t.center).sub(cn)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Rn=new B,re=new B,pe=new B,we=new B,ln=new B,In=new B,Zn=new B;class pi{constructor(t=new B,e=new B(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Rn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Rn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Rn.copy(this.direction).multiplyScalar(e).add(this.origin),Rn.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){re.copy(t).add(e).multiplyScalar(.5),pe.copy(e).sub(t).normalize(),we.copy(this.origin).sub(re);const o=.5*t.distanceTo(e),s=-this.direction.dot(pe),a=we.dot(this.direction),l=-we.dot(pe),h=we.lengthSq(),u=Math.abs(1-s*s);let p,_,x,w;if(u>0)if(p=s*l-a,_=s*a-l,w=o*u,p>=0)if(_>=-w)if(_<=w){const M=1/u;p*=M,_*=M,x=p*(p+s*_+2*a)+_*(s*p+_+2*l)+h}else _=o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;else _=-o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;else _<=-w?(p=Math.max(0,-(-s*o+a)),_=p>0?-o:Math.min(Math.max(-o,-l),o),x=-p*p+_*(_+2*l)+h):_<=w?(p=0,_=Math.min(Math.max(-o,-l),o),x=_*(_+2*l)+h):(p=Math.max(0,-(s*o+a)),_=p>0?o:Math.min(Math.max(-o,-l),o),x=-p*p+_*(_+2*l)+h);else _=s>0?-o:o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(p).add(this.origin),r&&r.copy(pe).multiplyScalar(_).add(re),x}intersectSphere(t,e){Rn.subVectors(t.center,this.origin);const n=Rn.dot(this.direction),r=Rn.dot(Rn)-n*n,o=t.radius*t.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=n-s,l=n+s;return a<0&&l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0?!0:t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,o,s,a,l;const h=1/this.direction.x,u=1/this.direction.y,p=1/this.direction.z,_=this.origin;return h>=0?(n=(t.min.x-_.x)*h,r=(t.max.x-_.x)*h):(n=(t.max.x-_.x)*h,r=(t.min.x-_.x)*h),u>=0?(o=(t.min.y-_.y)*u,s=(t.max.y-_.y)*u):(o=(t.max.y-_.y)*u,s=(t.min.y-_.y)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),p>=0?(a=(t.min.z-_.z)*p,l=(t.max.z-_.z)*p):(a=(t.max.z-_.z)*p,l=(t.min.z-_.z)*p),n>l||a>r?null:((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return this.intersectBox(t,Rn)!==null}intersectTriangle(t,e,n,r,o){ln.subVectors(e,t),In.subVectors(n,t),Zn.crossVectors(ln,In);let s,a=this.direction.dot(Zn);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}we.subVectors(this.origin,t);const l=s*this.direction.dot(In.crossVectors(we,In));if(l<0)return null;const h=s*this.direction.dot(ln.cross(we));if(h<0||l+h>a)return null;const u=-s*we.dot(Zn);return u<0?null:this.at(u/a,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h,u,p,_,x,w,M,C){const G=this.elements;return G[0]=t,G[4]=e,G[8]=n,G[12]=r,G[1]=o,G[5]=s,G[9]=a,G[13]=l,G[2]=h,G[6]=u,G[10]=p,G[14]=_,G[3]=x,G[7]=w,G[11]=M,G[15]=C,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new tn().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/yt.setFromMatrixColumn(t,0).length(),o=1/yt.setFromMatrixColumn(t,1).length(),s=1/yt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,o=t.z,s=Math.cos(n),a=Math.sin(n),l=Math.cos(r),h=Math.sin(r),u=Math.cos(o),p=Math.sin(o);if(t.order==="XYZ"){const _=s*u,x=s*p,w=a*u,M=a*p;e[0]=l*u,e[4]=-l*p,e[8]=h,e[1]=x+w*h,e[5]=_-M*h,e[9]=-a*l,e[2]=M-_*h,e[6]=w+x*h,e[10]=s*l}else if(t.order==="YXZ"){const _=l*u,x=l*p,w=h*u,M=h*p;e[0]=_+M*a,e[4]=w*a-x,e[8]=s*h,e[1]=s*p,e[5]=s*u,e[9]=-a,e[2]=x*a-w,e[6]=M+_*a,e[10]=s*l}else if(t.order==="ZXY"){const _=l*u,x=l*p,w=h*u,M=h*p;e[0]=_-M*a,e[4]=-s*p,e[8]=w+x*a,e[1]=x+w*a,e[5]=s*u,e[9]=M-_*a,e[2]=-s*h,e[6]=a,e[10]=s*l}else if(t.order==="ZYX"){const _=s*u,x=s*p,w=a*u,M=a*p;e[0]=l*u,e[4]=w*h-x,e[8]=_*h+M,e[1]=l*p,e[5]=M*h+_,e[9]=x*h-w,e[2]=-h,e[6]=a*l,e[10]=s*l}else if(t.order==="YZX"){const _=s*l,x=s*h,w=a*l,M=a*h;e[0]=l*u,e[4]=M-_*p,e[8]=w*p+x,e[1]=p,e[5]=s*u,e[9]=-a*u,e[2]=-h*u,e[6]=x*p+w,e[10]=_-M*p}else if(t.order==="XZY"){const _=s*l,x=s*h,w=a*l,M=a*h;e[0]=l*u,e[4]=-p,e[8]=h*u,e[1]=_*p+M,e[5]=s*u,e[9]=x*p-w,e[2]=w*p-x,e[6]=a*u,e[10]=M*p+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(It,t,Qt)}lookAt(t,e,n){const r=this.elements;return oe.subVectors(t,e),oe.lengthSq()===0&&(oe.z=1),oe.normalize(),Wt.crossVectors(n,oe),Wt.lengthSq()===0&&(Math.abs(n.z)===1?oe.x+=1e-4:oe.z+=1e-4,oe.normalize(),Wt.crossVectors(n,oe)),Wt.normalize(),Zt.crossVectors(oe,Wt),r[0]=Wt.x,r[4]=Zt.x,r[8]=oe.x,r[1]=Wt.y,r[5]=Zt.y,r[9]=oe.y,r[2]=Wt.z,r[6]=Zt.z,r[10]=oe.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[4],l=n[8],h=n[12],u=n[1],p=n[5],_=n[9],x=n[13],w=n[2],M=n[6],C=n[10],G=n[14],Q=n[3],nt=n[7],ct=n[11],it=n[15],mt=r[0],lt=r[4],gt=r[8],Ut=r[12],Ft=r[1],Mt=r[5],At=r[9],Ot=r[13],Lt=r[2],ne=r[6],$t=r[10],zt=r[14],Yt=r[3],ge=r[7],be=r[11],Pe=r[15];return o[0]=s*mt+a*Ft+l*Lt+h*Yt,o[4]=s*lt+a*Mt+l*ne+h*ge,o[8]=s*gt+a*At+l*$t+h*be,o[12]=s*Ut+a*Ot+l*zt+h*Pe,o[1]=u*mt+p*Ft+_*Lt+x*Yt,o[5]=u*lt+p*Mt+_*ne+x*ge,o[9]=u*gt+p*At+_*$t+x*be,o[13]=u*Ut+p*Ot+_*zt+x*Pe,o[2]=w*mt+M*Ft+C*Lt+G*Yt,o[6]=w*lt+M*Mt+C*ne+G*ge,o[10]=w*gt+M*At+C*$t+G*be,o[14]=w*Ut+M*Ot+C*zt+G*Pe,o[3]=Q*mt+nt*Ft+ct*Lt+it*Yt,o[7]=Q*lt+nt*Mt+ct*ne+it*ge,o[11]=Q*gt+nt*At+ct*$t+it*be,o[15]=Q*Ut+nt*Ot+ct*zt+it*Pe,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],o=t[12],s=t[1],a=t[5],l=t[9],h=t[13],u=t[2],p=t[6],_=t[10],x=t[14];return t[3]*(+o*l*p-r*h*p-o*a*_+n*h*_+r*a*x-n*l*x)+t[7]*(+e*l*x-e*h*_+o*s*_-r*s*x+r*h*u-o*l*u)+t[11]*(+e*h*p-e*a*x-o*s*p+n*s*x+o*a*u-n*h*u)+t[15]*(-r*a*u-e*l*p+e*a*_+r*s*p-n*s*_+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=t[9],_=t[10],x=t[11],w=t[12],M=t[13],C=t[14],G=t[15],Q=p*C*h-M*_*h+M*l*x-a*C*x-p*l*G+a*_*G,nt=w*_*h-u*C*h-w*l*x+s*C*x+u*l*G-s*_*G,ct=u*M*h-w*p*h+w*a*x-s*M*x-u*a*G+s*p*G,it=w*p*l-u*M*l-w*a*_+s*M*_+u*a*C-s*p*C,mt=e*Q+n*nt+r*ct+o*it;if(mt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const lt=1/mt;return t[0]=Q*lt,t[1]=(M*_*o-p*C*o-M*r*x+n*C*x+p*r*G-n*_*G)*lt,t[2]=(a*C*o-M*l*o+M*r*h-n*C*h-a*r*G+n*l*G)*lt,t[3]=(p*l*o-a*_*o-p*r*h+n*_*h+a*r*x-n*l*x)*lt,t[4]=nt*lt,t[5]=(u*C*o-w*_*o+w*r*x-e*C*x-u*r*G+e*_*G)*lt,t[6]=(w*l*o-s*C*o-w*r*h+e*C*h+s*r*G-e*l*G)*lt,t[7]=(s*_*o-u*l*o+u*r*h-e*_*h-s*r*x+e*l*x)*lt,t[8]=ct*lt,t[9]=(w*p*o-u*M*o-w*n*x+e*M*x+u*n*G-e*p*G)*lt,t[10]=(s*M*o-w*a*o+w*n*h-e*M*h-s*n*G+e*a*G)*lt,t[11]=(u*a*o-s*p*o-u*n*h+e*p*h+s*n*x-e*a*x)*lt,t[12]=it*lt,t[13]=(u*M*r-w*p*r+w*n*_-e*M*_-u*n*C+e*p*C)*lt,t[14]=(w*a*r-s*M*r-w*n*l+e*M*l+s*n*C-e*a*C)*lt,t[15]=(s*p*r-u*a*r+u*n*l-e*p*l-s*n*_+e*a*_)*lt,this}scale(t){const e=this.elements,n=t.x,r=t.y,o=t.z;return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),o=1-n,s=t.x,a=t.y,l=t.z,h=o*s,u=o*a;return this.set(h*s+n,h*a-r*l,h*l+r*a,0,h*a+r*l,u*a+n,u*l-r*s,0,h*l-r*a,u*l+r*s,o*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,o,s){return this.set(1,n,o,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,o=e._x,s=e._y,a=e._z,l=e._w,h=o+o,u=s+s,p=a+a,_=o*h,x=o*u,w=o*p,M=s*u,C=s*p,G=a*p,Q=l*h,nt=l*u,ct=l*p,it=n.x,mt=n.y,lt=n.z;return r[0]=(1-(M+G))*it,r[1]=(x+ct)*it,r[2]=(w-nt)*it,r[3]=0,r[4]=(x-ct)*mt,r[5]=(1-(_+G))*mt,r[6]=(C+Q)*mt,r[7]=0,r[8]=(w+nt)*lt,r[9]=(C-Q)*lt,r[10]=(1-(_+M))*lt,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let o=yt.set(r[0],r[1],r[2]).length();const s=yt.set(r[4],r[5],r[6]).length(),a=yt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],wt.copy(this);const l=1/o,h=1/s,u=1/a;return wt.elements[0]*=l,wt.elements[1]*=l,wt.elements[2]*=l,wt.elements[4]*=h,wt.elements[5]*=h,wt.elements[6]*=h,wt.elements[8]*=u,wt.elements[9]*=u,wt.elements[10]*=u,e.setFromRotationMatrix(wt),n.x=o,n.y=s,n.z=a,this}makePerspective(t,e,n,r,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*o/(e-t),h=2*o/(n-r),u=(e+t)/(e-t),p=(n+r)/(n-r),_=-(s+o)/(s-o),x=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=_,a[14]=x,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,o,s){const a=this.elements,l=1/(e-t),h=1/(n-r),u=1/(s-o),p=(e+t)*l,_=(n+r)*h,x=(s+o)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-_,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-x,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}tn.prototype.isMatrix4=!0;const yt=new B,wt=new tn,It=new B(0,0,0),Qt=new B(1,1,1),Wt=new B,Zt=new B,oe=new B,Me=new tn,Se=new V;class Ee{constructor(t=0,e=0,n=0,r=Ee.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,o=r[0],s=r[4],a=r[8],l=r[1],h=r[5],u=r[9],p=r[2],_=r[6],x=r[10];switch(e){case"XYZ":this._y=Math.asin(et(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,x),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(_,h),this._z=0);break;case"YXZ":this._x=Math.asin(-et(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,x),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(et(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-p,x),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-et(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(et(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(a,x));break;case"XZY":this._z=Math.asin(-et(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(_,h),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-u,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Me.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Me,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Se.setFromEuler(this),this.setFromQuaternion(Se,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new B(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Ee.prototype.isEuler=!0,Ee.DefaultOrder="XYZ",Ee.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ve{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}}let en=0;const dn=new B,Tn=new V,yn=new tn,Xn=new B,Pn=new B,zi=new B,fo=new V,io=new B(1,0,0),Fn=new B(0,1,0),Yo=new B(0,0,1),ro={type:"added"},mo={type:"removed"};class kn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:en++}),this.uuid=X(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kn.DefaultUp.clone();const t=new B,e=new Ee,n=new V,r=new B(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new tn},normalMatrix:{value:new U}}),this.matrix=new tn,this.matrixWorld=new tn,this.matrixAutoUpdate=kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ve,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.multiply(Tn),this}rotateOnWorldAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.premultiply(Tn),this}rotateX(t){return this.rotateOnAxis(io,t)}rotateY(t){return this.rotateOnAxis(Fn,t)}rotateZ(t){return this.rotateOnAxis(Yo,t)}translateOnAxis(t,e){return dn.copy(t).applyQuaternion(this.quaternion),this.position.add(dn.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(io,t)}translateY(t){return this.translateOnAxis(Fn,t)}translateZ(t){return this.translateOnAxis(Yo,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(yn.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Xn.copy(t):Xn.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Pn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yn.lookAt(Pn,Xn,this.up):yn.lookAt(Xn,Pn,this.up),this.quaternion.setFromRotationMatrix(yn),r&&(yn.extractRotation(r.matrixWorld),Tn.setFromRotationMatrix(yn),this.quaternion.premultiply(Tn.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ro)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(mo)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(mo)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),yn.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),yn.multiply(t.parent.matrixWorld)),t.applyMatrix4(yn),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,t,zi),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,fo,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const p=l[h];o(t.shapes,p)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(o(t.materials,this.material[l]));r.material=a}else r.material=o(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(t.animations,l))}}if(e){const a=s(t.geometries),l=s(t.materials),h=s(t.textures),u=s(t.images),p=s(t.shapes),_=s(t.skeletons),x=s(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),p.length>0&&(n.shapes=p),_.length>0&&(n.skeletons=_),x.length>0&&(n.animations=x)}return n.object=r,n;function s(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}kn.DefaultUp=new B(0,1,0),kn.DefaultMatrixAutoUpdate=!0,kn.prototype.isObject3D=!0;const jn=new B,Ki=new B,Wr=new B,Mi=new B,Sr=new B,Lr=new B,qo=new B,Jo=new B,go=new B,vo=new B;class ui{constructor(t=new B,e=new B,n=new B){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),jn.subVectors(t,e),r.cross(jn);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,n,r,o){jn.subVectors(r,e),Ki.subVectors(n,e),Wr.subVectors(t,e);const s=jn.dot(jn),a=jn.dot(Ki),l=jn.dot(Wr),h=Ki.dot(Ki),u=Ki.dot(Wr),p=s*h-a*a;if(p===0)return o.set(-2,-1,-1);const _=1/p,x=(h*l-a*u)*_,w=(s*u-a*l)*_;return o.set(1-x-w,w,x)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Mi),Mi.x>=0&&Mi.y>=0&&Mi.x+Mi.y<=1}static getUV(t,e,n,r,o,s,a,l){return this.getBarycoord(t,e,n,r,Mi),l.set(0,0),l.addScaledVector(o,Mi.x),l.addScaledVector(s,Mi.y),l.addScaledVector(a,Mi.z),l}static isFrontFacing(t,e,n,r){return jn.subVectors(n,e),Ki.subVectors(t,e),jn.cross(Ki).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return jn.subVectors(this.c,this.b),Ki.subVectors(this.a,this.b),.5*jn.cross(Ki).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ui.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ui.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,o){return ui.getUV(t,this.a,this.b,this.c,e,n,r,o)}containsPoint(t){return ui.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ui.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,o=this.c;let s,a;Sr.subVectors(r,n),Lr.subVectors(o,n),Jo.subVectors(t,n);const l=Sr.dot(Jo),h=Lr.dot(Jo);if(l<=0&&h<=0)return e.copy(n);go.subVectors(t,r);const u=Sr.dot(go),p=Lr.dot(go);if(u>=0&&p<=u)return e.copy(r);const _=l*p-u*h;if(_<=0&&l>=0&&u<=0)return s=l/(l-u),e.copy(n).addScaledVector(Sr,s);vo.subVectors(t,o);const x=Sr.dot(vo),w=Lr.dot(vo);if(w>=0&&x<=w)return e.copy(o);const M=x*h-l*w;if(M<=0&&h>=0&&w<=0)return a=h/(h-w),e.copy(n).addScaledVector(Lr,a);const C=u*w-x*p;if(C<=0&&p-u>=0&&x-w>=0)return qo.subVectors(o,r),a=(p-u)/(p-u+(x-w)),e.copy(r).addScaledVector(qo,a);const G=1/(C+M+_);return s=M*G,a=_*G,e.copy(n).addScaledVector(Sr,s).addScaledVector(Lr,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Zo=0;class Ci extends D{constructor(){super(),Object.defineProperty(this,"id",{value:Zo++}),this.uuid=X(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1;continue}const r=this[e];r!==void 0?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(n.blending=this.blending),this.side!==0&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),e){const o=r(t.textures),s=r(t.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const r=e.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=e[o].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}Ci.prototype.isMaterial=!0;const mr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oi={h:0,s:0,l:0},Dr={h:0,s:0,l:0};function _o(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+6*(t-i)*e:e<.5?t:e<2/3?i+6*(t-i)*(2/3-e):i}function oo(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function yo(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}class fn{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=ut(t,1),e=et(e,0,1),n=et(n,0,1),e===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,o=2*n-r;this.r=_o(o,r,t+1/3),this.g=_o(o,r,t),this.b=_o(o,r,t-1/3)}return this}setStyle(t){function e(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let r;const o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const a=parseFloat(r[1])/360,l=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,l,h)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=n[1],o=r.length;if(o===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=mr[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=oo(t.r),this.g=oo(t.g),this.b=oo(t.b),this}copyLinearToSRGB(t){return this.r=yo(t.r),this.g=yo(t.g),this.b=yo(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,r=this.b,o=Math.max(e,n,r),s=Math.min(e,n,r);let a,l;const h=(s+o)/2;if(s===o)a=0,l=0;else{const u=o-s;switch(l=h<=.5?u/(o+s):u/(2-o-s),o){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;case r:a=(e-n)/u+4}a/=6}return t.h=a,t.s=l,t.l=h,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Oi),Oi.h+=t,Oi.s+=e,Oi.l+=n,this.setHSL(Oi.h,Oi.s,Oi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Oi),t.getHSL(Dr);const n=Rt(Oi.h,Dr.h,e),r=Rt(Oi.s,Dr.s,e),o=Rt(Oi.l,Dr.l,e);return this.setHSL(n,r,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}fn.NAMES=mr,fn.prototype.isColor=!0,fn.prototype.r=1,fn.prototype.g=1,fn.prototype.b=1;class Qi extends Ci{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Qi.prototype.isMeshBasicMaterial=!0;const Mn=new B,xo=new R;class Yn{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new fn),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new R),e[n++]=s.x,e[n++]=s.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new B),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Nt),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)xo.fromBufferAttribute(this,e),xo.applyMatrix3(t),this.setXY(e,xo.x,xo.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)Mn.fromBufferAttribute(this,e),Mn.applyMatrix3(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyMatrix4(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyNormalMatrix(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.transformDirection(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==35044&&(t.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(t.updateRange=this.updateRange),t}}Yn.prototype.isBufferAttribute=!0;class vs extends Yn{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class ea extends Yn{constructor(t,e,n){super(new Int32Array(t),e,n)}}class bo extends Yn{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends Yn{constructor(i,t,e){super(new Uint16Array(i),t,e)}}).prototype.isFloat16BufferAttribute=!0;class An extends Yn{constructor(t,e,n){super(new Float32Array(t),e,n)}}function _s(i){if(i.length===0)return-1/0;let t=i[0];for(let e=1,n=i.length;e<n;++e)i[e]>t&&(t=i[e]);return t}let Ko=0;const bi=new tn,Qo=new kn,gr=new B,Ni=new vt,so=new vt,fi=new B;class Wn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:Ko++}),this.uuid=X(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(_s(t)>65535?bo:vs)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new U().getNormalMatrix(t);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return bi.makeRotationFromQuaternion(t),this.applyMatrix4(bi),this}rotateX(t){return bi.makeRotationX(t),this.applyMatrix4(bi),this}rotateY(t){return bi.makeRotationY(t),this.applyMatrix4(bi),this}rotateZ(t){return bi.makeRotationZ(t),this.applyMatrix4(bi),this}translate(t,e,n){return bi.makeTranslation(t,e,n),this.applyMatrix4(bi),this}scale(t,e,n){return bi.makeScale(t,e,n),this.applyMatrix4(bi),this}lookAt(t){return Qo.lookAt(t),Qo.updateMatrix(),this.applyMatrix4(Qo.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(gr).negate(),this.translate(gr.x,gr.y,gr.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];e.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new An(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vt);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new B(-1/0,-1/0,-1/0),new B(1/0,1/0,1/0));if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const o=e[n];Ni.setFromBufferAttribute(o),this.morphTargetsRelative?(fi.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(fi),fi.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(fi)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ge);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new B,1/0);if(t){const n=this.boundingSphere.center;if(Ni.setFromBufferAttribute(t),e)for(let o=0,s=e.length;o<s;o++){const a=e[o];so.setFromBufferAttribute(a),this.morphTargetsRelative?(fi.addVectors(Ni.min,so.min),Ni.expandByPoint(fi),fi.addVectors(Ni.max,so.max),Ni.expandByPoint(fi)):(Ni.expandByPoint(so.min),Ni.expandByPoint(so.max))}Ni.getCenter(n);let r=0;for(let o=0,s=t.count;o<s;o++)fi.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(fi));if(e)for(let o=0,s=e.length;o<s;o++){const a=e[o],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)fi.fromBufferAttribute(a,h),l&&(gr.fromBufferAttribute(t,h),fi.add(gr)),r=Math.max(r,n.distanceToSquared(fi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,o=e.normal.array,s=e.uv.array,a=r.length/3;e.tangent===void 0&&this.setAttribute("tangent",new Yn(new Float32Array(4*a),4));const l=e.tangent.array,h=[],u=[];for(let Ft=0;Ft<a;Ft++)h[Ft]=new B,u[Ft]=new B;const p=new B,_=new B,x=new B,w=new R,M=new R,C=new R,G=new B,Q=new B;function nt(Ft,Mt,At){p.fromArray(r,3*Ft),_.fromArray(r,3*Mt),x.fromArray(r,3*At),w.fromArray(s,2*Ft),M.fromArray(s,2*Mt),C.fromArray(s,2*At),_.sub(p),x.sub(p),M.sub(w),C.sub(w);const Ot=1/(M.x*C.y-C.x*M.y);isFinite(Ot)&&(G.copy(_).multiplyScalar(C.y).addScaledVector(x,-M.y).multiplyScalar(Ot),Q.copy(x).multiplyScalar(M.x).addScaledVector(_,-C.x).multiplyScalar(Ot),h[Ft].add(G),h[Mt].add(G),h[At].add(G),u[Ft].add(Q),u[Mt].add(Q),u[At].add(Q))}let ct=this.groups;ct.length===0&&(ct=[{start:0,count:n.length}]);for(let Ft=0,Mt=ct.length;Ft<Mt;++Ft){const At=ct[Ft],Ot=At.start;for(let Lt=Ot,ne=Ot+At.count;Lt<ne;Lt+=3)nt(n[Lt+0],n[Lt+1],n[Lt+2])}const it=new B,mt=new B,lt=new B,gt=new B;function Ut(Ft){lt.fromArray(o,3*Ft),gt.copy(lt);const Mt=h[Ft];it.copy(Mt),it.sub(lt.multiplyScalar(lt.dot(Mt))).normalize(),mt.crossVectors(gt,Mt);const At=mt.dot(u[Ft])<0?-1:1;l[4*Ft]=it.x,l[4*Ft+1]=it.y,l[4*Ft+2]=it.z,l[4*Ft+3]=At}for(let Ft=0,Mt=ct.length;Ft<Mt;++Ft){const At=ct[Ft],Ot=At.start;for(let Lt=Ot,ne=Ot+At.count;Lt<ne;Lt+=3)Ut(n[Lt+0]),Ut(n[Lt+1]),Ut(n[Lt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Yn(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let _=0,x=n.count;_<x;_++)n.setXYZ(_,0,0,0);const r=new B,o=new B,s=new B,a=new B,l=new B,h=new B,u=new B,p=new B;if(t)for(let _=0,x=t.count;_<x;_+=3){const w=t.getX(_+0),M=t.getX(_+1),C=t.getX(_+2);r.fromBufferAttribute(e,w),o.fromBufferAttribute(e,M),s.fromBufferAttribute(e,C),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),a.fromBufferAttribute(n,w),l.fromBufferAttribute(n,M),h.fromBufferAttribute(n,C),a.add(u),l.add(u),h.add(u),n.setXYZ(w,a.x,a.y,a.z),n.setXYZ(M,l.x,l.y,l.z),n.setXYZ(C,h.x,h.y,h.z)}else for(let _=0,x=e.count;_<x;_+=3)r.fromBufferAttribute(e,_+0),o.fromBufferAttribute(e,_+1),s.fromBufferAttribute(e,_+2),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),n.setXYZ(_+0,u.x,u.y,u.z),n.setXYZ(_+1,u.x,u.y,u.z),n.setXYZ(_+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(t.attributes[r]===void 0)continue;const o=n[r].array,s=t.attributes[r],a=s.array,l=s.itemSize*e,h=Math.min(a.length,o.length-l);for(let u=0,p=l;u<h;u++,p++)o[p]=a[u]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)fi.fromBufferAttribute(t,e),fi.normalize(),t.setXYZ(e,fi.x,fi.y,fi.z)}toNonIndexed(){function t(a,l){const h=a.array,u=a.itemSize,p=a.normalized,_=new h.constructor(l.length*u);let x=0,w=0;for(let M=0,C=l.length;M<C;M++){x=a.isInterleavedBufferAttribute?l[M]*a.data.stride+a.offset:l[M]*u;for(let G=0;G<u;G++)_[w++]=h[x++]}return new Yn(_,u,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Wn,n=this.index.array,r=this.attributes;for(const a in r){const l=t(r[a],n);e.setAttribute(a,l)}const o=this.morphAttributes;for(const a in o){const l=[],h=o[a];for(let u=0,p=h.length;u<p;u++){const _=t(h[u],n);l.push(_)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const h=s[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(t[h]=l[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const h=n[l];t.data.attributes[l]=h.toJSON(t.data)}const r={};let o=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let p=0,_=h.length;p<_;p++){const x=h[p];u.push(x.toJSON(t.data))}u.length>0&&(r[l]=u,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new Wn().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const r=t.attributes;for(const h in r){const u=r[h];this.setAttribute(h,u.clone(e))}const o=t.morphAttributes;for(const h in o){const u=[],p=o[h];for(let _=0,x=p.length;_<x;_++)u.push(p[_].clone(e));this.morphAttributes[h]=u}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let h=0,u=s.length;h<u;h++){const p=s[h];this.addGroup(p.start,p.count,p.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Wn.prototype.isBufferGeometry=!0;const To=new tn,Fr=new pi,wo=new Ge,Ar=new B,Mr=new B,or=new B,Eo=new B,So=new B,Ao=new B,Y=new B,g=new B,m=new B,y=new R,N=new R,q=new R,ht=new B,xt=new B;class Tt extends kn{constructor(t=new Wn,e=new Qi){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),wo.copy(n.boundingSphere),wo.applyMatrix4(o),t.ray.intersectsSphere(wo)===!1)||(To.copy(o).invert(),Fr.copy(t.ray).applyMatrix4(To),n.boundingBox!==null&&Fr.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,u=n.morphTargetsRelative,p=n.attributes.uv,_=n.attributes.uv2,x=n.groups,w=n.drawRange;if(a!==null)if(Array.isArray(r))for(let M=0,C=x.length;M<C;M++){const G=x[M],Q=r[G.materialIndex];for(let nt=Math.max(G.start,w.start),ct=Math.min(G.start+G.count,w.start+w.count);nt<ct;nt+=3){const it=a.getX(nt),mt=a.getX(nt+1),lt=a.getX(nt+2);s=Kt(this,Q,t,Fr,l,h,u,p,_,it,mt,lt),s&&(s.faceIndex=Math.floor(nt/3),s.face.materialIndex=G.materialIndex,e.push(s))}}else for(let M=Math.max(0,w.start),C=Math.min(a.count,w.start+w.count);M<C;M+=3){const G=a.getX(M),Q=a.getX(M+1),nt=a.getX(M+2);s=Kt(this,r,t,Fr,l,h,u,p,_,G,Q,nt),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}else if(l!==void 0)if(Array.isArray(r))for(let M=0,C=x.length;M<C;M++){const G=x[M],Q=r[G.materialIndex];for(let nt=Math.max(G.start,w.start),ct=Math.min(G.start+G.count,w.start+w.count);nt<ct;nt+=3)s=Kt(this,Q,t,Fr,l,h,u,p,_,nt,nt+1,nt+2),s&&(s.faceIndex=Math.floor(nt/3),s.face.materialIndex=G.materialIndex,e.push(s))}else for(let M=Math.max(0,w.start),C=Math.min(l.count,w.start+w.count);M<C;M+=3)s=Kt(this,r,t,Fr,l,h,u,p,_,M,M+1,M+2),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Kt(i,t,e,n,r,o,s,a,l,h,u,p){Ar.fromBufferAttribute(r,h),Mr.fromBufferAttribute(r,u),or.fromBufferAttribute(r,p);const _=i.morphTargetInfluences;if(t.morphTargets&&o&&_){Y.set(0,0,0),g.set(0,0,0),m.set(0,0,0);for(let w=0,M=o.length;w<M;w++){const C=_[w],G=o[w];C!==0&&(Eo.fromBufferAttribute(G,h),So.fromBufferAttribute(G,u),Ao.fromBufferAttribute(G,p),s?(Y.addScaledVector(Eo,C),g.addScaledVector(So,C),m.addScaledVector(Ao,C)):(Y.addScaledVector(Eo.sub(Ar),C),g.addScaledVector(So.sub(Mr),C),m.addScaledVector(Ao.sub(or),C)))}Ar.add(Y),Mr.add(g),or.add(m)}i.isSkinnedMesh&&(i.boneTransform(h,Ar),i.boneTransform(u,Mr),i.boneTransform(p,or));const x=function(w,M,C,G,Q,nt,ct,it){let mt;if(mt=M.side===1?G.intersectTriangle(ct,nt,Q,!0,it):G.intersectTriangle(Q,nt,ct,M.side!==2,it),mt===null)return null;xt.copy(it),xt.applyMatrix4(w.matrixWorld);const lt=C.ray.origin.distanceTo(xt);return lt<C.near||lt>C.far?null:{distance:lt,point:xt.clone(),object:w}}(i,t,e,n,Ar,Mr,or,ht);if(x){a&&(y.fromBufferAttribute(a,h),N.fromBufferAttribute(a,u),q.fromBufferAttribute(a,p),x.uv=ui.getUV(ht,Ar,Mr,or,y,N,q,new R)),l&&(y.fromBufferAttribute(l,h),N.fromBufferAttribute(l,u),q.fromBufferAttribute(l,p),x.uv2=ui.getUV(ht,Ar,Mr,or,y,N,q,new R));const w={a:h,b:u,c:p,normal:new B,materialIndex:0};ui.getNormal(Ar,Mr,or,w.normal),x.face=w}return x}Tt.prototype.isMesh=!0;class ee extends Wn{constructor(t=1,e=1,n=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],h=[],u=[],p=[];let _=0,x=0;function w(M,C,G,Q,nt,ct,it,mt,lt,gt,Ut){const Ft=ct/lt,Mt=it/gt,At=ct/2,Ot=it/2,Lt=mt/2,ne=lt+1,$t=gt+1;let zt=0,Yt=0;const ge=new B;for(let be=0;be<$t;be++){const Pe=be*Mt-Ot;for(let Ct=0;Ct<ne;Ct++){const Bt=Ct*Ft-At;ge[M]=Bt*Q,ge[C]=Pe*nt,ge[G]=Lt,h.push(ge.x,ge.y,ge.z),ge[M]=0,ge[C]=0,ge[G]=mt>0?1:-1,u.push(ge.x,ge.y,ge.z),p.push(Ct/lt),p.push(1-be/gt),zt+=1}}for(let be=0;be<gt;be++)for(let Pe=0;Pe<lt;Pe++){const Ct=_+Pe+ne*be,Bt=_+Pe+ne*(be+1),ve=_+(Pe+1)+ne*(be+1),le=_+(Pe+1)+ne*be;l.push(Ct,Bt,le),l.push(Bt,ve,le),Yt+=6}a.addGroup(x,Yt,Ut),x+=Yt,_+=zt}w("z","y","x",-1,-1,n,e,t,s,o,0),w("z","y","x",1,-1,n,e,-t,s,o,1),w("x","z","y",1,1,t,n,e,r,s,2),w("x","z","y",1,-1,t,n,-e,r,s,3),w("x","y","z",1,-1,t,e,n,r,o,4),w("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(l),this.setAttribute("position",new An(h,3)),this.setAttribute("normal",new An(u,3)),this.setAttribute("uv",new An(p,2))}static fromJSON(t){return new ee(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Fe(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[e][n]=r.clone():Array.isArray(r)?t[e][n]=r.slice():t[e][n]=r}}return t}function Te(i){const t={};for(let e=0;e<i.length;e++){const n=Fe(i[e]);for(const r in n)t[r]=n[r]}return t}const Qe={clone:Fe,merge:Te};class hn extends Ci{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Fe(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?e.uniforms[r]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?e.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?e.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?e.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?e.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?e.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?e.uniforms[r]={type:"m4",value:o.toArray()}:e.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}hn.prototype.isShaderMaterial=!0;class vn extends kn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tn,this.projectionMatrix=new tn,this.projectionMatrixInverse=new tn}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}vn.prototype.isCamera=!0;class un extends vn{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*J*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*z*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*J*Math.atan(Math.tan(.5*z*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,o,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*z*this.fov)/this.zoom,n=2*e,r=this.aspect*n,o=-.5*r;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,h=s.fullHeight;o+=s.offsetX*r/l,e-=s.offsetY*n/h,r*=s.width/l,n*=s.height/h}const a=this.filmOffset;a!==0&&(o+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}un.prototype.isPerspectiveCamera=!0;class Kn extends kn{constructor(t,e,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new un(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new B(1,0,0)),this.add(r);const o=new un(90,1,t,e);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new B(-1,0,0)),this.add(o);const s=new un(90,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new B(0,1,0)),this.add(s);const a=new un(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new B(0,-1,0)),this.add(a);const l=new un(90,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new B(0,0,1)),this.add(l);const h=new un(90,1,t,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new B(0,0,-1)),this.add(h)}update(t,e){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,o,s,a,l,h]=this.children,u=t.xr.enabled,p=t.getRenderTarget();t.xr.enabled=!1;const _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=_,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(p),t.xr.enabled=u}}class mi extends ${constructor(t,e,n,r,o,s,a,l,h,u){super(t=t!==void 0?t:[],e=e!==void 0?e:301,n,r,o,s,a=a!==void 0?a:1022,l,h,u),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}mi.prototype.isCubeTexture=!0;class gi extends Vt{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new mi(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.generateMipmaps=e.generateMipmaps!==void 0&&e.generateMipmaps,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:1006,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=1023,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ee(5,5,5),o=new hn({name:"CubemapFromEquirect",uniforms:Fe(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=e;const s=new Tt(r,o),a=e.minFilter;return e.minFilter===1008&&(e.minFilter=1006),new Kn(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){const o=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(o)}}gi.prototype.isWebGLCubeRenderTarget=!0;const ei=new B,Di=new B,Fi=new U;class hi{constructor(t=new B(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=ei.subVectors(n,e).cross(Di.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(ei),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(n).multiplyScalar(o).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Fi.getNormalMatrix(t),r=this.coplanarPoint(ei).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}hi.prototype.isPlane=!0;const Ti=new Ge,vr=new B;class Br{constructor(t=new hi,e=new hi,n=new hi,r=new hi,o=new hi,s=new hi){this.planes=[t,e,n,r,o,s]}set(t,e,n,r,o,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],o=n[1],s=n[2],a=n[3],l=n[4],h=n[5],u=n[6],p=n[7],_=n[8],x=n[9],w=n[10],M=n[11],C=n[12],G=n[13],Q=n[14],nt=n[15];return e[0].setComponents(a-r,p-l,M-_,nt-C).normalize(),e[1].setComponents(a+r,p+l,M+_,nt+C).normalize(),e[2].setComponents(a+o,p+h,M+x,nt+G).normalize(),e[3].setComponents(a-o,p-h,M-x,nt-G).normalize(),e[4].setComponents(a-s,p-u,M-w,nt-Q).normalize(),e[5].setComponents(a+s,p+u,M+w,nt+Q).normalize(),this}intersectsObject(t){const e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Ti.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ti)}intersectsSprite(t){return Ti.center.set(0,0,0),Ti.radius=.7071067811865476,Ti.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ti)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(vr.x=r.normal.x>0?t.max.x:t.min.x,vr.y=r.normal.y>0?t.max.y:t.min.y,vr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(vr)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function $o(){let i=null,t=!1,e=null,n=null;function r(o,s){e(o,s),n=i.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){i=o}}}function ts(i,t){const e=t.isWebGL2,n=new WeakMap;return{get:function(r){return r.isInterleavedBufferAttribute&&(r=r.data),n.get(r)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);const o=n.get(r);o&&(i.deleteBuffer(o.buffer),n.delete(r))},update:function(r,o){if(r.isGLBufferAttribute){const a=n.get(r);return void((!a||a.version<r.version)&&n.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version}))}r.isInterleavedBufferAttribute&&(r=r.data);const s=n.get(r);s===void 0?n.set(r,function(a,l){const h=a.array,u=a.usage,p=i.createBuffer();i.bindBuffer(l,p),i.bufferData(l,h,u),a.onUploadCallback();let _=5126;return h instanceof Float32Array?_=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?a.isFloat16BufferAttribute?e?_=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):_=5123:h instanceof Int16Array?_=5122:h instanceof Uint32Array?_=5125:h instanceof Int32Array?_=5124:h instanceof Int8Array?_=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(_=5121),{buffer:p,type:_,bytesPerElement:h.BYTES_PER_ELEMENT,version:a.version}}(r,o)):s.version<r.version&&(function(a,l,h){const u=l.array,p=l.updateRange;i.bindBuffer(h,a),p.count===-1?i.bufferSubData(h,0,u):(e?i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u,p.offset,p.count):i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u.subarray(p.offset,p.offset+p.count)),p.count=-1)}(s.buffer,r,o),s.version=r.version)}}}class Cr extends Wn{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const o=t/2,s=e/2,a=Math.floor(n),l=Math.floor(r),h=a+1,u=l+1,p=t/a,_=e/l,x=[],w=[],M=[],C=[];for(let G=0;G<u;G++){const Q=G*_-s;for(let nt=0;nt<h;nt++){const ct=nt*p-o;w.push(ct,-Q,0),M.push(0,0,1),C.push(nt/a),C.push(1-G/l)}}for(let G=0;G<l;G++)for(let Q=0;Q<a;Q++){const nt=Q+h*G,ct=Q+h*(G+1),it=Q+1+h*(G+1),mt=Q+1+h*G;x.push(nt,ct,mt),x.push(ct,it,mt)}this.setIndex(x),this.setAttribute("position",new An(w,3)),this.setAttribute("normal",new An(M,3)),this.setAttribute("uv",new An(C,2))}static fromJSON(t){return new Cr(t.width,t.height,t.widthSegments,t.heightSegments)}}const On={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},sn={common:{diffuse:{value:new fn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new U},uv2Transform:{value:new U},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new R(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new U}},sprite:{diffuse:{value:new fn(16777215)},opacity:{value:1},center:{value:new R(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new U}}},Rr={basic:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.fog]),vertexShader:On.meshbasic_vert,fragmentShader:On.meshbasic_frag},lambert:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshlambert_vert,fragmentShader:On.meshlambert_frag},phong:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:On.meshphong_vert,fragmentShader:On.meshphong_frag},standard:{uniforms:Te([sn.common,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.roughnessmap,sn.metalnessmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag},toon:{uniforms:Te([sn.common,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.gradientmap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshtoon_vert,fragmentShader:On.meshtoon_frag},matcap:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,{matcap:{value:null}}]),vertexShader:On.meshmatcap_vert,fragmentShader:On.meshmatcap_frag},points:{uniforms:Te([sn.points,sn.fog]),vertexShader:On.points_vert,fragmentShader:On.points_frag},dashed:{uniforms:Te([sn.common,sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:On.linedashed_vert,fragmentShader:On.linedashed_frag},depth:{uniforms:Te([sn.common,sn.displacementmap]),vertexShader:On.depth_vert,fragmentShader:On.depth_frag},normal:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,{opacity:{value:1}}]),vertexShader:On.normal_vert,fragmentShader:On.normal_frag},sprite:{uniforms:Te([sn.sprite,sn.fog]),vertexShader:On.sprite_vert,fragmentShader:On.sprite_frag},background:{uniforms:{uvTransform:{value:new U},t2D:{value:null}},vertexShader:On.background_vert,fragmentShader:On.background_frag},cube:{uniforms:Te([sn.envmap,{opacity:{value:1}}]),vertexShader:On.cube_vert,fragmentShader:On.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:On.equirect_vert,fragmentShader:On.equirect_frag},distanceRGBA:{uniforms:Te([sn.common,sn.displacementmap,{referencePosition:{value:new B},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:On.distanceRGBA_vert,fragmentShader:On.distanceRGBA_frag},shadow:{uniforms:Te([sn.lights,sn.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:On.shadow_vert,fragmentShader:On.shadow_frag}};function Ch(i,t,e,n,r){const o=new fn(0);let s,a,l=0,h=null,u=0,p=null;function _(x,w){e.buffers.color.setClear(x.r,x.g,x.b,w,r)}return{getClearColor:function(){return o},setClearColor:function(x,w=1){o.set(x),l=w,_(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,_(o,l)},render:function(x,w){let M=!1,C=w.isScene===!0?w.background:null;C&&C.isTexture&&(C=t.get(C));const G=i.xr,Q=G.getSession&&G.getSession();Q&&Q.environmentBlendMode==="additive"&&(C=null),C===null?_(o,l):C&&C.isColor&&(_(C,1),M=!0),(i.autoClear||M)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),C&&(C.isCubeTexture||C.mapping===306)?(a===void 0&&(a=new Tt(new ee(1,1,1),new hn({name:"BackgroundCubeMaterial",uniforms:Fe(Rr.cube.uniforms),vertexShader:Rr.cube.vertexShader,fragmentShader:Rr.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(nt,ct,it){this.matrixWorld.copyPosition(it.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),a.material.uniforms.envMap.value=C,a.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C._needsFlipEnvMap?-1:1,h===C&&u===C.version&&p===i.toneMapping||(a.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(a,a.geometry,a.material,0,0,null)):C&&C.isTexture&&(s===void 0&&(s=new Tt(new Cr(2,2),new hn({name:"BackgroundMaterial",uniforms:Fe(Rr.background.uniforms),vertexShader:Rr.background.vertexShader,fragmentShader:Rr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=C,C.matrixAutoUpdate===!0&&C.updateMatrix(),s.material.uniforms.uvTransform.value.copy(C.matrix),h===C&&u===C.version&&p===i.toneMapping||(s.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(s,s.geometry,s.material,0,0,null))}}}function ao(i,t,e,n){const r=i.getParameter(34921),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),s=n.isWebGL2||o!==null,a={},l=_(null);let h=l;function u(ct){return n.isWebGL2?i.bindVertexArray(ct):o.bindVertexArrayOES(ct)}function p(ct){return n.isWebGL2?i.deleteVertexArray(ct):o.deleteVertexArrayOES(ct)}function _(ct){const it=[],mt=[],lt=[];for(let gt=0;gt<r;gt++)it[gt]=0,mt[gt]=0,lt[gt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:it,enabledAttributes:mt,attributeDivisors:lt,object:ct,attributes:{},index:null}}function x(){const ct=h.newAttributes;for(let it=0,mt=ct.length;it<mt;it++)ct[it]=0}function w(ct){M(ct,0)}function M(ct,it){const mt=h.newAttributes,lt=h.enabledAttributes,gt=h.attributeDivisors;mt[ct]=1,lt[ct]===0&&(i.enableVertexAttribArray(ct),lt[ct]=1),gt[ct]!==it&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ct,it),gt[ct]=it)}function C(){const ct=h.newAttributes,it=h.enabledAttributes;for(let mt=0,lt=it.length;mt<lt;mt++)it[mt]!==ct[mt]&&(i.disableVertexAttribArray(mt),it[mt]=0)}function G(ct,it,mt,lt,gt,Ut){n.isWebGL2!==!0||mt!==5124&&mt!==5125?i.vertexAttribPointer(ct,it,mt,lt,gt,Ut):i.vertexAttribIPointer(ct,it,mt,gt,Ut)}function Q(){nt(),h!==l&&(h=l,u(h.object))}function nt(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(ct,it,mt,lt,gt){let Ut=!1;if(s){const Ft=function(Mt,At,Ot){const Lt=Ot.wireframe===!0;let ne=a[Mt.id];ne===void 0&&(ne={},a[Mt.id]=ne);let $t=ne[At.id];$t===void 0&&($t={},ne[At.id]=$t);let zt=$t[Lt];return zt===void 0&&(zt=_(n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()),$t[Lt]=zt),zt}(lt,mt,it);h!==Ft&&(h=Ft,u(h.object)),Ut=function(Mt,At){const Ot=h.attributes,Lt=Mt.attributes;let ne=0;for(const $t in Lt){const zt=Ot[$t],Yt=Lt[$t];if(zt===void 0||zt.attribute!==Yt||zt.data!==Yt.data)return!0;ne++}return h.attributesNum!==ne||h.index!==At}(lt,gt),Ut&&function(Mt,At){const Ot={},Lt=Mt.attributes;let ne=0;for(const $t in Lt){const zt=Lt[$t],Yt={};Yt.attribute=zt,zt.data&&(Yt.data=zt.data),Ot[$t]=Yt,ne++}h.attributes=Ot,h.attributesNum=ne,h.index=At}(lt,gt)}else{const Ft=it.wireframe===!0;h.geometry===lt.id&&h.program===mt.id&&h.wireframe===Ft||(h.geometry=lt.id,h.program=mt.id,h.wireframe=Ft,Ut=!0)}ct.isInstancedMesh===!0&&(Ut=!0),gt!==null&&e.update(gt,34963),Ut&&(function(Ft,Mt,At,Ot){if(n.isWebGL2===!1&&(Ft.isInstancedMesh||Ot.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();const Lt=Ot.attributes,ne=At.getAttributes(),$t=Mt.defaultAttributeValues;for(const zt in ne){const Yt=ne[zt];if(Yt>=0){const ge=Lt[zt];if(ge!==void 0){const be=ge.normalized,Pe=ge.itemSize,Ct=e.get(ge);if(Ct===void 0)continue;const Bt=Ct.buffer,ve=Ct.type,le=Ct.bytesPerElement;if(ge.isInterleavedBufferAttribute){const se=ge.data,Ie=se.stride,Le=ge.offset;se&&se.isInstancedInterleavedBuffer?(M(Yt,se.meshPerAttribute),Ot._maxInstanceCount===void 0&&(Ot._maxInstanceCount=se.meshPerAttribute*se.count)):w(Yt),i.bindBuffer(34962,Bt),G(Yt,Pe,ve,be,Ie*le,Le*le)}else ge.isInstancedBufferAttribute?(M(Yt,ge.meshPerAttribute),Ot._maxInstanceCount===void 0&&(Ot._maxInstanceCount=ge.meshPerAttribute*ge.count)):w(Yt),i.bindBuffer(34962,Bt),G(Yt,Pe,ve,be,0,0)}else if(zt==="instanceMatrix"){const be=e.get(Ft.instanceMatrix);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;M(Yt+0,1),M(Yt+1,1),M(Yt+2,1),M(Yt+3,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Yt+0,4,Ct,!1,64,0),i.vertexAttribPointer(Yt+1,4,Ct,!1,64,16),i.vertexAttribPointer(Yt+2,4,Ct,!1,64,32),i.vertexAttribPointer(Yt+3,4,Ct,!1,64,48)}else if(zt==="instanceColor"){const be=e.get(Ft.instanceColor);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;M(Yt,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Yt,3,Ct,!1,12,0)}else if($t!==void 0){const be=$t[zt];if(be!==void 0)switch(be.length){case 2:i.vertexAttrib2fv(Yt,be);break;case 3:i.vertexAttrib3fv(Yt,be);break;case 4:i.vertexAttrib4fv(Yt,be);break;default:i.vertexAttrib1fv(Yt,be)}}}}C()}(ct,it,mt,lt),gt!==null&&i.bindBuffer(34963,e.get(gt).buffer))},reset:Q,resetDefaultState:nt,dispose:function(){Q();for(const ct in a){const it=a[ct];for(const mt in it){const lt=it[mt];for(const gt in lt)p(lt[gt].object),delete lt[gt];delete it[mt]}delete a[ct]}},releaseStatesOfGeometry:function(ct){if(a[ct.id]===void 0)return;const it=a[ct.id];for(const mt in it){const lt=it[mt];for(const gt in lt)p(lt[gt].object),delete lt[gt];delete it[mt]}delete a[ct.id]},releaseStatesOfProgram:function(ct){for(const it in a){const mt=a[it];if(mt[ct.id]===void 0)continue;const lt=mt[ct.id];for(const gt in lt)p(lt[gt].object),delete lt[gt];delete mt[ct.id]}},initAttributes:x,enableAttribute:w,disableUnusedAttributes:C}}function es(i,t,e,n){const r=n.isWebGL2;let o;this.setMode=function(s){o=s},this.render=function(s,a){i.drawArrays(o,s,a),e.update(a,o,1)},this.renderInstances=function(s,a,l){if(l===0)return;let h,u;if(r)h=i,u="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",h===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](o,s,a,l),e.update(a,o,l)}}function Rh(i,t,e){let n;function r(ct){if(ct==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ct="mediump"}return ct==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext;let s=e.precision!==void 0?e.precision:"highp";const a=r(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||t.has("WEBGL_draw_buffers"),h=e.logarithmicDepthBuffer===!0,u=i.getParameter(34930),p=i.getParameter(35660),_=i.getParameter(3379),x=i.getParameter(34076),w=i.getParameter(34921),M=i.getParameter(36347),C=i.getParameter(36348),G=i.getParameter(36349),Q=p>0,nt=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const ct=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(ct.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:s,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:p,maxTextureSize:_,maxCubemapSize:x,maxAttributes:w,maxVertexUniforms:M,maxVaryings:C,maxFragmentUniforms:G,vertexTextures:Q,floatFragmentTextures:nt,floatVertexTextures:Q&&nt,maxSamples:o?i.getParameter(36183):0}}function Ih(i){const t=this;let e=null,n=0,r=!1,o=!1;const s=new hi,a=new U,l={value:null,needsUpdate:!1};function h(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(p,_,x,w){const M=p!==null?p.length:0;let C=null;if(M!==0){if(C=l.value,w!==!0||C===null){const G=x+4*M,Q=_.matrixWorldInverse;a.getNormalMatrix(Q),(C===null||C.length<G)&&(C=new Float32Array(G));for(let nt=0,ct=x;nt!==M;++nt,ct+=4)s.copy(p[nt]).applyMatrix4(Q,a),s.normal.toArray(C,ct),C[ct+3]=s.constant}l.value=C,l.needsUpdate=!0}return t.numPlanes=M,t.numIntersection=0,C}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,_,x){const w=p.length!==0||_||n!==0||r;return r=_,e=u(p,x,0),n=p.length,w},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,h()},this.setState=function(p,_,x){const w=p.clippingPlanes,M=p.clipIntersection,C=p.clipShadows,G=i.get(p);if(!r||w===null||w.length===0||o&&!C)o?u(null):h();else{const Q=o?0:n,nt=4*Q;let ct=G.clippingState||null;l.value=ct,ct=u(w,_,nt,x);for(let it=0;it!==nt;++it)ct[it]=e[it];G.clippingState=ct,this.numIntersection=M?this.numPlanes:0,this.numPlanes+=Q}}}function Ph(i){let t=new WeakMap;function e(r,o){return o===303?r.mapping=301:o===304&&(r.mapping=302),r}function n(r){const o=r.target;o.removeEventListener("dispose",n);const s=t.get(o);s!==void 0&&(t.delete(o),s.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===303||o===304){if(t.has(r))return e(t.get(r).texture,r.mapping);{const s=r.image;if(s&&s.height>0){const a=i.getRenderTarget(),l=new gi(s.height/2);return l.fromEquirectangularTexture(i,r),t.set(r,l),i.setRenderTarget(a),r.addEventListener("dispose",n),e(l.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}function el(i){const t={};function e(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float")},get:function(n){const r=e(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Oh(i,t,e,n){const r={},o=new WeakMap;function s(l){const h=l.target;h.index!==null&&t.remove(h.index);for(const p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",s),delete r[h.id];const u=o.get(h);u&&(t.remove(u),o.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,e.memory.geometries--}function a(l){const h=[],u=l.index,p=l.attributes.position;let _=0;if(u!==null){const M=u.array;_=u.version;for(let C=0,G=M.length;C<G;C+=3){const Q=M[C+0],nt=M[C+1],ct=M[C+2];h.push(Q,nt,nt,ct,ct,Q)}}else{const M=p.array;_=p.version;for(let C=0,G=M.length/3-1;C<G;C+=3){const Q=C+0,nt=C+1,ct=C+2;h.push(Q,nt,nt,ct,ct,Q)}}const x=new(_s(h)>65535?bo:vs)(h,1);x.version=_;const w=o.get(l);w&&t.remove(w),o.set(l,x)}return{get:function(l,h){return r[h.id]===!0||(h.addEventListener("dispose",s),r[h.id]=!0,e.memory.geometries++),h},update:function(l){const h=l.attributes;for(const p in h)t.update(h[p],34962);const u=l.morphAttributes;for(const p in u){const _=u[p];for(let x=0,w=_.length;x<w;x++)t.update(_[x],34962)}},getWireframeAttribute:function(l){const h=o.get(l);if(h){const u=l.index;u!==null&&h.version<u.version&&a(l)}else a(l);return o.get(l)}}}function Nh(i,t,e,n){const r=n.isWebGL2;let o,s,a;this.setMode=function(l){o=l},this.setIndex=function(l){s=l.type,a=l.bytesPerElement},this.render=function(l,h){i.drawElements(o,h,s,l*a),e.update(h,o,1)},this.renderInstances=function(l,h,u){if(u===0)return;let p,_;if(r)p=i,_="drawElementsInstanced";else if(p=t.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",p===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[_](o,h,s,l*a,u),e.update(h,o,u)}}function Lh(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Dh(i,t){return i[0]-t[0]}function ys(i,t){return Math.abs(t[1])-Math.abs(i[1])}function Fh(i){const t={},e=new Float32Array(8),n=[];for(let r=0;r<8;r++)n[r]=[r,0];return{update:function(r,o,s,a){const l=r.morphTargetInfluences,h=l===void 0?0:l.length;let u=t[o.id];if(u===void 0||u.length!==h){u=[];for(let M=0;M<h;M++)u[M]=[M,0];t[o.id]=u}for(let M=0;M<h;M++){const C=u[M];C[0]=M,C[1]=l[M]}u.sort(ys);for(let M=0;M<8;M++)M<h&&u[M][1]?(n[M][0]=u[M][0],n[M][1]=u[M][1]):(n[M][0]=Number.MAX_SAFE_INTEGER,n[M][1]=0);n.sort(Dh);const p=s.morphTargets&&o.morphAttributes.position,_=s.morphNormals&&o.morphAttributes.normal;let x=0;for(let M=0;M<8;M++){const C=n[M],G=C[0],Q=C[1];G!==Number.MAX_SAFE_INTEGER&&Q?(p&&o.getAttribute("morphTarget"+M)!==p[G]&&o.setAttribute("morphTarget"+M,p[G]),_&&o.getAttribute("morphNormal"+M)!==_[G]&&o.setAttribute("morphNormal"+M,_[G]),e[M]=Q,x+=Q):(p&&o.hasAttribute("morphTarget"+M)===!0&&o.deleteAttribute("morphTarget"+M),_&&o.hasAttribute("morphNormal"+M)===!0&&o.deleteAttribute("morphNormal"+M),e[M]=0)}const w=o.morphTargetsRelative?1:1-x;a.getUniforms().setValue(i,"morphTargetBaseInfluence",w),a.getUniforms().setValue(i,"morphTargetInfluences",e)}}}function Bh(i,t,e,n){let r=new WeakMap;function o(s){const a=s.target;a.removeEventListener("dispose",o),e.remove(a.instanceMatrix),a.instanceColor!==null&&e.remove(a.instanceColor)}return{update:function(s){const a=n.render.frame,l=s.geometry,h=t.get(s,l);return r.get(h)!==a&&(t.update(h),r.set(h,a)),s.isInstancedMesh&&(s.hasEventListener("dispose",o)===!1&&s.addEventListener("dispose",o),e.update(s.instanceMatrix,34962),s.instanceColor!==null&&e.update(s.instanceColor,34962)),h},dispose:function(){r=new WeakMap}}}Rr.physical={uniforms:Te([Rr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new R(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new fn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new R},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new fn(0)}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag};class nl extends ${constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}nl.prototype.isDataTexture2DArray=!0;class xs extends ${constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}xs.prototype.isDataTexture3D=!0;const il=new $,na=new nl,kh=new xs,rl=new mi,ol=[],sl=[],al=new Float32Array(16),ll=new Float32Array(9),hl=new Float32Array(4);function Mo(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let o=ol[r];if(o===void 0&&(o=new Float32Array(r),ol[r]=o),t!==0){n.toArray(o,0);for(let s=1,a=0;s!==t;++s)a+=e,i[s].toArray(o,a)}return o}function qi(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function Bi(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function ia(i,t){let e=sl[t];e===void 0&&(e=new Int32Array(t),sl[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function Uh(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function ul(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y||(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(qi(e,t))return;i.uniform2fv(this.addr,t),Bi(e,t)}}function T(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z||(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)e[0]===t.r&&e[1]===t.g&&e[2]===t.b||(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(qi(e,t))return;i.uniform3fv(this.addr,t),Bi(e,t)}}function d(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z&&e[3]===t.w||(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(qi(e,t))return;i.uniform4fv(this.addr,t),Bi(e,t)}}function c(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(qi(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),Bi(e,t)}else{if(qi(e,n))return;hl.set(n),i.uniformMatrix2fv(this.addr,!1,hl),Bi(e,n)}}function f(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(qi(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),Bi(e,t)}else{if(qi(e,n))return;ll.set(n),i.uniformMatrix3fv(this.addr,!1,ll),Bi(e,n)}}function A(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(qi(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),Bi(e,t)}else{if(qi(e,n))return;al.set(n),i.uniformMatrix4fv(this.addr,!1,al),Bi(e,n)}}function k(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function K(i,t){const e=this.cache;qi(e,t)||(i.uniform2iv(this.addr,t),Bi(e,t))}function ot(i,t){const e=this.cache;qi(e,t)||(i.uniform3iv(this.addr,t),Bi(e,t))}function dt(i,t){const e=this.cache;qi(e,t)||(i.uniform4iv(this.addr,t),Bi(e,t))}function Pt(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function kt(i,t){const e=this.cache;qi(e,t)||(i.uniform2uiv(this.addr,t),Bi(e,t))}function he(i,t){const e=this.cache;qi(e,t)||(i.uniform3uiv(this.addr,t),Bi(e,t))}function te(i,t){const e=this.cache;qi(e,t)||(i.uniform4uiv(this.addr,t),Bi(e,t))}function me(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTexture2D(t||il,r)}function xe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||kh,r)}function Be(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTextureCube(t||rl,r)}function qe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||na,r)}function Ye(i,t){i.uniform1fv(this.addr,t)}function Je(i,t){const e=Mo(t,this.size,2);i.uniform2fv(this.addr,e)}function je(i,t){const e=Mo(t,this.size,3);i.uniform3fv(this.addr,e)}function pn(i,t){const e=Mo(t,this.size,4);i.uniform4fv(this.addr,e)}function _n(i,t){const e=Mo(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function Un(i,t){const e=Mo(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function Dn(i,t){const e=Mo(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Xe(i,t){i.uniform1iv(this.addr,t)}function an(i,t){i.uniform2iv(this.addr,t)}function bn(i,t){i.uniform3iv(this.addr,t)}function Gn(i,t){i.uniform4iv(this.addr,t)}function qn(i,t){i.uniform1uiv(this.addr,t)}function wi(i,t){i.uniform2uiv(this.addr,t)}function $n(i,t){i.uniform3uiv(this.addr,t)}function vi(i,t){i.uniform4uiv(this.addr,t)}function Ri(i,t,e){const n=t.length,r=ia(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTexture2D(t[o]||il,r[o])}function Ji(i,t,e){const n=t.length,r=ia(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTextureCube(t[o]||rl,r[o])}function ki(i,t,e){this.id=i,this.addr=e,this.cache=[],this.setValue=function(n){switch(n){case 5126:return Uh;case 35664:return ul;case 35665:return T;case 35666:return d;case 35674:return c;case 35675:return f;case 35676:return A;case 5124:case 35670:return k;case 35667:case 35671:return K;case 35668:case 35672:return ot;case 35669:case 35673:return dt;case 5125:return Pt;case 36294:return kt;case 36295:return he;case 36296:return te;case 35678:case 36198:case 36298:case 36306:case 35682:return me;case 35679:case 36299:case 36307:return xe;case 35680:case 36300:case 36308:case 36293:return Be;case 36289:case 36303:case 36311:case 36292:return qe}}(t.type)}function ni(i,t,e){this.id=i,this.addr=e,this.cache=[],this.size=t.size,this.setValue=function(n){switch(n){case 5126:return Ye;case 35664:return Je;case 35665:return je;case 35666:return pn;case 35674:return _n;case 35675:return Un;case 35676:return Dn;case 5124:case 35670:return Xe;case 35667:case 35671:return an;case 35668:case 35672:return bn;case 35669:case 35673:return Gn;case 5125:return qn;case 36294:return wi;case 36295:return $n;case 36296:return vi;case 35678:case 36198:case 36298:case 36306:case 35682:return Ri;case 35680:case 36300:case 36308:case 36293:return Ji}}(t.type)}function Ei(i){this.id=i,this.seq=[],this.map={}}ni.prototype.updateCache=function(i){const t=this.cache;i instanceof Float32Array&&t.length!==i.length&&(this.cache=new Float32Array(i.length)),Bi(t,i)},Ei.prototype.setValue=function(i,t,e){const n=this.seq;for(let r=0,o=n.length;r!==o;++r){const s=n[r];s.setValue(i,t[s.id],e)}};const Ui=/(\w+)(\])?(\[|\.)?/g;function Gi(i,t){i.seq.push(t),i.map[t.id]=t}function $i(i,t,e){const n=i.name,r=n.length;for(Ui.lastIndex=0;;){const o=Ui.exec(n),s=Ui.lastIndex;let a=o[1];const l=o[2]==="]",h=o[3];if(l&&(a|=0),h===void 0||h==="["&&s+2===r){Gi(e,h===void 0?new ki(a,i,t):new ni(a,i,t));break}{let u=e.map[a];u===void 0&&(u=new Ei(a),Gi(e,u)),e=u}}}function ii(i,t){this.seq=[],this.map={};const e=i.getProgramParameter(t,35718);for(let n=0;n<e;++n){const r=i.getActiveUniform(t,n);$i(r,i.getUniformLocation(t,r.name),this)}}function cl(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}ii.prototype.setValue=function(i,t,e,n){const r=this.map[t];r!==void 0&&r.setValue(i,e,n)},ii.prototype.setOptional=function(i,t,e){const n=t[e];n!==void 0&&this.setValue(i,e,n)},ii.upload=function(i,t,e,n){for(let r=0,o=t.length;r!==o;++r){const s=t[r],a=e[s.id];a.needsUpdate!==!1&&s.setValue(i,a.value,n)}},ii.seqWithValue=function(i,t){const e=[];for(let n=0,r=i.length;n!==r;++n){const o=i[n];o.id in t&&e.push(o)}return e};let Gh=0;function dl(i){switch(i){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function pl(i,t,e){const n=i.getShaderParameter(t,35713),r=i.getShaderInfoLog(t).trim();return n&&r===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+e+`
`+r+function(o){const s=o.split(`
`);for(let a=0;a<s.length;a++)s[a]=a+1+": "+s[a];return s.join(`
`)}(i.getShaderSource(t))}function ns(i,t){const e=dl(t);return"vec4 "+i+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function Hh(i,t){const e=dl(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function Qv(i,t){let e;switch(t){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="OptimizedCineon";break;case 4:e="ACESFilmic";break;case 5:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function ra(i){return i!==""}function Yc(i,t){return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function qc(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const $v=/^[ \t]*#include +<([\w\d./]+)>/gm;function jh(i){return i.replace($v,t0)}function t0(i,t){const e=On[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return jh(e)}const e0=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,n0=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Jc(i){return i.replace(n0,Zc).replace(e0,i0)}function i0(i,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Zc(i,t,e,n)}function Zc(i,t,e,n){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function Kc(i){let t="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?t+=`
#define HIGH_PRECISION`:i.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function r0(i,t,e,n){const r=i.getContext(),o=e.defines;let s=e.vertexShader,a=e.fragmentShader;const l=function(gt){let Ut="SHADOWMAP_TYPE_BASIC";return gt.shadowMapType===1?Ut="SHADOWMAP_TYPE_PCF":gt.shadowMapType===2?Ut="SHADOWMAP_TYPE_PCF_SOFT":gt.shadowMapType===3&&(Ut="SHADOWMAP_TYPE_VSM"),Ut}(e),h=function(gt){let Ut="ENVMAP_TYPE_CUBE";if(gt.envMap)switch(gt.envMapMode){case 301:case 302:Ut="ENVMAP_TYPE_CUBE";break;case 306:case 307:Ut="ENVMAP_TYPE_CUBE_UV"}return Ut}(e),u=function(gt){let Ut="ENVMAP_MODE_REFLECTION";if(gt.envMap)switch(gt.envMapMode){case 302:case 307:Ut="ENVMAP_MODE_REFRACTION"}return Ut}(e),p=function(gt){let Ut="ENVMAP_BLENDING_NONE";if(gt.envMap)switch(gt.combine){case 0:Ut="ENVMAP_BLENDING_MULTIPLY";break;case 1:Ut="ENVMAP_BLENDING_MIX";break;case 2:Ut="ENVMAP_BLENDING_ADD"}return Ut}(e),_=i.gammaFactor>0?i.gammaFactor:1,x=e.isWebGL2?"":function(gt){return[gt.extensionDerivatives||gt.envMapCubeUV||gt.bumpMap||gt.tangentSpaceNormalMap||gt.clearcoatNormalMap||gt.flatShading||gt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(gt.extensionFragDepth||gt.logarithmicDepthBuffer)&&gt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",gt.extensionDrawBuffers&&gt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(gt.extensionShaderTextureLOD||gt.envMap||gt.transmission>0)&&gt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ra).join(`
`)}(e),w=function(gt){const Ut=[];for(const Ft in gt){const Mt=gt[Ft];Mt!==!1&&Ut.push("#define "+Ft+" "+Mt)}return Ut.join(`
`)}(o),M=r.createProgram();let C,G,Q=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(C=[w].filter(ra).join(`
`),C.length>0&&(C+=`
`),G=[x,w].filter(ra).join(`
`),G.length>0&&(G+=`
`)):(C=[Kc(e),"#define SHADER_NAME "+e.shaderName,w,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ra).join(`
`),G=[x,Kc(e),"#define SHADER_NAME "+e.shaderName,w,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+_,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+h:"",e.envMap?"#define "+u:"",e.envMap?"#define "+p:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.sheen?"#define USE_SHEEN":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==0?"#define TONE_MAPPING":"",e.toneMapping!==0?On.tonemapping_pars_fragment:"",e.toneMapping!==0?Qv("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",On.encodings_pars_fragment,e.map?ns("mapTexelToLinear",e.mapEncoding):"",e.matcap?ns("matcapTexelToLinear",e.matcapEncoding):"",e.envMap?ns("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMap?ns("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.lightMap?ns("lightMapTexelToLinear",e.lightMapEncoding):"",Hh("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(ra).join(`
`)),s=jh(s),s=Yc(s,e),s=qc(s,e),a=jh(a),a=Yc(a,e),a=qc(a,e),s=Jc(s),a=Jc(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(Q=`#version 300 es
`,C=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+C,G=["#define varying in",e.glslVersion==="300 es"?"":"out highp vec4 pc_fragColor;",e.glslVersion==="300 es"?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+G);const nt=Q+G+a,ct=cl(r,35633,Q+C+s),it=cl(r,35632,nt);if(r.attachShader(M,ct),r.attachShader(M,it),e.index0AttributeName!==void 0?r.bindAttribLocation(M,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(M,0,"position"),r.linkProgram(M),i.debug.checkShaderErrors){const gt=r.getProgramInfoLog(M).trim(),Ut=r.getShaderInfoLog(ct).trim(),Ft=r.getShaderInfoLog(it).trim();let Mt=!0,At=!0;if(r.getProgramParameter(M,35714)===!1){Mt=!1;const Ot=pl(r,ct,"vertex"),Lt=pl(r,it,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(M,35715),"gl.getProgramInfoLog",gt,Ot,Lt)}else gt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",gt):Ut!==""&&Ft!==""||(At=!1);At&&(this.diagnostics={runnable:Mt,programLog:gt,vertexShader:{log:Ut,prefix:C},fragmentShader:{log:Ft,prefix:G}})}let mt,lt;return r.deleteShader(ct),r.deleteShader(it),this.getUniforms=function(){return mt===void 0&&(mt=new ii(r,M)),mt},this.getAttributes=function(){return lt===void 0&&(lt=function(gt,Ut){const Ft={},Mt=gt.getProgramParameter(Ut,35721);for(let At=0;At<Mt;At++){const Ot=gt.getActiveAttrib(Ut,At).name;Ft[Ot]=gt.getAttribLocation(Ut,Ot)}return Ft}(r,M)),lt},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(M),this.program=void 0},this.name=e.shaderName,this.id=Gh++,this.cacheKey=t,this.usedTimes=1,this.program=M,this.vertexShader=ct,this.fragmentShader=it,this}function o0(i,t,e,n,r,o){const s=[],a=n.isWebGL2,l=n.logarithmicDepthBuffer,h=n.floatVertexTextures,u=n.maxVertexUniforms,p=n.vertexTextures;let _=n.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},w=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function M(C){let G;return C&&C.isTexture?G=C.encoding:C&&C.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),G=C.texture.encoding):G=3e3,G}return{getParameters:function(C,G,Q,nt,ct){const it=nt.fog,mt=C.isMeshStandardMaterial?nt.environment:null,lt=t.get(C.envMap||mt),gt=x[C.type],Ut=ct.isSkinnedMesh?function(Ot){const Lt=Ot.skeleton.bones;if(h)return 1024;{const ne=u,$t=Math.floor((ne-20)/4),zt=Math.min($t,Lt.length);return zt<Lt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Lt.length+" bones. This GPU supports "+zt+"."),0):zt}}(ct):0;let Ft,Mt;if(C.precision!==null&&(_=n.getMaxPrecision(C.precision),_!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",_,"instead.")),gt){const Ot=Rr[gt];Ft=Ot.vertexShader,Mt=Ot.fragmentShader}else Ft=C.vertexShader,Mt=C.fragmentShader;const At=i.getRenderTarget();return{isWebGL2:a,shaderID:gt,shaderName:C.type,vertexShader:Ft,fragmentShader:Mt,defines:C.defines,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:_,instancing:ct.isInstancedMesh===!0,instancingColor:ct.isInstancedMesh===!0&&ct.instanceColor!==null,supportsVertexTextures:p,outputEncoding:At!==null?M(At.texture):i.outputEncoding,map:!!C.map,mapEncoding:M(C.map),matcap:!!C.matcap,matcapEncoding:M(C.matcap),envMap:!!lt,envMapMode:lt&&lt.mapping,envMapEncoding:M(lt),envMapCubeUV:!!lt&&(lt.mapping===306||lt.mapping===307),lightMap:!!C.lightMap,lightMapEncoding:M(C.lightMap),aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,emissiveMapEncoding:M(C.emissiveMap),bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===1,tangentSpaceNormalMap:C.normalMapType===0,clearcoatMap:!!C.clearcoatMap,clearcoatRoughnessMap:!!C.clearcoatRoughnessMap,clearcoatNormalMap:!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,alphaMap:!!C.alphaMap,gradientMap:!!C.gradientMap,sheen:!!C.sheen,transmission:!!C.transmission,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:C.normalMap&&C.vertexTangents,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&ct.geometry&&ct.geometry.attributes.color&&ct.geometry.attributes.color.itemSize===4,vertexUvs:!!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatMap||C.clearcoatRoughnessMap||C.clearcoatNormalMap||C.displacementMap||C.transmissionMap||C.thicknessMap),uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.transmission||C.transmissionMap||C.thicknessMap||!C.displacementMap),fog:!!it,useFog:C.fog,fogExp2:it&&it.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:l,skinning:ct.isSkinnedMesh===!0&&Ut>0,maxBones:Ut,useVertexTexture:h,morphTargets:C.morphTargets,morphNormals:C.morphNormals,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&Q.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,alphaTest:C.alphaTest,doubleSided:C.side===2,flipSided:C.side===1,depthPacking:C.depthPacking!==void 0&&C.depthPacking,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||e.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||e.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||e.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function(C){const G=[];if(C.shaderID?G.push(C.shaderID):(G.push(C.fragmentShader),G.push(C.vertexShader)),C.defines!==void 0)for(const Q in C.defines)G.push(Q),G.push(C.defines[Q]);if(C.isRawShaderMaterial===!1){for(let Q=0;Q<w.length;Q++)G.push(C[w[Q]]);G.push(i.outputEncoding),G.push(i.gammaFactor)}return G.push(C.customProgramCacheKey),G.join()},getUniforms:function(C){const G=x[C.type];let Q;if(G){const nt=Rr[G];Q=Qe.clone(nt.uniforms)}else Q=C.uniforms;return Q},acquireProgram:function(C,G){let Q;for(let nt=0,ct=s.length;nt<ct;nt++){const it=s[nt];if(it.cacheKey===G){Q=it,++Q.usedTimes;break}}return Q===void 0&&(Q=new r0(i,G,C,r),s.push(Q)),Q},releaseProgram:function(C){if(--C.usedTimes==0){const G=s.indexOf(C);s[G]=s[s.length-1],s.pop(),C.destroy()}},programs:s}}function s0(){let i=new WeakMap;return{get:function(t){let e=i.get(t);return e===void 0&&(e={},i.set(t,e)),e},remove:function(t){i.delete(t)},update:function(t,e,n){i.get(t)[e]=n},dispose:function(){i=new WeakMap}}}function a0(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.program!==t.program?i.program.id-t.program.id:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function Qc(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function $c(i){const t=[];let e=0;const n=[],r=[],o=[],s={id:-1};function a(l,h,u,p,_,x){let w=t[e];const M=i.get(u);return w===void 0?(w={id:l.id,object:l,geometry:h,material:u,program:M.program||s,groupOrder:p,renderOrder:l.renderOrder,z:_,group:x},t[e]=w):(w.id=l.id,w.object=l,w.geometry=h,w.material=u,w.program=M.program||s,w.groupOrder=p,w.renderOrder=l.renderOrder,w.z=_,w.group=x),e++,w}return{opaque:n,transmissive:r,transparent:o,init:function(){e=0,n.length=0,r.length=0,o.length=0},push:function(l,h,u,p,_,x){const w=a(l,h,u,p,_,x);u.transmission>0?r.push(w):u.transparent===!0?o.push(w):n.push(w)},unshift:function(l,h,u,p,_,x){const w=a(l,h,u,p,_,x);u.transmission>0?r.unshift(w):u.transparent===!0?o.unshift(w):n.unshift(w)},finish:function(){for(let l=e,h=t.length;l<h;l++){const u=t[l];if(u.id===null)break;u.id=null,u.object=null,u.geometry=null,u.material=null,u.program=null,u.group=null}},sort:function(l,h){n.length>1&&n.sort(l||a0),r.length>1&&r.sort(h||Qc),o.length>1&&o.sort(h||Qc)}}}function l0(i){let t=new WeakMap;return{get:function(e,n){let r;return t.has(e)===!1?(r=new $c(i),t.set(e,[r])):n>=t.get(e).length?(r=new $c(i),t.get(e).push(r)):r=t.get(e)[n],r},dispose:function(){t=new WeakMap}}}function h0(){const i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new B,color:new fn};break;case"SpotLight":e={position:new B,direction:new B,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new B,color:new fn,distance:0,decay:0};break;case"HemisphereLight":e={direction:new B,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":e={color:new fn,position:new B,halfWidth:new B,halfHeight:new B}}return i[t.id]=e,e}}}let u0=0;function c0(i,t){return(t.castShadow?1:0)-(i.castShadow?1:0)}function d0(i,t){const e=new h0,n=function(){const l={};return{get:function(h){if(l[h.id]!==void 0)return l[h.id];let u;switch(h.type){case"DirectionalLight":case"SpotLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new R};break;case"PointLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new R,shadowCameraNear:1,shadowCameraFar:1e3}}return l[h.id]=u,u}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new B);const o=new B,s=new tn,a=new tn;return{setup:function(l){let h=0,u=0,p=0;for(let it=0;it<9;it++)r.probe[it].set(0,0,0);let _=0,x=0,w=0,M=0,C=0,G=0,Q=0,nt=0;l.sort(c0);for(let it=0,mt=l.length;it<mt;it++){const lt=l[it],gt=lt.color,Ut=lt.intensity,Ft=lt.distance,Mt=lt.shadow&&lt.shadow.map?lt.shadow.map.texture:null;if(lt.isAmbientLight)h+=gt.r*Ut,u+=gt.g*Ut,p+=gt.b*Ut;else if(lt.isLightProbe)for(let At=0;At<9;At++)r.probe[At].addScaledVector(lt.sh.coefficients[At],Ut);else if(lt.isDirectionalLight){const At=e.get(lt);if(At.color.copy(lt.color).multiplyScalar(lt.intensity),lt.castShadow){const Ot=lt.shadow,Lt=n.get(lt);Lt.shadowBias=Ot.bias,Lt.shadowNormalBias=Ot.normalBias,Lt.shadowRadius=Ot.radius,Lt.shadowMapSize=Ot.mapSize,r.directionalShadow[_]=Lt,r.directionalShadowMap[_]=Mt,r.directionalShadowMatrix[_]=lt.shadow.matrix,G++}r.directional[_]=At,_++}else if(lt.isSpotLight){const At=e.get(lt);if(At.position.setFromMatrixPosition(lt.matrixWorld),At.color.copy(gt).multiplyScalar(Ut),At.distance=Ft,At.coneCos=Math.cos(lt.angle),At.penumbraCos=Math.cos(lt.angle*(1-lt.penumbra)),At.decay=lt.decay,lt.castShadow){const Ot=lt.shadow,Lt=n.get(lt);Lt.shadowBias=Ot.bias,Lt.shadowNormalBias=Ot.normalBias,Lt.shadowRadius=Ot.radius,Lt.shadowMapSize=Ot.mapSize,r.spotShadow[w]=Lt,r.spotShadowMap[w]=Mt,r.spotShadowMatrix[w]=lt.shadow.matrix,nt++}r.spot[w]=At,w++}else if(lt.isRectAreaLight){const At=e.get(lt);At.color.copy(gt).multiplyScalar(Ut),At.halfWidth.set(.5*lt.width,0,0),At.halfHeight.set(0,.5*lt.height,0),r.rectArea[M]=At,M++}else if(lt.isPointLight){const At=e.get(lt);if(At.color.copy(lt.color).multiplyScalar(lt.intensity),At.distance=lt.distance,At.decay=lt.decay,lt.castShadow){const Ot=lt.shadow,Lt=n.get(lt);Lt.shadowBias=Ot.bias,Lt.shadowNormalBias=Ot.normalBias,Lt.shadowRadius=Ot.radius,Lt.shadowMapSize=Ot.mapSize,Lt.shadowCameraNear=Ot.camera.near,Lt.shadowCameraFar=Ot.camera.far,r.pointShadow[x]=Lt,r.pointShadowMap[x]=Mt,r.pointShadowMatrix[x]=lt.shadow.matrix,Q++}r.point[x]=At,x++}else if(lt.isHemisphereLight){const At=e.get(lt);At.skyColor.copy(lt.color).multiplyScalar(Ut),At.groundColor.copy(lt.groundColor).multiplyScalar(Ut),r.hemi[C]=At,C++}}M>0&&(t.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_FLOAT_1,r.rectAreaLTC2=sn.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_HALF_1,r.rectAreaLTC2=sn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=u,r.ambient[2]=p;const ct=r.hash;ct.directionalLength===_&&ct.pointLength===x&&ct.spotLength===w&&ct.rectAreaLength===M&&ct.hemiLength===C&&ct.numDirectionalShadows===G&&ct.numPointShadows===Q&&ct.numSpotShadows===nt||(r.directional.length=_,r.spot.length=w,r.rectArea.length=M,r.point.length=x,r.hemi.length=C,r.directionalShadow.length=G,r.directionalShadowMap.length=G,r.pointShadow.length=Q,r.pointShadowMap.length=Q,r.spotShadow.length=nt,r.spotShadowMap.length=nt,r.directionalShadowMatrix.length=G,r.pointShadowMatrix.length=Q,r.spotShadowMatrix.length=nt,ct.directionalLength=_,ct.pointLength=x,ct.spotLength=w,ct.rectAreaLength=M,ct.hemiLength=C,ct.numDirectionalShadows=G,ct.numPointShadows=Q,ct.numSpotShadows=nt,r.version=u0++)},setupView:function(l,h){let u=0,p=0,_=0,x=0,w=0;const M=h.matrixWorldInverse;for(let C=0,G=l.length;C<G;C++){const Q=l[C];if(Q.isDirectionalLight){const nt=r.directional[u];nt.direction.setFromMatrixPosition(Q.matrixWorld),o.setFromMatrixPosition(Q.target.matrixWorld),nt.direction.sub(o),nt.direction.transformDirection(M),u++}else if(Q.isSpotLight){const nt=r.spot[_];nt.position.setFromMatrixPosition(Q.matrixWorld),nt.position.applyMatrix4(M),nt.direction.setFromMatrixPosition(Q.matrixWorld),o.setFromMatrixPosition(Q.target.matrixWorld),nt.direction.sub(o),nt.direction.transformDirection(M),_++}else if(Q.isRectAreaLight){const nt=r.rectArea[x];nt.position.setFromMatrixPosition(Q.matrixWorld),nt.position.applyMatrix4(M),a.identity(),s.copy(Q.matrixWorld),s.premultiply(M),a.extractRotation(s),nt.halfWidth.set(.5*Q.width,0,0),nt.halfHeight.set(0,.5*Q.height,0),nt.halfWidth.applyMatrix4(a),nt.halfHeight.applyMatrix4(a),x++}else if(Q.isPointLight){const nt=r.point[p];nt.position.setFromMatrixPosition(Q.matrixWorld),nt.position.applyMatrix4(M),p++}else if(Q.isHemisphereLight){const nt=r.hemi[w];nt.direction.setFromMatrixPosition(Q.matrixWorld),nt.direction.transformDirection(M),nt.direction.normalize(),w++}}},state:r}}function td(i,t){const e=new d0(i,t),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:function(){e.setup(n)},setupLightsView:function(o){e.setupView(n,o)},pushLight:function(o){n.push(o)},pushShadow:function(o){r.push(o)}}}function p0(i,t){let e=new WeakMap;return{get:function(n,r=0){let o;return e.has(n)===!1?(o=new td(i,t),e.set(n,[o])):r>=e.get(n).length?(o=new td(i,t),e.get(n).push(o)):o=e.get(n)[r],o},dispose:function(){e=new WeakMap}}}class ed extends Ci{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}ed.prototype.isMeshDepthMaterial=!0;class nd extends Ci{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new B,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}nd.prototype.isMeshDistanceMaterial=!0;function id(i,t,e){let n=new Br;const r=new R,o=new R,s=new Nt,a=[],l=[],h={},u=e.maxTextureSize,p={0:1,1:0,2:2},_=new hn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new R},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const w=new Wn;w.setAttribute("position",new Yn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const M=new Tt(w,_),C=this;function G(mt,lt){const gt=t.update(M);_.uniforms.shadow_pass.value=mt.map.texture,_.uniforms.resolution.value=mt.mapSize,_.uniforms.radius.value=mt.radius,i.setRenderTarget(mt.mapPass),i.clear(),i.renderBufferDirect(lt,null,gt,_,M,null),x.uniforms.shadow_pass.value=mt.mapPass.texture,x.uniforms.resolution.value=mt.mapSize,x.uniforms.radius.value=mt.radius,i.setRenderTarget(mt.map),i.clear(),i.renderBufferDirect(lt,null,gt,x,M,null)}function Q(mt){const lt=mt<<0;let gt=a[lt];return gt===void 0&&(gt=new ed({depthPacking:3201,morphTargets:mt}),a[lt]=gt),gt}function nt(mt){const lt=mt<<0;let gt=l[lt];return gt===void 0&&(gt=new nd({morphTargets:mt}),l[lt]=gt),gt}function ct(mt,lt,gt,Ut,Ft,Mt,At){let Ot=null,Lt=Q,ne=mt.customDepthMaterial;if(Ut.isPointLight===!0&&(Lt=nt,ne=mt.customDistanceMaterial),ne===void 0){let $t=!1;gt.morphTargets===!0&&($t=lt.morphAttributes&&lt.morphAttributes.position&&lt.morphAttributes.position.length>0),Ot=Lt($t)}else Ot=ne;if(i.localClippingEnabled&&gt.clipShadows===!0&&gt.clippingPlanes.length!==0){const $t=Ot.uuid,zt=gt.uuid;let Yt=h[$t];Yt===void 0&&(Yt={},h[$t]=Yt);let ge=Yt[zt];ge===void 0&&(ge=Ot.clone(),Yt[zt]=ge),Ot=ge}return Ot.visible=gt.visible,Ot.wireframe=gt.wireframe,Ot.side=At===3?gt.shadowSide!==null?gt.shadowSide:gt.side:gt.shadowSide!==null?gt.shadowSide:p[gt.side],Ot.clipShadows=gt.clipShadows,Ot.clippingPlanes=gt.clippingPlanes,Ot.clipIntersection=gt.clipIntersection,Ot.wireframeLinewidth=gt.wireframeLinewidth,Ot.linewidth=gt.linewidth,Ut.isPointLight===!0&&Ot.isMeshDistanceMaterial===!0&&(Ot.referencePosition.setFromMatrixPosition(Ut.matrixWorld),Ot.nearDistance=Ft,Ot.farDistance=Mt),Ot}function it(mt,lt,gt,Ut,Ft){if(mt.visible===!1)return;if(mt.layers.test(lt.layers)&&(mt.isMesh||mt.isLine||mt.isPoints)&&(mt.castShadow||mt.receiveShadow&&Ft===3)&&(!mt.frustumCulled||n.intersectsObject(mt))){mt.modelViewMatrix.multiplyMatrices(gt.matrixWorldInverse,mt.matrixWorld);const At=t.update(mt),Ot=mt.material;if(Array.isArray(Ot)){const Lt=At.groups;for(let ne=0,$t=Lt.length;ne<$t;ne++){const zt=Lt[ne],Yt=Ot[zt.materialIndex];if(Yt&&Yt.visible){const ge=ct(mt,At,Yt,Ut,gt.near,gt.far,Ft);i.renderBufferDirect(gt,null,At,ge,mt,zt)}}}else if(Ot.visible){const Lt=ct(mt,At,Ot,Ut,gt.near,gt.far,Ft);i.renderBufferDirect(gt,null,At,Lt,mt,null)}}const Mt=mt.children;for(let At=0,Ot=Mt.length;At<Ot;At++)it(Mt[At],lt,gt,Ut,Ft)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(mt,lt,gt){if(C.enabled===!1||C.autoUpdate===!1&&C.needsUpdate===!1||mt.length===0)return;const Ut=i.getRenderTarget(),Ft=i.getActiveCubeFace(),Mt=i.getActiveMipmapLevel(),At=i.state;At.setBlending(0),At.buffers.color.setClear(1,1,1,1),At.buffers.depth.setTest(!0),At.setScissorTest(!1);for(let Ot=0,Lt=mt.length;Ot<Lt;Ot++){const ne=mt[Ot],$t=ne.shadow;if($t===void 0){console.warn("THREE.WebGLShadowMap:",ne,"has no shadow.");continue}if($t.autoUpdate===!1&&$t.needsUpdate===!1)continue;r.copy($t.mapSize);const zt=$t.getFrameExtents();if(r.multiply(zt),o.copy($t.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/zt.x),r.x=o.x*zt.x,$t.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/zt.y),r.y=o.y*zt.y,$t.mapSize.y=o.y)),$t.map===null&&!$t.isPointLightShadow&&this.type===3){const ge={minFilter:1006,magFilter:1006,format:1023};$t.map=new Vt(r.x,r.y,ge),$t.map.texture.name=ne.name+".shadowMap",$t.mapPass=new Vt(r.x,r.y,ge),$t.camera.updateProjectionMatrix()}if($t.map===null){const ge={minFilter:1003,magFilter:1003,format:1023};$t.map=new Vt(r.x,r.y,ge),$t.map.texture.name=ne.name+".shadowMap",$t.camera.updateProjectionMatrix()}i.setRenderTarget($t.map),i.clear();const Yt=$t.getViewportCount();for(let ge=0;ge<Yt;ge++){const be=$t.getViewport(ge);s.set(o.x*be.x,o.y*be.y,o.x*be.z,o.y*be.w),At.viewport(s),$t.updateMatrices(ne,ge),n=$t.getFrustum(),it(lt,gt,$t.camera,ne,this.type)}$t.isPointLightShadow||this.type!==3||G($t,gt),$t.needsUpdate=!1}C.needsUpdate=!1,i.setRenderTarget(Ut,Ft,Mt)}}function f0(i,t,e){const n=e.isWebGL2,r=new function(){let bt=!1;const jt=new Nt;let ie=null;const ae=new Nt(0,0,0,0);return{setMask:function(qt){ie===qt||bt||(i.colorMask(qt,qt,qt,qt),ie=qt)},setLocked:function(qt){bt=qt},setClear:function(qt,ye,nn,on,rn){rn===!0&&(qt*=on,ye*=on,nn*=on),jt.set(qt,ye,nn,on),ae.equals(jt)===!1&&(i.clearColor(qt,ye,nn,on),ae.copy(jt))},reset:function(){bt=!1,ie=null,ae.set(-1,0,0,0)}}},o=new function(){let bt=!1,jt=null,ie=null,ae=null;return{setTest:function(qt){qt?Pe(2929):Ct(2929)},setMask:function(qt){jt===qt||bt||(i.depthMask(qt),jt=qt)},setFunc:function(qt){if(ie!==qt){if(qt)switch(qt){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);ie=qt}},setLocked:function(qt){bt=qt},setClear:function(qt){ae!==qt&&(i.clearDepth(qt),ae=qt)},reset:function(){bt=!1,jt=null,ie=null,ae=null}}},s=new function(){let bt=!1,jt=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null;return{setTest:function(En){bt||(En?Pe(2960):Ct(2960))},setMask:function(En){jt===En||bt||(i.stencilMask(En),jt=En)},setFunc:function(En,Ai,Jn){ie===En&&ae===Ai&&qt===Jn||(i.stencilFunc(En,Ai,Jn),ie=En,ae=Ai,qt=Jn)},setOp:function(En,Ai,Jn){ye===En&&nn===Ai&&on===Jn||(i.stencilOp(En,Ai,Jn),ye=En,nn=Ai,on=Jn)},setLocked:function(En){bt=En},setClear:function(En){rn!==En&&(i.clearStencil(En),rn=En)},reset:function(){bt=!1,jt=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null}}};let a={},l=null,h={},u=null,p=!1,_=null,x=null,w=null,M=null,C=null,G=null,Q=null,nt=!1,ct=null,it=null,mt=null,lt=null,gt=null;const Ut=i.getParameter(35661);let Ft=!1,Mt=0;const At=i.getParameter(7938);At.indexOf("WebGL")!==-1?(Mt=parseFloat(/^WebGL (\d)/.exec(At)[1]),Ft=Mt>=1):At.indexOf("OpenGL ES")!==-1&&(Mt=parseFloat(/^OpenGL ES (\d)/.exec(At)[1]),Ft=Mt>=2);let Ot=null,Lt={};const ne=i.getParameter(3088),$t=i.getParameter(2978),zt=new Nt().fromArray(ne),Yt=new Nt().fromArray($t);function ge(bt,jt,ie){const ae=new Uint8Array(4),qt=i.createTexture();i.bindTexture(bt,qt),i.texParameteri(bt,10241,9728),i.texParameteri(bt,10240,9728);for(let ye=0;ye<ie;ye++)i.texImage2D(jt+ye,0,6408,1,1,0,6408,5121,ae);return qt}const be={};function Pe(bt){a[bt]!==!0&&(i.enable(bt),a[bt]=!0)}function Ct(bt){a[bt]!==!1&&(i.disable(bt),a[bt]=!1)}be[3553]=ge(3553,3553,1),be[34067]=ge(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Pe(2929),o.setFunc(3),se(!1),Ie(1),Pe(2884),le(0);const Bt={100:32774,101:32778,102:32779};if(n)Bt[103]=32775,Bt[104]=32776;else{const bt=t.get("EXT_blend_minmax");bt!==null&&(Bt[103]=bt.MIN_EXT,Bt[104]=bt.MAX_EXT)}const ve={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function le(bt,jt,ie,ae,qt,ye,nn,on){if(bt!==0){if(p===!1&&(Pe(3042),p=!0),bt===5)qt=qt||jt,ye=ye||ie,nn=nn||ae,jt===x&&qt===C||(i.blendEquationSeparate(Bt[jt],Bt[qt]),x=jt,C=qt),ie===w&&ae===M&&ye===G&&nn===Q||(i.blendFuncSeparate(ve[ie],ve[ae],ve[ye],ve[nn]),w=ie,M=ae,G=ye,Q=nn),_=bt,nt=null;else if(bt!==_||on!==nt){if(x===100&&C===100||(i.blendEquation(32774),x=100,C=100),on)switch(bt){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,0,769,771);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",bt)}else switch(bt){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFunc(0,769);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",bt)}w=null,M=null,G=null,Q=null,_=bt,nt=on}}else p===!0&&(Ct(3042),p=!1)}function se(bt){ct!==bt&&(bt?i.frontFace(2304):i.frontFace(2305),ct=bt)}function Ie(bt){bt!==0?(Pe(2884),bt!==it&&(bt===1?i.cullFace(1029):bt===2?i.cullFace(1028):i.cullFace(1032))):Ct(2884),it=bt}function Le(bt,jt,ie){bt?(Pe(32823),lt===jt&&gt===ie||(i.polygonOffset(jt,ie),lt=jt,gt=ie)):Ct(32823)}function ue(bt){bt===void 0&&(bt=33984+Ut-1),Ot!==bt&&(i.activeTexture(bt),Ot=bt)}return{buffers:{color:r,depth:o,stencil:s},enable:Pe,disable:Ct,bindFramebuffer:function(bt,jt){return jt===null&&l!==null&&(jt=l),h[bt]!==jt&&(i.bindFramebuffer(bt,jt),h[bt]=jt,n&&(bt===36009&&(h[36160]=jt),bt===36160&&(h[36009]=jt)),!0)},bindXRFramebuffer:function(bt){bt!==l&&(i.bindFramebuffer(36160,bt),l=bt)},useProgram:function(bt){return u!==bt&&(i.useProgram(bt),u=bt,!0)},setBlending:le,setMaterial:function(bt,jt){bt.side===2?Ct(2884):Pe(2884);let ie=bt.side===1;jt&&(ie=!ie),se(ie),bt.blending===1&&bt.transparent===!1?le(0):le(bt.blending,bt.blendEquation,bt.blendSrc,bt.blendDst,bt.blendEquationAlpha,bt.blendSrcAlpha,bt.blendDstAlpha,bt.premultipliedAlpha),o.setFunc(bt.depthFunc),o.setTest(bt.depthTest),o.setMask(bt.depthWrite),r.setMask(bt.colorWrite);const ae=bt.stencilWrite;s.setTest(ae),ae&&(s.setMask(bt.stencilWriteMask),s.setFunc(bt.stencilFunc,bt.stencilRef,bt.stencilFuncMask),s.setOp(bt.stencilFail,bt.stencilZFail,bt.stencilZPass)),Le(bt.polygonOffset,bt.polygonOffsetFactor,bt.polygonOffsetUnits),bt.alphaToCoverage===!0?Pe(32926):Ct(32926)},setFlipSided:se,setCullFace:Ie,setLineWidth:function(bt){bt!==mt&&(Ft&&i.lineWidth(bt),mt=bt)},setPolygonOffset:Le,setScissorTest:function(bt){bt?Pe(3089):Ct(3089)},activeTexture:ue,bindTexture:function(bt,jt){Ot===null&&ue();let ie=Lt[Ot];ie===void 0&&(ie={type:void 0,texture:void 0},Lt[Ot]=ie),ie.type===bt&&ie.texture===jt||(i.bindTexture(bt,jt||be[bt]),ie.type=bt,ie.texture=jt)},unbindTexture:function(){const bt=Lt[Ot];bt!==void 0&&bt.type!==void 0&&(i.bindTexture(bt.type,null),bt.type=void 0,bt.texture=void 0)},compressedTexImage2D:function(){try{i.compressedTexImage2D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},texImage2D:function(){try{i.texImage2D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},texImage3D:function(){try{i.texImage3D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},scissor:function(bt){zt.equals(bt)===!1&&(i.scissor(bt.x,bt.y,bt.z,bt.w),zt.copy(bt))},viewport:function(bt){Yt.equals(bt)===!1&&(i.viewport(bt.x,bt.y,bt.z,bt.w),Yt.copy(bt))},reset:function(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),n===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),a={},Ot=null,Lt={},l=null,h={},u=null,p=!1,_=null,x=null,w=null,M=null,C=null,G=null,Q=null,nt=!1,ct=null,it=null,mt=null,lt=null,gt=null,zt.set(0,0,i.canvas.width,i.canvas.height),Yt.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),s.reset()}}}function m0(i,t,e,n,r,o,s){const a=r.isWebGL2,l=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,p=r.maxSamples,_=new WeakMap;let x,w=!1;try{w=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(Ct,Bt){return w?new OffscreenCanvas(Ct,Bt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function C(Ct,Bt,ve,le){let se=1;if((Ct.width>le||Ct.height>le)&&(se=le/Math.max(Ct.width,Ct.height)),se<1||Bt===!0){if(typeof HTMLImageElement!="undefined"&&Ct instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Ct instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Ct instanceof ImageBitmap){const Ie=Bt?L:Math.floor,Le=Ie(se*Ct.width),ue=Ie(se*Ct.height);x===void 0&&(x=M(Le,ue));const bt=ve?M(Le,ue):x;return bt.width=Le,bt.height=ue,bt.getContext("2d").drawImage(Ct,0,0,Le,ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ct.width+"x"+Ct.height+") to ("+Le+"x"+ue+")."),bt}return"data"in Ct&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ct.width+"x"+Ct.height+")."),Ct}return Ct}function G(Ct){return St(Ct.width)&&St(Ct.height)}function Q(Ct,Bt){return Ct.generateMipmaps&&Bt&&Ct.minFilter!==1003&&Ct.minFilter!==1006}function nt(Ct,Bt,ve,le,se=1){i.generateMipmap(Ct),n.get(Bt).__maxMipLevel=Math.log2(Math.max(ve,le,se))}function ct(Ct,Bt,ve){if(a===!1)return Bt;if(Ct!==null){if(i[Ct]!==void 0)return i[Ct];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ct+"'")}let le=Bt;return Bt===6403&&(ve===5126&&(le=33326),ve===5131&&(le=33325),ve===5121&&(le=33321)),Bt===6407&&(ve===5126&&(le=34837),ve===5131&&(le=34843),ve===5121&&(le=32849)),Bt===6408&&(ve===5126&&(le=34836),ve===5131&&(le=34842),ve===5121&&(le=32856)),le!==33325&&le!==33326&&le!==34842&&le!==34836||t.get("EXT_color_buffer_float"),le}function it(Ct){return Ct===1003||Ct===1004||Ct===1005?9728:9729}function mt(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",mt),function(ve){const le=n.get(ve);le.__webglInit!==void 0&&(i.deleteTexture(le.__webglTexture),n.remove(ve))}(Bt),Bt.isVideoTexture&&_.delete(Bt),s.memory.textures--}function lt(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",lt),function(ve){const le=ve.texture,se=n.get(ve),Ie=n.get(le);if(!!ve){if(Ie.__webglTexture!==void 0&&(i.deleteTexture(Ie.__webglTexture),s.memory.textures--),ve.depthTexture&&ve.depthTexture.dispose(),ve.isWebGLCubeRenderTarget)for(let Le=0;Le<6;Le++)i.deleteFramebuffer(se.__webglFramebuffer[Le]),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer[Le]);else i.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&i.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer&&i.deleteRenderbuffer(se.__webglColorRenderbuffer),se.__webglDepthRenderbuffer&&i.deleteRenderbuffer(se.__webglDepthRenderbuffer);if(ve.isWebGLMultipleRenderTargets)for(let Le=0,ue=le.length;Le<ue;Le++){const bt=n.get(le[Le]);bt.__webglTexture&&(i.deleteTexture(bt.__webglTexture),s.memory.textures--),n.remove(le[Le])}n.remove(le),n.remove(ve)}}(Bt)}let gt=0;function Ut(Ct,Bt){const ve=n.get(Ct);if(Ct.isVideoTexture&&function(le){const se=s.render.frame;_.get(le)!==se&&(_.set(le,se),le.update())}(Ct),Ct.version>0&&ve.__version!==Ct.version){const le=Ct.image;if(le===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(le.complete!==!1)return void ne(ve,Ct,Bt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}e.activeTexture(33984+Bt),e.bindTexture(3553,ve.__webglTexture)}function Ft(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?function(le,se,Ie){if(se.image.length!==6)return;Lt(le,se),e.activeTexture(33984+Ie),e.bindTexture(34067,le.__webglTexture),i.pixelStorei(37440,se.flipY),i.pixelStorei(37441,se.premultiplyAlpha),i.pixelStorei(3317,se.unpackAlignment),i.pixelStorei(37443,0);const Le=se&&(se.isCompressedTexture||se.image[0].isCompressedTexture),ue=se.image[0]&&se.image[0].isDataTexture,bt=[];for(let on=0;on<6;on++)bt[on]=Le||ue?ue?se.image[on].image:se.image[on]:C(se.image[on],!1,!0,h);const jt=bt[0],ie=G(jt)||a,ae=o.convert(se.format),qt=o.convert(se.type),ye=ct(se.internalFormat,ae,qt);let nn;if(Ot(34067,se,ie),Le){for(let on=0;on<6;on++){nn=bt[on].mipmaps;for(let rn=0;rn<nn.length;rn++){const En=nn[rn];se.format!==1023&&se.format!==1022?ae!==null?e.compressedTexImage2D(34069+on,rn,ye,En.width,En.height,0,En.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):e.texImage2D(34069+on,rn,ye,En.width,En.height,0,ae,qt,En.data)}}le.__maxMipLevel=nn.length-1}else{nn=se.mipmaps;for(let on=0;on<6;on++)if(ue){e.texImage2D(34069+on,0,ye,bt[on].width,bt[on].height,0,ae,qt,bt[on].data);for(let rn=0;rn<nn.length;rn++){const En=nn[rn].image[on].image;e.texImage2D(34069+on,rn+1,ye,En.width,En.height,0,ae,qt,En.data)}}else{e.texImage2D(34069+on,0,ye,ae,qt,bt[on]);for(let rn=0;rn<nn.length;rn++){const En=nn[rn];e.texImage2D(34069+on,rn+1,ye,ae,qt,En.image[on])}}le.__maxMipLevel=nn.length}Q(se,ie)&&nt(34067,se,jt.width,jt.height),le.__version=se.version,se.onUpdate&&se.onUpdate(se)}(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(34067,ve.__webglTexture))}const Mt={1e3:10497,1001:33071,1002:33648},At={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function Ot(Ct,Bt,ve){if(ve?(i.texParameteri(Ct,10242,Mt[Bt.wrapS]),i.texParameteri(Ct,10243,Mt[Bt.wrapT]),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,Mt[Bt.wrapR]),i.texParameteri(Ct,10240,At[Bt.magFilter]),i.texParameteri(Ct,10241,At[Bt.minFilter])):(i.texParameteri(Ct,10242,33071),i.texParameteri(Ct,10243,33071),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,33071),Bt.wrapS===1001&&Bt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(Ct,10240,it(Bt.magFilter)),i.texParameteri(Ct,10241,it(Bt.minFilter)),Bt.minFilter!==1003&&Bt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const le=t.get("EXT_texture_filter_anisotropic");if(Bt.type===1015&&t.has("OES_texture_float_linear")===!1||a===!1&&Bt.type===1016&&t.has("OES_texture_half_float_linear")===!1)return;(Bt.anisotropy>1||n.get(Bt).__currentAnisotropy)&&(i.texParameterf(Ct,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,r.getMaxAnisotropy())),n.get(Bt).__currentAnisotropy=Bt.anisotropy)}}function Lt(Ct,Bt){Ct.__webglInit===void 0&&(Ct.__webglInit=!0,Bt.addEventListener("dispose",mt),Ct.__webglTexture=i.createTexture(),s.memory.textures++)}function ne(Ct,Bt,ve){let le=3553;Bt.isDataTexture2DArray&&(le=35866),Bt.isDataTexture3D&&(le=32879),Lt(Ct,Bt),e.activeTexture(33984+ve),e.bindTexture(le,Ct.__webglTexture),i.pixelStorei(37440,Bt.flipY),i.pixelStorei(37441,Bt.premultiplyAlpha),i.pixelStorei(3317,Bt.unpackAlignment),i.pixelStorei(37443,0);const se=function(qt){return!a&&(qt.wrapS!==1001||qt.wrapT!==1001||qt.minFilter!==1003&&qt.minFilter!==1006)}(Bt)&&G(Bt.image)===!1,Ie=C(Bt.image,se,!1,u),Le=G(Ie)||a,ue=o.convert(Bt.format);let bt,jt=o.convert(Bt.type),ie=ct(Bt.internalFormat,ue,jt);Ot(le,Bt,Le);const ae=Bt.mipmaps;if(Bt.isDepthTexture)ie=6402,a?ie=Bt.type===1015?36012:Bt.type===1014?33190:Bt.type===1020?35056:33189:Bt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Bt.format===1026&&ie===6402&&Bt.type!==1012&&Bt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Bt.type=1012,jt=o.convert(Bt.type)),Bt.format===1027&&ie===6402&&(ie=34041,Bt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Bt.type=1020,jt=o.convert(Bt.type))),e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ue,jt,null);else if(Bt.isDataTexture)if(ae.length>0&&Le){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],e.texImage2D(3553,qt,ie,bt.width,bt.height,0,ue,jt,bt.data);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ue,jt,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isCompressedTexture){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],Bt.format!==1023&&Bt.format!==1022?ue!==null?e.compressedTexImage2D(3553,qt,ie,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):e.texImage2D(3553,qt,ie,bt.width,bt.height,0,ue,jt,bt.data);Ct.__maxMipLevel=ae.length-1}else if(Bt.isDataTexture2DArray)e.texImage3D(35866,0,ie,Ie.width,Ie.height,Ie.depth,0,ue,jt,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isDataTexture3D)e.texImage3D(32879,0,ie,Ie.width,Ie.height,Ie.depth,0,ue,jt,Ie.data),Ct.__maxMipLevel=0;else if(ae.length>0&&Le){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],e.texImage2D(3553,qt,ie,ue,jt,bt);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,ue,jt,Ie),Ct.__maxMipLevel=0;Q(Bt,Le)&&nt(le,Bt,Ie.width,Ie.height),Ct.__version=Bt.version,Bt.onUpdate&&Bt.onUpdate(Bt)}function $t(Ct,Bt,ve,le,se){const Ie=o.convert(ve.format),Le=o.convert(ve.type),ue=ct(ve.internalFormat,Ie,Le);se===32879||se===35866?e.texImage3D(se,0,ue,Bt.width,Bt.height,Bt.depth,0,Ie,Le,null):e.texImage2D(se,0,ue,Bt.width,Bt.height,0,Ie,Le,null),e.bindFramebuffer(36160,Ct),i.framebufferTexture2D(36160,le,se,n.get(ve).__webglTexture,0),e.bindFramebuffer(36160,null)}function zt(Ct,Bt,ve){if(i.bindRenderbuffer(36161,Ct),Bt.depthBuffer&&!Bt.stencilBuffer){let le=33189;if(ve){const se=Bt.depthTexture;se&&se.isDepthTexture&&(se.type===1015?le=36012:se.type===1014&&(le=33190));const Ie=ge(Bt);i.renderbufferStorageMultisample(36161,Ie,le,Bt.width,Bt.height)}else i.renderbufferStorage(36161,le,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,36096,36161,Ct)}else if(Bt.depthBuffer&&Bt.stencilBuffer){if(ve){const le=ge(Bt);i.renderbufferStorageMultisample(36161,le,35056,Bt.width,Bt.height)}else i.renderbufferStorage(36161,34041,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,33306,36161,Ct)}else{const le=Bt.isWebGLMultipleRenderTargets===!0?Bt.texture[0]:Bt.texture,se=o.convert(le.format),Ie=o.convert(le.type),Le=ct(le.internalFormat,se,Ie);if(ve){const ue=ge(Bt);i.renderbufferStorageMultisample(36161,ue,Le,Bt.width,Bt.height)}else i.renderbufferStorage(36161,Le,Bt.width,Bt.height)}i.bindRenderbuffer(36161,null)}function Yt(Ct){const Bt=n.get(Ct),ve=Ct.isWebGLCubeRenderTarget===!0;if(Ct.depthTexture){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");(function(le,se){if(se&&se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,le),!se.depthTexture||!se.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(se.depthTexture).__webglTexture&&se.depthTexture.image.width===se.width&&se.depthTexture.image.height===se.height||(se.depthTexture.image.width=se.width,se.depthTexture.image.height=se.height,se.depthTexture.needsUpdate=!0),Ut(se.depthTexture,0);const Ie=n.get(se.depthTexture).__webglTexture;if(se.depthTexture.format===1026)i.framebufferTexture2D(36160,36096,3553,Ie,0);else{if(se.depthTexture.format!==1027)throw new Error("Unknown depthTexture format");i.framebufferTexture2D(36160,33306,3553,Ie,0)}})(Bt.__webglFramebuffer,Ct)}else if(ve){Bt.__webglDepthbuffer=[];for(let le=0;le<6;le++)e.bindFramebuffer(36160,Bt.__webglFramebuffer[le]),Bt.__webglDepthbuffer[le]=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer[le],Ct,!1)}else e.bindFramebuffer(36160,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer,Ct,!1);e.bindFramebuffer(36160,null)}function ge(Ct){return a&&Ct.isWebGLMultisampleRenderTarget?Math.min(p,Ct.samples):0}let be=!1,Pe=!1;this.allocateTextureUnit=function(){const Ct=gt;return Ct>=l&&console.warn("THREE.WebGLTextures: Trying to use "+Ct+" texture units while this GPU supports only "+l),gt+=1,Ct},this.resetTextureUnits=function(){gt=0},this.setTexture2D=Ut,this.setTexture2DArray=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ne(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(35866,ve.__webglTexture))},this.setTexture3D=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ne(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(32879,ve.__webglTexture))},this.setTextureCube=Ft,this.setupRenderTarget=function(Ct){const Bt=Ct.texture,ve=n.get(Ct),le=n.get(Bt);Ct.addEventListener("dispose",lt),Ct.isWebGLMultipleRenderTargets!==!0&&(le.__webglTexture=i.createTexture(),le.__version=Bt.version,s.memory.textures++);const se=Ct.isWebGLCubeRenderTarget===!0,Ie=Ct.isWebGLMultipleRenderTargets===!0,Le=Ct.isWebGLMultisampleRenderTarget===!0,ue=Bt.isDataTexture3D||Bt.isDataTexture2DArray,bt=G(Ct)||a;if(!a||Bt.format!==1022||Bt.type!==1015&&Bt.type!==1016||(Bt.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),se){ve.__webglFramebuffer=[];for(let jt=0;jt<6;jt++)ve.__webglFramebuffer[jt]=i.createFramebuffer()}else if(ve.__webglFramebuffer=i.createFramebuffer(),Ie)if(r.drawBuffers){const jt=Ct.texture;for(let ie=0,ae=jt.length;ie<ae;ie++){const qt=n.get(jt[ie]);qt.__webglTexture===void 0&&(qt.__webglTexture=i.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Le)if(a){ve.__webglMultisampledFramebuffer=i.createFramebuffer(),ve.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,ve.__webglColorRenderbuffer);const jt=o.convert(Bt.format),ie=o.convert(Bt.type),ae=ct(Bt.internalFormat,jt,ie),qt=ge(Ct);i.renderbufferStorageMultisample(36161,qt,ae,Ct.width,Ct.height),e.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,ve.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),Ct.depthBuffer&&(ve.__webglDepthRenderbuffer=i.createRenderbuffer(),zt(ve.__webglDepthRenderbuffer,Ct,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(se){e.bindTexture(34067,le.__webglTexture),Ot(34067,Bt,bt);for(let jt=0;jt<6;jt++)$t(ve.__webglFramebuffer[jt],Ct,Bt,36064,34069+jt);Q(Bt,bt)&&nt(34067,Bt,Ct.width,Ct.height),e.bindTexture(34067,null)}else if(Ie){const jt=Ct.texture;for(let ie=0,ae=jt.length;ie<ae;ie++){const qt=jt[ie],ye=n.get(qt);e.bindTexture(3553,ye.__webglTexture),Ot(3553,qt,bt),$t(ve.__webglFramebuffer,Ct,qt,36064+ie,3553),Q(qt,bt)&&nt(3553,qt,Ct.width,Ct.height)}e.bindTexture(3553,null)}else{let jt=3553;ue&&(a?jt=Bt.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(jt,le.__webglTexture),Ot(jt,Bt,bt),$t(ve.__webglFramebuffer,Ct,Bt,36064,jt),Q(Bt,bt)&&nt(jt,Bt,Ct.width,Ct.height,Ct.depth),e.bindTexture(jt,null)}Ct.depthBuffer&&Yt(Ct)},this.updateRenderTargetMipmap=function(Ct){const Bt=G(Ct)||a,ve=Ct.isWebGLMultipleRenderTargets===!0?Ct.texture:[Ct.texture];for(let le=0,se=ve.length;le<se;le++){const Ie=ve[le];if(Q(Ie,Bt)){const Le=Ct.isWebGLCubeRenderTarget?34067:3553,ue=n.get(Ie).__webglTexture;e.bindTexture(Le,ue),nt(Le,Ie,Ct.width,Ct.height),e.bindTexture(Le,null)}}},this.updateMultisampleRenderTarget=function(Ct){if(Ct.isWebGLMultisampleRenderTarget)if(a){const Bt=Ct.width,ve=Ct.height;let le=16384;Ct.depthBuffer&&(le|=256),Ct.stencilBuffer&&(le|=1024);const se=n.get(Ct);e.bindFramebuffer(36008,se.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,se.__webglFramebuffer),i.blitFramebuffer(0,0,Bt,ve,0,0,Bt,ve,le,9728),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ct,Bt){Ct&&Ct.isWebGLRenderTarget&&(be===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),be=!0),Ct=Ct.texture),Ut(Ct,Bt)},this.safeSetTextureCube=function(Ct,Bt){Ct&&Ct.isWebGLCubeRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Pe=!0),Ct=Ct.texture),Ft(Ct,Bt)}}function g0(i,t,e){const n=e.isWebGL2;return{convert:function(r){let o;if(r===1009)return 5121;if(r===1017)return 32819;if(r===1018)return 32820;if(r===1019)return 33635;if(r===1010)return 5120;if(r===1011)return 5122;if(r===1012)return 5123;if(r===1013)return 5124;if(r===1014)return 5125;if(r===1015)return 5126;if(r===1016)return n?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(r===1021)return 6406;if(r===1022)return 6407;if(r===1023)return 6408;if(r===1024)return 6409;if(r===1025)return 6410;if(r===1026)return 6402;if(r===1027)return 34041;if(r===1028)return 6403;if(r===1029)return 36244;if(r===1030)return 33319;if(r===1031)return 33320;if(r===1032)return 36248;if(r===1033)return 36249;if(r===33776||r===33777||r===33778||r===33779){if(o=t.get("WEBGL_compressed_texture_s3tc"),o===null)return null;if(r===33776)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===33777)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===33778)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===33779)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===35840||r===35841||r===35842||r===35843){if(o=t.get("WEBGL_compressed_texture_pvrtc"),o===null)return null;if(r===35840)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===35841)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===35842)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===35843)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===36196)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((r===37492||r===37496)&&(o=t.get("WEBGL_compressed_texture_etc"),o!==null)){if(r===37492)return o.COMPRESSED_RGB8_ETC2;if(r===37496)return o.COMPRESSED_RGBA8_ETC2_EAC}return r===37808||r===37809||r===37810||r===37811||r===37812||r===37813||r===37814||r===37815||r===37816||r===37817||r===37818||r===37819||r===37820||r===37821||r===37840||r===37841||r===37842||r===37843||r===37844||r===37845||r===37846||r===37847||r===37848||r===37849||r===37850||r===37851||r===37852||r===37853?(o=t.get("WEBGL_compressed_texture_astc"),o!==null?r:null):r===36492?(o=t.get("EXT_texture_compression_bptc"),o!==null?r:null):r===1020?n?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class rd extends un{constructor(t=[]){super(),this.cameras=t}}rd.prototype.isArrayCamera=!0;class bs extends kn{constructor(){super(),this.type="Group"}}bs.prototype.isGroup=!0;const v0={type:"move"};class zh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new bs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new bs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new B,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new B),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new bs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new B,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new B),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,h=this._hand;if(t&&e.session.visibilityState!=="visible-blurred")if(a!==null&&(r=e.getPose(t.targetRaySpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(v0))),h&&t.hand){s=!0;for(const M of t.hand.values()){const C=e.getJointPose(M,n);if(h.joints[M.jointName]===void 0){const Q=new bs;Q.matrixAutoUpdate=!1,Q.visible=!1,h.joints[M.jointName]=Q,h.add(Q)}const G=h.joints[M.jointName];C!==null&&(G.matrix.fromArray(C.transform.matrix),G.matrix.decompose(G.position,G.rotation,G.scale),G.jointRadius=C.radius),G.visible=C!==null}const u=h.joints["index-finger-tip"],p=h.joints["thumb-tip"],_=u.position.distanceTo(p.position),x=.02,w=.005;h.inputState.pinching&&_>x+w?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&_<=x-w&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(o=e.getPose(t.gripSpace,n),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),h!==null&&(h.visible=s!==null),this}}class _0 extends D{constructor(t,e){super();const n=this,r=t.state;let o=null,s=1,a=null,l="local-floor",h=null,u=null,p=null,_=null;const x=[],w=new Map,M=new un;M.layers.enable(1),M.viewport=new Nt;const C=new un;C.layers.enable(2),C.viewport=new Nt;const G=[M,C],Q=new rd;Q.layers.enable(1),Q.layers.enable(2);let nt=null,ct=null;function it(Ot){const Lt=w.get(Ot.inputSource);Lt&&Lt.dispatchEvent({type:Ot.type,data:Ot.inputSource})}function mt(){w.forEach(function(Ot,Lt){Ot.disconnect(Lt)}),w.clear(),nt=null,ct=null,r.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),At.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function lt(Ot){const Lt=o.inputSources;for(let ne=0;ne<x.length;ne++)w.set(Lt[ne],x[ne]);for(let ne=0;ne<Ot.removed.length;ne++){const $t=Ot.removed[ne],zt=w.get($t);zt&&(zt.dispatchEvent({type:"disconnected",data:$t}),w.delete($t))}for(let ne=0;ne<Ot.added.length;ne++){const $t=Ot.added[ne],zt=w.get($t);zt&&zt.dispatchEvent({type:"connected",data:$t})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ot){let Lt=x[Ot];return Lt===void 0&&(Lt=new zh,x[Ot]=Lt),Lt.getTargetRaySpace()},this.getControllerGrip=function(Ot){let Lt=x[Ot];return Lt===void 0&&(Lt=new zh,x[Ot]=Lt),Lt.getGripSpace()},this.getHand=function(Ot){let Lt=x[Ot];return Lt===void 0&&(Lt=new zh,x[Ot]=Lt),Lt.getHandSpace()},this.setFramebufferScaleFactor=function(Ot){s=Ot,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ot){l=Ot,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return o},this.setSession=async function(Ot){if(o=Ot,o!==null){o.addEventListener("select",it),o.addEventListener("selectstart",it),o.addEventListener("selectend",it),o.addEventListener("squeeze",it),o.addEventListener("squeezestart",it),o.addEventListener("squeezeend",it),o.addEventListener("end",mt),o.addEventListener("inputsourceschange",lt);const Lt=e.getContextAttributes();if(Lt.xrCompatible!==!0&&await e.makeXRCompatible(),o.renderState.layers===void 0){const ne={antialias:Lt.antialias,alpha:Lt.alpha,depth:Lt.depth,stencil:Lt.stencil,framebufferScaleFactor:s},$t=new XRWebGLLayer(o,e,ne);o.updateRenderState({baseLayer:$t})}else{let ne=0;Lt.depth&&(ne=Lt.stencil?34041:6402);const $t={colorFormat:Lt.alpha?6408:6407,depthFormat:ne,scaleFactor:s};u=new XRWebGLBinding(o,e),_=u.createProjectionLayer($t),p=e.createFramebuffer(),o.updateRenderState({layers:[_]})}a=await o.requestReferenceSpace(l),At.setContext(o),At.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const gt=new B,Ut=new B;function Ft(Ot,Lt){Lt===null?Ot.matrixWorld.copy(Ot.matrix):Ot.matrixWorld.multiplyMatrices(Lt.matrixWorld,Ot.matrix),Ot.matrixWorldInverse.copy(Ot.matrixWorld).invert()}this.updateCamera=function(Ot){if(o===null)return;Q.near=C.near=M.near=Ot.near,Q.far=C.far=M.far=Ot.far,nt===Q.near&&ct===Q.far||(o.updateRenderState({depthNear:Q.near,depthFar:Q.far}),nt=Q.near,ct=Q.far);const Lt=Ot.parent,ne=Q.cameras;Ft(Q,Lt);for(let zt=0;zt<ne.length;zt++)Ft(ne[zt],Lt);Q.matrixWorld.decompose(Q.position,Q.quaternion,Q.scale),Ot.position.copy(Q.position),Ot.quaternion.copy(Q.quaternion),Ot.scale.copy(Q.scale),Ot.matrix.copy(Q.matrix),Ot.matrixWorld.copy(Q.matrixWorld);const $t=Ot.children;for(let zt=0,Yt=$t.length;zt<Yt;zt++)$t[zt].updateMatrixWorld(!0);ne.length===2?function(zt,Yt,ge){gt.setFromMatrixPosition(Yt.matrixWorld),Ut.setFromMatrixPosition(ge.matrixWorld);const be=gt.distanceTo(Ut),Pe=Yt.projectionMatrix.elements,Ct=ge.projectionMatrix.elements,Bt=Pe[14]/(Pe[10]-1),ve=Pe[14]/(Pe[10]+1),le=(Pe[9]+1)/Pe[5],se=(Pe[9]-1)/Pe[5],Ie=(Pe[8]-1)/Pe[0],Le=(Ct[8]+1)/Ct[0],ue=Bt*Ie,bt=Bt*Le,jt=be/(-Ie+Le),ie=jt*-Ie;Yt.matrixWorld.decompose(zt.position,zt.quaternion,zt.scale),zt.translateX(ie),zt.translateZ(jt),zt.matrixWorld.compose(zt.position,zt.quaternion,zt.scale),zt.matrixWorldInverse.copy(zt.matrixWorld).invert();const ae=Bt+jt,qt=ve+jt,ye=ue-ie,nn=bt+(be-ie),on=le*ve/qt*ae,rn=se*ve/qt*ae;zt.projectionMatrix.makePerspective(ye,nn,on,rn,ae,qt)}(Q,M,C):Q.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return Q};let Mt=null;const At=new $o;At.setAnimationLoop(function(Ot,Lt){if(h=Lt.getViewerPose(a),h!==null){const $t=h.views,zt=o.renderState.baseLayer;o.renderState.layers===void 0&&r.bindXRFramebuffer(zt.framebuffer);let Yt=!1;$t.length!==Q.cameras.length&&(Q.cameras.length=0,Yt=!0);for(let ge=0;ge<$t.length;ge++){const be=$t[ge];let Pe=null;if(o.renderState.layers===void 0)Pe=zt.getViewport(be);else{const Bt=u.getViewSubImage(_,be);r.bindXRFramebuffer(p),e.framebufferTexture2D(36160,36064,3553,Bt.colorTexture,0),Bt.depthStencilTexture!==void 0&&e.framebufferTexture2D(36160,36096,3553,Bt.depthStencilTexture,0),Pe=Bt.viewport}const Ct=G[ge];Ct.matrix.fromArray(be.transform.matrix),Ct.projectionMatrix.fromArray(be.projectionMatrix),Ct.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),ge===0&&Q.matrix.copy(Ct.matrix),Yt===!0&&Q.cameras.push(Ct)}}const ne=o.inputSources;for(let $t=0;$t<x.length;$t++){const zt=x[$t],Yt=ne[$t];zt.update(Yt,Lt,a)}Mt&&Mt(Ot,Lt)}),this.setAnimationLoop=function(Ot){Mt=Ot},this.dispose=function(){}}}function y0(i){function t(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.specularMap&&(n.specularMap.value=r.specularMap);const o=i.get(r).envMap;if(o){n.envMap.value=o,n.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,n.reflectivity.value=r.reflectivity,n.refractionRatio.value=r.refractionRatio;const l=i.get(o).__maxMipLevel;l!==void 0&&(n.maxMipLevel.value=l)}let s,a;r.lightMap&&(n.lightMap.value=r.lightMap,n.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?s=r.map:r.specularMap?s=r.specularMap:r.displacementMap?s=r.displacementMap:r.normalMap?s=r.normalMap:r.bumpMap?s=r.bumpMap:r.roughnessMap?s=r.roughnessMap:r.metalnessMap?s=r.metalnessMap:r.alphaMap?s=r.alphaMap:r.emissiveMap?s=r.emissiveMap:r.clearcoatMap?s=r.clearcoatMap:r.clearcoatNormalMap?s=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(s=r.clearcoatRoughnessMap),s!==void 0&&(s.isWebGLRenderTarget&&(s=s.texture),s.matrixAutoUpdate===!0&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}function e(n,r){n.roughness.value=r.roughness,n.metalness.value=r.metalness,r.roughnessMap&&(n.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(n.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===1&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===1&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),i.get(r).envMap&&(n.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(n,r){n.fogColor.value.copy(r.color),r.isFog?(n.fogNear.value=r.near,n.fogFar.value=r.far):r.isFogExp2&&(n.fogDensity.value=r.density)},refreshMaterialUniforms:function(n,r,o,s,a){r.isMeshBasicMaterial?t(n,r):r.isMeshLambertMaterial?(t(n,r),function(l,h){h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap)}(n,r)):r.isMeshToonMaterial?(t(n,r),function(l,h){h.gradientMap&&(l.gradientMap.value=h.gradientMap),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshPhongMaterial?(t(n,r),function(l,h){l.specular.value.copy(h.specular),l.shininess.value=Math.max(h.shininess,1e-4),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshStandardMaterial?(t(n,r),r.isMeshPhysicalMaterial?function(l,h,u){e(l,h),l.reflectivity.value=h.reflectivity,l.clearcoat.value=h.clearcoat,l.clearcoatRoughness.value=h.clearcoatRoughness,h.sheen&&l.sheen.value.copy(h.sheen),h.clearcoatMap&&(l.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(l.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(l.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),l.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===1&&l.clearcoatNormalScale.value.negate()),l.transmission.value=h.transmission,h.transmissionMap&&(l.transmissionMap.value=h.transmissionMap),h.transmission>0&&(l.transmissionSamplerMap.value=u.texture,l.transmissionSamplerSize.value.set(u.width,u.height)),l.thickness.value=h.thickness,h.thicknessMap&&(l.thicknessMap.value=h.thicknessMap),l.attenuationDistance.value=h.attenuationDistance,l.attenuationColor.value.copy(h.attenuationColor)}(n,r,a):e(n,r)):r.isMeshMatcapMaterial?(t(n,r),function(l,h){h.matcap&&(l.matcap.value=h.matcap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDepthMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDistanceMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias),l.referencePosition.value.copy(h.referencePosition),l.nearDistance.value=h.nearDistance,l.farDistance.value=h.farDistance}(n,r)):r.isMeshNormalMaterial?(t(n,r),function(l,h){h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isLineBasicMaterial?(function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity}(n,r),r.isLineDashedMaterial&&function(l,h){l.dashSize.value=h.dashSize,l.totalSize.value=h.dashSize+h.gapSize,l.scale.value=h.scale}(n,r)):r.isPointsMaterial?function(l,h,u,p){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.size.value=h.size*u,l.scale.value=.5*p,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let _;h.map?_=h.map:h.alphaMap&&(_=h.alphaMap),_!==void 0&&(_.matrixAutoUpdate===!0&&_.updateMatrix(),l.uvTransform.value.copy(_.matrix))}(n,r,o,s):r.isSpriteMaterial?function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.rotation.value=h.rotation,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let u;h.map?u=h.map:h.alphaMap&&(u=h.alphaMap),u!==void 0&&(u.matrixAutoUpdate===!0&&u.updateMatrix(),l.uvTransform.value.copy(u.matrix))}(n,r):r.isShadowMaterial?(n.color.value.copy(r.color),n.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ti(i={}){const t=i.canvas!==void 0?i.canvas:function(){const Ht=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Ht.style.display="block",Ht}(),e=i.context!==void 0?i.context:null,n=i.alpha!==void 0&&i.alpha,r=i.depth===void 0||i.depth,o=i.stencil===void 0||i.stencil,s=i.antialias!==void 0&&i.antialias,a=i.premultipliedAlpha===void 0||i.premultipliedAlpha,l=i.preserveDrawingBuffer!==void 0&&i.preserveDrawingBuffer,h=i.powerPreference!==void 0?i.powerPreference:"default",u=i.failIfMajorPerformanceCaveat!==void 0&&i.failIfMajorPerformanceCaveat;let p=null,_=null;const x=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const M=this;let C=!1,G=0,Q=0,nt=null,ct=-1,it=null;const mt=new Nt,lt=new Nt;let gt=null,Ut=t.width,Ft=t.height,Mt=1,At=null,Ot=null;const Lt=new Nt(0,0,Ut,Ft),ne=new Nt(0,0,Ut,Ft);let $t=!1;const zt=[],Yt=new Br;let ge=!1,be=!1,Pe=null;const Ct=new tn,Bt=new B,ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return nt===null?Mt:1}let se,Ie,Le,ue,bt,jt,ie,ae,qt,ye,nn,on,rn,En,Ai,Jn,dr,za,Va,Wa,hr,pr,He=e;function Wg(Ht,Ce){for(let fe=0;fe<Ht.length;fe++){const Re=Ht[fe],We=t.getContext(Re,Ce);if(We!==null)return We}return null}try{const Ht={alpha:n,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",Yg,!1),t.addEventListener("webglcontextrestored",qg,!1),He===null){const Ce=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&Ce.shift(),He=Wg(Ce,Ht),He===null)throw Wg(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}He.getShaderPrecisionFormat===void 0&&(He.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ht){throw console.error("THREE.WebGLRenderer: "+Ht.message),Ht}function Xg(){se=new el(He),Ie=new Rh(He,se,i),se.init(Ie),hr=new g0(He,se,Ie),Le=new f0(He,se,Ie),zt[0]=1029,ue=new Lh,bt=new s0,jt=new m0(He,se,Le,bt,Ie,hr,ue),ie=new Ph(M),ae=new ts(He,Ie),pr=new ao(He,se,ae,Ie),qt=new Oh(He,ae,ue,pr),ye=new Bh(He,qt,ae,ue),za=new Fh(He),Ai=new Ih(bt),nn=new o0(M,ie,se,Ie,pr,Ai),on=new y0(bt),rn=new l0(bt),En=new p0(se,Ie),dr=new Ch(M,ie,Le,ye,a),Jn=new id(M,ye,Ie),Va=new es(He,se,ue,Ie),Wa=new Nh(He,se,ue,Ie),ue.programs=nn.programs,M.capabilities=Ie,M.extensions=se,M.properties=bt,M.renderLists=rn,M.shadowMap=Jn,M.state=Le,M.info=ue}Xg();const Tr=new _0(M,He);function Yg(Ht){Ht.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function qg(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const Ht=ue.autoReset,Ce=Jn.enabled,fe=Jn.autoUpdate,Re=Jn.needsUpdate,We=Jn.type;Xg(),ue.autoReset=Ht,Jn.enabled=Ce,Jn.autoUpdate=fe,Jn.needsUpdate=Re,Jn.type=We}function Jg(Ht){const Ce=Ht.target;Ce.removeEventListener("dispose",Jg),function(fe){(function(Re){const We=bt.get(Re).programs;We!==void 0&&We.forEach(function(Vn){nn.releaseProgram(Vn)})})(fe),bt.remove(fe)}(Ce)}this.xr=Tr,this.getContext=function(){return He},this.getContextAttributes=function(){return He.getContextAttributes()},this.forceContextLoss=function(){const Ht=se.get("WEBGL_lose_context");Ht&&Ht.loseContext()},this.forceContextRestore=function(){const Ht=se.get("WEBGL_lose_context");Ht&&Ht.restoreContext()},this.getPixelRatio=function(){return Mt},this.setPixelRatio=function(Ht){Ht!==void 0&&(Mt=Ht,this.setSize(Ut,Ft,!1))},this.getSize=function(Ht){return Ht.set(Ut,Ft)},this.setSize=function(Ht,Ce,fe){Tr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ut=Ht,Ft=Ce,t.width=Math.floor(Ht*Mt),t.height=Math.floor(Ce*Mt),fe!==!1&&(t.style.width=Ht+"px",t.style.height=Ce+"px"),this.setViewport(0,0,Ht,Ce))},this.getDrawingBufferSize=function(Ht){return Ht.set(Ut*Mt,Ft*Mt).floor()},this.setDrawingBufferSize=function(Ht,Ce,fe){Ut=Ht,Ft=Ce,Mt=fe,t.width=Math.floor(Ht*fe),t.height=Math.floor(Ce*fe),this.setViewport(0,0,Ht,Ce)},this.getCurrentViewport=function(Ht){return Ht.copy(mt)},this.getViewport=function(Ht){return Ht.copy(Lt)},this.setViewport=function(Ht,Ce,fe,Re){Ht.isVector4?Lt.set(Ht.x,Ht.y,Ht.z,Ht.w):Lt.set(Ht,Ce,fe,Re),Le.viewport(mt.copy(Lt).multiplyScalar(Mt).floor())},this.getScissor=function(Ht){return Ht.copy(ne)},this.setScissor=function(Ht,Ce,fe,Re){Ht.isVector4?ne.set(Ht.x,Ht.y,Ht.z,Ht.w):ne.set(Ht,Ce,fe,Re),Le.scissor(lt.copy(ne).multiplyScalar(Mt).floor())},this.getScissorTest=function(){return $t},this.setScissorTest=function(Ht){Le.setScissorTest($t=Ht)},this.setOpaqueSort=function(Ht){At=Ht},this.setTransparentSort=function(Ht){Ot=Ht},this.getClearColor=function(Ht){return Ht.copy(dr.getClearColor())},this.setClearColor=function(){dr.setClearColor.apply(dr,arguments)},this.getClearAlpha=function(){return dr.getClearAlpha()},this.setClearAlpha=function(){dr.setClearAlpha.apply(dr,arguments)},this.clear=function(Ht,Ce,fe){let Re=0;(Ht===void 0||Ht)&&(Re|=16384),(Ce===void 0||Ce)&&(Re|=256),(fe===void 0||fe)&&(Re|=1024),He.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Yg,!1),t.removeEventListener("webglcontextrestored",qg,!1),rn.dispose(),En.dispose(),bt.dispose(),ie.dispose(),ye.dispose(),pr.dispose(),Tr.dispose(),Tr.removeEventListener("sessionstart",Zg),Tr.removeEventListener("sessionend",Kg),Pe&&(Pe.dispose(),Pe=null),fs.stop()},this.renderBufferImmediate=function(Ht,Ce){pr.initAttributes();const fe=bt.get(Ht);Ht.hasPositions&&!fe.position&&(fe.position=He.createBuffer()),Ht.hasNormals&&!fe.normal&&(fe.normal=He.createBuffer()),Ht.hasUvs&&!fe.uv&&(fe.uv=He.createBuffer()),Ht.hasColors&&!fe.color&&(fe.color=He.createBuffer());const Re=Ce.getAttributes();Ht.hasPositions&&(He.bindBuffer(34962,fe.position),He.bufferData(34962,Ht.positionArray,35048),pr.enableAttribute(Re.position),He.vertexAttribPointer(Re.position,3,5126,!1,0,0)),Ht.hasNormals&&(He.bindBuffer(34962,fe.normal),He.bufferData(34962,Ht.normalArray,35048),pr.enableAttribute(Re.normal),He.vertexAttribPointer(Re.normal,3,5126,!1,0,0)),Ht.hasUvs&&(He.bindBuffer(34962,fe.uv),He.bufferData(34962,Ht.uvArray,35048),pr.enableAttribute(Re.uv),He.vertexAttribPointer(Re.uv,2,5126,!1,0,0)),Ht.hasColors&&(He.bindBuffer(34962,fe.color),He.bufferData(34962,Ht.colorArray,35048),pr.enableAttribute(Re.color),He.vertexAttribPointer(Re.color,3,5126,!1,0,0)),pr.disableUnusedAttributes(),He.drawArrays(4,0,Ht.count),Ht.count=0},this.renderBufferDirect=function(Ht,Ce,fe,Re,We,Vn){Ce===null&&(Ce=ve);const Sn=We.isMesh&&We.matrixWorld.determinant()<0,Ke=tv(Ht,Ce,Re,We);Le.setMaterial(Re,Sn);let Ln=fe.index;const mn=fe.attributes.position;if(Ln===null){if(mn===void 0||mn.count===0)return}else if(Ln.count===0)return;let zn,wn=1;Re.wireframe===!0&&(Ln=qt.getWireframeAttribute(fe),wn=2),(Re.morphTargets||Re.morphNormals)&&za.update(We,fe,Re,Ke),pr.setup(We,Re,Ke,fe,Ln);let Hn=Va;Ln!==null&&(zn=ae.get(Ln),Hn=Wa,Hn.setIndex(zn));const Li=Ln!==null?Ln.count:mn.count,ai=fe.drawRange.start*wn,Vr=fe.drawRange.count*wn,oi=Vn!==null?Vn.start*wn:0,eo=Vn!==null?Vn.count*wn:1/0,ji=Math.max(ai,oi),wr=Math.min(Li,ai+Vr,oi+eo)-1,rr=Math.max(0,wr-ji+1);if(rr!==0){if(We.isMesh)Re.wireframe===!0?(Le.setLineWidth(Re.wireframeLinewidth*le()),Hn.setMode(1)):Hn.setMode(4);else if(We.isLine){let Xa=Re.linewidth;Xa===void 0&&(Xa=1),Le.setLineWidth(Xa*le()),We.isLineSegments?Hn.setMode(1):We.isLineLoop?Hn.setMode(2):Hn.setMode(3)}else We.isPoints?Hn.setMode(0):We.isSprite&&Hn.setMode(4);if(We.isInstancedMesh)Hn.renderInstances(ji,rr,We.count);else if(fe.isInstancedBufferGeometry){const Xa=Math.min(fe.instanceCount,fe._maxInstanceCount);Hn.renderInstances(ji,rr,Xa)}else Hn.render(ji,rr)}},this.compile=function(Ht,Ce){_=En.get(Ht),_.init(),Ht.traverseVisible(function(fe){fe.isLight&&fe.layers.test(Ce.layers)&&(_.pushLight(fe),fe.castShadow&&_.pushShadow(fe))}),_.setupLights(),Ht.traverse(function(fe){const Re=fe.material;if(Re)if(Array.isArray(Re))for(let We=0;We<Re.length;We++)Sc(Re[We],Ht,fe);else Sc(Re,Ht,fe)})};let Ec=null;function Zg(){fs.stop()}function Kg(){fs.start()}const fs=new $o;function yh(Ht,Ce,fe){const Re=Ce.isScene===!0?Ce.overrideMaterial:null;for(let We=0,Vn=Ht.length;We<Vn;We++){const Sn=Ht[We],Ke=Sn.object,Ln=Sn.geometry,mn=Re===null?Sn.material:Re,zn=Sn.group;if(fe.isArrayCamera){const wn=fe.cameras;for(let Hn=0,Li=wn.length;Hn<Li;Hn++){const ai=wn[Hn];Ke.layers.test(ai.layers)&&(Le.viewport(mt.copy(ai.viewport)),_.setupLightsView(ai),Qg(Ke,Ce,ai,Ln,mn,zn))}}else Qg(Ke,Ce,fe,Ln,mn,zn)}}function Qg(Ht,Ce,fe,Re,We,Vn){if(Ht.onBeforeRender(M,Ce,fe,Re,We,Vn),Ht.modelViewMatrix.multiplyMatrices(fe.matrixWorldInverse,Ht.matrixWorld),Ht.normalMatrix.getNormalMatrix(Ht.modelViewMatrix),Ht.isImmediateRenderObject){const Sn=tv(fe,Ce,We,Ht);Le.setMaterial(We),pr.reset(),function(Ke,Ln){Ke.render(function(mn){M.renderBufferImmediate(mn,Ln)})}(Ht,Sn)}else We.transparent===!0&&We.side===2?(We.side=1,We.needsUpdate=!0,M.renderBufferDirect(fe,Ce,Re,We,Ht,Vn),We.side=0,We.needsUpdate=!0,M.renderBufferDirect(fe,Ce,Re,We,Ht,Vn),We.side=2):M.renderBufferDirect(fe,Ce,Re,We,Ht,Vn);Ht.onAfterRender(M,Ce,fe,Re,We,Vn)}function Sc(Ht,Ce,fe){Ce.isScene!==!0&&(Ce=ve);const Re=bt.get(Ht),We=_.state.lights,Vn=_.state.shadowsArray,Sn=We.state.version,Ke=nn.getParameters(Ht,We.state,Vn,Ce,fe),Ln=nn.getProgramCacheKey(Ke);let mn=Re.programs;Re.environment=Ht.isMeshStandardMaterial?Ce.environment:null,Re.fog=Ce.fog,Re.envMap=ie.get(Ht.envMap||Re.environment),mn===void 0&&(Ht.addEventListener("dispose",Jg),mn=new Map,Re.programs=mn);let zn=mn.get(Ln);if(zn!==void 0){if(Re.currentProgram===zn&&Re.lightsStateVersion===Sn)return $g(Ht,Ke),zn}else Ke.uniforms=nn.getUniforms(Ht),Ht.onBuild(Ke,M),Ht.onBeforeCompile(Ke,M),zn=nn.acquireProgram(Ke,Ln),mn.set(Ln,zn),Re.uniforms=Ke.uniforms;const wn=Re.uniforms;(Ht.isShaderMaterial||Ht.isRawShaderMaterial)&&Ht.clipping!==!0||(wn.clippingPlanes=Ai.uniform),$g(Ht,Ke),Re.needsLights=function(ai){return ai.isMeshLambertMaterial||ai.isMeshToonMaterial||ai.isMeshPhongMaterial||ai.isMeshStandardMaterial||ai.isShadowMaterial||ai.isShaderMaterial&&ai.lights===!0}(Ht),Re.lightsStateVersion=Sn,Re.needsLights&&(wn.ambientLightColor.value=We.state.ambient,wn.lightProbe.value=We.state.probe,wn.directionalLights.value=We.state.directional,wn.directionalLightShadows.value=We.state.directionalShadow,wn.spotLights.value=We.state.spot,wn.spotLightShadows.value=We.state.spotShadow,wn.rectAreaLights.value=We.state.rectArea,wn.ltc_1.value=We.state.rectAreaLTC1,wn.ltc_2.value=We.state.rectAreaLTC2,wn.pointLights.value=We.state.point,wn.pointLightShadows.value=We.state.pointShadow,wn.hemisphereLights.value=We.state.hemi,wn.directionalShadowMap.value=We.state.directionalShadowMap,wn.directionalShadowMatrix.value=We.state.directionalShadowMatrix,wn.spotShadowMap.value=We.state.spotShadowMap,wn.spotShadowMatrix.value=We.state.spotShadowMatrix,wn.pointShadowMap.value=We.state.pointShadowMap,wn.pointShadowMatrix.value=We.state.pointShadowMatrix);const Hn=zn.getUniforms(),Li=ii.seqWithValue(Hn.seq,wn);return Re.currentProgram=zn,Re.uniformsList=Li,zn}function $g(Ht,Ce){const fe=bt.get(Ht);fe.outputEncoding=Ce.outputEncoding,fe.instancing=Ce.instancing,fe.skinning=Ce.skinning,fe.numClippingPlanes=Ce.numClippingPlanes,fe.numIntersection=Ce.numClipIntersection,fe.vertexAlphas=Ce.vertexAlphas}function tv(Ht,Ce,fe,Re){Ce.isScene!==!0&&(Ce=ve),jt.resetTextureUnits();const We=Ce.fog,Vn=fe.isMeshStandardMaterial?Ce.environment:null,Sn=nt===null?M.outputEncoding:nt.texture.encoding,Ke=ie.get(fe.envMap||Vn),Ln=fe.vertexColors===!0&&Re.geometry&&Re.geometry.attributes.color&&Re.geometry.attributes.color.itemSize===4,mn=bt.get(fe),zn=_.state.lights;if(ge===!0&&(be===!0||Ht!==it)){const rr=Ht===it&&fe.id===ct;Ai.setState(fe,Ht,rr)}let wn=!1;fe.version===mn.__version?mn.needsLights&&mn.lightsStateVersion!==zn.state.version||mn.outputEncoding!==Sn||Re.isInstancedMesh&&mn.instancing===!1?wn=!0:Re.isInstancedMesh||mn.instancing!==!0?Re.isSkinnedMesh&&mn.skinning===!1?wn=!0:Re.isSkinnedMesh||mn.skinning!==!0?mn.envMap!==Ke||fe.fog&&mn.fog!==We?wn=!0:mn.numClippingPlanes===void 0||mn.numClippingPlanes===Ai.numPlanes&&mn.numIntersection===Ai.numIntersection?mn.vertexAlphas!==Ln&&(wn=!0):wn=!0:wn=!0:wn=!0:(wn=!0,mn.__version=fe.version);let Hn=mn.currentProgram;wn===!0&&(Hn=Sc(fe,Ce,Re));let Li=!1,ai=!1,Vr=!1;const oi=Hn.getUniforms(),eo=mn.uniforms;if(Le.useProgram(Hn.program)&&(Li=!0,ai=!0,Vr=!0),fe.id!==ct&&(ct=fe.id,ai=!0),Li||it!==Ht){if(oi.setValue(He,"projectionMatrix",Ht.projectionMatrix),Ie.logarithmicDepthBuffer&&oi.setValue(He,"logDepthBufFC",2/(Math.log(Ht.far+1)/Math.LN2)),it!==Ht&&(it=Ht,ai=!0,Vr=!0),fe.isShaderMaterial||fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshStandardMaterial||fe.envMap){const rr=oi.map.cameraPosition;rr!==void 0&&rr.setValue(He,Bt.setFromMatrixPosition(Ht.matrixWorld))}(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial)&&oi.setValue(He,"isOrthographic",Ht.isOrthographicCamera===!0),(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial||fe.isShadowMaterial||Re.isSkinnedMesh)&&oi.setValue(He,"viewMatrix",Ht.matrixWorldInverse)}if(Re.isSkinnedMesh){oi.setOptional(He,Re,"bindMatrix"),oi.setOptional(He,Re,"bindMatrixInverse");const rr=Re.skeleton;rr&&(Ie.floatVertexTextures?(rr.boneTexture===null&&rr.computeBoneTexture(),oi.setValue(He,"boneTexture",rr.boneTexture,jt),oi.setValue(He,"boneTextureSize",rr.boneTextureSize)):oi.setOptional(He,rr,"boneMatrices"))}var ji,wr;return(ai||mn.receiveShadow!==Re.receiveShadow)&&(mn.receiveShadow=Re.receiveShadow,oi.setValue(He,"receiveShadow",Re.receiveShadow)),ai&&(oi.setValue(He,"toneMappingExposure",M.toneMappingExposure),mn.needsLights&&(wr=Vr,(ji=eo).ambientLightColor.needsUpdate=wr,ji.lightProbe.needsUpdate=wr,ji.directionalLights.needsUpdate=wr,ji.directionalLightShadows.needsUpdate=wr,ji.pointLights.needsUpdate=wr,ji.pointLightShadows.needsUpdate=wr,ji.spotLights.needsUpdate=wr,ji.spotLightShadows.needsUpdate=wr,ji.rectAreaLights.needsUpdate=wr,ji.hemisphereLights.needsUpdate=wr),We&&fe.fog&&on.refreshFogUniforms(eo,We),on.refreshMaterialUniforms(eo,fe,Mt,Ft,Pe),ii.upload(He,mn.uniformsList,eo,jt)),fe.isShaderMaterial&&fe.uniformsNeedUpdate===!0&&(ii.upload(He,mn.uniformsList,eo,jt),fe.uniformsNeedUpdate=!1),fe.isSpriteMaterial&&oi.setValue(He,"center",Re.center),oi.setValue(He,"modelViewMatrix",Re.modelViewMatrix),oi.setValue(He,"normalMatrix",Re.normalMatrix),oi.setValue(He,"modelMatrix",Re.matrixWorld),Hn}fs.setAnimationLoop(function(Ht){Ec&&Ec(Ht)}),typeof window!="undefined"&&fs.setContext(window),this.setAnimationLoop=function(Ht){Ec=Ht,Tr.setAnimationLoop(Ht),Ht===null?fs.stop():fs.start()},Tr.addEventListener("sessionstart",Zg),Tr.addEventListener("sessionend",Kg),this.render=function(Ht,Ce){if(Ce!==void 0&&Ce.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(C===!0)return;Ht.autoUpdate===!0&&Ht.updateMatrixWorld(),Ce.parent===null&&Ce.updateMatrixWorld(),Tr.enabled===!0&&Tr.isPresenting===!0&&(Tr.cameraAutoUpdate===!0&&Tr.updateCamera(Ce),Ce=Tr.getCamera()),Ht.isScene===!0&&Ht.onBeforeRender(M,Ht,Ce,nt),_=En.get(Ht,w.length),_.init(),w.push(_),Ct.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),Yt.setFromProjectionMatrix(Ct),be=this.localClippingEnabled,ge=Ai.init(this.clippingPlanes,be,Ce),p=rn.get(Ht,x.length),p.init(),x.push(p),function Sn(Ke,Ln,mn,zn){if(Ke.visible===!1)return;if(Ke.layers.test(Ln.layers)){if(Ke.isGroup)mn=Ke.renderOrder;else if(Ke.isLOD)Ke.autoUpdate===!0&&Ke.update(Ln);else if(Ke.isLight)_.pushLight(Ke),Ke.castShadow&&_.pushShadow(Ke);else if(Ke.isSprite){if(!Ke.frustumCulled||Yt.intersectsSprite(Ke)){zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct);const Hn=ye.update(Ke),Li=Ke.material;Li.visible&&p.push(Ke,Hn,Li,mn,Bt.z,null)}}else if(Ke.isImmediateRenderObject)zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct),p.push(Ke,null,Ke.material,mn,Bt.z,null);else if((Ke.isMesh||Ke.isLine||Ke.isPoints)&&(Ke.isSkinnedMesh&&Ke.skeleton.frame!==ue.render.frame&&(Ke.skeleton.update(),Ke.skeleton.frame=ue.render.frame),!Ke.frustumCulled||Yt.intersectsObject(Ke))){zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct);const Hn=ye.update(Ke),Li=Ke.material;if(Array.isArray(Li)){const ai=Hn.groups;for(let Vr=0,oi=ai.length;Vr<oi;Vr++){const eo=ai[Vr],ji=Li[eo.materialIndex];ji&&ji.visible&&p.push(Ke,Hn,ji,mn,Bt.z,eo)}}else Li.visible&&p.push(Ke,Hn,Li,mn,Bt.z,null)}}const wn=Ke.children;for(let Hn=0,Li=wn.length;Hn<Li;Hn++)Sn(wn[Hn],Ln,mn,zn)}(Ht,Ce,0,M.sortObjects),p.finish(),M.sortObjects===!0&&p.sort(At,Ot),ge===!0&&Ai.beginShadows();const fe=_.state.shadowsArray;Jn.render(fe,Ht,Ce),_.setupLights(),_.setupLightsView(Ce),ge===!0&&Ai.endShadows(),this.info.autoReset===!0&&this.info.reset(),dr.render(p,Ht);const Re=p.opaque,We=p.transmissive,Vn=p.transparent;Re.length>0&&yh(Re,Ht,Ce),We.length>0&&function(Sn,Ke,Ln,mn){if(Pe===null){const Hn=s===!0&&Ie.isWebGL2===!0;Pe=new(Hn?st:Vt)(1024,1024,{generateMipmaps:!0,type:hr.convert(1016)!==null?1016:1009,minFilter:1008,magFilter:1003,wrapS:1001,wrapT:1001})}const zn=M.getRenderTarget();M.setRenderTarget(Pe),M.clear();const wn=M.toneMapping;M.toneMapping=0,yh(Sn,Ln,mn),M.toneMapping=wn,jt.updateMultisampleRenderTarget(Pe),jt.updateRenderTargetMipmap(Pe),M.setRenderTarget(zn),yh(Ke,Ln,mn)}(Re,We,Ht,Ce),Vn.length>0&&yh(Vn,Ht,Ce),nt!==null&&(jt.updateMultisampleRenderTarget(nt),jt.updateRenderTargetMipmap(nt)),Ht.isScene===!0&&Ht.onAfterRender(M,Ht,Ce),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1),pr.resetDefaultState(),ct=-1,it=null,w.pop(),_=w.length>0?w[w.length-1]:null,x.pop(),p=x.length>0?x[x.length-1]:null},this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return Q},this.getRenderTarget=function(){return nt},this.setRenderTarget=function(Ht,Ce=0,fe=0){nt=Ht,G=Ce,Q=fe,Ht&&bt.get(Ht).__webglFramebuffer===void 0&&jt.setupRenderTarget(Ht);let Re=null,We=!1,Vn=!1;if(Ht){const Sn=Ht.texture;(Sn.isDataTexture3D||Sn.isDataTexture2DArray)&&(Vn=!0);const Ke=bt.get(Ht).__webglFramebuffer;Ht.isWebGLCubeRenderTarget?(Re=Ke[Ce],We=!0):Re=Ht.isWebGLMultisampleRenderTarget?bt.get(Ht).__webglMultisampledFramebuffer:Ke,mt.copy(Ht.viewport),lt.copy(Ht.scissor),gt=Ht.scissorTest}else mt.copy(Lt).multiplyScalar(Mt).floor(),lt.copy(ne).multiplyScalar(Mt).floor(),gt=$t;if(Le.bindFramebuffer(36160,Re)&&Ie.drawBuffers){let Sn=!1;if(Ht)if(Ht.isWebGLMultipleRenderTargets){const Ke=Ht.texture;if(zt.length!==Ke.length||zt[0]!==36064){for(let Ln=0,mn=Ke.length;Ln<mn;Ln++)zt[Ln]=36064+Ln;zt.length=Ke.length,Sn=!0}}else zt.length===1&&zt[0]===36064||(zt[0]=36064,zt.length=1,Sn=!0);else zt.length===1&&zt[0]===1029||(zt[0]=1029,zt.length=1,Sn=!0);Sn&&(Ie.isWebGL2?He.drawBuffers(zt):se.get("WEBGL_draw_buffers").drawBuffersWEBGL(zt))}if(Le.viewport(mt),Le.scissor(lt),Le.setScissorTest(gt),We){const Sn=bt.get(Ht.texture);He.framebufferTexture2D(36160,36064,34069+Ce,Sn.__webglTexture,fe)}else if(Vn){const Sn=bt.get(Ht.texture),Ke=Ce||0;He.framebufferTextureLayer(36160,36064,Sn.__webglTexture,fe||0,Ke)}},this.readRenderTargetPixels=function(Ht,Ce,fe,Re,We,Vn,Sn){if(!Ht||!Ht.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ke=bt.get(Ht).__webglFramebuffer;if(Ht.isWebGLCubeRenderTarget&&Sn!==void 0&&(Ke=Ke[Sn]),Ke){Le.bindFramebuffer(36160,Ke);try{const Ln=Ht.texture,mn=Ln.format,zn=Ln.type;if(mn!==1023&&hr.convert(mn)!==He.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const wn=zn===1016&&(se.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&se.has("EXT_color_buffer_float"));if(!(zn===1009||hr.convert(zn)===He.getParameter(35738)||zn===1015&&(Ie.isWebGL2||se.has("OES_texture_float")||se.has("WEBGL_color_buffer_float"))||wn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");He.checkFramebufferStatus(36160)===36053?Ce>=0&&Ce<=Ht.width-Re&&fe>=0&&fe<=Ht.height-We&&He.readPixels(Ce,fe,Re,We,hr.convert(mn),hr.convert(zn),Vn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ln=nt!==null?bt.get(nt).__webglFramebuffer:null;Le.bindFramebuffer(36160,Ln)}}},this.copyFramebufferToTexture=function(Ht,Ce,fe=0){const Re=Math.pow(2,-fe),We=Math.floor(Ce.image.width*Re),Vn=Math.floor(Ce.image.height*Re);let Sn=hr.convert(Ce.format);Ie.isWebGL2&&(Sn===6407&&(Sn=32849),Sn===6408&&(Sn=32856)),jt.setTexture2D(Ce,0),He.copyTexImage2D(3553,fe,Sn,Ht.x,Ht.y,We,Vn,0),Le.unbindTexture()},this.copyTextureToTexture=function(Ht,Ce,fe,Re=0){const We=Ce.image.width,Vn=Ce.image.height,Sn=hr.convert(fe.format),Ke=hr.convert(fe.type);jt.setTexture2D(fe,0),He.pixelStorei(37440,fe.flipY),He.pixelStorei(37441,fe.premultiplyAlpha),He.pixelStorei(3317,fe.unpackAlignment),Ce.isDataTexture?He.texSubImage2D(3553,Re,Ht.x,Ht.y,We,Vn,Sn,Ke,Ce.image.data):Ce.isCompressedTexture?He.compressedTexSubImage2D(3553,Re,Ht.x,Ht.y,Ce.mipmaps[0].width,Ce.mipmaps[0].height,Sn,Ce.mipmaps[0].data):He.texSubImage2D(3553,Re,Ht.x,Ht.y,Sn,Ke,Ce.image),Re===0&&fe.generateMipmaps&&He.generateMipmap(3553),Le.unbindTexture()},this.copyTextureToTexture3D=function(Ht,Ce,fe,Re,We=0){if(M.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Vn=Ht.max.x-Ht.min.x+1,Sn=Ht.max.y-Ht.min.y+1,Ke=Ht.max.z-Ht.min.z+1,Ln=hr.convert(Re.format),mn=hr.convert(Re.type);let zn;if(Re.isDataTexture3D)jt.setTexture3D(Re,0),zn=32879;else{if(!Re.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");jt.setTexture2DArray(Re,0),zn=35866}He.pixelStorei(37440,Re.flipY),He.pixelStorei(37441,Re.premultiplyAlpha),He.pixelStorei(3317,Re.unpackAlignment);const wn=He.getParameter(3314),Hn=He.getParameter(32878),Li=He.getParameter(3316),ai=He.getParameter(3315),Vr=He.getParameter(32877),oi=fe.isCompressedTexture?fe.mipmaps[0]:fe.image;He.pixelStorei(3314,oi.width),He.pixelStorei(32878,oi.height),He.pixelStorei(3316,Ht.min.x),He.pixelStorei(3315,Ht.min.y),He.pixelStorei(32877,Ht.min.z),fe.isDataTexture||fe.isDataTexture3D?He.texSubImage3D(zn,We,Ce.x,Ce.y,Ce.z,Vn,Sn,Ke,Ln,mn,oi.data):fe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),He.compressedTexSubImage3D(zn,We,Ce.x,Ce.y,Ce.z,Vn,Sn,Ke,Ln,oi.data)):He.texSubImage3D(zn,We,Ce.x,Ce.y,Ce.z,Vn,Sn,Ke,Ln,mn,oi),He.pixelStorei(3314,wn),He.pixelStorei(32878,Hn),He.pixelStorei(3316,Li),He.pixelStorei(3315,ai),He.pixelStorei(32877,Vr),We===0&&Re.generateMipmaps&&He.generateMipmap(zn),Le.unbindTexture()},this.initTexture=function(Ht){jt.setTexture2D(Ht,0),Le.unbindTexture()},this.resetState=function(){G=0,Q=0,nt=null,Le.reset(),pr.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends ti{}).prototype.isWebGL1Renderer=!0;class Vh extends kn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}}Vh.prototype.isScene=!0;class oa{constructor(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=X()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,o=this.stride;r<o;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=X()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=X()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}oa.prototype.isInterleavedBuffer=!0;const Ii=new B;class sa{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Ii.x=this.getX(e),Ii.y=this.getY(e),Ii.z=this.getZ(e),Ii.applyMatrix4(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Ii.x=this.getX(e),Ii.y=this.getY(e),Ii.z=this.getZ(e),Ii.applyNormalMatrix(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Ii.x=this.getX(e),Ii.y=this.getY(e),Ii.z=this.getZ(e),Ii.transformDirection(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=o,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return new Yn(new this.array.constructor(e),this.itemSize,this.normalized)}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new sa(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}sa.prototype.isInterleavedBufferAttribute=!0;class od extends Ci{constructor(t){super(),this.type="SpriteMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Ts;od.prototype.isSpriteMaterial=!0;const aa=new B,ws=new B,Es=new B,Ss=new R,la=new R,sd=new tn,fl=new B,ha=new B,ml=new B,ad=new R,Wh=new R,ld=new R;class x0 extends kn{constructor(t){if(super(),this.type="Sprite",Ts===void 0){Ts=new Wn;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new oa(e,5);Ts.setIndex([0,1,2,0,2,3]),Ts.setAttribute("position",new sa(n,3,0,!1)),Ts.setAttribute("uv",new sa(n,2,3,!1))}this.geometry=Ts,this.material=t!==void 0?t:new od,this.center=new R(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ws.setFromMatrixScale(this.matrixWorld),sd.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Es.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ws.multiplyScalar(-Es.z);const n=this.material.rotation;let r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));const s=this.center;gl(fl.set(-.5,-.5,0),Es,s,ws,r,o),gl(ha.set(.5,-.5,0),Es,s,ws,r,o),gl(ml.set(.5,.5,0),Es,s,ws,r,o),ad.set(0,0),Wh.set(1,0),ld.set(1,1);let a=t.ray.intersectTriangle(fl,ha,ml,!1,aa);if(a===null&&(gl(ha.set(-.5,.5,0),Es,s,ws,r,o),Wh.set(0,1),a=t.ray.intersectTriangle(fl,ml,ha,!1,aa),a===null))return;const l=t.ray.origin.distanceTo(aa);l<t.near||l>t.far||e.push({distance:l,point:aa.clone(),uv:ui.getUV(aa,fl,ha,ml,ad,Wh,ld,new R),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function gl(i,t,e,n,r,o){Ss.subVectors(i,e).addScalar(.5).multiply(n),r!==void 0?(la.x=o*Ss.x-r*Ss.y,la.y=r*Ss.x+o*Ss.y):la.copy(Ss),i.copy(t),i.x+=la.x,i.y+=la.y,i.applyMatrix4(sd)}x0.prototype.isSprite=!0;const hd=new B,ud=new Nt,cd=new Nt,b0=new B,dd=new tn;class pd extends Tt{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tn,this.bindMatrixInverse=new tn}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Nt,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;ud.fromBufferAttribute(r.attributes.skinIndex,t),cd.fromBufferAttribute(r.attributes.skinWeight,t),hd.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let o=0;o<4;o++){const s=cd.getComponent(o);if(s!==0){const a=ud.getComponent(o);dd.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(b0.copy(hd).applyMatrix4(dd),s)}}return e.applyMatrix4(this.bindMatrixInverse)}}pd.prototype.isSkinnedMesh=!0;class T0 extends kn{constructor(){super(),this.type="Bone"}}T0.prototype.isBone=!0;class fd extends ${constructor(t=null,e=1,n=1,r,o,s,a,l,h=1003,u=1003,p,_){super(null,s,a,l,h,u,r,o,p,_),this.image={data:t,width:e,height:n},this.magFilter=h,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}fd.prototype.isDataTexture=!0;const md=new tn,gd=new tn,vl=[],ua=new Tt;class w0 extends Tt{constructor(t,e,n){super(t,e),this.instanceMatrix=new Yn(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(ua.geometry=this.geometry,ua.material=this.material,ua.material!==void 0)for(let o=0;o<r;o++){this.getMatrixAt(o,md),gd.multiplyMatrices(n,md),ua.matrixWorld=gd,ua.raycast(t,vl);for(let s=0,a=vl.length;s<a;s++){const l=vl[s];l.instanceId=o,l.object=this,e.push(l)}vl.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new Yn(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}w0.prototype.isInstancedMesh=!0;class ca extends Ci{constructor(t){super(),this.type="LineBasicMaterial",this.color=new fn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}ca.prototype.isLineBasicMaterial=!0;const vd=new B,_d=new B,yd=new tn,Xh=new pi,_l=new Ge;class Yh extends kn{constructor(t=new Wn,e=new ca){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[0];for(let r=1,o=e.count;r<o;r++)vd.fromBufferAttribute(e,r-1),_d.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=vd.distanceTo(_d);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),_l.copy(n.boundingSphere),_l.applyMatrix4(r),_l.radius+=o,t.ray.intersectsSphere(_l)===!1)return;yd.copy(r).invert(),Xh.copy(t.ray).applyMatrix4(yd);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new B,u=new B,p=new B,_=new B,x=this.isLineSegments?2:1;if(n.isBufferGeometry){const w=n.index,M=n.attributes.position;if(w!==null)for(let C=Math.max(0,s.start),G=Math.min(w.count,s.start+s.count)-1;C<G;C+=x){const Q=w.getX(C),nt=w.getX(C+1);if(h.fromBufferAttribute(M,Q),u.fromBufferAttribute(M,nt),Xh.distanceSqToSegment(h,u,_,p)>l)continue;_.applyMatrix4(this.matrixWorld);const ct=t.ray.origin.distanceTo(_);ct<t.near||ct>t.far||e.push({distance:ct,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}else for(let C=Math.max(0,s.start),G=Math.min(M.count,s.start+s.count)-1;C<G;C+=x){if(h.fromBufferAttribute(M,C),u.fromBufferAttribute(M,C+1),Xh.distanceSqToSegment(h,u,_,p)>l)continue;_.applyMatrix4(this.matrixWorld);const Q=t.ray.origin.distanceTo(_);Q<t.near||Q>t.far||e.push({distance:Q,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Yh.prototype.isLine=!0;const xd=new B,bd=new B;class qh extends Yh{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[];for(let r=0,o=e.count;r<o;r+=2)xd.fromBufferAttribute(e,r),bd.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+xd.distanceTo(bd);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}qh.prototype.isLineSegments=!0;class E0 extends Yh{constructor(t,e){super(t,e),this.type="LineLoop"}}E0.prototype.isLineLoop=!0;class Td extends Ci{constructor(t){super(),this.type="PointsMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}Td.prototype.isPointsMaterial=!0;const wd=new tn,Jh=new pi,yl=new Ge,xl=new B;class S0 extends kn{constructor(t=new Wn,e=new Td){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),yl.copy(n.boundingSphere),yl.applyMatrix4(r),yl.radius+=o,t.ray.intersectsSphere(yl)===!1)return;wd.copy(r).invert(),Jh.copy(t.ray).applyMatrix4(wd);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){const h=n.index,u=n.attributes.position;if(h!==null)for(let p=Math.max(0,s.start),_=Math.min(h.count,s.start+s.count);p<_;p++){const x=h.getX(p);xl.fromBufferAttribute(u,x),Ed(xl,x,l,r,t,e,this)}else for(let p=Math.max(0,s.start),_=Math.min(u.count,s.start+s.count);p<_;p++)xl.fromBufferAttribute(u,p),Ed(xl,p,l,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Ed(i,t,e,n,r,o,s){const a=Jh.distanceSqToPoint(i);if(a<e){const l=new B;Jh.closestPointToPoint(i,l),l.applyMatrix4(n);const h=r.ray.origin.distanceTo(l);if(h<r.near||h>r.far)return;o.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:s})}}S0.prototype.isPoints=!0,class extends ${constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.format=s!==void 0?s:1022,this.minFilter=o!==void 0?o:1006,this.magFilter=r!==void 0?r:1006,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in i&&i.requestVideoFrameCallback(function u(){h.needsUpdate=!0,i.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){const i=this.image;!("requestVideoFrameCallback"in i)&&i.readyState>=i.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0;class A0 extends ${constructor(t,e,n,r,o,s,a,l,h,u,p,_){super(null,s,a,l,h,u,r,o,p,_),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}A0.prototype.isCompressedTexture=!0,class extends ${constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,class extends ${constructor(i,t,e,n,r,o,s,a,l,h){if((h=h!==void 0?h:1026)!==1026&&h!==1027)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");e===void 0&&h===1026&&(e=1012),e===void 0&&h===1027&&(e=1020),super(null,n,r,o,s,a,h,e,l),this.image={width:i,height:t},this.magFilter=s!==void 0?s:1003,this.minFilter=a!==void 0?a:1003,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=!0,new B,new B,new B,new ui;class Ir{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),o=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),o+=n.distanceTo(r),e.push(o),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const o=n.length;let s;s=e||t*n[o-1];let a,l=0,h=o-1;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),a=n[r]-s,a<0)l=r+1;else{if(!(a>0)){h=r;break}h=r-1}if(r=h,n[r]===s)return r/(o-1);const u=n[r];return(r+(s-u)/(n[r+1]-u))/(o-1)}getTangent(t,e){let n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);const o=this.getPoint(n),s=this.getPoint(r),a=e||(o.isVector2?new R:new B);return a.copy(s).sub(o).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new B,r=[],o=[],s=[],a=new B,l=new tn;for(let x=0;x<=t;x++){const w=x/t;r[x]=this.getTangentAt(w,new B),r[x].normalize()}o[0]=new B,s[0]=new B;let h=Number.MAX_VALUE;const u=Math.abs(r[0].x),p=Math.abs(r[0].y),_=Math.abs(r[0].z);u<=h&&(h=u,n.set(1,0,0)),p<=h&&(h=p,n.set(0,1,0)),_<=h&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let x=1;x<=t;x++){if(o[x]=o[x-1].clone(),s[x]=s[x-1].clone(),a.crossVectors(r[x-1],r[x]),a.length()>Number.EPSILON){a.normalize();const w=Math.acos(et(r[x-1].dot(r[x]),-1,1));o[x].applyMatrix4(l.makeRotationAxis(a,w))}s[x].crossVectors(r[x],o[x])}if(e===!0){let x=Math.acos(et(o[0].dot(o[t]),-1,1));x/=t,r[0].dot(a.crossVectors(o[0],o[t]))>0&&(x=-x);for(let w=1;w<=t;w++)o[w].applyMatrix4(l.makeRotationAxis(r[w],x*w)),s[w].crossVectors(r[w],o[w])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class bl extends Ir{constructor(t=0,e=0,n=1,r=1,o=0,s=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(t,e){const n=e||new R,r=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=s?0:r),this.aClockwise!==!0||s||(o===r?o=-r:o-=r);const a=this.aStartAngle+t*o;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),p=Math.sin(this.aRotation),_=l-this.aX,x=h-this.aY;l=_*u-x*p+this.aX,h=_*p+x*u+this.aY}return n.set(l,h)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}bl.prototype.isEllipseCurve=!0;class Sd extends bl{constructor(t,e,n,r,o,s){super(t,e,n,n,r,o,s),this.type="ArcCurve"}}function Zh(){let i=0,t=0,e=0,n=0;function r(o,s,a,l){i=o,t=a,e=-3*o+3*s-2*a-l,n=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,h){r(s,a,h*(a-o),h*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,h,u,p){let _=(s-o)/h-(a-o)/(h+u)+(a-s)/u,x=(a-s)/u-(l-s)/(u+p)+(l-a)/p;_*=u,x*=u,r(s,a,_,x)},calc:function(o){const s=o*o;return i+t*o+e*s+n*(s*o)}}}Sd.prototype.isArcCurve=!0;const Tl=new B,Kh=new Zh,Qh=new Zh,$h=new Zh;class Ad extends Ir{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new B){const n=e,r=this.points,o=r.length,s=(o-(this.closed?0:1))*t;let a,l,h=Math.floor(s),u=s-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/o)+1)*o:u===0&&h===o-1&&(h=o-2,u=1),this.closed||h>0?a=r[(h-1)%o]:(Tl.subVectors(r[0],r[1]).add(r[0]),a=Tl);const p=r[h%o],_=r[(h+1)%o];if(this.closed||h+2<o?l=r[(h+2)%o]:(Tl.subVectors(r[o-1],r[o-2]).add(r[o-1]),l=Tl),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let w=Math.pow(a.distanceToSquared(p),x),M=Math.pow(p.distanceToSquared(_),x),C=Math.pow(_.distanceToSquared(l),x);M<1e-4&&(M=1),w<1e-4&&(w=M),C<1e-4&&(C=M),Kh.initNonuniformCatmullRom(a.x,p.x,_.x,l.x,w,M,C),Qh.initNonuniformCatmullRom(a.y,p.y,_.y,l.y,w,M,C),$h.initNonuniformCatmullRom(a.z,p.z,_.z,l.z,w,M,C)}else this.curveType==="catmullrom"&&(Kh.initCatmullRom(a.x,p.x,_.x,l.x,this.tension),Qh.initCatmullRom(a.y,p.y,_.y,l.y,this.tension),$h.initCatmullRom(a.z,p.z,_.z,l.z,this.tension));return n.set(Kh.calc(u),Qh.calc(u),$h.calc(u)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new B().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Md(i,t,e,n,r){const o=.5*(n-t),s=.5*(r-e),a=i*i;return(2*e-2*n+o+s)*(i*a)+(-3*e+3*n-2*o-s)*a+o*i+e}function da(i,t,e,n){return function(r,o){const s=1-r;return s*s*o}(i,t)+function(r,o){return 2*(1-r)*r*o}(i,e)+function(r,o){return r*r*o}(i,n)}function pa(i,t,e,n,r){return function(o,s){const a=1-o;return a*a*a*s}(i,t)+function(o,s){const a=1-o;return 3*a*a*o*s}(i,e)+function(o,s){return 3*(1-o)*o*o*s}(i,n)+function(o,s){return o*o*o*s}(i,r)}Ad.prototype.isCatmullRomCurve3=!0;class tu extends Ir{constructor(t=new R,e=new R,n=new R,r=new R){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new R){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(pa(t,r.x,o.x,s.x,a.x),pa(t,r.y,o.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}tu.prototype.isCubicBezierCurve=!0;class Cd extends Ir{constructor(t=new B,e=new B,n=new B,r=new B){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new B){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(pa(t,r.x,o.x,s.x,a.x),pa(t,r.y,o.y,s.y,a.y),pa(t,r.z,o.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Cd.prototype.isCubicBezierCurve3=!0;class wl extends Ir{constructor(t=new R,e=new R){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new R){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new R;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}wl.prototype.isLineCurve=!0;class eu extends Ir{constructor(t=new R,e=new R,n=new R){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new R){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(da(t,r.x,o.x,s.x),da(t,r.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}eu.prototype.isQuadraticBezierCurve=!0;class Rd extends Ir{constructor(t=new B,e=new B,n=new B){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new B){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(da(t,r.x,o.x,s.x),da(t,r.y,o.y,s.y),da(t,r.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Rd.prototype.isQuadraticBezierCurve3=!0;class nu extends Ir{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new R){const n=e,r=this.points,o=(r.length-1)*t,s=Math.floor(o),a=o-s,l=r[s===0?s:s-1],h=r[s],u=r[s>r.length-2?r.length-1:s+1],p=r[s>r.length-3?r.length-1:s+2];return n.set(Md(a,l.x,h.x,u.x,p.x),Md(a,l.y,h.y,u.y,p.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new R().fromArray(r))}return this}}nu.prototype.isSplineCurve=!0;var Id=Object.freeze({__proto__:null,ArcCurve:Sd,CatmullRomCurve3:Ad,CubicBezierCurve:tu,CubicBezierCurve3:Cd,EllipseCurve:bl,LineCurve:wl,LineCurve3:class extends Ir{constructor(i=new B,t=new B){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=i,this.v2=t}getPoint(i,t=new B){const e=t;return i===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(i).add(this.v1)),e}getPointAt(i,t){return this.getPoint(i,t)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},QuadraticBezierCurve:eu,QuadraticBezierCurve3:Rd,SplineCurve:nu});const M0=function(i,t,e=2){const n=t&&t.length,r=n?t[0]*e:i.length;let o=Pd(i,0,r,e,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,h,u,p,_,x;if(n&&(o=function(w,M,C,G){const Q=[];let nt,ct,it,mt,lt;for(nt=0,ct=M.length;nt<ct;nt++)it=M[nt]*G,mt=nt<ct-1?M[nt+1]*G:w.length,lt=Pd(w,it,mt,G,!1),lt===lt.next&&(lt.steiner=!0),Q.push(D0(lt));for(Q.sort(O0),nt=0;nt<Q.length;nt++)N0(Q[nt],C),C=Co(C,C.next);return C}(i,t,o,e)),i.length>80*e){a=h=i[0],l=u=i[1];for(let w=e;w<r;w+=e)p=i[w],_=i[w+1],p<a&&(a=p),_<l&&(l=_),p>h&&(h=p),_>u&&(u=_);x=Math.max(h-a,u-l),x=x!==0?1/x:0}return fa(o,s,e,a,l,x),s};function Pd(i,t,e,n,r){let o,s;if(r===function(a,l,h,u){let p=0;for(let _=l,x=h-u;_<h;_+=u)p+=(a[x]-a[_])*(a[_+1]+a[x+1]),x=_;return p}(i,t,e,n)>0)for(o=t;o<e;o+=n)s=Ld(o,i[o],i[o+1],s);else for(o=e-n;o>=t;o-=n)s=Ld(o,i[o],i[o+1],s);return s&&El(s,s.next)&&(ga(s),s=s.next),s}function Co(i,t){if(!i)return i;t||(t=i);let e,n=i;do if(e=!1,n.steiner||!El(n,n.next)&&_i(n.prev,n,n.next)!==0)n=n.next;else{if(ga(n),n=t=n.prev,n===n.next)break;e=!0}while(e||n!==t);return t}function fa(i,t,e,n,r,o,s){if(!i)return;!s&&o&&function(u,p,_,x){let w=u;do w.z===null&&(w.z=iu(w.x,w.y,p,_,x)),w.prevZ=w.prev,w.nextZ=w.next,w=w.next;while(w!==u);w.prevZ.nextZ=null,w.prevZ=null,function(M){let C,G,Q,nt,ct,it,mt,lt,gt=1;do{for(G=M,M=null,ct=null,it=0;G;){for(it++,Q=G,mt=0,C=0;C<gt&&(mt++,Q=Q.nextZ,Q);C++);for(lt=gt;mt>0||lt>0&&Q;)mt!==0&&(lt===0||!Q||G.z<=Q.z)?(nt=G,G=G.nextZ,mt--):(nt=Q,Q=Q.nextZ,lt--),ct?ct.nextZ=nt:M=nt,nt.prevZ=ct,ct=nt;G=Q}ct.nextZ=null,gt*=2}while(it>1)}(w)}(i,n,r,o);let a,l,h=i;for(;i.prev!==i.next;)if(a=i.prev,l=i.next,o?R0(i,n,r,o):C0(i))t.push(a.i/e),t.push(i.i/e),t.push(l.i/e),ga(i),i=l.next,h=l.next;else if((i=l)===h){s?s===1?fa(i=I0(Co(i),t,e),t,e,n,r,o,2):s===2&&P0(i,t,e,n,r,o):fa(Co(i),t,e,n,r,o,1);break}}function C0(i){const t=i.prev,e=i,n=i.next;if(_i(t,e,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(As(t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y)&&_i(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function R0(i,t,e,n){const r=i.prev,o=i,s=i.next;if(_i(r,o,s)>=0)return!1;const a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,h=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,p=iu(a,l,t,e,n),_=iu(h,u,t,e,n);let x=i.prevZ,w=i.nextZ;for(;x&&x.z>=p&&w&&w.z<=_;){if(x!==i.prev&&x!==i.next&&As(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&_i(x.prev,x,x.next)>=0||(x=x.prevZ,w!==i.prev&&w!==i.next&&As(r.x,r.y,o.x,o.y,s.x,s.y,w.x,w.y)&&_i(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;x&&x.z>=p;){if(x!==i.prev&&x!==i.next&&As(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&_i(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;w&&w.z<=_;){if(w!==i.prev&&w!==i.next&&As(r.x,r.y,o.x,o.y,s.x,s.y,w.x,w.y)&&_i(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function I0(i,t,e){let n=i;do{const r=n.prev,o=n.next.next;!El(r,o)&&Od(r,n,n.next,o)&&ma(r,o)&&ma(o,r)&&(t.push(r.i/e),t.push(n.i/e),t.push(o.i/e),ga(n),ga(n.next),n=i=o),n=n.next}while(n!==i);return Co(n)}function P0(i,t,e,n,r,o){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&F0(s,a)){let l=Nd(s,a);return s=Co(s,s.next),l=Co(l,l.next),fa(s,t,e,n,r,o),void fa(l,t,e,n,r,o)}a=a.next}s=s.next}while(s!==i)}function O0(i,t){return i.x-t.x}function N0(i,t){if(t=function(e,n){let r=n;const o=e.x,s=e.y;let a,l=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const w=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(w<=o&&w>l){if(l=w,w===o){if(s===r.y)return r;if(s===r.next.y)return r.next}a=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!a)return null;if(o===l)return a;const h=a,u=a.x,p=a.y;let _,x=1/0;r=a;do o>=r.x&&r.x>=u&&o!==r.x&&As(s<p?o:l,s,u,p,s<p?l:o,s,r.x,r.y)&&(_=Math.abs(s-r.y)/(o-r.x),ma(r,e)&&(_<x||_===x&&(r.x>a.x||r.x===a.x&&L0(a,r)))&&(a=r,x=_)),r=r.next;while(r!==h);return a}(i,t)){const e=Nd(t,i);Co(t,t.next),Co(e,e.next)}}function L0(i,t){return _i(i.prev,i,t.prev)<0&&_i(t.next,i,i.next)<0}function iu(i,t,e,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function D0(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function As(i,t,e,n,r,o,s,a){return(r-s)*(t-a)-(i-s)*(o-a)>=0&&(i-s)*(n-a)-(e-s)*(t-a)>=0&&(e-s)*(o-a)-(r-s)*(n-a)>=0}function F0(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(e,n){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&Od(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}(i,t)&&(ma(i,t)&&ma(t,i)&&function(e,n){let r=e,o=!1;const s=(e.x+n.x)/2,a=(e.y+n.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&s<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next;while(r!==e);return o}(i,t)&&(_i(i.prev,i,t.prev)||_i(i,t.prev,t))||El(i,t)&&_i(i.prev,i,i.next)>0&&_i(t.prev,t,t.next)>0)}function _i(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function El(i,t){return i.x===t.x&&i.y===t.y}function Od(i,t,e,n){const r=Al(_i(i,t,e)),o=Al(_i(i,t,n)),s=Al(_i(e,n,i)),a=Al(_i(e,n,t));return r!==o&&s!==a||!(r!==0||!Sl(i,e,t))||!(o!==0||!Sl(i,n,t))||!(s!==0||!Sl(e,i,n))||!(a!==0||!Sl(e,t,n))}function Sl(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Al(i){return i>0?1:i<0?-1:0}function ma(i,t){return _i(i.prev,i,i.next)<0?_i(i,t,i.next)>=0&&_i(i,i.prev,t)>=0:_i(i,t,i.prev)<0||_i(i,i.next,t)<0}function Nd(i,t){const e=new ru(i.i,i.x,i.y),n=new ru(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function Ld(i,t,e,n){const r=new ru(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function ga(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ru(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ro{static area(t){const e=t.length;let n=0;for(let r=e-1,o=0;o<e;r=o++)n+=t[r].x*t[o].y-t[o].x*t[r].y;return .5*n}static isClockWise(t){return Ro.area(t)<0}static triangulateShape(t,e){const n=[],r=[],o=[];Dd(t),Fd(n,t);let s=t.length;e.forEach(Dd);for(let l=0;l<e.length;l++)r.push(s),s+=e[l].length,Fd(n,e[l]);const a=M0(n,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function Dd(i){const t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function Fd(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}class Ms extends Wn{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],o=[];for(let a=0,l=t.length;a<l;a++)s(t[a]);function s(a){const l=[],h=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1;let p=e.depth!==void 0?e.depth:100,_=e.bevelEnabled===void 0||e.bevelEnabled,x=e.bevelThickness!==void 0?e.bevelThickness:6,w=e.bevelSize!==void 0?e.bevelSize:x-2,M=e.bevelOffset!==void 0?e.bevelOffset:0,C=e.bevelSegments!==void 0?e.bevelSegments:3;const G=e.extrudePath,Q=e.UVGenerator!==void 0?e.UVGenerator:B0;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=e.amount);let nt,ct,it,mt,lt,gt=!1;G&&(nt=G.getSpacedPoints(u),gt=!0,_=!1,ct=G.computeFrenetFrames(u,!1),it=new B,mt=new B,lt=new B),_||(C=0,x=0,w=0,M=0);const Ut=a.extractPoints(h);let Ft=Ut.shape;const Mt=Ut.holes;if(!Ro.isClockWise(Ft)){Ft=Ft.reverse();for(let ue=0,bt=Mt.length;ue<bt;ue++){const jt=Mt[ue];Ro.isClockWise(jt)&&(Mt[ue]=jt.reverse())}}const At=Ro.triangulateShape(Ft,Mt),Ot=Ft;for(let ue=0,bt=Mt.length;ue<bt;ue++){const jt=Mt[ue];Ft=Ft.concat(jt)}function Lt(ue,bt,jt){return bt||console.error("THREE.ExtrudeGeometry: vec does not exist"),bt.clone().multiplyScalar(jt).add(ue)}const ne=Ft.length,$t=At.length;function zt(ue,bt,jt){let ie,ae,qt;const ye=ue.x-bt.x,nn=ue.y-bt.y,on=jt.x-ue.x,rn=jt.y-ue.y,En=ye*ye+nn*nn,Ai=ye*rn-nn*on;if(Math.abs(Ai)>Number.EPSILON){const Jn=Math.sqrt(En),dr=Math.sqrt(on*on+rn*rn),za=bt.x-nn/Jn,Va=bt.y+ye/Jn,Wa=((jt.x-rn/dr-za)*rn-(jt.y+on/dr-Va)*on)/(ye*rn-nn*on);ie=za+ye*Wa-ue.x,ae=Va+nn*Wa-ue.y;const hr=ie*ie+ae*ae;if(hr<=2)return new R(ie,ae);qt=Math.sqrt(hr/2)}else{let Jn=!1;ye>Number.EPSILON?on>Number.EPSILON&&(Jn=!0):ye<-Number.EPSILON?on<-Number.EPSILON&&(Jn=!0):Math.sign(nn)===Math.sign(rn)&&(Jn=!0),Jn?(ie=-nn,ae=ye,qt=Math.sqrt(En)):(ie=ye,ae=nn,qt=Math.sqrt(En/2))}return new R(ie/qt,ae/qt)}const Yt=[];for(let ue=0,bt=Ot.length,jt=bt-1,ie=ue+1;ue<bt;ue++,jt++,ie++)jt===bt&&(jt=0),ie===bt&&(ie=0),Yt[ue]=zt(Ot[ue],Ot[jt],Ot[ie]);const ge=[];let be,Pe=Yt.concat();for(let ue=0,bt=Mt.length;ue<bt;ue++){const jt=Mt[ue];be=[];for(let ie=0,ae=jt.length,qt=ae-1,ye=ie+1;ie<ae;ie++,qt++,ye++)qt===ae&&(qt=0),ye===ae&&(ye=0),be[ie]=zt(jt[ie],jt[qt],jt[ye]);ge.push(be),Pe=Pe.concat(be)}for(let ue=0;ue<C;ue++){const bt=ue/C,jt=x*Math.cos(bt*Math.PI/2),ie=w*Math.sin(bt*Math.PI/2)+M;for(let ae=0,qt=Ot.length;ae<qt;ae++){const ye=Lt(Ot[ae],Yt[ae],ie);ve(ye.x,ye.y,-jt)}for(let ae=0,qt=Mt.length;ae<qt;ae++){const ye=Mt[ae];be=ge[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Lt(ye[nn],be[nn],ie);ve(rn.x,rn.y,-jt)}}}const Ct=w+M;for(let ue=0;ue<ne;ue++){const bt=_?Lt(Ft[ue],Pe[ue],Ct):Ft[ue];gt?(mt.copy(ct.normals[0]).multiplyScalar(bt.x),it.copy(ct.binormals[0]).multiplyScalar(bt.y),lt.copy(nt[0]).add(mt).add(it),ve(lt.x,lt.y,lt.z)):ve(bt.x,bt.y,0)}for(let ue=1;ue<=u;ue++)for(let bt=0;bt<ne;bt++){const jt=_?Lt(Ft[bt],Pe[bt],Ct):Ft[bt];gt?(mt.copy(ct.normals[ue]).multiplyScalar(jt.x),it.copy(ct.binormals[ue]).multiplyScalar(jt.y),lt.copy(nt[ue]).add(mt).add(it),ve(lt.x,lt.y,lt.z)):ve(jt.x,jt.y,p/u*ue)}for(let ue=C-1;ue>=0;ue--){const bt=ue/C,jt=x*Math.cos(bt*Math.PI/2),ie=w*Math.sin(bt*Math.PI/2)+M;for(let ae=0,qt=Ot.length;ae<qt;ae++){const ye=Lt(Ot[ae],Yt[ae],ie);ve(ye.x,ye.y,p+jt)}for(let ae=0,qt=Mt.length;ae<qt;ae++){const ye=Mt[ae];be=ge[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Lt(ye[nn],be[nn],ie);gt?ve(rn.x,rn.y+nt[u-1].y,nt[u-1].x+jt):ve(rn.x,rn.y,p+jt)}}}function Bt(ue,bt){let jt=ue.length;for(;--jt>=0;){const ie=jt;let ae=jt-1;ae<0&&(ae=ue.length-1);for(let qt=0,ye=u+2*C;qt<ye;qt++){const nn=ne*qt,on=ne*(qt+1);se(bt+ie+nn,bt+ae+nn,bt+ae+on,bt+ie+on)}}}function ve(ue,bt,jt){l.push(ue),l.push(bt),l.push(jt)}function le(ue,bt,jt){Ie(ue),Ie(bt),Ie(jt);const ie=r.length/3,ae=Q.generateTopUV(n,r,ie-3,ie-2,ie-1);Le(ae[0]),Le(ae[1]),Le(ae[2])}function se(ue,bt,jt,ie){Ie(ue),Ie(bt),Ie(ie),Ie(bt),Ie(jt),Ie(ie);const ae=r.length/3,qt=Q.generateSideWallUV(n,r,ae-6,ae-3,ae-2,ae-1);Le(qt[0]),Le(qt[1]),Le(qt[3]),Le(qt[1]),Le(qt[2]),Le(qt[3])}function Ie(ue){r.push(l[3*ue+0]),r.push(l[3*ue+1]),r.push(l[3*ue+2])}function Le(ue){o.push(ue.x),o.push(ue.y)}(function(){const ue=r.length/3;if(_){let bt=0,jt=ne*bt;for(let ie=0;ie<$t;ie++){const ae=At[ie];le(ae[2]+jt,ae[1]+jt,ae[0]+jt)}bt=u+2*C,jt=ne*bt;for(let ie=0;ie<$t;ie++){const ae=At[ie];le(ae[0]+jt,ae[1]+jt,ae[2]+jt)}}else{for(let bt=0;bt<$t;bt++){const jt=At[bt];le(jt[2],jt[1],jt[0])}for(let bt=0;bt<$t;bt++){const jt=At[bt];le(jt[0]+ne*u,jt[1]+ne*u,jt[2]+ne*u)}}n.addGroup(ue,r.length/3-ue,0)})(),function(){const ue=r.length/3;let bt=0;Bt(Ot,bt),bt+=Ot.length;for(let jt=0,ie=Mt.length;jt<ie;jt++){const ae=Mt[jt];Bt(ae,bt),bt+=ae.length}n.addGroup(ue,r.length/3-ue,1)}()}this.setAttribute("position",new An(r,3)),this.setAttribute("uv",new An(o,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(e,n,r){if(r.shapes=[],Array.isArray(e))for(let o=0,s=e.length;o<s;o++){const a=e[o];r.shapes.push(a.uuid)}else r.shapes.push(e.uuid);return n.extrudePath!==void 0&&(r.options.extrudePath=n.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let o=0,s=t.shapes.length;o<s;o++){const a=e[t.shapes[o]];n.push(a)}const r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new Id[r.type]().fromJSON(r)),new Ms(n,t.options)}}const B0={generateTopUV:function(i,t,e,n,r){const o=t[3*e],s=t[3*e+1],a=t[3*n],l=t[3*n+1],h=t[3*r],u=t[3*r+1];return[new R(o,s),new R(a,l),new R(h,u)]},generateSideWallUV:function(i,t,e,n,r,o){const s=t[3*e],a=t[3*e+1],l=t[3*e+2],h=t[3*n],u=t[3*n+1],p=t[3*n+2],_=t[3*r],x=t[3*r+1],w=t[3*r+2],M=t[3*o],C=t[3*o+1],G=t[3*o+2];return Math.abs(a-u)<Math.abs(s-h)?[new R(s,1-l),new R(h,1-p),new R(_,1-w),new R(M,1-G)]:[new R(a,1-l),new R(u,1-p),new R(x,1-w),new R(C,1-G)]}};class ou extends Wn{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],o=[],s=[];let a=0,l=0;if(Array.isArray(t)===!1)h(t);else for(let u=0;u<t.length;u++)h(t[u]),this.addGroup(a,l,u),a+=l,l=0;function h(u){const p=r.length/3,_=u.extractPoints(e);let x=_.shape;const w=_.holes;Ro.isClockWise(x)===!1&&(x=x.reverse());for(let C=0,G=w.length;C<G;C++){const Q=w[C];Ro.isClockWise(Q)===!0&&(w[C]=Q.reverse())}const M=Ro.triangulateShape(x,w);for(let C=0,G=w.length;C<G;C++){const Q=w[C];x=x.concat(Q)}for(let C=0,G=x.length;C<G;C++){const Q=x[C];r.push(Q.x,Q.y,0),o.push(0,0,1),s.push(Q.x,Q.y)}for(let C=0,G=M.length;C<G;C++){const Q=M[C],nt=Q[0]+p,ct=Q[1]+p,it=Q[2]+p;n.push(nt,ct,it),l+=3}}this.setIndex(n),this.setAttribute("position",new An(r,3)),this.setAttribute("normal",new An(o,3)),this.setAttribute("uv",new An(s,2))}toJSON(){const t=super.toJSON();return function(e,n){if(n.shapes=[],Array.isArray(e))for(let r=0,o=e.length;r<o;r++){const s=e[r];n.shapes.push(s.uuid)}else n.shapes.push(e.uuid);return n}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,o=t.shapes.length;r<o;r++){const s=e[t.shapes[r]];n.push(s)}return new ou(n,t.curveSegments)}}class k0 extends Ci{constructor(t){super(),this.type="ShadowMaterial",this.color=new fn(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}k0.prototype.isShadowMaterial=!0;class U0 extends hn{constructor(t){super(t),this.type="RawShaderMaterial"}}U0.prototype.isRawShaderMaterial=!0;class Bd extends Ci{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}Bd.prototype.isMeshStandardMaterial=!0;class G0 extends Bd{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new R(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=et(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new fn(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new fn).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}G0.prototype.isMeshPhysicalMaterial=!0;class kd extends Ci{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}kd.prototype.isMeshPhongMaterial=!0;class H0 extends Ci{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}H0.prototype.isMeshToonMaterial=!0;class j0 extends Ci{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}j0.prototype.isMeshNormalMaterial=!0;class z0 extends Ci{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}z0.prototype.isMeshLambertMaterial=!0;class V0 extends Ci{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}V0.prototype.isMeshMatcapMaterial=!0;class W0 extends ca{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}W0.prototype.isLineDashedMaterial=!0;const ci={arraySlice:function(i,t,e){return ci.isTypedArray(i)?new i.constructor(i.subarray(t,e!==void 0?e:i.length)):i.slice(t,e)},convertArray:function(i,t,e){return!i||!e&&i.constructor===t?i:typeof t.BYTES_PER_ELEMENT=="number"?new t(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,e=new Array(t);for(let n=0;n!==t;++n)e[n]=n;return e.sort(function(n,r){return i[n]-i[r]}),e},sortedArray:function(i,t,e){const n=i.length,r=new i.constructor(n);for(let o=0,s=0;s!==n;++o){const a=e[o]*t;for(let l=0;l!==t;++l)r[s++]=i[a+l]}return r},flattenJSON:function(i,t,e,n){let r=1,o=i[0];for(;o!==void 0&&o[n]===void 0;)o=i[r++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(t.push(o.time),e.push.apply(e,s)),o=i[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(t.push(o.time),s.toArray(e,e.length)),o=i[r++];while(o!==void 0);else do s=o[n],s!==void 0&&(t.push(o.time),e.push(s)),o=i[r++];while(o!==void 0)},subclip:function(i,t,e,n,r=30){const o=i.clone();o.name=t;const s=[];for(let l=0;l<o.tracks.length;++l){const h=o.tracks[l],u=h.getValueSize(),p=[],_=[];for(let x=0;x<h.times.length;++x){const w=h.times[x]*r;if(!(w<e||w>=n)){p.push(h.times[x]);for(let M=0;M<u;++M)_.push(h.values[x*u+M])}}p.length!==0&&(h.times=ci.convertArray(p,h.times.constructor),h.values=ci.convertArray(_,h.values.constructor),s.push(h))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(i,t=0,e=i,n=30){n<=0&&(n=30);const r=e.tracks.length,o=t/n;for(let s=0;s<r;++s){const a=e.tracks[s],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=i.tracks.find(function(G){return G.name===a.name&&G.ValueTypeName===l});if(h===void 0)continue;let u=0;const p=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);let _=0;const x=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);const w=a.times.length-1;let M;if(o<=a.times[0]){const G=u,Q=p-u;M=ci.arraySlice(a.values,G,Q)}else if(o>=a.times[w]){const G=w*p+u,Q=G+p-u;M=ci.arraySlice(a.values,G,Q)}else{const G=a.createInterpolant(),Q=u,nt=p-u;G.evaluate(o),M=ci.arraySlice(G.resultBuffer,Q,nt)}l==="quaternion"&&new V().fromArray(M).normalize().conjugate().toArray(M);const C=h.times.length;for(let G=0;G<C;++G){const Q=G*x+_;if(l==="quaternion")V.multiplyQuaternionsFlat(h.values,Q,M,0,h.values,Q);else{const nt=x-2*_;for(let ct=0;ct<nt;++ct)h.values[Q+ct]-=M[ct]}}}return i.blendMode=2501,i}};class Io{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],o=e[n-1];t:{e:{let s;n:{i:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<o)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,o)}if(n===a)break;if(o=r,r=e[++n],t<r)break e}s=e.length;break n}if(t>=o)break t;{const a=e[1];t<a&&(n=2,o=a);for(let l=n-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===l)break;if(r=o,o=e[--n-1],t>=o)break e}s=n,n=0}}for(;n<s;){const a=n+s>>>1;t<e[a]?s=a:n=a+1}if(r=e[n],o=e[n-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(r===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,o,t)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=t*r;for(let s=0;s!==r;++s)e[s]=n[o+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Io.prototype.beforeStart_=Io.prototype.copySampleValue_,Io.prototype.afterEnd_=Io.prototype.copySampleValue_;class X0 extends Io{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(t,e,n){const r=this.parameterPositions;let o=t-2,s=t+1,a=r[o],l=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case 2401:o=t,a=2*e-n;break;case 2402:o=r.length-2,a=e+r[o]-r[o+1];break;default:o=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case 2401:s=t,l=2*n-e;break;case 2402:s=1,l=n+r[1]-r[0];break;default:s=t-1,l=e}const h=.5*(n-e),u=this.valueSize;this._weightPrev=h/(e-a),this._weightNext=h/(l-n),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=this._offsetPrev,p=this._offsetNext,_=this._weightPrev,x=this._weightNext,w=(n-e)/(r-e),M=w*w,C=M*w,G=-_*C+2*_*M-_*w,Q=(1+_)*C+(-1.5-2*_)*M+(-.5+_)*w+1,nt=(-1-x)*C+(1.5+x)*M+.5*w,ct=x*C-x*M;for(let it=0;it!==a;++it)o[it]=G*s[u+it]+Q*s[h+it]+nt*s[l+it]+ct*s[p+it];return o}}class Ud extends Io{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=(n-e)/(r-e),p=1-u;for(let _=0;_!==a;++_)o[_]=s[h+_]*p+s[l+_]*u;return o}}class Y0 extends Io{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Xr{constructor(t,e,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ci.convertArray(e,this.TimeBufferType),this.values=ci.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:ci.convertArray(t.times,Array),values:ci.convertArray(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Y0(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Ud(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new X0(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let o=0,s=r-1;for(;o!==r&&n[o]<t;)++o;for(;s!==-1&&n[s]>e;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=ci.arraySlice(n,o,s),this.values=ci.arraySlice(this.values,o*a,s*a)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==o;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),t=!1;break}s=l}if(r!==void 0&&ci.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),t=!1;break}}return t}optimize(){const t=ci.arraySlice(this.times),e=ci.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===2302,o=t.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const h=t[a];if(h!==t[a+1]&&(a!==1||h!==t[0]))if(r)l=!0;else{const u=a*n,p=u-n,_=u+n;for(let x=0;x!==n;++x){const w=e[u+x];if(w!==e[p+x]||w!==e[_+x]){l=!0;break}}}if(l){if(a!==s){t[s]=t[a];const u=a*n,p=s*n;for(let _=0;_!==n;++_)e[p+_]=e[u+_]}++s}}if(o>0){t[s]=t[o];for(let a=o*n,l=s*n,h=0;h!==n;++h)e[l+h]=e[a+h];++s}return s!==t.length?(this.times=ci.arraySlice(t,0,s),this.values=ci.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=ci.arraySlice(this.times,0),e=ci.arraySlice(this.values,0),n=new this.constructor(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}Xr.prototype.TimeBufferType=Float32Array,Xr.prototype.ValueBufferType=Float32Array,Xr.prototype.DefaultInterpolation=2301;class Cs extends Xr{}Cs.prototype.ValueTypeName="bool",Cs.prototype.ValueBufferType=Array,Cs.prototype.DefaultInterpolation=2300,Cs.prototype.InterpolantFactoryMethodLinear=void 0,Cs.prototype.InterpolantFactoryMethodSmooth=void 0;class Gd extends Xr{}Gd.prototype.ValueTypeName="color";class Ml extends Xr{}Ml.prototype.ValueTypeName="number";class q0 extends Io{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(n-e)/(r-e);let h=t*a;for(let u=h+a;h!==u;h+=4)V.slerpFlat(o,0,s,h-a,s,h,l);return o}}class va extends Xr{InterpolantFactoryMethodLinear(t){return new q0(this.times,this.values,this.getValueSize(),t)}}va.prototype.ValueTypeName="quaternion",va.prototype.DefaultInterpolation=2301,va.prototype.InterpolantFactoryMethodSmooth=void 0;class Rs extends Xr{}Rs.prototype.ValueTypeName="string",Rs.prototype.ValueBufferType=Array,Rs.prototype.DefaultInterpolation=2300,Rs.prototype.InterpolantFactoryMethodLinear=void 0,Rs.prototype.InterpolantFactoryMethodSmooth=void 0;class Cl extends Xr{}Cl.prototype.ValueTypeName="vector";class Hd{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=X(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(J0(n[s]).scale(r));const o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let o=0,s=n.length;o!==s;++o)e.push(Xr.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const o=e.length,s=[];for(let a=0;a<o;a++){let l=[],h=[];l.push((a+o-1)%o,a,(a+1)%o),h.push(0,1,0);const u=ci.getKeyframeOrder(l);l=ci.sortedArray(l,1,u),h=ci.sortedArray(h,1,u),r||l[0]!==0||(l.push(o),h.push(h[0])),s.push(new Ml(".morphTargetInfluences["+e[a].name+"]",l,h).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const h=t[a],u=h.name.match(o);if(u&&u.length>1){const p=u[1];let _=r[p];_||(r[p]=_=[]),_.push(h)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,p,_,x,w){if(_.length!==0){const M=[],C=[];ci.flattenJSON(_,M,C,x),M.length!==0&&w.push(new u(p,M,C))}},r=[],o=t.name||"default",s=t.fps||30,a=t.blendMode;let l=t.length||-1;const h=t.hierarchy||[];for(let u=0;u<h.length;u++){const p=h[u].keys;if(p&&p.length!==0)if(p[0].morphTargets){const _={};let x;for(x=0;x<p.length;x++)if(p[x].morphTargets)for(let w=0;w<p[x].morphTargets.length;w++)_[p[x].morphTargets[w]]=-1;for(const w in _){const M=[],C=[];for(let G=0;G!==p[x].morphTargets.length;++G){const Q=p[x];M.push(Q.time),C.push(Q.morphTarget===w?1:0)}r.push(new Ml(".morphTargetInfluence["+w+"]",M,C))}l=_.length*(s||1)}else{const _=".bones["+e[u].name+"]";n(Cl,_+".position",p,"pos",r),n(va,_+".quaternion",p,"rot",r),n(Cl,_+".scale",p,"scl",r)}}return r.length===0?null:new this(o,l,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function J0(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ml;case"vector":case"vector2":case"vector3":case"vector4":return Cl;case"color":return Gd;case"quaternion":return va;case"bool":case"boolean":return Cs;case"string":return Rs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(i.type);if(i.times===void 0){const e=[],n=[];ci.flattenJSON(i.keys,e,n,"value"),i.times=e,i.values=n}return t.parse!==void 0?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}const Is={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Z0{constructor(t,e,n){const r=this;let o=!1,s=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,o===!1&&r.onStart!==void 0&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,p){return h.push(u,p),this},this.removeHandler=function(u){const p=h.indexOf(u);return p!==-1&&h.splice(p,2),this},this.getHandler=function(u){for(let p=0,_=h.length;p<_;p+=2){const x=h[p],w=h[p+1];if(x.global&&(x.lastIndex=0),x.test(u))return w}return null}}}const K0=new Z0;class Po{constructor(t){this.manager=t!==void 0?t:K0,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,o){n.load(t,r,e,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const kr={};class Q0 extends Po{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Is.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;if(kr[t]!==void 0)return void kr[t].push({onLoad:e,onProgress:n,onError:r});const a=t.match(/^data:(.*?)(;base64)?,(.*)$/);let l;if(a){const h=a[1],u=!!a[2];let p=a[3];p=decodeURIComponent(p),u&&(p=atob(p));try{let _;const x=(this.responseType||"").toLowerCase();switch(x){case"arraybuffer":case"blob":const w=new Uint8Array(p.length);for(let C=0;C<p.length;C++)w[C]=p.charCodeAt(C);_=x==="blob"?new Blob([w.buffer],{type:h}):w.buffer;break;case"document":_=new DOMParser().parseFromString(p,h);break;case"json":_=JSON.parse(p);break;default:_=p}setTimeout(function(){e&&e(_),o.manager.itemEnd(t)},0)}catch(_){setTimeout(function(){r&&r(_),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{kr[t]=[],kr[t].push({onLoad:e,onProgress:n,onError:r}),l=new XMLHttpRequest,l.open("GET",t,!0),l.addEventListener("load",function(h){const u=this.response,p=kr[t];if(delete kr[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Is.add(t,u);for(let _=0,x=p.length;_<x;_++){const w=p[_];w.onLoad&&w.onLoad(u)}o.manager.itemEnd(t)}else{for(let _=0,x=p.length;_<x;_++){const w=p[_];w.onError&&w.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),l.addEventListener("progress",function(h){const u=kr[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onProgress&&x.onProgress(h)}},!1),l.addEventListener("error",function(h){const u=kr[t];delete kr[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),l.addEventListener("abort",function(h){const u=kr[t];delete kr[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),this.responseType!==void 0&&(l.responseType=this.responseType),this.withCredentials!==void 0&&(l.withCredentials=this.withCredentials),l.overrideMimeType&&l.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const h in this.requestHeader)l.setRequestHeader(h,this.requestHeader[h]);l.send(null)}return o.manager.itemStart(t),l}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class jd extends Po{constructor(t){super(t)}load(t,e,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Is.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function l(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),Is.add(t,this),e&&e(this),o.manager.itemEnd(t)}function h(u){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),r&&r(u),o.manager.itemError(t),o.manager.itemEnd(t)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(t),a.src=t,a}}class $0 extends Po{constructor(t){super(t)}load(t,e,n,r){const o=new mi,s=new jd(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(h){s.load(t[h],function(u){o.images[h]=u,a++,a===6&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}for(let h=0;h<t.length;++h)l(h);return o}}class t_ extends Po{constructor(t){super(t)}load(t,e,n,r){const o=new $,s=new jd(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(a){o.image=a;const l=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;o.format=l?1022:1023,o.needsUpdate=!0,e!==void 0&&e(o)},n,r),o}}class e_ extends Ir{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new wl(e,t))}getPoint(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const o=n[r]-e,s=this.curves[r],a=s.getLength(),l=a===0?0:1-o/a;return s.getPointAt(l)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],a=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,l=s.getPoints(a);for(let h=0;h<l.length;h++){const u=l[h];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(new Id[r.type]().fromJSON(r))}return this}}class Ps extends e_{constructor(t){super(),this.type="Path",this.currentPoint=new R,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new wl(this.currentPoint.clone(),new R(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const o=new eu(this.currentPoint.clone(),new R(t,e),new R(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,o,s){const a=new tu(this.currentPoint.clone(),new R(t,e),new R(n,r),new R(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new nu(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,o,s){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,r,o,s),this}absarc(t,e,n,r,o,s){return this.absellipse(t,e,n,n,r,o,s),this}ellipse(t,e,n,r,o,s,a,l){const h=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+h,e+u,n,r,o,s,a,l),this}absellipse(t,e,n,r,o,s,a,l){const h=new bl(t,e,n,r,o,s,a,l);if(this.curves.length>0){const p=h.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(h);const u=h.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class su extends Ps{constructor(t){super(t),this.uuid=X(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(new Ps().fromJSON(r))}return this}}class Yr extends kn{constructor(t,e=1){super(),this.type="Light",this.color=new fn(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}Yr.prototype.isLight=!0;class n_ extends Yr{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.groundColor=new fn(e)}copy(t){return Yr.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}n_.prototype.isHemisphereLight=!0;const zd=new tn,Vd=new B,Wd=new B;class au{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new R(512,512),this.map=null,this.mapPass=null,this.matrix=new tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Br,this._frameExtents=new R(1,1),this._viewportCount=1,this._viewports=[new Nt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Vd.setFromMatrixPosition(t.matrixWorld),e.position.copy(Vd),Wd.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Wd),e.updateMatrixWorld(),zd.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zd),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Xd extends au{constructor(){super(new un(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*J*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=t.distance||e.far;n===e.fov&&r===e.aspect&&o===e.far||(e.fov=n,e.aspect=r,e.far=o,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}Xd.prototype.isSpotLightShadow=!0;class i_ extends Yr{constructor(t,e,n=0,r=Math.PI/3,o=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.distance=n,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new Xd}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}i_.prototype.isSpotLight=!0;const Yd=new tn,_a=new B,lu=new B;class qd extends au{constructor(){super(new un(90,1,.5,500)),this._frameExtents=new R(4,2),this._viewportCount=6,this._viewports=[new Nt(2,1,1,1),new Nt(0,1,1,1),new Nt(3,1,1,1),new Nt(1,1,1,1),new Nt(3,0,1,1),new Nt(1,0,1,1)],this._cubeDirections=[new B(1,0,0),new B(-1,0,0),new B(0,0,1),new B(0,0,-1),new B(0,1,0),new B(0,-1,0)],this._cubeUps=[new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,0,1),new B(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,o=t.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),_a.setFromMatrixPosition(t.matrixWorld),n.position.copy(_a),lu.copy(n.position),lu.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(lu),n.updateMatrixWorld(),r.makeTranslation(-_a.x,-_a.y,-_a.z),Yd.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yd)}}qd.prototype.isPointLightShadow=!0;class r_ extends Yr{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new qd}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}r_.prototype.isPointLight=!0;class hu extends vn{constructor(t=-1,e=1,n=1,r=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-t,s=n+t,a=r+e,l=r-e;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,s=o+h*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}hu.prototype.isOrthographicCamera=!0;class Jd extends au{constructor(){super(new hu(-5,5,5,-5,.5,500))}}Jd.prototype.isDirectionalLightShadow=!0;class o_ extends Yr{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.shadow=new Jd}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}o_.prototype.isDirectionalLight=!0;class s_ extends Yr{constructor(t,e){super(t,e),this.type="AmbientLight"}}s_.prototype.isAmbientLight=!0;class a_ extends Yr{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}a_.prototype.isRectAreaLight=!0;class Zd{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new B)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*o),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*r*1.092548),e.addScaledVector(s[5],r*o*1.092548),e.addScaledVector(s[6],.315392*(3*o*o-1)),e.addScaledVector(s[7],n*o*1.092548),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*r),e.addScaledVector(s[2],1.023328*o),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*r),e.addScaledVector(s[5],.858086*r*o),e.addScaledVector(s[6],.743125*o*o-.247708),e.addScaledVector(s[7],.858086*n*o),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,o=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*o,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*o,e[6]=.315392*(3*o*o-1),e[7]=1.092548*n*o,e[8]=.546274*(n*n-r*r)}}Zd.prototype.isSphericalHarmonics3=!0;class uu extends Yr{constructor(t=new Zd,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}uu.prototype.isLightProbe=!0;class l_{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}}class h_ extends Wn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}h_.prototype.isInstancedBufferGeometry=!0;class u_ extends Yn{constructor(t,e,n,r=1){typeof n=="number"&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}u_.prototype.isInstancedBufferAttribute=!0,class extends Po{constructor(i){super(i),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,t,e,n){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const r=this,o=Is.get(i);if(o!==void 0)return r.manager.itemStart(i),setTimeout(function(){t&&t(o),r.manager.itemEnd(i)},0),o;const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader,fetch(i,s).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(a){Is.add(i,a),t&&t(a),r.manager.itemEnd(i)}).catch(function(a){n&&n(a),r.manager.itemError(i),r.manager.itemEnd(i)}),r.manager.itemStart(i)}}.prototype.isImageBitmapLoader=!0;let cu;const c_=function(){return cu===void 0&&(cu=new(window.AudioContext||window.webkitAudioContext)),cu};class d_ extends Po{constructor(t){super(t)}load(t,e,n,r){const o=this,s=new Q0(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(a){try{const l=a.slice(0);c_().decodeAudioData(l,function(h){e(h)})}catch(l){r?r(l):console.error(l),o.manager.itemError(t)}},n,r)}}(class extends uu{constructor(i,t,e=1){super(void 0,e);const n=new fn().set(i),r=new fn().set(t),o=new B(n.r,n.g,n.b),s=new B(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends uu{constructor(i,t=1){super(void 0,t);const e=new fn().set(i);this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class p_ extends kn{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl!==!1)return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl!==!1)return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class f_{constructor(t,e,n){let r,o,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,o=t*r+r;let s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)n[o+a]=n[a];s=e}else{s+=e;const a=e/s;this._mixBufferRegion(n,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=e*this._origIndex;this._mixBufferRegion(n,r,l,1-o,e)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let l=e,h=e+e;l!==h;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let o=n,s=r;o!==s;++o)e[o]=e[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,o){if(r>=.5)for(let s=0;s!==o;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){V.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,o){const s=this._workIndex*o;V.multiplyQuaternionsFlat(t,s,t,e,t,n),V.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,o){const s=1-r;for(let a=0;a!==o;++a){const l=e+a;t[l]=t[l]*s+t[n+a]*r}}_lerpAdditive(t,e,n,r,o){for(let s=0;s!==o;++s){const a=e+s;t[a]=t[a]+t[n+s]*r}}}const m_=new RegExp("[\\[\\]\\.:\\/]","g"),g_="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",v_=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),__=/(WCOD+)?/.source.replace("WCOD",g_),y_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),x_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),b_=new RegExp("^"+v_+__+y_+x_+"$"),T_=["material","materials","bones"];class Qn{constructor(t,e,n){this.path=e,this.parsedPath=n||Qn.parseTrackName(e),this.node=Qn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Qn.Composite(t,e,n):new Qn(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(m_,"")}static parseTrackName(t){const e=b_.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=n.nodeName.substring(r+1);T_.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(o){for(let s=0;s<o.length;s++){const a=o[s];if(a.name===e||a.uuid===e)return a;const l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.node[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let o=e.propertyIndex;if(t||(t=Qn.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let h=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===h){h=u;break}break;default:if(t[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(h!==void 0){if(t[h]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const s=t[r];if(s===void 0){const h=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Qn.Composite=class{constructor(i,t,e){const n=e||Qn.parseTrackName(t);this._targetGroup=i,this._bindings=i.subscribe_(t,n)}getValue(i,t){this.bind();const e=this._targetGroup.nCachedObjects_,n=this._bindings[e];n!==void 0&&n.getValue(i,t)}setValue(i,t){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].setValue(i,t)}bind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].bind()}unbind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].unbind()}},Qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Qn.prototype.GetterByBindingType=[Qn.prototype._getValue_direct,Qn.prototype._getValue_array,Qn.prototype._getValue_arrayElement,Qn.prototype._getValue_toArray],Qn.prototype.SetterByBindingTypeAndVersioning=[[Qn.prototype._setValue_direct,Qn.prototype._setValue_direct_setNeedsUpdate,Qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_array,Qn.prototype._setValue_array_setNeedsUpdate,Qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_arrayElement,Qn.prototype._setValue_arrayElement_setNeedsUpdate,Qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_fromArray,Qn.prototype._setValue_fromArray_setNeedsUpdate,Qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class w_{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const o=e.tracks,s=o.length,a=new Array(s),l={endingStart:2400,endingEnd:2400};for(let h=0;h!==s;++h){const u=o[h].createInterpolant(null);a[h]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const r=this._clip.duration,o=t._clip.duration,s=o/r,a=r/o;t.warp(1,s,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,o=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=o,l[1]=o+n,h[0]=t/s,h[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const o=this._startTime;if(o!==null){const l=(t-o)*n;if(l<0||n===0)return;this._startTime=null,e=n*l}e*=this._updateTimeScale(t);const s=this._updateTime(e),a=this._updateWeight(t);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case 2501:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulateAdditive(a);break;case 2500:default:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulate(r,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,o=this._loopCount;const s=n===2202;if(t===0)return o===-1?r:s&&(1&o)==1?e-r:r;if(n===2200){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=e||r<0){const a=Math.floor(r/e);r-=e*a,o+=Math.abs(a);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const h=t<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(1&o)==1)return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(t,e,n){const r=this._mixer,o=r.time;let s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=e,a[1]=o+t,l[1]=n,this}}(class extends D{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,t){const e=i._localRoot||this._root,n=i._clip.tracks,r=n.length,o=i._propertyBindings,s=i._interpolants,a=e.uuid,l=this._bindingsByRootAndName;let h=l[a];h===void 0&&(h={},l[a]=h);for(let u=0;u!==r;++u){const p=n[u],_=p.name;let x=h[_];if(x!==void 0)o[u]=x;else{if(x=o[u],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,a,_));continue}const w=t&&t._propertyBindings[u].binding.parsedPath;x=new f_(Qn.create(e,_,w),p.ValueTypeName,p.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,a,_),o[u]=x}s[u].resultBuffer=x.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){const e=(i._localRoot||this._root).uuid,n=i._clip.uuid,r=this._actionsByClip[n];this._bindAction(i,r&&r.knownActions[0]),this._addInactiveAction(i,n,e)}const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];r.useCount++==0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.useCount==0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){const t=i._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(i,t,e){const n=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,r[t]=o;else{const s=o.knownActions;i._byClipCacheIndex=s.length,s.push(i)}i._cacheIndex=n.length,n.push(i),o.actionByRoot[e]=i}_removeInactiveAction(i){const t=this._actions,e=t[t.length-1],n=i._cacheIndex;e._cacheIndex=n,t[n]=e,t.pop(),i._cacheIndex=null;const r=i._clip.uuid,o=this._actionsByClip,s=o[r],a=s.knownActions,l=a[a.length-1],h=i._byClipCacheIndex;l._byClipCacheIndex=h,a[h]=l,a.pop(),i._byClipCacheIndex=null,delete s.actionByRoot[(i._localRoot||this._root).uuid],a.length===0&&delete o[r],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.referenceCount==0&&this._removeInactiveBinding(r)}}_lendAction(i){const t=this._actions,e=i._cacheIndex,n=this._nActiveActions++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackAction(i){const t=this._actions,e=i._cacheIndex,n=--this._nActiveActions,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_addInactiveBinding(i,t,e){const n=this._bindingsByRootAndName,r=this._bindings;let o=n[t];o===void 0&&(o={},n[t]=o),o[e]=i,i._cacheIndex=r.length,r.push(i)}_removeInactiveBinding(i){const t=this._bindings,e=i.binding,n=e.rootNode.uuid,r=e.path,o=this._bindingsByRootAndName,s=o[n],a=t[t.length-1],l=i._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[r],Object.keys(s).length===0&&delete o[n]}_lendBinding(i){const t=this._bindings,e=i._cacheIndex,n=this._nActiveBindings++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackBinding(i){const t=this._bindings,e=i._cacheIndex,n=--this._nActiveBindings,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_lendControlInterpolant(){const i=this._controlInterpolants,t=this._nActiveControlInterpolants++;let e=i[t];return e===void 0&&(e=new Ud(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),e.__cacheIndex=t,i[t]=e),e}_takeBackControlInterpolant(i){const t=this._controlInterpolants,e=i.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];i.__cacheIndex=n,t[n]=i,r.__cacheIndex=e,t[e]=r}clipAction(i,t,e){const n=t||this._root,r=n.uuid;let o=typeof i=="string"?Hd.findByName(n,i):i;const s=o!==null?o.uuid:i,a=this._actionsByClip[s];let l=null;if(e===void 0&&(e=o!==null?o.blendMode:2500),a!==void 0){const u=a.actionByRoot[r];if(u!==void 0&&u.blendMode===e)return u;l=a.knownActions[0],o===null&&(o=l._clip)}if(o===null)return null;const h=new w_(this,o,t,e);return this._bindAction(h,l),this._addInactiveAction(h,s,r),h}existingAction(i,t){const e=t||this._root,n=e.uuid,r=typeof i=="string"?Hd.findByName(e,i):i,o=r?r.uuid:i,s=this._actionsByClip[o];return s!==void 0&&s.actionByRoot[n]||null}stopAllAction(){const i=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)i[t].stop();return this}update(i){i*=this.timeScale;const t=this._actions,e=this._nActiveActions,n=this.time+=i,r=Math.sign(i),o=this._accuIndex^=1;for(let l=0;l!==e;++l)t[l]._update(n,i,r,o);const s=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)s[l].apply(o);return this}setTime(i){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){const t=this._actions,e=i.uuid,n=this._actionsByClip,r=n[e];if(r!==void 0){const o=r.knownActions;for(let s=0,a=o.length;s!==a;++s){const l=o[s];this._deactivateAction(l);const h=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=h,t[h]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[e]}}uncacheRoot(i){const t=i.uuid,e=this._actionsByClip;for(const r in e){const o=e[r].actionByRoot[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}const n=this._bindingsByRootAndName[t];if(n!==void 0)for(const r in n){const o=n[r];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(i,t){const e=this.existingAction(i,t);e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1),class extends oa{constructor(i,t,e=1){super(i,t),this.meshPerAttribute=e}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}clone(i){const t=super.clone(i);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(i){const t=super.toJSON(i);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}.prototype.isInstancedInterleavedBuffer=!0,new R,new B,new B,class extends kn{constructor(i){super(),this.material=i,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const Oo=new B,Rl=new tn,du=new tn,E_=new Float32Array(1);new Int32Array(E_.buffer);const Kd=[.125,.215,.35,.446,.526,.582],S_=5+Kd.length,A_=new Qi({side:1,depthWrite:!1,depthTest:!1});new Tt(new ee,A_),M_();function M_(){const i=[],t=[],e=[];let n=8;for(let r=0;r<S_;r++){const o=Math.pow(2,n);t.push(o);let s=1/o;r>4?s=Kd[r-8+4-1]:r==0&&(s=0),e.push(s);const a=1/(o-1),l=-a/2,h=1+a/2,u=[l,l,h,l,h,h,l,l,h,h,l,h],p=6,_=6,x=3,w=2,M=1,C=new Float32Array(x*_*p),G=new Float32Array(w*_*p),Q=new Float32Array(M*_*p);for(let ct=0;ct<p;ct++){const it=ct%3*2/3-1,mt=ct>2?0:-1,lt=[it,mt,0,it+2/3,mt,0,it+2/3,mt+1,0,it,mt,0,it+2/3,mt+1,0,it,mt+1,0];C.set(lt,x*_*ct),G.set(u,w*_*ct);const gt=[ct,ct,ct,ct,ct,ct];Q.set(gt,M*_*ct)}const nt=new Wn;nt.setAttribute("position",new Yn(C,x)),nt.setAttribute("uv",new Yn(G,w)),nt.setAttribute("faceIndex",new Yn(Q,M)),i.push(nt),n>4&&n--}return{_lodPlanes:i,_sizeLods:t,_sigmas:e}}Ir.create=function(i,t){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(Ir.prototype),i.prototype.constructor=i,i.prototype.getPoint=t,i},Ps.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)},class extends qh{constructor(i=10,t=10,e=4473924,n=8947848){e=new fn(e),n=new fn(n);const r=t/2,o=i/t,s=i/2,a=[],l=[];for(let u=0,p=0,_=-s;u<=t;u++,_+=o){a.push(-s,0,_,s,0,_),a.push(_,0,-s,_,0,s);const x=u===r?e:n;x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3}const h=new Wn;h.setAttribute("position",new An(a,3)),h.setAttribute("color",new An(l,3)),super(h,new ca({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends qh{constructor(i){const t=function a(l){const h=[];l&&l.isBone&&h.push(l);for(let u=0;u<l.children.length;u++)h.push.apply(h,a(l.children[u]));return h}(i),e=new Wn,n=[],r=[],o=new fn(0,0,1),s=new fn(0,1,0);for(let a=0;a<t.length;a++){const l=t[a];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}e.setAttribute("position",new An(n,3)),e.setAttribute("color",new An(r,3)),super(e,new ca({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=t,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const t=this.bones,e=this.geometry,n=e.getAttribute("position");du.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const s=t[r];s.parent&&s.parent.isBone&&(Rl.multiplyMatrices(du,s.matrixWorld),Oo.setFromMatrixPosition(Rl),n.setXYZ(o,Oo.x,Oo.y,Oo.z),Rl.multiplyMatrices(du,s.parent.matrixWorld),Oo.setFromMatrixPosition(Rl),n.setXYZ(o+1,Oo.x,Oo.y,Oo.z),o+=2)}e.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Po.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),l_.extractUrlBase(i)},Po.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},vt.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)},vt.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},vt.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},vt.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},vt.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)},Ge.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Br.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)},U.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},U.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},U.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},U.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},U.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},U.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},tn.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)},tn.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new B().setFromMatrixColumn(this,3)},tn.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)},tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tn.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tn.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)},tn.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tn.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tn.prototype.makeFrustum=function(i,t,e,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,t,n,e,r,o)},tn.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},hi.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)},V.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)},V.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},pi.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},pi.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)},pi.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},ui.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ui.prototype.barycoordFromPoint=function(i,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,t)},ui.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)},ui.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)},ui.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)},ui.barycoordFromPoint=function(i,t,e,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ui.getBarycoord(i,t,e,n,r)},ui.normal=function(i,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ui.getNormal(i,t,e,n)},su.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)},su.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ms(this,i)},su.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ou(this,i)},R.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},R.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},R.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},B.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},B.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},B.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)},B.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)},B.prototype.getColumnFromMatrix=function(i,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)},B.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)},B.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},B.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},B.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Nt.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},Nt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},kn.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)},kn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},kn.prototype.translate=function(i,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,i)},kn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},kn.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Tt.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Tt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),pd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},un.prototype.setLens=function(i,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(i)},Object.defineProperties(Yr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}}),Object.defineProperties(Yn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Yn.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},Yn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Yn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Wn.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)},Wn.prototype.addAttribute=function(i,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(i,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new Yn(arguments[1],arguments[2])))},Wn.prototype.addDrawCall=function(i,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,t)},Wn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Wn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Wn.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)},Wn.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(Wn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),oa.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},oa.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ms.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ms.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ms.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Vh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(Ci.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}}}),Object.defineProperties(hn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}}),ti.prototype.clearTarget=function(i,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(t,e,n)},ti.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)},ti.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ti.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ti.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ti.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ti.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ti.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ti.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ti.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ti.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ti.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ti.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ti.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ti.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)},ti.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ti.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ti.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ti.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ti.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ti.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ti.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ti.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ti.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ti.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ti.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(id.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Vt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}}),p_.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new d_().load(i,function(e){t.setBuffer(e)}),this},Kn.prototype.updateCubeMap=function(i,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,t)},Kn.prototype.clear=function(i,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,t,e,n)},P.crossOrigin=void 0,P.loadTexture=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new t_;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},P.loadTextureCube=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new $0;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},P.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},P.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"130"}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="130");var C_=v(6),yi=v.n(C_),R_=v(34),I_=v.n(R_),P_=v(11),Hi=v.n(P_);class O_{constructor(){this.camera=new hu(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(t,e){t.position.z=50}updateAspect(t,e){this.camera.left=-1*t/2,this.camera.right=t/2,this.camera.top=e/2,this.camera.bottom=-1*e/2,this.camera.updateProjectionMatrix()}}const Qd={linear:(i,t,e,n)=>e*i/n+t,easeIn:(i,t,e,n)=>e*(i/=n)*i+t,strongEaseIn:(i,t,e,n)=>e*(i/=n)*i*i*i*i+t,strongEaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i*i*i+1)+t,sineaseIn:(i,t,e,n)=>e*(i/=n)*i*i+t,sineaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i+1)+t},_r=new $;class Zi{constructor(){this.camera=new O_,this.mesh=new Tt,this.material=null,this.geometry=null}applyOptions(t){}addObjects(t){this.mesh.position.z=50,t.add(this.mesh)}setSize(t,e){this.camera.updateAspect(t,e),this.geometry=new Cr(t,e,1,1),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:t},height:{value:e},timePercent:{value:0},texturePrev:{value:_r},textureNext:{value:_r}},this.applyOptions(this.options),this.mesh.geometry=this.geometry,this.mesh.material=this.material}setPrevTexture(t){this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.material.uniforms.textureNext.value=t}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var N_=v(72),L_=v.n(N_),D_=v(73),F_=v.n(D_),B_=v(74),k_=v.n(B_),U_=v(75),G_=v.n(U_),H_=v(76),j_=v.n(H_),z_=v(77),V_=v.n(z_),W_=v(78),X_=v.n(W_),Y_=v(79),q_=v.n(Y_),J_=v(80),Z_=v.n(J_),K_=v(81),Q_=v.n(K_),$_=v(82),ty=v.n($_),ey=v(83),ny=v.n(ey),iy=v(84),ry=v.n(iy),oy=v(85),sy=v.n(oy);class is{constructor(){this.camera=new un(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}focus(t,e){const n=.5*e/Math.tan(Math.PI/6);t.position.z=1e3-n}}class ya{constructor(){this.prevTexture=_r,this.nextTexture=_r,this.geometry=new Wn,this.material=null,this.camera=new is,this.mesh=new Tt,this.textureWidth=0,this.textureHeight=0}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}applyOptions(t){this.options=t}initMesh(t,e){const n=[],r=[],o=[],s=this.verticalSegments,a=this.horizontalSegments(),l=t/2,h=e/2,u=t/a,p=e/s,_=this.extraAttributes(),x=Object.keys(_),w=x.reduce((M,C)=>(M[C]=[],M),{});for(let M=0;M<s;M++){const C=M*p-h;for(let G=0;G<a;G++){const Q=G*u-l;r.push(Q,-C,0),o.push(1*G/a,1-1*M/s),x.forEach(nt=>w[nt].push(..._[nt].generator(M,G))),r.push(Q+u,-C,0),o.push(1*(G+1)/a,1-1*M/s),x.forEach(nt=>w[nt].push(..._[nt].generator(M,G))),r.push(Q,-C-p,0),o.push(1*G/a,1-1*(M+1)/s),x.forEach(nt=>w[nt].push(..._[nt].generator(M,G))),r.push(Q+u,-C-p,0),o.push(1*(G+1)/a,1-1*(M+1)/s),x.forEach(nt=>w[nt].push(..._[nt].generator(M,G)))}}for(let M=0;M<s*a;M++){const C=4*M,G=C+1,Q=C+2,nt=C+3;n.push(G,C,nt),n.push(C,Q,nt)}return this.geometry.setIndex(n),this.geometry.setAttribute("position",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),x.forEach(M=>{const{threeType:C,jsType:G,itemSize:Q}=_[M];this.geometry.setAttribute(M,new C(new G(w[M]),Q))}),{verticalSegments:s,horizontalSegments:a,segmentWidth:u,segmentHeight:p}}setSize(t,e){this.textureWidth=t,this.textureHeight=e,this.camera.updateAspect(t,e),this.camera.focus(this.mesh,e),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:2}),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material;const{verticalSegments:n,horizontalSegments:r,segmentWidth:o,segmentHeight:s}=this.initMesh(t,e);this.material.uniforms={segmentWidth:{value:o},segmentHeight:{value:s},verticalSegments:{value:n},horizontalSegments:{value:r},timePercent:{value:0},texturePrev:{value:_r},textureNext:{value:_r}},this.applyOptions(this.options)}setPrevTexture(t){this.prevTexture=t,this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.nextTexture=t,this.material.uniforms.textureNext.value=t}addObjects(t){t.add(this.mesh)}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var ay=v(86),ly=v.n(ay),hy=v(87),uy=v.n(hy),cy=v(88),dy=v.n(cy),py=v(89),fy=v.n(py),my=v(90),gy=v.n(my),vy=v(91),_y=v.n(vy),yy=v(92),xy=v.n(yy),by=v(93),Ty=v.n(by),wy=v(94),Ey=v.n(wy),Sy=v(95),Ay=v.n(Sy),My=v(96),Cy=v.n(My),Ry=v(97),Iy=v.n(Ry);class $d extends ya{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=Iy.a,this.vertexShader=Cy.a,this.verticalSegments=100}addObjects(t){t.add(this.mesh),t.background=this.nextTexture}extraAttributes(){return{}}applyOptions(t){super.applyOptions(t);const e=this.options.find(n=>n.name==="invX");this.material.uniforms.option={value:e!=null&&e.value?Number(e.value):0}}}var Py=v(98),Oy=v.n(Py),Ny=v(99),Ly=v.n(Ny),Dy=v(100),Fy=v.n(Dy),By=v(101),ky=v.n(By),Uy=v(102),Gy=v.n(Uy),Hy=v(103),jy=v.n(Hy),zy=v(104),Vy=v.n(zy),Wy=v(105),Xy=v.n(Wy),Yy=v(47),tp=v.n(Yy),qy=v(48),ep=v.n(qy),Jy=v(106),Zy=v.n(Jy),Ky=v(107),Qy=v.n(Ky);const $y={RandomLines:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=F_.a,this.options=[{name:"dir",value:"horz"}]}genRandomLines(){let i=[1];for(let e=20;e--;){let n=i.sort((l,h)=>h-l)[0],r=i.indexOf(n),o=Math.random(),s=n*o,a=n*(1-o);i.splice(r,1),i.push(s,a)}let t=i.length;for(;t;){let e=Math.floor(Math.random()*t--);[i[e],i[t]]=[i[t],i[e]]}return i}applyOptions(i){var t,e;super.applyOptions(i),this.material.uniforms.direction={value:((e=(t=this.options)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.value)==="horz"?0:1}}setSize(i,t){super.setSize(i,t),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=L_.a}},Shape:class extends Zi{constructor(){super(...arguments),this.duration=800,this.fragmentShader=k_.a,this.options=[]}},Ripples:class extends Zi{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=G_.a,this.options=[{name:"dir",value:"center"}],this.optionsMap={center:0,ru:1,lu:2,ld:3,rd:4}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"center"]}}},Erase:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=j_.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Dissolve:class extends Zi{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=V_.a,this.options=[],this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setSize(i,t){super.setSize(i,t);for(let e=0;e<1600;e++){let n=this.random40(),r=this.random40();for(;this.dissolveIndices[`${n}_${r}`]!==void 0;)n=this.random40(),r=this.random40();this.dissolveIndices[`${n}_${r}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var i=new Uint8Array(4800);for(let t=0;t<1600;t++){const e=t%40+1,n=Math.floor(t/40)+1,r=3*t;this.dissolveIndices[`${e}_${n}`]===0?(i[r]=0,i[r+1]=0,i[r+2]=0):(i[r]=255,i[r+1]=255,i[r+2]=255)}return new fd(i,40,40,1022)}updateAnimation(i){const t=1600*i-Object.keys(this.dissolveIndices).filter(e=>this.dissolveIndices[e]===1).length;for(let e=0;e<t;e++){const n=Object.keys(this.dissolveIndices).filter(o=>this.dissolveIndices[o]===0),r=Math.ceil(Math.random()*n.length)-1;this.dissolveIndices[n[r]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends Zi{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=X_.a,this.options=[]}},FadeInOut:class extends Zi{constructor(){super(...arguments),this.duration=700,this.fragmentShader=q_.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="thruBlk");this.material.uniforms.option={value:(t==null?void 0:t.value)==="1"?1:0}}},Push:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Z_.a,this.options=[],this.optionsMap={u:0,r:1,d:2,l:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"l"]}}},Separation:class extends Zi{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=Q_.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(n=>n.name==="orient"),e=this.options.find(n=>n.name==="dir");this.material.uniforms.orient={value:(t==null?void 0:t.value)==="vert"},this.material.uniforms.direction={value:(e==null?void 0:e.value)==="in"}}},Display:class extends Zi{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=ty.a,this.options=[]}applyOptions(i){const t=this.options.find(n=>n.name==="dir"),e=this.options.find(n=>n.name==="thruBlk");this.material.uniforms.direction={value:(t==null?void 0:t.value)==="r"},this.material.uniforms.thruBlk={value:(e==null?void 0:e.value)==="1"}}},Uncover:class extends Zi{constructor(){super(...arguments),this.duration=750,this.fragmentShader=ny.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Cover:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=ry.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Flash:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=sy.a,this.options=[]}},Checkerboard:class extends ya{constructor(){super(...arguments),this.duration=2500,this.options=[{name:"dir",value:"horz"}],this.fragmentShader=uy.a,this.vertexShader=ly.a,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>(this.vIndex!==`${i}${t}`&&(this.delay=.3*Math.random(),this.vIndex=`${i}${t}`),[this.delay])},segment:{threeType:An,jsType:Float32Array,itemSize:2,generator:(i,t)=>[t,i]},option:{threeType:ea,jsType:Int32Array,itemSize:1,generator:()=>[this.options.find(i=>i.name==="dir"&&i.value==="horz")?0:1]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new Wn,this.material=new hn({fragmentShader:fy.a,vertexShader:dy.a,side:2}),this.camera=new is,this.mesh=new Tt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=Math.ceil(124*i/t),h=i/2,u=t/2,p=i/l,_=t/124;for(let x=0;x<124;x++){const w=x*_-u;for(let M=0;M<l;M++){const C=M*p-h,G=Math.ceil((M+1)/((l+1)/12)),Q=.4/G,nt=(G-1)*Q+Math.random()*Q;n.push(C,-w,0),o.push(1*M/l,1-1*x/124),r.push(0,0,1),s.push(M,x),a.push(nt),n.push(C+p,-w,0),o.push(1*(M+1)/l,1-1*x/124),r.push(0,0,1),s.push(M,x),a.push(nt),n.push(C,-w-_,0),o.push(1*M/l,1-1*(x+1)/124),r.push(0,0,1),s.push(M,x),a.push(nt),n.push(C+p,-w-_,0),o.push(1*(M+1)/l,1-1*(x+1)/124),r.push(0,0,1),s.push(M,x),a.push(nt)}}for(let x=0;x<124*l;x++){const w=4*x,M=w+1,C=w+2,G=w+3;e.push(M,w,G),e.push(w,C,G)}return this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("normal",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("segment",new An(new Float32Array(s),2)),this.geometry.setAttribute("times",new An(new Float32Array(a),1)),{verticalSegments:124,horizontalSegments:l,segmentWidth:p,segmentHeight:_}}setSize(i,t){const{verticalSegments:e,horizontalSegments:n,segmentWidth:r,segmentHeight:o}=this.initData(i,t);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:r},segmentHeight:{value:o},verticalSegments:{value:e},horizontalSegments:{value:n},timePercent:{value:0},texturePrev:{value:_r},textureNext:{value:_r}},this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,new kd({side:2,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new Wn,this.material=new hn({fragmentShader:_y.a,vertexShader:gy.a,side:2}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new is,this.mesh=new Tt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=i/2,h=t/2,u=i/this.horizontalSegments;for(let p=0;p<this.horizontalSegments;p++){const _=Math.abs(p-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),x=p*u-l;n.push(x,h,0),r.push(0),o.push(p/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,h,0),r.push(0),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x,-1*h,0),r.push(0),o.push(p/this.horizontalSegments,0),s.push(p),a.push(_),n.push(x+u,-1*h,0),o.push((p+1)/this.horizontalSegments,0),r.push(0),s.push(p),a.push(_),n.push(x+u,h,0),r.push(1),o.push(p/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,h,-1*u),r.push(1),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,-1*h,0),r.push(1),o.push(p/this.horizontalSegments,0),s.push(p),a.push(_),n.push(x+u,-1*h,-1*u),o.push((p+1)/this.horizontalSegments,0),r.push(1),s.push(p),a.push(_)}for(let p=0;p<this.horizontalSegments;p++){const _=8*p,x=_+1,w=_+2,M=_+3,C=_+4,G=_+5,Q=_+6,nt=_+7;e.push(x,_,M),e.push(_,w,M),e.push(G,C,nt),e.push(C,Q,nt)}this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("index",new An(new Float32Array(s),1)),this.geometry.setAttribute("type",new An(new Float32Array(r),1)),this.geometry.setAttribute("delay",new An(new Float32Array(a),1))}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}setSize(i,t){this.initData(i,t),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:i/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:_r},textureNext:{value:_r}},this.meshToCameraDistance=.5*t/Math.tan(Math.PI/6),this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},Curtain:class extends ya{constructor(){super(...arguments),this.duration=6e3,this.options=[],this.fragmentShader=Ty.a,this.vertexShader=xy.a,this.verticalSegments=100}extraAttributes(){return{isLeft:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>[t<this.horizontalSegments()/2?1:0]}}}addObjects(i){super.addObjects(i),this.mesh.position.z+=20,i.background=this.nextTexture}},Fall:class extends ya{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.options=[{name:"invX",value:"0"}],this.verticalSegments=100,this.fragmentShader=Ay.a,this.vertexShader=Ey.a}extraAttributes(){return{}}setSize(i,t){var e;super.setSize(i,t);const n=this.options.find(r=>r.name==="invX");this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))},this.material.uniforms.option={value:(e=n==null?void 0:n.value)!==null&&e!==void 0?e:0}}addObjects(i){i.add(this.mesh),i.background=this.nextTexture}updateAnimation(i){this.material.uniforms.timePercent.value=i}},Suspension:class extends $d{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=Ly.a,this.vertexShader=Oy.a}addObjects(i){i.add(this.mesh),i.background=this.prevTexture}},Clock:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Fy.a,this.options=[]}},Combing:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=ky.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="vert"?1:0}}},Scale:class extends Zi{constructor(){super(...arguments),this.duration=900,this.fragmentShader=Gy.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="in"?0:1}}},PeelOff:$d,Flip:class extends ya{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=Vy.a,this.vertexShader=jy.a,this.verticalSegments=1}extraAttributes(){return{}}applyOptions(i){const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="l"?1:0}}},Strips:class extends Zi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Xy.a,this.options=[],this.defaultDir="lu",this.optionsMap={[this.defaultDir]:0,ld:1,rd:2,ru:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Gallery:class{constructor(){this.camera=new is,this.duration=1600,this.options=[],this.gap=10,this.group=new bs,this.prevMesh=new Tt,this.nextMesh=new Tt,this.width=100,this.height=100,this.prevMaterial=new hn({vertexShader:tp.a,fragmentShader:ep.a,side:2,uniforms:{galleryTexture:{value:_r},galleryHeight:{value:1}}}),this.nextMaterial=new hn({vertexShader:tp.a,fragmentShader:ep.a,side:2,uniforms:{galleryTexture:{value:_r},galleryHeight:{value:1}}})}get isRight(){const i=this.options.find(t=>t.name==="dir");return!i||i.value==="r"}addObjects(i){this.group.add(this.prevMesh),this.group.add(this.nextMesh),i.add(this.group)}dispose(){this.prevMaterial.dispose(),this.nextMaterial.dispose(),this.prevMesh.geometry.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){this.nextMaterial.uniforms.galleryTexture.value=i,this.nextMesh.material=this.nextMaterial}setPrevTexture(i){this.prevMaterial.uniforms.galleryTexture.value=i,this.prevMesh.material=this.prevMaterial}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.gap=this.width/20,this.prevMaterial.uniforms.galleryHeight.value=t,this.nextMaterial.uniforms.galleryHeight.value=t;const e=new Cr(i,1.2*t+8,1,1);this.prevMesh.geometry=e;const n=new Cr(i,1.2*t+8,1,1);this.nextMesh.geometry=n,this.nextMesh.position.z=this.prevMesh.position.z,this.isRight?this.nextMesh.position.x=i+this.gap:this.nextMesh.position.x=-1*(i+this.gap)}updateAnimation(i){if(i<.3){const t=i/.3;this.isRight?(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*-1*t):(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*t)}else if(i>=.3&&i<.7){const t=(i-.3)/.4;this.isRight?(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=-1*(this.width+this.gap)*t):(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=(this.width+this.gap)*t)}else{const t=(i-.7)/.3;this.isRight?(this.group.position.x=-1*(this.width+this.gap),this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*-1*(1-t)):(this.group.position.x=this.width+this.gap,this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*(1-t))}}},Switch:class{constructor(){this.camera=new is,this.duration=6e3,this.options=[],this.prevMesh=new Tt,this.nextMesh=new Tt,this.width=100,this.height=100,this.depth=1,this.prevDepth=1}addObjects(i){i.add(this.prevMesh),i.add(this.nextMesh)}dispose(){Array.isArray(this.prevMesh.material)?this.prevMesh.material.forEach(i=>i.dispose()):this.prevMesh.material.dispose(),this.prevMesh.geometry.dispose(),Array.isArray(this.nextMesh.material)?this.nextMesh.material.forEach(i=>i.dispose()):this.nextMesh.material.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){const t=new Qi({map:i});this.nextMesh.material=t}setPrevTexture(i){const t=new Qi({map:i});this.prevMesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.depth=t/2;const e=new Cr(i,t,1,1);this.prevMesh.geometry=e;const n=new Cr(i,t,1,1);this.nextMesh.geometry=n,this.prevDepth=this.prevMesh.position.z}updateAnimation(i){const t=this.options.find(e=>e.name==="dir");if(i<.5){const e=i/.5;this.prevMesh.position.x=this.width/2*e,this.prevMesh.rotation.y=-Math.PI/10*e,this.nextMesh.position.x=-this.width/2*e,this.nextMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.z=this.prevDepth-this.depth*(1-e)}else{const e=(i-.5)/.5;this.prevMesh.position.x=this.width/2*(1-e),this.prevMesh.rotation.y=-Math.PI/10*(1-e),this.prevMesh.position.z=this.prevDepth-this.depth*e,this.nextMesh.position.x=-this.width/2*(1-e),this.nextMesh.rotation.y=Math.PI/10*(1-e)}if(t&&t.value==="l")if(i<.5){const e=i/.5;this.prevMesh.position.x=-this.width/2*e,this.prevMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.x=this.width/2*e,this.nextMesh.rotation.y=-Math.PI/10*e}else{const e=(i-.5)/.5;this.prevMesh.position.x=-this.width/2*(1-e),this.prevMesh.rotation.y=Math.PI/10*(1-e),this.nextMesh.position.x=this.width/2*(1-e),this.nextMesh.rotation.y=-Math.PI/10*(1-e)}}},Prism:class{constructor(){this.camera=new is,this.duration=6e3,this.preset=null,this.presetZ=0,this.mesh=new Tt,this.width=100,this.height=100}addObjects(i){this.mesh.geometry=this.box,i.add(this.mesh)}dispose(){Array.isArray(this.mesh.material)?this.mesh.material.forEach(i=>i.dispose()):this.mesh.material.dispose(),this.mesh.geometry.dispose()}setNextTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new Qi({map:i})),t.push(new Qi({map:i})),t.push(new Qi({map:i})),this.mesh.material=t}setPrevTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new Qi({map:i})),t.push(new Qi({map:i})),t.push(new Qi({map:i})),this.mesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.position.z-=i/2,this.width=i,this.height=t,this.box=new ee(i,t,i,1,1,1),this.mesh.geometry=this.box}updateAnimation(i){this.preset===null&&(this.preset=i>0?0:Math.PI/2,this.presetZ=this.mesh.position.z);const t=Math.PI/2*i,e=(Math.sqrt(2)-1)*(this.width/2);this.mesh.rotation.y=this.preset+t,this.mesh.position.z=i<=.5?this.presetZ-i/.5*e:this.presetZ-(1-(i-.5)/.5)*e}},Doors:class{constructor(){this.camera=new is,this.duration=1600,this.options=[],this.width=100,this.preMaterial=new hn({fragmentShader:Qy.a,vertexShader:Zy.a,uniforms:{prevTexture:{value:_r},timePercent:{value:0},offset:{value:0}}}),this.prevGeometry=new Wn,this.prevMesh=new Tt,this.nextMesh=new Tt}addObjects(i){this.prevMesh.material=this.preMaterial,this.prevMesh.geometry=this.prevGeometry,this.prevMesh.material.transparent=!0,i.add(this.prevMesh),i.add(this.nextMesh)}setNextTexture(i){this.nextMesh.material=new Qi({map:i})}setPrevTexture(i){this.preMaterial.uniforms.prevTexture.value=i}setSize(i,t){this.width=i,this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t);const e=i/2,n=t/2;this.preMaterial.uniforms.offset.value=i/2,this.prevGeometry.setIndex([0,1,2,3,4,5,6,7,8,9,10,11]);const r=this.options.find(s=>s.name==="dir"),o=r&&r.value==="vert"?0:1;this.preMaterial.uniforms.option={value:o},o===1?(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,0,0,e,n,0,-e,0,0,e,0,0,e,n,0,-e,0,0,-e,-n,0,e,0,0,-e,-n,0,e,-n,0,e,0,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,.5,1,1,0,.5,1,.5,1,1,0,.5,0,0,1,.5,0,0,1,0,1,.5],2))):(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,-n,0,0,n,0,-e,-n,0,0,-n,0,0,n,0,0,n,0,0,-n,0,e,n,0,0,-n,0,e,-n,0,e,n,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,0,.5,1,0,0,.5,0,.5,1,.5,1,.5,0,1,1,.5,0,1,0,1,1],2))),this.prevGeometry.setAttribute("left",new An([1,1,1,1,1,1,0,0,0,0,0,0],1)),this.nextMesh.geometry=new Cr(i,t,1,1),this.nextMesh.position.z=this.prevMesh.position.z-i/4}updateAnimation(i){this.preMaterial.uniforms.timePercent.value=i,this.nextMesh.position.z=this.prevMesh.position.z-(1-i)*(this.width/4)}dispose(){}}};class tx{constructor(){this.startTime=0,this.lastTime=0,this.lastFPSTime=0,this.renderingDuration=16,this.reverse=!1,this.scene=new Vh,this.delay=0,this.easeFn=Qd.linear,this.preset=null,this.onTransactionEnd=()=>{},this.isTransactionStartApplied=!1,this.prevTexture=null,this.nextTexture=null,this.animationId=null,this.config=null,this.renderer=new ti({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(t=-1)=>{var e,n,r;if(!this.fps(t))return void(this.animationId=window.requestAnimationFrame(this.animate));this.renderer.clear(),t>this.delay&&this.lastTime===0&&(this.lastTime=t,this.startTime=t);let o=0;this.lastTime>0&&o<1&&(o=this.easeFn(t-this.startTime,0,1,(n=(e=this.preset)===null||e===void 0?void 0:e.duration)!==null&&n!==void 0?n:0)),o>1&&(o=1),(r=this.preset)===null||r===void 0||r.updateAnimation(this.reverse?1-o:o),this.rerender(),this.isTransactionStartApplied||(this.isTransactionStartApplied=!0),o<1?this.animationId=window.requestAnimationFrame(this.animate):this.onTransactionEnd()}}initPlayer(t){this.config=t,this.reverse=t.reverse,t.delay&&Number.isInteger(t.delay)&&(this.delay=t.delay),t.easeFn&&(this.easeFn=Qd[t.easeFn]),t.maxFPS&&Number.isInteger(t.maxFPS)&&t.maxFPS>0&&(this.renderingDuration=Math.ceil(1e3/t.maxFPS)),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1,this.renderer.setClearColor(t.clearColor||0),this.isTransactionStartApplied=!1,this.renderer.setSize(t.stageWidth,t.stageHeight),this.preset=new $y[t.presetType],t.options&&(this.preset.options=t.options),t.duration&&Number.isInteger(t.duration)&&(this.preset.duration=t.duration),this.preset.setSize(t.stageWidth,t.stageHeight)}setPrevTexture(t){var e,n,r,o;t.needsUpdate=!0,this.reverse?(this.nextTexture=t,(e=this.preset)===null||e===void 0||e.setNextTexture(t)):(this.prevTexture=t,(n=this.preset)===null||n===void 0||n.setPrevTexture(t)),(r=this.preset)===null||r===void 0||r.addObjects(this.scene),(o=this.preset)===null||o===void 0||o.updateAnimation(this.reverse?1:0),this.rerender()}setNextTexture(t){var e,n;t.needsUpdate=!0,this.reverse?(this.prevTexture=t,(e=this.preset)===null||e===void 0||e.setPrevTexture(t)):(this.nextTexture=t,(n=this.preset)===null||n===void 0||n.setNextTexture(t))}play(){return new Promise(t=>{this.onTransactionEnd=t,this.animate(),this.isPlaying=!0})}rerender(){var t;this.renderer.clear(),!((t=this.preset)===null||t===void 0)&&t.camera.camera&&this.renderer.render(this.scene,this.preset.camera.camera)}fps(t){return t<=0?!0:this.lastFPSTime<0?(this.lastFPSTime=t,!0):t-this.lastFPSTime>=this.renderingDuration&&(this.lastFPSTime=t,!0)}skip(){var t;(t=this.preset)===null||t===void 0||t.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var t,e,n;window.cancelAnimationFrame(this.animationId),this.renderer.clear(),this.isPlaying=!1,(t=this.preset)===null||t===void 0||t.dispose(),(e=this.prevTexture)===null||e===void 0||e.dispose(),(n=this.nextTexture)===null||n===void 0||n.dispose();for(let r=this.scene.children.length-1;r>=0;r--){const o=this.scene.children[r];this.scene.remove(o)}this.scene.background=null}destroy(){this.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose()}}v(139);var xn=v(3),Cn=v(5);Cn.c.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var np=function(){function i(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(xn.isMobile.tablet||xn.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2 .toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(i.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),i.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2 .toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},i.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},i.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)===null||t===void 0||t.appendChild(this.div))},i.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)===null||t===void 0||t.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},i.prototype.update=function(){var t=performance.now();if(!(xn.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,r=e.top,o=e.width,s=e.height,a=this.renderer,l=a.width,h=a.height,u=a.resolution,p=o/l*u,_=s/h*u,x=this.div;x.style.left=n+"px",x.style.top=r+"px",x.style.width=l+"px",x.style.height=h+"px";for(var w=0;w<this.children.length;w++){var M=this.children[w];if(M.renderId!==this.renderId)M._accessibleActive=!1,Object(xn.removeItems)(this.children,w,1),this.div.removeChild(M._accessibleDiv),this.pool.push(M._accessibleDiv),M._accessibleDiv=null,w--;else{x=M._accessibleDiv;var C=M.hitArea,G=M.worldTransform;M.hitArea?(x.style.left=(G.tx+C.x*G.a)*p+"px",x.style.top=(G.ty+C.y*G.d)*_+"px",x.style.width=C.width*G.a*p+"px",x.style.height=C.height*G.d*_+"px"):(C=M.getBounds(),this.capHitArea(C),x.style.left=C.x*p+"px",x.style.top=C.y*_+"px",x.style.width=C.width*p+"px",x.style.height=C.height*_+"px",x.title!==M.accessibleTitle&&M.accessibleTitle!==null&&(x.title=M.accessibleTitle),x.getAttribute("aria-label")!==M.accessibleHint&&M.accessibleHint!==null&&x.setAttribute("aria-label",M.accessibleHint)),M.accessibleTitle===x.title&&M.tabIndex===x.tabIndex||(x.title=M.accessibleTitle,x.tabIndex=M.tabIndex,this.debug&&this.updateDebugHTML(x))}}this.renderId++}},i.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},i.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,r=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>r&&(t.height=r-t.y)},i.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2 .toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:t.accessibleHint&&t.accessibleHint!==null||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},i.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"click",r),e.dispatchEvent(n,"pointertap",r),e.dispatchEvent(n,"tap",r)},i.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseover",r)},i.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseout",r)},i.prototype._onKeyDown=function(t){t.keyCode===9&&this.activate()},i.prototype._onMouseMove=function(t){t.movementX===0&&t.movementY===0||this.deactivate()},i.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i}(),De=v(1),tr=v(7),ip=function(){function i(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new De.g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(i.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),i.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},i.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},i.prototype.reset=function(){this.isPrimary=!1},i}(),rp=function(i,t){return(rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},ex=function(){function i(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return i.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},i.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},i}(),pu=function(){function i(t){this._pointerId=t,this._flags=i.FLAGS.NONE}return i.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(i.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"none",{get:function(){return this._flags===i.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"over",{get:function(){return(this._flags&i.FLAGS.OVER)!=0},set:function(t){this._doSet(i.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rightDown",{get:function(){return(this._flags&i.FLAGS.RIGHT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leftDown",{get:function(){return(this._flags&i.FLAGS.LEFT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),i}(),nx=function(){function i(){this._tempPoint=new De.g}return i.prototype.recursiveFindHit=function(t,e,n,r,o){if(!e||!e.visible)return!1;var s=t.data.global,a=!1,l=o=e.interactive||o,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(r=!1,h=!1)),l=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,p=u.length-1;p>=0;p--){var _=u[p],x=this.recursiveFindHit(t,_,n,r,l);if(x){if(!_.parent)continue;l=!1,x&&(t.target&&(r=!1),a=!0)}}return o&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),n&&n(t,e,!!a))),a},i.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},i}(),ix={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(i){i?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Cn.c.mixin(ix);var Il={target:null,data:{global:null}},op=function(i){function t(e,n){var r=i.call(this)||this;return n=n||{},r.renderer=e,r.autoPreventDefault=n.autoPreventDefault===void 0||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new ip,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new ex,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new nx,r._tempDisplayObject=new Cn.d,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=n.useSystemTicker===void 0||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(e,n){function r(){this.constructor=e}rp(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,n){return Il.target=null,Il.data.global=e,n||(n=this.lastObjectRendered),this.processInteractive(Il,n,null,!0),Il.target},t.prototype.setTargetElement=function(e,n){n===void 0&&(n=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=n,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(tr.a.system.add(this.tickerUpdate,this,tr.c.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(tr.a.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var n=this.activeInteractionData[e];if(n.originalEvent&&n.pointerType!=="touch"){var r=this.configureInteractionEventForDOMEvent(this.eventData,n.originalEvent,n);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var n=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(n=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var r=this.cursorStyles[e];if(r)switch(typeof r){case"string":n&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(e);break;case"object":n&&Object.assign(this.interactionDOMElement.style,r)}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,n,r){r.stopPropagationHint&&e!==r.stopsPropagatingAt||(r.currentTarget=e,r.type=n,e.emit(n,r),e[n]&&e[n](r))},t.prototype.delayDispatchEvent=function(e,n,r){this.delayedEvents.push({displayObject:e,eventString:n,eventData:r})},t.prototype.mapPositionToPoint=function(e,n,r){var o;o=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var s=1/this.resolution;e.x=(n-o.left)*(this.interactionDOMElement.width/o.width)*s,e.y=(r-o.top)*(this.interactionDOMElement.height/o.height)*s},t.prototype.processInteractive=function(e,n,r,o){var s=this.search.findHit(e,n,r,o),a=this.delayedEvents;if(!a.length)return s;e.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var h=0;h<l;h++){var u=a[h],p=u.displayObject,_=u.eventString,x=u.eventData;x.stopsPropagatingAt===p&&(x.stopPropagationHint=!0),this.dispatchEvent(p,_,x)}return s},t.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);if(l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",l),s.pointerType==="touch")this.emit("touchstart",l);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var h=s.button===2;this.emit(h?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,n,r){var o=e.data,s=e.data.identifier;if(r){if(n.trackedPointers[s]||(n.trackedPointers[s]=new pu(s)),this.dispatchEvent(n,"pointerdown",e),o.pointerType==="touch")this.dispatchEvent(n,"touchstart",e);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var a=o.button===2;a?n.trackedPointers[s].rightDown=!0:n.trackedPointers[s].leftDown=!0,this.dispatchEvent(n,a?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,n,r){for(var o=this.normalizeToPointerData(e),s=o.length,a=e.target!==this.interactionDOMElement?"outside":"",l=0;l<s;l++){var h=o[l],u=this.getInteractionDataForPointerId(h),p=this.configureInteractionEventForDOMEvent(this.eventData,h,u);if(p.data.originalEvent=e,this.processInteractive(p,this.lastObjectRendered,r,n||!a),this.emit(n?"pointercancel":"pointerup"+a,p),h.pointerType==="mouse"||h.pointerType==="pen"){var _=h.button===2;this.emit(_?"rightup"+a:"mouseup"+a,p)}else h.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+a,p),this.releaseInteractionDataForPointerId(h.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,n){var r=e.data,o=e.data.identifier;n.trackedPointers[o]!==void 0&&(delete n.trackedPointers[o],this.dispatchEvent(n,"pointercancel",e),r.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,n,r){var o=e.data,s=e.data.identifier,a=n.trackedPointers[s],l=o.pointerType==="touch",h=o.pointerType==="mouse"||o.pointerType==="pen",u=!1;if(h){var p=o.button===2,_=pu.FLAGS,x=p?_.RIGHT_DOWN:_.LEFT_DOWN,w=a!==void 0&&a.flags&x;r?(this.dispatchEvent(n,p?"rightup":"mouseup",e),w&&(this.dispatchEvent(n,p?"rightclick":"click",e),u=!0)):w&&this.dispatchEvent(n,p?"rightupoutside":"mouseupoutside",e),a&&(p?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(n,"pointerup",e),l&&this.dispatchEvent(n,"touchend",e),a&&(h&&!u||this.dispatchEvent(n,"pointertap",e),l&&(this.dispatchEvent(n,"tap",e),a.over=!1))):a&&(this.dispatchEvent(n,"pointerupoutside",e),l&&this.dispatchEvent(n,"touchendoutside",e)),a&&a.none&&delete n.trackedPointers[s]},t.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);n[0].pointerType!=="mouse"&&n[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),s.pointerType==="touch"&&this.emit("touchmove",l),s.pointerType!=="mouse"&&s.pointerType!=="pen"||this.emit("mousemove",l)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,n,r){var o=e.data,s=o.pointerType==="touch",a=o.pointerType==="mouse"||o.pointerType==="pen";a&&this.processPointerOverOut(e,n,r),this.moveWhenInside&&!r||(this.dispatchEvent(n,"pointermove",e),s&&this.dispatchEvent(n,"touchmove",e),a&&this.dispatchEvent(n,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e)[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(r.identifier)}},t.prototype.processPointerOverOut=function(e,n,r){var o=e.data,s=e.data.identifier,a=o.pointerType==="mouse"||o.pointerType==="pen",l=n.trackedPointers[s];r&&!l&&(l=n.trackedPointers[s]=new pu(s)),l!==void 0&&(r&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(n,"pointerover",e),a&&this.delayDispatchEvent(n,"mouseover",e)),a&&this.cursor===null&&(this.cursor=n.cursor)):l.over&&(l.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),a&&this.dispatchEvent(n,"mouseout",e),l.none&&delete n.trackedPointers[s]))},t.prototype.onPointerOver=function(e){var n=this.normalizeToPointerData(e)[0],r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),n.pointerType!=="mouse"&&n.pointerType!=="pen"||this.emit("mouseover",o)},t.prototype.getInteractionDataForPointerId=function(e){var n,r=e.pointerId;return r===1||e.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[r]?n=this.activeInteractionData[r]:((n=this.interactionDataPool.pop()||new ip).identifier=r,this.activeInteractionData[r]=n),n.copyEvent(e),n},t.prototype.releaseInteractionDataForPointerId=function(e){var n=this.activeInteractionData[e];n&&(delete this.activeInteractionData[e],n.reset(),this.interactionDataPool.push(n))},t.prototype.configureInteractionEventForDOMEvent=function(e,n,r){return e.data=r,this.mapPositionToPoint(r.global,n.clientX,n.clientY),n.pointerType==="touch"&&(n.globalX=r.global.x,n.globalY=r.global.y),r.originalEvent=n,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,o=e.changedTouches.length;r<o;r++){var s=e.changedTouches[r];s.button===void 0&&(s.button=e.touches.length?1:0),s.buttons===void 0&&(s.buttons=e.touches.length?1:0),s.isPrimary===void 0&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),s.width===void 0&&(s.width=s.radiusX||1),s.height===void 0&&(s.height=s.radiusY||1),s.tiltX===void 0&&(s.tiltX=0),s.tiltY===void 0&&(s.tiltY=0),s.pointerType===void 0&&(s.pointerType="touch"),s.pointerId===void 0&&(s.pointerId=s.identifier||0),s.pressure===void 0&&(s.pressure=s.force||.5),s.twist===void 0&&(s.twist=0),s.tangentialPressure===void 0&&(s.tangentialPressure=0),s.layerX===void 0&&(s.layerX=s.offsetX=s.clientX),s.layerY===void 0&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,n.push(s)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))n.push(e);else{var a=e;a.isPrimary===void 0&&(a.isPrimary=!0),a.width===void 0&&(a.width=1),a.height===void 0&&(a.height=1),a.tiltX===void 0&&(a.tiltX=0),a.tiltY===void 0&&(a.tiltY=0),a.pointerType===void 0&&(a.pointerType="mouse"),a.pointerId===void 0&&(a.pointerId=1),a.pressure===void 0&&(a.pressure=.5),a.twist===void 0&&(a.twist=0),a.tangentialPressure===void 0&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}return n},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(xn.EventEmitter),ce=v(2),Pl=function(){function i(t){var e=this;this.stage=new Cn.b,t=Object.assign({forceCanvas:!1},t),this.renderer=Object(ce.y)(t),i._plugins.forEach(function(n){n.init.call(e,t)})}return i.registerPlugin=function(t){i._plugins.push(t)},i.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(i.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),i.prototype.destroy=function(t,e){var n=this,r=i._plugins.slice(0);r.reverse(),r.forEach(function(o){o.destroy.call(n)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},i._plugins=[],i}(),rx=function(){function i(){}return i.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var n,r;if(e.cancelResize(),e._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{var o=e._resizeTo;n=o.clientWidth,r=o.clientHeight}e.renderer.resize(n,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},i.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},i}();Pl.registerPlugin(rx);/*!
 * @pixi/extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var fu=/iPhone/i,sp=/iPod/i,ap=/iPad/i,lp=/\biOS-universal(?:.+)Mac\b/i,mu=/\bAndroid(?:.+)Mobile\b/i,hp=/Android/i,Os=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ol=/Silk/i,lo=/Windows Phone/i,up=/\bWindows(?:.+)ARM\b/i,cp=/BlackBerry/i,dp=/BB10/i,pp=/Opera Mini/i,fp=/\b(CriOS|Chrome)(?:.+)Mobile/i,mp=/Mobile(?:.+)Firefox\b/i,gp=function(i){return i!==void 0&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var vp,_p,yp,xp,bp,Tp,wp,Ep,Sp,gu,vu,_u,Ap,Mp,yu,xa,Cp,xu,Rp,Ns=function(i){var t={userAgent:"",platform:"",maxTouchPoints:0};i||typeof navigator=="undefined"?typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=t.userAgent,n=e.split("[FBAN");n[1]!==void 0&&(e=n[0]),(n=e.split("Twitter"))[1]!==void 0&&(e=n[0]);var r=function(s){return function(a){return a.test(s)}}(e),o={apple:{phone:r(fu)&&!r(lo),ipod:r(sp),tablet:!r(fu)&&(r(ap)||gp(t))&&!r(lo),universal:r(lp),device:(r(fu)||r(sp)||r(ap)||r(lp)||gp(t))&&!r(lo)},amazon:{phone:r(Os),tablet:!r(Os)&&r(Ol),device:r(Os)||r(Ol)},android:{phone:!r(lo)&&r(Os)||!r(lo)&&r(mu),tablet:!r(lo)&&!r(Os)&&!r(mu)&&(r(Ol)||r(hp)),device:!r(lo)&&(r(Os)||r(Ol)||r(mu)||r(hp))||r(/\bokhttp\b/i)},windows:{phone:r(lo),tablet:r(up),device:r(lo)||r(up)},other:{blackberry:r(cp),blackberry10:r(dp),opera:r(pp),firefox:r(mp),chrome:r(fp),device:r(cp)||r(dp)||r(pp)||r(mp)||r(fp)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(globalThis.navigator);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(vp||(vp={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(_p||(_p={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(yp||(yp={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(xp||(xp={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(bp||(bp={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Tp||(Tp={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(wp||(wp={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(Ep||(Ep={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Sp||(Sp={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(gu||(gu={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(vu||(vu={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(_u||(_u={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Ap||(Ap={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Mp||(Mp={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(yu||(yu={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(xa||(xa={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Cp||(Cp={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(xu||(xu={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Rp||(Rp={}));var ox={MIPMAP_TEXTURES:_u.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:xu.NONE,SPRITE_MAX_TEXTURES:function(i){var t=!0;if(Ns.tablet||Ns.phone){var e;Ns.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(t=!1),Ns.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(t=!1)}return t?i:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:yu.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:vu.CLAMP,SCALE_MODE:gu.LINEAR,PRECISION_VERTEX:xa.HIGH,PRECISION_FRAGMENT:Ns.apple.device?xa.HIGH:xa.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Ns.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,SORTABLE_CHILDREN:!1},Ip=function(){function i(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return i.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},i.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},i.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?De.j.EMPTY:((t=t||new De.j(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},i.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},i.prototype.addPointMatrix=function(t,e){var n=t.a,r=t.b,o=t.c,s=t.d,a=t.tx,l=t.ty,h=n*e.x+o*e.y+a,u=r*e.x+s*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},i.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY,s=t[0],a=t[1];e=s<e?s:e,n=a<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[2])<e?s:e,n=(a=t[3])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[4])<e?s:e,n=(a=t[5])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[6])<e?s:e,n=(a=t[7])<n?a:n,r=s>r?s:r,o=a>o?a:o,this.minX=e,this.minY=n,this.maxX=r,this.maxY=o},i.prototype.addFrame=function(t,e,n,r,o){this.addFrameMatrix(t.worldTransform,e,n,r,o)},i.prototype.addFrameMatrix=function(t,e,n,r,o){var s=t.a,a=t.b,l=t.c,h=t.d,u=t.tx,p=t.ty,_=this.minX,x=this.minY,w=this.maxX,M=this.maxY,C=s*e+l*n+u,G=a*e+h*n+p;_=C<_?C:_,x=G<x?G:x,w=C>w?C:w,M=G>M?G:M,_=(C=s*r+l*n+u)<_?C:_,x=(G=a*r+h*n+p)<x?G:x,w=C>w?C:w,M=G>M?G:M,_=(C=s*e+l*o+u)<_?C:_,x=(G=a*e+h*o+p)<x?G:x,w=C>w?C:w,M=G>M?G:M,_=(C=s*r+l*o+u)<_?C:_,x=(G=a*r+h*o+p)<x?G:x,w=C>w?C:w,M=G>M?G:M,this.minX=_,this.minY=x,this.maxX=w,this.maxY=M},i.prototype.addVertexData=function(t,e,n){for(var r=this.minX,o=this.minY,s=this.maxX,a=this.maxY,l=e;l<n;l+=2){var h=t[l],u=t[l+1];r=h<r?h:r,o=u<o?u:o,s=h>s?h:s,a=u>a?u:a}this.minX=r,this.minY=o,this.maxX=s,this.maxY=a},i.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},i.prototype.addVerticesMatrix=function(t,e,n,r,o,s){o===void 0&&(o=0),s===void 0&&(s=o);for(var a=t.a,l=t.b,h=t.c,u=t.d,p=t.tx,_=t.ty,x=this.minX,w=this.minY,M=this.maxX,C=this.maxY,G=n;G<r;G+=2){var Q=e[G],nt=e[G+1],ct=a*Q+h*nt+p,it=u*nt+l*Q+_;x=Math.min(x,ct-o),M=Math.max(M,ct+o),w=Math.min(w,it-s),C=Math.max(C,it+s)}this.minX=x,this.minY=w,this.maxX=M,this.maxY=C},i.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>o?t.maxY:o},i.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},i.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},i.prototype.addFramePad=function(t,e,n,r,o,s){t-=o,e-=s,n+=o,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},i}(),Pp=function(i,t){return(Pp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function bu(i,t){function e(){this.constructor=i}Pp(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Op,Np,Lp,Dp,Fp,Bp,kp,Up,Gp,Hp,jp,zp,Vp,Wp,Xp,Yp,Tu,qp,Jp,ba=function(i){function t(){var e=i.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new De.m,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Ip,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return bu(t,i),t.mixin=function(e){for(var n=Object.keys(e),r=0;r<n.length;++r){var o=n[r];Object.defineProperty(t.prototype,o,Object.getOwnPropertyDescriptor(e,o))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new De.j),n=this._boundsRect),this._bounds.getRectangle(n)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Ip);var n=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var o=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=o,this._bounds.updateID+=this._boundsID-s,a},t.prototype.toGlobal=function(e,n,r){return r===void 0&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)},t.prototype.toLocal=function(e,n,r,o){return n&&(e=n.toGlobal(e,r,o)),o||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,n,r,o,s,a,l,h,u){return e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=1),s===void 0&&(s=0),a===void 0&&(a=0),l===void 0&&(l=0),h===void 0&&(h=0),u===void 0&&(u=0),this.position.x=e,this.position.y=n,this.scale.x=r||1,this.scale.y=o||1,this.rotation=s,this.skew.x=a,this.skew.y=l,this.pivot.x=h,this.pivot.y=u,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new sx),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*De.i},set:function(e){this.transform.rotation=e*De.b},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){var n;this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount--,n._maskRefCount===0&&(n.renderable=!0,n.isMask=!1)),this._mask=e,this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount===0&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}},enumerable:!1,configurable:!0}),t}(xn.EventEmitter),sx=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.sortDirty=null,e}return bu(t,i),t}(ba);function ax(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}ba.prototype.displayObjectUpdateTransform=ba.prototype.updateTransform,function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"}(Op||(Op={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(Np||(Np={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(Lp||(Lp={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Dp||(Dp={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Fp||(Fp={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Bp||(Bp={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(kp||(kp={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(Up||(Up={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Gp||(Gp={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Hp||(Hp={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(jp||(jp={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(zp||(zp={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Vp||(Vp={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Wp||(Wp={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Xp||(Xp={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Yp||(Yp={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Tu||(Tu={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(qp||(qp={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Jp||(Jp={}));var Zp=function(i){function t(){var e=i.call(this)||this;return e.children=[],e.sortableChildren=ox.SORTABLE_CHILDREN,e.sortDirty=!1,e}return bu(t,i),t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.addChild(n[o]);else{var s=n[0];s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.push(s),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this)}return n[0]},t.prototype.addChildAt=function(e,n){if(n<0||n>this.children.length)throw new Error(e+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),this.emit("childAdded",e,this,n),e},t.prototype.swapChildren=function(e,n){if(e!==n){var r=this.getChildIndex(e),o=this.getChildIndex(n);this.children[r]=n,this.children[o]=e,this.onChildrenChange(r<o?r:o)}},t.prototype.getChildIndex=function(e){var n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},t.prototype.setChildIndex=function(e,n){if(n<0||n>=this.children.length)throw new Error("The index "+n+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(e);Object(xn.removeItems)(this.children,r,1),this.children.splice(n,0,e),this.onChildrenChange(n)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.removeChild(n[o]);else{var s=n[0],a=this.children.indexOf(s);if(a===-1)return null;s.parent=null,s.transform._parentID=-1,Object(xn.removeItems)(this.children,a,1),this._boundsID++,this.onChildrenChange(a),s.emit("removed",this),this.emit("childRemoved",s,this,a)}return n[0]},t.prototype.removeChildAt=function(e){var n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,Object(xn.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),this.emit("childRemoved",n,this,e),n},t.prototype.removeChildren=function(e,n){e===void 0&&(e=0),n===void 0&&(n=this.children.length);var r,o=e,s=n-o;if(s>0&&s<=n){r=this.children.splice(o,s);for(var a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,n=0,r=this.children.length;n<r;++n){var o=this.children[n];o._lastSortedIndex=n,e||o.zIndex===0||(e=!0)}e&&this.children.length>1&&this.children.sort(ax),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,n=this.children.length;e<n;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.visible&&n.renderable)if(n.calculateBounds(),n._mask){var r=n._mask.maskObject||n._mask;r.calculateBounds(),this._bounds.addBoundsMask(n._bounds,r._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,n){n===void 0&&(n=!1);var r=i.prototype.getLocalBounds.call(this,e);if(!n)for(var o=0,s=this.children.length;o<s;++o){var a=this.children[o];a.visible&&a.updateTransform()}return r},t.prototype._calculateBounds=function(){},t.prototype._renderWithCulling=function(e){var n=e.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var r,o;if(this.cullArea?(r=this.cullArea,o=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0)),r&&n.intersects(r,o))this._render(e);else if(this.cullArea)return;for(var s=0,a=this.children.length;s<a;++s){var l=this.children[s],h=l.cullable;l.cullable=h||!this.cullArea,l.render(e),l.cullable=h}}},t.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var n=0,r=this.children.length;n<r;++n)this.children[n].render(e)}},t.prototype.renderAdvanced=function(e){var n=this.filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var o=0;o<n.length;o++)n[o].enabled&&this._enabledFilters.push(n[o])}var s=n&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Tu.NONE));if(s&&e.batch.flush(),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e),o=0;for(var a=this.children.length;o<a;++o)this.children[o].render(e)}s&&e.batch.flush(),r&&e.mask.pop(this),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){i.prototype.destroy.call(this),this.sortDirty=!1;var n=typeof e=="boolean"?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(n)for(var o=0;o<r.length;++o)r[o].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var n=this.getLocalBounds().width;this.scale.x=n!==0?e/n:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var n=this.getLocalBounds().height;this.scale.y=n!==0?e/n:1,this._height=e},enumerable:!1,configurable:!0}),t}(ba);Zp.prototype.containerUpdateTransform=Zp.prototype.updateTransform;var wu=new De.j,lx=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o=this.renderer,s=!1,a=!1;t&&(t instanceof ce.p?r=t:(r=this.renderer.generateTexture(t),a=!0)),r?(e=r.baseTexture.resolution,n=r.frame,s=!1,o.renderTexture.bind(r)):(e=this.renderer.resolution,s=!0,(n=wu).width=this.renderer.width,n.height=this.renderer.height,o.renderTexture.bind(null));var l=Math.floor(n.width*e+1e-4),h=Math.floor(n.height*e+1e-4),u=new xn.CanvasRenderTarget(l,h,1),p=new Uint8Array(4*l*h),_=o.gl;_.readPixels(n.x*e,n.y*e,l,h,_.RGBA,_.UNSIGNED_BYTE,p);var x=u.context.getImageData(0,0,l,h);if(i.arrayPostDivide(p,x.data),u.context.putImageData(x,0,0),s){var w=new xn.CanvasRenderTarget(u.width,u.height,1);w.context.scale(1,-1),w.context.drawImage(u.canvas,0,-h),u.destroy(),u=w}return a&&r.destroy(!0),u.canvas},i.prototype.pixels=function(t,e){var n,r,o,s=this.renderer,a=!1;t&&(t instanceof ce.p?o=t:t instanceof ba&&(o=this.renderer.generateTexture(t),a=!0)),o?e?(n=e.resolution,r=o.frame,s.renderTexture.bind(o)):(n=o.baseTexture.resolution,r=o.frame,s.renderTexture.bind(o)):e?(n=e.resolution,(r=wu).width=e.width,r.height=e.height,s.renderTexture.bind(null)):(n=s.resolution,(r=wu).width=s.width,r.height=s.height,s.renderTexture.bind(null));var l=r.width*n,h=r.height*n,u=new Uint8Array(4*l*h),p=s.gl;return p.readPixels(r.x*n,r.y*n,l,h,p.RGBA,p.UNSIGNED_BYTE,u),a&&o.destroy(!0),i.arrayPostDivide(u,u),u},i.prototype.destroy=function(){this.renderer=null},i.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},i}(),Nl=function(){function i(t,e,n){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return i.prototype.detach=function(){return this._owner!==null&&(this._owner.detach(this),!0)},i}();function Kp(i,t){return i._head?(i._tail._next=t,t._prev=i._tail,i._tail=t):(i._head=t,i._tail=t),t._owner=i,t}var Eu,ho=function(){function i(){this._head=this._tail=void 0}return i.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},i.prototype.has=function(t){if(!(t instanceof Nl))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},i.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},i.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return Kp(this,new Nl(t,!1,e))},i.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return Kp(this,new Nl(t,!0,e))},i.prototype.detach=function(t){if(!(t instanceof Nl))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},i.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},i}();function Qp(i,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=e.parser[t.strictMode?"strict":"loose"].exec(i),r={},o=14;o--;)r[e.key[o]]=n[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(s,a,l){a&&(r[e.q.name][a]=l)}),r}var Ll=null;function $p(){}function tf(i,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(i[t]=e)}function Su(i){return i.toString().replace("object ","")}var Si=function(){function i(t,e,n){if(this._dequeue=$p,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(i.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=i.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=$p,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new ho,this.onProgress=new ho,this.onComplete=new ho,this.onAfterMiddleware=new ho}return i.setExtensionLoadType=function(t,e){tf(i._loadTypeMap,t,e)},i.setExtensionXhrType=function(t,e){tf(i._xhrTypeMap,t,e)},Object.defineProperty(i.prototype,"isDataUrl",{get:function(){return this._hasFlag(i.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this._hasFlag(i.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isLoading",{get:function(){return this._hasFlag(i.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),i.prototype.complete=function(){this._clearEvents(),this._finish()},i.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=i.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},i.prototype.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(i.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case i.LOAD_TYPE.IMAGE:this.type=i.TYPE.IMAGE,this._loadElement("image");break;case i.LOAD_TYPE.AUDIO:this.type=i.TYPE.AUDIO,this._loadSourceElement("audio");break;case i.LOAD_TYPE.VIDEO:this.type=i.TYPE.VIDEO,this._loadSourceElement("video");break;case i.LOAD_TYPE.XHR:default:Eu===void 0&&(Eu=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),Eu&&this.crossOrigin?this._loadXdr():this._loadXhr()}},i.prototype._hasFlag=function(t){return(this._flags&t)!=0},i.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},i.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},i.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(i.STATUS_FLAGS.COMPLETE,!0),this._setFlag(i.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},i.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&globalThis.Image!==void 0?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},i.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&globalThis.Audio!==void 0?this.data=new Audio:this.data=document.createElement(t),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else e=this.metadata.mimeType,this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},i.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(t.withCredentials=!0),t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===i.XHR_RESPONSE_TYPE.JSON||this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=i.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},i.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},i.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},i.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},i.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},i.prototype._onTimeout=function(){this.abort("Load timed out.")},i.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Su(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},i.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Su(t)+" Request timed out.")},i.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Su(t)+" Request was aborted by the user.")},i.prototype._xhrOnLoad=function(){var t=this.xhr,e="",n=t.status===void 0?200:t.status;if(t.responseType!==""&&t.responseType!=="text"&&t.responseType!==void 0||(e=t.responseText),n===0&&(e.length>0||t.responseType===i.XHR_RESPONSE_TYPE.BUFFER)?n=200:n===1223&&(n=204),(n/100|0)===2){if(this.xhrType===i.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=i.TYPE.TEXT;else if(this.xhrType===i.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=i.TYPE.JSON}catch(s){return void this.abort("Error trying to parse loaded json: "+s)}else if(this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e,this.data=o}this.type=i.TYPE.XML}catch(s){return void this.abort("Error trying to parse loaded xml: "+s)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},i.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Ll||(Ll=document.createElement("a")),Ll.href=t;var n=Qp(Ll.href,{strictMode:!0}),r=!n.port&&e.port===""||n.port===e.port,o=n.protocol?n.protocol+":":"";return n.host===e.hostname&&r&&o===e.protocol?"":"anonymous"},i.prototype._determineXhrType=function(){return i._xhrTypeMap[this.extension]||i.XHR_RESPONSE_TYPE.TEXT},i.prototype._determineLoadType=function(){return i._loadTypeMap[this.extension]||i.LOAD_TYPE.XHR},i.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),o=t.indexOf("#"),s=Math.min(r>-1?r:t.length,o>-1?o:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},i.prototype._getMimeFromXhrType=function(t){switch(t){case i.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case i.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case i.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case i.XHR_RESPONSE_TYPE.JSON:return"application/json";case i.XHR_RESPONSE_TYPE.DEFAULT:case i.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i}();function rs(){}function hx(i){return function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(i===null)throw new Error("Callback was already called.");var r=i;i=null,r.apply(this,e)}}(function(i){var t,e,n,r;(t=i.STATUS_FLAGS||(i.STATUS_FLAGS={}))[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING",(e=i.TYPE||(i.TYPE={}))[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT",(n=i.LOAD_TYPE||(i.LOAD_TYPE={}))[n.XHR=1]="XHR",n[n.IMAGE=2]="IMAGE",n[n.AUDIO=3]="AUDIO",n[n.VIDEO=4]="VIDEO",(r=i.XHR_RESPONSE_TYPE||(i.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",i._loadTypeMap={gif:i.LOAD_TYPE.IMAGE,png:i.LOAD_TYPE.IMAGE,bmp:i.LOAD_TYPE.IMAGE,jpg:i.LOAD_TYPE.IMAGE,jpeg:i.LOAD_TYPE.IMAGE,tif:i.LOAD_TYPE.IMAGE,tiff:i.LOAD_TYPE.IMAGE,webp:i.LOAD_TYPE.IMAGE,tga:i.LOAD_TYPE.IMAGE,svg:i.LOAD_TYPE.IMAGE,"svg+xml":i.LOAD_TYPE.IMAGE,mp3:i.LOAD_TYPE.AUDIO,ogg:i.LOAD_TYPE.AUDIO,wav:i.LOAD_TYPE.AUDIO,mp4:i.LOAD_TYPE.VIDEO,webm:i.LOAD_TYPE.VIDEO},i._xhrTypeMap={xhtml:i.XHR_RESPONSE_TYPE.DOCUMENT,html:i.XHR_RESPONSE_TYPE.DOCUMENT,htm:i.XHR_RESPONSE_TYPE.DOCUMENT,xml:i.XHR_RESPONSE_TYPE.DOCUMENT,tmx:i.XHR_RESPONSE_TYPE.DOCUMENT,svg:i.XHR_RESPONSE_TYPE.DOCUMENT,tsx:i.XHR_RESPONSE_TYPE.DOCUMENT,gif:i.XHR_RESPONSE_TYPE.BLOB,png:i.XHR_RESPONSE_TYPE.BLOB,bmp:i.XHR_RESPONSE_TYPE.BLOB,jpg:i.XHR_RESPONSE_TYPE.BLOB,jpeg:i.XHR_RESPONSE_TYPE.BLOB,tif:i.XHR_RESPONSE_TYPE.BLOB,tiff:i.XHR_RESPONSE_TYPE.BLOB,webp:i.XHR_RESPONSE_TYPE.BLOB,tga:i.XHR_RESPONSE_TYPE.BLOB,json:i.XHR_RESPONSE_TYPE.JSON,text:i.XHR_RESPONSE_TYPE.TEXT,txt:i.XHR_RESPONSE_TYPE.TEXT,ttf:i.XHR_RESPONSE_TYPE.BUFFER,otf:i.XHR_RESPONSE_TYPE.BUFFER},i.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(Si||(Si={}));var ux=function(i,t){this.data=i,this.callback=t},Au=function(){function i(t,e){var n=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=rs,this.unsaturated=rs,this.empty=rs,this.drain=rs,this.error=rs,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(r,o,s){if(s&&typeof s!="function")throw new Error("task callback must be a function");if(n.started=!0,r==null&&n.idle())setTimeout(function(){return n.drain()},1);else{var a=new ux(r,typeof s=="function"?s:rs);o?n._tasks.unshift(a):n._tasks.push(a),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var r=n._tasks.shift();n._tasks.length===0&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(r.data,hx(n._next(r)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return i.prototype._next=function(t){var e=this;return function(){for(var n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];e.workers-=1,t.callback.apply(t,r),r[0]!=null&&e.error(r[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},i.prototype.push=function(t,e){this._insert(t,!1,e)},i.prototype.kill=function(){this.workers=0,this.drain=rs,this.started=!1,this._tasks=[]},i.prototype.unshift=function(t,e){this._insert(t,!0,e)},i.prototype.length=function(){return this._tasks.length},i.prototype.running=function(){return this.workers},i.prototype.idle=function(){return this._tasks.length+this.workers===0},i.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},i.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},i.eachSeries=function(t,e,n,r){var o=0,s=t.length;(function a(l){l||o===s?n&&n(l):r?setTimeout(function(){e(t[o++],a)},1):e(t[o++],a)})()},i.queue=function(t,e){return new i(t,e)},i}(),cx=/(#[\w-]+)?$/,qr=function(){function i(t,e){var n=this;t===void 0&&(t=""),e===void 0&&(e=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this._queue=Au.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new ho,this.onError=new ho,this.onLoad=new ho,this.onStart=new ho,this.onComplete=new ho;for(var r=0;r<i._plugins.length;++r){var o=i._plugins[r],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this._protected=!1}return i.prototype._add=function(t,e,n,r){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Si(t,e,n),typeof r=="function"&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var l=o.progressChunk*(s.length+1)/(s.length+2);for(o.children.push(this.resources[t]),o.progressChunk=l,a=0;a<s.length;++a)s[a].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},i.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},i.prototype.use=function(t){return this._afterMiddleware.push(t),this},i.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},i.prototype.load=function(t){if(typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(i.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),i.prototype._prepareUrl=function(t){var e,n=Qp(t,{strictMode:!0});if(e=n.protocol||!n.path||t.indexOf("//")===0?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=cx.exec(e)[0];(e=e.slice(0,e.length-r.length)).indexOf("?")!==-1?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},i.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,Au.eachSeries(this._beforeMiddleware,function(r,o){r.call(n,t,function(){o(t.isComplete?{}:null)})},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())},!0)},i.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},i.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},i.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Au.eachSeries(this._afterMiddleware,function(n,r){n.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},i.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(i,"shared",{get:function(){var t=i._shared;return t||((t=new i)._protected=!0,i._shared=t),t},enumerable:!1,configurable:!0}),i.registerPlugin=function(t){return i._plugins.push(t),t.add&&t.add(),i},i._plugins=[],i}();qr.prototype.add=function(i,t,e,n){if(Array.isArray(i)){for(var r=0;r<i.length;++r)this.add(i[r]);return this}if(typeof i=="object"&&(e=i,n=t||e.callback||e.onComplete,t=e.url,i=e.name||e.key||e.url),typeof t!="string"&&(n=e,e=t,t=i),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof e=="function"&&(n=e,e=null),this._add(i,t,e,n)};var dx=function(){function i(){}return i.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?qr.shared:new qr},i.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},i}(),px=function(){function i(){}return i.add=function(){Si.setExtensionLoadType("svg",Si.LOAD_TYPE.XHR),Si.setExtensionXhrType("svg",Si.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){if(!t.data||t.type!==Si.TYPE.IMAGE&&t.extension!=="svg")e();else{var n=t.data,r=t.url,o=t.name,s=t.metadata;ce.t.fromLoader(n,r,o,s).then(function(a){t.texture=a,e()}).catch(e)}},i}();qr.registerPlugin({use:function(i,t){if(i.data){if(i.xhr&&i.xhrType===Si.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&typeof i.data!="string"){if(i.data.type.indexOf("image")===0){var e=globalThis.URL||globalThis.webkitURL,n=e.createObjectURL(i.data);return i.blob=i.data,i.data=new Image,i.data.src=n,i.type=Si.TYPE.IMAGE,void(i.data.onload=function(){e.revokeObjectURL(n),i.data.onload=null,t()})}}else{var r=i.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0)return i.data=new Image,i.data.src="data:"+r+";base64,"+function(o){for(var s="",a=0;a<o.length;){for(var l=[0,0,0],h=[0,0,0,0],u=0;u<l.length;++u)a<o.length?l[u]=255&o.charCodeAt(a++):l[u]=0;switch(h[0]=l[0]>>2,h[1]=(3&l[0])<<4|l[1]>>4,h[2]=(15&l[1])<<2|l[2]>>6,h[3]=63&l[2],a-(o.length-1)){case 2:h[3]=64,h[2]=64;break;case 1:h[3]=64}for(u=0;u<h.length;++u)s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h[u])}return s}(i.xhr.responseText),i.type=Si.TYPE.IMAGE,void(i.data.onload=function(){i.data.onload=null,t()})}t()}else t()}}),qr.registerPlugin(px);var ri,Nn,gn=v(0);/*!
 * @pixi/compressed-textures - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(i){i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(Nn||(Nn={}));var Dl=((ri={})[Nn.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,ri[Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,ri[Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,ri[Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,ri[Nn.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,ri[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,ri[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,ri[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,ri[Nn.COMPRESSED_R11_EAC]=.5,ri[Nn.COMPRESSED_SIGNED_R11_EAC]=.5,ri[Nn.COMPRESSED_RG11_EAC]=1,ri[Nn.COMPRESSED_SIGNED_RG11_EAC]=1,ri[Nn.COMPRESSED_RGB8_ETC2]=.5,ri[Nn.COMPRESSED_RGBA8_ETC2_EAC]=1,ri[Nn.COMPRESSED_SRGB8_ETC2]=.5,ri[Nn.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,ri[Nn.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,ri[Nn.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,ri[Nn.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,ri[Nn.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,ri[Nn.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,ri[Nn.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,ri[Nn.COMPRESSED_RGB_ETC1_WEBGL]=.5,ri[Nn.COMPRESSED_RGB_ATC_WEBGL]=.5,ri[Nn.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,ri[Nn.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,ri),ef=function(i,t){return(ef=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function nf(i,t){function e(){this.constructor=i}ef(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function fx(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}}var Fl,Jr,Mu=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.format=n.format,r.levels=n.levels||1,r._width=n.width,r._height=n.height,r._extension=t._formatToExtension(r.format),(n.levelBuffers||r.buffer)&&(r._levelBuffers=n.levelBuffers||t._createLevelBuffers(e instanceof Uint8Array?e:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return nf(t,i),t.prototype.upload=function(e,n,r){var o=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var s=0,a=this.levels;s<a;s++){var l=this._levelBuffers[s],h=l.levelID,u=l.levelWidth,p=l.levelHeight,_=l.levelBuffer;o.compressedTexImage2D(o.TEXTURE_2D,h,this.format,u,p,0,_)}return!0},t.prototype.onBlobLoaded=function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},t._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},t._createLevelBuffers=function(e,n,r,o,s,a,l){for(var h=new Array(r),u=e.byteOffset,p=a,_=l,x=p+o-1&~(o-1),w=_+s-1&~(s-1),M=x*w*Dl[n],C=0;C<r;C++)h[C]={levelID:C,levelWidth:r>1?p:x,levelHeight:r>1?_:w,levelBuffer:new Uint8Array(e.buffer,u,M)},u+=M,M=(x=(p=p>>1||1)+o-1&~(o-1))*(w=(_=_>>1||1)+s-1&~(s-1))*Dl[n];return h},t}(function(i){function t(e,n){n===void 0&&(n={width:1,height:1,autoLoad:!0});var r,o,s=this;return typeof e=="string"?(r=e,o=new Uint8Array):(r=null,o=e),(s=i.call(this,o,n)||this).origin=r,s.buffer=o?new ce.x(o):null,s.origin&&n.autoLoad!==!1&&s.load(),o&&o.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return nf(t,i),t.prototype.onBlobLoaded=function(e){},t.prototype.load=function(){return e=this,n=void 0,o=function(){var s;return fx(this,function(a){switch(a.label){case 0:return[4,fetch(this.origin)];case 1:return[4,a.sent().blob()];case 2:return[4,a.sent().arrayBuffer()];case 3:return s=a.sent(),this.data=new Uint32Array(s),this.buffer=new ce.x(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),[2,this]}})},new((r=Promise)||(r=Promise))(function(s,a){function l(p){try{u(o.next(p))}catch(_){a(_)}}function h(p){try{u(o.throw(p))}catch(_){a(_)}}function u(p){p.done?s(p.value):new r(function(_){_(p.value)}).then(l,h)}u((o=o.apply(e,n||[])).next())});var e,n,r,o},t}(ce.i)),mx=function(){function i(){}return i.use=function(t,e){var n=t.data;if(t.type===Si.TYPE.JSON&&n&&n.cacheID&&n.textures){for(var r=n.textures,o=void 0,s=void 0,a=0,l=r.length;a<l;a++){var h=r[a],u=h.src,p=h.format;if(p||(s=u),i.textureFormats[p]){o=u;break}}if(!(o=o||s))return void e(new Error("Cannot load compressed-textures in "+t.url+", make sure you provide a fallback"));if(o===t.url)return void e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var _={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},x=xn.url.resolve(t.url.replace(this.baseUrl,""),o),w=n.cacheID;this.add(w,x,_,function(M){if(M.error)e(M.error);else{var C=M.texture,G=C===void 0?null:C,Q=M.textures,nt=Q===void 0?{}:Q;Object.assign(t,{texture:G,textures:nt}),e()}})}else e()},Object.defineProperty(i,"textureExtensions",{get:function(){if(!i._textureExtensions){var t=document.createElement("canvas").getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var e={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};i._textureExtensions=e}return i._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(i,"textureFormats",{get:function(){if(!i._textureFormats){var t=i.textureExtensions;for(var e in i._textureFormats={},t){var n=t[e];n&&Object.assign(i._textureFormats,Object.getPrototypeOf(n))}}return i._textureFormats},enumerable:!1,configurable:!0}),i}();function rf(i,t,e){var n={textures:{},texture:null};return t&&t.map(function(r){return new ce.t(new ce.c(r,Object.assign({mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(r,o){var s=r.baseTexture,a=i+"-"+(o+1);ce.c.addToCache(s,a),ce.t.addToCache(r,a),o===0&&(ce.c.addToCache(s,i),ce.t.addToCache(r,i),n.texture=r),n.textures[a]=r}),n}Si.setExtensionXhrType("dds",Si.XHR_RESPONSE_TYPE.BUFFER);var Ur,Cu,gx=3,vx=4,_x=7,yx=19,xx=2,bx=0,Tx=1,wx=2,Ex=3;(function(i){i[i.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",i[i.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",i[i.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",i[i.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",i[i.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",i[i.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",i[i.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",i[i.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",i[i.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",i[i.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",i[i.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",i[i.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",i[i.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",i[i.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",i[i.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",i[i.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",i[i.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",i[i.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",i[i.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",i[i.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",i[i.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",i[i.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",i[i.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",i[i.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",i[i.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",i[i.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",i[i.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",i[i.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",i[i.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",i[i.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",i[i.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",i[i.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",i[i.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",i[i.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",i[i.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",i[i.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",i[i.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",i[i.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",i[i.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",i[i.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",i[i.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",i[i.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",i[i.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",i[i.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",i[i.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",i[i.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",i[i.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",i[i.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",i[i.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",i[i.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",i[i.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",i[i.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",i[i.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",i[i.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",i[i.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",i[i.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",i[i.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",i[i.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",i[i.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",i[i.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",i[i.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",i[i.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",i[i.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",i[i.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",i[i.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",i[i.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",i[i.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",i[i.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",i[i.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",i[i.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",i[i.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",i[i.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",i[i.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",i[i.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",i[i.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",i[i.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",i[i.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",i[i.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",i[i.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",i[i.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",i[i.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",i[i.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",i[i.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",i[i.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",i[i.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",i[i.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",i[i.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",i[i.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",i[i.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",i[i.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",i[i.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",i[i.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",i[i.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",i[i.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",i[i.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",i[i.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",i[i.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",i[i.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",i[i.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",i[i.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",i[i.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",i[i.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",i[i.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",i[i.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",i[i.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",i[i.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",i[i.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",i[i.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",i[i.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",i[i.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",i[i.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",i[i.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Ur||(Ur={})),function(i){i[i.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",i[i.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",i[i.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Cu||(Cu={}));var os,No,Bl,Sx=((Fl={})[827611204]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Fl[861165636]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Fl[894720068]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Fl),Ax=((Jr={})[Ur.DXGI_FORMAT_BC1_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Jr[Ur.DXGI_FORMAT_BC1_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Jr[Ur.DXGI_FORMAT_BC2_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Jr[Ur.DXGI_FORMAT_BC2_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Jr[Ur.DXGI_FORMAT_BC3_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Jr[Ur.DXGI_FORMAT_BC3_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Jr[Ur.DXGI_FORMAT_BC1_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Jr[Ur.DXGI_FORMAT_BC2_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Jr[Ur.DXGI_FORMAT_BC3_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Jr),Mx=function(){function i(){}return i.use=function(t,e){if(t.extension==="dds"&&t.data)try{Object.assign(t,rf(t.name||t.url,i.parse(t.data),t.metadata))}catch(n){return void e(n)}e()},i.parse=function(t){var e=new Uint32Array(t);if(e[0]!==542327876)throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[gx],o=n[vx],s=n[_x],a=new Uint32Array(t,yx*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),l=a[1];if(4&l){var h=a[xx];if(h!==808540228){var u=Sx[h],p=new Uint8Array(t,128);return[new Mu(p,{format:u,width:o,height:r,levels:s})]}var _=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),x=_[bx],w=_[Tx],M=_[wx],C=_[Ex],G=Ax[x];if(G===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+x);if(M===4)throw new Error("DDSLoader does not support cubemap textures");if(w===Cu.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var Q=new Array;if(C===1)Q.push(new Uint8Array(t,148));else{for(var nt=Dl[G],ct=0,it=o,mt=r,lt=0;lt<s;lt++)ct+=Math.max(1,it+3&-4)*Math.max(1,mt+3&-4)*nt,it>>>=1,mt>>>=1;var gt=148;for(lt=0;lt<C;lt++)Q.push(new Uint8Array(t,gt,ct)),gt+=ct}return Q.map(function(Ut){return new Mu(Ut,{format:G,width:o,height:r,levels:s})})}throw 64&l?new Error("DDSLoader does not support uncompressed texture data."):512&l?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&l?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&l?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},i}();Si.setExtensionXhrType("ktx",Si.XHR_RESPONSE_TYPE.BUFFER);var of=[171,75,84,88,32,49,49,187,13,10,26,10],Cx=12,Rx=16,Ix=24,Px=28,Ox=36,Nx=40,Lx=44,Dx=48,Fx=52,Bx=56,kx=60,sf=((os={})[gn.r.UNSIGNED_BYTE]=1,os[gn.r.UNSIGNED_SHORT]=2,os[gn.r.INT]=4,os[gn.r.UNSIGNED_INT]=4,os[gn.r.FLOAT]=4,os[gn.r.HALF_FLOAT]=8,os),Ux=((No={})[gn.h.RGBA]=4,No[gn.h.RGB]=3,No[gn.h.RG]=2,No[gn.h.RED]=1,No[gn.h.LUMINANCE]=1,No[gn.h.LUMINANCE_ALPHA]=2,No[gn.h.ALPHA]=1,No),Gx=((Bl={})[gn.r.UNSIGNED_SHORT_4_4_4_4]=2,Bl[gn.r.UNSIGNED_SHORT_5_5_5_1]=2,Bl[gn.r.UNSIGNED_SHORT_5_6_5]=2,Bl),Hx=function(){function i(){}return i.use=function(t,e){if(t.extension==="ktx"&&t.data)try{var n=t.name||t.url,r=i.parse(n,t.data),o=r.compressed,s=r.uncompressed,a=r.kvData;if(o){var l=rf(n,o,t.metadata);if(a&&l.textures)for(var h in l.textures)l.textures[h].baseTexture.ktxKeyValueData=a;Object.assign(t,l)}else if(s){var u={};s.forEach(function(p,_){var x=new ce.t(new ce.c(p.resource,{mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA,type:p.type,format:p.format})),w=n+"-"+(_+1);a&&(x.baseTexture.ktxKeyValueData=a),ce.c.addToCache(x.baseTexture,w),ce.t.addToCache(x,w),_===0&&(u[n]=x,ce.c.addToCache(x.baseTexture,n),ce.t.addToCache(x,n)),u[w]=x}),Object.assign(t,{textures:u})}}catch(p){return void e(p)}e()},i.parse=function(t,e){var n=new DataView(e);if(!i.validate(t,n))return null;var r=n.getUint32(Cx,!0)===67305985,o=n.getUint32(Rx,r),s=n.getUint32(Ix,r),a=n.getUint32(Px,r),l=n.getUint32(Ox,r),h=n.getUint32(Nx,r)||1,u=n.getUint32(Lx,r)||1,p=n.getUint32(Dx,r)||1,_=n.getUint32(Fx,r),x=n.getUint32(Bx,r),w=n.getUint32(kx,r);if(h===0||u!==1)throw new Error("Only 2D textures are supported");if(_!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");var M,C=l+3&-4,G=h+3&-4,Q=new Array(p),nt=l*h;if(o===0&&(nt=C*G),(M=o!==0?sf[o]?sf[o]*Ux[s]:Gx[o]:Dl[a])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var ct=i.loadKeyValueData?i.parseKvData(n,w,r):null,it=nt*M,mt=l,lt=h,gt=C,Ut=G,Ft=64+w,Mt=0;Mt<x;Mt++){for(var At=n.getUint32(Ft,r),Ot=Ft+4,Lt=0;Lt<p;Lt++){var ne=Q[Lt];ne||(ne=Q[Lt]=new Array(x)),ne[Mt]={levelID:Mt,levelWidth:x>1||o!==0?mt:gt,levelHeight:x>1||o!==0?lt:Ut,levelBuffer:new Uint8Array(e,Ot,it)},Ot+=it}Ft=(Ft+=At+4)%4!=0?Ft+4-Ft%4:Ft,it=(gt=(mt=mt>>1||1)+4-1&-4)*(Ut=(lt=lt>>1||1)+4-1&-4)*M}return o!==0?{uncompressed:Q.map(function($t){var zt=$t[0].levelBuffer,Yt=!1;return o===gn.r.FLOAT?zt=new Float32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4):o===gn.r.UNSIGNED_INT?(Yt=!0,zt=new Uint32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)):o===gn.r.INT&&(Yt=!0,zt=new Int32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)),{resource:new ce.i(zt,{width:$t[0].levelWidth,height:$t[0].levelHeight}),type:o,format:Yt?i.convertFormatToInteger(s):s}}),kvData:ct}:{compressed:Q.map(function($t){return new Mu(null,{format:a,width:l,height:h,levels:x,levelBuffers:$t})}),kvData:ct}},i.validate=function(t,e){for(var n=0;n<of.length;n++)if(e.getUint8(n)!==of[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},i.convertFormatToInteger=function(t){switch(t){case gn.h.RGBA:return gn.h.RGBA_INTEGER;case gn.h.RGB:return gn.h.RGB_INTEGER;case gn.h.RG:return gn.h.RG_INTEGER;case gn.h.RED:return gn.h.RED_INTEGER;default:return t}},i.parseKvData=function(t,e,n){for(var r=new Map,o=0;o<e;){var s=t.getUint32(64+o,n),a=64+o+4,l=3-(s+3)%4;if(s===0||s>e-o){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var h=0;h<s&&t.getUint8(a+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var u=new TextDecoder().decode(new Uint8Array(t.buffer,a,h)),p=new DataView(t.buffer,a+h+1,s-h-1);r.set(u,p),o+=4+s+l}return r},i.loadKeyValueData=!1,i}(),af=function(i,t){return(af=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function lf(i,t){function e(){this.constructor=i}af(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Lo,Do,jx=function(i){function t(e,n,r,o){e===void 0&&(e=1500),r===void 0&&(r=16384),o===void 0&&(o=!1);var s=i.call(this)||this;return r>16384&&(r=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=r,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=gn.b.NORMAL,s.autoResize=o,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return lf(t,i),t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Object(xn.hex2rgb)(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var n=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var n=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<n;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[n]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},t}(Cn.b),hf=function(){function i(t,e,n){this.geometry=new ce.l,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var o=t[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||gn.r.FLOAT,offset:o.offset},e[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return i.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new ce.h(Object(xn.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(a=this.dynamicProperties[n]).offset=e,e+=a.size,this.dynamicStride+=a.size;var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new ce.h(this.dynamicData,!1,!1);var o=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(a=this.staticProperties[n]).offset=o,o+=a.size,this.staticStride+=a.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ce.h(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var a=this.dynamicProperties[n];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.dynamicStride,4*a.offset)}for(n=0;n<this.staticProperties.length;++n)a=this.staticProperties[n],t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.staticStride,4*a.offset)},i.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},i.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},i.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},i}(),zx=function(i){function t(e){var n=i.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new De.d,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:gn.r.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=ce.r.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),n.state=ce.s.for2d(),n}return lf(t,i),t.prototype.render=function(e){var n=e.children,r=e._maxSize,o=e._batchSize,s=this.renderer,a=n.length;if(a!==0){a>r&&!e.autoResize&&(a=r);var l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));var h=n[0]._texture.baseTexture;this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),s.state.set(this.state);var u=s.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=Object(xn.premultiplyRgba)(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,h.alphaMode),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);for(var _=!1,x=0,w=0;x<a;x+=o,w+=1){var M=a-x;M>o&&(M=o),w>=l.length&&l.push(this._generateOneMoreBuffer(e));var C=l[w];C.uploadDynamic(n,x,M);var G=e._bufferUpdateIDs[w]||0;(_=_||C._updateID<G)&&(C._updateID=e._updateID,C.uploadStatic(n,x,M)),s.geometry.bind(C.geometry),u.drawElements(u.TRIANGLES,6*M,u.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var n=[],r=e._maxSize,o=e._batchSize,s=e._properties,a=0;a<r;a+=o)n.push(new hf(this.properties,s,o));return n},t.prototype._generateOneMoreBuffer=function(e){var n=e._batchSize,r=e._properties;return new hf(this.properties,r,n)},t.prototype.uploadVertices=function(e,n,r,o,s,a){for(var l=0,h=0,u=0,p=0,_=0;_<r;++_){var x=e[n+_],w=x._texture,M=x.scale.x,C=x.scale.y,G=w.trim,Q=w.orig;G?(l=(h=G.x-x.anchor.x*Q.width)+G.width,u=(p=G.y-x.anchor.y*Q.height)+G.height):(l=Q.width*(1-x.anchor.x),h=Q.width*-x.anchor.x,u=Q.height*(1-x.anchor.y),p=Q.height*-x.anchor.y),o[a]=h*M,o[a+1]=p*C,o[a+s]=l*M,o[a+s+1]=p*C,o[a+2*s]=l*M,o[a+2*s+1]=u*C,o[a+3*s]=h*M,o[a+3*s+1]=u*C,a+=4*s}},t.prototype.uploadPosition=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].position;o[a]=h.x,o[a+1]=h.y,o[a+s]=h.x,o[a+s+1]=h.y,o[a+2*s]=h.x,o[a+2*s+1]=h.y,o[a+3*s]=h.x,o[a+3*s+1]=h.y,a+=4*s}},t.prototype.uploadRotation=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].rotation;o[a]=h,o[a+s]=h,o[a+2*s]=h,o[a+3*s]=h,a+=4*s}},t.prototype.uploadUvs=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l]._texture._uvs;h?(o[a]=h.x0,o[a+1]=h.y0,o[a+s]=h.x1,o[a+s+1]=h.y1,o[a+2*s]=h.x2,o[a+2*s+1]=h.y2,o[a+3*s]=h.x3,o[a+3*s+1]=h.y3,a+=4*s):(o[a]=0,o[a+1]=0,o[a+s]=0,o[a+s+1]=0,o[a+2*s]=0,o[a+2*s+1]=0,o[a+3*s]=0,o[a+3*s+1]=0,a+=4*s)}},t.prototype.uploadTint=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l],u=h._texture.baseTexture.alphaMode>0,p=h.alpha,_=p<1&&u?Object(xn.premultiplyTint)(h._tintRGB,p):h._tintRGB+(255*p<<24);o[a]=_,o[a+s]=_,o[a+2*s]=_,o[a+3*s]=_,a+=4*s}},t.prototype.destroy=function(){i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(ce.m),yr=v(4);(function(i){i.MITER="miter",i.BEVEL="bevel",i.ROUND="round"})(Lo||(Lo={})),function(i){i.BUTT="butt",i.ROUND="round",i.SQUARE="square"}(Do||(Do={}));var Ta={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(i,t){if(t===void 0&&(t=20),!this.adaptive||!i||isNaN(i))return t;var e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},uf=function(){function i(){this.color=16777215,this.alpha=1,this.texture=ce.t.WHITE,this.matrix=null,this.visible=!1,this.reset()}return i.prototype.clone=function(){var t=new i;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},i.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ce.t.WHITE,this.matrix=null,this.visible=!1},i.prototype.destroy=function(){this.texture=null,this.matrix=null},i}(),cf=function(i,t){return(cf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Ru(i,t){function e(){this.constructor=i}cf(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function df(i,t){var e,n;t===void 0&&(t=!1);var r=i.length;if(!(r<6)){for(var o=0,s=0,a=i[r-2],l=i[r-1];s<r;s+=2){var h=i[s],u=i[s+1];o+=(h-a)*(u+l),a=h,l=u}if(!t&&o>0||t&&o<=0){var p=r/2;for(s=p+p%2;s<r;s+=2){var _=r-s-2,x=r-s-1,w=s,M=s+1;e=[i[w],i[_]],i[_]=e[0],i[w]=e[1],n=[i[M],i[x]],i[x]=n[0],i[M]=n[1]}}}}var pf={build:function(i){i.points=i.shape.points.slice()},triangulate:function(i,t){var e=i.points,n=i.holes,r=t.points,o=t.indices;if(e.length>=6){df(e,!1);for(var s=[],a=0;a<n.length;a++){var l=n[a];df(l.points,!0),s.push(e.length/2),e=e.concat(l.points)}var h=Object(xn.earcut)(e,s,2);if(!h)return;var u=r.length/2;for(a=0;a<h.length;a+=3)o.push(h[a]+u),o.push(h[a+1]+u),o.push(h[a+2]+u);for(a=0;a<e.length;a++)r.push(e[a])}}},kl={build:function(i){var t,e,n,r,o,s,a=i.points;if(i.type===De.l.CIRC){var l=i.shape;t=l.x,e=l.y,o=s=l.radius,n=r=0}else if(i.type===De.l.ELIP){var h=i.shape;t=h.x,e=h.y,o=h.width,s=h.height,n=r=0}else{var u=i.shape,p=u.width/2,_=u.height/2;t=u.x+p,e=u.y+_,n=p-(o=s=Math.max(0,Math.min(u.radius,Math.min(p,_)))),r=_-s}if(o>=0&&s>=0&&n>=0&&r>=0){var x=Math.ceil(2.3*Math.sqrt(o+s)),w=8*x+(n?4:0)+(r?4:0);if(a.length=w,w!==0){if(x===0)return a.length=8,a[0]=a[6]=t+n,a[1]=a[3]=e+r,a[2]=a[4]=t-n,void(a[5]=a[7]=e-r);var M=0,C=4*x+(n?2:0)+2,G=C,Q=w,nt=t+(Ut=n+o),ct=t-Ut,it=e+(Ft=r);if(a[M++]=nt,a[M++]=it,a[--C]=it,a[--C]=ct,r){var mt=e-Ft;a[G++]=ct,a[G++]=mt,a[--Q]=mt,a[--Q]=nt}for(var lt=1;lt<x;lt++){var gt=Math.PI/2*(lt/x);nt=t+(Ut=n+Math.cos(gt)*o),ct=t-Ut,it=e+(Ft=r+Math.sin(gt)*s),mt=e-Ft,a[M++]=nt,a[M++]=it,a[--C]=it,a[--C]=ct,a[G++]=ct,a[G++]=mt,a[--Q]=mt,a[--Q]=nt}var Ut,Ft;nt=t+(Ut=n),ct=t-Ut,it=e+(Ft=r+s),mt=e-Ft,a[M++]=nt,a[M++]=it,a[--Q]=mt,a[--Q]=nt,n&&(a[M++]=ct,a[M++]=it,a[--Q]=mt,a[--Q]=ct)}}else a.length=0},triangulate:function(i,t){var e,n,r=i.points,o=t.points,s=t.indices,a=o.length/2,l=a;if(i.type!==De.l.RREC){var h=i.shape;e=h.x,n=h.y}else{var u=i.shape;e=u.x+u.width/2,n=u.y+u.height/2}var p=i.matrix;o.push(i.matrix?p.a*e+p.c*n+p.tx:e,i.matrix?p.b*e+p.d*n+p.ty:n),a++,o.push(r[0],r[1]);for(var _=2;_<r.length;_+=2)o.push(r[_],r[_+1]),s.push(a++,l,a);s.push(l+1,l,a)}},Vx={build:function(i){var t=i.shape,e=t.x,n=t.y,r=t.width,o=t.height,s=i.points;s.length=0,s.push(e,n,e+r,n,e+r,n+o,e,n+o)},triangulate:function(i,t){var e=i.points,n=t.points,r=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function Ls(i,t,e){return i+(t-i)*e}function Ul(i,t,e,n,r,o,s){s===void 0&&(s=[]);for(var a=s,l=0,h=0,u=0,p=0,_=0,x=0,w=0,M=0;w<=20;++w)l=Ls(i,e,M=w/20),h=Ls(t,n,M),u=Ls(e,r,M),p=Ls(n,o,M),_=Ls(l,u,M),x=Ls(h,p,M),w===0&&a[a.length-2]===_&&a[a.length-1]===x||a.push(_,x);return a}var Wx={build:function(i){if(er.nextRoundedRectBehavior)kl.build(i);else{var t=i.shape,e=i.points,n=t.x,r=t.y,o=t.width,s=t.height,a=Math.max(0,Math.min(t.radius,Math.min(o,s)/2));e.length=0,a?(Ul(n,r+a,n,r,n+a,r,e),Ul(n+o-a,r,n+o,r,n+o,r+a,e),Ul(n+o,r+s-a,n+o,r+s,n+o-a,r+s,e),Ul(n+a,r+s,n,r+s,n,r+s-a,e)):e.push(n,r,n+o,r,n+o,r+s,n,r+s)}},triangulate:function(i,t){if(er.nextRoundedRectBehavior)kl.triangulate(i,t);else{for(var e=i.points,n=t.points,r=t.indices,o=n.length/2,s=Object(xn.earcut)(e,null,2),a=0,l=s.length;a<l;a+=3)r.push(s[a]+o),r.push(s[a+1]+o),r.push(s[a+2]+o);for(a=0,l=e.length;a<l;a++)n.push(e[a],e[++a])}}};function ff(i,t,e,n,r,o,s,a){var l,h;s?(l=n,h=-e):(l=-n,h=e);var u=i-e*r+l,p=t-n*r+h,_=i+e*o+l,x=t+n*o+h;return a.push(u,p),a.push(_,x),2}function Ds(i,t,e,n,r,o,s,a){var l=e-i,h=n-t,u=Math.atan2(l,h),p=Math.atan2(r-i,o-t);a&&u<p?u+=2*Math.PI:!a&&u>p&&(p+=2*Math.PI);var _=u,x=p-u,w=Math.abs(x),M=Math.sqrt(l*l+h*h),C=1+(15*w*Math.sqrt(M)/Math.PI>>0),G=x/C;if(_+=G,a){s.push(i,t),s.push(e,n);for(var Q=1,nt=_;Q<C;Q++,nt+=G)s.push(i,t),s.push(i+Math.sin(nt)*M,t+Math.cos(nt)*M);s.push(i,t),s.push(r,o)}else{for(s.push(e,n),s.push(i,t),Q=1,nt=_;Q<C;Q++,nt+=G)s.push(i+Math.sin(nt)*M,t+Math.cos(nt)*M),s.push(i,t);s.push(r,o),s.push(i,t)}return 2*C}function mf(i,t){i.lineStyle.native?function(e,n){var r=0,o=e.shape,s=e.points||o.points,a=o.type!==De.l.POLY||o.closeStroke;if(s.length!==0){var l=n.points,h=n.indices,u=s.length/2,p=l.length/2,_=p;for(l.push(s[0],s[1]),r=1;r<u;r++)l.push(s[2*r],s[2*r+1]),h.push(_,_+1),_++;a&&h.push(_,p)}}(i,t):function(e,n){var r=e.shape,o=e.points||r.points.slice(),s=n.closePointEps;if(o.length!==0){var a=e.lineStyle,l=new De.g(o[0],o[1]),h=new De.g(o[o.length-2],o[o.length-1]),u=r.type!==De.l.POLY||r.closeStroke,p=Math.abs(l.x-h.x)<s&&Math.abs(l.y-h.y)<s;if(u){o=o.slice(),p&&(o.pop(),o.pop(),h.set(o[o.length-2],o[o.length-1]));var _=.5*(l.x+h.x),x=.5*(h.y+l.y);o.unshift(_,x),o.push(_,x)}var w=n.points,M=o.length/2,C=o.length,G=w.length/2,Q=a.width/2,nt=Q*Q,ct=a.miterLimit*a.miterLimit,it=o[0],mt=o[1],lt=o[2],gt=o[3],Ut=0,Ft=0,Mt=-(mt-gt),At=it-lt,Ot=0,Lt=0,ne=Math.sqrt(Mt*Mt+At*At);Mt/=ne,At/=ne,Mt*=Q,At*=Q;var $t=a.alignment,zt=2*(1-$t),Yt=2*$t;u||(a.cap===Do.ROUND?C+=Ds(it-Mt*(zt-Yt)*.5,mt-At*(zt-Yt)*.5,it-Mt*zt,mt-At*zt,it+Mt*Yt,mt+At*Yt,w,!0)+2:a.cap===Do.SQUARE&&(C+=ff(it,mt,Mt,At,zt,Yt,!0,w))),w.push(it-Mt*zt,mt-At*zt),w.push(it+Mt*Yt,mt+At*Yt);for(var ge=1;ge<M-1;++ge){it=o[2*(ge-1)],mt=o[2*(ge-1)+1],lt=o[2*ge],gt=o[2*ge+1],Ut=o[2*(ge+1)],Ft=o[2*(ge+1)+1],Mt=-(mt-gt),At=it-lt,Mt/=ne=Math.sqrt(Mt*Mt+At*At),At/=ne,Mt*=Q,At*=Q,Ot=-(gt-Ft),Lt=lt-Ut,Ot/=ne=Math.sqrt(Ot*Ot+Lt*Lt),Lt/=ne,Ot*=Q,Lt*=Q;var be=lt-it,Pe=mt-gt,Ct=lt-Ut,Bt=Ft-gt,ve=Pe*Ct-Bt*be,le=ve<0;if(Math.abs(ve)<.1)w.push(lt-Mt*zt,gt-At*zt),w.push(lt+Mt*Yt,gt+At*Yt);else{var se=(-Mt+it)*(-At+gt)-(-Mt+lt)*(-At+mt),Ie=(-Ot+Ut)*(-Lt+gt)-(-Ot+lt)*(-Lt+Ft),Le=(be*Ie-Ct*se)/ve,ue=(Bt*se-Pe*Ie)/ve,bt=(Le-lt)*(Le-lt)+(ue-gt)*(ue-gt),jt=lt+(Le-lt)*zt,ie=gt+(ue-gt)*zt,ae=lt-(Le-lt)*Yt,qt=gt-(ue-gt)*Yt,ye=le?zt:Yt;bt<=Math.min(be*be+Pe*Pe,Ct*Ct+Bt*Bt)+ye*ye*nt?a.join===Lo.BEVEL||bt/nt>ct?(le?(w.push(jt,ie),w.push(lt+Mt*Yt,gt+At*Yt),w.push(jt,ie),w.push(lt+Ot*Yt,gt+Lt*Yt)):(w.push(lt-Mt*zt,gt-At*zt),w.push(ae,qt),w.push(lt-Ot*zt,gt-Lt*zt),w.push(ae,qt)),C+=2):a.join===Lo.ROUND?le?(w.push(jt,ie),w.push(lt+Mt*Yt,gt+At*Yt),C+=Ds(lt,gt,lt+Mt*Yt,gt+At*Yt,lt+Ot*Yt,gt+Lt*Yt,w,!0)+4,w.push(jt,ie),w.push(lt+Ot*Yt,gt+Lt*Yt)):(w.push(lt-Mt*zt,gt-At*zt),w.push(ae,qt),C+=Ds(lt,gt,lt-Mt*zt,gt-At*zt,lt-Ot*zt,gt-Lt*zt,w,!1)+4,w.push(lt-Ot*zt,gt-Lt*zt),w.push(ae,qt)):(w.push(jt,ie),w.push(ae,qt)):(w.push(lt-Mt*zt,gt-At*zt),w.push(lt+Mt*Yt,gt+At*Yt),a.join===Lo.ROUND?C+=le?Ds(lt,gt,lt+Mt*Yt,gt+At*Yt,lt+Ot*Yt,gt+Lt*Yt,w,!0)+2:Ds(lt,gt,lt-Mt*zt,gt-At*zt,lt-Ot*zt,gt-Lt*zt,w,!1)+2:a.join===Lo.MITER&&bt/nt<=ct&&(le?(w.push(ae,qt),w.push(ae,qt)):(w.push(jt,ie),w.push(jt,ie)),C+=2),w.push(lt-Ot*zt,gt-Lt*zt),w.push(lt+Ot*Yt,gt+Lt*Yt),C+=2)}}it=o[2*(M-2)],mt=o[2*(M-2)+1],lt=o[2*(M-1)],Mt=-(mt-(gt=o[2*(M-1)+1])),At=it-lt,Mt/=ne=Math.sqrt(Mt*Mt+At*At),At/=ne,Mt*=Q,At*=Q,w.push(lt-Mt*zt,gt-At*zt),w.push(lt+Mt*Yt,gt+At*Yt),u||(a.cap===Do.ROUND?C+=Ds(lt-Mt*(zt-Yt)*.5,gt-At*(zt-Yt)*.5,lt-Mt*zt,gt-At*zt,lt+Mt*Yt,gt+At*Yt,w,!1)+2:a.cap===Do.SQUARE&&(C+=ff(lt,gt,Mt,At,zt,Yt,!1,w)));var nn=n.indices,on=Ta.epsilon*Ta.epsilon;for(ge=G;ge<C+G-2;++ge)it=w[2*ge],mt=w[2*ge+1],lt=w[2*(ge+1)],gt=w[2*(ge+1)+1],Ut=w[2*(ge+2)],Ft=w[2*(ge+2)+1],Math.abs(it*(gt-Ft)+lt*(Ft-mt)+Ut*(mt-gt))<on||nn.push(ge,ge+1,ge+2)}}(i,t)}var Fs,gf=function(){function i(){}return i.curveTo=function(t,e,n,r,o,s){var a=s[s.length-2],l=s[s.length-1]-e,h=a-t,u=r-e,p=n-t,_=Math.abs(l*p-h*u);if(_<1e-8||o===0)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var x=l*l+h*h,w=u*u+p*p,M=l*u+h*p,C=o*Math.sqrt(x)/_,G=o*Math.sqrt(w)/_,Q=C*M/x,nt=G*M/w,ct=C*p+G*h,it=C*u+G*l,mt=h*(G+Q),lt=l*(G+Q),gt=p*(C+nt),Ut=u*(C+nt);return{cx:ct+t,cy:it+e,radius:o,startAngle:Math.atan2(lt-it,mt-ct),endAngle:Math.atan2(Ut-it,gt-ct),anticlockwise:h*u>p*l}},i.arc=function(t,e,n,r,o,s,a,l,h){for(var u=a-s,p=Ta._segmentsCount(Math.abs(u)*o,40*Math.ceil(Math.abs(u)/De.f)),_=u/(2*p),x=2*_,w=Math.cos(_),M=Math.sin(_),C=p-1,G=C%1/C,Q=0;Q<=C;++Q){var nt=_+s+x*(Q+G*Q),ct=Math.cos(nt),it=-Math.sin(nt);h.push((w*ct+M*it)*o+n,(w*-it+M*ct)*o+r)}},i}(),Xx=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s,a,l){for(var h=0,u=0,p=0,_=0,x=0,w=0,M=0,C=0,G=0,Q=0,nt=0,ct=t,it=e,mt=1;mt<=10;++mt)Q=ct-(C=(M=(w=(x=1-(u=mt/10))*x)*x)*t+3*w*u*n+3*x*(p=u*u)*o+(_=p*u)*a),nt=it-(G=M*e+3*w*u*r+3*x*p*s+_*l),ct=C,it=G,h+=Math.sqrt(Q*Q+nt*nt);return h},i.curveTo=function(t,e,n,r,o,s,a){var l=a[a.length-2],h=a[a.length-1];a.length-=2;var u=Ta._segmentsCount(i.curveLength(l,h,t,e,n,r,o,s)),p=0,_=0,x=0,w=0,M=0;a.push(l,h);for(var C=1,G=0;C<=u;++C)x=(_=(p=1-(G=C/u))*p)*p,M=(w=G*G)*G,a.push(x*l+3*_*G*t+3*p*w*n+M*o,x*h+3*_*G*e+3*p*w*r+M*s)},i}(),Yx=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s){var a=t-2*n+o,l=e-2*r+s,h=2*n-2*t,u=2*r-2*e,p=4*(a*a+l*l),_=4*(a*h+l*u),x=h*h+u*u,w=2*Math.sqrt(p+_+x),M=Math.sqrt(p),C=2*p*M,G=2*Math.sqrt(x),Q=_/M;return(C*w+M*_*(w-G)+(4*x*p-_*_)*Math.log((2*M+Q+w)/(Q+G)))/(4*C)},i.curveTo=function(t,e,n,r,o){for(var s=o[o.length-2],a=o[o.length-1],l=Ta._segmentsCount(i.curveLength(s,a,t,e,n,r)),h=0,u=0,p=1;p<=l;++p){var _=p/l;h=s+(t-s)*_,u=a+(e-a)*_,o.push(h+(t+(n-t)*_-h)*_,u+(e+(r-e)*_-u)*_)}},i}(),qx=function(){function i(){this.reset()}return i.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},i.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},i.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},i}(),Iu=((Fs={})[De.l.POLY]=pf,Fs[De.l.CIRC]=kl,Fs[De.l.ELIP]=kl,Fs[De.l.RECT]=Vx,Fs[De.l.RREC]=Wx,Fs),vf=[],Gl=[],_f=function(){function i(t,e,n,r){e===void 0&&(e=null),n===void 0&&(n=null),r===void 0&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}return i.prototype.clone=function(){return new i(this.shape,this.fillStyle,this.lineStyle,this.matrix)},i.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},i}(),Bs=new De.g,Jx=new Cn.a,Zx=function(i){function t(){var e=i.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Cn.a,e.boundsDirty=-1,e}return Ru(t,i),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Gl.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var n=this.batches[e];n.reset(),vf.push(n)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,n,r,o){n===void 0&&(n=null),r===void 0&&(r=null),o===void 0&&(o=null);var s=new _f(e,n,r,o);return this.graphicsData.push(s),this.dirty++,this},t.prototype.drawHole=function(e,n){if(n===void 0&&(n=null),!this.graphicsData.length)return null;var r=new _f(e,null,null,n),o=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=o.lineStyle,o.holes.push(r),this.dirty++,this},t.prototype.destroy=function(){i.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var n=this.graphicsData,r=0;r<n.length;++r){var o=n[r];if(o.fillStyle.visible&&o.shape&&(o.matrix?o.matrix.applyInverse(e,Bs):Bs.copyFrom(e),o.shape.contains(Bs.x,Bs.y))){var s=!1;if(o.holes){for(var a=0;a<o.holes.length;a++)if(o.holes[a].shape.contains(Bs.x,Bs.y)){s=!0;break}}if(!s)return!0}}return!1},t.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var n=this.uvs,r=this.graphicsData,o=null,s=null;this.batches.length>0&&(s=(o=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<r.length;a++){this.shapeIndex++;var l=r[a],h=l.fillStyle,u=l.lineStyle;Iu[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||u.visible)&&this.processHoles(l.holes);for(var p=0;p<2;p++){var _=p===0?h:u;if(_.visible){var x=_.texture.baseTexture,w=this.indices.length,M=this.points.length/2;x.wrapMode=gn.s.REPEAT,p===0?this.processFill(l):this.processLine(l);var C=this.points.length/2-M;C!==0&&(o&&!this._compareStyles(s,_)&&(o.end(w,M),o=null),o||((o=vf.pop()||new qx).begin(_,w,M),this.batches.push(o),s=_),this.addUvs(this.points,n,_.texture,M,C,_.matrix))}}}var G=this.indices.length,Q=this.points.length/2;if(o&&o.end(G,Q),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var nt=Q>65535&&e;this.indicesUint16=nt?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},t.prototype._compareStyles=function(e,n){return!(!e||!n)&&e.texture.baseTexture===n.texture.baseTexture&&e.color+e.alpha===n.color+n.alpha&&!!e.native==!!n.native},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,n=this.graphicsData.length;e<n;e++){var r=this.graphicsData[e],o=r.fillStyle,s=r.lineStyle;if(o&&!o.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,n=0,r=e.length;n<r;n++)for(var o=e[n],s=0;s<o.size;s++){var a=o.start+s;this.indicesUint16[a]=this.indicesUint16[a]-o.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE},t.prototype.buildDrawCalls=function(){for(var e=++ce.c._globalBatch,n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),Gl.push(this.drawCalls[n]);this.drawCalls.length=0;var r=this.colors,o=this.textureIds,s=Gl.pop();s||((s=new ce.d).texArray=new ce.g),s.texArray.count=0,s.start=0,s.size=0,s.type=gn.f.TRIANGLES;var a=0,l=null,h=0,u=!1,p=gn.f.TRIANGLES,_=0;for(this.drawCalls.push(s),n=0;n<this.batches.length;n++){var x=this.batches[n],w=x.style,M=w.texture.baseTexture;u!==!!w.native&&(p=(u=!!w.native)?gn.f.LINES:gn.f.TRIANGLES,l=null,a=8,e++),l!==M&&(l=M,M._batchEnabled!==e&&(a===8&&(e++,a=0,s.size>0&&((s=Gl.pop())||((s=new ce.d).texArray=new ce.g),this.drawCalls.push(s)),s.start=_,s.size=0,s.texArray.count=0,s.type=p),M.touched=1,M._batchEnabled=e,M._batchLocation=a,M.wrapMode=gn.s.REPEAT,s.texArray.elements[s.texArray.count++]=M,a++)),s.size+=x.size,_+=x.size,h=M._batchLocation,this.addColors(r,w.color,w.alpha,x.attribSize,x.attribStart),this.addTextureIds(o,h,x.attribSize,x.attribStart)}ce.c._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,n=this.uvs,r=this.colors,o=this.textureIds,s=new ArrayBuffer(3*e.length*4),a=new Float32Array(s),l=new Uint32Array(s),h=0,u=0;u<e.length/2;u++)a[h++]=e[2*u],a[h++]=e[2*u+1],a[h++]=n[2*u],a[h++]=n[2*u+1],l[h++]=r[u],a[h++]=o[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?pf.triangulate(e,this):Iu[e.type].triangulate(e,this)},t.prototype.processLine=function(e){mf(e,this);for(var n=0;n<e.holes.length;n++)mf(e.holes[n],this)},t.prototype.processHoles=function(e){for(var n=0;n<e.length;n++){var r=e[n];Iu[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,n=Jx,r=De.d.IDENTITY;this._bounds.clear(),n.clear();for(var o=0;o<this.graphicsData.length;o++){var s=this.graphicsData[o],a=s.shape,l=s.type,h=s.lineStyle,u=s.matrix||De.d.IDENTITY,p=0;if(h&&h.visible&&(p=h.width,l!==De.l.POLY||s.fillStyle.visible?p*=Math.max(0,h.alignment):p*=Math.max(h.alignment,1-h.alignment)),r!==u&&(n.isEmpty()||(e.addBoundsMatrix(n,r),n.clear()),r=u),l===De.l.RECT||l===De.l.RREC){var _=a;n.addFramePad(_.x,_.y,_.x+_.width,_.y+_.height,p,p)}else if(l===De.l.CIRC){var x=a;n.addFramePad(x.x,x.y,x.x,x.y,x.radius+p,x.radius+p)}else if(l===De.l.ELIP){var w=a;n.addFramePad(w.x,w.y,w.x,w.y,w.width+p,w.height+p)}else{var M=a;e.addVerticesMatrix(r,M.points,0,M.points.length,p,p)}}n.isEmpty()||e.addBoundsMatrix(n,r),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,n){for(var r=0;r<e.length/2;r++){var o=e[2*r],s=e[2*r+1];e[2*r]=n.a*o+n.c*s+n.tx,e[2*r+1]=n.b*o+n.d*s+n.ty}},t.prototype.addColors=function(e,n,r,o,s){s===void 0&&(s=0);var a=(n>>16)+(65280&n)+((255&n)<<16),l=Object(xn.premultiplyTint)(a,r);e.length=Math.max(e.length,s+o);for(var h=0;h<o;h++)e[s+h]=l},t.prototype.addTextureIds=function(e,n,r,o){o===void 0&&(o=0),e.length=Math.max(e.length,o+r);for(var s=0;s<r;s++)e[o+s]=n},t.prototype.addUvs=function(e,n,r,o,s,a){a===void 0&&(a=null);for(var l=0,h=n.length,u=r.frame;l<s;){var p=e[2*(o+l)],_=e[2*(o+l)+1];if(a){var x=a.a*p+a.c*_+a.tx;_=a.b*p+a.d*_+a.ty,p=x}l++,n.push(p/u.width,_/u.height)}var w=r.baseTexture;(u.width<w.width||u.height<w.height)&&this.adjustUvs(n,r,h,s)},t.prototype.adjustUvs=function(e,n,r,o){for(var s=n.baseTexture,a=1e-6,l=r+2*o,h=n.frame,u=h.width/s.width,p=h.height/s.height,_=h.x/h.width,x=h.y/h.height,w=Math.floor(e[r]+a),M=Math.floor(e[r+1]+a),C=r+2;C<l;C+=2)w=Math.min(w,Math.floor(e[C]+a)),M=Math.min(M,Math.floor(e[C+1]+a));for(_-=w,x-=M,C=r;C<l;C+=2)e[C]=(e[C]+_)*u,e[C+1]=(e[C+1]+x)*p},t.BATCHABLE_SIZE=100,t}(ce.e),Kx=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Do.BUTT,e.join=Lo.MITER,e.miterLimit=10,e}return Ru(t,i),t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){i.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(uf),Qx=new Float32Array(3),Pu={},er=function(i){function t(e){e===void 0&&(e=null);var n=i.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new uf,n._lineStyle=new Kx,n._matrix=null,n._holeMode=!1,n.state=ce.s.for2d(),n._geometry=e||new Zx,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=gn.b.NORMAL,n}return Ru(t,i),Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,n,r,o,s){return e===void 0&&(e=null),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=.5),s===void 0&&(s=!1),typeof e=="number"&&(e={width:e,color:n,alpha:r,alignment:o,native:s}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:ce.t.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Do.BUTT,join:Lo.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new De.h,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[n-2],e[n-1]))}else this.currentPath=new De.h,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,n){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=n,this},t.prototype.lineTo=function(e,n){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,o=r[r.length-2],s=r[r.length-1];return o===e&&s===n||r.push(e,n),this},t.prototype._initCurve=function(e,n){e===void 0&&(e=0),n===void 0&&(n=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,n]):this.moveTo(e,n)},t.prototype.quadraticCurveTo=function(e,n,r,o){this._initCurve();var s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Yx.curveTo(e,n,r,o,s),this},t.prototype.bezierCurveTo=function(e,n,r,o,s,a){return this._initCurve(),Xx.curveTo(e,n,r,o,s,a,this.currentPath.points),this},t.prototype.arcTo=function(e,n,r,o,s){this._initCurve(e,n);var a=this.currentPath.points,l=gf.curveTo(e,n,r,o,s,a);if(l){var h=l.cx,u=l.cy,p=l.radius,_=l.startAngle,x=l.endAngle,w=l.anticlockwise;this.arc(h,u,p,_,x,w)}return this},t.prototype.arc=function(e,n,r,o,s,a){if(a===void 0&&(a=!1),o===s)return this;if(!a&&s<=o?s+=De.f:a&&o<=s&&(o+=De.f),s-o===0)return this;var l=e+Math.cos(o)*r,h=n+Math.sin(o)*r,u=this._geometry.closePointEps,p=this.currentPath?this.currentPath.points:null;if(p){var _=Math.abs(p[p.length-2]-l),x=Math.abs(p[p.length-1]-h);_<u&&x<u||p.push(l,h)}else this.moveTo(l,h),p=this.currentPath.points;return gf.arc(l,h,e,n,r,o,s,a,p),this},t.prototype.beginFill=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=1),this.beginTextureFill({texture:ce.t.WHITE,color:e,alpha:n})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:ce.t.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,n,r,o){return this.drawShape(new De.j(e,n,r,o))},t.prototype.drawRoundedRect=function(e,n,r,o,s){return this.drawShape(new De.k(e,n,r,o,s))},t.prototype.drawCircle=function(e,n,r){return this.drawShape(new De.a(e,n,r))},t.prototype.drawEllipse=function(e,n,r,o){return this.drawShape(new De.c(e,n,r,o))},t.prototype.drawPolygon=function(){for(var e,n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];var s=!0,a=r[0];a.points?(s=a.closeStroke,e=a.points):e=Array.isArray(r[0])?r[0]:r;var l=new De.h(e);return l.closeStroke=s,this.drawShape(l),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(e.length!==1||e[0].shape.type!==De.l.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var n=this._geometry,r=e.context.supports.uint32Indices;n.updateBatches(r),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,n=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(var o=0;o<r;o++){var s=e.batches[o],a=s.style.color,l=new Float32Array(this.vertexData.buffer,4*s.attribStart*2,2*s.attribSize),h=new Float32Array(e.uvsFloat32.buffer,4*s.attribStart*2,2*s.attribSize),u={vertexData:l,blendMode:n,indices:new Uint16Array(e.indicesUint16.buffer,2*s.start,s.size),uvs:h,_batchRGB:Object(xn.hex2rgb)(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[o]=u}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var n=0,r=this.batches.length;n<r;n++){var o=this.batches[n];o.worldAlpha=this.worldAlpha*o.alpha,e.plugins[this.pluginName].render(o)}}},t.prototype._renderDirect=function(e){var n=this._resolveDirectShader(e),r=this._geometry,o=this.tint,s=this.worldAlpha,a=n.uniforms,l=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(o>>16&255)/255*s,a.tint[1]=(o>>8&255)/255*s,a.tint[2]=(255&o)/255*s,a.tint[3]=s,e.shader.bind(n),e.geometry.bind(r,n),e.state.set(this.state);for(var h=0,u=l.length;h<u;h++)this._renderDrawCallDirect(e,r.drawCalls[h])},t.prototype._renderDrawCallDirect=function(e,n){for(var r=n.texArray,o=n.type,s=n.size,a=n.start,l=r.count,h=0;h<l;h++)e.texture.bind(r.elements[h],h);e.geometry.draw(o,s,a)},t.prototype._resolveDirectShader=function(e){var n=this.shader,r=this.pluginName;if(!n){if(!Pu[r]){for(var o=e.plugins[r].MAX_TEXTURES,s=new Int32Array(o),a=0;a<o;a++)s[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new De.d,default:ce.v.from({uSamplers:s},!0)},h=e.plugins[r]._shader.program;Pu[r]=new ce.r(h,l)}n=Pu[r]}return n},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var n=e.bounds,r=n.minX,o=n.minY,s=n.maxX,a=n.maxY;this._bounds.addFrame(this.transform,r,o,s,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Object(xn.hex2rgb)(this.tint,Qx),n=0;n<this.batches.length;n++){var r=this.batches[n],o=r._batchRGB,s=(e[0]*o[0]*255<<16)+(e[1]*o[1]*255<<8)+(0|e[2]*o[2]*255);r._tintRGB=(s>>16)+(65280&s)+((255&s)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this._geometry.points,p=this.vertexData,_=0,x=0;x<u.length;x+=2){var w=u[x],M=u[x+1];p[_++]=r*w+s*M+l,p[_++]=a*M+o*w+h}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,i.prototype.destroy.call(this,e)},t.nextRoundedRectBehavior=!1,t._TEMP_POINT=new De.g,t}(Cn.b),yf=function(i,t){return(yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},wa,Ea=new De.g,$x=new Uint16Array([0,1,2,0,2,3]),di=function(i){function t(e){var n=i.call(this)||this;return n._anchor=new De.e(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=gn.b.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||ce.t.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=$x,n.pluginName="batch",n.isSprite=!0,n._roundPixels=yr.b.ROUND_PIXELS,n}return function(e,n){function r(){this.constructor=e}yf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Object(xn.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Object(xn.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this.vertexData,p=e.trim,_=e.orig,x=this._anchor,w=0,M=0,C=0,G=0;if(p?(w=(M=p.x-x._x*_.width)+p.width,C=(G=p.y-x._y*_.height)+p.height):(w=(M=-x._x*_.width)+_.width,C=(G=-x._y*_.height)+_.height),u[0]=r*M+s*G+l,u[1]=a*G+o*M+h,u[2]=r*w+s*G+l,u[3]=a*G+o*w+h,u[4]=r*w+s*C+l,u[5]=a*C+o*w+h,u[6]=r*M+s*C+l,u[7]=a*C+o*M+h,this._roundPixels)for(var Q=yr.b.RESOLUTION,nt=0;nt<u.length;++nt)u[nt]=Math.round((u[nt]*Q|0)/Q)}},t.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,n=this.vertexTrimmedData,r=e.orig,o=this._anchor,s=this.transform.worldTransform,a=s.a,l=s.b,h=s.c,u=s.d,p=s.tx,_=s.ty,x=-o._x*r.width,w=x+r.width,M=-o._y*r.height,C=M+r.height;n[0]=a*x+h*M+p,n[1]=u*M+l*x+_,n[2]=a*w+h*M+p,n[3]=u*M+l*w+_,n[4]=a*w+h*C+p,n[5]=u*C+l*w+_,n[6]=a*x+h*C+p,n[7]=u*C+l*x+_},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Cn.a),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._localBounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Ea);var n=this._texture.orig.width,r=this._texture.orig.height,o=-n*this.anchor.x,s=0;return Ea.x>=o&&Ea.x<o+n&&(s=-r*this.anchor.y,Ea.y>=s&&Ea.y<s+r)},t.prototype.destroy=function(e){if(i.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e&&e.texture){var n=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},t.from=function(e,n){return new t(e instanceof ce.t?e:ce.t.from(e,n))},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||ce.t.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Cn.b),xf=function(i,t){return(xf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};(function(i){i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(wa||(wa={}));var Ou={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:wa.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},tb=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ks=function(){function i(t){this.styleID=0,this.reset(),Lu(this,t,t)}return i.prototype.clone=function(){var t={};return Lu(t,this,Ou),new i(t)},i.prototype.reset=function(){Lu(this,Ou,Ou)},Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Nu(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Nu(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(e,n){if(!Array.isArray(e)||!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Nu(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),i.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&tb.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},i}();function bf(i){return typeof i=="number"?Object(xn.hex2string)(i):(typeof i=="string"&&i.indexOf("0x")===0&&(i=i.replace("0x","#")),i)}function Nu(i){if(Array.isArray(i)){for(var t=0;t<i.length;++t)i[t]=bf(i[t]);return i}return bf(i)}function Lu(i,t,e){for(var n in e)Array.isArray(t[n])?i[n]=t[n].slice():i[n]=t[n]}var Zr=function(){function i(t,e,n,r,o,s,a,l,h){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}return i.measureText=function(t,e,n,r){r===void 0&&(r=i._canvas),n=n==null?e.wordWrap:n;var o=e.toFontString(),s=i.measureFont(o);s.fontSize===0&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var a=r.getContext("2d");a.font=o;for(var l=(n?i.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),u=0,p=0;p<l.length;p++){var _=a.measureText(l[p]).width+(l[p].length-1)*e.letterSpacing;h[p]=_,u=Math.max(u,_)}var x=u+e.strokeThickness;e.dropShadow&&(x+=e.dropShadowDistance);var w=e.lineHeight||s.fontSize+e.strokeThickness,M=Math.max(w,s.fontSize+e.strokeThickness)+(l.length-1)*(w+e.leading);return e.dropShadow&&(M+=e.dropShadowDistance),new i(t,e,x,M,l,h,w+e.leading,u,s)},i.wordWrap=function(t,e,n){n===void 0&&(n=i._canvas);for(var r=n.getContext("2d"),o=0,s="",a="",l=Object.create(null),h=e.letterSpacing,u=e.whiteSpace,p=i.collapseSpaces(u),_=i.collapseNewlines(u),x=!p,w=e.wordWrapWidth+h,M=i.tokenize(t),C=0;C<M.length;C++){var G=M[C];if(i.isNewline(G)){if(!_){a+=i.addLine(s),x=!p,s="",o=0;continue}G=" "}if(p){var Q=i.isBreakingSpace(G),nt=i.isBreakingSpace(s[s.length-1]);if(Q&&nt)continue}var ct=i.getFromCache(G,h,l,r);if(ct>w)if(s!==""&&(a+=i.addLine(s),s="",o=0),i.canBreakWords(G,e.breakWords))for(var it=i.wordWrapSplit(G),mt=0;mt<it.length;mt++){for(var lt=it[mt],gt=1;it[mt+gt];){var Ut=it[mt+gt],Ft=lt[lt.length-1];if(i.canBreakChars(Ft,Ut,G,mt,e.breakWords))break;lt+=Ut,gt++}mt+=lt.length-1;var Mt=i.getFromCache(lt,h,l,r);Mt+o>w&&(a+=i.addLine(s),x=!1,s="",o=0),s+=lt,o+=Mt}else{s.length>0&&(a+=i.addLine(s),s="",o=0);var At=C===M.length-1;a+=i.addLine(G,!At),x=!1,s="",o=0}else ct+o>w&&(x=!1,a+=i.addLine(s),s="",o=0),(s.length>0||!i.isBreakingSpace(G)||x)&&(s+=G,o+=ct)}return a+=i.addLine(s,!1)},i.addLine=function(t,e){return e===void 0&&(e=!0),t=i.trimRight(t),t=e?t+`
`:t},i.getFromCache=function(t,e,n,r){var o=n[t];if(typeof o!="number"){var s=t.length*e;o=r.measureText(t).width+s,n[t]=o}return o},i.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},i.collapseNewlines=function(t){return t==="normal"},i.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var n=t[e];if(!i.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},i.isNewline=function(t){return typeof t=="string"&&i._newlines.indexOf(t.charCodeAt(0))>=0},i.isBreakingSpace=function(t,e){return typeof t=="string"&&i._breakingSpaces.indexOf(t.charCodeAt(0))>=0},i.tokenize=function(t){var e=[],n="";if(typeof t!="string")return e;for(var r=0;r<t.length;r++){var o=t[r],s=t[r+1];i.isBreakingSpace(o,s)||i.isNewline(o)?(n!==""&&(e.push(n),n=""),e.push(o)):n+=o}return n!==""&&e.push(n),e},i.canBreakWords=function(t,e){return e},i.canBreakChars=function(t,e,n,r,o){return!0},i.wordWrapSplit=function(t){return t.split("")},i.measureFont=function(t){if(i._fonts[t])return i._fonts[t];var e={ascent:0,descent:0,fontSize:0},n=i._canvas,r=i._context;r.font=t;var o=i.METRICS_STRING+i.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width),a=Math.ceil(r.measureText(i.BASELINE_SYMBOL).width),l=Math.ceil(i.HEIGHT_MULTIPLIER*a);a=a*i.BASELINE_MULTIPLIER|0,n.width=s,n.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,a);var h=r.getImageData(0,0,s,l).data,u=h.length,p=4*s,_=0,x=0,w=!1;for(_=0;_<a;++_){for(var M=0;M<p;M+=4)if(h[x+M]!==255){w=!0;break}if(w)break;x+=p}for(e.ascent=a-_,x=u-p,w=!1,_=l;_>a;--_){for(M=0;M<p;M+=4)if(h[x+M]!==255){w=!0;break}if(w)break;x-=p}return e.descent=_-a,e.fontSize=e.ascent+e.descent,i._fonts[t]=e,e},i.clearMetrics=function(t){t===void 0&&(t=""),t?delete i._fonts[t]:i._fonts={}},Object.defineProperty(i,"_canvas",{get:function(){if(!i.__canvas){var t=void 0;try{var e=new OffscreenCanvas(0,0),n=e.getContext("2d");if(n&&n.measureText)return i.__canvas=e,e;t=document.createElement("canvas")}catch{t=document.createElement("canvas")}t.width=t.height=10,i.__canvas=t}return i.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(i,"_context",{get:function(){return i.__context||(i.__context=i._canvas.getContext("2d")),i.__context},enumerable:!1,configurable:!0}),i}();Zr._fonts={},Zr.METRICS_STRING="|\xC9q\xC5",Zr.BASELINE_SYMBOL="M",Zr.BASELINE_MULTIPLIER=1.4,Zr.HEIGHT_MULTIPLIER=2,Zr._newlines=[10,13],Zr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var eb={texture:!0,children:!1,baseTexture:!0},Du=function(i){function t(e,n,r){var o=this,s=!1;r||(r=document.createElement("canvas"),s=!0),r.width=3,r.height=3;var a=ce.t.from(r);return a.orig=new De.j,a.trim=new De.j,(o=i.call(this,a)||this)._ownCanvas=s,o.canvas=r,o.context=o.canvas.getContext("2d"),o._resolution=yr.b.RESOLUTION,o._autoResolution=!0,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=e,o.style=n,o.localStyleID=-1,o}return function(e,n){function r(){this.constructor=e}xf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.updateText=function(e){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!e){this._font=this._style.toFontString();var r,o,s=this.context,a=Zr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),l=a.width,h=a.height,u=a.lines,p=a.lineHeight,_=a.lineWidths,x=a.maxLineWidth,w=a.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,l)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var M=n.dropShadow?2:1,C=0;C<M;++C){var G=n.dropShadow&&C===0,Q=G?Math.ceil(Math.max(1,h)+2*n.padding):0,nt=Q*this._resolution;if(G){s.fillStyle="black",s.strokeStyle="black";var ct=n.dropShadowColor,it=Object(xn.hex2rgb)(typeof ct=="number"?ct:Object(xn.string2hex)(ct)),mt=n.dropShadowBlur*this._resolution,lt=n.dropShadowDistance*this._resolution;s.shadowColor="rgba("+255*it[0]+","+255*it[1]+","+255*it[2]+","+n.dropShadowAlpha+")",s.shadowBlur=mt,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*lt,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*lt+nt}else s.fillStyle=this._generateFillStyle(n,u,a),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var gt=(p-w.fontSize)/2;(!t.nextLineHeightBehavior||p-w.fontSize<0)&&(gt=0);for(var Ut=0;Ut<u.length;Ut++)r=n.strokeThickness/2,o=n.strokeThickness/2+Ut*p+w.ascent+gt,n.align==="right"?r+=x-_[Ut]:n.align==="center"&&(r+=(x-_[Ut])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[Ut],r+n.padding,o+n.padding-Q,!0),n.fill&&this.drawLetterSpacing(u[Ut],r+n.padding,o+n.padding-Q)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,n,r,o){o===void 0&&(o=!1);var s=this._style.letterSpacing,a=t.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(s===0||a)return a&&(this.context.letterSpacing=s,this.context.textLetterSpacing=s),void(o?this.context.strokeText(e,n,r):this.context.fillText(e,n,r));for(var l=n,h=Array.from?Array.from(e):e.split(""),u=this.context.measureText(e).width,p=0,_=0;_<h.length;++_){var x=h[_];o?this.context.strokeText(x,l,r):this.context.fillText(x,l,r);for(var w="",M=_+1;M<h.length;++M)w+=h[M];l+=u-(p=this.context.measureText(w).width)+s,u=p}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var n=Object(xn.trimCanvas)(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}var r=this._texture,o=this._style,s=o.trim?0:o.padding,a=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-2*s,r.orig.height=r._frame.height-2*s,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),i.prototype._render.call(this,e)},t.prototype.updateTransform=function(){this.updateText(!0),i.prototype.updateTransform.call(this)},t.prototype.getBounds=function(e,n){return this.updateText(!0),this._textureID===-1&&(e=!1),i.prototype.getBounds.call(this,e,n)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),i.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,n,r){var o,s=e.fill;if(!Array.isArray(s))return s;if(s.length===1)return s[0];var a=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-a-2*l,u=this.canvas.height/this._resolution-a-2*l,p=s.slice(),_=e.fillGradientStops.slice();if(!_.length)for(var x=p.length+1,w=1;w<x;++w)_.push(w/x);if(p.unshift(s[0]),_.unshift(0),p.push(s[s.length-1]),_.push(1),e.fillGradientType===wa.LINEAR_VERTICAL){o=this.context.createLinearGradient(h/2,l,h/2,u+l);var M=r.fontProperties.fontSize+e.strokeThickness;for(w=0;w<n.length;w++){var C=r.lineHeight*(w-1)+M,G=r.lineHeight*w,Q=G;w>0&&C>G&&(Q=(G+C)/2);var nt=G+M,ct=r.lineHeight*(w+1),it=nt;w+1<n.length&&ct<nt&&(it=(nt+ct)/2);for(var mt=(it-Q)/u,lt=0;lt<p.length;lt++){var gt=0;gt=typeof _[lt]=="number"?_[lt]:lt/p.length;var Ut=Math.min(1,Math.max(0,Q/u+gt*mt));Ut=Number(Ut.toFixed(5)),o.addColorStop(Ut,p[lt])}}}else{o=this.context.createLinearGradient(l,u/2,h+l,u/2);var Ft=p.length+1,Mt=1;for(w=0;w<p.length;w++){var At=void 0;At=typeof _[w]=="number"?_[w]:Mt/Ft,o.addColorStop(At,p[w]),Mt++}}return o},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},eb,e),i.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof ks?e:new ks(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t.experimentalLetterSpacing=!1,t}(di);/*!
 * @pixi/prepare - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */yr.b.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Tf=function(i,t){return(Tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},nb=function(){function i(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return i.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},i.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},i}();function ib(i,t){var e=!1;if(i&&i._textures&&i._textures.length){for(var n=0;n<i._textures.length;n++)if(i._textures[n]instanceof ce.t){var r=i._textures[n].baseTexture;t.indexOf(r)===-1&&(t.push(r),e=!0)}}return e}function rb(i,t){if(i.baseTexture instanceof ce.c){var e=i.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function ob(i,t){if(i._texture&&i._texture instanceof ce.t){var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function sb(i,t){return t instanceof Du&&(t.updateText(!0),!0)}function ab(i,t){if(t instanceof ks){var e=t.toFontString();return Zr.measureFont(e),!0}return!1}function lb(i,t){if(i instanceof Du){t.indexOf(i.style)===-1&&t.push(i.style),t.indexOf(i)===-1&&t.push(i);var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function hb(i,t){return i instanceof ks&&(t.indexOf(i)===-1&&t.push(i),!0)}var wf=function(){function i(t){var e=this;this.limiter=new nb(yr.b.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(lb),this.registerFindHook(hb),this.registerFindHook(ib),this.registerFindHook(rb),this.registerFindHook(ob),this.registerUploadHook(sb),this.registerUploadHook(ab)}return i.prototype.upload=function(t,e){typeof t=="function"&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,tr.a.system.addOnce(this.tick,this,tr.c.UTILITY))):e&&e()},i.prototype.tick=function(){setTimeout(this.delayedTick,0)},i.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed){for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)tr.a.system.addOnce(this.tick,this,tr.c.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);for(this.completes.length=0,n=0,r=o.length;n<r;n++)o[n]()}},i.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},i.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},i.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Cn.b)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},i.prototype.destroy=function(){this.ticking&&tr.a.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},i}();function Ef(i,t){return t instanceof ce.c&&(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0)}function ub(i,t){if(!(t instanceof er))return!1;var e=t.geometry;t.finishPoly(),e.updateBatches();for(var n=e.batches,r=0;r<n.length;r++){var o=n[r].style.texture;o&&Ef(i,o.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function cb(i,t){return i instanceof er&&(t.push(i),!0)}var db=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(cb),n.registerUploadHook(Ef),n.registerUploadHook(ub),n}return function(e,n){function r(){this.constructor=e}Tf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(wf),Sf=function(){function i(t,e,n){n===void 0&&(n=null),this._texture=t instanceof ce.t?t:null,this.baseTexture=t instanceof ce.c?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i.prototype._updateResolution=function(t){t===void 0&&(t=null);var e=this.data.meta.scale,n=Object(xn.getResolutionOfUrl)(t,null);return n===null&&(n=e!==void 0?parseFloat(e):1),n!==1&&this.baseTexture.setResolution(n),n},i.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=i.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},i.prototype._processFrames=function(t){for(var e=t,n=i.BATCH_SIZE;e-t<n&&e<this._frameKeys.length;){var r=this._frameKeys[e],o=this._frames[r],s=o.frame;if(s){var a=null,l=null,h=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new De.j(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a=o.rotated?new De.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new De.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(l=new De.j(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new ce.t(this.baseTexture,a,u,l,o.rotated?2:0,o.anchor),ce.t.addToCache(this.textures[r],r)}e++}},i.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},i.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},i.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*i.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*i.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},i.prototype.destroy=function(t){var e;for(var n in t===void 0&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},i.BATCH_SIZE=1e3,i}(),pb=function(){function i(){}return i.use=function(t,e){var n,r,o=this,s=t.name+"_image";if(t.data&&t.type===Si.TYPE.JSON&&t.data.frames&&!o.resources[s]){var a=(r=(n=t.data)===null||n===void 0?void 0:n.meta)===null||r===void 0?void 0:r.related_multi_packs;if(Array.isArray(a))for(var l=function(x){if(typeof x!="string")return"continue";var w=x.replace(".json",""),M=xn.url.resolve(t.url.replace(o.baseUrl,""),x);if(o.resources[w]||Object.values(o.resources).some(function(G){return xn.url.format(xn.url.parse(G.url))===M}))return"continue";var C={crossOrigin:t.crossOrigin,loadType:Si.LOAD_TYPE.XHR,xhrType:Si.XHR_RESPONSE_TYPE.JSON,parentResource:t,metadata:t.metadata};o.add(w,M,C)},h=0,u=a;h<u.length;h++)l(u[h]);var p={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},_=i.getResourcePath(t,o.baseUrl);o.add(s,_,p,function(x){if(x.error)e(x.error);else{var w=new Sf(x.texture,t.data,t.url);w.parse(function(){t.spritesheet=w,t.textures=w.textures,e()})}})}else e()},i.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:xn.url.resolve(t.url.replace(e,""),t.data.meta.image)},i}(),Af=function(i,t){return(Af=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Mf(i,t){function e(){this.constructor=i}Af(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Sa=new De.g,fb=function(i){function t(e,n,r){n===void 0&&(n=100),r===void 0&&(r=100);var o=i.call(this,e)||this;return o.tileTransform=new De.m,o._width=n,o._height=r,o.uvMatrix=o.texture.uvMatrix||new ce.u(e),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return Mf(t,i),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var n=this._texture;n&&n.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,n=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),o=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,n,r,o)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Sa);var n=this._width,r=this._height,o=-n*this.anchor._x;if(Sa.x>=o&&Sa.x<o+n){var s=-r*this.anchor._y;if(Sa.y>=s&&Sa.y<s+r)return!0}return!1},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,n){return new t(e instanceof ce.t?e:ce.t.from(e,n),n.width,n.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(di),Cf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Hl=new De.d,mb=function(i){function t(e){var n=i.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new ce.o,n.state=ce.s.for2d(),n}return Mf(t,i),t.prototype.contextChange=function(){var e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=ce.r.from(Cf,`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,n),this.shader=e.context.webGLVersion>1?ce.r.from(`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,n):ce.r.from(Cf,`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,n)},t.prototype.render=function(e){var n=this.renderer,r=this.quad,o=r.vertices;o[0]=o[6]=e._width*-e.anchor.x,o[1]=o[3]=e._height*-e.anchor.y,o[2]=o[4]=e._width*(1-e.anchor.x),o[5]=o[7]=e._height*(1-e.anchor.y);var s=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;(o=r.uvs)[0]=o[6]=-s,o[1]=o[3]=-a,o[2]=o[4]=1-s,o[5]=o[7]=1-a,r.invalidate();var l=e._texture,h=l.baseTexture,u=e.tileTransform.localTransform,p=e.uvMatrix,_=h.isPowerOfTwo&&l.frame.width===h.width&&l.frame.height===h.height;_&&(h._glTextures[n.CONTEXT_UID]?_=h.wrapMode!==gn.s.CLAMP:h.wrapMode===gn.s.CLAMP&&(h.wrapMode=gn.s.REPEAT));var x=_?this.simpleShader:this.shader,w=l.width,M=l.height,C=e._width,G=e._height;Hl.set(u.a*w/C,u.b*w/G,u.c*M/C,u.d*M/G,u.tx/C,u.ty/G),Hl.invert(),_?Hl.prepend(p.mapCoord):(x.uniforms.uMapCoord=p.mapCoord.toArray(!0),x.uniforms.uClampFrame=p.uClampFrame,x.uniforms.uClampOffset=p.uClampOffset),x.uniforms.uTransform=Hl.toArray(!0),x.uniforms.uColor=Object(xn.premultiplyTintToRgba)(e.tint,e.worldAlpha,x.uniforms.uColor,h.alphaMode),x.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),x.uniforms.uSampler=l,n.shader.bind(x),n.geometry.bind(r),this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(ce.m),Us=v(8),Rf=function(i,t){return(Rf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},jl=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},gb=function(){function i(){}return i.test=function(t){return typeof t=="string"&&t.indexOf("info face=")===0},i.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in e){var o=e[r].match(/^[a-z]+/gm)[0],s=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in s){var h=s[l].split("="),u=h[0],p=h[1].replace(/"/gm,""),_=parseFloat(p),x=isNaN(_)?p:_;a[u]=x}n[o].push(a)}var w=new jl;return n.info.forEach(function(M){return w.info.push({face:M.face,size:parseInt(M.size,10)})}),n.common.forEach(function(M){return w.common.push({lineHeight:parseInt(M.lineHeight,10)})}),n.page.forEach(function(M){return w.page.push({id:parseInt(M.id,10),file:M.file})}),n.char.forEach(function(M){return w.char.push({id:parseInt(M.id,10),page:parseInt(M.page,10),x:parseInt(M.x,10),y:parseInt(M.y,10),width:parseInt(M.width,10),height:parseInt(M.height,10),xoffset:parseInt(M.xoffset,10),yoffset:parseInt(M.yoffset,10),xadvance:parseInt(M.xadvance,10)})}),n.kerning.forEach(function(M){return w.kerning.push({first:parseInt(M.first,10),second:parseInt(M.second,10),amount:parseInt(M.amount,10)})}),n.distanceField.forEach(function(M){return w.distanceField.push({distanceRange:parseInt(M.distanceRange,10),fieldType:M.fieldType})}),w},i}(),Fu=function(){function i(){}return i.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},i.parse=function(t){for(var e=new jl,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField"),h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<r.length;h++)e.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(h=0;h<o.length;h++)e.page.push({id:parseInt(o[h].getAttribute("id"),10)||0,file:o[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<a.length;h++)e.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(h=0;h<l.length;h++)e.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return e},i}(),vb=function(){function i(){}return i.test=function(t){if(typeof t=="string"&&t.indexOf("<font>")>-1){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return Fu.test(e)}return!1},i.parse=function(t){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return Fu.parse(e)},i}(),Bu=[gb,Fu,vb];function If(i){for(var t=0;t<Bu.length;t++)if(Bu[t].test(i))return Bu[t];return null}function _b(i,t,e,n,r,o,s){var a=e.text,l=e.fontProperties;t.translate(n,r),t.scale(o,o);var h=s.strokeThickness/2,u=-s.strokeThickness/2;if(t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=function(M,C,G,Q,nt,ct){var it,mt=G.fill;if(!Array.isArray(mt))return mt;if(mt.length===1)return mt[0];var lt=G.dropShadow?G.dropShadowDistance:0,gt=G.padding||0,Ut=M.width/Q-lt-2*gt,Ft=M.height/Q-lt-2*gt,Mt=mt.slice(),At=G.fillGradientStops.slice();if(!At.length)for(var Ot=Mt.length+1,Lt=1;Lt<Ot;++Lt)At.push(Lt/Ot);if(Mt.unshift(mt[0]),At.unshift(0),Mt.push(mt[mt.length-1]),At.push(1),G.fillGradientType===wa.LINEAR_VERTICAL){it=C.createLinearGradient(Ut/2,gt,Ut/2,Ft+gt);var ne=0,$t=(ct.fontProperties.fontSize+G.strokeThickness)/Ft;for(Lt=0;Lt<nt.length;Lt++)for(var zt=ct.lineHeight*Lt,Yt=0;Yt<Mt.length;Yt++){var ge=zt/Ft+(typeof At[Yt]=="number"?At[Yt]:Yt/Mt.length)*$t,be=Math.max(ne,ge);be=Math.min(be,1),it.addColorStop(be,Mt[Yt]),ne=be}}else{it=C.createLinearGradient(gt,Ft/2,Ut+gt,Ft/2);var Pe=Mt.length+1,Ct=1;for(Lt=0;Lt<Mt.length;Lt++){var Bt=void 0;Bt=typeof At[Lt]=="number"?At[Lt]:Ct/Pe,it.addColorStop(Bt,Mt[Lt]),Ct++}}return it}(i,t,s,o,[a],e),t.strokeStyle=s.stroke,s.dropShadow){var p=s.dropShadowColor,_=Object(xn.hex2rgb)(typeof p=="number"?p:Object(xn.string2hex)(p)),x=s.dropShadowBlur*o,w=s.dropShadowDistance*o;t.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+s.dropShadowAlpha+")",t.shadowBlur=x,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*w,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*w}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;s.stroke&&s.strokeThickness&&t.strokeText(a,h,u+e.lineHeight-l.descent),s.fill&&t.fillText(a,h,u+e.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Pf(i){return Array.from?Array.from(i):i.split("")}function zl(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}var Gs=function(){function i(t,e,n){var r,o,s=t.info[0],a=t.common[0],l=t.page[0],h=t.distanceField[0],u=Object(xn.getResolutionOfUrl)(l.file),p={};this._ownsTextures=n,this.font=s.face,this.size=s.size,this.lineHeight=a.lineHeight/u,this.chars={},this.pageTextures=p;for(var _=0;_<t.page.length;_++){var x=t.page[_],w=x.id,M=x.file;p[w]=e instanceof Array?e[_]:e[M],(h==null?void 0:h.fieldType)&&h.fieldType!=="none"&&(p[w].baseTexture.alphaMode=gn.a.NO_PREMULTIPLIED_ALPHA)}for(_=0;_<t.char.length;_++){var C=t.char[_],G=(w=C.id,C.page),Q=t.char[_],nt=Q.x,ct=Q.y,it=Q.width,mt=Q.height,lt=Q.xoffset,gt=Q.yoffset,Ut=Q.xadvance;nt/=u,ct/=u,it/=u,mt/=u,lt/=u,gt/=u,Ut/=u;var Ft=new De.j(nt+p[G].frame.x/u,ct+p[G].frame.y/u,it,mt);this.chars[w]={xOffset:lt,yOffset:gt,xAdvance:Ut,kerning:{},texture:new ce.t(p[G].baseTexture,Ft),page:G}}for(_=0;_<t.kerning.length;_++){var Mt=t.kerning[_],At=Mt.first,Ot=Mt.second,Lt=Mt.amount;At/=u,Ot/=u,Lt/=u,this.chars[Ot]&&(this.chars[Ot].kerning[At]=Lt)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=(o=(r=h==null?void 0:h.fieldType)===null||r===void 0?void 0:r.toLowerCase())!==null&&o!==void 0?o:"none"}return i.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},i.install=function(t,e,n){var r;if(t instanceof jl)r=t;else{var o=If(t);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(t)}e instanceof ce.t&&(e=[e]);var s=new i(r,e,n);return i.available[s.font]=s,s},i.uninstall=function(t){var e=i.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete i.available[t]},i.from=function(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},i.defaultOptions,n),o=r.chars,s=r.padding,a=r.resolution,l=r.textureWidth,h=r.textureHeight,u=function(ge){typeof ge=="string"&&(ge=[ge]);for(var be=[],Pe=0,Ct=ge.length;Pe<Ct;Pe++){var Bt=ge[Pe];if(Array.isArray(Bt)){if(Bt.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+Bt.length+".");var ve=Bt[0].charCodeAt(0),le=Bt[1].charCodeAt(0);if(le<ve)throw new Error("[BitmapFont]: Invalid character range.");for(var se=ve,Ie=le;se<=Ie;se++)be.push(String.fromCharCode(se))}else be.push.apply(be,Pf(Bt))}if(be.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return be}(o),p=e instanceof ks?e:new ks(e),_=l,x=new jl;x.info[0]={face:p.fontFamily,size:p.fontSize},x.common[0]={lineHeight:p.fontSize};for(var w,M,C,G=0,Q=0,nt=0,ct=[],it=0;it<u.length;it++){w||((w=document.createElement("canvas")).width=l,w.height=h,M=w.getContext("2d"),C=new ce.c(w,{resolution:a}),ct.push(new ce.t(C)),x.page.push({id:ct.length-1,file:""}));var mt=Zr.measureText(u[it],p,!1,w),lt=mt.width,gt=Math.ceil(mt.height),Ut=Math.ceil((p.fontStyle==="italic"?2:1)*lt);if(Q>=h-gt*a){if(Q===0)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+p.fontSize+"px fonts");--it,w=null,M=null,C=null,Q=0,G=0,nt=0}else if(nt=Math.max(gt+mt.fontProperties.descent,nt),Ut*a+G>=_)--it,Q+=nt*a,Q=Math.ceil(Q),G=0,nt=0;else{_b(w,M,mt,G,Q,a,p);var Ft=zl(mt.text);x.char.push({id:Ft,page:ct.length-1,x:G/a,y:Q/a,width:Ut,height:gt,xoffset:0,yoffset:0,xadvance:Math.ceil(lt-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0))}),G+=(Ut+2*s)*a,G=Math.ceil(G)}}it=0;for(var Mt=u.length;it<Mt;it++)for(var At=u[it],Ot=0;Ot<Mt;Ot++){var Lt=u[Ot],ne=M.measureText(At).width,$t=M.measureText(Lt).width,zt=M.measureText(At+Lt).width-(ne+$t);zt&&x.kerning.push({first:zl(At),second:zl(Lt),amount:zt})}var Yt=new i(x,ct,!0);return i.available[t]!==void 0&&i.uninstall(t),i.available[t]=Yt,Yt},i.ALPHA=[["a","z"],["A","Z"]," "],i.NUMERIC=[["0","9"]],i.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],i.ASCII=[[" ","~"]],i.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:i.ALPHANUMERIC},i.available={},i}(),yb=[],xb=[],Of=[],bb=(function(i){function t(e,n){n===void 0&&(n={});var r=i.call(this)||this;r._tint=16777215;var o=Object.assign({},t.styleDefaults,n),s=o.align,a=o.tint,l=o.maxWidth,h=o.letterSpacing,u=o.fontName,p=o.fontSize;if(!Gs.available[u])throw new Error('Missing BitmapFont "'+u+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=s,r._tint=a,r._fontName=u,r._fontSize=p||Gs.available[u].size,r.text=e,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=h,r._anchor=new De.e(function(){r.dirty=!0},r,0,0),r._roundPixels=yr.b.ROUND_PIXELS,r.dirty=!0,r._resolution=yr.b.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}(function(e,n){function r(){this.constructor=e}Rf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)})(t,i),t.prototype.updateText=function(){for(var e,n=Gs.available[this._fontName],r=this._fontSize/n.size,o=new De.g,s=[],a=[],l=[],h=Pf(this._text.replace(/(?:\r\n|\r)/g,`
`)||" "),u=this._maxWidth*n.size/this._fontSize,p=n.distanceFieldType==="none"?yb:xb,_=null,x=0,w=0,M=0,C=-1,G=0,Q=0,nt=0,ct=0,it=0;it<h.length;it++){var mt=zl(se=h[it]);if(/(?:\s)/.test(se)&&(C=it,G=x,ct++),se!=="\r"&&se!==`
`){var lt=n.chars[mt];if(lt){_&&lt.kerning[_]&&(o.x+=lt.kerning[_]);var gt=Of.pop()||{texture:ce.t.EMPTY,line:0,charCode:0,prevSpaces:0,position:new De.g};gt.texture=lt.texture,gt.line=M,gt.charCode=mt,gt.position.x=o.x+lt.xOffset+this._letterSpacing/2,gt.position.y=o.y+lt.yOffset,gt.prevSpaces=ct,s.push(gt),x=gt.position.x+Math.max(lt.xAdvance,lt.texture.orig.width),o.x+=lt.xAdvance+this._letterSpacing,nt=Math.max(nt,lt.yOffset+lt.texture.height),_=mt,C!==-1&&u>0&&o.x>u&&(++Q,Object(xn.removeItems)(s,1+C-Q,1+it-C),it=C,C=-1,a.push(G),l.push(s.length>0?s[s.length-1].prevSpaces:0),w=Math.max(w,G),M++,o.x=0,o.y+=n.lineHeight,_=null,ct=0)}}else a.push(x),l.push(-1),w=Math.max(w,x),++M,++Q,o.x=0,o.y+=n.lineHeight,_=null,ct=0}var Ut=h[h.length-1];Ut!=="\r"&&Ut!==`
`&&(/(?:\s)/.test(Ut)&&(x=G),a.push(x),w=Math.max(w,x),l.push(-1));var Ft=[];for(it=0;it<=M;it++){var Mt=0;this._align==="right"?Mt=w-a[it]:this._align==="center"?Mt=(w-a[it])/2:this._align==="justify"&&(Mt=l[it]<0?0:(w-a[it])/l[it]),Ft.push(Mt)}var At=s.length,Ot={},Lt=[],ne=this._activePagesMeshData;for(it=0;it<ne.length;it++)p.push(ne[it]);for(it=0;it<At;it++){var $t=(Le=s[it].texture).baseTexture.uid;if(!Ot[$t]){if(!(ye=p.pop())){var zt=new Us.b,Yt=void 0,ge=void 0;n.distanceFieldType==="none"?(Yt=new Us.c(ce.t.EMPTY),ge=gn.b.NORMAL):(Yt=new Us.c(ce.t.EMPTY,{program:ce.n.from(`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`),uniforms:{uFWidth:0}}),ge=gn.b.NORMAL_NPM);var be=new Us.a(zt,Yt);be.blendMode=ge,ye={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:be,vertices:null,uvs:null,indices:null}}ye.index=0,ye.indexCount=0,ye.vertexCount=0,ye.uvsCount=0,ye.total=0;var Pe=this._textureCache;Pe[$t]=Pe[$t]||new ce.t(Le.baseTexture),ye.mesh.texture=Pe[$t],ye.mesh.tint=this._tint,Lt.push(ye),Ot[$t]=ye}Ot[$t].total++}for(it=0;it<ne.length;it++)Lt.indexOf(ne[it])===-1&&this.removeChild(ne[it].mesh);for(it=0;it<Lt.length;it++)Lt[it].mesh.parent!==this&&this.addChild(Lt[it].mesh);for(var it in this._activePagesMeshData=Lt,Ot){var Ct=(ye=Ot[it]).total;if(!(((e=ye.indices)===null||e===void 0?void 0:e.length)>6*Ct)||ye.vertices.length<2*Us.a.BATCHABLE_SIZE)ye.vertices=new Float32Array(8*Ct),ye.uvs=new Float32Array(8*Ct),ye.indices=new Uint16Array(6*Ct);else for(var Bt=ye.total,ve=ye.vertices,le=4*Bt*2;le<ve.length;le++)ve[le]=0;ye.mesh.size=6*Ct}for(it=0;it<At;it++){var se,Ie=(se=s[it]).position.x+Ft[se.line]*(this._align==="justify"?se.prevSpaces:1);this._roundPixels&&(Ie=Math.round(Ie));var Le,ue=Ie*r,bt=se.position.y*r,jt=Ot[(Le=se.texture).baseTexture.uid],ie=Le.frame,ae=Le._uvs,qt=jt.index++;jt.indices[6*qt+0]=0+4*qt,jt.indices[6*qt+1]=1+4*qt,jt.indices[6*qt+2]=2+4*qt,jt.indices[6*qt+3]=0+4*qt,jt.indices[6*qt+4]=2+4*qt,jt.indices[6*qt+5]=3+4*qt,jt.vertices[8*qt+0]=ue,jt.vertices[8*qt+1]=bt,jt.vertices[8*qt+2]=ue+ie.width*r,jt.vertices[8*qt+3]=bt,jt.vertices[8*qt+4]=ue+ie.width*r,jt.vertices[8*qt+5]=bt+ie.height*r,jt.vertices[8*qt+6]=ue,jt.vertices[8*qt+7]=bt+ie.height*r,jt.uvs[8*qt+0]=ae.x0,jt.uvs[8*qt+1]=ae.y0,jt.uvs[8*qt+2]=ae.x1,jt.uvs[8*qt+3]=ae.y1,jt.uvs[8*qt+4]=ae.x2,jt.uvs[8*qt+5]=ae.y2,jt.uvs[8*qt+6]=ae.x3,jt.uvs[8*qt+7]=ae.y3}for(var it in this._textWidth=w*r,this._textHeight=(o.y+n.lineHeight)*r,Ot){var ye=Ot[it];if(this.anchor.x!==0||this.anchor.y!==0)for(var nn=0,on=this._textWidth*this.anchor.x,rn=this._textHeight*this.anchor.y,En=0;En<ye.total;En++)ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn;this._maxLineHeight=nt*r;var Ai=ye.mesh.geometry.getBuffer("aVertexPosition"),Jn=ye.mesh.geometry.getBuffer("aTextureCoord"),dr=ye.mesh.geometry.getIndex();Ai.data=ye.vertices,Jn.data=ye.uvs,dr.data=ye.indices,Ai.update(),Jn.update(),dr.update()}for(it=0;it<s.length;it++)Of.push(s[it])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=Gs.available[this._fontName],r=n.distanceFieldRange,o=n.distanceFieldType,s=n.size;if(o!=="none")for(var a=this.worldTransform,l=a.a,h=a.b,u=a.c,p=a.d,_=Math.sqrt(l*l+h*h),x=Math.sqrt(u*u+p*p),w=(Math.abs(_)+Math.abs(x))/2,M=this._fontSize/s,C=0,G=this._activePagesMeshData;C<G.length;C++)G[C].mesh.shader.uniforms.uFWidth=w*r*M*this._resolution;i.prototype._render.call(this,e)},t.prototype.getLocalBounds=function(){return this.validate(),i.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Gs.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){var n=this._textureCache;for(var r in n)n[r].destroy(),delete n[r];this._textureCache=null,i.prototype.destroy.call(this,e)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(Cn.b),function(){function i(){}return i.add=function(){Si.setExtensionXhrType("fnt",Si.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){var n=If(t.data);if(n)for(var r=i.getBaseUrl(this,t),o=n.parse(t.data),s={},a=function(M){s[M.metadata.pageFile]=M.texture,Object.keys(s).length===o.page.length&&(t.bitmapFont=Gs.install(o,s,!0),e())},l=0;l<o.page.length;++l){var h=o.page[l].file,u=r+h,p=!1;for(var _ in this.resources){var x=this.resources[_];if(x.url===u){x.metadata.pageFile=h,x.texture?a(x):x.onAfterMiddleware.add(a),p=!0;break}}if(!p){var w={crossOrigin:t.crossOrigin,loadType:Si.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(u,w,a)}}else e()},i.getBaseUrl=function(t,e){var n=e.isDataUrl?"":i.dirname(e.url);return e.isDataUrl&&(n==="."&&(n=""),t.baseUrl&&n&&t.baseUrl.charAt(t.baseUrl.length-1)==="/"&&(n+="/")),(n=n.replace(t.baseUrl,""))&&n.charAt(n.length-1)!=="/"&&(n+="/"),n},i.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":e===""?"/":e},i}()),Nf=function(i,t){return(Nf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Tb=function(i){function t(e){e===void 0&&(e=1);var n=i.call(this,ce.A,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return n.alpha=e,n}return function(e,n){function r(){this.constructor=e}Nf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ce.k),Lf=function(i,t){return(Lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Df(i,t){function e(){this.constructor=i}Lf(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Ff,Bf,kf,Uf,Gf,Hf,jf,zf,Vf,Wf,Xf,Yf,qf,Aa,Jf,Zf,Kf,Qf,$f,wb={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Eb=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(Ff||(Ff={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(Bf||(Bf={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(kf||(kf={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Uf||(Uf={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Gf||(Gf={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Hf||(Hf={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(jf||(jf={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(zf||(zf={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Vf||(Vf={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Wf||(Wf={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Xf||(Xf={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(Yf||(Yf={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(qf||(qf={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Aa||(Aa={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Jf||(Jf={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Zf||(Zf={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Kf||(Kf={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Qf||(Qf={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}($f||($f={}));var ku=function(i){function t(e,n,r,o,s){n===void 0&&(n=8),r===void 0&&(r=4),o===void 0&&(o=yr.b.FILTER_RESOLUTION),s===void 0&&(s=5);var a=this,l=function(u,p){var _,x=Math.ceil(u/2),w=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,M="";_=p?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var C=0;C<u;C++){var G=_.replace("%index%",C.toString());M+=G=G.replace("%sampleIndex%",C-(x-1)+".0"),M+=`
`}return w=(w=w.replace("%blur%",M)).replace("%size%",u.toString())}(s,e),h=function(u){for(var p,_=wb[u],x=_.length,w=Eb,M="",C=0;C<u;C++){var G="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",C.toString());p=C,C>=x&&(p=u-C-1),M+=G=G.replace("%value%",_[p].toString()),M+=`
`}return w=(w=w.replace("%blur%",M)).replace("%size%",u.toString())}(s);return(a=i.call(this,l,h)||this).horizontal=e,a.resolution=o,a._quality=0,a.quality=r,a.blur=n,a}return Df(t,i),t.prototype.apply=function(e,n,r,o){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/n.width):this.uniforms.strength=1/r.height*(r.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,r,o);else{var s=e.getFilterTexture(),a=e.renderer,l=n,h=s;this.state.blend=!1,e.applyFilter(this,l,h,Aa.CLEAR);for(var u=1;u<this.passes-1;u++){e.bindAndClear(l,Aa.BLIT),this.uniforms.uSampler=h;var p=h;h=l,l=p,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,r,o),e.returnFilterTexture(s)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(ce.k),Sb=function(i){function t(e,n,r,o){e===void 0&&(e=8),n===void 0&&(n=4),r===void 0&&(r=yr.b.FILTER_RESOLUTION),o===void 0&&(o=5);var s=i.call(this)||this;return s.blurXFilter=new ku(!0,e,n,r,o),s.blurYFilter=new ku(!1,e,n,r,o),s.resolution=r,s.quality=n,s.blur=e,s.repeatEdgePixels=!1,s}return Df(t,i),t.prototype.apply=function(e,n,r,o){var s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){var l=e.getFilterTexture();this.blurXFilter.apply(e,n,l,Aa.CLEAR),this.blurYFilter.apply(e,l,r,o),e.returnFilterTexture(l)}else a?this.blurYFilter.apply(e,n,r,o):this.blurXFilter.apply(e,n,r,o)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),t}(ce.k),tm=function(i,t){return(tm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Uu=function(i){function t(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=i.call(this,ce.z,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,n)||this).alpha=1,e}return function(e,n){function r(){this.constructor=e}tm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._loadMatrix=function(e,n){n===void 0&&(n=!1);var r=e;n&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e},t.prototype._colorMatrix=function(e){var n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},t.prototype.brightness=function(e,n){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.tint=function(e,n){var r=[(e>>16&255)/255,0,0,0,0,0,(e>>8&255)/255,0,0,0,0,0,(255&e)/255,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.greyscale=function(e,n){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,n){e=(e||0)/180*Math.PI;var r=Math.cos(e),o=Math.sin(e),s=1/3,a=(0,Math.sqrt)(s),l=[r+(1-r)*s,s*(1-r)-a*o,s*(1-r)+a*o,0,0,s*(1-r)+a*o,r+s*(1-r),s*(1-r)-a*o,0,0,s*(1-r)-a*o,s*(1-r)+a*o,r+s*(1-r),0,0,0,0,0,1,0];this._loadMatrix(l,n)},t.prototype.contrast=function(e,n){var r=(e||0)+1,o=-.5*(r-1),s=[r,0,0,0,o,0,r,0,0,o,0,0,r,0,o,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.saturate=function(e,n){e===void 0&&(e=0);var r=2*e/3+1,o=-.5*(r-1),s=[r,o,o,0,0,o,r,o,0,0,o,o,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,n,r,o,s){var a=((r=r||16770432)>>16&255)/255,l=(r>>8&255)/255,h=(255&r)/255,u=((o=o||3375104)>>16&255)/255,p=(o>>8&255)/255,_=(255&o)/255,x=[.3,.59,.11,0,0,a,l,h,e=e||.2,0,u,p,_,n=n||.15,0,a-u,l-p,h-_,0,0];this._loadMatrix(x,s)},t.prototype.night=function(e,n){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.predator=function(e,n){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ce.k);Uu.prototype.grayscale=Uu.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var em=function(i,t){return(em=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Ab=function(i){function t(e,n){var r=this,o=new De.d;return e.renderable=!1,(r=i.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:e._texture,filterMatrix:o,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=o,n==null&&(n=20),r.scale=new De.g(n,n),r}return function(e,n){function r(){this.constructor=e}em(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.apply=function(e,n,r,o){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var s=this.maskSprite.worldTransform,a=Math.sqrt(s.a*s.a+s.b*s.b),l=Math.sqrt(s.c*s.c+s.d*s.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=s.a/a,this.uniforms.rotation[1]=s.b/a,this.uniforms.rotation[2]=s.c/l,this.uniforms.rotation[3]=s.d/l),e.applyFilter(this,n,r,o)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),t}(ce.k),nm=function(i,t){return(nm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Mb=function(i){function t(){return i.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(e,n){function r(){this.constructor=e}nm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(ce.k),im=function(i,t){return(im=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},rm,om,sm,am,lm,hm,um,cm,dm,pm,fm,mm,gm,vm,_m,ym,xm,Gu,bm,Cb=function(i){function t(e,n){e===void 0&&(e=.5),n===void 0&&(n=Math.random());var r=i.call(this,ce.z,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=n,r}return function(e,n){function r(){this.constructor=e}im(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t}(ce.k);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(rm||(rm={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(om||(om={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(sm||(sm={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(am||(am={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(lm||(lm={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(hm||(hm={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(um||(um={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(cm||(cm={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(dm||(dm={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(pm||(pm={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(fm||(fm={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(mm||(mm={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(gm||(gm={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(vm||(vm={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(_m||(_m={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(ym||(ym={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(xm||(xm={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Gu||(Gu={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(bm||(bm={}));var Tm=new De.d;Cn.c.prototype._cacheAsBitmap=!1,Cn.c.prototype._cacheData=null,Cn.c.prototype._cacheAsBitmapResolution=null,Cn.c.prototype._cacheAsBitmapMultisample=Gu.NONE;var Rb=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Cn.c.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(i){var t;this._cacheAsBitmap!==i&&(this._cacheAsBitmap=i,i?(this._cacheData||(this._cacheData=new Rb),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),Cn.c.prototype._renderCached=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))},Cn.c.prototype._initCachedDisplayObject=function(i){var t;if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,i.batch.flush();var n=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;n.pad(r)}n.ceil(yr.b.RESOLUTION);var o=i.renderTexture.current,s=i.renderTexture.sourceFrame.clone(),a=i.renderTexture.destinationFrame.clone(),l=i.projection.transform,h=ce.p.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||i.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:i.multisample}),u="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=u,ce.c.addToCache(h.baseTexture,u),ce.t.addToCache(h,u);var p=this.transform.localTransform.copyTo(Tm).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:h,clear:!0,transform:p,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=l,i.renderTexture.bind(o,s,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var _=new di(h);_.transform.worldTransform=this.transform.worldTransform,_.anchor.x=-n.x/n.width,_.anchor.y=-n.y/n.height,_.alpha=e,_._bounds=this._bounds,this._cacheData.sprite=_,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=_.containsPoint.bind(_)}},Cn.c.prototype._renderCachedCanvas=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))},Cn.c.prototype._initCachedDisplayObjectCanvas=function(i){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var n=i.context,r=i._projTransform;t.ceil(yr.b.RESOLUTION);var o=ce.p.create({width:t.width,height:t.height}),s="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=s,ce.c.addToCache(o.baseTexture,s),ce.t.addToCache(o,s);var a=Tm;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),i.context=n,i._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var l=new di(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},Cn.c.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Cn.c.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Cn.c.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ce.c.removeFromCache(this._cacheData.textureCacheId),ce.t.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Cn.c.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)},Cn.c.prototype.name=null,Cn.b.prototype.getChildByName=function(i,t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].name===i)return this.children[e];if(t){for(e=0,n=this.children.length;e<n;e++)if(this.children[e].getChildByName){var r=this.children[e].getChildByName(i,!0);if(r)return r}}return null},Cn.c.prototype.getGlobalPosition=function(i,t){return i===void 0&&(i=new De.g),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var Ib=v(16),wm=(v(12),function(i,t){return(wm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)}),Vl=function(i){function t(e,n){n===void 0&&(n=!0);var r=i.call(this,e[0]instanceof ce.t?e[0]:e[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=n,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=e,r}return function(e,n){function r(){this.constructor=e}wm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(tr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(tr.a.shared.add(this.update,this,tr.c.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var n=this.animationSpeed*e,r=this.currentFrame;if(this._durations!==null){var o=this._currentTime%1*this._durations[this.currentFrame];for(o+=n/60*1e3;o<0;)this._currentTime--,o+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);o>=this._durations[this.currentFrame];)o-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=o/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(e){this.stop(),i.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ce.t.from(e[r]));return new t(n)},t.fromImages=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ce.t.from(e[r]));return new t(n)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof ce.t)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(tr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(tr.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),t}(di);/*!
 * pixi.js - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ce.q.registerPlugin("accessibility",np),ce.q.registerPlugin("extract",lx),ce.q.registerPlugin("interaction",op),ce.q.registerPlugin("particle",zx),ce.q.registerPlugin("prepare",db),ce.q.registerPlugin("batch",ce.f),ce.q.registerPlugin("tilingSprite",mb),qr.registerPlugin(bb),qr.registerPlugin(mx),qr.registerPlugin(Mx),qr.registerPlugin(Hx),qr.registerPlugin(pb),Pl.registerPlugin(tr.b),Pl.registerPlugin(dx);var Hu,Hs={AlphaFilter:Tb,BlurFilter:Sb,BlurFilterPass:ku,ColorMatrixFilter:Uu,DisplacementFilter:Ab,FXAAFilter:Mb,NoiseFilter:Cb},Gr=v(10),Pb=v(35),Em=function(){function i(){}return i.offsetPolygon=function(t,e){var n=[],r=t.length;e=i.isPolygonClockwise(t)?e:-1*e;for(var o=0;o<r;o+=2){var s=o-2;s<0&&(s+=r);var a=(o+2)%r,l=t[o]-t[s],h=t[o+1]-t[s+1],u=Math.sqrt(l*l+h*h);l/=u,h/=u;var p=-(h*=e),_=l*=e,x=[t[s]+p,t[s+1]+_],w=[t[o]+p,t[o+1]+_],M=t[a]-t[o],C=t[a+1]-t[o+1];M/=u=Math.sqrt(M*M+C*C),C/=u;var G=-(C*=e),Q=M*=e,nt=[t[o]+G,t[o+1]+Q],ct=[t[a]+G,t[a+1]+Q],it=i.findIntersection(x[0],x[1],w[0],w[1],nt[0],nt[1],ct[0],ct[1]);it&&n.push.apply(n,it)}return n},i.findIntersection=function(t,e,n,r,o,s,a,l){var h=(l-s)*(n-t)-(a-o)*(r-e),u=(a-o)*(e-s)-(l-s)*(t-o);if(h===0)return u===0&&(n-t)*(e-s)-(r-e)*(t-o)===0?[(t+n)/2,(e+r)/2]:null;var p=u/h;return[t+p*(n-t),e+p*(r-e)]},i.isPolygonClockwise=function(t){for(var e=0,n=0,r=t.length-2;n<t.length;r=n,n+=2)e+=(t[n]-t[r])*(t[n+1]+t[r+1]);return e>0},i}(),Ob=function(){function i(t){this._svgMatrix=null,this._tempMatrix=new De.d,this.renderer=t}return i.prototype._calcCanvasStyle=function(t,e){var n;return t.texture&&t.texture.baseTexture!==ce.t.WHITE.baseTexture?t.texture.valid?(n=Gr.b.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||De.d.IDENTITY)):n="#808080":n="#"+("00000"+(0|e).toString(16)).slice(-6),n},i.prototype.render=function(t){var e=this.renderer,n=e.context,r=t.worldAlpha,o=t.transform.worldTransform;e.setContextTransform(o),e.setBlendMode(t.blendMode);for(var s,a,l=t.geometry.graphicsData,h=(t.tint>>16&255)/255,u=(t.tint>>8&255)/255,p=(255&t.tint)/255,_=0;_<l.length;_++){var x=l[_],w=x.shape,M=x.fillStyle,C=x.lineStyle,G=0|x.fillStyle.color,Q=0|x.lineStyle.color;if(x.matrix&&e.setContextTransform(o.copyTo(this._tempMatrix).append(x.matrix)),M.visible){var nt=((G>>16&255)/255*h*255<<16)+((G>>8&255)/255*u*255<<8)+(255&G)/255*p*255;s=this._calcCanvasStyle(M,nt)}if(C.visible){var ct=((Q>>16&255)/255*h*255<<16)+((Q>>8&255)/255*u*255<<8)+(255&Q)/255*p*255;a=this._calcCanvasStyle(C,ct)}if(n.lineWidth=C.width,n.lineCap=C.cap,n.lineJoin=C.join,n.miterLimit=C.miterLimit,x.type===De.l.POLY){n.beginPath();var it=(Lt=w).points,mt=x.holes,lt=void 0,gt=void 0,Ut=void 0,Ft=void 0,Mt=void 0;n.moveTo(it[0],it[1]);for(var At=2;At<it.length;At+=2)n.lineTo(it[At],it[At+1]);if(Lt.closeStroke&&n.closePath(),mt.length>0){for(Mt=[],lt=0,Ut=it[0],Ft=it[1],At=2;At+2<it.length;At+=2)lt+=(it[At]-Ut)*(it[At+3]-Ft)-(it[At+2]-Ut)*(it[At+1]-Ft);for(var Ot=0;Ot<mt.length;Ot++)if(it=mt[Ot].shape.points){for(gt=0,Ut=it[0],Ft=it[1],At=2;At+2<it.length;At+=2)gt+=(it[At]-Ut)*(it[At+3]-Ft)-(it[At+2]-Ut)*(it[At+1]-Ft);if(gt*lt<0)for(n.moveTo(it[0],it[1]),At=2;At<it.length;At+=2)n.lineTo(it[At],it[At+1]);else for(n.moveTo(it[it.length-2],it[it.length-1]),At=it.length-4;At>=0;At-=2)n.lineTo(it[At],it[At+1]);mt[Ot].shape.closeStroke&&n.closePath(),Mt[Ot]=gt*lt<0}}M.visible&&(n.globalAlpha=M.alpha*r,n.fillStyle=s,n.fill()),C.visible&&this.paintPolygonStroke(Lt,C,a,mt,Mt,r,n)}else if(x.type===De.l.RECT){var Lt=w;if(M.visible&&(n.globalAlpha=M.alpha*r,n.fillStyle=s,n.fillRect(Lt.x,Lt.y,Lt.width,Lt.height)),C.visible){var ne=C.width*(.5-(1-C.alignment)),$t=Lt.width+2*ne,zt=Lt.height+2*ne;n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.strokeRect(Lt.x-ne,Lt.y-ne,$t,zt)}}else if(x.type===De.l.CIRC)Lt=w,n.beginPath(),n.arc(Lt.x,Lt.y,Lt.radius,0,2*Math.PI),n.closePath(),M.visible&&(n.globalAlpha=M.alpha*r,n.fillStyle=s,n.fill()),C.visible&&(C.alignment!==.5&&(ne=C.width*(.5-(1-C.alignment)),n.beginPath(),n.arc(Lt.x,Lt.y,Lt.radius+ne,0,2*Math.PI),n.closePath()),n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke());else if(x.type===De.l.ELIP){if(Lt=w,(Le=C.alignment===1)||this.paintEllipse(Lt,M,C,s,r,n),C.visible){if(C.alignment!==.5){ne=C.width*(.5-(1-C.alignment));var Yt=2*(Lt.width+ne),ge=2*(Lt.height+ne),be=Lt.x-Yt/2,Pe=Lt.y-ge/2,Ct=Yt/2*.5522848,Bt=ge/2*.5522848,ve=be+Yt,le=Pe+ge,se=be+Yt/2,Ie=Pe+ge/2;n.beginPath(),n.moveTo(be,Ie),n.bezierCurveTo(be,Ie-Bt,se-Ct,Pe,se,Pe),n.bezierCurveTo(se+Ct,Pe,ve,Ie-Bt,ve,Ie),n.bezierCurveTo(ve,Ie+Bt,se+Ct,le,se,le),n.bezierCurveTo(se-Ct,le,be,Ie+Bt,be,Ie),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}Le&&this.paintEllipse(Lt,M,C,s,r,n)}else if(x.type===De.l.RREC){var Le;if(Lt=w,(Le=C.alignment===1)||this.paintRoundedRectangle(Lt,M,C,s,r,n),C.visible){if(C.alignment!==.5){$t=Lt.width,zt=Lt.height,ne=C.width*(.5-(1-C.alignment));var ue=Lt.x-ne,bt=Lt.y-ne,jt=Lt.width+2*ne,ie=Lt.height+2*ne,ae=ne*(C.alignment>=1?Math.min(jt/$t,ie/zt):Math.min($t/jt,zt/ie)),qt=Lt.radius+ae,ye=Math.min(jt,ie)/2;qt=qt>ye?ye:qt,n.beginPath(),n.moveTo(ue,bt+qt),n.lineTo(ue,bt+ie-qt),n.quadraticCurveTo(ue,bt+ie,ue+qt,bt+ie),n.lineTo(ue+jt-qt,bt+ie),n.quadraticCurveTo(ue+jt,bt+ie,ue+jt,bt+ie-qt),n.lineTo(ue+jt,bt+qt),n.quadraticCurveTo(ue+jt,bt,ue+jt-qt,bt),n.lineTo(ue+qt,bt),n.quadraticCurveTo(ue,bt,ue,bt+qt),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}Le&&this.paintRoundedRectangle(Lt,M,C,s,r,n)}}},i.prototype.paintPolygonStroke=function(t,e,n,r,o,s,a){if(e.alignment!==.5){var l=e.width*(.5-(1-e.alignment)),h=Em.offsetPolygon(t.points,l),u=void 0;a.beginPath(),a.moveTo(h[0],h[1]);for(var p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);t.closeStroke&&a.closePath();for(var _=0;_<r.length;_++){if(u=r[_].shape.points,h=Em.offsetPolygon(u,l),o[_])for(a.moveTo(h[0],h[1]),p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);else for(a.moveTo(h[h.length-2],h[h.length-1]),p=h.length-4;p>=0;p-=2)a.lineTo(h[p],h[p+1]);r[_].shape.closeStroke&&a.closePath()}}a.globalAlpha=e.alpha*s,a.strokeStyle=n,a.stroke()},i.prototype.paintEllipse=function(t,e,n,r,o,s){var a=2*t.width,l=2*t.height,h=t.x-a/2,u=t.y-l/2,p=a/2*.5522848,_=l/2*.5522848,x=h+a,w=u+l,M=h+a/2,C=u+l/2;n.alignment===0&&s.save(),s.beginPath(),s.moveTo(h,C),s.bezierCurveTo(h,C-_,M-p,u,M,u),s.bezierCurveTo(M+p,u,x,C-_,x,C),s.bezierCurveTo(x,C+_,M+p,w,M,w),s.bezierCurveTo(M-p,w,h,C+_,h,C),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.paintRoundedRectangle=function(t,e,n,r,o,s){var a=t.x,l=t.y,h=t.width,u=t.height,p=t.radius,_=Math.min(h,u)/2;p=p>_?_:p,n.alignment===0&&s.save(),s.beginPath(),s.moveTo(a,l+p),s.lineTo(a,l+u-p),s.quadraticCurveTo(a,l+u,a+p,l+u),s.lineTo(a+h-p,l+u),s.quadraticCurveTo(a+h,l+u,a+h,l+u-p),s.lineTo(a+h,l+p),s.quadraticCurveTo(a+h,l,a+h-p,l),s.lineTo(a+p,l),s.quadraticCurveTo(a,l,a,l+p),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.setPatternTransform=function(t,e){if(this._svgMatrix!==!1){if(!this._svgMatrix){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n&&n.createSVGMatrix&&(this._svgMatrix=n.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},i.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},i}(),Ma=new De.d;er.prototype.generateCanvasTexture=function(i,t){t===void 0&&(t=1);var e=this.getLocalBounds(),n=ce.p.create({width:e.width,height:e.height,scaleMode:i,resolution:t});Hu||(Hu=new Gr.a),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(Ma),Ma.invert(),Ma.tx-=e.x,Ma.ty-=e.y,Hu.render(this,{renderTexture:n,clear:!0,transform:Ma});var r=ce.t.from(n.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return r.baseTexture.setResolution(t),r},er.prototype.cachedGraphicsData=[],er.prototype._renderCanvas=function(i){this.isMask!==!0&&(this.finishPoly(),i.plugins.graphics.render(this))};/*!
 * @pixi/canvas-sprite - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Sm=new De.d,Nb=function(){function i(t){this.renderer=t}return i.prototype.render=function(t){var e=t._texture,n=this.renderer,r=n.context;if(e.valid){var o=e._frame.width,s=e._frame.height,a=t.transform.worldTransform,l=0,h=0,u=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&u){n.setBlendMode(t.blendMode,!0),n.context.globalAlpha=t.worldAlpha;var p=e.baseTexture.scaleMode===gn.p.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==p&&(r[n.smoothProperty]=p),e.trim?(l=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(l=(.5-t.anchor.x)*e.orig.width,h=(.5-t.anchor.y)*e.orig.height),e.rotate&&(a.copyTo(Sm),a=Sm,De.n.matrixAppendRotationInv(a,e.rotate,l,h),l=0,h=0),l-=o/2,h-=s/2,n.setContextTransform(a,t.roundPixels,1),t.roundPixels&&(l|=0,h|=0);var _=e.baseTexture.resolution,x=n._outerBlend;x&&(r.save(),r.beginPath(),r.rect(l*n.resolution,h*n.resolution,o*n.resolution,s*n.resolution),r.clip()),t.tint!==16777215?(t._cachedTint===t.tint&&t._tintedCanvas.tintId===t._texture._updateID||(t._cachedTint=t.tint,t._tintedCanvas=Gr.b.getTintedCanvas(t,t.tint)),r.drawImage(t._tintedCanvas,0,0,Math.floor(o*_),Math.floor(s*_),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution))):r.drawImage(u,e._frame.x*_,e._frame.y*_,Math.floor(o*_),Math.floor(s*_),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution)),x&&r.restore(),n.setBlendMode(gn.b.NORMAL)}}},i.prototype.destroy=function(){this.renderer=null},i}();di.prototype._tintedCanvas=null,di.prototype._renderCanvas=function(i){i.plugins.sprite.render(this)};/*!
 * @pixi/canvas-extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Am=new De.j,Lb=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ce.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=Am).width=this.renderer.width,r.height=this.renderer.height);var a=Math.floor(r.width*n+1e-4),l=Math.floor(r.height*n+1e-4),h=new xn.CanvasRenderTarget(a,l,1),u=e.getImageData(r.x*n,r.y*n,a,l);return h.context.putImageData(u,0,0),h.canvas},i.prototype.pixels=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ce.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=Am).width=s.width,r.height=s.height);var a=r.x*n,l=r.y*n,h=r.width*n,u=r.height*n;return e.getImageData(a,l,h,u).data},i.prototype.destroy=function(){this.renderer=null},i}(),Mm=function(i,t){return(Mm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Db(i,t){var e=i;if(t instanceof ce.c){var n=t.source,r=n.width===0?e.canvas.width:Math.min(e.canvas.width,n.width),o=n.height===0?e.canvas.height:Math.min(e.canvas.height,n.height);return e.ctx.drawImage(n,0,0,r,o,0,0,e.canvas.width,e.canvas.height),!0}return!1}var Vi,Fb=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=16,n.canvas.height=16,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(Db),n}return function(e,n){function r(){this.constructor=e}Mm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.destroy=function(){i.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(wf),Wl=new De.d,Ca=new De.d,Kr=[new De.g,new De.g,new De.g,new De.g];/*!
 * @pixi/canvas-sprite-tiling - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */fb.prototype._renderCanvas=function(i){var t=this._texture;if(t.baseTexture.valid){var e=i.context,n=this.worldTransform,r=t.baseTexture,o=r.getDrawableSource(),s=r.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var a=new xn.CanvasRenderTarget(t._frame.width,t._frame.height,s);this.tint!==16777215?(this._tintedCanvas=Gr.b.getTintedCanvas(this,this.tint),a.context.drawImage(this._tintedCanvas,0,0)):a.context.drawImage(o,-t._frame.x*s,-t._frame.y*s),this._cachedTint=this.tint,this._canvasPattern=a.context.createPattern(a.canvas,"repeat")}e.globalAlpha=this.worldAlpha,i.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();var l=this.tileTransform.localTransform,h=this._width,u=this._height;Wl.identity(),Ca.copyFrom(l),this.uvRespectAnchor||Ca.translate(-this.anchor.x*h,-this.anchor.y*u),Ca.scale(this.tileScale.x/s,this.tileScale.y/s),Wl.prepend(Ca),Wl.prepend(n),i.setContextTransform(Wl),e.fillStyle=this._canvasPattern;var p=this.anchor.x*-h,_=this.anchor.y*-u;Kr[0].set(p,_),Kr[1].set(p+h,_),Kr[2].set(p+h,_+u),Kr[3].set(p,_+u);for(var x=0;x<4;x++)Ca.applyInverse(Kr[x],Kr[x]);for(e.beginPath(),e.moveTo(Kr[0].x,Kr[0].y),x=1;x<4;x++)e.lineTo(Kr[x].x,Kr[x].y);e.closePath(),e.fill()}},jx.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var t=i.context,e=this.worldTransform,n=!0,r=0,o=0,s=0,a=0;i.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible&&h._texture.valid){var u=h._texture.frame;if(t.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(i.setContextTransform(e,!1,1),n=!1),r=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,s=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var p=h.worldTransform;i.setContextTransform(p,this.roundPixels,1),r=h.anchor.x*-u.width+.5,o=h.anchor.y*-u.height+.5,s=u.width,a=u.height}var _=h._texture.baseTexture.resolution;t.drawImage(h._texture.baseTexture.getDrawableSource(),u.x*_,u.y*_,u.width*_,u.height*_,r*i.resolution,o*i.resolution,s*i.resolution,a*i.resolution)}}}},Cn.b.prototype._renderCanvas=function(i){},Cn.b.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&i.maskManager.pushMask(this._mask),this._renderCanvas(i);for(var t=0,e=this.children.length;t<e;++t)this.children[t].renderCanvas(i);this._mask&&i.maskManager.popMask(i)}},Cn.c.prototype.renderCanvas=function(i){},Du.prototype._renderCanvas=function(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),di.prototype._renderCanvas.call(this,i)},Gr.a.registerPlugin("accessibility",np),Gr.a.registerPlugin("extract",Lb),Gr.a.registerPlugin("graphics",Ob),Gr.a.registerPlugin("interaction",op),Gr.a.registerPlugin("mesh",Pb.a),Gr.a.registerPlugin("prepare",Fb),Gr.a.registerPlugin("sprite",Nb);class Bb extends yi.a{constructor(){super(),this.prevTime=-1,this.times=0,this.valueTotal=0,this.destroyed=!1,this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(t=>{const e=t-this.prevTime;this.valueTotal+=e,this.times+=1,this.times>20&&(this.value=Math.floor(1e3*this.times/this.valueTotal),this.valueTotal=0,this.times=0,this.destroyed||this.emit("update",this.value)),this.prevTime=t,this.destroyed||this.calcFps()})}destroy(){this.destroyed=!0}}(function(i){i.ResourceError="RESOURCE_ERROR",i.RuntimeError="RUNTIME_ERROR",i.RuntimeWarn="RUNTIME_WARN",i.CanvasCrash="CANVAS_CRASH"})(Vi||(Vi={}));class xi extends Error{constructor(t,e){var n,r;super(e),n=this,r=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__&&(n.__proto__=r),this.errorType=t,this.errorMsg=e}static transform(t){return t instanceof xi?t:new xi(Vi.RuntimeError,t.message)}}function Xl(){return function(i,t,e){const n=e.value;e.value=function(...r){try{return n.apply(this,r)}catch(o){throw new xi(Vi.RuntimeWarn,o.message)}}}}var kb=v(49),Cm=v.n(kb),Rm=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function ss(){return S()}const uo="__delay_resolve_result__";function Im(i){return new Promise(t=>{setTimeout(()=>{t(uo)},i)})}function js(i,t){return Rm(this,void 0,void 0,function*(){const e=yield Promise.race([i(),Im(t)]);return e===uo?uo:e})}function Yl(i,t){return Rm(this,void 0,void 0,function*(){const e=Date.now();for(;!i()&&Date.now()-e<t;)yield Im(16)})}var ju=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function Pm(i,t){return ju(this,void 0,void 0,function*(){const e=yield js(()=>fetch(i),t);if(e===uo)throw new xi(Vi.ResourceError,`"${i}" loaded timeout"`);if(!e.ok)throw new xi(Vi.ResourceError,`"${i}" loaded failed with status "${e.status}"`);return e})}class Ub{constructor(t,e,n,r,o,s,a){this.timeout=15e3,this.useCache=!1,this.taskId="",this.delegate=null,this.urlInterrupter=null,this.useCache=e,this.localStorage=t,this.logger=n,this.tracker=r,this.timeout=o,this.delegate=s||null,this.urlInterrupter=a||null}attachTaskId(t){this.taskId=t}fetchJson(t){return ju(this,void 0,void 0,function*(){const e=Date.now();let n=t;const r=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const s=Date.now();n=yield this.urlInterrupter(n),this.logger.info(`use url interrupter, ${n}, time: ${Date.now()-s}`,this.taskId)}let o;if(this.useCache&&(this.logger.info("load resource from cache. "+r,this.taskId||""),o=yield this.localStorage.getItem(r)),o)return this.logger.info("cache hit. "+r,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"cache"}}),o;{let s;if(this.delegate){this.logger.info("load resource by delegate. "+r,this.taskId||"");const a=Date.now();try{const l=yield js(()=>this.delegate.loadJson(n),this.timeout);if(this.logger.info(`load resource by delegate end. ${r}, time: ${Date.now()-a}`,this.taskId||""),l===uo)throw new xi(Vi.ResourceError,`"${r}" loaded timeout"`);s=JSON.parse(l),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}})}catch(l){throw this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}}),new xi(Vi.ResourceError,`"${r}" loaded timeout"`)}}else{this.logger.info("load resource from server. "+r,this.taskId||"");const a=Date.now();try{s=yield(yield Pm(""+n,this.timeout)).json()}catch(l){throw this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}}),l}this.logger.info(`load resource from server end. ${r}, time: ${Date.now()-a}`,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}})}return this.logger.info("load end. "+r,this.taskId||""),this.useCache&&this.localStorage.setItem(r,s).catch(()=>{}),s}})}fetchPng(t,e){return ju(this,void 0,void 0,function*(){const n=Date.now();let r=t;const o=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const l=Date.now();r=yield this.urlInterrupter(r),this.logger.info(`use url interrupter, ${r}, time: ${Date.now()-l}`,this.taskId)}let s;const a=o+"-v2";if(this.useCache&&(this.logger.info("load resource from cache. "+o,this.taskId||""),s=yield this.localStorage.getItem(a)),s){const{scale:l,scaledBase64:h}=s;this.logger.info("cache hit. "+o,this.taskId||"");const u=new ce.c(h,{resolution:1});return this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"cache"}}),{baseTexture:u,scale:l}}{let l;if(this.delegate)try{this.logger.info("load resource by delegate. "+o,this.taskId||"");const ct=Date.now();if(l=yield js(()=>this.delegate.loadImage(r),this.timeout),this.logger.info(`load resource by delegate end. ${o}, time: ${Date.now()-ct}`,this.taskId||""),l===uo)throw new xi(Vi.ResourceError,`"${o}" loaded timeout"`);this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}catch(ct){this.tracker({name:"slideResourceLoad",result:"fail",reason:ct+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}else try{this.logger.info("load resource from server. "+o,this.taskId||"");const ct=Date.now(),it=yield Pm(r,this.timeout);this.logger.info(`load resource from server end. ${o}, time: ${Date.now()-ct}`,this.taskId||""),l=yield it.blob(),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}catch(ct){this.tracker({name:"slideResourceLoad",result:"fail",reason:ct+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}s=yield function(ct){return new Promise((it,mt)=>{const lt=new FileReader;lt.onload=()=>{it(lt.result)},lt.onerror=()=>{mt(new xi(Vi.ResourceError,"Failed parse blob data."))},lt.readAsDataURL(ct)})}(l);const h=document.createElement("img");h.src=s,yield new Promise((ct,it)=>{h.onload=()=>ct(""),h.onerror=()=>it(new Error("load sprite image failed"))});let u=e;const p=h.width||1,_=h.height||1,x=2048,w=2048;if(p>x||_>w){u*=x/p;const ct=u*_;ct>w&&(u*=_/ct)}const M=document.createElement("canvas"),C=Math.ceil(h.width*u),G=Math.ceil(h.height*u);M.width=C,M.height=G,M.getContext("2d").drawImage(h,0,0,C,G);const Q=M.toDataURL("image/png"),nt=new ce.c(Q,{resolution:1});return this.logger.info("load end. "+o,this.taskId||""),this.useCache&&this.localStorage.setItem(a,{scale:u,scaledBase64:Q}).catch(()=>{}),{baseTexture:nt,scale:u}}})}destroy(){}}var Gb=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Hb{constructor(t){this.isPaused=!1,this.timestamp=0,this.callbackList=[],this.onTimeUpdate=e=>{const n=e/(yr.b.TARGET_FPMS||.06);if(!this.isPaused){this.timestamp+=n,this.callbackList=this.callbackList.filter(o=>o&&!o.applied);let{length:r}=this.callbackList;for(let o=0;o<r;o++){const s=this.callbackList[o];if(s&&!s.applied){if(!(s.triggerTime<=this.timestamp))break;s.running=!0,s.fn(),s.applied=!0,r=this.callbackList.length}}}},this.ticker=t,this.ticker.add(this.onTimeUpdate)}setTimeout(t,e){const n=ss(),r=this.timestamp+Math.max(e||16,16);return this.callbackList.push({fn:t,triggerTime:r,id:n,applied:!1,running:!1}),this.callbackList.sort((o,s)=>o.triggerTime-s.triggerTime),n}clearTimeout(t){const e=this.callbackList.findIndex(n=>n.id===t);e>=0&&!this.callbackList[e].running&&this.callbackList.splice(e,1)}delay(t){return new Promise(e=>{this.setTimeout(e,t)})}waitUntil(t,e){return Gb(this,void 0,void 0,function*(){const n=this.timestamp;for(;!t()&&this.timestamp-n<e;)yield this.delay(50)})}pause(){this.isPaused=!0}resume(){this.isPaused=!1}}var jb=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function ql(i,t,e){return e?Math.floor(parseFloat(i)*t):Math.ceil(parseFloat(i)*t)}const Jl={w:!1,h:!1,x:!0,y:!0};class zb{constructor(t){this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null),this.spriteSheets=[],this.loader=t}getTexture(t){return this.textures[t]||null}getFrameData(t){return this.frames[t]}getGifFrames(t){return this.gifs[t]?this.gifs[t].filter(e=>!!e):[]}loadSpriteSheetItem(t,e,n,r){return jb(this,void 0,void 0,function*(){const o=yield this.loader.fetchJson(`${t}/${e}/jsonOutput/${n}.json`),{baseTexture:s,scale:a}=yield this.loader.fetchPng(`${t}/${e}/jsonOutput/${n}.png`,r);(function(h,u){h.meta&&h.meta.size&&["w","h"].forEach(p=>{h.meta.size[p]=ql(h.meta.size[p],u,Jl[p])}),h.frames&&Object.keys(h.frames).forEach(p=>{h.frames[p].frame&&["x","y","w","h"].forEach(_=>{h.frames[p].frame[_]=ql(h.frames[p].frame[_],u,Jl[_])}),h.frames[p].spriteSourceSize&&["x","y","w","h"].forEach(_=>{h.frames[p].spriteSourceSize[_]=ql(h.frames[p].spriteSourceSize[_],u,Jl[_])}),h.frames[p].sourceSize&&["w","h"].forEach(_=>{h.frames[p].sourceSize[_]=ql(h.frames[p].sourceSize[_],u,Jl[_])})})})(o,a);const l=new Sf(s,o);yield new Promise(h=>{l.parse(()=>h(""))}),this.spriteSheets.push(l),Object.keys(l.textures).forEach(h=>{const u=h.match(/^(.+)_gif_(\d+)$/);if(u&&u[1]&&u[2]){const p=u[1];this.gifs[p]||(this.gifs[p]=[]);const _=parseInt(u[2],10);this.gifs[p][_]=l.textures[h]}else this.frames[h]=o.frames[h],this.textures[h]=l.textures[h]})})}destroy(){this.spriteSheets.forEach(t=>t.destroy(!0)),this.spriteSheets=[],this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null)}}var Vb=v(18),Zl=v.n(Vb),Wb=v(13),Fo=v.n(Wb);function Om(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=Math.sin(o*(Math.PI/180))*e;else{const s=function(a){const l=a*Math.PI/180;return Math.tan(l)}(o);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=s*n}return{x:n,y:r}}function Xb(i,t,e,n,r,o){const s=i,a=t;let l,h,u,p,_;if(Math.round(n)===0)l=r,h=o,_=0;else if(Math.round(n)>=360)l=r,h=o,u=r+2*i*Math.abs(Math.cos(-e/180*Math.PI)),p=o+2*t*Math.sin(-e/180*Math.PI),_=1;else{const x=-e,w=-(e+n),{x:M,y:C}=Om(x,s,a),G=r-M,Q=o+C,{x:nt,y:ct}=Om(w,s,a);l=nt+G,h=Q-ct,_=n>=-360&&n<-180?1:n>=-180&&n<0||n>0&&n<180?0:1}return{radiusX:s,radiusY:a,xAxisRotation:0,largeArcFlag:_,sweepFlag:n>0?1:0,endX:l,endY:h,middleX:u,middleY:p}}class Nm{constructor(){this.pool=[]}getObject(t){const e=this.pool.find(n=>!n.isUsed);if(e)return e.isUsed=!0,e.obj;{const n={obj:this.createObject(),isUsed:!0,group:t};return this.pool.push(n),n.obj}}collectObject(t){const e=this.pool.find(n=>n.obj===t);e&&(e.isUsed=!1,this.resetObject(e.obj))}collectObjectByGroup(t){this.pool.filter(e=>e.group===t).forEach(e=>this.collectObject(e.obj))}}const zu=new class extends Nm{createObject(){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i}resetObject(i){i.removeAttribute("viewBox"),i.removeAttribute("width"),i.removeAttribute("height"),i.innerHTML=""}},Vu=new class extends Nm{createObject(){return document.createElement("img")}resetObject(i){i.removeAttribute("src")}};var Yb=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class qb{constructor(t){this.imgElements=[],this.svgElements=[],this.idToHashMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.hashToIdMap=Object.create(null),this.maxResolution=t}render(t,e,n,r){return Yb(this,void 0,void 0,function*(){const{items:o,width:s,height:a}=t,l=Vu.getObject(n),h=new ce.c(l,{width:s*r,height:a*r,resolution:1}),u=zu.getObject(n);this.imgElements.push(l),this.svgElements.push(u),u.setAttribute("viewBox",`0 0 ${s} ${a}`),u.setAttribute("width",""+s),u.setAttribute("height",""+a);const p={};o.forEach(C=>{const{item:G,x:Q,y:nt}=C,ct=Q+2,it=nt+2;G.pathsData.forEach(gt=>{let Ut="";gt.cmds.forEach(([Ft,Mt])=>{Ut+=Ft+" ",Ut+=Mt.map(At=>(Fo()(At)||(At.x=At.x+gt.offset.x+ct,At.y=At.y+gt.offset.y+it),At)).reduce((At,Ot)=>(Fo()(Ot)?At+=Ot+" ":At+=`${Ot.x} ${Ot.y} `,At),""),Ut+=" "}),gt.pathElement.setAttribute("d",Ut),u.appendChild(gt.pathElement)});const mt=G.width-4-2*G.padding,lt=G.height-4-2*G.padding;this.textures[G.hash]={texture:new ce.t(h,new De.j((ct+2)*r,(it+2)*r,mt*r,lt*r)),pivot:G.pivot,scale:1/r},p[G.hash]=this.hashToIdMap[G.hash]});const _=(x='<?xml version="1.0" encoding="utf-8"?>'+u.outerHTML,"data:image/svg+xml,"+encodeURIComponent(x).replace(/'/g,"%27").replace(/"/g,"%22"));var x;const w=document.createElement("img");w.src=_,yield new Promise((C,G)=>{w.onload=()=>C(""),w.onerror=()=>G()});const M=document.createElement("canvas");M.width=w.width*r,M.height=w.height*r,M.getContext("2d").drawImage(w,0,0,M.width,M.height),l.src=M.toDataURL("image/png"),yield new Promise((C,G)=>{l.onload=()=>C(""),l.onerror=()=>G()})})}getGraphicsData(t){const e=this.idToHashMap[t]||"";return this.textures[e]||null}addGraphics(t,e,n,r,o,s,a,l,h,u,p){var _,x;if(!a&&!h)return t;const w=Zl()(n+((x=(_=a==null?void 0:a.width)===null||_===void 0?void 0:_.toString())!==null&&x!==void 0?x:0)+h+u+p);if(this.hashToIdMap[w]||(this.hashToIdMap[w]=[]),this.hashToIdMap[w].push(t),this.idToHashMap[t]=w,this.graphics.findIndex(M=>M.hash===w)<0){const{graphicsWidth:M,graphicsHeight:C,pathsData:G,pivot:Q,padding:nt}=function(ct,it,mt,lt,gt,Ut,Ft,Mt,At){var Ot;const Lt=[],ne={x:Math.abs(gt.x),y:Math.abs(gt.y)};let $t=0,zt=0,Yt=0,ge=0,be=0,Pe="none";const Ct=(Ot=lt==null?void 0:lt.width)!==null&&Ot!==void 0?Ot:0;return Ft?($t=it,zt=mt,be=0):(Pe=At||"#ff0000",be=Ct,Yt=.5*Ct,ge=.5*Ct,$t=it+Ct,zt=mt+Ct,ne.x+=.5*Ct,ne.y+=.5*Ct),$t+=Math.abs(gt.x),zt+=Math.abs(gt.y),Yt+=Math.abs(gt.x),ge+=Math.abs(gt.y),$t+=4,zt+=4,Yt+=2,ge+=2,$t=Math.ceil($t),zt=Math.ceil(zt),ct.forEach(Bt=>{const ve=document.createElementNS("http://www.w3.org/2000/svg","path");Bt.fill!=="none"&&Ft?ve.setAttribute("fill",Mt||"#ff0000"):ve.setAttribute("fill","none"),Bt.hasStroke&&!Ft&&(ve.setAttribute("stroke-linecap",(lt==null?void 0:lt.cap)||"butt"),ve.setAttribute("stroke-linejoin",(lt==null?void 0:lt.join)||"miter"),ve.setAttribute("stroke-width",be.toString()),ve.setAttribute("stroke",Pe),lt!=null&&lt.dash&&ve.setAttribute("stroke-dasharray",lt.dash));const{scale:le}=Bt,se=Bt.path.trim().split(" ");let Ie={x:0,y:0};const Le={offset:{x:Yt,y:ge},cmds:[],pathElement:ve};for(let ue=0;ue<se.length;ue+=2){const bt=se[ue],jt=se[ue+1];if(bt==="M"){let[ie,ae]=jt.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,Le.cmds.push(["M",[{x:ie,y:ae}]])}else if(bt==="A"){const[ie,ae,qt,ye]=jt.split(",").map(En=>Number(En)),nn=qt/Math.PI*180,on=ye/Math.PI*180,rn=Xb(ie,ae,nn,on,Ie.x,Ie.y);Math.round(on)>=360?(Ie={x:rn.endX,y:rn.endY},Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.middleX/9525*le.x,y:rn.middleY/9525*le.y}]]),Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]])):(Ie={x:rn.endX,y:rn.endY},Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]]))}else if(bt==="L"){let[ie,ae]=jt.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,Le.cmds.push(["L",[{x:ie,y:ae}]])}else if(bt==="QB"){let[ie,ae,qt,ye]=jt.split(",").map(nn=>Number(nn));Ie={x:qt,y:ye},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,Le.cmds.push(["Q",[{x:ie,y:ae},{x:qt,y:ye}]])}else if(bt==="CB"){let[ie,ae,qt,ye,nn,on]=jt.split(",").map(rn=>Number(rn));Ie={x:nn,y:on},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,nn=nn/9525*le.x,on=on/9525*le.y,Le.cmds.push(["C",[{x:ie,y:ae},{x:qt,y:ye},{x:nn,y:on}]])}else bt==="C"&&Le.cmds.push(["Z",[]])}Lt.push(Le)}),{graphicsWidth:$t,graphicsHeight:zt,pivot:ne,padding:2,pathsData:Lt}}(e,o,s,a,r,0,h,u,p);this.graphics.push({hash:w,pathsData:G,pivot:Q,width:M,height:C,padding:nt})}return t}pack(){return this.graphics.forEach(t=>{t.width+=4,t.height+=4}),function t(e){const n=[],r=e.filter(u=>{const p=u.width<2048&&u.height<2048;return p||n.push(u),p}).sort((u,p)=>u.width*u.height-p.width*p.height);let o=r.length+1,s=2050,a=2050;const l=[];let h=null;for(;(s>2048||a>2048)&&r.length>0;)o-=1,h=Cm()(r.slice(0,o)),s=h.width,a=h.height;return h&&l.push(h),n.forEach(u=>{const p=Cm()([u]);l.push(p)}),o<r.length?l.concat(t(r.slice(o))):l}(this.graphics)}destroy(){Object.keys(this.textures).forEach(t=>{var e;(e=this.textures[t])===null||e===void 0||e.texture.destroy(!0)}),this.textures=Object.create(null),this.imgElements.forEach(t=>Vu.collectObject(t)),this.svgElements.forEach(t=>zu.collectObject(t)),this.graphics=[]}}class Jb{constructor(){this.runningTimeNodes={}}addRunningTimeNode(t,e,n){const r=`${e}_${t}`;if(this.runningTimeNodes[r])try{this.runningTimeNodes[r].dispose(!0)}catch{}this.runningTimeNodes[r]=n}removeRunningTimeNode(t,e){const n=`${e}_${t}`;delete this.runningTimeNodes[n]}}class Zb{constructor(t){this.eventHub=t,this.targets=Object.create(null)}getTargets(){return Object.keys(this.targets).map(t=>this.targets[t])}addTarget(t,e){this.targets[t]=e}getTargetById(t){return this.targets[t]}getTarget(t,e,n={type:"el",index:0,id:""}){var r,o;let s=this.targets[t.id];return t.type!=="shape"?s:(t.type==="shape"&&t.txEl&&(s=(r=s==null?void 0:s.getTextElement(t.txEl.type,t.txEl.range))!==null&&r!==void 0?r:null),t.type==="shape"&&t.bg&&n.index===0&&(e=!1,s=(o=s==null?void 0:s.getBgElement())!==null&&o!==void 0?o:null,this.eventHub.emit("IterateTimeNodeEnd",n.id)),e&&s?s.getIterateEntry(n.type,n.index,n.id):(s||this.eventHub.emit("IterateTimeNodeEnd",n.id),s))}clearTargets(){this.targets=Object.create(null)}}class Kb{constructor(t){this.target=t}get color(){return this.target.strokeColorFilter.currentColor}set color(t){this.target.strokeColorFilter.color=t}get on(){return this.target.strokeActive?"true":"false"}set on(t){this.target.strokeActive=t==="true"}}class Qb{constructor(t){this.applyCommand=(e,n)=>{this.target.applyCommand(e,n)},this.target=t}}class $b{constructor(t){this.target=t}get color(){return this.target.pptColorFilter.currentColor}set color(t){this.target.pptColorActive&&(this.target.pptColorFilter.color=t)}get on(){return this.target.pptColorActive?"true":"false"}set on(t){this.target.pptColorActive=t==="true"}get designColor(){return this.target.pptColorFilter.designColor}toString(){return this.color}}class Lm{constructor(t){this.target=t}get color(){return this.target.fillColorFilter.currentColor}set color(t){this.target.fillActive&&(this.target.fillColorFilter.color=t)}get on(){return this.target.fillActive?"true":"false"}set on(t){this.target.fillActive=t==="true"}get designColor(){return this.target.fillColorFilter.designColor}}class t1{constructor(t,e,n){this.hardHidden=!1,this.designRotation=0,this.target=t,e===!0&&(this.hardHidden=!0),this.designRotation=n}get opacity(){return this.target.alpha}set opacity(t){this.target.alpha=t}get rotation(){return this.target.rotation/Math.PI*180}set rotation(t){this.target.rotation=t/180*Math.PI+this.designRotation}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(t){this.visibility===t||this.hardHidden||(this.target.visible=t==="visible")}}class Dm{constructor(t,e){this.actions=[],this.ctx=e,this.object=t,this.object.interactive=!0}reset(t){this.object.interactive=!1,this.object.removeAllListeners(),this.object=t,this.object.interactive=!0}addAction(t,e){this.actions.push([t,e]),e==="click"?(this.object.addListener("pointertap",()=>this.handleAction(t)),this.object.cursor="pointer"):e==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(t))}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new De.k(0,0,this.object.width,this.object.height)}handleAction(t){this.ctx.eventHub.emit(Ze.hyperlinkTrigger,t),this.execAction(t)}execAction(t){var e,n;if(this.ctx.eventHub.emit(Ze.userInput),t.action==="ppaction://hlinksldjump"){const r=((e=t==null?void 0:t.target)!==null&&e!==void 0?e:"").match(/slide(\d+)\.xml/);r&&r[1]&&this.ctx.eventHub.emit(Ze.requestGotoSlide,Number(r[1]))}else if(t.action==="ppaction://hlinkshowjump?jump=nextslide")this.ctx.eventHub.emit(Ze.requestNextSlide);else if(t.action==="ppaction://hlinkshowjump?jump=previousslide")this.ctx.eventHub.emit(Ze.requestPrevSlide);else if(t.action==="ppaction://hlinkshowjump?jump=firstslide")this.ctx.eventHub.emit(Ze.requestGotoSlide,1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslide")this.ctx.eventHub.emit(Ze.requestGotoSlide,-1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslideviewed"){const r=this.ctx.lastViewedIndex;this.ctx.eventHub.emit(Ze.requestGotoSlide,r)}else t.action==="ppaction://hlinkshowjump?jump=endshow"?this.ctx.eventHub.emit(Ze.requestGotoSlide,-1):t.action===""&&((n=t.target)===null||n===void 0?void 0:n.startsWith("http"))&&this.ctx.eventHub.emit(Ze.requestOpenUrl,t.target)}}function xr(i,t,e=5){return Math.abs(i-t)<=Math.pow(10,-e)}function zs(i){return Math.floor(1e6*i)/1e6}class Bo{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(t,e){const n=new Bo;return n.point=t,n.slope=e,n}resolveY(t){return Math.tan(this.slope)*(t-this.point.x)+this.point.y}distanceToLinearEquation(t){return xr(this.slope,t.slope)?this.distanceToPoint(t.point):-1}distanceToPoint(t){let e=0;if(Math.tan(this.slope)*(t.x-this.point.x)+this.point.y===t.y)return 0;e=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const n=Bo.fromPointSlope(t,e),r=this.crossPoint(n);return r?Math.ceil(Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))):0}crossPoint(t){if(xr(t.slope,this.slope))return null;let e=0,n=0;const r=Math.tan(t.slope),o=Math.tan(this.slope),{x:s,y:a}=this.point,{x:l,y:h}=t.point;return xr(this.slope,Math.PI/2)?(e=this.point.x,n=r*(e-l)+h):xr(t.slope,Math.PI/2)?(e=t.point.x,n=o*(e-s)+a):xr(this.slope,Math.PI)||xr(this.slope,0)?(n=this.point.y,e=(n-h)/r+l):xr(t.slope,Math.PI)||xr(t.slope,0)?(n=t.point.y,e=(n-a)/o+s):(e=(r*l-h+a-o*s)/(r-o),n=o*(e-s)+a),{x:e,y:n}}}class Wu{constructor(t,e,n){var r,o,s,a,l,h;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new De.j(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Cn.b,this.ctx=e,this.option=n,this.style=new t1(this.container,!!t.hardHidden,t.rotation||0),this.designGlobalPosition={x:n.parentGlobalPos.x+((o=(r=t.position)===null||r===void 0?void 0:r.x)!==null&&o!==void 0?o:0),y:n.parentGlobalPos.y+((a=(s=t.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0)},(t.hlinkClick||t.hlinkHover)&&(this.hyperlink=new Dm(this.container,this.ctx),t.hlinkHover&&((l=this.hyperlink)===null||l===void 0||l.addAction(t.hlinkHover,"hover")),t.hlinkClick&&((h=this.hyperlink)===null||h===void 0||h.addAction(t.hlinkClick,"click"))),this.ctx.clock.waitUntil(()=>{try{return!!this.container.width}catch{return!1}},3e3).then(()=>{try{this.designWidth=this.designWidth||this.container.width}catch{}}),this.ctx.clock.waitUntil(()=>{try{return!!this.container.height}catch{return!1}},3e3).then(()=>{try{this.designHeight=this.designHeight||this.container.height}catch{}})}updateScale(){this.container&&(this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y)}updateTransform(t){var e,n,r,o,s,a,l,h;this.designWidth=t.width,this.designHeight=t.height,this.designX=(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,this.designY=(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0;const u=this.designWidth/2,p=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=u,this.container.pivot.y=p;const _=(a=(s=t.position)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:0,x=(h=(l=t.position)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:0;this.container.x=_+u,this.container.y=x+p,t.scale&&(this.designScale={x:t.scale.x,y:t.scale.y},this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y),t.rotation&&(this.container.rotation=t.rotation);const w=new er;w.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(w),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=_,this.bound.y=x,this.bound.width=this.designWidth,this.bound.height=this.designHeight}get scale(){return this.scaleOrigin}set scale(t){this.scaleOrigin.x=t.x,this.scaleOrigin.y=t.y,this.updateScale()}get design_ppt_w(){return zs(this.designWidth/this.ctx.stageWidth)}get design_ppt_h(){return zs((this.designHeight||this.container.height)/this.ctx.stageHeight)}get design_ppt_x(){return zs(this.designX/this.ctx.stageWidth)}get design_ppt_y(){return zs(this.designY/this.ctx.stageHeight)}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(t){this.designWidth&&(this.scaleExt.x=t*this.ctx.stageWidth/this.designWidth,this.updateScale())}get ppt_h(){const t=this.designHeight||this.container.height;return this.scaleExt.y*this.scaleOrigin.y*t/this.ctx.stageHeight}set ppt_h(t){this.designHeight&&(this.scaleExt.y=t*this.ctx.stageHeight/this.designHeight,this.updateScale())}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(t){this.pptX=t;const e=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=t*this.ctx.stageWidth+this.container.pivot.x*e}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(t){this.pptY=t;const e=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=t*this.ctx.stageHeight+this.container.pivot.y*e}get r(){return this.container.rotation}set r(t){this.container.rotation=t}set xshear(t){this.container.skew.x=t}get xshear(){return this.container.skew.x}set yshear(t){this.container.skew.y=t}get yshear(){return this.container.skew.y}}var e1=v(112),n1=v.n(e1);class Kl{constructor(t){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,t){this._isInit=!0;const e=t.match(/-?[0-9]+/g);e&&(this.h=parseInt(e[0],10),this.s=parseInt(e[1],10)/100,this.l=parseInt(e[2],10)/100)}}isInit(){return this._isInit}by(t,e){e.h=Math.max(Math.min(this.h+t.h,359),0),e.s=Math.max(Math.min(this.s+t.s,1),0),e.l=Math.max(Math.min(this.l+t.l,1),0),e.a=Math.max(Math.min(this.a+t.a,1),0)}fromHexString(t){const[e,n,r,o]=br(t);let s=0,a=0,l=0;const h=Math.max(e,n,r),u=Math.min(e,n,r),p=h-u;l=(h+u)/2,p===0?s=0:h===e?s=(n-r)/p%6*60:h===n?s=60*((r-e)/p+2):h===r&&(s=60*((e-n)/p+4)),a=p===0?0:p/(1-Math.abs(2*l-1)),this.h=s,this.s=a,this.l=l,this.a=o}interpolationFrom(t,e,n){const r=t.h+(this.h-t.h)*e,o=t.s+(this.s-t.s)*e,s=t.l+(this.l-t.l)*e,a=t.a+(this.a-t.a)*e;n.h=Math.max(Math.min(r,359),0),n.s=Math.max(Math.min(o,1),0),n.l=Math.max(Math.min(s,1),0),n.a=Math.max(Math.min(a,1),0)}toHexString(){let t=[0,0,0,0];const{h:e,s:n,l:r}=this;if(e<360&&e>=0&&n<=1&&n>=0&&r<=1&&r>=0){let o,s,a;const l=(1-Math.abs(2*r-1))*n,h=l*(1-Math.abs(e/60%2-1)),u=r-l/2;[o,s,a]=e>=0&&e<60?[l,h,0]:e>=60&&e<120?[h,l,0]:e>=120&&e<180?[0,l,h]:e>=180&&e<240?[0,h,l]:e>=240&&e<300?[h,0,l]:[l,0,h],t=[o+u,s+u,a+u,this.a]}return Bm(t)}}class Ql{constructor(t){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,t&&(this._isInit=!0,this.fromHexString(t))}fromHexString(t){const[e,n,r,o]=br(t);this.r=e,this.g=n,this.b=r,this.a=o}isInit(){return this._isInit}interpolationFrom(t,e,n){n.r=t.r+(this.r-t.r)*e,n.g=t.g+(this.g-t.g)*e,n.b=t.b+(this.b-t.b)*e,n.a=t.a+(this.a-t.a)*e}by(t,e){e.r=Math.min(Math.max(this.r+t.r,0),255),e.g=Math.min(Math.max(this.g+t.g,0),255),e.b=Math.min(Math.max(this.b+t.b,0),255),e.a=Math.min(Math.max(this.a+t.a,0),1)}toHexString(){return Bm([this.r,this.g,this.b,this.a])}}function Fm(i){const t=i.substring(1);return[parseInt(t.substring(0,6),16),parseInt(t.substring(6,8),16)/255]}function br(i){return(i=i.replace(/^#/,"")).substring(6,8).length===0&&(i+="FF"),[parseInt(i.substring(0,2).padStart(8,"0"),16)/255,parseInt(i.substring(2,4).padStart(8,"0"),16)/255,parseInt(i.substring(4,6).padStart(8,"0"),16)/255,parseInt(i.substring(6,8).padStart(8,"0"),16)/255]}function Bm(i){return"#"+Math.round(255*i[0]).toString(16).padStart(2,"0")+Math.round(255*i[1]).toString(16).padStart(2,"0")+Math.round(255*i[2]).toString(16).padStart(2,"0")+Math.round(255*i[3]).toString(16).padStart(2,"0")}function Ra(i,t,e){const n=br(i),r=br(t),o=Math.round(255*(n[0]+(r[0]-n[0])*e)),s=Math.round(255*(n[1]+(r[1]-n[1])*e)),a=Math.round(255*(n[2]+(r[2]-n[2])*e)),l=Math.round(255*(n[3]+(r[3]-n[3])*e));return"#"+o.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")+l.toString(16).padStart(2,"0")}class as extends ce.k{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF",this.designColor="#FFFFFFFF"}set color(t){this.currentColor=t;const e=br(t);this.uniforms.color=Float32Array.from(e)}get color(){return this.currentColor}}const km=new Hs.ColorMatrixFilter;km.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const Um=new Hs.ColorMatrixFilter;Um.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const Gm=new Hs.ColorMatrixFilter;Gm.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const Hm=new Hs.ColorMatrixFilter;Hm.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const i1={darken:km,darkenLess:Um,lightenLess:Hm,lighten:Gm};class Xu extends Wu{get fillActive(){var t,e;return((e=(t=this.container.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set fillActive(t){var e,n;t?((n=(e=this.container.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0&&(this.container.filters=[this.fillColorFilter]):this.container.filters=[]}constructor(t,e,n){super({position:{x:t.x,y:t.y},width:t.width,height:t.height},e,n),this.fillColorFilter=new as,this.fill=new Lm(this),this.json=t,this.ctx=e,this.parentGlobalPos=n.parentGlobalPos,this.global={x:n.parentGlobalPos.x+t.x,y:n.parentGlobalPos.y+t.y},this.updateTransform({position:{x:t.x,y:t.y},width:t.width,height:t.height})}get renderContainer(){return this.container}get interactiveContainer(){return this.container}clearOnSlideChange(){}initOnReuse(){}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(t){const e=t*this.ctx.stageWidth-this.global.x,n=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+e+this.container.pivot.x*n}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(t){const e=t*this.ctx.stageHeight-this.global.y,n=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+e+this.container.pivot.y*n}get design_ppt_x(){return zs(this.global.x/this.ctx.stageWidth)}get design_ppt_y(){return zs(this.global.y/this.ctx.stageHeight)}}class r1{constructor(t,e,n,r,o,s,a,l,h,u,p){this.ctx=t,this.type=e,this.lineWidth=n,this.width=r,this.height=o,this.fillColor=s,this.isHorz=a,this.renderContainer=new Cn.b,this.ghcTextureId=`${l}-text-p${h}-l${u}-u${p}-underLine`}createPaths(){if(this.type==="ww")return null;{let t=`M 0,0 L ${9525*this.width},0`,[e,n]=[this.width,this.lineWidth];return this.isHorz||(t="M 0,0 L 0,"+9525*this.height,[e,n]=[this.lineWidth,this.height]),{paths:[{id:ss(),path:t,fill:"norm",hasStroke:!0,scale:{x:1,y:1},hash:Zl()(t)}],width:e,height:n}}}getLineStyle(){const t={width:this.lineWidth};return this.type==="dotted"&&(t.dash=""+this.lineWidth),t}preRender(){const t=this.createPaths();if(t){const{paths:e,width:n,height:r}=t,o=e.reduce((s,a)=>s+a.hash,"");this.ctx.graphicsTexture.addGraphics(this.ghcTextureId,e,o,{x:0,y:0},n,r,this.getLineStyle(),this.ctx.objectPoolGroup,!1,null,this.fillColor)}}render(){if(this.ghcTextureId){const t=this.ctx.graphicsTexture.getGraphicsData(this.ghcTextureId);t&&(this.sprite=new di,this.sprite.texture=t.texture,this.sprite.pivot.x=t.pivot.x,this.sprite.scale.x=t.scale,this.sprite.scale.y=t.scale)}}destroy(){var t;(t=this.sprite)===null||t===void 0||t.destroy({texture:!0})}}const nr=134217729;function Yu(i,t,e,n,r){let o,s,a,l,h=t[0],u=n[0],p=0,_=0;u>h==u>-h?(o=h,h=t[++p]):(o=u,u=n[++_]);let x=0;if(p<i&&_<e)for(u>h==u>-h?(s=h+o,a=o-(s-h),h=t[++p]):(s=u+o,a=o-(s-u),u=n[++_]),o=s,a!==0&&(r[x++]=a);p<i&&_<e;)u>h==u>-h?(s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p]):(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++_]),o=s,a!==0&&(r[x++]=a);for(;p<i;)s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p],o=s,a!==0&&(r[x++]=a);for(;_<e;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++_],o=s,a!==0&&(r[x++]=a);return o===0&&x!==0||(r[x++]=o),x}function o1(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function Ia(i){return new Float64Array(i)}const Vs=Ia(4),jm=Ia(8),zm=Ia(12),Vm=Ia(16),sr=Ia(4);function $l(i,t,e,n,r,o){const s=(t-o)*(e-r),a=(i-r)*(n-o),l=s-a;if(s===0||a===0||s>0!=a>0)return l;const h=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(u,p,_,x,w,M,C){let G,Q,nt,ct,it,mt,lt,gt,Ut,Ft,Mt,At,Ot,Lt,ne,$t,zt,Yt;const ge=u-w,be=_-w,Pe=p-M,Ct=x-M;Lt=ge*Ct,mt=nr*ge,lt=mt-(mt-ge),gt=ge-lt,mt=nr*Ct,Ut=mt-(mt-Ct),Ft=Ct-Ut,ne=gt*Ft-(Lt-lt*Ut-gt*Ut-lt*Ft),$t=Pe*be,mt=nr*Pe,lt=mt-(mt-Pe),gt=Pe-lt,mt=nr*be,Ut=mt-(mt-be),Ft=be-Ut,zt=gt*Ft-($t-lt*Ut-gt*Ut-lt*Ft),Mt=ne-zt,it=ne-Mt,Vs[0]=ne-(Mt+it)+(it-zt),At=Lt+Mt,it=At-Lt,Ot=Lt-(At-it)+(Mt-it),Mt=Ot-$t,it=Ot-Mt,Vs[1]=Ot-(Mt+it)+(it-$t),Yt=At+Mt,it=Yt-At,Vs[2]=At-(Yt-it)+(Mt-it),Vs[3]=Yt;let Bt=o1(4,Vs),ve=22204460492503146e-32*C;if(Bt>=ve||-Bt>=ve||(it=u-ge,G=u-(ge+it)+(it-w),it=_-be,nt=_-(be+it)+(it-w),it=p-Pe,Q=p-(Pe+it)+(it-M),it=x-Ct,ct=x-(Ct+it)+(it-M),G===0&&Q===0&&nt===0&&ct===0)||(ve=11093356479670487e-47*C+33306690738754706e-32*Math.abs(Bt),Bt+=ge*ct+Ct*G-(Pe*nt+be*Q),Bt>=ve||-Bt>=ve))return Bt;Lt=G*Ct,mt=nr*G,lt=mt-(mt-G),gt=G-lt,mt=nr*Ct,Ut=mt-(mt-Ct),Ft=Ct-Ut,ne=gt*Ft-(Lt-lt*Ut-gt*Ut-lt*Ft),$t=Q*be,mt=nr*Q,lt=mt-(mt-Q),gt=Q-lt,mt=nr*be,Ut=mt-(mt-be),Ft=be-Ut,zt=gt*Ft-($t-lt*Ut-gt*Ut-lt*Ft),Mt=ne-zt,it=ne-Mt,sr[0]=ne-(Mt+it)+(it-zt),At=Lt+Mt,it=At-Lt,Ot=Lt-(At-it)+(Mt-it),Mt=Ot-$t,it=Ot-Mt,sr[1]=Ot-(Mt+it)+(it-$t),Yt=At+Mt,it=Yt-At,sr[2]=At-(Yt-it)+(Mt-it),sr[3]=Yt;const le=Yu(4,Vs,4,sr,jm);Lt=ge*ct,mt=nr*ge,lt=mt-(mt-ge),gt=ge-lt,mt=nr*ct,Ut=mt-(mt-ct),Ft=ct-Ut,ne=gt*Ft-(Lt-lt*Ut-gt*Ut-lt*Ft),$t=Pe*nt,mt=nr*Pe,lt=mt-(mt-Pe),gt=Pe-lt,mt=nr*nt,Ut=mt-(mt-nt),Ft=nt-Ut,zt=gt*Ft-($t-lt*Ut-gt*Ut-lt*Ft),Mt=ne-zt,it=ne-Mt,sr[0]=ne-(Mt+it)+(it-zt),At=Lt+Mt,it=At-Lt,Ot=Lt-(At-it)+(Mt-it),Mt=Ot-$t,it=Ot-Mt,sr[1]=Ot-(Mt+it)+(it-$t),Yt=At+Mt,it=Yt-At,sr[2]=At-(Yt-it)+(Mt-it),sr[3]=Yt;const se=Yu(le,jm,4,sr,zm);Lt=G*ct,mt=nr*G,lt=mt-(mt-G),gt=G-lt,mt=nr*ct,Ut=mt-(mt-ct),Ft=ct-Ut,ne=gt*Ft-(Lt-lt*Ut-gt*Ut-lt*Ft),$t=Q*nt,mt=nr*Q,lt=mt-(mt-Q),gt=Q-lt,mt=nr*nt,Ut=mt-(mt-nt),Ft=nt-Ut,zt=gt*Ft-($t-lt*Ut-gt*Ut-lt*Ft),Mt=ne-zt,it=ne-Mt,sr[0]=ne-(Mt+it)+(it-zt),At=Lt+Mt,it=At-Lt,Ot=Lt-(At-it)+(Mt-it),Mt=Ot-$t,it=Ot-Mt,sr[1]=Ot-(Mt+it)+(it-$t),Yt=At+Mt,it=Yt-At,sr[2]=At-(Yt-it)+(Mt-it),sr[3]=Yt;const Ie=Yu(se,zm,4,sr,Vm);return Vm[Ie-1]}(i,t,e,n,r,o,h)}const Wm=Math.pow(2,-52),th=new Uint32Array(512);class qu{static from(t,e=l1,n=h1){const r=t.length,o=new Float64Array(2*r);for(let s=0;s<r;s++){const a=t[s];o[2*s]=e(a),o[2*s+1]=n(a)}return new qu(o)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let Ft=0;Ft<s;Ft++){const Mt=t[2*Ft],At=t[2*Ft+1];Mt<a&&(a=Mt),At<l&&(l=At),Mt>h&&(h=Mt),At>u&&(u=At),this._ids[Ft]=Ft}const p=(a+h)/2,_=(l+u)/2;let x,w,M,C=1/0;for(let Ft=0;Ft<s;Ft++){const Mt=Ju(p,_,t[2*Ft],t[2*Ft+1]);Mt<C&&(x=Ft,C=Mt)}const G=t[2*x],Q=t[2*x+1];C=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x)continue;const Mt=Ju(G,Q,t[2*Ft],t[2*Ft+1]);Mt<C&&Mt>0&&(w=Ft,C=Mt)}let nt=t[2*w],ct=t[2*w+1],it=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x||Ft===w)continue;const Mt=a1(G,Q,nt,ct,t[2*Ft],t[2*Ft+1]);Mt<it&&(M=Ft,it=Mt)}let mt=t[2*M],lt=t[2*M+1];if(it===1/0){for(let At=0;At<s;At++)this._dists[At]=t[2*At]-t[0]||t[2*At+1]-t[1];Ws(this._ids,this._dists,0,s-1);const Ft=new Uint32Array(s);let Mt=0;for(let At=0,Ot=-1/0;At<s;At++){const Lt=this._ids[At];this._dists[Lt]>Ot&&(Ft[Mt++]=Lt,Ot=this._dists[Lt])}return this.hull=Ft.subarray(0,Mt),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if($l(G,Q,nt,ct,mt,lt)<0){const Ft=w,Mt=nt,At=ct;w=M,nt=mt,ct=lt,M=Ft,mt=Mt,lt=At}const gt=function(Ft,Mt,At,Ot,Lt,ne){const $t=At-Ft,zt=Ot-Mt,Yt=Lt-Ft,ge=ne-Mt,be=$t*$t+zt*zt,Pe=Yt*Yt+ge*ge,Ct=.5/($t*ge-zt*Yt);return{x:Ft+(ge*be-zt*Pe)*Ct,y:Mt+($t*Pe-Yt*be)*Ct}}(G,Q,nt,ct,mt,lt);this._cx=gt.x,this._cy=gt.y;for(let Ft=0;Ft<s;Ft++)this._dists[Ft]=Ju(t[2*Ft],t[2*Ft+1],gt.x,gt.y);Ws(this._ids,this._dists,0,s-1),this._hullStart=x;let Ut=3;n[x]=e[M]=w,n[w]=e[x]=M,n[M]=e[w]=x,r[x]=0,r[w]=1,r[M]=2,o.fill(-1),o[this._hashKey(G,Q)]=x,o[this._hashKey(nt,ct)]=w,o[this._hashKey(mt,lt)]=M,this.trianglesLen=0,this._addTriangle(x,w,M,-1,-1,-1);for(let Ft,Mt,At=0;At<this._ids.length;At++){const Ot=this._ids[At],Lt=t[2*Ot],ne=t[2*Ot+1];if(At>0&&Math.abs(Lt-Ft)<=Wm&&Math.abs(ne-Mt)<=Wm||(Ft=Lt,Mt=ne,Ot===x||Ot===w||Ot===M))continue;let $t=0;for(let Pe=0,Ct=this._hashKey(Lt,ne);Pe<this._hashSize&&($t=o[(Ct+Pe)%this._hashSize],$t===-1||$t===n[$t]);Pe++);$t=e[$t];let zt,Yt=$t;for(;zt=n[Yt],$l(Lt,ne,t[2*Yt],t[2*Yt+1],t[2*zt],t[2*zt+1])>=0;)if(Yt=zt,Yt===$t){Yt=-1;break}if(Yt===-1)continue;let ge=this._addTriangle(Yt,Ot,n[Yt],-1,-1,r[Yt]);r[Ot]=this._legalize(ge+2),r[Yt]=ge,Ut++;let be=n[Yt];for(;zt=n[be],$l(Lt,ne,t[2*be],t[2*be+1],t[2*zt],t[2*zt+1])<0;)ge=this._addTriangle(be,Ot,zt,r[Ot],-1,r[be]),r[Ot]=this._legalize(ge+2),n[be]=be,Ut--,be=zt;if(Yt===$t)for(;zt=e[Yt],$l(Lt,ne,t[2*zt],t[2*zt+1],t[2*Yt],t[2*Yt+1])<0;)ge=this._addTriangle(zt,Ot,Yt,-1,r[Yt],r[zt]),this._legalize(ge+2),r[zt]=ge,n[Yt]=Yt,Ut--,Yt=zt;this._hullStart=e[Ot]=Yt,n[Yt]=e[be]=Ot,n[Ot]=be,o[this._hashKey(Lt,ne)]=Ot,o[this._hashKey(t[2*Yt],t[2*Yt+1])]=Yt}this.hull=new Uint32Array(Ut);for(let Ft=0,Mt=this._hullStart;Ft<Ut;Ft++)this.hull[Ft]=Mt,Mt=n[Mt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(n,r){const o=n/(Math.abs(n)+Math.abs(r));return(r>0?3-o:1+o)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let o=0,s=0;for(;;){const a=n[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=th[--o];continue}const h=a-a%3,u=l+(t+1)%3,p=h+(a+2)%3,_=e[s],x=e[t],w=e[u],M=e[p];if(s1(r[2*_],r[2*_+1],r[2*x],r[2*x+1],r[2*w],r[2*w+1],r[2*M],r[2*M+1])){e[t]=M,e[a]=_;const C=n[p];if(C===-1){let Q=this._hullStart;do{if(this._hullTri[Q]===p){this._hullTri[Q]=t;break}Q=this._hullPrev[Q]}while(Q!==this._hullStart)}this._link(t,C),this._link(a,n[s]),this._link(s,p);const G=h+(a+1)%3;o<th.length&&(th[o++]=G)}else{if(o===0)break;t=th[--o]}}return s}_link(t,e){this._halfedges[t]=e,e!==-1&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function Ju(i,t,e,n){const r=i-e,o=t-n;return r*r+o*o}function s1(i,t,e,n,r,o,s,a){const l=i-s,h=t-a,u=e-s,p=n-a,_=r-s,x=o-a,w=u*u+p*p,M=_*_+x*x;return l*(p*M-w*x)-h*(u*M-w*_)+(l*l+h*h)*(u*x-p*_)<0}function a1(i,t,e,n,r,o){const s=e-i,a=n-t,l=r-i,h=o-t,u=s*s+a*a,p=l*l+h*h,_=.5/(s*h-a*l),x=(h*u-a*p)*_,w=(s*p-l*u)*_;return x*x+w*w}function Ws(i,t,e,n){if(n-e<=20)for(let r=e+1;r<=n;r++){const o=i[r],s=t[o];let a=r-1;for(;a>=e&&t[i[a]]>s;)i[a+1]=i[a--];i[a+1]=o}else{let r=e+1,o=n;Pa(i,e+n>>1,r),t[i[e]]>t[i[n]]&&Pa(i,e,n),t[i[r]]>t[i[n]]&&Pa(i,r,n),t[i[e]]>t[i[r]]&&Pa(i,e,r);const s=i[r],a=t[s];for(;;){do r++;while(t[i[r]]<a);do o--;while(t[i[o]]>a);if(o<r)break;Pa(i,r,o)}i[e+1]=i[o],i[o]=s,n-r+1>=o-e?(Ws(i,t,r,n),Ws(i,t,e,o-1)):(Ws(i,t,e,o-1),Ws(i,t,r,n))}}function Pa(i,t,e){const n=i[t];i[t]=i[e],i[e]=n}function l1(i){return i[0]}function h1(i){return i[1]}function u1(i,t,e){let n=null;const r=new Cn.b;if(i.stopList.sort((s,a)=>s.pos-a.pos),!i.stopList.find(s=>s.pos===0)){const s=i.stopList[0];i.stopList.unshift({pos:0,color:s.color})}if(!i.stopList.find(s=>s.pos===1)){const s=i.stopList[i.stopList.length-1];i.stopList.push({pos:1,color:s.color})}const o=s=>{const a=[];for(let l=0,h=s.length;l<h-1;l++){const u=s[l],p=s[l+1],_=u.pos+.5*(p.pos-u.pos),x=Ra(u.color,p.color,.5),w=2*l;a[w]=u,a[w+1]={color:x,pos:_},a[w+2]=p}return a};if(i.stopList=o(i.stopList),i.stopList=o(i.stopList),n=i.line?Xm(i,t,e):i.path?function(s,a,l){var h,u,p;const _=[],x={x:0,y:0};if(((h=s.path)===null||h===void 0?void 0:h.path)==="circle"||((u=s.path)===null||u===void 0?void 0:u.path)==="rect"||((p=s.path)===null||p===void 0?void 0:p.path)==="shape"){const w=a/2,M=l/2,C=Math.sqrt(w*w+M*M);s.stopList.forEach(G=>{if(G.pos===0)_.push({point:{x:0,y:0},color:G.color});else{const Q=C*G.pos,nt=new Ps;nt.absellipse(0,0,Q,Q,0,2*Math.PI,!1,0),nt.getPoints(50).forEach(ct=>{_.push({point:{x:ct.x,y:ct.y},color:G.color})})}x.x=w,x.y=M})}return{points:_,position:x}}(i,t,e):Xm(i,t,e),n){const s=[],a=[],{position:l,points:h}=n,u=qu.from(h,M=>M.point.x,M=>M.point.y);for(let M=0;M<u.triangles.length;M+=3)s.push(h[u.triangles[M]].point.x,h[u.triangles[M]].point.y),s.push(h[u.triangles[M+1]].point.x,h[u.triangles[M+1]].point.y),s.push(h[u.triangles[M+2]].point.x,h[u.triangles[M+2]].point.y),a.push(...br(h[u.triangles[M]].color)),a.push(...br(h[u.triangles[M+1]].color)),a.push(...br(h[u.triangles[M+2]].color));const p=new ce.l;p.addAttribute("aVertexPosition",s,2),p.addAttribute("aColor",a,4);const _=ce.r.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            float alpha = vColor.a;
            vec4 color = vColor;
            color.a = 1.0;
            gl_FragColor = color * alpha;
        }
    `),x=new er;x.drawRect(0,0,t+1,e+1),r.mask=x,r.addChild(x);const w=new Us.a(p,_);w.position.x=l.x,w.position.y=l.y,r.addChild(w)}return r}function Xm(i,t,e){const n=t/2,r=e/2,o=[{x:-n,y:r},{x:-n,y:-r},{x:n,y:r},{x:n,y:-r}],s=[Bo.fromPointSlope({x:-n,y:0},Math.PI/2),Bo.fromPointSlope({x:0,y:r},0),Bo.fromPointSlope({x:n,y:0},Math.PI/2),Bo.fromPointSlope({x:0,y:-r},0)],a=[],l=i.stopList.slice(1,i.stopList.length-1).map(w=>{var M,C,G;const Q=2*Math.PI;let nt=(C=(M=i.line)===null||M===void 0?void 0:M.ang)!==null&&C!==void 0?C:0;for(;nt>Q;)nt-=Q;for(;nt<0;)nt+=Q;const ct={x:0,y:0};xr(nt,Math.PI/2)?(ct.x=0,ct.y=e/2-w.pos*e):xr(nt,0)?(ct.x=w.pos*t-t/2,ct.y=0):(ct.x=w.pos*t-t/2,ct.y=e/2-w.pos*e),nt>Math.PI/2&&nt<=Math.PI&&(ct.x*=-1),nt>Math.PI&&nt<=2*Math.PI&&(ct.y*=-1);const it=Bo.fromPointSlope(ct,Math.PI/2-(((G=i.line)===null||G===void 0?void 0:G.ang)||0)),mt=s.map(gt=>it.crossPoint(gt)).filter(gt=>gt&&gt.x<=n&&gt.x>=-n&&gt.y<=r&&gt.y>=-r).map(gt=>({point:gt,color:w.color})).sort((gt,Ut)=>Ut.point.y-gt.point.y);a.push(...mt);let lt=Math.abs(mt[1].point.x-mt[0].point.x)/10;for(let gt=20;gt--;){const Ut=gt%2==0?1:-1,Ft=ct.x+Ut*lt,Mt=it.resolveY(Ft);Ft<=n&&Ft>=-n&&Mt<=r&&Mt>=-r&&a.push({point:{x:Ft,y:Mt},color:w.color}),lt+=lt}return it});let h=[],u=[];t:for(let w=0;w<o.length;w++){const M=o[w];for(let ct=0;ct<l.length-1;ct++){const it=l[ct],mt=l[ct+1],lt=it.distanceToLinearEquation(mt),gt=it.distanceToPoint(M),Ut=mt.distanceToPoint(M);if(gt<lt&&Ut<lt){const Ft=i.stopList.slice(1,i.stopList.length-1)[ct],Mt=i.stopList.slice(1,i.stopList.length-1)[ct+1],At=Ra(Ft.color,Mt.color,gt/lt);a.splice(ct+1,0,{point:M,color:At});continue t}}const C=l[0],G=l[l.length-1],Q=C.distanceToPoint(M),nt=G.distanceToPoint(M);Q<=nt?h.push({point:M,dis:Q}):u.push({point:M,dis:nt})}h=h.sort((w,M)=>M.dis-w.dis);const p=h.map((w,M)=>{if(M===0)return{point:w.point,color:i.stopList[0].color};{const C=i.stopList[0].color,G=i.stopList[1].color;return{point:w.point,color:Ra(C,G,1-(h[0].dis===0?1:w.dis/h[0].dis))}}}).sort((w,M)=>M.point.y-w.point.y);u=u.sort((w,M)=>M.dis-w.dis);const _=u.map((w,M)=>{if(M===0)return{point:w.point,color:i.stopList[i.stopList.length-1].color};{const C=i.stopList[i.stopList.length-2].color,G=i.stopList[i.stopList.length-1].color;return{point:w.point,color:Ra(C,G,u[0].dis===0?0:w.dis/u[0].dis)}}}).sort((w,M)=>M.point.y-w.point.y),x=p.concat(...a).concat(_);for(let w=0;w<x.length;w++)x[w].point.x+=n,x[w].point.y=-x[w].point.y+r;return{points:x,position:{x:0,y:0}}}const eh=`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`,c1=[eh],d1={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= arg || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0) * texColor.a;
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0) * texColor.a;
    }
}
`,alphaModFix:`
vec4 transform(vec4 texColor, float arg) {
   return texColor * arg;
}
`,alphaBiLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < arg) {
        result.a = 0.0;
    } else {
        result.a = 1.0;
    }
    return result;
}
`,alphaCeiling:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a > 0.0) {
        result.a = 1.0;
    }
    return result;
}
`,alphaFloor:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < 1.0) {
        result.a = 0.0;
    }
    return result;
}
`,grayscl:`
vec4 transform(vec4 texColor, float arg) {
    float avg = (texColor.r + texColor.g + texColor.b) / 3.0;
    return vec4(avg, avg, avg, texColor.a);
}
`};class p1 extends ce.k{constructor(t,e){var n;super(void 0,(n=d1[t],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${c1.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:e})}}const f1=[eh],m1={clrChange:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    float epsilon = 0.001;
    vec3 colorDiff = arg1.rgb - (texColor.rgb / max(texColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    if (colorDistance < epsilon) {
        arg2.rgb *= arg2.a;
        return arg2;
    } else {
        return texColor;
    }
}
`,changeBulletColor:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    if (texColor.a == 0.0) {
        return texColor;
    } else {
        return arg2;
    }
}
`,duotone:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    // float avg = (texColor.r + texColor.g + texColor.b) / 3.0;
    // vec3 hsl = rgb2hsl(vec3(avg, avg, avg));
    // vec3 result = arg2.rgb * hsl.z + arg1.rgb * (1.0 - hsl.z);
    // return vec4(result * texColor.a, texColor.a);
    
    float brightness = texColor.r * 0.3 + texColor.g * 0.59 + texColor.b * 0.11;
    
    return vec4(
        (arg1.r + brightness * (arg2.r - arg1.r)) * texColor.a,
        (arg1.g + brightness * (arg2.g - arg1.g)) * texColor.a,
        (arg1.b + brightness * (arg2.b - arg1.b)) * texColor.a,
        texColor.a
    );
}
`};class g1 extends ce.k{constructor(t,e,n){var r;super(void 0,(r=m1[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform vec4 arg2;
uniform sampler2D uSampler;

${f1.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:Float32Array.from(e),arg2:Float32Array.from(n)})}}const v1=[eh],_1={lum:`
vec4 transform(vec4 texColor, float arg1, float arg2) {
    vec3 rgb = texColor.rgb / texColor.a;

    // \u5BF9\u6BD4\u5EA6
    highp float C = arg2 * 255.0;
    highp float F = (259.0 * (255.0 + C)) / (255.0 * (259.0 - C));
    rgb.rgb = F * (rgb.rgb - 0.5) + 0.5;

    // \u4EAE\u5EA6
    rgb.rgb += arg1 * rgb.rgb;

    rgb.rgb *= texColor.a;
    return vec4(rgb, texColor.a);
}
`};class y1 extends ce.k{constructor(t,e,n){var r;super(void 0,(r=_1[t],`
varying vec2 vTextureCoord;

uniform float arg1;
uniform float arg2;
uniform sampler2D uSampler;

${v1.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:e,arg2:n})}}const x1=[eh],b1={alphaInv:`
vec4 transform(vec4 texColor, vec4 arg1) {
    float alpha = 1.0 - texColor.a;
    arg1.rgb = arg1.rgb * alpha;
    arg1.a = alpha;
    return arg1;
}
`};class T1 extends ce.k{constructor(t,e){var n;super(void 0,(n=b1[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform sampler2D uSampler;

${x1.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1);
}
`),{arg1:Float32Array.from(e)})}}function Ym(i,t){const e=[];return i.forEach(n=>{const r=((t==null?void 0:t.filter)||[]).indexOf(n.type)>=0;if(["biLevel","alphaBiLevel","alphaCeiling","alphaModFix","alphaFloor","grayscl"].indexOf(n.type)>=0&&r)e.push(new p1(n.type,n.args[0]||0));else if(["clrChange","changeBulletColor","duotone"].indexOf(n.type)>=0&&r){const o=br(n.args[0]),s=br(n.args[1]);e.push(new g1(n.type,o,s))}else if(n.type==="lum"&&r)e.push(new y1(n.type,n.args[0],n.args[1]));else if(n.type==="alphaInv"&&r){const o=br(n.args[0]);e.push(new T1(n.type,o))}}),e}class co{get displayObject(){return this._displayObject||(this._displayObject=this.createDisplayObject()),this._displayObject}set displayObject(t){this._displayObject&&this._displayObject.destroy({children:!0,texture:!0}),this._displayObject=t}get hasFill(){return!!this.fillStyle&&this.fillStyle.fillType!=="noFill"}constructor(t,e,n,r,o){this.ctx=t,this.fillStyle=e,this.width=n,this.height=r,this.config=o,this.clonedObjects=[],this._displayObject=null,this.gradientHash=Zl()(`${JSON.stringify(e)}${Math.ceil(n)}${Math.ceil(r)}`)}createDisplayObject(){var t,e;if(!this.fillStyle)return null;if(this.config.useSlideBackgroundFill&&this.ctx.bgTexture){const n=new di;return n.texture=this.ctx.bgTexture,n}if(this.fillStyle.fillType==="solidFill"||this.fillStyle.fillType==="noFill")return null;if(this.fillStyle.fillType==="gradientFill"){const n=new di,r=u1(JSON.parse(JSON.stringify(this.fillStyle)),this.width,this.height),o=ce.p.create({width:this.width,height:this.height,resolution:this.ctx.renderer.resolution});return this.ctx.renderer.render(r,{renderTexture:o}),r.destroy({children:!0,texture:!0}),n.texture=o,n}if(this.fillStyle.fillType==="blipFill"){const{src:n,filters:r}=this.fillStyle,o=this.ctx.spriteTexture.getTexture(n),s=this.ctx.spriteTexture.getFrameData(n);if(o){const a=new di;if(a.texture=o,r.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(a.filters=Ym(r,this.ctx.featureList)),this.config.fillFloat){const{l,t:h,r:u,b:p}=this.config.fillFloat.fillRect,_=this.width*(1-l-u),x=this.height*(1-h-p),w=((t=this.config.shapeRotation)!==null&&t!==void 0?t:0)+((e=this.config.groupRotation)!==null&&e!==void 0?e:0),M=new er;M.drawRect(0,0,_,x),M.pivot.x=_/2,M.pivot.y=x/2,M.rotation=w;const C=M.getBounds(),G=C.width,Q=C.height;a.width=G,a.height=Q,a.anchor.x=.5,a.anchor.y=.5,a.rotation=-1*w,a.name="math-texture",w===0?(a.position.x=G/2+l*this.width,a.position.y=Q/2+h*this.height):(a.position.x=this.width/2,a.position.y=this.height/2)}else a.width=this.width,a.height=this.height,s.rotate&&(a.position.x=this.width/2,a.position.y=this.height/2,a.anchor.x=.5,a.anchor.y=.5,a.rotation=s.rotate/180*Math.PI);return a}}else if(this.fillStyle.fillType==="gifFill"){const{src:n,delays:r,filters:o}=this.fillStyle,s=this.ctx.spriteTexture.getGifFrames(n).map((u,p)=>({texture:u,time:r[p]||20})),a=new Vl(s,!0);a.name=ss(),a.width=this.width,a.height=this.height,o.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(a.filters=Ym(o,this.ctx.featureList));const l=this.fillStyle.loop;let h=1;return a.onLoop=()=>{h+=1,l>0&&h>l&&a.gotoAndStop(a.totalFrames-1)},a}return null}isSolidFill(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"}getSolidFillColor(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"?this.fillStyle.color:"#000000"}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}class Zu extends ce.k{}var w1=v(113),E1=v.n(w1),S1=v(114),A1=v.n(S1);class M1 extends Zu{constructor(t){super(E1.a,A1.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uGlowColor:br(t.color),uSdfSampler:ce.t.WHITE,uSdfReady:0,uSdfMaxDis:0,uRad:t.rad/2,uSdfPosition:new Float32Array([0,0])}),this.priority=3,this.json=t}filterAreaJustify(t){const e=Math.ceil(this.json.rad),n=Math.ceil(t.width+2*e),r=Math.ceil(t.height+2*e);return new De.j(t.x-e,t.y-e,n,r)}sdfBox(t,e){const n=Math.ceil(this.json.rad),r=Math.ceil(t+2*n),o=Math.ceil(e+2*n);return new De.j(n,n,r,o)}}var C1=v(19),nh=v.n(C1),R1=v(115),I1=v.n(R1);class P1 extends Zu{constructor(t){super(nh.a,I1.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uRad:t.rad,uSdfSampler:ce.t.WHITE,uSdfReady:0,uSdfMaxDis:1}),this.priority=2,this.json=t}filterAreaJustify(t){return t}sdfBox(t,e){return new De.j(0,0,t,e)}}class qm{}var O1=v(116),N1=v.n(O1);class L1 extends ce.k{constructor(t){super(nh.a,N1.a,{uColor:br(t)})}}class D1 extends qm{constructor(t,e,n){super(),this.order=1,this.outputTexture=ce.t.WHITE,this.frameTextures=[],this.json=t,this.effectContainer=e,this.outputSprite=new di,this.targetScale=n,this.outputSprite.scale.x=this.json.sx,this.outputSprite.scale.y=this.json.sy,this.outputSprite.skew.x=(this.targetScale.x>0?1:-1)*this.json.kx,this.outputSprite.skew.y=(this.targetScale.y>0?1:-1)*this.json.ky,this.outputSprite.filters=[new Hs.BlurFilter(this.json.blurRad/2,4),new L1(this.json.color)]}updateFrame(t){const e=this.frameTextures[t];if(e){const n=this.effectContainer.getBounds(),r=(this.effectContainer.width-e.width)/2,o=(this.effectContainer.height-e.height)/2,s=new De.g(n.x,n.y),a=new De.g(n.x,n.y);switch(this.json.align){case"tl":a.x=n.x,a.y=n.y;break;case"t":a.x=n.x+n.width/2,a.y=n.y,s.x+=n.width/2;break;case"tr":a.x=n.x+n.width,a.y=n.y,s.x+=n.width;break;case"l":a.x=n.x,a.y=n.y+n.height/2,s.y+=n.height/2;break;case"ctr":a.x=n.x+n.width/2,a.y=n.y+n.height/2,s.x+=n.width/2,s.y+=n.height/2;break;case"r":a.x=n.x+n.width,a.y=n.y+n.height/2,s.x+=n.width,s.y+=n.height/2;break;case"bl":a.x=n.x,a.y=n.y+n.height,s.y+=n.height;break;case"b":a.x=n.x+n.width/2,a.y=n.y+n.height,s.x+=n.width/2,s.y+=n.height;break;case"br":a.x=n.x+n.width,a.y=n.y+n.height,s.x+=n.width,s.y+=n.height}const l=this.effectContainer.toLocal(a);this.outputSprite.pivot.x=l.x,this.outputSprite.pivot.y=l.y;const h=new De.g(this.json.dist,0),u=new De.d;u.rotate(this.json.dir),u.translate(s.x+r,s.y+o),u.apply({x:h.x,y:h.y},h);const p=this.effectContainer.toLocal(h);this.outputSprite.position.x=p.x,this.outputSprite.position.y=p.y,this.outputSprite.texture=e}}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){}}var F1=v(117),B1=v.n(F1);class k1 extends ce.k{constructor(t,e){super(nh.a,B1.a,{uStartAlpha:t.startAlpha,uEndAlpha:t.endAlpha,uStartPos:t.startPos,uEndPos:t.endPos,uHeight:e}),console.log(this)}}class U1 extends qm{constructor(t,e,n,r,o){super(),this.order=2,this.outputSprite=new di,this.outputTexture=ce.t.WHITE,this.frameTextures=[],this.json=t,this.shapeScaleX=r,this.effectContainer=e,this.rotation=n,this.ctx=o,this.outputSprite.anchor.x=.5,this.outputSprite.anchor.y=.5;const s=this.effectContainer.getBounds();this.outputSprite.filters=[new Hs.BlurFilter(this.json.blurRad/2,4),new k1(this.json,s.height)],this.outputSprite.alpha=.5,this.outputSprite.rotation=this.shapeScaleX===-1?Math.PI+2*this.rotation:Math.PI-2*this.rotation,this.outputSprite.scale.x=-1}updateFrame(t){const e=this.frameTextures[t];e&&(this.outputSprite.texture=e)}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){const n=this.effectContainer.getBounds(),r=new De.g(n.x+n.width/2,n.y+n.height/2),o=new De.g(r.x,r.y+n.height+this.json.dist),s=this.effectContainer.toLocal(o);this.outputSprite.position.x=s.x+t,this.outputSprite.position.y=s.y+e}}var G1=v(118),H1=v.n(G1);class j1 extends Zu{constructor(t){super(nh.a,H1.a,{}),this.priority=1,this.json=t}filterAreaJustify(t){return t}sdfBox(){return null}}var Jm=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Zm extends yi.a{get container(){return this._targetContainer}constructor(t,e,n,r,o,s){super(),this.effects=[],this.attachs=[],this.frames=new Map,this._targetContainer=new Cn.b,this.frameCount=1,this.ctx=r,this.originWidth=t.width,this.originHeight=t.height,this.cacheKey=n,this.sourceSprite=new di;for(const x of e)switch(x.type){case"innerShadow":this.effects.push(new j1(x));break;case"softEdge":this.effects.push(new P1(x));break;case"glow":this.effects.push(new M1(x));break;case"reflection":this.attachs.push(new U1(x,t,o,s.x,this.ctx));break;case"outerShadow":this.attachs.push(new D1(x,t,s))}this.effects=this.effects.sort((x,w)=>x.priority-w.priority),this.attachs=this.attachs.sort((x,w)=>x.order-w.order);for(const x of this.attachs)this._targetContainer.addChild(x.outputSprite);this.sourceSprite.name="source-sprite";const a=new De.j(0,0,this.originWidth,this.originHeight),l=this.effects.map(x=>x.filterAreaJustify(a)),h=l.map(x=>x.x),u=l.map(x=>x.y),p=l.map(x=>x.width),_=l.map(x=>x.height);this.filterArea=new De.j(Math.min(...h,0),Math.min(...u,0),Math.max(...p,this.originWidth),Math.max(..._,this.originHeight)),this.sourceSprite.filters=this.effects,this.sourceSprite.filterArea=new De.j(0,0,this.filterArea.width,this.filterArea.height),this._targetSprite=new di,this._targetSprite.name="effect-sprite",this._targetContainer.sortableChildren=!0,this._targetSprite.zIndex=999,this._targetContainer.addChild(this._targetSprite)}getSdfTexture(t,e){return Jm(this,void 0,void 0,function*(){const n=`${this.cacheKey}_${t}`,r=this.effects.map(o=>({sdfRect:o.sdfBox(e.width,e.height)})).reduce((o,s)=>(s.sdfRect&&(o.width<s.sdfRect.width&&(o.width=s.sdfRect.width),o.height<s.sdfRect.height&&(o.height=s.sdfRect.height)),o),new De.j(0,0));return r.width===0||r.height===0?null:this.ctx.sdfManager.getSdf(e,r,n)})}setFrameCount(t){this.frameCount=t}updateFrame(t){const e=this.frames.get(t);if(e){this._targetSprite.texture=e.texture,this._targetSprite.pivot.x=e.pivotX,this._targetSprite.pivot.y=e.pivotY;for(const n of this.attachs)n.updateFrame(t)}}hasFrame(t){return this.frames.has(t)}setFrameOffset(t,e){this._targetContainer.position.x=-1*t,this._targetContainer.position.y=-1*e,this.attachs.forEach(n=>n.setFrameOffset(t,e))}createFrame(t,e){var n,r;return Jm(this,void 0,void 0,function*(){const o=e.width,s=e.height;if(this.frames.has(t))return;const a=yield this.getSdfTexture(t,e),l=(n=a==null?void 0:a.texture.width)!==null&&n!==void 0?n:0,h=(r=a==null?void 0:a.texture.height)!==null&&r!==void 0?r:0;for(const M of this.effects){const C=M.sdfBox(e.width,e.height);C&&a&&(M.uniforms.uSdfSampler=a.texture,M.uniforms.uSdfIsReady=1,M.uniforms.uSdfMaxDis=a.maxDis,M.uniforms.uSdfPosition=new Float32Array([(a.texture.width-C.width)/2/a.texture.width,(a.texture.height-C.height)/2/a.texture.height])),M.uniforms.uShapeFilterArea=new Float32Array([0,0,this.filterArea.width,this.filterArea.height])}this.sourceSprite.texture=e;const u=(this.filterArea.width-this.sourceSprite.width)/2,p=(this.filterArea.height-this.sourceSprite.height)/2;this.sourceSprite.x=u,this.sourceSprite.y=p;const _=Math.max(o,l,this.filterArea.width),x=Math.max(s,h,this.filterArea.height),w=ce.p.create({width:_,height:x,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.sourceSprite,{renderTexture:w}),this.frames.set(t,{texture:w,pivotX:-1*(this.originWidth-_)/2,pivotY:-1*(this.originWidth-_)/2});for(const M of this.attachs)M.createOutput(w,t);Array.from(this.frames.keys()).length===this.frameCount&&this.emit("ready")})}}var Km=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class z1 extends Xu{constructor(t,e,n){var r;super(t,e,n),this.textureContainer=new Cn.b,this.underline=null,this.cacheSprite=new di,this.effectContainer=new Cn.b,this.effectObject=null;const{shapeId:o,paragraphIndex:s,lineIndex:a,unitIndex:l,lineHeight:h,width:u,underLine:p,fill:_,height:x,isHorz:w,lineWidth:M}=t,C=((r=_==null?void 0:_.fill)===null||r===void 0?void 0:r.fillType)==="solidFill"?_.fill.color:null;if(p){const G=w?h/16:M/16;this.underline=new r1(e,p.type,G,u,x,C,w,o,s,a,l)}if(this.textGraphics=this.createTextGraphics(),this.textFill=this.createTextFill(),this.strokeGraphics=this.createStrokeGraphics(),this.strokeFill=this.createStrokeFill(),this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),t.effectIndexList&&t.effectIndexList.length&&n.effectList){const{effectList:G}=n;this.effectList=t.effectIndexList.map(Q=>{const nt=G[Q];return nt.type==="outerShadow"&&nt.dist>5&&(nt.dist=5),G[Q]}),this.ctx.slideScopeEventHub.once("slide-render",Q=>{if(this.ctx.slideIndex===Q&&this.effectObject){const nt=this.getEffectTexture();if(nt){const{texture:ct,offsetX:it,offsetY:mt}=nt;this.effectObject.setFrameOffset(it,mt),this.effectObject.createFrame(1,ct)}}})}}getEffectTexture(){const{lineHeight:t,fillLineHeight:e,isHorz:n,lineWidth:r}=this.json,o=this.effectContainer.getLocalBounds();let s=0,a=0;for(const u of this.effectContainer.children)u.pivot.x>s&&(s=u.pivot.x),u.pivot.y>a&&(a=u.pivot.y);const l=new De.d;l.translate(s,a);const h=ce.p.create({width:n?o.width:r,height:n?Math.max(e,t):o.height,resolution:2});return this.ctx.renderer.render(this.effectContainer,{renderTexture:h,transform:l}),{texture:h,offsetX:s,offsetY:a}}createStrokeFill(){const{stroke:t,lineWidth:e,lineHeight:n}=this.json;return new co(this.ctx,t==null?void 0:t.fill,e,n,{useFilter:!1,useSlideBackgroundFill:!1})}createStrokeGraphics(){const{stroke:t}=this.json,e=t!=null&&t.key?{fillType:"blipFill",src:t.key,filters:[]}:void 0;return new co(this.ctx,e,(t==null?void 0:t.width)||0,(t==null?void 0:t.height)||0,{useFilter:!1,useSlideBackgroundFill:!1})}applyEffectCacheAsBitMap(){}createTextFill(){const{isHorz:t,fill:e,lineWidth:n,lineHeight:r,fillLineHeight:o}=this.json;return t?new co(this.ctx,e==null?void 0:e.fill,n,Math.max(o,r),{useFilter:!1,useSlideBackgroundFill:!1}):new co(this.ctx,e==null?void 0:e.fill,o,r,{useFilter:!1,useSlideBackgroundFill:!1})}createTextGraphics(){var t;const{fill:e,content:n}=this.json;let r="#000000";((t=e==null?void 0:e.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"&&(r=e.fill.color);const o=e!=null&&e.key?{fillType:"blipFill",src:e.key,filters:[{type:"changeBulletColor",args:["#000000",r]}]}:void 0;return new co(this.ctx,o,(e==null?void 0:e.width)||0,(e==null?void 0:e.height)||0,{useFilter:n==="\u25FE",useSlideBackgroundFill:!1})}getIterateEntry(){return null}getBgElement(){return null}updateTransform(t){var e,n,r,o;const{isHorz:s}=this.json;t.position={x:s&&(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:s?0:(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0},t.width=s?this.json.width:this.json.lineWidth,t.height=s?this.json.lineHeight:this.json.height,super.updateTransform(t)}preRender(){var t;(t=this.underline)===null||t===void 0||t.preRender()}render(t){t.addSubMTask(()=>Km(this,void 0,void 0,function*(){this.doRender()}),"@TextUnitImpl[doRender]"),t.addSubMTask(()=>Km(this,void 0,void 0,function*(){var e;if(this.effectList&&this.effectList.length>0){const n=`${this.ctx.taskId}_${this.ctx.slideIndex}_${(e=this.json.fill)===null||e===void 0?void 0:e.key}_${this.json.effectIndexList}`;this.effectObject=new Zm(this.effectContainer,this.effectList,n,this.ctx,0,new De.g(1,1)),this.effectObject.on("ready",()=>{var r;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(r=this.effectObject)===null||r===void 0||r.updateFrame(1)})}}),"@ShapeImpl[post.render]")}doRender(){let t=!1;const{lineWidth:e,lineHeight:n,baseLine:r,isHorz:o,underline:s,stroke:a,height:l,width:h,highlightColor:u,x:p,y:_,content:x,fillLineHeight:w,fill:M}=this.json;let C=this.json.needFill!==!1;if(M&&M.fill&&M.fill.fillType!=="solidFill"&&(C=!0),u){const G=new er,[Q,nt]=Fm(u);G.beginFill(Q,nt),G.drawRect(0,0,o?h:e,o?n:l),G.endFill(),this.textureContainer.addChild(G)}if(this.textGraphics.displayObject){const G=this.textGraphics.displayObject;if(o&&(G.position.y=_>0?_:0),C){const Q=this.textFill.displayObject;if(Q)Q.mask=G,Q.addChild(G),Q.position.x=-p,G.position.x+=p,t=!0,this.textureContainer.addChild(Q);else if(this.textFill.isSolidFill()){const nt=new as;nt.color=this.textFill.getSolidFillColor(),G.filters=[nt],t=!0,this.textureContainer.addChild(G)}}else this.textureContainer.addChild(G)}if(this.strokeGraphics.displayObject){const G=this.strokeGraphics.displayObject;if(C){const nt=this.strokeFill.displayObject;if(nt)nt.mask=G,nt.addChild(G),o?nt.position.y=_>0?_:0:nt.position.x=p,this.textureContainer.addChild(nt);else if(this.strokeFill.isSolidFill()){o?G.position.y=Math.max(_,0):G.position.x=p;const ct=new as;ct.color=this.strokeFill.getSolidFillColor(),G.filters=[ct],t=!0,this.textureContainer.addChild(G)}}else o?G.position.y=_>0?_:0:G.position.x=p,this.textureContainer.addChild(G);const Q=a&&M?(a.width-(M==null?void 0:M.width))/4:0;G.position.x-=Q}if(this.underline&&(this.underline.render(),this.underline.sprite)){o?(this.underline.sprite.position.y=s?s-n/16:r,this.underline.sprite.position.x=0):(this.underline.sprite.position.x=0,this.underline.sprite.position.y=0);const G=this.textFill.getClonedDisplayObject();G?(G.mask=this.underline.sprite,G.addChild(this.underline.sprite),this.textureContainer.addChild(G)):this.textureContainer.addChild(this.underline.sprite)}if(t){const G=ce.p.create({width:o?h:e,height:o?Math.max(w,n):l,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.textureContainer,{renderTexture:G}),this.cacheSprite.texture=G,o&&_<0&&(this.cacheSprite.position.y=_),this.effectContainer.addChild(this.cacheSprite)}else this.effectContainer.addChild(this.textureContainer);this.container.name=x}destroy(){this.textFill.destroy(),this.textGraphics.destroy(),this.strokeFill.destroy(),this.strokeGraphics.destroy(),this.cacheSprite.texture.destroy(!0),this.cacheSprite.destroy(),this.textureContainer.destroy(),this.container.destroy()}}var Qm=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class V1 extends Xu{constructor(t,e,n){super(t,e,n),this.units=[],this.isHorz=!0,this.hyperLinkMap=new Map,this.hyperLinkContainerMap=new Map,this.effectList=[],n.effectList&&(this.effectList=n.effectList)}getIterateElements(){return this.units}getIterateEntry(t,e,n){return this.units[e]?this.units[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}applyEffectCacheAsBitMap(){}createUnits(t,e,n,r){for(let o=0,s=this.json.textUnits.length;o<s;o++)r.addSubMTask(()=>Qm(this,void 0,void 0,function*(){const a=this.json.textUnits[o],{height:l,width:h,fillHeight:u,baseline:p,y:_,underline:x}=this.json,w=new z1(Object.assign(Object.assign({},a),{lineHeight:l,lineWidth:h,baseLine:p-_,underline:x,fillLineHeight:u||l,isHorz:this.isHorz,shapeId:t,paragraphIndex:e,lineIndex:n,unitIndex:o}),this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});if(w.preRender(),this.units.push(w),a.hyperlink||a.hlinkHover){const M=new Dm(w.container,this.ctx);a.hyperlink&&M.addAction(a.hyperlink,"click"),a.hlinkHover&&M.addAction(a.hlinkHover,"hover"),this.container.sortableChildren=!0}}),"@TextLineImpl[createUnits]")}render(t){for(const e of this.units.reverse())e.render(t),t.addSubMTask(()=>Qm(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextLineImpl[container.addChild]")}destroy(){this.units.forEach(t=>{t.destroy()}),this.container.destroy({children:!1}),this.hyperLinkMap.clear();for(const t of this.hyperLinkContainerMap.values())t.destroy({children:!0,baseTexture:!0,texture:!0});this.hyperLinkContainerMap.clear()}}var $m=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class W1 extends Xu{constructor(t,e,n){super(t,e,n),this.iterateElements=[],this.lines=[],this.effectList=[],this.isHorz=!0,n.effectList&&(this.effectList=n.effectList)}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const t=this.lines.reduce((e,n)=>e=e.concat(n.getIterateElements()),[]);return this.iterateElements=t,t}getIterateEntry(t,e,n){const r=this.getIterateElements();return r[e]?r[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}applyEffectCacheAsBitMap(){}createLines(t,e,n){for(let r=0,o=this.json.lines.length;r<o;r++)n.addSubMTask(()=>$m(this,void 0,void 0,function*(){const s=this.json.lines[r],a=new V1(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=this.isHorz,a.container.name="line-"+r,a.createUnits(t,e,r,n),this.lines.push(a)}),"@TextParagraphImpl[createLines]")}render(t){for(const e of this.lines)e.render(t),t.addSubMTask(()=>$m(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextParagraphImpl[container.addChild]")}destroy(){this.lines.forEach(t=>{t.destroy()}),this.container.destroy({children:!1})}}function X1(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=-Math.sin(o*(Math.PI/180))*e;else{const s=Math.tan(o*Math.PI/180);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=-s*n}return{x:n,y:r}}function Y1(i,t,e,n,r,o){const s=X1((r=-r)/Math.PI*180,e,n),a=i.x-s.x,l=i.y-s.y;return{centerX:a/9525*t.x,centerY:l/9525*t.y,rx:e/9525*t.x,ry:n/9525*t.y,st:-r,end:-r+o,aClockWise:o<0}}function tg(i){const t=new Ps,{scale:e}=i;let n={x:0,y:0};const r=i.path.trim().split(" ");for(let o=0;o<r.length;o+=2){const s=r[o],a=r[o+1];if(s==="M"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.moveTo(l,h)}else if(s==="A"){const[l,h,u,p]=a.split(",").map(nt=>Number(nt)),{centerX:_,centerY:x,rx:w,ry:M,st:C,end:G,aClockWise:Q}=Y1(n,e,l,h,u,p);t.absellipse(_,x,w,M,C,G,Q,0)}else if(s==="L"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.lineTo(l,h)}else if(s==="QB"){let[l,h,u,p]=a.split(",").map(_=>Number(_));n={x:u,y:p},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,t.quadraticCurveTo(l,h,u,p)}else if(s==="CB"){let[l,h,u,p,_,x]=a.split(",").map(w=>Number(w));n={x:_,y:x},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,_=_/9525*e.x,x=x/9525*e.y,t.bezierCurveTo(l,h,u,p,_,x)}else if(s==="C")try{t.closePath()}catch{}}return t}function Bn(i,t){return i.curves.map(e=>e.getPoints(t)).reduce((e,n)=>e.concat(n),[])}const Ku={textCirclePour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textStop:{top:i=>Bn(i,100),bottom:i=>Bn(i,100)},textPlain:{top:i=>Bn(i,100),bottom:i=>Bn(i,100)},textTriangle:{top:i=>Bn(i,50),bottom:i=>Bn(i,101)},textTriangleInverted:{bottom:i=>Bn(i,50),top:i=>Bn(i,101)},textChevron:{bottom:i=>Bn(i,50),top:i=>Bn(i,50)},textChevronInverted:{bottom:i=>Bn(i,50),top:i=>Bn(i,50)},textRingInside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textRingOutside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchUpPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchDownPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave1:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textWave2:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDoubleWave1:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave4:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textInflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDeflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textInflateBottom:{top:i=>Bn(i,180),bottom:i=>i.getPoints(180)},textDeflateBottom:{top:i=>Bn(i,180),bottom:i=>i.getPoints(180)},textInflateTop:{bottom:i=>Bn(i,180),top:i=>i.getPoints(180)},textDeflateTop:{bottom:i=>Bn(i,180),top:i=>i.getPoints(180)},textFadeRight:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeLeft:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textSlantUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textSlantDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCascadeUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCascadeDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textArchUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textArchDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCircle:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)}};function q1(i,t,e,n,r){const o=i.trim().split(" "),[s,a]=o[1].split(",").map(Q=>parseFloat(Q)),[l,h,u,p]=o[3].split(",").map(Q=>parseFloat(Q)),_=function(Q,nt,ct,it,mt,lt){const gt=Math.abs(lt*Math.sqrt((ct*ct+it*it)/2)),Ut=Math.ceil(gt/9525/10);let Ft=0,Mt=mt,At={x:Q+ct*Math.cos(Mt),y:nt+it*Math.sin(Mt)};for(let Ot=0;Ot<Ut;Ot+=1){Mt+=lt/Ut;const Lt={x:Q+ct*Math.cos(Mt),y:nt+it*Math.sin(Mt)};Ft+=Math.sqrt(Math.pow(Lt.x-At.x,2)+Math.pow(Lt.y-At.y,2)),At=Lt}return Ft}(s,a,l,h,u,p);r*=Math.min(1,_/9525/n);const x=new De.d;x.translate(r+t/2,0),x.rotate(2*Math.PI-u);const w=new De.g(0,0),M=x.apply(w);M.x+=t/2,M.y=e/2-M.y;const C=l+9525*r,G=h+9525*r;return`M ${9525*M.x},${9525*M.y} A ${C},${G},${u},${p}`}var Oa=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class J1{get width(){return this.json.width}get height(){return this.json.height}get x(){return this.json.position.x}get y(){return this.json.position.y}set color(t){var e;((e=this.container.filters)!==null&&e!==void 0?e:[]).length>0&&(this.textColorFilter.color=t)}get color(){return this.textColorFilter.color}get on(){var t;return((t=this.container.filters)!==null&&t!==void 0?t:[]).length>0?"true":"false"}set on(t){var e;t==="true"?((e=this.container.filters)!==null&&e!==void 0?e:[]).indexOf(this.textColorFilter)<0&&(this.container.filters=[this.textColorFilter]):this.container.filters=[]}constructor(t,e,n,r,o){var s;this.iterateElements=[],this.paragraphs=[],this.effectList=[],this.container=new Cn.b,this.textContainer=new Cn.b,this.textColorFilter=new as,this.json=t,this.ctx=e,this.shapeRotation=o,this.parentGlobalPos=r,this.iterateType=n,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+t.position.x,y:this.parentGlobalPos.y+t.position.y},this.container.position.x=t.position.x,this.container.position.y=t.position.y,this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y;const a=new er;a.drawRect(0,0,t.width,t.height),this.container.addChild(a),this.container.addChild(this.textContainer),this.textColorFilter.currentColor="#000000FF",this.textColorFilter.designColor="#000000FF",this.effectList=(s=t.effectList)!==null&&s!==void 0?s:[]}getTextElement(t,e){return t==="paragraph"?this.paragraphs[e[0]]:null}getIterateEntry(t,e){return this.iterateElements[t]?this.iterateElements[t]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",e),null)}applyEffectCacheAsBitMap(){}destroy(){this.paragraphs.forEach(t=>{t.destroy()}),this.textColorFilter.destroy()}createParagraphs(t,e){for(let n=0,r=this.json.paragraphs.length;n<r;n++)e.addSubMTask(()=>Oa(this,void 0,void 0,function*(){var o;const s=this.json.paragraphs[n],a=new W1(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=(o=this.json.isHorz)===null||o===void 0||o,a.createLines(t,n,e),e.addSubMTask(()=>Oa(this,void 0,void 0,function*(){this.iterateElements=this.iterateElements.concat(a.getIterateElements()),a.container.name="\u6BB5\u843D-"+n,this.paragraphs.push(a)}),"@TextBodyImpl[paragraphs.push]")}),"@TextBodyImpl[createParagraphs]")}render(t){for(const e of this.paragraphs)e.render(t),t.addSubMTask(()=>Oa(this,void 0,void 0,function*(){this.textContainer.addChild(e.container)}),"@TextBodyImpl[container.addChild]");t.addSubMTask(()=>Oa(this,void 0,void 0,function*(){const{width:e}=this.container;this.container.scale.x<0&&(this.container.x+=-1*e)}),"@TextBodyImpl[reset width]"),t.addSubMTask(()=>Oa(this,void 0,void 0,function*(){if(this.json.presetTextShape){const e=this.json.paragraphs.map(u=>u.x).reduce((u,p)=>Math.min(u,p)),n=this.json.paragraphs[0].y,r=this.textContainer.getBounds(),o=this.json.paragraphs.map(u=>u.lines.map(p=>p.width).sort((p,_)=>p-_)[0]).sort((u,p)=>u-p)[0],{width:s,height:a}=r,{geometry:l,type:h}=this.json.presetTextShape;if(l.paths){const u=ce.p.create({width:o,height:a,resolution:this.ctx.renderer.resolution}),p=new De.d;p.translate(-e,-n),this.ctx.renderer.render(this.textContainer,{renderTexture:u,transform:p});const _=this.json.isHorz!==void 0&&!this.json.isHorz;if(["textCircle","textArchUp","textArchDown"].indexOf(this.json.presetTextShape.type)>=0){const w=q1(l.paths[0].path,this.json.width,this.json.height,s,a);l.paths.unshift(Object.assign(Object.assign({},l.paths[0]),{path:w}))}const x=function(w,M,C,G){if(!Ku[C])return null;const Q=Ku[C].top(tg(M)),nt=Ku[C].bottom(tg(w));if(Q.length!==nt.length)return null;const ct=Math.min(Q.length,nt.length),it=1/(ct-1),mt=[],lt=[],gt=new Array(2*ct).fill("").map((Ut,Ft)=>Ft);for(let Ut=0;Ut<ct;Ut++)mt.push(Q[Ut].x,Q[Ut].y),G?lt.push(1,it*Ut):lt.push(it*Ut,0),mt.push(nt[Ut].x,nt[Ut].y),G?lt.push(0,it*Ut):lt.push(it*Ut,1);return{vertices:new Float32Array(mt),uvs:new Float32Array(lt),drawMode:gn.f.TRIANGLE_STRIP,indices:new Uint16Array(gt)}}(l.paths[1],l.paths[0],h,_);if(x){const w=new Ib.b(u,x.vertices,x.uvs,x.indices,x.drawMode);this.textContainer.visible=!1,this.container.addChild(w)}}}}),"presetTextShape")}}class Z1{constructor(t){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=t.id,this.type=t.type,this.heightSize=t.heightSize,this.widthSize=t.widthSize,this.fillStyle=t.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=t.lineWidth||1,this.position=t.position||{x:0,y:0},this.rotate=t.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"triangle":this.pivot={x:.7*this.width,y:this.height/2};break;case"arrow":case"stealth":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+Zl()(this.path+this.scaleX+this.scaleY),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=3/4;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=3/4;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class Qu{get displayObject(){return this._displayObject}constructor(t,e,n,r,o,s,a,l,h,u,p){this.id=t,this.ctx=e,this.paths=n,this.hash=r,this.nept=o,this.width=s,this.height=a,this.lineStyle=l,this.shouldFill=h,this.bgColor=u,this.lnColor=p,this.clonedObjects=[],this._displayObject=null,this.isRectangle=!1,this.isPureRect=!1,this.isColoredPureRect=!1,this.isRectangle=this.rectangleDetect(n),this.isRectangle&&h?this.bgColor?this.isColoredPureRect=!0:this.isPureRect=!0:this.ctx.graphicsTexture.addGraphics(this.id,this.paths,this.hash,this.nept,this.width,this.height,this.lineStyle,this.ctx.objectPoolGroup,this.shouldFill,this.bgColor,this.lnColor)}pointDis(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}isPoint(t){return Number.isNaN(Number(t.x))||Number.isNaN(Number(t.y))}isSquare(t,e){if(t.join("")!=="MLLLC"&&t.join("")!=="MLLLCC")return!1;const n=e.filter(l=>!this.isPoint(l));if(n.length!==4)return!1;const r=Math.min(...n.map(l=>l.x)),o=Math.min(...n.map(l=>l.y)),s=Math.max(...n.map(l=>l.x)),a=Math.max(...n.map(l=>l.y));for(const l of n)if(l.x!==r&&l.x!==s||l.y!==o&&l.y!==a)return!1;return!0}rectangleDetect(t){if(t.length!==1)return!1;const e=t[0].path.trim().split(" ");if(e.length!==10)return!1;const n=[],r=[];for(let l=0;l<e.length;l+=2){const h=e[l],u=e[l+1],[p,_]=u.split(",").map(x=>Number(x)/100);n.push(h),r.push({x:p,y:_})}if(this.isSquare(n,r))return!0;for(let l=0;l<3;l++){const h=r[l],u=r[l+1];if(h.x!==u.x&&h.y!==u.y)return!1}const o=r.slice(0,4).reduce((l,h)=>l+h.x,0)/4,s=r.slice(0,4).reduce((l,h)=>l+h.y,0)/4;if(Number.isNaN(o)||Number.isNaN(s))return!1;const a={x:o,y:s};return xr(this.pointDis(a,r[0]),this.pointDis(a,r[1]))&&xr(this.pointDis(a,r[0]),this.pointDis(a,r[2]))&&xr(this.pointDis(a,r[0]),this.pointDis(a,r[3]))&&this.pointDis(a,r[0])===this.pointDis(a,r[1])}createDisplayObject(){if(this.isPureRect){const t=new er;return t.beginFill(0,1),t.drawRect(0,0,this.width,this.height),t}if(this.isColoredPureRect&&this.bgColor){const t=new er,[e,n]=Fm(this.bgColor);return t.beginFill(e,n),t.drawRect(0,0,this.width,this.height),t}{const t=new di,e=this.ctx.graphicsTexture.getGraphicsData(this.id);return e?(t.texture=e.texture,t.pivot.x=e.pivot.x,t.pivot.y=e.pivot.y,t.scale.x=e.scale,t.scale.y=e.scale,t):null}}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}render(){this._displayObject=this.createDisplayObject()}isNeedMask(t,e){let n=!1;return this._displayObject&&(n=!(this.isRectangle&&Math.abs(t-this._displayObject.width)<2&&Math.abs(e-this._displayObject.height)<2&&this.shouldFill)),n}addArrows(t){var e;(e=this._displayObject)===null||e===void 0||e.addChild(t)}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}var ih=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const ls={pivot:{x:0,y:0},width:0,height:0};class eg extends Wu{constructor(t,e,n){var r,o,s,a,l,h,u,p,_;super(t,e,n),this.renderContainer=new Cn.b,this.needCacheAsBitMap=!1,this.backgroundGraphics=null,this.effectList=[],this.strokeGraphics=null,this.ghco=null,this.useGroupFill=!1,this.arrowList=[],this.fillColorFilter=new as,this.strokeColorFilter=new as,this.pptColorFilter=new as,this.id="",this.ppt_c=new $b(this),this.fill=new Lm(this),this.stroke=new Kb(this),this.effectObject=null,this.effectContainer=new Cn.b,this.effectDisposer=()=>{},this.json=t,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle,this.useGroupFill=!0),this.id=t.id;const{fillStyle:x,lineStyle:w}=this.json;this.container.sortableChildren=!0,this.container.name=t.id+"_container_[Shape]",this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),this.renderContainer.name=t.id+"_render_container_[Shape]",this.generateArrowList(),this.backgroundFill=this.createBackgroundFill(),this.backgroundGraphics=this.createBackgroundGraphics(),this.strokeFill=this.createStrokeFill(),this.strokeGraphics=this.createStrokeGraphics();try{this.ghco=new Qu(this.json.id+"-path-graphics-text-wrap",this.ctx,(s=(o=(r=this.json.textBody)===null||r===void 0?void 0:r.presetTextShape)===null||o===void 0?void 0:o.geometry.paths)!==null&&s!==void 0?s:[],(h=(l=(a=this.json.textBody)===null||a===void 0?void 0:a.presetTextShape)===null||l===void 0?void 0:l.geometry.hash)!==null&&h!==void 0?h:"",{x:0,y:0},((u=this.json.textBody)===null||u===void 0?void 0:u.width)||100,((p=this.json.textBody)===null||p===void 0?void 0:p.height)||100,{width:2,fill:{fillType:"solidFill",color:"#FF0000FF"}},!1,null,null)}catch(M){this.ctx.logger.error(M.message,this.ctx.taskId)}this.ctx.timingTargets.addTarget(this.id,this),(x==null?void 0:x.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=x.color,this.fillColorFilter.designColor=x.color),((_=w==null?void 0:w.fill)===null||_===void 0?void 0:_.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=w.fill.color,this.strokeColorFilter.designColor=w.fill.color),this.updateTransform(this.json),t.textBody&&(this.text=new J1(t.textBody,this.ctx,t.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y},this.json.rotation||0)),this.container.hitArea=new De.k(1,1,this.json.width,this.json.height),this.ctx.slideScopeEventHub.once("slide-render",M=>{if(this.ctx.slideIndex===M&&this.effectObject){const C=this.getEffectTexture();if(C){const{texture:G,offsetX:Q,offsetY:nt}=C;this.effectObject.setFrameOffset(Q,nt),this.effectObject.createFrame(1,G)}}})}get interactiveContainer(){return this.renderContainer}get strokeActive(){var t,e,n,r,o,s,a;return this.strokeFill.displayObject?((n=(e=(t=this.strokeFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set strokeActive(t){var e,n,r,o,s,a;const{displayObject:l}=this.strokeFill;t?l&&((n=(e=l.filters)===null||e===void 0?void 0:e.indexOf(this.strokeColorFilter))!==null&&n!==void 0?n:-1)<0?l.filters=[this.strokeColorFilter]:((r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.strokeGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.strokeColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.strokeGraphics.displayObject.filters=[this.strokeColorFilter]):l?l.filters=[]:!((a=this.strokeGraphics)===null||a===void 0)&&a.displayObject&&(this.strokeGraphics.displayObject.filters=[])}get pptColorActive(){var t,e;return((e=(t=this.renderContainer.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set pptColorActive(t){this.renderContainer.filters=t?[this.pptColorFilter]:[]}get fillActive(){var t,e,n,r,o,s,a;return this.backgroundFill.displayObject?((n=(e=(t=this.backgroundFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set fillActive(t){var e,n,r,o,s,a;t?this.backgroundFill.displayObject&&((n=(e=this.backgroundFill.displayObject.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0?this.backgroundFill.displayObject.filters=[this.fillColorFilter]:((r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.backgroundGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.fillColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.backgroundGraphics.displayObject.filters=[this.fillColorFilter]):this.backgroundFill.displayObject?this.backgroundFill.displayObject.filters=[]:!((a=this.backgroundGraphics)===null||a===void 0)&&a.displayObject&&(this.backgroundGraphics.displayObject.filters=[])}getTextElement(t,e){var n,r;if(this.json.isMathFallback){if(!this.json.textBody)return this;const o=()=>this.json.textBody.paragraphs[0].lines.length<=1,s=()=>this.json.textBody.paragraphs[0].lines[0].textUnits.length<=1,a=()=>this.json.textBody.paragraphs[0].lines[0].textUnits[0].content.trim()==="";if((()=>this.json.textBody.paragraphs.length<=1)()&&o()&&s()&&a())return this}return(r=(n=this.text)===null||n===void 0?void 0:n.getTextElement(t,e))!==null&&r!==void 0?r:null}getBgElement(){return this}getIterateEntry(t,e,n){return e===0?this:t==="el"?(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null):this.text?this.text.getIterateEntry(e-1,n)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getEffectTexture(){const t=this.effectContainer.getLocalBounds();let e=0,n=0;for(const s of this.effectContainer.children)s.pivot.x>e&&(e=s.pivot.x),s.pivot.y>n&&(n=s.pivot.y);const r=new De.d;if(r.translate(e,n),this.effectContainer.children.length===0)return null;const o=ce.p.create({width:t.width,height:t.height,resolution:this.ctx.renderer.resolution});return this.ctx.renderer.render(this.effectContainer,{renderTexture:o,transform:r}),{texture:o,offsetX:e,offsetY:n}}createStrokeGraphics(){var t,e,n,r;const{id:o,geometry:s,lineStyle:a}=this.json,{width:l,height:h,pivot:u}=(s==null?void 0:s.lineTransform)||ls,p=l||this.json.width,_=h||this.json.height,x=((t=a==null?void 0:a.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?a.fill.color:null;return a&&((e=a.fill)===null||e===void 0?void 0:e.fillType)!=="noFill"?new Qu(o+"-path-graphics",this.ctx,(n=s==null?void 0:s.paths)!==null&&n!==void 0?n:[],(r=s==null?void 0:s.hash)!==null&&r!==void 0?r:"",u||{x:0,y:0},p,_,a,!1,null,x):null}createStrokeFill(){const[t,e]=this.calculateFillObjectOffset(),{geometry:n,lineStyle:r,width:o,height:s}=this.json,a=(n==null?void 0:n.lineTransform)||ls,l=Fo()(r==null?void 0:r.width)?r.width:1;return new co(this.ctx,r==null?void 0:r.fill,(a.width||o)+l+t,Math.max((a.height||s)+l,e),{useFilter:!0,useSlideBackgroundFill:!1})}createBackgroundGraphics(){var t;const{geometry:e,lineStyle:n,fillStyle:r,id:o}=this.json,{width:s,height:a,pivot:l}=(e==null?void 0:e.lineTransform)||ls,h=s||this.json.width,u=a||this.json.height,p=(r==null?void 0:r.fillType)==="solidFill"?r.color:null;return r&&r.fillType!=="noFill"||this.json.isPicture?new Qu(o+"-bg-graphics",this.ctx,(t=e==null?void 0:e.paths)!==null&&t!==void 0?t:[],(e==null?void 0:e.hash)||"",l||{x:0,y:0},h,u,n,!0,p,null):null}createBackgroundFill(){var t,e,n,r;const{fillStyle:o,width:s,height:a,lineStyle:l,geometry:h}=this.json,u=(h==null?void 0:h.fillTransform)||ls,p={useFilter:!0,useSlideBackgroundFill:this.json.useBgFill,fillFloat:this.json.fillFloat,shapeRotation:this.json.rotation,groupRotation:this.option.groupRotation},_=this.useGroupFill&&((t=this.option.groupSize)===null||t===void 0?void 0:t.w)?this.option.groupSize.w:u.width||s,x=this.useGroupFill&&((e=this.option.groupSize)===null||e===void 0?void 0:e.h)?this.option.groupSize.h:u.height||a;return new co(this.ctx,o,_+((n=l==null?void 0:l.width)!==null&&n!==void 0?n:0),x+((r=l==null?void 0:l.width)!==null&&r!==void 0?r:0),p)}createBackground(){var t,e,n,r,o,s,a,l,h,u,p,_;const{pivot:x,width:w,height:M}=((t=this.json.geometry)===null||t===void 0?void 0:t.fillTransform)||ls,{displayObject:C}=this.backgroundFill;C?(this.json.useBgFill&&((n=this.backgroundGraphics)===null||n===void 0?void 0:n.displayObject)?(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,C.pivot.x=((r=this.json.position)===null||r===void 0?void 0:r.x)||0,C.pivot.y=((o=this.json.position)===null||o===void 0?void 0:o.y)||0,this.effectContainer.addChild(this.backgroundGraphics.displayObject)):((s=this.json.fillStyle)===null||s===void 0?void 0:s.fillType)==="gifFill"?(C.height=M||this.designHeight,C.width=w||this.designWidth,C instanceof Vl&&C.play(),!((a=this.backgroundGraphics)===null||a===void 0)&&a.isNeedMask(C.width,C.height)&&(C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))):!((l=this.backgroundGraphics)===null||l===void 0)&&l.isNeedMask(C.width,C.height)&&(this.json.fillFloat||(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))),this.json.fillFloat||(C.x=x.x,C.y=x.y),this.useGroupFill&&(C.x-=(u=(h=this.json.position)===null||h===void 0?void 0:h.x)!==null&&u!==void 0?u:0,C.y-=(_=(p=this.json.position)===null||p===void 0?void 0:p.y)!==null&&_!==void 0?_:0),this.effectContainer.addChild(C)):this.backgroundFill.hasFill&&((e=this.backgroundGraphics)===null||e===void 0?void 0:e.displayObject)&&this.effectContainer.addChild(this.backgroundGraphics.displayObject)}createPathFill(){var t,e,n;const{displayObject:r}=this.strokeFill,o=(t=this.strokeGraphics)===null||t===void 0?void 0:t.displayObject,[s,a]=this.calculateFillObjectOffset();r?(((e=this.strokeGraphics)===null||e===void 0?void 0:e.isNeedMask(r.width,r.height))&&o&&(this.needCacheAsBitMap=!0,r.pivot.x=o.pivot.x,r.pivot.y=o.pivot.y,o.pivot.x=0,o.pivot.y=0,r.mask=o,r.addChild(o),r.position.x=-s/2,r.position.y=-a/2,o.position.x=s/2,o.position.y=a/2),this.effectContainer.addChild(r)):this.strokeFill.hasFill&&((n=this.strokeGraphics)===null||n===void 0?void 0:n.displayObject)&&this.effectContainer.addChild(this.strokeGraphics.displayObject)}createFilledPathMask(){var t,e,n;const r=((e=(t=this.json.geometry)===null||t===void 0?void 0:t.paths)===null||e===void 0?void 0:e.filter(o=>o.fill!=="none"&&o.fill!=="norm"))||[];for(const o of r){const s=this.ctx.graphicsTexture.getGraphicsData(o.id);if(s){const a=new di(s.texture);a.pivot.x=s.pivot.x,a.pivot.y=s.pivot.y,a.scale.x=s.scale,a.scale.y=s.scale;const l=this.backgroundFill.getClonedDisplayObject(),h=(n=this.backgroundGraphics)===null||n===void 0?void 0:n.getClonedDisplayObject(),u=l||h;u&&(this.backgroundFill.displayObject&&(u.pivot.x=this.backgroundFill.displayObject.pivot.x,u.pivot.y=this.backgroundFill.displayObject.pivot.y),u.mask=a,u.filters=[i1[o.fill]],this.needCacheAsBitMap=!0,this.effectContainer.addChild(u),this.effectContainer.addChild(a))}}}createArrow(){this.arrowList.length&&this.arrowList.forEach(t=>{var e;const n=this.ctx.graphicsTexture.getGraphicsData(t.graphicsId);if(n){const{texture:r}=n,o=new di(r);o.pivot.x=t.pivot.x,o.pivot.y=t.pivot.y,o.position.x=t.position.x,o.position.y=t.position.y,o.rotation=t.rotate/180*Math.PI,o.scale.x=n.scale,o.scale.y=n.scale,(e=this.backgroundGraphics)===null||e===void 0||e.addArrows(o)}})}generateArrowList(){var t,e;const{lineArrowList:n,lineStyle:r,id:o}=this.json,s=((t=r==null?void 0:r.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?r.fill.color:null;(e=n||[])===null||e===void 0||e.forEach((a,l)=>{var h,u,p,_,x,w,M,C;const G=new Z1(Object.assign(Object.assign({},a),{position:{x:a.position.x-((p=(u=(h=this.json.geometry)===null||h===void 0?void 0:h.lineTransform)===null||u===void 0?void 0:u.pivot.x)!==null&&p!==void 0?p:0),y:a.position.y-((w=(x=(_=this.json.geometry)===null||_===void 0?void 0:_.lineTransform)===null||x===void 0?void 0:x.pivot.y)!==null&&w!==void 0?w:0)},fillStyle:r==null?void 0:r.fill,lineWidth:(M=r==null?void 0:r.width)!==null&&M!==void 0?M:0}));G.graphicsId=`${o}-arrow-${l}-graphics`,G.textureId=`${o}-arrow-${l}-fill`,this.ctx.graphicsTexture.addGraphics(G.graphicsId,(C=G.paths)!==null&&C!==void 0?C:[],G.hash,{x:0,y:0},G.width,G.height,void 0,this.ctx.objectPoolGroup,!0,s,null),this.arrowList.push(G)})}calculateFillObjectOffset(){let[t,e]=[0,0];return this.arrowList.length&&(t=this.arrowList.reduce((n,r)=>Math.max(n,r.width),0),e=this.arrowList.reduce((n,r)=>Math.max(n,r.height),0)),[t,e]}preRender(t){var e,n,r;const{lineStyle:o,geometry:s}=this.json,{width:a,height:l}=(s==null?void 0:s.lineTransform)||ls,h=a||this.json.width,u=l||this.json.height,p=((e=s==null?void 0:s.paths)===null||e===void 0?void 0:e.filter(x=>x.fill!=="none"&&x.fill!=="norm"))||[],_=((n=o==null?void 0:o.fill)===null||n===void 0?void 0:n.fillType)==="solidFill"?o.fill.color:null;t.addSubMTask(()=>ih(this,void 0,void 0,function*(){for(const x of p)this.ctx.graphicsTexture.addGraphics(x.id,[x],x.hash,((s==null?void 0:s.lineTransform)||ls).pivot,h,u,o,this.ctx.objectPoolGroup,!0,null,_)}),"@ShapeImpl[addGraphics]"),(r=this.text)===null||r===void 0||r.createParagraphs(this.json.id,t)}subClassRender(){return ih(this,void 0,void 0,function*(){})}render(t){t.addSubMTask(()=>ih(this,void 0,void 0,function*(){var e,n;(e=this.strokeGraphics)===null||e===void 0||e.render(),(n=this.backgroundGraphics)===null||n===void 0||n.render(),this.createBackground(),yield this.subClassRender(),this.createFilledPathMask(),this.createPathFill(),this.createArrow()}),"@ShapeImpl[render]"),this.text&&this.text.render(t),t.addSubMTask(()=>ih(this,void 0,void 0,function*(){var e,n,r,o,s,a,l,h,u,p,_,x,w,M,C,G,Q;if(((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="wd"||((n=this.json.textBody)===null||n===void 0?void 0:n.iterateType)==="lt"){if(this.renderContainer.addChild(this.container),this.text){const{x:nt,y:ct}=(r=this.json.scale)!==null&&r!==void 0?r:{x:1,y:1};this.text.container.scale.x=ct<0?-Math.abs(nt):Math.abs(nt),this.text.container.scale.y=ct,this.text.container.position.x=((s=(o=this.json.position)===null||o===void 0?void 0:o.x)!==null&&s!==void 0?s:0)+this.text.x,this.text.container.position.y=((l=(a=this.json.position)===null||a===void 0?void 0:a.y)!==null&&l!==void 0?l:0)+this.text.y,this.text.container.scale.y<0&&(this.text.container.position.y+=this.text.height),this.text.container.scale.x<0&&(this.text.container.position.x+=this.json.width),this.json.textRotation&&(this.text.container.rotation=this.json.textRotation),this.renderContainer.addChild(this.text.container)}}else{if(this.text){if(this.json.textRotation){this.text.container.rotation=this.json.textRotation;const{width:mt,height:lt}=this.text,{x:gt,y:Ut}=this.text.container.position;this.text.container.pivot.x=mt/2,this.text.container.pivot.y=lt/2,this.text.container.x=gt+mt/2,this.text.container.y=Ut+lt/2}if(n1()(this.json.textRotateWithShape)&&!this.json.textRotateWithShape){const mt=this.json.rotation||0;this.text.container.rotation=-mt;const{width:lt}=this.text;this.text.container.position.x=lt}this.text.container.zIndex=100;const nt=(h=this.json.effectList)===null||h===void 0?void 0:h.find(mt=>mt.type==="outerShadow"),ct=(u=this.json.effectList)===null||u===void 0?void 0:u.find(mt=>mt.type==="softEdge"),it=(p=this.json.effectList)===null||p===void 0?void 0:p.find(mt=>mt.type==="glow");nt&&nt.sx!==1||ct||it?this.container.addChild(this.text.container):this.effectContainer.addChild(this.text.container)}this.renderContainer.addChild(this.container)}if(this.json.id==="background"&&this.ctx.hasBackgroundFillShape){const nt=ce.p.create({width:this.json.width,height:this.json.height,resolution:Math.ceil(this.ctx.renderer.resolution)});this.ctx.renderer.render(this.renderContainer,{renderTexture:nt}),this.ctx.bgTexture=nt}if(((_=this.json.fillStyle)===null||_===void 0?void 0:_.fillType)==="noFill"){const nt=(w=(x=this.json.effectList)===null||x===void 0?void 0:x.findIndex(ct=>ct.type==="innerShadow"))!==null&&w!==void 0?w:-1;nt>=0&&((M=this.json.effectList)===null||M===void 0||M.splice(nt,1))}this.json.effectList&&this.json.effectList.length>0&&((C=this.ctx.featureList)===null||C===void 0?void 0:C.effect)&&!this.ctx.forceCanvas&&!this.json.media&&(this.effectObject=new Zm(this.effectContainer,this.json.effectList,`${this.ctx.taskId}_${this.ctx.slideIndex}_${this.json.id}`,this.ctx,this.json.rotation||0,new De.g(((G=this.json.scale)===null||G===void 0?void 0:G.x)||1,((Q=this.json.scale)===null||Q===void 0?void 0:Q.y)||1)),function(nt){var ct,it,mt;return((ct=nt.fillStyle)===null||ct===void 0?void 0:ct.fillType)==="gifFill"||((mt=(it=nt.lineStyle)===null||it===void 0?void 0:it.fill)===null||mt===void 0?void 0:mt.fillType)==="gifFill"||!!nt.picFill&&nt.picFill.fillType==="gifFill"}(this.json)&&this.effectObject.setFrameCount(-1),this.effectObject.on("ready",()=>{var nt;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(nt=this.effectObject)===null||nt===void 0||nt.updateFrame(1),this.applyEffectCacheAsBitMap(!0)}))}),"@ShapeImpl[post.render]")}applyEffectCacheAsBitMap(t){var e,n;((e=this.json.fillStyle)===null||e===void 0?void 0:e.fillType)!=="gifFill"&&((n=this.effectObject)===null||n===void 0||n.container.children.forEach(r=>{r.name!=="effect-sprite"&&(r.cacheAsBitmap=t)}))}clearOnSlideChange(){}initOnReuse(){}destroy(){var t,e,n,r;(t=this.text)===null||t===void 0||t.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.backgroundFill.destroy(),(e=this.backgroundGraphics)===null||e===void 0||e.destroy(),this.strokeFill.destroy(),(n=this.strokeGraphics)===null||n===void 0||n.destroy(),this.renderContainer.destroy(),(r=this.arrowRenderTexture)===null||r===void 0||r.destroy(!0),this.arrowList=[],this.effectDisposer()}}var K1=v(119);const $u=new(v.n(K1)).a,Q1=$u.getDevice(),$1=$u.getBrowser(),rh=$u.getOS(),hs={isDesktop(){let i=!0;return Q1.type==="mobile"&&(i=!1),/Samsung/.test($1.name||"")&&(i=!1),window.__nativeTags&&window.__nativeTags.platform&&(i=!1),i},isIOS(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^ios/i.test(window.__nativeTags.platform)&&(i=!0),rh.name&&/iOS/.test(rh.name)&&(i=!0),i},isAndroid(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^android/i.test(window.__nativeTags.platform)&&(i=!0),rh.name&&/android/i.test(rh.name)&&(i=!0),i},isLowGpuMemory(){var i,t;const e=(t=(i=window.__nativeTags)===null||i===void 0?void 0:i.platform)!==null&&t!==void 0?t:"";if(e){const n=e.split(" ");if(n[1]){if(/^iPad/.test(n[1])){const r=n[1].match(/^iPad(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=6)}if(/^iPhone/.test(n[1])){const r=n[1].match(/^iPhone(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=9)}return!1}return!1}return!0}};var oh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function ir(i,t){for(const e in t)i.style[e]=t[e]}const ko={medianContainerClass:"median-container",hoverHiddeDelay:1500,portalWidth:300,portalHeight:50,hiddenOpacity:"0",hoverOpacity:"1",opacityAnimationTime:.4};class Na{get clippedDuration(){return this.duration}constructor(t){var e,n;this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.fullScreenButton=document.createElement("div"),this.exitFullScreenButton=document.createElement("div"),this.medianIsEnd=!1,this.pickBookmarkIndex=0,this.playCallBackList=[],this.duration=0,this.isVideo=!1,this.start=0,this.end=0,this.fullscreenStatus=!1,this.fadeState={in:!1,out:!1},this.changeMediaProgress=r=>{if(this.ctx.isPlayerPaused())return void this.ctx.logger.info("Media controller prevent seek event with paused state",this.ctx.taskId);r.stopPropagation();const o=r.offsetX/this.progress.clientWidth*this.duration;this.medianIsEnd=!1,this.ctx.mode!=="interactive"&&this.jumpToTime(o),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ze.mediaSeek,{id:this.targetId,time:o,isPlaying:this.media.isPlaying}),this.delayHide()},this.jumpToTime=(r=0)=>oh(this,void 0,void 0,function*(){yield Yl(()=>!!this.duration,3e3);const o=Math.floor(r)+this.start;this.media.currentTime!==o&&(this.media.currentTime=o,this.changeBookmarkIndex(o,o>this.media.currentTime))}),this.showController=r=>{r.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.media.duration,this.start&&(this.duration-=this.start,this.jumpToTime()),this.end&&(this.duration-=this.end)),this.totalTime.innerText=Na.formatTime(this.duration)},this.playMedia=()=>oh(this,void 0,void 0,function*(){this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.media.play(),this.medianIsEnd&&(this.medianIsEnd=!1,this.jumpToTime()),this.playCallBackList.forEach(r=>{r()}),this.delayHide()}),this.pauseMedia=()=>oh(this,void 0,void 0,function*(){this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.media.pause()}),this.onMouseOut=r=>{r.stopPropagation(),this.hide()},this.mediaTimeUpdate=()=>oh(this,void 0,void 0,function*(){const r=this.media.currentTime-this.start;if(this.duration>0&&(Math.abs(r-this.duration)<.3||r>this.duration)&&(yield this.pauseMedia(),this.medianIsEnd=!0,this.jumpToTime(),this.ctx.eventHub.emit(Ze.mediaStop,{id:this.targetId}),this.onClickCancelFullScreenButtonHandle()),this.currentTime.innerText=Na.formatTime(r),this.currentProgress.style.flex=(r/this.duration).toString(),this.bookmarkList&&this.bookmarkList.length>0){const o=this.bookmarkList[this.pickBookmarkIndex];o&&o.time.toFixed(0)===this.media.currentTime.toFixed(0)&&(this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`),this.pickBookmarkIndex+=1)}this.fadeHit(r)}),this.onPauseMedia=()=>{this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.fadeState={in:!1,out:!1},this.fadeHit(0),this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(r=>{r()}),this.media.currentTime<this.start&&this.jumpToTime()},this._playMediaFromCtrl=()=>{this.playMediaFromCtrl(!1)},this._pauseMediaFromCtrl=()=>{this.pauseMediaFromCtrl(!1),this.delayHide()},this.onClickFullScreenButtonHandle=()=>{this.fullscreenPlay()},this.onClickCancelFullScreenButtonHandle=()=>{this.fullscreenStatus=!1,this.media.requestCancelFullscreen(),this.ctx.eventHub.emit(Ze.fullscreenChange,{targetId:this.targetId,state:!1}),this.delayHide()},this.onFullScreenChange=r=>{const{status:o,targetId:s,slideIndex:a}=r;this.changeFullScreenState(o,s,a),this.delayHide()},this.onContainerSizeChange=()=>{this.setControllerPosition()},this.onControllerShowStatusChange=({slideIndex:r,targetId:o,status:s})=>{if(r===this.ctx.slideIndex){if(this.targetId===o){const{hiddenOpacity:a,hoverOpacity:l}=ko;s?(this.mediaController.style.opacity=l,this.mediaController.style.display="flex"):this.mediaController.style.opacity=a}this.delayHide()}},this.targetId=t.targetId,this.ctx=t.ctx,this.height=t.height,this.width=t.width,this.target=t.target,this.media=t.media,this.info=t.info,this.shapeId=t.shapeId,this.canvasElement=t.canvasElement,this.media.type==="video"&&(this.isVideo=!0),this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(e=this.info.cut.start)!==null&&e!==void 0?e:0,this.end=(n=this.info.cut.end)!==null&&n!==void 0?n:0),this.info.bookmarkList&&(this.bookmarkList=this.info.bookmarkList.sort((r,o)=>r.time-o.time))}getMedianContainer(){var t;const{medianContainerClass:e}=ko;let n=(t=this.canvasElement.parentElement)===null||t===void 0?void 0:t.querySelector("."+e);n||(n=document.createElement("div"),n.className=e,this.canvasElement.parentElement.appendChild(n)),this.container=n}static formatTime(t){let e="00:00";if(t){const n=Math.floor(t/60),r=String(n<0?0:n).padStart(2,"0"),o=Math.floor(t%60);e=`${r}:${String(o<0?0:o).padStart(2,"0")}`}return e}generatePlayButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","polyline");return r.setAttributeNS(null,"points","35 0, 477 256, 35 512"),r.setAttributeNS(null,"fill","#000000"),n.appendChild(r),n}generatePauseButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");ir(n,{height:t+"px"}),n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"x","35"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","148"),r.setAttributeNS(null,"height","512");const o=r.cloneNode(!0);return o.setAttributeNS(null,"x","330"),n.append(r,o),n}generateFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");ir(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M918.116352 107.409408c10.186752 10.175488 10.186752 26.691584 0 36.87936L653.734912 407.038976c-10.187776 10.187776-26.703872 10.187776-36.891648 0-10.175488-10.187776-10.175488-26.703872 0.013312-36.891648l264.38144-262.73792c10.174464-10.187776 26.69056-10.200064 36.87936-0.013312L918.117376 107.409408zM878.281728 148.096l-161.155072-0.44544c-11.283456 0.279552-20.85888-8.226816-21.90336-19.458048l0-13.421568c0.318464-10.671104 8.889344-19.241984 19.560448-19.560448l187.030528 0.827392c0.1792-0.037888 0.357376-0.0768 0.523264-0.089088l9.549824-0.229376c5.005312-0.152576 9.843712 1.770496 13.372416 5.336064 3.32288 3.629056 4.9664 8.49408 4.545536 13.40928l-1.032192 9.537536c0 0.191488 0.70144 0.318464 0.70144 0.49664l-0.534528 188.279808c-0.54784 9.984-9.092096 17.637376-19.076096 17.089536-0.165888-0.012288-0.319488-0.0256-0.484352-0.037888L896.009216 329.8304c-10.379264-0.0512-18.733056-8.506368-18.681856-18.885632 0.013312-0.191488 0.013312-0.381952 0.013312-0.585728L878.281728 148.096zM105.884672 916.661248c-10.187776-10.175488-10.200064-26.691584-0.013312-36.87936 0 0 0-0.013312 0.013312-0.013312l265.19552-262.73792c10.35264-10.008576 26.86976-9.729024 36.866048 0.636928 9.766912 10.110976 9.766912 26.131456 0 36.242432L143.579136 916.661248C133.072896 926.848 116.3776 926.848 105.884672 916.661248L105.884672 916.661248zM146.533376 875.973632l161.154048 0.433152c11.283456-0.292864 20.85888 8.213504 21.891072 19.458048l0 13.38368c-0.292864 10.672128-8.876032 19.255296-19.560448 19.561472l-187.858944-0.828416c-0.165888 0.037888-0.344064 0.075776-0.509952 0.089088l-9.550848 0.229376c-5.004288 0.152576-9.831424-1.782784-13.35808-5.336064-3.323904-3.629056-4.979712-8.493056-4.54656-13.395968l1.031168-9.537536c0-0.191488-0.712704-0.330752-0.700416-0.509952l0.534528-188.278784c0.534528-9.984 9.066496-17.625088 19.050496-17.089536 0.165888 0.013312 0.330752 0.0256 0.508928 0.037888l14.212096 0c10.365952 0.0512 18.719744 8.507392 18.656256 18.873344 0 0.191488 0 0.395264-0.013312 0.598016L146.533376 875.973632zM918.116352 916.661248c10.186752-10.175488 10.200064-26.691584 0.012288-36.87936 0 0 0-0.013312-0.012288-0.013312l-264.38144-262.73792c-10.365952-10.008576-26.86976-9.729024-36.87936 0.636928-9.766912 10.110976-9.766912 26.131456 0 36.242432L881.22368 916.661248c10.186752 10.186752 26.703872 10.186752 36.891648 0.013312L918.115328 916.661248 918.116352 916.661248zM878.281728 875.973632l-161.168384 0.433152c-11.270144-0.292864-20.845568 8.213504-21.890048 19.458048l0 13.38368c0.306176 10.672128 8.889344 19.241984 19.560448 19.561472l187.030528-0.828416c0.1792 0.037888 0.357376 0.075776 0.523264 0.089088l9.549824 0.229376c5.005312 0.152576 9.843712-1.782784 13.372416-5.336064 3.32288-3.629056 4.978688-8.493056 4.545536-13.395968l-1.032192-9.537536c0-0.191488 0.70144-0.330752 0.70144-0.509952l-0.534528-188.278784c-0.54784-9.984-9.092096-17.637376-19.076096-17.089536-0.165888 0.013312-0.319488 0.0256-0.484352 0.037888L896.009216 694.19008c-10.379264 0.0512-18.733056 8.507392-18.681856 18.885632 0 0.191488 0.013312 0.381952 0.013312 0.584704L878.281728 875.973632zM105.884672 107.409408c-10.187776 10.175488-10.187776 26.691584 0 36.87936l265.19552 262.750208c10.187776 10.187776 26.691584 10.187776 36.87936 0s10.175488-26.703872-0.012288-36.891648l-264.368128-262.73792C133.072896 97.222656 116.3776 97.222656 105.884672 107.409408L105.884672 107.409408zM146.533376 148.096l161.154048-0.44544c11.283456 0.292864 20.85888-8.213504 21.891072-19.458048l0-13.421568c-0.306176-10.671104-8.889344-19.241984-19.560448-19.560448l-187.858944 0.827392c-0.165888-0.0512-0.344064-0.0768-0.509952-0.089088l-9.550848-0.229376c-5.004288-0.152576-9.831424 1.782784-13.35808 5.336064-3.323904 3.629056-4.979712 8.49408-4.54656 13.40928l1.031168 9.537536c0 0.191488-0.712704 0.318464-0.700416 0.49664l0.534528 188.279808c0.534528 9.970688 9.066496 17.624064 19.050496 17.089536 0.165888-0.012288 0.330752-0.0256 0.508928-0.037888l14.212096 0c10.365952-0.0512 18.719744-8.506368 18.656256-18.87232 0-0.191488 0-0.395264-0.013312-0.598016L146.533376 148.096z"),n.appendChild(r),document.body.appendChild(n),n}generateExitFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");ir(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path"),o=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M716.8 998.4a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 0 1 25.6-25.6h256a25.6 25.6 0 1 1 0 51.2h-230.4v230.4a25.6 25.6 0 0 1-25.6 25.6zM307.2 998.4a25.6 25.6 0 0 1-25.6-25.6v-230.4H51.2a25.6 25.6 0 1 1 0-51.2h256a25.6 25.6 0 0 1 25.6 25.6v256a25.6 25.6 0 0 1-25.6 25.6zM972.8 332.8h-256a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 1 1 51.2 0v230.4h230.4a25.6 25.6 0 1 1 0 51.2zM307.2 332.8h-256a25.6 25.6 0 1 1 0-51.2h230.4V51.2a25.6 25.6 0 1 1 51.2 0v256a25.6 25.6 0 0 1-25.6 25.6z"),o.setAttributeNS(null,"d","M307.2 332.8a25.6 25.6 0 0 1-18.112-7.488L56.896 93.12a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192A25.6 25.6 0 0 1 307.2 332.8zM716.8 332.8a25.6 25.6 0 0 1-18.112-43.712L930.88 56.896a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488zM948.992 974.592a25.6 25.6 0 0 1-18.112-7.488l-232.192-232.192a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192a25.6 25.6 0 0 1-18.112 43.712zM75.008 974.592a25.6 25.6 0 0 1-18.112-43.712l232.192-232.192a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488z"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),n}createButton(){const t={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px",display:"flex",justifyContent:"center",alignItems:"center"};ir(this.playButton,Object.assign(Object.assign({},t),{display:"block"}));const e=this.generatePlayButton();ir(e,{height:"20px"}),this.playButton.appendChild(e),ir(this.pauseButton,Object.assign(Object.assign({},t),{display:"none"}));const n=this.generatePauseButton();if(ir(n,{height:"20px"}),this.pauseButton.appendChild(n),!this.isVideo)return;const r=this.generateFullScreenButton(20,20);this.fullScreenButton.appendChild(r),ir(this.fullScreenButton,Object.assign(Object.assign({},t),{display:"block"}));const o=this.generateExitFullScreenButton(20,20);this.exitFullScreenButton.appendChild(o),ir(this.exitFullScreenButton,Object.assign(Object.assign({},t),{display:"none"}))}createTimer(){const t=document.createElement("div");ir(t,{width:"100px"}),this.currentTime.innerText="00:00";const e=document.createElement("span");return e.innerText="/",t.append(this.currentTime,e,this.totalTime),t}createProgress(){const t={flex:"1",position:"relative"};this.isVideo||(t.marginRight="10px"),ir(this.progress,t);const e=document.createElement("div");ir(e,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(e),ir(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),e.appendChild(this.currentProgress)}fadeHit(t){if(!this.info.fade)return;const{start:e,end:n}=this.info.fade;e&&!this.fadeState.in&&t>=0&&(this.fadeState.in=!0,this.media.fadeIn(0,e)),n&&!this.fadeState.out&&t>=this.duration-n/1e3&&(this.fadeState.out=!0,this.media.fadeOut(0,n))}changeBookmarkIndex(t,e){if(this.bookmarkList&&this.bookmarkList.length!==0){if(this.pickBookmarkIndex>0){for(let n=0;n<this.pickBookmarkIndex;n++)if(this.bookmarkList[n].time>t){this.pickBookmarkIndex=n;break}}if(e){let n=this.pickBookmarkIndex-1;for(let r=0;r<this.bookmarkList.length;r++)this.bookmarkList[r].time<t&&(n=r);for(let r=this.pickBookmarkIndex;r<=n;r++){const o=this.bookmarkList[r];o&&this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`)}this.pickBookmarkIndex=n+1}}}playMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent play event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.playMedia(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ze.mediaPlay,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}pauseMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent pause event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.pauseMedia(),this.ctx.mode==="local"||this.ctx.isRendering||this.ctx.eventHub.emit(Ze.mediaPause,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}setControllerPosition(){var t;const{target:e}=this,{portalWidth:n,portalHeight:r}=ko,{stageWidth:o,stageHeight:s}=this.ctx,a=e.getGlobalPosition(),l=Number((t=this.container)===null||t===void 0?void 0:t.getAttribute("data-scale")),h=o*l,u=1/l*(n>h?h/n:1);a.y=a.y+this.height-r,a.x=Math.max(a.x,0),a.x=Math.min(a.x,o-n*u),a.y=Math.max(a.y,0),a.y=Math.min(a.y,s-r),ir(this.mediaController,{height:r+"px",borderRadius:r/2+"px",width:n+"px",flexDirection:"row",alignItems:"center",position:"absolute",left:a.x+"px",top:a.y+"px",background:"#fff",zIndex:"2",border:"1px solid #ccc",transform:`scale(${u})`,transformOrigin:"0 100%"}),this.fullscreenStatus&&ir(this.mediaController,{left:"0",top:s-r+"px"})}createMediaController(){this.setControllerPosition(),ir(this.mediaController,{display:"none",transition:`opacity ${ko.opacityAnimationTime}s`}),this.createButton();const t=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,t,this.progress),this.isVideo&&this.mediaController.append(this.fullScreenButton,this.exitFullScreenButton),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(t){this.playCallBackList.push(t)}fullscreenPlay(){this.fullscreenStatus=!0,this.ctx.mode!=="interactive"&&this.media.requestFullscreen(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ze.fullscreenChange,{targetId:this.targetId,state:!0}),this.delayHide()}changeFullScreenState(t,e,n){n===this.ctx.slideIndex&&(t&&this.targetId===e?this.fullscreenStatus=t:this.fullscreenStatus=!1,this.fullscreenStatus?(this.fullScreenButton.style.display="none",this.exitFullScreenButton.style.display="block"):(this.fullScreenButton.style.display="block",this.exitFullScreenButton.style.display="none"),this.setControllerPosition())}bindEvent(){hs.isDesktop()&&(this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.mediaController.addEventListener("mouseover",this.showController,!1)),this.progress.addEventListener("click",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.addEventListener("click",this._pauseMediaFromCtrl,!1),this.media.on("durationchange",this.getMediaDuration,!1),this.media.on("timeupdate",this.mediaTimeUpdate,!1),this.media.on("pause",this.onPauseMedia,!1),this.media.on("play",this.onPlayMedia,!1),this.containerObserver=new MutationObserver(this.onContainerSizeChange),this.container&&this.containerObserver.observe(this.container,{attributes:!0,attributeFilter:["data-scale","style"]}),this.isVideo&&(this.ctx.globalEventHub.on("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.on("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.addEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.addEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}unbindEvent(){var t;hs.isDesktop()&&(this.mediaController.removeEventListener("mouseout",this.onMouseOut,!1),this.mediaController.removeEventListener("mouseover",this.showController,!1)),this.progress.removeEventListener("click",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.removeEventListener("click",this._pauseMediaFromCtrl,!1),this.media.removeAllListeners(),(t=this.containerObserver)===null||t===void 0||t.disconnect(),this.isVideo&&(this.ctx.globalEventHub.removeListener("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.removeListener("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.removeEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.removeEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}show(){this.setControllerPosition(),this.mediaController.style.opacity=ko.hoverOpacity,this.fullscreenStatus||(this.mediaController.style.display="flex"),this.delayHide()}hide(){this.fullscreenStatus?this.mediaController.style.opacity=ko.hiddenOpacity:this.mediaController.style.display="none"}delayHide(){clearTimeout(this.autoHiddenTimer),this.autoHiddenTimer=setTimeout(()=>{this.hide()},ko.hoverHiddeDelay)}destroy(){var t;this.unbindEvent(),this.playCallBackList=[],(t=this.container)===null||t===void 0||t.removeChild(this.mediaController)}}var tT=v(120);class tc extends yi.a{constructor(t,e,n){var r,o;super(),this.isGlobalPause=!1,this.lastTime=-1,this.howl=null,this.rctClient=null,this.isHowlEnd=!1,this.isHowlLoadEmit=!1,this.staticEventId=1001,this._catParams=void 0,this.url=t,this.runningAudio=e,n&&(this._catParams=n),ar.RtcAudioClazz?(this.rctClient=new ar.RtcAudioClazz(t,(r=this._catParams)===null||r===void 0?void 0:r.start,(o=this._catParams)===null||o===void 0?void 0:o.end),this.rctClient.on("load",()=>this.emit("load")),this.rctClient.on("pause",()=>this.emit("pause")),this.rctClient.on("play",()=>{this.startTimeChangeEmit(),this.emit("play")}),this.rctClient.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{this.emit("resumeAllAudioInterruptByAudioSessionChanged")})):(this.howl=new tT.Howl({src:[t]}),[this.staticEventId]=this.howl._getSoundIds(),this.howl.load(),this.howl.on("load",()=>{this.isHowlLoadEmit=!0,this.emit("load")}),this.howl.on("pause",()=>this.emit("pause")),this.howl.on("play",()=>{this.isHowlLoadEmit||this.emit("load"),this.isHowlEnd=!1,this.startTimeChangeEmit(),this.emit("play")}),this.howl.on("end",()=>{this.isHowlEnd=!0}))}startTimeChangeEmit(){this.currentTime!==this.lastTime&&(this.lastTime=this.currentTime,this.emit("timeupdate",this.lastTime)),this.isPaused||setTimeout(()=>{this.isPaused||this.startTimeChangeEmit()},300)}play(){var t,e,n;this.runningAudio.has(this.url)&&((t=this.runningAudio.get(this.url))===null||t===void 0||t.stop(),this.runningAudio.delete(this.url)),this.isHowlEnd=!1,this.lastTime=-1,(e=this.howl)===null||e===void 0||e.play(this.staticEventId),(n=this.rctClient)===null||n===void 0||n.play(),this.runningAudio.set(this.url,this)}fade(t,e,n){this.howl&&this.howl.fade(t,e,n)}pause(){var t,e;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),(e=this.rctClient)===null||e===void 0||e.pause(),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}globalPause(){this.isPaused||(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}stop(){var t;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),this.rctClient&&(this.rctClient.pause(),this.rctClient.currentTime=0),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}destroy(){var t,e,n,r,o,s,a,l;(t=this.howl)===null||t===void 0||t.stop(this.staticEventId),(e=this.howl)===null||e===void 0||e.unload(),(n=this.rctClient)===null||n===void 0||n.pause(),(r=this.rctClient)===null||r===void 0||r.destroy(),(o=this.rctClient)===null||o===void 0||o.removeAllListeners("load"),(s=this.rctClient)===null||s===void 0||s.removeAllListeners("play"),(a=this.rctClient)===null||a===void 0||a.removeAllListeners("pause"),(l=this.rctClient)===null||l===void 0||l.removeAllListeners("resumeAllAudioInterruptByAudioSessionChanged"),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}get currentTime(){return this.rctClient?this.rctClient.currentTime:this.howl?this.howl.seek(this.staticEventId):-1}set currentTime(t){this.rctClient?this.rctClient.currentTime=t:this.howl&&this.howl.seek(t,this.staticEventId)}get duration(){return this.rctClient?this.rctClient.duration:this.howl?this.howl.duration(this.staticEventId):0}get isPaused(){return this.rctClient?this.rctClient.isPaused:!!this.howl&&!this.howl.playing(this.staticEventId)}volume(t){this.rctClient?this.rctClient.volume(t):this.howl&&this.howl.volume(t)}}var ng=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class eT extends yi.a{get videoElement(){return this.videoResource.source}get currentTime(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.currentTime)!==null&&e!==void 0?e:0}set currentTime(t){this.rtcAudio.currentTime=t,this.videoElement&&(this.videoElement.currentTime=t)}get paused(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.paused)===null||e===void 0||e}get duration(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.duration)!==null&&e!==void 0?e:0}get clippedDuration(){return this.controller.clippedDuration}constructor(t){var e,n,r,o,s,a,l;super(),this.type="video",this.sprite=new di,this.isPlaying=!1,this.isGlobalPause=!1,this.fullscreen=!1,this.url="",this.isLoaded=!1,this.onVideoResourceLoaded=()=>{this.isLoaded=!0},this.onVideoStalled=()=>{this.ctx.logger.warn(this.url+", Failed to fetch data, but trying.",this.ctx.taskId)},this.updateVolume=C=>{this.rtcAudio.volume(C)},this.syncFullscreenVideoState=C=>{const{targetId:G,state:Q,slideIndex:nt}=C;nt===this.ctx.slideIndex&&G===this.id&&(Q?(this.requestFullscreen(),this.ctx.latestChangeFullscreenTargetId=G):this.requestCancelFullscreen())},this.id=t.id,this.start=(e=t.video.cut)===null||e===void 0?void 0:e.start,this.end=(n=t.video.cut)===null||n===void 0?void 0:n.end,this.fullscreen=(r=t.video.fullscreen)!==null&&r!==void 0&&r,this.container=t.container,this.ctx=t.ctx,this.ctx.medias[this.id]=this;const h=t.video.src;this.videoResource=new ce.w(h,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0}),(o=this.videoElement)===null||o===void 0||o.addEventListener("stalled",this.onVideoStalled),(s=this.videoElement)===null||s===void 0||s.addEventListener("loadedmetadata",this.onVideoResourceLoaded),this.url=t.video.src;let u=t.video.src.replace(/4$/,"3");this.ctx.loaderDelegate&&(u=this.ctx.loaderDelegate.redirectMedia(u),this.ctx.logger.info(`redirect media url from ${t.video.src.replace(/4$/,"3")} to ${u} by delegate.`,t.ctx.taskId)),this.rtcAudio=new tc(u,t.ctx.runningAudio,{start:(a=t.video.cut)===null||a===void 0?void 0:a.start,end:(l=t.video.cut)===null||l===void 0?void 0:l.end}),this.rtcAudio.on("timeupdate",C=>{if(this.videoElement){const G=this.videoElement.currentTime;Math.abs(G-C)>.5&&(this.videoElement.currentTime=C)}}),this.rtcAudio.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{var C;(C=this.videoElement)===null||C===void 0||C.pause(),setTimeout(()=>{var G;this.rtcAudio.isPaused||(G=this.videoElement)===null||G===void 0||G.play()},200)});const{video:p,width:_,height:x,target:w}=t;this.controller=new Na({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,width:_,height:x,target:w,media:this,info:p,canvasElement:t.canvasElement}),this.controller.addPlayCallBack(()=>{this.sprite.width=_,this.sprite.height=x,this.ctx.clock.setTimeout(()=>{this.sprite.visible=!0},50)});const M=new ce.c(null,{height:x,width:_});M.resource=this.videoResource,this.videoResource.bind(M),this.sprite=new di,this.sprite.visible=!1,this.sprite.texture=new ce.t(M),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",C=>{C.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",C=>{C.stopPropagation(),this.controller.hide()}),["durationchange","timeupdate","pause","play"].forEach(C=>{var G;(G=this.videoElement)===null||G===void 0||G.addEventListener(C,()=>{C==="timeupdate"&&this.isPlaying,this.emit(C)})}),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume),this.ctx.globalEventHub.on("syncFullscreenVideoState",this.syncFullscreenVideoState)}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return ng(this,void 0,void 0,function*(){this.isPlaying=!0,this.updateVolume(this.ctx.volumeAdjuster.volume),yield this.load(),yield this.ctx.clock.waitUntil(()=>{const e=this.videoElement;return!!(e&&e.videoWidth>0)},3e3);const t=this.videoElement;t&&t.videoWidth<=0||(this.videoElement&&(this.videoElement.volume=0,this.videoElement.muted=!0),this.rtcAudio.on("play",()=>{var e;(e=this.videoElement)===null||e===void 0||e.play(),this.fullscreen&&this.controller.fullscreenPlay()}),this.rtcAudio.play())})}load(){return this.videoResource.load()}pause(){var t;this.isPlaying=!1,this.ctx.logger.warn(this.url+", pause video manual.",this.ctx.taskId),this.ctx.logger.warn(this.url+", pause rtc audio manual.",this.ctx.taskId),this.rtcAudio.once("pause",()=>{var e;(e=this.videoElement)===null||e===void 0||e.pause()}),this.rtcAudio.pause(),(t=this.videoElement)===null||t===void 0||t.pause()}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.controller.jumpToTime(t)}stop(){this.rtcAudio.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(Ze.mediaStop,{id:this.id})}requestFullscreen(){return ng(this,void 0,void 0,function*(){yield Yl(()=>this.isLoaded,5e3);const t=new ce.t(this.sprite.texture.baseTexture);this.ctx.globalEventHub.emit("requestFullscreen",{texture:t,index:this.ctx.slideIndex,targetId:this.id})})}requestCancelFullscreen(){this.ctx.globalEventHub.emit("requestCancelFullscreen",{targetId:this.id,index:this.ctx.slideIndex})}destroy(){var t,e,n;this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.ctx.globalEventHub.removeListener("syncFullscreenVideoState",this.syncFullscreenVideoState),(t=this.videoElement)===null||t===void 0||t.removeEventListener("stalled",this.onVideoStalled),(e=this.videoElement)===null||e===void 0||e.removeEventListener("loadedmetadata",this.onVideoResourceLoaded),this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(n=this.videoResource)===null||n===void 0||n.destroy(),this.rtcAudio.destroy(),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this)}fadeIn(t,e){this.rtcAudio.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){this.rtcAudio.fade(this.ctx.volumeAdjuster.volume,t,e)}}var nT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class iT extends yi.a{constructor(t){var e,n;super(),this.type="audio",this.isPlaying=!1,this.isGlobalPause=!1,this.updateVolume=l=>{this.audioPlayer.volume(l)},this.id=t.id;const r=t.audio.src;this.audioPlayer=new tc(r,t.ctx.runningAudio,{start:(e=t.audio.cut)===null||e===void 0?void 0:e.start,end:(n=t.audio.cut)===null||n===void 0?void 0:n.end}),t.audio.cut&&(this.start=t.audio.cut.start,this.end=t.audio.cut.end),this.ctx=t.ctx,this.ctx.medias[this.id]=this;const{width:o,height:s,target:a}=t;this.controller=new Na({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,height:s,width:o,target:a,media:this,info:t.audio,canvasElement:t.canvasElement}),this.audioPlayer.on("load",()=>this.emit("durationchange")),this.audioPlayer.on("timeupdate",()=>this.emit("timeupdate")),this.audioPlayer.on("pause",()=>this.emit("pause")),this.audioPlayer.on("play",()=>this.emit("play")),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume)}get currentTime(){return this.audioPlayer.currentTime}set currentTime(t){this.audioPlayer.currentTime=t}get clippedDuration(){return this.controller.clippedDuration}get paused(){return this.audioPlayer.isPaused}get isPaused(){return this.audioPlayer.isPaused}get duration(){return this.audioPlayer.duration}load(){return Promise.resolve()}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return nT(this,void 0,void 0,function*(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent play event with paused state",this.ctx.taskId):(this.updateVolume(this.ctx.volumeAdjuster.volume),this.isPlaying=!0,this.audioPlayer.play())})}pause(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent pause event with paused state",this.ctx.taskId):(this.isPlaying=!1,this.audioPlayer.pause())}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent seek event with paused state",this.ctx.taskId):this.controller.jumpToTime(t)}stop(){this.audioPlayer.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(Ze.mediaStop,{id:this.id})}requestFullscreen(){}requestCancelFullscreen(){}destroy(){this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this),this.audioPlayer.destroy()}fadeIn(t,e){this.audioPlayer.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){this.audioPlayer.fade(this.ctx.volumeAdjuster.volume,t,e)}}var ig=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class rT extends eg{constructor(t,e,n){super(Object.assign(Object.assign({},t),{type:"Shape",useBgFill:!1,textRotateWithShape:!0,isPicture:!0}),e,n),this.isInteractiveOutside=!1,this.cmd=new Qb(this),this.onSlideRenderPlayGif=(r,o)=>{var s;const{displayObject:a}=this.picFill;a&&a instanceof Vl&&this.ctx.slideIndex===r&&((s=this.effectObject)===null||s===void 0||s.setFrameCount(a.totalFrames),o?a.gotoAndPlay(0):a.gotoAndStop(a.totalFrames-1),a.onFrameChange=l=>{if(this.effectObject)if(this.effectObject.hasFrame(l))this.effectObject.updateFrame(l);else{const h=this.getEffectTexture();h&&(this.effectObject.createFrame(l,h.texture),this.effectObject.setFrameOffset(h.offsetX,h.offsetY))}})},this.media=t==null?void 0:t.media,this.container.name=t.id+"_container_[Picture]",this.renderContainer.name=t.id+"_render_container_[Picture]",this.picFill=new co(this.ctx,t.picFill,t.width,t.height,{useFilter:!0,useSlideBackgroundFill:!1})}applyCommand(t,e){var n,r,o,s;if(e==="call")if(/playFrom\(([0-9.]+)\)/.test(t)){const a=t.match(/playFrom\(([0-9.]+)\)/),l=Number(a[1]||"0");(n=this.mediaPlayer)===null||n===void 0||n.controller.playMediaFromCtrl(!0),Math.abs(l)>.1&&((r=this.mediaPlayer)===null||r===void 0||r.controller.jumpToTime(l))}else t==="custom-pause"?(o=this.mediaPlayer)===null||o===void 0||o.controller.pauseMediaFromCtrl(!0):t==="togglePause"?this.mediaPlayer&&(this.mediaPlayer.isPlaying?this.mediaPlayer.controller.pauseMediaFromCtrl(!0):this.mediaPlayer.controller.playMediaFromCtrl(!0)):t==="stop"&&((s=this.mediaPlayer)===null||s===void 0||s.stop())}applyEffectCacheAsBitMap(t){var e,n,r;((e=this.json.fillStyle)===null||e===void 0?void 0:e.fillType)==="gifFill"||this.media&&this.media.type==="video"||((n=this.json.picFill)===null||n===void 0?void 0:n.fillType)==="gifFill"||(r=this.effectObject)===null||r===void 0||r.container.children.forEach(o=>{o.name!=="effect-sprite"&&(o.cacheAsBitmap=t)})}renderPic(){var t,e,n,r,o,s;return ig(this,void 0,void 0,function*(){const{displayObject:a}=this.picFill;if(a){a.name=this.json.id+"_pic_fill_[Picture]";const l=(t=this.backgroundGraphics)===null||t===void 0?void 0:t.getClonedDisplayObject();if(((e=this.backgroundGraphics)===null||e===void 0?void 0:e.isNeedMask(a.width,a.height))&&l&&(a.mask=l,this.effectContainer.addChild(l)),a.width=this.designWidth,a.height=this.designHeight,a instanceof Vl&&this.ctx.slideScopeEventHub.on("slide-render",this.onSlideRenderPlayGif),this.effectContainer.addChild(a),this.media){let h=this.media.src;if(this.media.type==="audio"&&/mp4$/.test(h)&&(h=h.replace(/mp4$/,"mp3")),this.ctx.urlInterrupter){const u=Date.now();h=yield this.ctx.urlInterrupter(h),this.ctx.logger.info("redirect media url by interrupter. time: "+(Date.now()-u),this.ctx.taskId)}this.ctx.loaderDelegate&&(h=this.ctx.loaderDelegate.redirectMedia(h),this.ctx.logger.info(`redirect media url to ${h} by delegate.`,this.ctx.taskId)),this.media.src=h}if(((n=this.media)===null||n===void 0?void 0:n.type)==="video"&&this.media.src){if(this.mediaPlayer=new eT({id:this.json.id+"-video",shapeId:this.json.id,ctx:this.ctx,video:this.media,height:this.designHeight,width:this.designWidth,target:a,container:this.effectContainer,canvasElement:this.ctx.view}),((r=this.mediaPlayer)===null||r===void 0?void 0:r.sprite)&&l){const h=(o=this.backgroundGraphics)===null||o===void 0?void 0:o.getClonedDisplayObject();h&&(this.mediaPlayer.sprite.mask=h,this.container.addChild(h))}}else((s=this.media)===null||s===void 0?void 0:s.type)==="audio"&&this.media.src&&(this.mediaPlayer=new iT({id:this.json.id+"-audio",shapeId:this.json.id,ctx:this.ctx,audio:this.media,height:this.designHeight,width:this.designWidth,target:a,canvasElement:this.ctx.view,fade:this.media.fade}));this.mediaPlayer&&(this.isInteractiveOutside=!!this.container.interactive,this.container.interactive=!0,hs.isDesktop()?(this.container.on("mouseover",()=>{this.mediaPlayer.showController()}),this.container.on("mouseout",()=>{this.mediaPlayer.hideController()},!1)):this.container.on("pointerdown",()=>{this.mediaPlayer.showController()}))}})}preRender(t){super.preRender(t)}subClassRender(){return ig(this,void 0,void 0,function*(){yield this.renderPic()})}clearOnSlideChange(){super.clearOnSlideChange(),this.mediaPlayer&&(this.container.interactive=!1,this.mediaPlayer.stop(),this.mediaPlayer.hideController())}initOnReuse(){super.initOnReuse(),this.mediaPlayer&&(this.container.interactive=!0)}destroy(){this.mediaPlayer&&(this.picFill.displayObject&&!this.isInteractiveOutside&&(this.container.interactive=!1),this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picFill.destroy(),this.ctx.slideScopeEventHub.removeListener("slide-render",this.onSlideRenderPlayGif)}}var sh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class ec extends Wu{constructor(t,e,n,r){super(t,e,n),this.children=[],this.cacheSprite=new di,this.cacheContainer=new Cn.b,this.json=t,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle),this.container.name=t.id+"_container_[Container]",this.cacheContainer.name=t.id+"_cache_container_[Container]",this.ctx.timingTargets.addTarget(t.id,this),this.updateTransform(this.json),this.fillObject=new co(this.ctx,t.fillStyle,t.width,t.height,{useFilter:!1,useSlideBackgroundFill:!1}),this.createChildren(r)}createChildren(t){var e,n,r,o;const s={x:(n=(e=this.json.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:(o=(r=this.json.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0};for(let a=0,l=this.json.children.length;a<l;a++)t.addSubMTask(()=>sh(this,void 0,void 0,function*(){var h,u,p,_;let x=this.json.children[a],w=null;if(!(!this.ctx.featureList||!this.ctx.featureList.smartArt)&&((x==null?void 0:x.type)==="Shape"||(x==null?void 0:x.type)==="Picture")&&this.ctx.smartArtShapeList){const{id:C}=x,G=this.ctx.smartArtShapeList.find(Q=>Q.id===C);G&&(x=G)}const M={parentGlobalPos:s,groupFillStyle:(h=this.json.fillStyle)!==null&&h!==void 0?h:{fillType:"noFill"},groupSize:{w:this.json.width,h:this.json.height},groupRotation:((u=this.json.rotation)!==null&&u!==void 0?u:0)+((_=(p=this.option)===null||p===void 0?void 0:p.groupRotation)!==null&&_!==void 0?_:0)};(x==null?void 0:x.type)==="Shape"?w=new eg(x,this.ctx,M):(x==null?void 0:x.type)==="Picture"?w=new rT(x,this.ctx,M):(x==null?void 0:x.type)==="Container"&&(w=new ec(x,this.ctx,M,t)),w&&this.children.push(w)}),"@ContainerImpl[child.init]")}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(t){for(const e of this.children)t.addSubMTask(()=>sh(this,void 0,void 0,function*(){e.preRender(t)}),"@ContainerImpl[child.preRender]")}getBgElement(){return null}getIterateEntry(t,e,n){return e===0?this:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getTextElement(){return null}render(t){for(const e of this.children)e.render(t),t.addSubMTask(()=>sh(this,void 0,void 0,function*(){this.cacheContainer.addChild(e.renderContainer)}),"@ContainerImpl[child.render]");t.addSubMTask(()=>sh(this,void 0,void 0,function*(){this.container.addChild(this.cacheContainer)}),"@ContainerImpl[child.append]")}applyEffectCacheAsBitMap(t){this.children.forEach(e=>e.applyEffectCacheAsBitMap(t))}clearOnSlideChange(){this.children.forEach(t=>t.clearOnSlideChange())}initOnReuse(){this.children.forEach(t=>t.initOnReuse())}isChildrenInteractive(){for(const t of this.json.children)if((t==null?void 0:t.type)==="Container"||(t==null?void 0:t.type)==="Stage"||(t==null?void 0:t.hlinkHover)||(t==null?void 0:t.hlinkClick))return!0;return!1}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(t=>t.destroy()),this.container.destroy({children:!0,texture:!0,baseTexture:!0}),this.cacheContainer.destroy({children:!0,texture:!0,baseTexture:!0})}}class La extends yi.a{constructor(t,e,n,r){super(),this.cond={},this.timeoutIds=[],this.condHandle=(o,s={})=>{if(o)if(o.delay&&o.delay>0){const a=this.ctx.clock.setTimeout(()=>{o.event&&(this.cond[o.event]=!0,this.detectTrigger(s))},o.delay);this.timeoutIds.push(a)}else this.cond[o.event]=!0,this.detectTrigger(s);else this.detectTrigger(s)},this.id=t,this.ctx=r,this.eventHubs=n,e.forEach(o=>{this.addCond(o)})}setTriggerParams(t){this.triggerParams=t}addCond(t){const e=(...n)=>{this.condHandle(t,n)};t.event&&(/^shape/.test(t.event)||/^time/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.global.addListener(t.event,e)):/^runtime/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):/^self/.test(t.event)?t.delay&&t.delay>0&&(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):this.cond[t.event]=!1)}isTrigger(){return Object.keys(this.cond).every(t=>!!this.cond[t])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(t=>t!=="self").every(t=>!!this.cond[t])}detectTrigger(t){if(Object.keys(this.cond).every(e=>!!this.cond[e])){Object.keys(this.cond).forEach(n=>{this.cond[n]=!1});const e=this.triggerParams;this.triggerParams=void 0,this.emit("active",e,t)}}reset(){Object.keys(this.cond).forEach(t=>{this.cond[t]=!1}),this.timeoutIds.forEach(t=>this.ctx.clock.clearTimeout(t))}}class oT extends yi.a{constructor(t){super(),this.isTimeNodeEndSync=!1,this.interactiveListeners=[],this.runtimeNodeEventHub=new yi.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=(_=!1)=>{var x,w,M,C,G,Q;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(x=this.commonTimeNode.children[this.currentSeqIndex])===null||x===void 0||x.commonTimeNode.seekToStart(),(w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((M=this.commonTimeNode.children[this.currentSeqIndex])===null||M===void 0||M.commonTimeNode.seekToStart(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(G=this.commonTimeNode.children[this.currentSeqIndex])===null||G===void 0||G.commonTimeNode.seekToStart(),(Q=this.commonTimeNode.children[this.currentSeqIndex])===null||Q===void 0||Q.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide",_)},this.handleNext=(_,x)=>{var w,M,C,G;if(this.isTimeNodeEndSync&&(this.isTimeNodeEndSync=!1,this.currentSeqState="idle",this.currentSeqIndex=0),!this.hasNext()&&this.isMainSeq&&x)this.globalEventHub.emit("c:next slide",_);else{if(this.isInteractiveSeq){this.globalEventHub.emit("shape slide onNext"+(this.json.ctn.id||""));const Q={result:null};this.findChildInfiniteRepeat(this.commonTimeNode,Q),this.commonTimeNode.children.length===1&&Q.result&&(Q.result.json.subTnLst||[]).length>0&&this.currentSeqIndex===0&&this.currentSeqState==="running"&&this.commonTimeNode.allChildrenEndHandle()}this.currentSeqState==="idle"?(w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((M=this.commonTimeNode.children[this.currentSeqIndex])===null||M===void 0||M.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(G=this.commonTimeNode.children[this.currentSeqIndex])===null||G===void 0||G.commonTimeNode.startTimeNodeForce())}};const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p}=t;this.isMainSeq=e.ctn.nodeType==="mainSeq",this.isInteractiveSeq=e.ctn.nodeType==="interactiveSeq",this.id=e.ctn.id,this.isIterate=r,this.json=e,this.ctx=a,this.globalEventHub=l,this.commonTimeNode=new Ys({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p||this.isInteractiveSeq,fromSeqId:this.isInteractiveSeq?this.json.ctn.id:""}),this.bindShapeEvent(),this.nextConds=new La("mainSeq",e.nextCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new La("mainSeq",e.preCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",_=>{const x=this.commonTimeNode.children.findIndex(w=>w.commonTimeNode.uuid===_.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(Ze.mainSeqStepStart,x)}),this.commonTimeNode.on("childTimeNodeEnd",_=>{const x=this.commonTimeNode.children.findIndex(w=>w.commonTimeNode.uuid===_.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="end",this.autoPlay&&this.ctx.clock.setTimeout(()=>{this.handleNext(!1,!0)}),this.isMainSeq&&this.ctx.eventHub.emit(Ze.mainSeqStepEnd,x)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.isTimeNodeEndSync=!0,this.commonTimeNode.resetForRepeat()}),this.commonTimeNode.on("timeNodeDestroy",()=>{this.interactiveListeners.forEach(([_,x])=>{_&&x&&_.interactiveContainer.removeListener("pointerdown",x)}),this.interactiveListeners=[]}),this.nextConds.on("active",(_,x)=>{Array.isArray(x)?this.handleNext(x[0],x[1]):this.handleNext(x,!0)}),this.prevConds.on("active",(_,x)=>{Array.isArray(x)?this.handlePrev(x[0]):this.handlePrev(x)})}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(t){this._currentSeqIndex=t,this.isMainSeq?this.ctx.eventHub.emit(Ze.mainSeqStepChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(Ze.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:t,state:this._currentSeqState}})}get currentSeqState(){return this._currentSeqState}set currentSeqState(t){this._currentSeqState=t,this.isMainSeq?this.ctx.eventHub.emit(Ze.mainSeqStateChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(Ze.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:this._currentSeqIndex,state:t}})}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}findChildInfiniteRepeat(t,e){t.isInfiniteRepeat()?e.result=t:t.children.map(n=>n.commonTimeNode).forEach(n=>this.findChildInfiniteRepeat(n,e))}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(t=>{if(/^shape/.test(t.event)){const e=t.event.split(" ")[1];if(e){const n=this.ctx.timingTargets.getTargetById(e);if(n){n.interactiveContainer.interactive=!0,n.interactiveContainer.cursor="pointer";const r=()=>{this.ctx.eventHub.emit(Ze.userInput);const o=`shape ${e} onClick`,{mode:s}=this.ctx;s!=="interactive"&&s!=="sync"||this.ctx.eventHub.emit(Ze.interactiveSeqAction,{action:o,seqId:this.json.ctn.id}),s!=="sync"&&s!=="local"||this.globalEventHub.emit(o)};n.interactiveContainer.on("pointerdown",r),this.interactiveListeners.push([n,r])}}}})}setCurrentStep(t,e){const{length:n}=this.commonTimeNode.children;if(t>n)return;this.isInteractiveSeq&&this.commonTimeNode.applyCount===0&&(this.commonTimeNode.applyCount=1);let r=t;if(this.commonTimeNode.seekToStart(),r===-1&&(r=n-1),r!==0||e!=="start"){if(r>=0&&r<n)for(let o=0;o<=r;o++){const s=this.commonTimeNode.children[o];o!==r?s.commonTimeNode.seekToEnd(!1,!0):e==="start"?s.commonTimeNode.seekToStart():e==="end"&&s.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=r,this.currentSeqState=e==="start"?"idle":"end"}}}function Hr(i,t,e){const n=t.split(".");n.reduce((r,o,s)=>{if(r)return s!==n.length-1?r[o]:void(r[o]=e);console.warn(`${i} not support ${t}`)},i)}function Da(i,t){return t?t.split(".").reduce((e,n)=>e?e[n]:(console.warn(`${i} not support ${t}`),null),i):null}class Uo{constructor(t){this.timingTarget=null,this.runtimeNodeEventHub=new yi.a,this.basicOnTimeNodeEnd=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr,w=this.getTargetId(x);this.ctx.conflictTimeNodeManager.removeRunningTimeNode(w,this.modifyAttrKey)}},this.basicOnTimeNodeStart=()=>{this.timingTarget&&this.timingTarget.applyEffectCacheAsBitMap(!1)},this.basicOnTimeLineStart=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr;if(this.activeWhenConflict==="next"){const w=this.getTargetId(x);this.ctx.conflictTimeNodeManager.addRunningTimeNode(w,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:e,isSub:n,json:r,ctx:o,parent:s,eventHub:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.json=r,this.id=r.cBhvr.ctn.id,this.ctx=o,this.globalEventHub=a,this.commonTimeNode=new Ys({json:r.cBhvr.ctn,isSub:n,eventHubs:{global:a,runtime:this.runtimeNodeEventHub},ctx:o,parent:s,isIterate:e,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}),this.timingTarget=this.ctx.timingTargets.getTarget(r.cBhvr.target,e,{type:l,index:h,id:u}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.basicOnTimeLineStart),this.commonTimeNode.on("timeNodeEnd",this.basicOnTimeNodeEnd),this.commonTimeNode.on("timeNodeStart",this.basicOnTimeNodeStart)}getTargetId(t){let e=t.id;return t.type==="shape"&&t.txEl&&(e=`${e}-txEl-${t.txEl.range[0]}`),this.commonTimeNode.isIterate&&(e=`${e}-iterate-${this.commonTimeNode.iterateIndex}`),e}}class nc extends Uo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Da(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const e=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&Hr(this.timingTarget,e,this.startVal)},this.onSeekToEnd=()=>{const e=this.json.cBhvr.attrList[0],n=this.json.cBhvr.to||this.json.to;n&&this.timingTarget&&Hr(this.timingTarget,e,n)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timeUpdate",({duration:e,delta:n})=>{if(n/e>=1){const r=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const o=this.json.cBhvr.to||this.json.to;o&&this.timingTarget&&Hr(this.timingTarget,r,o)}})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}var ah=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class lh{constructor(t,e){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:n=>n/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:n=>n/180*Math.PI,rand:Math.random,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=e,this.val=t.val.value,this.time=t.time,t.fmla&&(this.fmla=this.parseFmla(t.fmla))}parseFmla(t){let e=t.replace(/#ppt_h/g,`(${this.timingTarget.design_ppt_h})`);return e=e.replace(/#ppt_w/g,`(${this.timingTarget.design_ppt_w})`),e=e.replace(/#ppt_x/g,`(${this.timingTarget.design_ppt_x})`),e=e.replace(/#ppt_y/g,`(${this.timingTarget.design_ppt_y})`),e=e.replace(/ppt_w/g,"vars.ppt_w"),e=e.replace(/ppt_h/g,"vars.ppt_h"),e=e.replace(/ppt_x/g,"vars.ppt_x"),e=e.replace(/ppt_y/g,"vars.ppt_y"),e=e.replace(/#/g,"vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(n=>{const r=new RegExp(`([^a-z])${n}([^a-z])`,"g");e=e.replace(r,(o,s,a)=>`${s}math.${n}${a}`)}),new Function("vars","math","$","return "+e)}}class rg extends lh{constructor(t,e,n){super(t,e),this.value=t.val.value,n&&(this.fmla=this.parseFmla(n))}resolveValue(){return this.value}interpolationFrom(t,e,n){const r=t.resolveValue(n),o=r+(this.resolveValue()-r)*e;return t.fmla?t.fmla(n,this.math,o):o}}ah([Xl()],rg.prototype,"interpolationFrom",null);class og extends lh{constructor(t,e){var n;super(t,e),this.value=(n=t.val)===null||n===void 0?void 0:n.value}interpolationFrom(t,e,n){let r=t.resolveValue(n);return e>this.time&&["hidden","visible"].indexOf(r)<0&&(r=this.resolveValue()),r}resolveValue(){return this.value||""}}ah([Xl()],og.prototype,"interpolationFrom",null);class Xs extends lh{constructor(t,e){super(t,e),this.fn=this.parseFmla(this.val)}resolveValue(t){return this.fn(t,this.math,1)}interpolationFrom(t,e,n){const r=t.resolveValue(n),o=r+(this.resolveValue(n)-r)*e;return t.fmla?t.fmla(n,this.math,o):o}}ah([Xl()],Xs.prototype,"interpolationFrom",null);class sg extends lh{constructor(t,e){super(t,e),this.value=t.val.value}interpolationFrom(t,e){return Ra(t.resolveValue(),this.value,e)}resolveValue(){return this.value}}ah([Xl()],sg.prototype,"interpolationFrom",null);class sT extends Uo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0},this.keyFrames=[],this.isColorAnim=!1,this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Da(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var e,n,r,o;!((e=this.timingTarget)===null||e===void 0)&&e.ppt_h&&(this.vars.ppt_h=this.timingTarget.ppt_h),!((n=this.timingTarget)===null||n===void 0)&&n.ppt_w&&(this.vars.ppt_w=this.timingTarget.ppt_w),!((r=this.timingTarget)===null||r===void 0)&&r.ppt_x&&(this.vars.ppt_x=this.timingTarget.ppt_x),!((o=this.timingTarget)===null||o===void 0)&&o.ppt_y&&(this.vars.ppt_y=this.timingTarget.ppt_y),this.isColorAnim},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e,o=this.keyFrames.findIndex(_=>r<=_[0]),{attrList:s}=this.json.cBhvr;if(o<0){const _=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&s&&s[0]&&Hr(this.timingTarget,s[0],_[1].resolveValue(this.vars)))}const a=o-1,l=this.keyFrames[o],h=this.keyFrames[a]||l,u=l[0]-h[0]==0?1:(r-h[0])/(l[0]-h[0]),p=l[1].interpolationFrom(h[1],u,this.vars);this.timingTarget&&s&&s[0]&&Hr(this.timingTarget,s[0],p)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&Hr(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&Hr(this.timingTarget,this.json.cBhvr.attrList[0],this.createVal)},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.createVal=Da(this.timingTarget,this.json.cBhvr.attrList[0])}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var t;const{valueType:e}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const r={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(e==="num"&&this.timingTarget){const o=new Xs(r,this.timingTarget);this.keyFrames.push([r.time,o])}}const n={time:1,val:{type:"string",value:this.json.to},fmla:""};if(e==="num"&&this.timingTarget){const r=new Xs(n,this.timingTarget);this.keyFrames.push([n.time,r])}}else if(this.json.by){const n={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(e==="num"&&this.timingTarget){const o=new Xs(n,this.timingTarget);this.keyFrames.push([n.time,o])}const r={time:1,val:{type:"string",value:(((t=n.val)===null||t===void 0?void 0:t.value)||"")+"+"+this.json.by},fmla:""};if(e==="num"&&this.timingTarget){const o=new Xs(r,this.timingTarget);this.keyFrames.push([r.time,o])}}}if(this.json.tavLst.length>0){for(const n of this.json.tavLst)if(n.val&&this.timingTarget){let r=null;n.val.type==="string"?e==="num"?r=new Xs(n,this.timingTarget):e==="str"&&(r=new og(n,this.timingTarget)):n.val.type==="number"?r=new rg(n,this.timingTarget):n.val.type==="color"?(this.isColorAnim=!0,r=new sg(n,this.timingTarget)):n.val.type==="boolean"&&console.warn("not implements"),r&&this.keyFrames.push([n.time,r])}}}}class ur extends ce.k{constructor(t,e,n){super(t,e,n)}set percent(t){this.uniforms.percent=t}set transition(t){this.uniforms.transition=t}}var aT=v(121),lT=v.n(aT),hT=v(122),uT=v.n(hT),cT=v(123),dT=v.n(cT),pT=v(124),fT=v.n(pT),mT=v(9),Pr=v.n(mT),gT=v(125),vT=v.n(gT),_T=v(126),yT=v.n(_T);const ag="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5QTFRFAAAATwAAOQAAZgAAKwAAPAAAPQAA7AAA/wAA/QAAugAA5QAAsQAAwQAAsAAAfwAAawAASQAAZAAAOAAAJwAALAAALQAAqQAAiwAAmgAA5AAA7QAAtQAAhQAALwAAfAAAXwAAYQAAigAAuQAAfgAAswAAcgAArQAAqgAAZwAAaQAAMgAAGAAAiAAAjwAA1gAA6QAA+wAA7wAA2AAAbQAA2gAA3QAAuwAA3wAA2QAAxQAA0QAAzwAA0gAAXQAAYAAADAAADwAAGQAALgAAjgAAcAAAzQAAwgAA+gAA3AAAGwAAoAAAowAAcQAAVwAA1QAAIQAAWQAA5wAAsgAAuAAASwAAbwAARwAAMAAAnAAAUQAAaAAA9wAA4gAAPwAAbAAAOwAAlwAA0wAAjQAAvAAAwwAAkwAAQQAAvgAAnwAAvQAA0AAA2wAAwAAAWwAATQAACwAABwAAQgAAtgAAgwAAvwAAgQAAlgAAEAAAxgAAtwAAmAAARgAAjAAAdwAAqwAArwAAywAAYgAACAAAmwAAHwAApQAA8QAAdAAAbgAAFgAAgAAAogAAewAAXgAA6AAA9gAA/AAAzgAA3gAAkgAAngAAdQAARAAAmQAATgAAUgAAJQAAIgAAqAAARQAAPgAAxwAACQAAAgAAMQAAiQAAhwAA4AAAUAAABQAAeQAAygAA9AAAFQAAVQAAyAAANQAA4wAAKAAAWAAAZQAApwAA4QAAyQAAXAAAkQAArAAAdgAApgAAHgAA8gAA/gAA6gAA8wAAFwAAHQAAhgAArgAAnQAANAAASAAA7gAAlQAAJgAA+AAA8AAANwAAJAAAHAAANgAAkAAAKQAAoQAAzAAABgAAFAAATAAAeAAAAQAADgAAggAA6wAAEQAAfQAAVAAA9QAAIAAADQAAEgAAVgAA5gAAQAAABAAA1wAA+QAAUHExBAAAJDlJREFUeJwlevk/lPv7/2XtOrKNsWcbzGCMJSmSpSxJZtQkjPEOg5mxRWns+xpZyr5ECGmcLIOsdVK2oyJbcVI0J8fp/Bff2+d7/+BhPO6Z1+u+ruf1XF4GAEAGZOXkFRQBTiD+dgKVTiqrqKqpq5M0ZMmaWtoAOrp6+qcMDMFIzdiEYmpmbqJBpVlYWtFJitYMG1sbFTskLvvTDmcQHM+ec3ImXp13uYCubvB/l7sHkC9eAk8jcy9Eb5/LvldQzQ+v+jsw1ZAlfwYDAK5dZ98IvIlBwXRNXVYIJ9TpLJUb9j9LvBVOj4jkRVGj/Y1i8AwiH09eEwhjMU4uXtsiAWLlqInMcLh+28okKRnuhNy945lic0+Uqu7NdErDdB/5DBo7MwuE4J+dw8jIzcsvwEIUFFGEisWQm1ACpcZlxF7vl1c8YMCJyqrqGio+fFRbVw8NjU2uec0isNWhVuq2XMPzmjcRBVHhSWCtXaPR2mZoybHzL0TUfmxPabeR6yg/+6QTY83VQNOkSwkbumsgkgzwtKe8tDdHYM7ts3sW1Q/Pn3PEWaGmYjoje+B3ewx9bM4V0LNfDB5XL3/o5v1hSBi5fzvQkQESOkQOwiiwI++5YBdkDjFIrKEx3cZK4Ti8eAlZpjcnYMSHKG0ygKKVeFSLRpOZNL9p19Ku1Q9enKlp45lZiQGr7hlWS17RKWp03mv8481cQnwBUNTAXwIUeAvsJwCCTnV4FyJC9CrKYDnOT91DpRZSG8Bsn7pAw2Ihd7Hn7R0hynXezjQcvQTyMGgUjV12kiW75XaR7Z9OK9kD0/j6ckfyk/fcPHCkvkz48NG/r3p4FeRpoQa9JA74sJAOcLubirEPqXqTpZ1hNzUN5exoNVbk5RmSOQqcJix5yWvvRZZ9nyay+tqAsb6U76oAwo3wgXvJkK6sCpOYQBTIdT6cg92rSxWh16pdV2c8NnDzfQhveqvND4k6aAB0ssWnHuL2yZQ7AHLzJTgUrreyZeWewhawpw1RMDWYHLP1OcNQgKzwlKVP5JV5crB7cZ+NRJ6AB3wx/x3RsEufEkozLu+g7+zkekfLbFQo8byEubp5ld7Ot2CQKxJ7qguZxF4SB3ozQF2pCEIbcaFxg6eAr0/MbeHb1DCK+vQCA3j4YTcwjNiWyEgcq1dRlfnXsq31K3hhhvNX/CYM0JC+asxk91d+7ahTr6AAaTAn3U2lTBfjIc1pr5VEX94yw8uIZhWQVAHQj66iLErxDLqNmN0wuO9hYf6FN+boQb1FjENYJAiWKrru2ejWzoZX6M9A91p2Sw1TTRT/rdDQsyiOT1f6br4fKm6Fpeb9qocNfvYOLPAuczuA5BTbeVT2O/ghlkYEScGHX0Df3StfyMT4iYHCTEQTLj04iWePVx6aomPYGLc08OXB+drJLqoq42/wXqB5eagtaqR+ZAPsymG8utBxt1rO8zFTPHITA50gCMQ4Gw7tQBZFo0DBsWb5ExlyKoBbvRAO7jdv6U8jMYne4Y+iWXmg53gvbNYsGg+gU3elEnaeXB/ufFUKJiyZdNZemo10NviBxr65KE1k/Rijg8KTan5647eoiJQAYPIL+9fuHPb/VSMucg/bcJHzKt557SPRYF8voq1+2SIWmSgQCZo2ZjhlymMigEZdZQ3MzX6wmmMTECwNWieLpWDlKihSZ2sVVwNX9AmecOXtMHP7C/WwPzvKbZqiJIYFZ7PuZngFJmNi9YatOLLQU77vGbS6PzGdsQVn/Ad7nQyALeZVbm01GA72t5bvR/aWTWVIIEVDwDJanzjqAc8QuFl4Yr9/2WTdPVPmHCtY7ZEZ4mJoDqURsbWcaHwtmIqJWrIXshpck5ilsHlYM34YFFXTG3dGzKrDMBxB8gsDn7G3bW/TDpe51ALDmy5KQW8lUgg4guspE7TN7wCTbFWnf7gBB16vuHtYoXsWo14j1cD9/Z+oyj5GF95jqI9KG0s6YtJ0N0jtISrVAZQcIO251QuKrBIaH7k2hLK/Mw8pyNmCnott3tGm6XjT9DsZUps7H8DCHwjc731hFRtTaF2UQ572Ca4Qp/On0RVdmFD0A219YL4DcFBN/lnfBvNr12E0W2MSZatepyNLVIbbFIg7jaYfoR/4W1VUKqL6zsF4NpNiq4orZEhCEjExd7AQ2j+B6GMOPmekeA7+DsM0IAsIqj31xrtAzvWqBsjmIWC6+uBONItM9R+HA8rGHxptX9JAF/G0L6QEiy3McdFEhp4+YNA0FHNwnW0/RFFEtwHRb/hwQsbzX/heYihsB6nNVJssfHnqQe/acYKMv8LqcRe7aEF7Y6ugtWxKLILeNmlzVF277PqxIg8dSxpo5gsaMBFxfgwvdWBhOvzOHHHzx4JUHLNpyc8LUzkLcfiIv3A2jQxpeQ1iL4IKUJ1dTmigtKLpgi6QjX2d8ISbHl1B8bH0UEbnI2DMVm5h4+6Ko+kTd3VVSVPGkpp4/p+BW7/faCjBhlD7MoDqRpcOJxz6lBe8gWYtBP80qaKf86k0FP9L1ziS+Y1m8MPaWpcD8BXkG2flILIvKvoC/hr8upkS1N2pwbQD5NtZmC6iNb2JUVJTRDoZxTXibAjQDp3w/y5Bhld8zynk7OU1S3S3LPnJLvjhzcfUaKeYeJwtkmPDDbYpWt0gTaf8e/gL32vUwV1i7lHVD65CN0n+CySLiHLZfbSx/XYollUUj09xeL/Cjqg2DUp2eM7igsEZPyXlnve63tfjYjZSbBwtUf7mlAhvX0N/CzxFIKE25lol9uEzuf4B95AK6EAVtXBSn3XGA6bVuISAxQuuFKTClSg4xz/VEivy43BYA1UY4x7aSd/i1RMdwdgzi68x0JEYIfLBbEMag6Kcur0R3WGGtXvT2744+WPE4QaWz1rrbq5fEmwQTMwOLPRNs2jAJiPTPpAjXA48lyGNDo/aEnNyEv39YQtTIKcLY2gVw/SWl2eGCgmvgRKcowIU96xWM6PvyJhk/4dRHbP4A2JaG+uq0xb1J15Gaa++VgngHKhh3L3grVzTsa95kyjw3wgZLYViuASK6smRQA8Ds39GAisCnrN+wiGik1BsIZfpFhk9aVvJNr+pUWJbSmxoOAqRzseBsHsCPJ+9EvFA6HLDuymPuB3VbLuUAeRzs5AnmhdV52drj6JdA/9JE6GEWqDZIrYYlrYCDM7hLcefRsAoFiZc4P3tYx5qFsH9ttFzAL0L/lgSwvjbS4Hlik7xGLuSVfejKzFhvtnHF3039B8VGq1UCpg4+cLt0KMDi46N3M5F9YWHiD/InKc21mDdj2pCGZNgqLihu2j14oFnH9dxycOd1FsVBZ+cMEBkuu0U7wwPJEfc9SWATH9MuG0EvfyJPxuf9enmuy3ipIOtB/Tq8fRSfpzQFs03/H+7yBgpxgsOgaPD69B90NfAH5SMhqmB4xns1ARtQlmao4VcBTRTDeuo6wPwzlIp/AQcGagk6KNOsPIQxV8P+wi/EIUDDVLWFGWvjTzIZnkLRH1UoJhWpXMTjPAjt3UAX17p6WGAJwxrWKi26AC0+gNR2jzhlwfEJrgvQCombOyaY8/bLwB9fMvueMLQvWNkBKGC0lq0Ht3KzP5jCcE4StVpESb3tdp2iHeZtLDMQ26rGa6n0GpULC4tIz4jBBxadsL3wHdFQPwahEAq1xR5rwJkcKwXQrx0f6F7awZw4fPbGa1gUiXJVpYOUgng1Il6/kdwHeGfQlS+PdZEZ/WbBBOmQjvC0LG6wpXRfApSSh5UP+GjCtGd2HwGkHtuvHkJDGvpqBlcXLXap5CKR9eJRzlgZ8W4zK891g7/yQl4SpDRz5B6E6FEUxFv8K/4i/p8Hn1DOZxLx2FQHi3X/cwgM0LCK+TZnTMszAMO3JUIXyO6zOQNiThG4OXOrwJNCE8XwV95JJ175KWLydZwJE882VhaOGyWMiSKcP771g4kaYKUFB2Dmz0JUdUk75Pplh8T7VBZwUY90zTpUDwWxIJNQ4p3+oSPgHVcJUQVskdpHklpVCunu2AMvq7HI2HuekbnizilxbZeVzVwQLUBT133fJUvswkKMu+OHgCDmIJX9+b8TDTiXIyTQUrXPXFm5NsIOF7X6snH0GkbLAqxPlJ9ecWoX5Ywy8Vl/GgAlgE21JAfp4T0F8NwItrDq/BXLuXDsET46eLTOOKK5svMyhZ3Ah1ePwHOvYdijiwWbAEJnbIP5V95SOcbXM43qIJm+5G32UABbhvaNNvRffVynh4jmDDQ3V+XtC1dHWnr5PFwd9Ds2UdVaIEHmECBo9V1OAz0w9Q7ZONc7xXtF+8+ETCmmX+G7+2+flmEDTEww2Dr5eQAbJggPltoLQ9vmismCRLQYIvSsXqDWOIS85DgRSlAhWjGdOxACJXNVdyGoSxA1lu2eETiYQrdn23iL9SxSRCa5LgEX0CruBRSxHIQWrdV/mq5qOUyNgs9QUYv+xsmlhwRichkxSqZko2RwH46USV7CUofNLnT23rewuaB+3Y+8g82zzjibgmdChhbQRFk34o/zPECaRHy7wKj5wlFDE8H30Jva81PwVlVT/UNLeH5C/T9cIDrBy3capubs5y2F7ATbAwpRvThn7BsaBvwbu0BBMDxHEtAsSE3DVOdF+kWWcXsfX3AFYeWSbrZP/TS/H80MGryotBYxj1U8rWXomZeevT+aQ0crFNLeulQLpiCr0J3rB5jTS3MR+wbSYRJirC2/5eEGCMHpzOUFWEplMsWaW0SVaCL8y8rZVI4hiy4qyEC7CW0YwNHTGLxvJ2vW6GNMctZQNF8YFxN+y/di6ENOZNtphmlCkIZsU3uvDqzlidm8vQCrkUfzYk6D4AYr6tk+mccy/i8xBKFQzibM/wWTIysZ6cDt/XhySBb1niUMBJRN+ILdWbj7Z6dnUgLZELPYXWeyXNhzV48NvUbAWzWEC0lD8PwVIGTt6rveS3h3gX3XiVRg1O5poRFvgPCL17nEx324dKJT5AC5OU7RFWXuEp0U1v+MRgY7mxikdoB4lle086YyXrr61aA8eVem+VOaY1TKn/sOxOeRhIcR4AZLNrygau7faIG/T/vTPO010Kbci6K9mAYPE3+D/Q/02VDHhOfPxxTud5MF+8KsrdY8Bw4TELjh26cdDiBfCo2ptEyDRsJrRk1KZcvgta3ckuK5CRPn7AxcptUHMpozoAU68b9ElVYL1uhaVz7RTJwRJ15W+0X8HZs7gUMi9wPAEik099Y6ilYhW7j1KNLmlFXlRwAb+NvU+PbN1AfHY1t+/sN4J1JVfn7FDYLloP1Scsg9GA3s2b6XMPgHYNbve6n3ghsmK0WGyzvNrCU7t0veADh7RGOKA7vXwYQc0uuPZMJMUQMLbBdz+2kFzkStJJNFEvH/f/cT1wnXJfsflkfnn+qJe89nGfU5c6Fpsd3vp8y31fD+eHg8uZSYXdwqcoBT9DS0aTRKoaZrdSqk0KtkFZb4+BBqXAnpKdyVLXBuP5clrK5wxSYyIWrghPCaNnLhJkp/A3x8fsMgMczROQeBhpGULvpU+ZNQqKLZQMr2c5uvEvEMHOemnBn5rN1M88Y+/TkhOxUIBP/2P2jr1+oIelfW2KEQFOnrjfGzrGWUsS6YsjIBTxTDwc64bw+fGhfW5AnvnpxLYAJDBm2lJ6rvaNZZMrsfTANYByHtYSbJahyNwhmaepqjdIPb+zS9jVAgfRHPZEjU1Gd3rhA/5cI2/I7HkyV/yE2rhd7VLRC+6h3nRnBwqHqGw2HNB46i9yPFIYrAbBjbP8Xiw3DuyzbyCf9d4TVDRcSKQussrgoejwBiAjYwZi0qcQK8KuYyotDvMBHuWgDgNhVUXyHsaOlkxmK4H0+NoRd5BhMX9v+E0DX3JzZF4fOt9EZhbDdj5dngkuAUBvofWKvSxgvWN/JXhGtuib/SxfY8KRQCXuP9M9m4RKN/YNl9WjkI76xL/vI3tkUW8UwNyBJ97wf3vZkr8zgZWjt09M51pPhhhhIa5n7iOjQUKxcVfAILZl0T4jc7FxaD1109JL9Ca0sSBbrEuNCQcFBiIv+SZSJPYe/1EYItPw54SrCk2fKxMmvjDJ19ORWT937dR9t2yrEWeJCbBTuaVFvARwhlXYkVrmPmMoeHL//5uHAvRj2Y8axOXO33AUsW/qXsBWn9CxkKIYN1C7xCb9tfTfE+3+m+utf4yM6L/i+ic02U8cQ2F98GKWj7KuD2pLDXkPCLCOzaCvJfwOemmSw+9kphfUY4yI+yj5/MmQxX+dJTNMaPNhkZY4Wbc3tEQKBn08wseAkoa6qqIQUIOD3kPmDGdgoM1ToC4KklkiDUBk4Uk/Fidp8zCJcFBMgHj+etTxbRFeHvwhf80CiSt3z3DIFYl6k1lWLVvRBn0lpMVKj6PITC0tar9jbVAPhHP8k4rhblOqCcOdqrAPy67Z1WL4TfMfVx0GLrHQJyH8iQUus8lkFKuv5kcYrNvW13YfKuZ89ORAmC15BmyKxBFilYKq8dxQRWdqGLLb8Rij6WrIs7/mxVyFptbrarK6uDO1v3yxzOWQjtaz2W/01pTvN/Omyfx8D2VGPK80olW8HfnliYW8J7UjIcIlewB+DJW6whrBEqHlPOAQ8W/xs1Hn5GmuasOM+K9M5T9RYI+PMwnvMsCTG6r+dbVXfMESA2YjneGLq0D1CQv4w2JrzNXBsshiH+QHHQa2Mr/AZ4I3FCYwSF30Bqgti3TOnZKmjAfxUANcv/0JqQQ2HHnOhMOwJodHns6/25Jg743Q1lQ+KbmEPuPq51Bt83snYTH17IxKtNv2roT2epeJDTPX4a0X9SZHNHJqSie0RtRDgKb5JGNRAJr4h2aypQVI68DWseD13hXjPfFQtgcpsWw3+bHWbYNMQ5bN4cjo9d8aBirB8/oJdnePZQoxNeCAZZbotwjOCA0wROeUdcuZjnmA4UdjXjcB5b5xb9AZYmwdFSH2DdhvscW5z5QnIMnYTFRngKajbkSdjvvVyWw6LwIJWxlYhshBPGlg4xDUFZOFLf2UlA4MUe8DA8TIea+IX2smNzuP0vmleE8ArQR+UsNqTqekrljgz0+vhX5+FaB5qs3t9J5cPuwScX+MPS/UkluQXNh5WrJFM9p4CGban0P71P43YKxglb2X+cyKQ94h/diX4v9RaCpnBsnLBEiBNo/0idpiYrznuGrJbXrCBGfcS8UOZNOTvW4hnUTwJkuVcBHodNx3R8t5LtTDmf9/EmsNByWOE4XyHplSzut+ilAlOYAW6FAoMlRP17j9CYvp40MImU7d5GfS2Drx+GW3yciuygcSeJPwW0wzd8Jx7iITtZPchNXC6aPAtKQrB2xa8z53r/+NXr2nhyLPFySAhSY0IYOQBgKT6h3kSWUhtwoeuSh11H23xn6OOue1lRwSZFtnWn9cdSaaEGqWp9dYsa7+ChyZcubQzxJjXzXLk9h89vBXfZGDIlvpsP4QIbmPMjqxhqsBfefv19nkI6ATGqFQsHNSKV1bi5RDhNzYOR3Ckunra8gfjADKT/ll0bAtT+Gyj2d7NLfv1oX/s3Dxbwcs6upK916xmn4Cn9qoUPECeybc02KdxfxGRB0zT8l0Zikliu1neuQQ0TmnzytBG1jCdcA7AUAfwLbEnAjIqNRI/tr3AS3HHzaJJ1AVHLTuHM72nkWqYVDDf+j66wmI+h8Lmvxl4OGEXnX3JOrwBz08R7ELtwHigs810rOj0viiWN/+sC7Ni5oBKQ6bZk8eHN3PYLZzQgVjEb5jNex3lMrEC0EzpQ3faNx4xd523exujDDnuf5ZP5S7v7/UuKqkqW2X94NfxXy7549ho3WWi6n1Vt7ABUIeJc5cdqWkRZrf4aNACabeODzxEINKtnW6CGh5734US98i9pjARiQfrdT+ax6iuaQ68hRSbykUQcJUr4DoFBkm4wgd2hq4tBIt5iGqkmIYjIK97X2Ac+y7Al6Eas2r5VF3EkYVixIGsqzlkm0RXA05xqwaznFZjzk8V80Y+iIDhMyNdfSpEMp3IheR2cbKGSnSfWK1HK5rU73te+Y+mp46Jt6oD3xe3/MKUzoD2UBzNmu3iQW2uCJHd2ne9t/x3h7lnn4kBxCEAK//UgVlyjyz9W5JHgDWu3g3OlGHBZO/680MjgZCrLsuOfLU+5jPl2Pxck02uqzyqmPlhPA0isbdnhRis6Qh/S179zV226tq30IMf1KqJ+bHgSCHhjM64dbIL8GGt21vGOEXP+/AJcER6NjIb286TKSzTCCidNp6Zf3rpsWZnG5dNhuEqU94Fd2sYHaDOgM3A3LO9nxQazFRTOJsT7cD4eScDOsG8UfQGqlmCqM7L0/3ZpnWylRSPqBu/B+eHEfYNZO+0QTaWrYVbLURYIK4TWR8iESRGfHHQWgthnGCFSR6XhpDR2Xtq0uhr2QQvOUVv8Giw6ImYIgOdd8OPo1dxm1hQCQV84zTzso6krY75wTfRjcwV5Geb/tJ4owfFd8kC7FDPX9B9mBYVZ0zuK21vYoVpvazdgKlwKfwFKZSgPgFfDQtTRYNOvy6JNZ7OeYCWEFJq/hygT5KPD9mIbenEBsAvHdzCG/K5iPb4S4aP/YhnMDJHIP/icNM6ztIK9gkRRdA71nyoMef+2jb3neklwx0pHH2SIdKb2jwOWG3JCmYK4Iva+7eEG0a3If9Da4KaFAGMYlTTCfFBFSoyK7YMSwyuICgV8M49c7bf4VqtKi5LOaLKCJlVZ5zBpLrIr9LvsMNctO/oiM3ab/MknNJPPbnirNLPbGflQrRr2aJJYXg/QIsh8k1PXzz+z9w5gIxiXea4P0RlO2OUDqhJdvv8EBpRLy6Z9p8GR+FFKgDHcGsMkkbMnJz0q7hAhDVdF3sCfBM6hj2P4SlE5njIsBmSky6FhkNYd2UfgLt37a35+BEvupCA+Jh5kmC5dWaGeQNmz35EEQvhwZG3qxKo/RZr66hM7IJ5Won7gh78anK172Zt3buKAMKyMDjzdR9ufcCZ0zU4DOA5RKIgkAMTbytB3LQFlT5MH/An6qfRJPjj2dg5WFP3mdlZkwFePrA+3eN2Wu0A+WAFKZrztzJRibcqCweEddxU/PSGWxOnjHtOUDzfDk9lEvDDj39cFH1E9dVeQLGVI3Qgeo0M34dZ6K/3cb9BBZcZf8uS+BivagqBuLW31L60FMADuX1jiTur3n1ZrBrIgpkFO//0OmyT9qWthHcnwzLRswTdDbgUflRNCAvfaODDSX8vQLo7QBDltK42Y/OdFbS1zUYFLv6qSiV43zDiUrcAtbEqoMVBPa37+RMTuT1gmrJVH1qqYsi12cyakNWPLrTGqg9NO1KY2vPwISkCnxobu6FodJWlXUwABhb1LwveepTps6Tt0E8j+tabfLiI+MdLLWSxLqA1cJON1hz8aZkisUWXUMhNOQpLrIR062CCV3Bg0ZwlU9OhbKefT1NjDog/g2q+TAW89zQllayE0d/y9qAdSAucb3iKOXZYzSSmdealQNS1IL3qMUpowYU6uuO7LEqyPD05MgXvXy6frzzrkpBXlAx+J30gur7J4OT/ziwA3fvIcKvLAHet4sqms0BCkZk6CKbyRPu8Xqwsv5KGfYcI4thniGI9nFwFwt1bfZm9racBom20+/R8n0upa1EAueM5b9A7lN3BE9empZqOTj5NkKNeCf630MV2jeKeEP8cImJ5W9l3gYGDg1wPxxZcmBvsZ4qZXUMim6a/M2jKAsHtYvPN1A0FsH3AAbpFvCxA200RpdN9ME2nSQL2g5pg9OIw6KkYT3gKe7QmWrItoXK1c/XBbJQ6pVOca2BzfQfoOCTygsFljpEPDG+tBLrte+jUDP2DcYKLisBjhgtTZnAmgmg8/Aus/awVIZGqScBZ1xa/82qG7rzT0BDLldEs0sP5HS8oNhU3lhDue5NS0TUt0T7YTZvSGH0HEYEs97dJ7xpNO1TKokYmLWenco4PvNEsv2hQ85pcgDjlA29jwVT9IoAcXQGCnhPG8fgYyhJ64NNzBiWf5p1XdoBx+xtXoPiVbK44FcHipEqTaar9/ruKsdneZuJmevOHPOjhmtvwVVX8Nmx+/eftj7gZmxlF3ocI/n5T0byPxzPfMi24AxSQeAGjdI3Q4hc5ffAT7v7F89ZNEgj6fheuHl2hjRQlG4EMMwpiAnsm1HT499a+zKPMejH0uAfnT4JyItDTiDQ4l5DoO/sQZ0HkzGpiM8KQNwaHk0Un9WaO+yuA1ZTV9z8Jm13bqwTlfNHncIi8M/kHQMFhMF7Imo2mUw/Sox7Bh3W6UplqvEiy+g2NvVzFPCtGkHSTLuFSL2CtGzpPY+E5O0PK3HSbUnBzNBZodkNnUAlch2Zk9/9F8JuAYBirgoVpE7QyheJ33WDOysDFYMSXBdm20XfXCWcGzsGyvXE8FJN7EadsGjIDzZ+GtIUEBWuQ6o87kaDvo4eplYs4dz6P06lSSCA0yAvpXKD1djjC8dnWdYtWsLpl4Fplhje74Y6i/M7VMSQnRvD54/CC4LPzx4vghhIOzVo6bLzl7QIHPvVyM/drqBBZ3tW1lYqvXfauRfH5WHe+RcHI+xxeqDECqJ9tdXLyy9L7RqxyUaZKwmlAux+zEzdzITSRlr36YuSm0LBhTpkivodWytR6BNULFxftqF42QqKLmoog9WlYNRb4GtNm93bHuxBvV5VcOUeY6N/9xDutwbqYhaN3rIzpg1M6XfrYctTdA5Msr2v4Aydmb+Nl2/Eqw+jSXYvctmuDHYUAei0pUc6E5N1bULPEjHAr+HI3gwDjpDg0nE2fMkXneCumq9ifZR5IKUOqn0aDIfN64olrhaHfV4msozkdG/3j5HHqsf5Els8kwvDrCaK4/BXb+YzYC00mJEOu8njPsKgB9dG+FjqqeToCsJKLTvHS+iQTnqFquCJ+yCckuDaHLnP4GzroGg7BelrYZWStEFay3j+vkEuXHy3B2zG5xBqSx+/pxoEOv+OfiCfq5QMCCNq26xXC+1DZ+eQdH2jJ9FXSh9yrISZTk56jTzMIzG9+Ye+pumQffxmh2lcvPXjmNWL3PoOgRpkx4o/TZzE2y3IMtEZNxpNUlBqFlnBVXuPS0TIBkF+ZfvW3y2bGWD14zb8Cju5+wiSW1pIIRRtD0DeaxOLIvup5BZ2R2QfQVx6ryHH4H/rls/fRJy6KIdsJ/qVsWrBZaKgKOhP0GOUjA16wS+vlpcmot72SIWJWQDwyiD04TLSU6LyObtnOC2W5QA0OCGXHtlTi9Cyh95AIL8UU6AaQOaDSDfuf3DbxO4065WUdqPZ6Zj9S26jGlhDs/3mX1c4h+to5J2UwvgO3dkFtmKMBF3OuQvskMsOO8R5FnXblT4zMUpkjhs3m1ygag6zQWKfFOQCFM8jmAFtaCpCqDX77xqhE3B99uGU3UT+41SufAp9fQENvgk5lwqneywazIE9IpGT8v23sBPibAHG34mLWiivxnjk8p2S5ofshihnLQd4CU5ABpVcMX/5Hg39Jm55k+hgxugBCGIR5KmY+qz6US5/wKYimBbjTOSBlyD9OiYpWxtoLH6PcoaUdK0dW4vKR121dfMwumvgSBf8g0fsVN0w8jbplh7Df1FVC9wZuTbZStSswGJu6IngHRvBgOFag8F3hwPVNuUYjxNngNURuMvnnOvway+3l+1sK7aILbzdSzAxUCtG9/CaaHsBFIVzMWEH7upNL6Hr6P+oI4i+VqT6NyQrYUMkRXYd2P1ZjEMDaJ1rrurxTBgTfMw9cZe8SHIAz0JA7jpgDmr+InVbg0HrkFNZVhQ2uBKn75tLEZwfMp2azBhkglsAXDPx2BccwTDGmnsjRDh2jHh9ynTQY4vLqcuv/NWRlP8sFHWyxSmm38ikF1UoTywoZL0oFE4I4ujqIcvCuo+0ABPohIMdyq8EqgTcogXcYNCGdgvytDCA/fwt2eG78+OAANOgmKkOI8WdjE3FaFdqW6rx/oOBunJoqMLOwnPtv67Cw7PY8c4jFvek2G/hk1Thivu5Pf2iV8YDA8DyziBPz6MKlF9XQlRt7ZRV09nZrygwo00ME7IpFuOiEsUrd14UcCvNC/DPkbFmqB1uQIg477mFiq2niVADUYnvdjiQPNpFfMTo4yg4X+tDW3rmH2WE9E2rY0ES40wM6QRwaQL5/fepJULkj3Zc6L1ItuWmO6zXbvou399GBCPcQwB2+rRpubsw03qWL2iRyHH9Afl/YHuFYa8v7zEXDEigXJo9RAtTM4BTzElQhSgePv55AmHTo4W9v4SmkPDlLIhOpcXBK4GO2AnyzeN0MaKP7umX9bZAfc5LA84bxj3frYCxezbP9KG7QeJzevIhiAU4p/j+y2OyMV2mxNgAAAABJRU5ErkJggg==";var xT=v(127),bT=v.n(xT),TT=v(128),wT=v.n(TT),ET=v(129),ST=v.n(ET),AT=v(130),MT=v.n(AT),CT=v(131),RT=v.n(CT),IT=v(132),PT=v.n(IT),OT=v(133),NT=v.n(OT),LT=v(134),DT=v.n(LT),FT=v(135),BT=v.n(FT);const lg={wipe:class extends ur{constructor(i){super(uT.a,lT.a,{percent:0,direction:1,transition:0});let t=1;i==="up"?t=1:i==="down"?t=2:i==="left"?t=3:i==="right"&&(t=4),this.uniforms.direction=t}},fade:class extends ur{constructor(i){super(void 0,dT.a,{percent:0,transition:1});let t=1;i==="out"?t=-1:i==="in"&&(t=1),this.uniforms.transition=Math.pow(t,t)}},blinds:class extends ur{constructor(i){super(Pr.a,fT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0}},checkerboard:class extends ur{constructor(i){super(Pr.a,vT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="down"?1:0}},dissolve:class extends ur{constructor(i){super(Pr.a,yT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ce.t.from(ag)}},randombar:class extends ur{constructor(i){super(Pr.a,bT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0,this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ce.t.from(ag)}},circle:class extends ur{constructor(i){super(Pr.a,wT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},box:class extends ur{constructor(i){super(Pr.a,ST.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},diamond:class extends ur{constructor(i){super(Pr.a,MT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},plus:class extends ur{constructor(i){super(Pr.a,RT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},barn:class extends ur{constructor(i){super(Pr.a,PT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="inHorizontal"?1:i==="outHorizontal"?2:i==="outVertical"?3:0}},strips:class extends ur{constructor(i){super(Pr.a,NT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="upLeft"?1:i==="downRight"?2:i==="upRight"?3:0}},wedge:class extends ur{constructor(i){super(Pr.a,DT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])})}},wheel:class extends ur{constructor(i){super(Pr.a,BT.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=Number(i)||1}}};class kT extends Uo{constructor(t){var e;super(t),this.filterType="",this.isConflict=!1,this.activeWhenConflict="prev",this.removeTimeout=null,this.onTimeUpdate=({duration:o,delta:s})=>{var a;const l=s/o;if(this.filter){this.filter.percent=this.commonTimeNode.applyTimeFilter(l);const h=(a=this.timingTarget)===null||a===void 0?void 0:a.container.getBounds();h&&(this.filter.uniforms.uBoundRect=new Float32Array([h.x,h.y,h.width,h.height]))}l>=1&&this.timingTarget&&(this.removeTimeout=this.ctx.clock.setTimeout(()=>{this.removeFilter(),this.removeTimeout=null},34))},this.onSeekToStart=()=>{this.timingTarget&&this.removeFilter()},this.onSeekToEnd=()=>{this.timingTarget&&this.removeFilter()},this.onDestroy=()=>{this.removeFilter()},this.commonTimeNode.on("timelineStart",()=>{this.removeTimeout&&(this.ctx.clock.clearTimeout(this.removeTimeout),this.removeTimeout=null),this.filter&&this.timingTarget&&(this.timingTarget.container.filters&&this.timingTarget.container.filters.length!==0?this.timingTarget.container.filters.push(this.filter):this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let n=1;t.json.transition==="out"&&(n=-1);const r=(e=t.json.filter)===null||e===void 0?void 0:e.match(/^([a-zA-Z]+)(\((.+)\))?/);if(r){const o=r[1],s=r[3];lg[o]&&(this.filter=new lg[o](s),this.filterType=`${o}-${s}`,this.filter&&(this.filter.transition=n))}}get modifyAttrKey(){return this.filterType}removeFilter(){var t;if(!(!((t=this.timingTarget)===null||t===void 0)&&t.container.filters)||!this.filter)return;const e=this.timingTarget.container.filters.findIndex(n=>n===this.filter);e>=0&&this.timingTarget.container.filters.splice(e,1)}}class UT extends Uo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startPos=null,this.onTimeNodeStart=()=>{var e,n;this.startPos={x:((e=this.timingTarget)===null||e===void 0?void 0:e.ppt_x)||0,y:((n=this.timingTarget)===null||n===void 0?void 0:n.ppt_y)||0}},this.onTimeUpdate=({duration:e,delta:n})=>{var r;const o=n/e,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{this.timingTarget&&this.startPos&&(this.timingTarget.ppt_x=this.startPos.x,this.timingTarget.ppt_y=this.startPos.y)},this.onSeekToEnd=()=>{var e,n,r;const o=(n=(e=this.commonTimeNode.json)===null||e===void 0?void 0:e.spd)!==null&&n!==void 0?n:1,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o>0?1:0);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var t;const e=new Ps,n=(t=this.json.path)===null||t===void 0?void 0:t.match(/[MLCmlc][^MLCmlc]+/g);if(n)for(const r of n){const[o,...s]=r.trim().replace(/\s+/g," ").split(" ");if(o==="M"){const[a,l]=s.map(h=>Number(h));e.moveTo(a,l)}else if(o==="L"){const[a,l]=s.map(h=>Number(h));e.lineTo(a,l)}else if(o==="C"){const[a,l,h,u,p,_]=s.map(x=>Number(x));e.bezierCurveTo(a,l,h,u,p,_)}else if(o==="Z")e.closePath();else if(o==="E")console.warn("not implements");else if(o==="c"){const[a,l,h,u,p,_]=s.map(w=>Number(w)),x=e.currentPoint;e.bezierCurveTo(a+x.x,l+x.y,h+x.x,u+x.y,p+x.x,_+x.y)}else if(o==="l"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.lineTo(l+a.x,h+a.y)}else if(o==="m"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.moveTo(l+a.x,h+a.y)}}this.path=e}}class GT extends Uo{constructor(t){var e;super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.onTimelineStart=n=>{n.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:n,delta:r})=>{var o,s,a,l,h;const u=r/n,p={x:1,y:1};if(this.to){const _=(o=this.from)!==null&&o!==void 0?o:{x:(a=(s=this.startVal)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:1,y:(h=(l=this.startVal)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:1};p.x=_.x+(this.to.x-_.x)*u,p.y=_.y+(this.to.y-_.y)*u}else if(this.by){const _={x:this.by.x,y:this.by.y};p.x=1+(_.x-1)*u,p.y=1+(_.y-1)*u}this.timingTarget&&(this.timingTarget.scale=p)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&(this.timingTarget.scale=this.createVal)},this.from=t.json.from,this.to=t.json.to,this.by=t.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),!((e=this.timingTarget)===null||e===void 0)&&e.scale.x&&(this.createVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class HT extends Uo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isTimelineStart=!1,this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=e=>{if(this.isTimelineStart)return;this.isTimelineStart=!0,e.isReverse||this.updateCurrentValue(),this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to);const n=this.json.cBhvr.attrList[0],[r]=n.split(".");Hr(this.timingTarget,r+".on","true")},this.onTimeNodeEnd=()=>{const e=this.json.cBhvr.attrList[0];if(this.json.cBhvr.ctn.fill==="remove"){const[n]=e.split(".");Hr(this.timingTarget,n+".on","false")}this.isTimelineStart=!1},this.onSeekToStart=()=>{var e;const n=this.json.cBhvr.attrList[0];if(this.timingTarget){this.onTimeUpdate({duration:1,delta:0});const r=n==="ppt_c.color"||n==="text.color";if(((e=this.timingTarget.fill)===null||e===void 0?void 0:e.designColor.toUpperCase())===this.from.toHexString().toUpperCase()||r){const[o]=n.split(".");Hr(this.timingTarget,o+".on","false")}}},this.onTimeNodeStart=()=>{if(this.timingTarget){const e=this.json.cBhvr.attrList[0],n=Da(this.timingTarget,e);n&&(this.startColorString=n)}},this.onTimeUpdate=({delta:e,duration:n})=>{const r=e/n;if(this.to.interpolationFrom(this.from,r,this.target),this.timingTarget){const o=this.json.cBhvr.attrList[0];Hr(this.timingTarget,o,this.target.toHexString())}},this.onSeekToEnd=()=>{this.isTimelineStart||this.onTimelineStart({isReverse:!1,activeCount:0,id:""}),this.onTimeUpdate({duration:1,delta:1})},this.replaceAttrToRelation(),this.json.clrSpc==="rgb"?(this.from=new Ql(this.json.from),this.to=new Ql(this.json.to),this.by=new Ql(this.json.by),this.target=new Ql):(this.from=new Kl(this.json.from),this.to=new Kl(this.json.to),this.by=new Kl(this.json.by),this.target=new Kl),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart)}replaceAttrToRelation(){const t=this.json.cBhvr.attrList[0];t!=="ppt_c"?t==="style.color"&&(this.json.cBhvr.attrList[0]="text.color"):this.json.cBhvr.attrList[0]="ppt_c.color"}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const t=this.json.cBhvr.attrList[0],e=Da(this.timingTarget,t);e&&(this.currentColorString=e)}}}class jT extends Uo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.lastVal=null,this.onTimelineStart=e=>{this.lastVal=null,e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e;let o=0,s=0;if(this.from!==void 0&&this.to!==void 0){o=this.from,s=this.to;const a=o+(s-o)*r;this.timingTarget&&(this.timingTarget.r=a)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const a=this.by*r-this.lastVal;this.lastVal=this.by*r,this.timingTarget&&(this.timingTarget.r+=a)}},this.onTimeNodeCreate=()=>{var e;Fo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.createVal=this.timingTarget.r)},this.onTimeNodeStart=()=>{var e;Fo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.timingTarget&&this.createVal!==null&&(this.timingTarget.r=this.createVal),this.startVal=null},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.onTimeNodeCreate(),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var t;this.currentVal=(t=this.timingTarget)===null||t===void 0?void 0:t.r}}class zT extends Uo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var e,n;const{cmd:r,cmdType:o}=this.json;!this.isApplied&&r&&o&&(this.isApplied=!0,(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand(r,o),this.commonTimeNode.seekToEnd(!1))},this.onSeekToStart=()=>{var e,n;this.commonTimeNode.isInInteractiveSeq||(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("seekToStart",this.onSeekToStart),this.commonTimeNode.on("seekToEnd",this.onSeekToEnd)}get modifyAttrKey(){var t,e,n,r;return((e=(t=this.json)===null||t===void 0?void 0:t.cmd)!==null&&e!==void 0?e:"")+((r=(n=this.json)===null||n===void 0?void 0:n.cmdType)!==null&&r!==void 0?r:"")}}class VT{constructor(t){this.runtimeNodeEventHub=new yi.a,this.onVolumeUpdate=w=>{this.audio.volume(w)},this.stopAudio=()=>{this.audio.stop()},this.destroy=()=>{this.stopAudio(),this.audio.destroy(),this.ctx.activeMedia.delete(this.audio),this.ctx.volumeAdjuster.off("update",this.onVolumeUpdate)};const{json:e,isIterate:n,isSub:r,eventHub:o,ctx:s,parent:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.json=e,this.id=e.cMediaNode.ctn.id,this.commonTimeNode=new Ys({json:e.cMediaNode.ctn,isSub:r,eventHubs:{global:o,runtime:this.runtimeNodeEventHub},ctx:s,parent:a,isIterate:n,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_});let x=e.cMediaNode.tgtEl;s.loaderDelegate&&(x=s.loaderDelegate.redirectMedia(x),s.logger.info(`redirect media url from ${e.cMediaNode.tgtEl} to ${x} by delegate.`,s.taskId)),this.audio=new tc(x,s.runningAudio),s.activeMedia.add(this.audio),this.commonTimeNode.on("timelineStart",()=>{this.audio.volume(s.volumeAdjuster.volume),this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.destroy),this.ctx=s,this.ctx.volumeAdjuster.on("update",this.onVolumeUpdate)}}function ic(i){return function(t){return!!(t!=null&&t.cBhvr)}(i)?i.cBhvr.ctn:function(t){var e;return!!(!((e=t==null?void 0:t.cMediaNode)===null||e===void 0)&&e.ctn)}(i)?i.cMediaNode.ctn:i.ctn}var WT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Ys extends yi.a{constructor(t){var e,n;super(),this.uuid=ss(),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId="",this.iterateShadows=[],this.isEndEventsEmitted=!1,this.tmFilter=[],this.timeDelta=0,this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.isInfiniteRepeat()?this.repeatTimeNodeEnd():this.seekToEnd(!1,!0))},this.handleActive=(G=!0)=>{if(this.isActive=!0,this.isConflictDispose=!1,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(G))}else this.startTimeLine(G)},this.updateTimeLine=G=>{const Q=G/(yr.b.TARGET_FPMS||.06);this.timeDelta+=Q,this.duration-this.timeDelta<=Q&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(G=!1)=>{(this.isTimeNodeEnd()||G)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:r,isIterate:o,ctx:s,eventHubs:a,parent:l,json:h,iterateType:u,iterateId:p,iterateIndex:_,isInInteractiveSeq:x,fromSeqId:w}=t;this.isSub=r,this.fromSeqId=w,this.isInInteractiveSeq=x,this.isIterate=o,this.parentTimeNode=l,this.json=h,this.ctx=s,this.iterateIndex=_,this.eventHubs=a,this.iterateType=u,this.iterateId=p,this.tmFilter=(n=(e=h.tmFilter)===null||e===void 0?void 0:e.split(";").map(G=>G.split(",").map(Q=>parseFloat(Q.trim()))))!==null&&n!==void 0?n:[];const M=Number(this.json.dur),C=this.json.spd||1;if(this.isNegativeSpeed=C<0,Number.isNaN(M)||(this.duration=M/Math.abs(C)),this.uuid+="--"+this.json.id,this.setPreStyle(),h.childTnLst&&this.createChildren(h.childTnLst),this.startConds=new La(this.json.id||"",h.stCondLst,a,this.ctx),this.endConds=new La(this.json.id||"",h.endCondLst,a,this.ctx),h.endSync&&(this.endSync=new La(this.json.id||"",[h.endSync],a,this.ctx),this.endSync.on("active",()=>{var G;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(G=this.endSync)===null||G===void 0||G.reset())})),this.startConds.on("active",G=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(G))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(G=>G.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"){const G="shape slide onNext"+this.fromSeqId;this.startConds.addCond({event:G})}this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const t=ss();let e=!0,n=0;const r=o=>{o===t&&(e=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",r))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",r);e;){const o=JSON.parse(JSON.stringify(this.json)),s=new Ys({json:o,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:o.iterate.type,iterateIndex:n,iterateId:t,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId});this.iterateShadows[n]=s,n+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(t){this.isReverse=t}createTimeNode(t,e){let n=null;const r={json:t,isSub:e,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId};return t.type==="seq"?n=new oT(r):t.type==="par"?n=new hg(r):t.type==="set"?n=new nc(r):t.type==="anim"?n=new sT(r):t.type==="animEffect"?n=new kT(r):t.type==="animMotion"?n=new UT(r):t.type==="animScale"?n=new GT(r):t.type==="animClr"?n=new HT(r):t.type==="animRot"?n=new jT(r):t.type==="cmd"?n=new zT(r):t.type==="audio"&&(n=new VT(r)),n}createSubList(t){this.subList&&this.subList.forEach(e=>e.commonTimeNode.destroy()),this.subList=[],t.forEach(e=>{const n=this.createTimeNode(e,!0);n&&this.subList.push(n)})}bindCommonTimeNodeEvent(t){t.commonTimeNode.on("timeNodeStart",e=>{this.emit("childTimeNodeStart",e)}),t.commonTimeNode.on("timeNodeEnd",e=>{this.emit("childTimeNodeEnd",e),this.children.every(n=>n.commonTimeNode.isTimeNodeEndWhenDetectEndSync())&&(this.json.iterate||this.allChildrenEndHandle())})}createChildren(t){function e(o){return ic(o).presetOrder}function n(o){return/^slide/.test(o)?"slide":/^layout/.test(o)?"layout":/^master/.test(o)?"master":"unknow"}const r=["master","layout","slide","unknow"];t&&t[0]&&e(t[0])?[...t].sort((o,s)=>{var a,l,h,u;const p=ic(o).id,_=ic(s).id;if(p&&_){const x=n(p),w=n(_);return x===w?((a=e(o))!==null&&a!==void 0?a:0)-((l=e(s))!==null&&l!==void 0?l:0):r.indexOf(x)-r.indexOf(w)}return((h=e(o))!==null&&h!==void 0?h:0)-((u=e(s))!==null&&u!==void 0?u:0)}).forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))}):t.forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(t=>t.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=this.ctx.clock.setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.isInInteractiveSeq&&this.isInfiniteRepeat()&&this.repeatTimeNodeEnd(),this.timeDelta=0,this.children.forEach(t=>t.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(t=>t.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.isEndEventsEmitted=!1,this.timeDelta=0;const t=1e3/this.ctx.ticker.maxFPS;this.duration<=t&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(Ze.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>t&&(this.ctx.eventHub.emit(Ze.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(t=!0){if(t&&(this.isEndEventsEmitted=!1,this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.ctx.ticker.addOnce(()=>{this.onTimeLineEnd()})):this.duration>e&&(this.ctx.eventHub.emit(Ze.animateStart),this.updateTimeLine(0),this.ctx.ticker.add(this.updateTimeLine))}startIterate(){return WT(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const t of this.iterateShadows){if(this.isIterateEnd)break;t.children.forEach(e=>{e.commonTimeNode.startTimeNode()}),t.applyCount+=1,yield this.ctx.clock.delay(this.json.iterate.interval)}this.onTimeLineEnd()}})}applyTimeFilter(t){if(!this.tmFilter.every(e=>Fo()(e[0])&&Fo()(e[1])))return t;for(let e=0;e<this.tmFilter.length;e++){const n=this.tmFilter[e];if(t<n[0]){const r=this.tmFilter[e-1];return(t-r[0])/(n[0]-r[0])*(n[1]-r[1])+r[1]}}return this.tmFilter.length>0?this.tmFilter[this.tmFilter.length-1][1]:t}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}findTargets(){const t=[],e=n=>{n.forEach(r=>{var o,s,a;r.cBhvr&&r.cBhvr.target&&t.findIndex(l=>l.id===r.cBhvr.target.id)<0&&t.push(r.cBhvr.target),((s=(o=r==null?void 0:r.cBhvr)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.childTnLst)&&r.cBhvr.ctn.childTnLst.length>0&&e(r.cBhvr.ctn.childTnLst),((a=r==null?void 0:r.ctn)===null||a===void 0?void 0:a.childTnLst)&&r.ctn.childTnLst.length>0&&e(r.ctn.childTnLst)})};return e(this.json.childTnLst||[]),t}setPreStyle(){this.json.presetClass&&this.findTargets().forEach(t=>{if(this.json.iterate){let e=0,n=!0;for(;n;){const r=this.ctx.timingTargets.getTarget(t,!0,{type:this.json.iterate.type,index:e,id:""});r&&(this.setPreStyleForTarget(r),e+=1),n=!!r}}else{const e=this.ctx.timingTargets.getTarget(t,!1);e&&this.setPreStyleForTarget(e)}})}setPreStyleForTarget(t){var e,n;if(t&&this.json.presetSubtype&&(t.presetSubType=this.json.presetSubtype),t&&!t.hasPreset)if(this.json.presetClass==="entr"){const r=(n=(e=this.json)===null||e===void 0?void 0:e.childTnLst)===null||n===void 0?void 0:n.filter(o=>o.type==="set"&&o.to==="visible");r!=null&&r.length&&(t.hasPreset=!0,t.style.visibility="hidden")}else(this.json.presetClass==="exit"||this.json.presetClass==="path"||this.json.presetClass==="emph")&&(t.hasPreset=!0,t.style.visibility="visible")}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(t=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(t);const e=this.json.stCondLst.filter(r=>/^self/.test(r.event||""))[0];e&&this.startConds.condHandle(e);const n=this.json.endCondLst.filter(r=>/^self/.test(r.event||""))[0];n&&this.endConds.condHandle(n),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(t=>t.commonTimeNode.destroy())}seekToStart(t=!0){if(this.isEndEventsEmitted=!1,this.isActive=!1,this.dispose(),this.timeDelta=0,this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(e=>e.seekToStart(t));if(t)for(let e=this.subList.length-1;e>=0;e--){const n=this.subList[e];n==null||n.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}if(this.children.length>1)for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}}repeatTimeNodeEnd(){this.dispose(),this.children.forEach(t=>{t.commonTimeNode.isActive=!1,t.commonTimeNode.dispose()})}dispose(t=!1){this.isConflictDispose=t,this.ctx.clock.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(Ze.animateEnd);try{this.ctx.ticker.remove(this.updateTimeLine)}catch{}this.startConds.reset(),this.endConds.reset()}seekToEnd(t,e=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const n=this.json.autoRev||t;if(n?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(r=>r.seekToEnd(n,e));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(r=>r.commonTimeNode.seekToEnd(n,e)),e&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(r=>r.commonTimeNode.seekToEnd(!1)),this.clearSubList())}isTimeNodeEndWhenDetectEndSync(){if(this.isInInteractiveSeq&&this.isInfiniteRepeat())return!0;let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEndWhenDetectEndSync())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}isTimeNodeEnd(){let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}emitEndEvents(){this.isEndEventsEmitted||(this.isEndEventsEmitted=!0,this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}))}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(t=>t.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(t=>t.commonTimeNode.destroy()),this.clearSubList()}}class hg extends yi.a{constructor(t){super(),this.isRunning=!1,this.runtimeNodeEventHub=new yi.a;const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.id=e.ctn.id,this.json=e,this.ctx=a,this.isIterate=r,this.globalEventHub=l,this.commonTimeNode=new Ys({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),x.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end")),this.commonTimeNode.json.presetClass==="exit"&&this.commonTimeNode.children.length>=1&&this.commonTimeNode.children[this.commonTimeNode.children.length-1]instanceof nc&&this.commonTimeNode.children.forEach(x=>{x instanceof nc||typeof x.onSeekToStart!="function"||x.onSeekToStart()})})}}var XT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class YT{constructor(t,e,n){this.json=t,this.ctx=n,this.globalEventHub=e;const r=t.timeNodeList.find(o=>o.type==="par"&&o.ctn.nodeType==="tmRoot");r&&(this.tmRoot=new hg({json:r,isSub:!1,isIterate:!1,eventHub:e,ctx:n,parent:null,iterateType:"el",iterateIndex:0,iterateId:"",isInInteractiveSeq:!1,fromSeqId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(o=>{var s,a,l;return((s=o.json)===null||s===void 0?void 0:s.type)==="seq"&&((l=(a=o.json)===null||a===void 0?void 0:a.ctn)===null||l===void 0?void 0:l.nodeType)==="mainSeq"}))}findSeq(t){var e;return(e=this.tmRoot)===null||e===void 0?void 0:e.commonTimeNode.children.find(n=>{var r,o,s;return((r=n.json)===null||r===void 0?void 0:r.type)==="seq"&&((s=(o=n.json)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.id)===t})}start(){var t,e;return XT(this,void 0,void 0,function*(){this.json.autoPlayMainSeq?(yield this.ctx.clock.delay(16),(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.startTimeNode()):(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()})}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var t;(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.collectStartValue()}setMainSeqStep(t,e){var n;t===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(n=this.mainSeq)===null||n===void 0||n.setCurrentStep(t,e)}destroy(){var t;this.globalEventHub.removeAllListeners(),(t=this.tmRoot)===null||t===void 0||t.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(t){const e=this.findSeq(t);e&&e.commonTimeNode.seekToEnd(!1,!0)}setInteractiveSeqState(t,e,n){const r=this.findSeq(t);r&&r.setCurrentStep(e,n)}resetAllInteractiveSeq(){var t;(((t=this.tmRoot)===null||t===void 0?void 0:t.commonTimeNode.children.filter(e=>{var n,r,o;return((n=e.json)===null||n===void 0?void 0:n.type)==="seq"&&((o=(r=e.json)===null||r===void 0?void 0:r.ctn)===null||o===void 0?void 0:o.nodeType)==="interactiveSeq"}))||[]).forEach(e=>{e.setCurrentStep(0,"start")})}applyInteractiveAction(t){this.globalEventHub.emit(t)}}var ug=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class qT extends ec{constructor(t,e,n,r){super({id:"stage",width:t.width,height:t.height,type:"Container",children:t.children},e,{parentGlobalPos:n},r),this.isRendered=!1,this.isTimingStartValueCollected=!1,this.json=t,this.json.smartArtShapeList&&(e.smartArtShapeList=this.json.smartArtShapeList),e.hasBackgroundFillShape=this.detectUseBackgroundFill(this.json),this.container.visible=!1,this.ctx=e;const o=new er;o.beginFill(16777215),o.drawRect(0,0,t.width,t.height),o.endFill(),this.container.addChild(o)}detectUseBackgroundFill(t){return!!t&&(t.type==="Picture"||t.type==="Shape"?t.useBgFill:!(!t.children||!Array.isArray(t.children))&&t.children.some(e=>this.detectUseBackgroundFill(e)))}initOnReuse(){super.initOnReuse(),this.ctx.timingEventHub.on("c:prev slide",t=>{this.ctx.eventHub.emit(Ze.requestPrevSlide,t)}),this.ctx.timingEventHub.on("c:next slide",(t,e)=>{this.ctx.eventHub.emit(Ze.requestNextSlide,t,e)})}get interactiveContainer(){return this.container}applyEffectCacheAsBitMap(t){this.children.forEach(e=>e.applyEffectCacheAsBitMap(t))}render(t){this.isRendered||(this.collectAnimatedIds().forEach(e=>this.ctx.animatedIds.add(e)),this.isRendered=!0,super.render(t),t.addSubMTask(()=>ug(this,void 0,void 0,function*(){this.ctx.eventHub.emit("StageRenderEnd")}),"@StageImpl[emit.StageRenderEnd]"))}isListTimeNode(t){return["excel","seq","par"].indexOf(t.type)>=0}isAnimatedTimeNode(t){return!!t.cBhvr}collectAnimatedIdsForTimeNode(t,e){var n;this.isListTimeNode(t)?(n=t.ctn.childTnLst)===null||n===void 0||n.forEach(r=>{this.collectAnimatedIdsForTimeNode(r,e)}):this.isAnimatedTimeNode(t)&&e.push(t.cBhvr.target.id)}collectAnimatedIds(){const t=[];return this.json.timing&&this.json.timing.timeNodeList.forEach(e=>{this.collectAnimatedIdsForTimeNode(e,t)}),t}createTiming(){this.json.timing&&!this.timing&&(this.timing=new YT(this.json.timing,this.ctx.timingEventHub,this.ctx))}startTiming(){var t;return((t=this.timing)===null||t===void 0?void 0:t.start())||Promise.resolve()}setMainSeqApplied(){var t;(t=this.timing)===null||t===void 0||t.setMainSeqApplied()}setMainSeqStep(t,e){var n;(n=this.timing)===null||n===void 0||n.setMainSeqStep(t,e)}collectMainSeqStartValue(){var t;this.isTimingStartValueCollected||(this.isTimingStartValueCollected=!0,(t=this.timing)===null||t===void 0||t.collectMainSeqStartValue())}hasTiming(){return!!this.timing}clearOnSlideChange(){this.ctx.eventHub.removeAllListeners(),this.ctx.timingEventHub.removeAllListeners(),super.clearOnSlideChange()}clearOnTransactionEnd(){var t,e;this.ctx.timingTargets.getTargets().forEach(n=>{n.hasPreset=!1}),(t=this.timing)===null||t===void 0||t.resetAllInteractiveSeq(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0}destroy(){var t,e;this.isTimingStartValueCollected=!1,this.isRendered=!1,this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),(t=this.ctx.bgTexture)===null||t===void 0||t.destroy(!0),this.ctx.spriteTexture.destroy(),this.ctx.timingEventHub.removeAllListeners(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0,super.destroy()}mainSeqStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqStep())!==null&&e!==void 0?e:0}mainSeqLength(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqLength())!==null&&e!==void 0?e:0}mainSeqHasNextStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(t,e){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onNext",t,e)):this.ctx.eventHub.emit(Ze.requestNextSlide,t,e)}prevStep(t=!1){var e;this.hasTiming()&&((e=this.timing)===null||e===void 0?void 0:e.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onPrev",t)):this.ctx.eventHub.emit(Ze.requestPrevSlide,t)}applyInteractiveAction(t){var e;(e=this.timing)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.timing)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.timing)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){return ug(this,void 0,void 0,function*(){const r=this.ctx.medias[t];r&&(e?n?(yield Yl(()=>r.clippedDuration>0,5e3),n<r.clippedDuration&&(r.once("play",()=>{r.seek(n)}),yield r.play())):yield r.play():(n&&r.seek(n),yield r.pause()))})}setMediaCurrentTime(t,e){const n=this.ctx.medias[t];n&&n.seek(e)}}class JT{constructor(t){this.ticker=t,this.tasks=[],this.couldRunning=!1,this.applyNext=()=>{this.tasks=this.tasks.filter(n=>!n.isEmpty());const e=this.tasks[0];e&&e.applyNext()},t.add(this.applyNext)}addTask(t){this.tasks.push(t),t.once("task-finish",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)}),t.once("task-error",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)})}start(){this.couldRunning=!0}stop(){this.couldRunning=!1}}var ZT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const KT=i=>new Promise(t=>setTimeout(t,i));class QT extends yi.a{constructor(t,e,n){super(),this.slideIndex=t,this.taskId=e,this.logger=n,this.uuid=ss(),this.isCancel=!1,this.tasks=[]}isEmpty(){return this.tasks.length===0}addMTask(t,e){this.tasks.push({fn:t,state:"wait",sub:[],name:e})}addSubMTask(t,e){let n=this.tasks.findIndex(r=>r.state==="running");n<0&&(n=0),this.tasks[n].sub.push({fn:t,state:"wait",sub:[],name:e})}cancel(){this.tasks=[],this.isCancel=!0}applyNext(){if(this.tasks.some(e=>e.state==="running")||this.tasks.some(e=>e.state==="error"))return;if(this.tasks.every(e=>e.state==="finish"))return void(this.isCancel||this.emit("task-finish"));const t=this.tasks.find(e=>e.state==="wait");t&&(t.state="running",t.fn.apply(null).then(()=>{if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}).catch(e=>{t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",xi.transform(e),this.slideIndex)}))}applyAll(){return ZT(this,void 0,void 0,function*(){for(;!this.tasks.every(t=>t.state==="finish");)if(this.tasks.some(t=>t.state==="running"))yield KT(16);else{if(this.tasks.some(t=>t.state==="error"))return;{const t=this.tasks.find(e=>e.state==="wait");if(t){t.state="running";try{if((yield js(()=>t.fn.apply(null),6e4))===uo)throw new xi(Vi.RuntimeError,`subtask ${t.name} apply timeout`);if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}catch(e){let n;n=e!=null&&e.errorType?e:new xi(Vi.RuntimeError,`subtask ${t.name} error. ${e}`),t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",xi.transform(n),this.slideIndex);break}}}}!this.isCancel&&this.tasks.every(t=>t.state==="finish")&&this.emit("task-finish")})}}var $T=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class tw{constructor(t,e){this.renderer=t,this.localStorage=e,this.worker=null,this.outputData=new Map,this.loadingSdfKeys=new Set;const n=new Blob([`
self.onmessage = function(e) {
    var data = e.data.data;
    var key = e.data.key;
    var height = Math.ceil(e.data.height);
    var width = Math.ceil(e.data.width);
    if (!data || !key) {
        return;
    }
    var maxDis = 0;
    var d = [];
    var p = [];
    var maxInt = Number.MAX_SAFE_INTEGER || 255 * 255 * 255;
    var setD = function(x, y, v) { d[y * width + x] = v; };
    var getD = function(x, y) { return d[y * width + x]; };
    var setP = function(x, y, v) { p[y * width + x] = v; };
    var getP = function(x, y) { return p[y * width + x]; };
    var isContains = function(x, y) { return x >= 0 && x < width && y >= 0 && y < height; };
    var isInterior = function(x, y) { return data[(y * width + x) * 4 + 3] > 10; };
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var c = isInterior(x, y);
            var t = isContains(x, y - 1) ? isInterior(x, y - 1) : false;
            var b = isContains(x, y + 1) ? isInterior(x, y + 1) : false;
            var l = isContains(x - 1, y) ? isInterior(x - 1, y) : false;
            var r = isContains(x + 1, y) ? isInterior(x + 1, y) : false;
            if (c !== t || c !== b || c !== l || c !== r) {
                setD(x, y, 0);
                setP(x, y, [x, y]);
            } else {
                setD(x, y, maxInt);
                setP(x, y, [-1, -1]);
            }
        }
    }
    
    var f = function (x, y, dir) {
        var d1 = 1;
        var d2 = Math.sqrt(2);
        var dx;
        var dy;
        var od;
        switch (dir) {
            case "TL": dx = -1; dy = -1; od = d2; break;
            case "T": dx = 0; dy = -1; od = d1; break;
            case "TR": dx = 1; dy = -1; od = d2; break;
            case "L": dx = -1; dy = 0; od = d1; break;
            case "R": dx = 1; dy = 0; od = d1; break;
            case "BL": dx = -1; dy = 1; od = d2; break;
            case "B": dx = 0; dy = 1; od = d1; break;
            case "BR": dx = 1; dy = 1; od = d2; break;
        }
        var b = isContains(x + dx, y + dy);
        var cb = b ? getD(x + dx, y + dy) : maxInt;
        if (cb + od < getD(x, y)) {
            var p = b ? getP(x + dx, y + dy) : [-1, -1];
            var dis = Math.sqrt(Math.pow(x - p[0], 2) + Math.pow(y - p[1], 2));
            setP(x, y, p);
            setD(x, y, dis);
            if (dis > maxDis) {
                maxDis = dis;
            }
        }
    };
    
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var dirs = ["TL", "T", "TR", "L"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    for (var y = height - 1; y >= 0; -- y) {
        for (var x = width - 1; x >= 0; -- x) {
            var dirs = ["R", "BL", "B", "BR"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    var outputData = [];
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            outputData.push(isInterior(x, y) ? 255: 0);
            outputData.push(0);
            outputData.push(0);
            outputData.push(Math.ceil(getD(x, y) / maxDis * 255));
        }
    }
    self.postMessage({
        key, outputData, maxDis
    });
};
`],{type:"text/javascript"});this.worker=new Worker(URL.createObjectURL(n)),this.worker.onmessage=r=>{this.outputData.set(r.data.key,{data:r.data.outputData,maxDis:r.data.maxDis})},this.outputData.set("111","222")}createSdfByWorker(t,e,n,r,o,s,a,l){const h=document.createElement("canvas");h.width=o,h.height=s;const u=h.getContext("2d");if(!u||!this.worker)return;u.drawImage(a,t,e,n,r);const{data:p}=u.getImageData(0,0,o,s);this.worker.postMessage({data:p,key:l,width:o,height:s})}createSdf(t,e,n){const r=document.createElement("canvas");r.width=t,r.height=e;const o=r.getContext("2d");if(!o)return{src:"",maxDis:1};o.drawImage(n,0,0);let s=0;const{data:a}=o.getImageData(0,0,t,e),l=[],h=[],u=function(Q,nt,ct){l[nt*t+Q]=ct},p=function(Q,nt){return l[nt*t+Q]},_=function(Q,nt,ct){h[nt*t+Q]=ct},x=function(Q,nt){return h[nt*t+Q]},w=function(Q,nt){return Q>=0&&Q<t&&nt>=0&&nt<e},M=function(Q,nt){return a[4*(nt*t+Q)+3]>10};for(let Q=0;Q<e;++Q)for(let nt=0;nt<t;++nt){const ct=M(nt,Q),it=!!w(nt,Q-1)&&M(nt,Q-1),mt=!!w(nt,Q+1)&&M(nt,Q+1),lt=!!w(nt-1,Q)&&M(nt-1,Q),gt=!!w(nt+1,Q)&&M(nt+1,Q);ct!==it||ct!==mt||ct!==lt||ct!==gt?(u(nt,Q,0),_(nt,Q,[nt,Q])):(u(nt,Q,Number.MAX_SAFE_INTEGER),_(nt,Q,[-1,-1]))}const C=function(Q,nt,ct){const it=Math.sqrt(2);let mt,lt,gt;switch(ct){case"TL":mt=-1,lt=-1,gt=it;break;case"T":mt=0,lt=-1,gt=1;break;case"TR":mt=1,lt=-1,gt=it;break;case"L":mt=-1,lt=0,gt=1;break;case"R":mt=1,lt=0,gt=1;break;case"BL":mt=-1,lt=1,gt=it;break;case"B":mt=0,lt=1,gt=1;break;case"BR":mt=1,lt=1,gt=it}const Ut=w(Q+mt,nt+lt);if((Ut?p(Q+mt,nt+lt):Number.MAX_SAFE_INTEGER)+gt<p(Q,nt)){const Ft=Ut?x(Q+mt,nt+lt):[-1,-1],Mt=Math.sqrt(Math.pow(Q-Ft[0],2)+Math.pow(nt-Ft[1],2));_(Q,nt,Ft),u(Q,nt,Mt),Mt>s&&(s=Mt)}};for(let Q=0;Q<e;++Q)for(let nt=0;nt<t;++nt){const ct=["TL","T","TR","L"];for(const it of ct)C(nt,Q,it)}for(let Q=e-1;Q>=0;--Q)for(let nt=t-1;nt>=0;--nt){const ct=["R","BL","B","BR"];for(const it of ct)C(nt,Q,it)}const G=[];for(let Q=0;Q<e;++Q)for(let nt=0;nt<t;++nt)G.push(0,0,0,Math.ceil(p(nt,Q)/s*255));return o.putImageData(new ImageData(Uint8ClampedArray.from(G),t,e),0,0),{src:r.toDataURL("image/png"),maxDis:s}}getSdf(t,e,n){return $T(this,void 0,void 0,function*(){const r=Math.ceil(e.width),o=Math.ceil(e.height),s=Math.ceil(e.width-t.width)/2,a=Math.ceil(e.height-t.height)/2;let l=yield this.localStorage.getItem(`sdf-${n}-src`),h=yield this.localStorage.getItem(`sdf-${n}-maxDis`);if(!(l&&h||this.loadingSdfKeys.has(n))){this.loadingSdfKeys.add(n);const u=this.renderer.plugins.extract.image(t,"image/png");u.addEventListener("load",()=>{this.createSdfByWorker(s,a,t.width,t.height,r,o,u,n)}),u.addEventListener("error",()=>null),yield Yl(()=>!!this.outputData.has(n),2e3),this.loadingSdfKeys.delete(n);const p=this.outputData.get(n);if(p){this.outputData.delete(n);const _=document.createElement("canvas");_.width=r,_.height=o;const x=_.getContext("2d");if(!x)return null;x.putImageData(new ImageData(Uint8ClampedArray.from(p.data),r,o),0,0),l=_.toDataURL("image/png"),h=p.maxDis,this.localStorage.setItem(`sdf-${n}-src`,l).catch(()=>{}),this.localStorage.setItem(`sdf-${n}-maxDis`,h).catch(()=>{})}}return!l||!h?null:(document.createElement("img").src=l,ce.t.fromURL(l).then(u=>({texture:u,maxDis:h})).catch(()=>null))})}destroy(){var t;(t=this.worker)===null||t===void 0||t.terminate(),this.worker=null}}var Fa=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class ew{constructor(t,e,n,r,o,s,a,l,h,u,p,_,x,w,M,C,G){this.loader=t,this.mode=e,this.renderer=n,this.ticker=r,this.view=o,this.clock=s,this.objPoolGroup=a,this.errorChannel=l,this.localstorage=h,this.logger=u,this.loaderDelegate=p,this.urlInterrupter=_,this.isPlayerPaused=x,this.maxResolution=w,this.volumeAdjuster=M,this.forceCanvas=C,this.globalEventHub=G,this.currentStageIndex=0,this.cacheCount=hs.isDesktop()?2:1,this.stageStates=Object.create(null),this.stageJsons=Object.create(null),this.stageCtxs=Object.create(null),this.stageImpls=Object.create(null),this.taskId="",this.url="",this.runningAudio=new Map,this.activeMedia=new Set,this.microTaskManager=new JT(r),this.sdfManager=new tw(n,h)}setResourceData(t,e){this.taskId=t,this.url=e}createCtx(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Fa(this,void 0,void 0,function*(){const n=new zb(this.loader),r=new yi.a,o={taskId:this.taskId,mode:this.mode,renderer:this.renderer,graphicsTexture:new qb(this.maxResolution),stageWidth:0,stageHeight:0,ticker:this.ticker,timingTargets:new Zb(r),eventHub:r,view:this.view,medias:Object.create(null),lastViewedIndex:0,conflictTimeNodeManager:new Jb,clock:this.clock,spriteTexture:n,slideIndex:t,objectPoolGroup:this.objPoolGroup,hasBackgroundFillShape:!1,slideScopeEventHub:new yi.a,logger:this.logger,sdfManager:this.sdfManager,loaderDelegate:this.loaderDelegate,runningAudio:this.runningAudio,activeMedia:this.activeMedia,isPlayerPaused:this.isPlayerPaused,timingEventHub:new yi.a,maxResolution:this.maxResolution,animatedIds:new Set,volumeAdjuster:this.volumeAdjuster,forceCanvas:this.forceCanvas,globalEventHub:this.globalEventHub,latestChangeFullscreenTargetId:"",isRendering:!1,urlInterrupter:this.urlInterrupter};this.stageCtxs[t]=o}),"@StagePool[createCtx]")}loadStageJson(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Fa(this,void 0,void 0,function*(){const n=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${t}.json`);this.stageJsons[t]=n,this.stageCtxs[t].stageWidth=n.width,this.stageCtxs[t].stageHeight=n.height,this.stageCtxs[t].featureList=n.featureList}),"@StagePool[loadStageJson]")}loadSpriteSheets(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{const n=this.stageJsons[t],{spriteTexture:r,stageWidth:o,stageHeight:s}=this.stageCtxs[t],{coloredSheets:a,sheets:l}=n,h=a||l;return h&&h.forEach(u=>{e.addSubMTask(()=>{let p=1;if(o>this.maxResolution.x||s>this.maxResolution.y){p=this.maxResolution.x/o;const _=p*s;_>this.maxResolution.y&&(p*=this.maxResolution.y/_)}return r.loadSpriteSheetItem(this.url,this.taskId,u,p)},"@StagePool[spriteTexture.loadSpriteSheetItem]")}),Promise.resolve()},"@StagePool[loadSpriteSheets]")}createStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{const n=this.stageJsons[t],r=this.stageCtxs[t],o=new qT(n,r,{x:0,y:0},e);return this.stageImpls[t]=o,Promise.resolve()},"@StagePool[createStage]")}preRenderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>(this.stageImpls[t].preRender(e),Promise.resolve()),"@StagePool[preRenderStage]")}createGraphicsTexture(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Fa(this,void 0,void 0,function*(){const n=this.stageCtxs[t];n.graphicsTexture.pack().forEach((r,o)=>{e.addSubMTask(()=>n.graphicsTexture.render(r,o,this.objPoolGroup,1),"@StagePool[graphicsTexture.render]")})}),"@StagePool[createGraphicsTexture]")}renderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Fa(this,void 0,void 0,function*(){yield this.stageImpls[t].render(e)}),"@StagePool[renderStage]")}destroyStageByIndex(t){this.stageStates[t].state==="load"&&this.stageStates[t].task.cancel(),delete this.stageStates[t],this.stageImpls[t].destroy(),delete this.stageImpls[t],delete this.stageCtxs[t]}destroyStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);Math.abs(this.currentStageIndex-e)>this.cacheCount&&this.destroyStageByIndex(e)})}destroyAllStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);this.destroyStageByIndex(e)})}preload(t,e=!1){if(this.stageImpls[t]||this.stageStates[t])return Promise.resolve();const n=new QT(t,this.taskId,this.logger);return n.on("task-error",(r,o)=>{delete this.stageStates[o],delete this.stageImpls[o],delete this.stageCtxs[o],this.errorChannel.emit("error",r,o)}),this.stageStates[t]={state:"load",task:n},this.createCtx(t),this.loadStageJson(t),this.loadSpriteSheets(t),this.createStage(t),this.preRenderStage(t),this.createGraphicsTexture(t),this.renderStage(t),this.microTaskManager.addTask(n),e?n.applyAll():new Promise(r=>{n.once("task-finish",()=>{this.stageStates[t].state="finish",Object.keys(this.stageStates).length>2*this.cacheCount+1&&this.destroyStage(),r()})})}getStageJson(t){return this.stageJsons[t]||null}getStage(t){return Fa(this,void 0,void 0,function*(){this.currentStageIndex=t;const e=this.stageStates[t];return(e==null?void 0:e.state)==="finish"&&this.stageImpls[t]?this.stageImpls[t]:(e==null?void 0:e.state)==="load"?(yield e.task.applyAll(),this.stageImpls[t]):(yield this.preload(t,!0),this.stageImpls[t])})}destroy(){this.runningAudio.clear(),this.sdfManager.destroy()}}var cg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Or{constructor(t){var e;this.logger=t,this.taskId="",this.isIndexDBReady=!1,this.memoryCache=new Map,(e=Or.localCache)===null||e===void 0||e.ready(n=>{n||(this.isIndexDBReady=!0)}).catch(()=>{t.warn("local storage not ready",this.taskId)})}get couldUseIndexDBCache(){return this.isIndexDBReady&&this.taskId.length>0}attachTaskId(t){this.taskId=t}getItem(t){return cg(this,void 0,void 0,function*(){let e=null;if(this.couldUseIndexDBCache&&Or.localCache)try{e=yield js(()=>Or.localCache.getItem(`${this.taskId}/${t}`),500)}catch{}return e=e===uo?null:e,e||this.memoryCache.get(t)||null})}setItem(t,e,n=!1){return cg(this,void 0,void 0,function*(){if(!this.couldUseIndexDBCache)return n&&this.memoryCache.set(t,e),Promise.resolve();if(Or.localCache){let r=null;try{r=yield js(()=>Or.localCache.setItem(`${this.taskId}/${t}`,e).catch(()=>{n&&this.memoryCache.set(t,e)}),500)}catch{}r!==uo&&r!==null||!n||this.memoryCache.set(t,e)}})}dispose(){var t;this.memoryCache=new Map,this.couldUseIndexDBCache&&((t=Or.localCache)===null||t===void 0||t.keys().then(e=>{e.filter(n=>n.indexOf(this.taskId)>=0).forEach(n=>{var r;(r=Or.localCache)===null||r===void 0||r.removeItem(n).catch(()=>{})})}).catch(()=>{}))}}Or.localCache=null;try{Or.localCache=I.createInstance({name:"slide_local_cache",driver:I.INDEXEDDB,version:1})}catch{}const nw=new De.j;class rc{constructor(t){this.localStorage=t}canvas(t,e,n,r){let o,s,a,l=!1,h=!1;t&&(t instanceof ce.p?a=t:(a=e.generateTexture(t),h=!0)),a?(o=a.baseTexture.resolution,s=a.frame,l=!1,e.renderTexture.bind(a)):(o=e.resolution,l=!0,s=nw,s.width=e.width,s.height=e.height,e.renderTexture.bind(null));const u=Math.floor(s.width*o+1e-4),p=Math.floor(s.height*o+1e-4);let _=document.createElement("canvas");_.width=u,_.height=p;const x=_.getContext("2d");if(!x)throw new Error("ctx");if(n)x.putImageData(n,0,0);else{const w=x.getImageData(0,0,u,p),M=new Uint8Array(4*u*p),{gl:C}=e;C.readPixels(s.x*o,s.y*o,u,p,C.RGBA,C.UNSIGNED_BYTE,M),rc.arrayPostDivide(M,w.data),x.putImageData(w,0,0),r&&this.localStorage.setItem(r,w).catch(()=>{})}if(l){const w=document.createElement("canvas");w.width=u,w.height=p;const M=w.getContext("2d");M.scale(1,-1),M.drawImage(_,0,-p),_=w}return h&&(a==null||a.destroy(!0)),_}static arrayPostDivide(t,e){for(let n=0;n<t.length;n+=4){const r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}}}class dg extends yi.a{constructor(){super(...arguments),this._volume=.5}get volume(){return this._volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this._volume=t,this.emit("update",this._volume)}}var qs=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};xn.skipHello();const pg={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip",gallery:"Gallery",switch:"Switch",prism:"Prism",doors:"Doors"},Ze={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",interactiveSeqStateChange:"interactiveSeqStateChange",interactiveSeqAction:"interactiveSeqAction",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",animateStart:"animateStart",animateEnd:"animateEnd",mediaSeek:"mediaSeek",mediaPlay:"mediaPlay",mediaPause:"mediaPause",mediaStop:"mediaStop",requestNextSlide:"requestNextSlide",requestPrevSlide:"requestPrevSlide",requestGotoSlide:"requestGotoSlide",requestOpenUrl:"requestOpenUrl",userInput:"userInput",fullscreenChange:"fullscreenChange",changeLocalFullscreenState:"changeLocalFullscreenState"};class ar extends yi.a{get view(){return this.app.renderer?this.app.view:null}get nextSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.nextIndex?this.currentStage.json.nextIndex:this.currentIndex+1}get prevSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.prevIndex?this.currentStage.json.prevIndex:this.currentIndex-1}constructor(t,e={}){super(),this.errorChannel=new yi.a,this.transactionPlayer=null,this.isForward=!0,this.drawCall=0,this.scale=1,this._isPaused=!1,this.maxResolution=new De.g(0,0),this.isNVIDIA=!1,this.fps=new Bb,this.designWidth=0,this.designHeight=0,this.currentIndex=0,this.slideCount=0,this.runtime={drawCall:0,fps:0},this.globalEventHub=new yi.a,this.globalVideoBackground=new er,this.globalVideoSprite=new di,this.onMousemoveTimeout=null,this.cacheFunctionMap=new Map,this.isPlayerPaused=()=>this._isPaused,this.onWebGLLost=()=>{this.errorChannel.emit("error",new xi(Vi.CanvasCrash,"webgl context lost."))},this.fullscreenOnMousemove=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!0}),this.onMousemoveTimeout&&clearTimeout(this.onMousemoveTimeout),this.onMousemoveTimeout=setTimeout(()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},ko.hoverHiddeDelay)},this.fullscreenOnMouseleave=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},this.calculateFullscreenVideoPosition=o=>{const{width:s,height:a}=o,{designWidth:l,designHeight:h}=this,u=Math.min(l/s,h/a);return{x:(l-s*u)/2,y:(h-a*u)/2,width:s*u,height:a*u}},this.onRequestFullscreenVideo=o=>{const{texture:s,index:a,targetId:l}=o;if(a!==this.currentIndex)return void s.destroy(!1);this.onRequestCancelFullscreenVideo(),this.globalVideoBackground.width=this.designWidth,this.globalVideoBackground.height=this.designHeight,this.globalVideoBackground.beginFill(0,1),this.globalVideoBackground.drawRect(0,0,this.designWidth,this.designHeight),this.globalVideoBackground.endFill(),this.globalVideoBackground.interactive=!0,this.app.stage.addChild(this.globalVideoBackground);const{x:h,y:u,width:p,height:_}=this.calculateFullscreenVideoPosition(s);this.globalVideoSprite.texture=s,this.globalVideoSprite.width=p,this.globalVideoSprite.height=_,this.globalVideoSprite.position.x=h,this.globalVideoSprite.position.y=u,this.globalVideoBackground.addChild(this.globalVideoSprite),this.globalEventHub.emit("onFullscreenChange",{status:!0,targetId:l,slideIndex:this.currentIndex}),this.clearFullscreenEventListenersWithAppView();const x={handleEvent:()=>{var w;(w=this.currentStage)===null||w===void 0||w.ctx.eventHub.emit(Ze.userInput)}};if(this.app.view.addEventListener("pointerdown",x,!1),this.cacheFunctionMap.set("pointerdown",x),hs.isDesktop()){const w={handleEvent:()=>{this.fullscreenOnMouseleave({index:a,targetId:l})}};this.app.view.addEventListener("mouseout",w,!1);const M={handleEvent:()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:a,targetId:l,status:!0})}};this.app.view.addEventListener("mouseover",M,!1);const C={handleEvent:()=>{this.fullscreenOnMousemove({index:a,targetId:l})}};this.app.view.addEventListener("mousemove",C,!1),this.cacheFunctionMap.set("mouseover",M),this.cacheFunctionMap.set("mousemove",C),this.cacheFunctionMap.set("mouseout",w)}else{const w={handleEvent:()=>{this.fullscreenOnMousemove({index:a,targetId:l})}};this.app.view.addEventListener("touchstart",w,!1),this.cacheFunctionMap.set("touchstart",w)}},this.onRequestCancelFullscreenVideo=(o=!1)=>{var s,a;this.globalVideoSprite.texture.destroy(!1);try{this.globalVideoBackground.removeChild(this.globalVideoSprite)}catch{this.logger.error("removeChild error: PPTPlayer:1057",this.taskId)}try{this.app.stage.removeChild(this.globalVideoBackground)}catch{this.logger.error("removeChild error: PPTPlayer:1062",this.taskId)}this.globalEventHub.emit("onFullscreenChange",{status:!1,slideIndex:this.currentIndex,targetId:(s=this.currentStage)===null||s===void 0?void 0:s.ctx.latestChangeFullscreenTargetId}),this.clearFullscreenEventListenersWithAppView(),o&&this.emit(Ze.changeLocalFullscreenState,{status:!1,slideIndex:this.currentIndex,targetId:(a=this.currentStage)===null||a===void 0?void 0:a.ctx.latestChangeFullscreenTargetId})},this.logger=t.logger,this.tracker=t.tracker,this.mode=t.mode,this.volumeAdjuster=t.volumeAdjuster,this.localStorage=new Or(this.logger),this.cachedExtract=new rc(this.localStorage),this.config={minFPS:Hi()(e.minFPS)?30:e.minFPS,maxFPS:Hi()(e.maxFPS)?40:e.maxFPS,resolution:Hi()(e.resolution)?1:e.resolution,autoFPS:!Hi()(e.autoFPS)&&e.autoFPS,autoResolution:!Hi()(e.autoResolution)&&e.autoResolution,transactionBgColor:Hi()(e.transactionBgColor)?0:e.transactionBgColor,maxResolutionLevel:this.getMaxResolution(e.maxResolutionLevel),forceCanvas:!Hi()(e.forceCanvas)&&e.forceCanvas,enableNvidiaDetect:!Hi()(e.enableNvidiaDetect)&&e.enableNvidiaDetect},this.updateMaxResolutionLevel(this.config.maxResolutionLevel),this.loader=new Ub(this.localStorage,t.useLocalCache,this.logger,this.tracker,t.resourceTimeout,t.loadDelegate,t.urlInterrupter);const n=xn.isWebGLSupported();this.app=new Pl({antialias:!0,autoDensity:!1,backgroundColor:16777215,forceCanvas:this.config.forceCanvas||!n}),globalThis.__PIXI_APP__=this.app,this.tracker({name:"slidePlayerCreate",result:"",reason:"",payload:{webgl:n,resolution:this.config.resolution,minFPS:this.config.minFPS,maxFPS:this.config.maxFPS,maxResolutionLevel:this.config.maxResolutionLevel,forceCanvas:this.config.forceCanvas}}),this.updateConfig(this.config),this.app.ticker.maxFPS=60,this.app.ticker.minFPS=this.config.minFPS,this.app.ticker.maxFPS=this.config.maxFPS,this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const r=this.app.renderer;if(r.gl){const{drawElements:o}=r.gl,s=r.gl.getExtension("WEBGL_debug_renderer_info"),a=r.gl.getParameter(s.UNMASKED_RENDERER_WEBGL);/nvidia/i.test(a)&&this.config.enableNvidiaDetect&&(this.isNVIDIA=!0),r.gl.drawElements=(...l)=>{o.call(r.gl,...l),this.drawCall+=1}}this.fps.on("update",o=>{if(o<this.config.minFPS){if(this.config.autoResolution){const s=.7*this.scale,a=this.app.renderer.resolution,l=Math.max(s,a-.1);l>=s&&this.updateResolution(l)}}else if(o>this.config.maxFPS&&this.config.autoResolution){const s=this.scale*this.config.resolution,a=this.app.renderer.resolution,l=Math.min(s,a+.1);l<=this.config.resolution&&this.updateResolution(l)}}),this.app.ticker.add(()=>{this.runtime.drawCall=this.drawCall,this.runtime.fps=Math.floor(this.app.ticker.minFPS),this.drawCall=0},null,tr.c.LOW),this.clock=new Hb(this.app.ticker),this.objPoolGroup=ss(),this.stagePool=new ew(this.loader,this.mode,this.app.renderer,this.app.ticker,this.app.view,this.clock,this.objPoolGroup,this.errorChannel,this.localStorage,this.logger,t.loadDelegate,t.urlInterrupter,this.isPlayerPaused,this.maxResolution,this.volumeAdjuster,this.config.forceCanvas,this.globalEventHub),this.app.view.addEventListener("webglcontextlost",this.onWebGLLost);try{this.config.forceCanvas||(this.transactionPlayer=new tx)}catch(o){/Error creating WebGL context/.test(o.message)?this.errorChannel.emit("error",new xi(Vi.CanvasCrash,"webgl context lost.")):this.errorChannel.emit("error",new xi(Vi.RuntimeWarn,o.message))}this.globalEventHub.on("requestFullscreen",this.onRequestFullscreenVideo),this.globalEventHub.on("requestCancelFullscreen",this.onRequestCancelFullscreenVideo)}getMaxResolution(t){return!Hi()(t)&&Number.isInteger(t)?(t<1&&(t=1),t>4&&(t=4),t):ar.platform.isAndroid()||ar.platform.isIOS()?2:4}updateMaxResolutionLevel(t){t<0&&(t=0),t>4&&(t=4);const e=[640,960,1280,1920,3200][t],n=[360,540,720,1080,1800][t];this.maxResolution.set(e,n)}updateConfig(t){Hi()(t.maxFPS)||Hi()(t.minFPS)||(this.config.maxFPS=t.maxFPS,this.app.ticker.maxFPS=t.maxFPS,this.config.minFPS=t.minFPS,this.app.ticker.minFPS=t.minFPS),Hi()(t.resolution)||(this.config.resolution=t.resolution,this.updateResolution(this.scale*this.config.resolution)),Hi()(t.autoFPS)||(this.config.autoFPS=t.autoFPS),Hi()(t.autoResolution)||(this.config.autoResolution=t.autoResolution),Hi()(t.transactionBgColor)||(this.config.transactionBgColor=t.transactionBgColor),this.taskId&&this.logger.info("ppt player update config: "+JSON.stringify(this.config),this.taskId),Hi()(t.maxResolutionLevel)||(this.config.maxResolutionLevel=t.maxResolutionLevel,this.updateMaxResolutionLevel(this.config.maxResolutionLevel))}preload(t){return qs(this,void 0,void 0,function*(){t<1||t>this.slideCount||(this.logger.info(`preload slide ${t} begin`,this.taskId),yield this.stagePool.preload(t),this.logger.info(`preload slide ${t} end`,this.taskId))})}setResourceData(t,e){this.logger.info("ppt player init config: "+JSON.stringify(this.config),t),this.logger.info("set resource to "+e,t),this.taskId=t,this.url=e,this.stagePool.setResourceData(t,e),this.localStorage.attachTaskId(t),this.loader.attachTaskId(t)}setInteractive(t){this.app.stage.interactive=t,this.app.stage.interactiveChildren=t}translateEvent(t,e){e.forEach(n=>{t.on(n,(...r)=>{var o,s,a,l;n===Ze.requestGotoSlide&&r[0]!==this.currentIndex&&((s=(o=this.currentStage)===null||o===void 0?void 0:o.timing)===null||s===void 0||s.setMainSeqStep(0,"start"),(l=(a=this.currentStage)===null||a===void 0?void 0:a.timing)===null||l===void 0||l.destroy()),this.emit(n,...r)})})}renderSlide(t){var e,n,r;return qs(this,void 0,void 0,function*(){if(this._isPaused)return void this.logger.info("ppt play prevent render slide with paused state",this.taskId);const o=this.currentIndex,s=Date.now();this.logger.info("render slide "+t,this.taskId),this.emit(Ze.renderStart,t);const a=yield this.stagePool.getStage(t),l=`snapshot-${t}-${this.isForward?"start":"end"}`,h=yield this.localStorage.getItem(l);if(!a)return;a.ctx.isRendering=!0,this.translateEvent(a.ctx.eventHub,[Ze.mainSeqStepChange,Ze.mainSeqStateChange,Ze.hyperlinkTrigger,Ze.interactiveSeqAction,Ze.mainSeqStepStart,Ze.mainSeqStepEnd,Ze.animateStart,Ze.animateEnd,Ze.mediaPlay,Ze.mediaPause,Ze.mediaSeek,Ze.mediaStop,Ze.requestGotoSlide,Ze.requestOpenUrl,Ze.requestNextSlide,Ze.requestPrevSlide,Ze.interactiveSeqStateChange,Ze.userInput,Ze.fullscreenChange,Ze.changeLocalFullscreenState]),this.currentIndex=Number(t);const{width:u,height:p,slideCount:_}=a.json;this.slideCount=_,this.designWidth=u,this.designHeight=p,(e=this.currentStage)===null||e===void 0||e.clearOnSlideChange();const x=this.currentStage;this.currentStage=a,a.initOnReuse(),a.createTiming(),a.container.visible=!0,a.collectMainSeqStartValue(),this.isForward?a.setMainSeqStep(0,"start"):a.setMainSeqStep(-1,"end"),this.onRequestCancelFullscreenVideo(!0);let w=!1;if(xn.isWebGLSupported()&&!this.config.forceCanvas&&a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&x){let{transition:M}=a.json;!this.isForward&&(x==null?void 0:x.json.transition)&&(M=x.json.transition);const C=this.getTransactionTexture(x,this.view,null,null);this.initTransactionPlayer(M),(n=this.transactionPlayer)===null||n===void 0||n.setPrevTexture(C),w=!0}if(this.app.stage.addChild(a.container),this.updateResolution(this.config.resolution*this.scale),x){x.clearOnTransactionEnd();try{this.app.stage.removeChild(x.container)}catch{this.logger.error("removeChild error: PPTPlayer:622",this.taskId)}}if(a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&this.transactionPlayer&&w){const M=yield this.getTransactionTexture(a,this.view,l,h);this.transactionPlayer.setNextTexture(M),yield this.transactionPlayer.play();const C=this.transactionPlayer.renderer.domElement;if(this.view.parentElement&&C)try{this.view.parentElement.removeChild(C)}catch{this.logger.error("removeChild error: PPTPlayer:637",this.taskId)}(r=this.transactionPlayer)===null||r===void 0||r.dispose()}this.isForward?yield a.startTiming():a.setMainSeqApplied(),a.ctx.slideScopeEventHub.emit("slide-render",a.ctx.slideIndex,this.isForward),this.emit(Ze.renderEnd,t),this.emit(Ze.slideChange,t),a.ctx.isRendering=!1,this.preload(t+1).catch(M=>{this.errorChannel.emit("error",xi.transform(M),t+1)}),this.preload(t-1).catch(M=>{this.errorChannel.emit("error",xi.transform(M),t-1)}),this.logger.info(`render slide ${t} done, time: ${Date.now()-s}ms`,this.taskId),this.tracker({name:"slidePageChange",reason:"",result:"",payload:{duration:Date.now()-s,from:o,to:t}})})}getTransactionTexture(t,e,n,r){const o=ce.p.create({width:t.json.width,height:t.json.height,resolution:1});this.app.renderer.render(t.container,{renderTexture:o});const s=this.cachedExtract.canvas(o,this.app.renderer,r,n);return new $(s)}renderToBase64(t,e,n){return qs(this,void 0,void 0,function*(){const r=yield this.stagePool.getStage(t);if(r){const{width:o,height:s}=r.json;this.designWidth=o,this.designHeight=s;const a=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:e});r.container.visible=!0,this.app.renderer.render(r.container,{renderTexture:a});const l=this.app.renderer.plugins.extract.base64(a,n);return this.stagePool.destroyStageByIndex(t),l}return"__null__"})}renderMainSeqToBase64(t,e,n){return qs(this,void 0,void 0,function*(){const r=[],o=yield this.stagePool.getStage(t);if(o.createTiming(),o){const{width:s,height:a}=o.json;this.designWidth=s,this.designHeight=a;const l=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:e});o.container.visible=!0;const h=o.mainSeqLength();o.setMainSeqStep(0,"start"),this.app.renderer.render(o.container,{renderTexture:l});const u=this.app.renderer.plugins.extract.base64(l,n);r.push(u);for(let p=0;p<h;p+=1){o.setMainSeqStep(p,"end"),this.app.renderer.render(o.container,{renderTexture:l});const _=this.app.renderer.plugins.extract.base64(l,n);r.push(_)}}return r})}snapshotWithTimingEnd(t){return qs(this,void 0,void 0,function*(){const e=yield this.stagePool.getStage(t);if(e){const{width:n,height:r}=e.json;this.designWidth=n,this.designHeight=r;const o=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:1});e.container.visible=!0,e.initOnReuse(),e.createTiming(),e.collectMainSeqStartValue(),e.setMainSeqStep(-1,"end"),this.app.renderer.render(e.container,{renderTexture:o});const s=this.app.renderer.plugins.extract.base64(o,"image/png");return t!==this.currentIndex&&this.stagePool.destroyStageByIndex(t),s}return null})}getBase64(t){if(!t.container.transform)return null;const e=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:1});this.app.renderer.render(t.container,{renderTexture:e});const n=this.app.renderer.plugins.extract.base64(e,"image/jpeg");return e.destroy(!0),n}initTransactionPlayer(t){var e,n,r,o,s;const a=(e=this.view)===null||e===void 0?void 0:e.parentElement;if(this.view&&a&&pg[t.type]&&this.transactionPlayer){const l=(n=this.transactionPlayer)===null||n===void 0?void 0:n.renderer.domElement;this.transactionPlayer.initPlayer({reverse:!this.isForward,stageWidth:this.view.width,stageHeight:this.view.height,presetType:pg[t.type],duration:(o=(r=this.currentStage)===null||r===void 0?void 0:r.json.transition)===null||o===void 0?void 0:o.dur,delay:0,clearColor:this.config.transactionBgColor,maxFPS:Math.ceil((s=this.config.maxFPS)!==null&&s!==void 0?s:60),options:t.options}),l&&(l.style.position="absolute",l.style.zIndex="9",l.style.left="0",l.style.top="0",l.style.width=this.view.style.width,l.style.height=this.view.style.height),a.appendChild(l)}}scaleView(t,e,n){var r;this.view&&(this.view.style.width=Math.floor(this.designWidth*t)+"px",this.view.style.height=Math.floor(this.designHeight*t)+"px");const o=(r=this.transactionPlayer)===null||r===void 0?void 0:r.renderer.domElement;if(o&&this.view&&(o.style.width=this.view.style.width,o.style.height=this.view.style.height),e){this.scale=t;const s=this.scale*this.config.resolution;this.updateResolution(s,n)}}updateResolution(t,e){this.app.ticker.addOnce(()=>{let n=hs.isDesktop()?t:1;for(;n*this.designWidth>this.maxResolution.x||n*this.designHeight>this.maxResolution.y;)n-=.1;this.app.renderer.resolution=n,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.designWidth,this.designHeight),I_()(e)&&e()})}nextStep(t,e){var n;if(this._isPaused)this.logger.info("ppt play prevent next step with paused state",this.taskId);else{this.logger.info("ppt play trigger next step",this.taskId);try{this.onRequestCancelFullscreenVideo(!0),(n=this.currentStage)===null||n===void 0||n.nextStep(t,e)}catch(r){this.errorChannel.emit("error",xi.transform(r),this.currentIndex)}}}prevStep(t=!1){var e;if(this._isPaused)this.logger.info("ppt play prevent prev step with paused state",this.taskId);else{this.logger.info("ppt play trigger prev step",this.taskId);try{this.onRequestCancelFullscreenVideo(!0),(e=this.currentStage)===null||e===void 0||e.prevStep(t)}catch(n){this.errorChannel.emit("error",xi.transform(n),this.currentIndex)}}}mainSeqLength(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqLength())!==null&&e!==void 0?e:0}mainSeqStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqStep())!==null&&e!==void 0?e:0}setMainSeqStep(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMainSeqStep(t,e)}mainSeqState(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqState())!==null&&e!==void 0?e:null}mainSeqHasNextStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}nextTick(t){this.app.ticker.addOnce(()=>{t()},tr.c.LOW)}applyInteractiveAction(t){var e;(e=this.currentStage)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.currentStage)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.currentStage)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){var r;return qs(this,void 0,void 0,function*(){yield(r=this.currentStage)===null||r===void 0?void 0:r.setMediaState(t,e,n)})}setMediaCurrentTime(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMediaCurrentTime(t,e)}pause(){var t;this.app.ticker.stop(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalPause()}),this._isPaused=!0}resume(){var t;this._isPaused=!1,this.app.ticker.start(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalResume()})}getSnapshot(){return this.currentStage&&this.getBase64(this.currentStage)||""}clearLocalCache(){this.localStorage.dispose()}static clearLocalCache(){var t;(t=Or.localCache)===null||t===void 0||t.clear().catch(()=>{})}clearFullscreenEventListenersWithAppView(){["mousemove","mouseout","mouseover","touchstart","pointerdown"].forEach(t=>{this.cacheFunctionMap.has(t)&&(this.app.view.removeEventListener(t,this.cacheFunctionMap.get(t),!1),this.cacheFunctionMap.delete(t))})}syncFullscreenVideoState(t){this.globalEventHub.emit("syncFullscreenVideoState",t)}destroy(){var t;try{this.app.view.removeEventListener("webglcontextlost",this.onWebGLLost),this.app.renderer.filter.texturePool.clear(!0),zu.collectObjectByGroup(this.objPoolGroup),Vu.collectObjectByGroup(this.objPoolGroup),(t=this.transactionPlayer)===null||t===void 0||t.destroy(),this.loader.destroy(),this.fps.destroy(),this.stagePool.destroyAllStage(),this.stagePool.destroy(),this.app.renderer.gl.getExtension("WEBGL_lose_context").loseContext(),this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.tracker({name:"slidePlayerDestroy",result:"",reason:"",payload:{}})}catch{}}}ar.platform=hs,ar.RtcAudioClazz=null;var oc=new Map,Ba,iw=v(136),rw=v.n(iw),ow=v(24),hh=v.n(ow),sw=v(50),fg=v.n(sw),us=[],mg="ResizeObserver loop completed with undelivered notifications.";(function(i){i.BORDER_BOX="border-box",i.CONTENT_BOX="content-box",i.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Ba||(Ba={}));var sc,cs=function(i){return Object.freeze(i)},aw=function(i,t){this.inlineSize=i,this.blockSize=t,cs(this)},gg=function(){function i(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,cs(this)}return i.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},i.fromRect=function(t){return new i(t.x,t.y,t.width,t.height)},i}(),ac=function(i){return i instanceof SVGElement&&"getBBox"in i},vg=function(i){if(ac(i)){var t=i.getBBox(),e=t.width,n=t.height;return!e&&!n}var r=i,o=r.offsetWidth,s=r.offsetHeight;return!(o||s||i.getClientRects().length)},_g=function(i){var t;if(i instanceof Element)return!0;var e=(t=i==null?void 0:i.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(e&&i instanceof e.Element)},ka=typeof window!="undefined"?window:{},uh=new WeakMap,yg=/auto|scroll/,lw=/^tb|vertical/,hw=/msie|trident/i.test(ka.navigator&&ka.navigator.userAgent),Qr=function(i){return parseFloat(i||"0")},Js=function(i,t,e){return i===void 0&&(i=0),t===void 0&&(t=0),e===void 0&&(e=!1),new aw((e?t:i)||0,(e?i:t)||0)},xg=cs({devicePixelContentBoxSize:Js(),borderBoxSize:Js(),contentBoxSize:Js(),contentRect:new gg(0,0,0,0)}),bg=function(i,t){if(t===void 0&&(t=!1),uh.has(i)&&!t)return uh.get(i);if(vg(i))return uh.set(i,xg),xg;var e=getComputedStyle(i),n=ac(i)&&i.ownerSVGElement&&i.getBBox(),r=!hw&&e.boxSizing==="border-box",o=lw.test(e.writingMode||""),s=!n&&yg.test(e.overflowY||""),a=!n&&yg.test(e.overflowX||""),l=n?0:Qr(e.paddingTop),h=n?0:Qr(e.paddingRight),u=n?0:Qr(e.paddingBottom),p=n?0:Qr(e.paddingLeft),_=n?0:Qr(e.borderTopWidth),x=n?0:Qr(e.borderRightWidth),w=n?0:Qr(e.borderBottomWidth),M=p+h,C=l+u,G=(n?0:Qr(e.borderLeftWidth))+x,Q=_+w,nt=a?i.offsetHeight-Q-i.clientHeight:0,ct=s?i.offsetWidth-G-i.clientWidth:0,it=r?M+G:0,mt=r?C+Q:0,lt=n?n.width:Qr(e.width)-it-ct,gt=n?n.height:Qr(e.height)-mt-nt,Ut=lt+M+ct+G,Ft=gt+C+nt+Q,Mt=cs({devicePixelContentBoxSize:Js(Math.round(lt*devicePixelRatio),Math.round(gt*devicePixelRatio),o),borderBoxSize:Js(Ut,Ft,o),contentBoxSize:Js(lt,gt,o),contentRect:new gg(p,l,lt,gt)});return uh.set(i,Mt),Mt},Tg=function(i,t,e){var n=bg(i,e),r=n.borderBoxSize,o=n.contentBoxSize,s=n.devicePixelContentBoxSize;switch(t){case Ba.DEVICE_PIXEL_CONTENT_BOX:return s;case Ba.BORDER_BOX:return r;default:return o}},uw=function(i){var t=bg(i);this.target=i,this.contentRect=t.contentRect,this.borderBoxSize=cs([t.borderBoxSize]),this.contentBoxSize=cs([t.contentBoxSize]),this.devicePixelContentBoxSize=cs([t.devicePixelContentBoxSize])},wg=function(i){if(vg(i))return 1/0;for(var t=0,e=i.parentNode;e;)t+=1,e=e.parentNode;return t},cw=function(){var i=1/0,t=[];us.forEach(function(r){if(r.activeTargets.length!==0){var o=[];r.activeTargets.forEach(function(s){var a=new uw(s.target),l=wg(s.target);o.push(a),s.lastReportedSize=Tg(s.target,s.observedBox),l<i&&(i=l)}),t.push(function(){r.callback.call(r.observer,o,r.observer)}),r.activeTargets.splice(0,r.activeTargets.length)}});for(var e=0,n=t;e<n.length;e++)(0,n[e])();return i},Eg=function(i){us.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(e){e.isActive()&&(wg(e.target)>i?t.activeTargets.push(e):t.skippedTargets.push(e))})})},dw=function(){var i,t=0;for(Eg(t);us.some(function(e){return e.activeTargets.length>0});)t=cw(),Eg(t);return us.some(function(e){return e.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?i=new ErrorEvent("error",{message:mg}):((i=document.createEvent("Event")).initEvent("error",!1,!1),i.message=mg),window.dispatchEvent(i)),t>0},Sg=[],pw=function(i){if(!sc){var t=0,e=document.createTextNode("");new MutationObserver(function(){return Sg.splice(0).forEach(function(n){return n()})}).observe(e,{characterData:!0}),sc=function(){e.textContent="".concat(t?t--:t++)}}Sg.push(i),sc()},lc=0,fw={attributes:!0,characterData:!0,childList:!0,subtree:!0},Ag=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Mg=function(i){return i===void 0&&(i=0),Date.now()+i},hc=!1,uc=new(function(){function i(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return i.prototype.run=function(t){var e=this;if(t===void 0&&(t=250),!hc){hc=!0;var n,r=Mg(t);n=function(){var o=!1;try{o=dw()}finally{if(hc=!1,t=r-Mg(),!lc)return;o?e.run(1e3):t>0?e.run(t):e.start()}},pw(function(){requestAnimationFrame(n)})}},i.prototype.schedule=function(){this.stop(),this.run()},i.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,fw)};document.body?e():ka.addEventListener("DOMContentLoaded",e)},i.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Ag.forEach(function(e){return ka.addEventListener(e,t.listener,!0)}))},i.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),Ag.forEach(function(e){return ka.removeEventListener(e,t.listener,!0)}),this.stopped=!0)},i}()),Cg=function(i){!lc&&i>0&&uc.start(),!(lc+=i)&&uc.stop()},mw=function(){function i(t,e){this.target=t,this.observedBox=e||Ba.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return i.prototype.isActive=function(){var t,e=Tg(this.target,this.observedBox,!0);return t=this.target,ac(t)||function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(t)||getComputedStyle(t).display!=="inline"||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},i}(),gw=function(i,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=i,this.callback=t},ch=new WeakMap,Rg=function(i,t){for(var e=0;e<i.length;e+=1)if(i[e].target===t)return e;return-1},dh=function(){function i(){}return i.connect=function(t,e){var n=new gw(t,e);ch.set(t,n)},i.observe=function(t,e,n){var r=ch.get(t),o=r.observationTargets.length===0;Rg(r.observationTargets,e)<0&&(o&&us.push(r),r.observationTargets.push(new mw(e,n&&n.box)),Cg(1),uc.schedule())},i.unobserve=function(t,e){var n=ch.get(t),r=Rg(n.observationTargets,e),o=n.observationTargets.length===1;r>=0&&(o&&us.splice(us.indexOf(n),1),n.observationTargets.splice(r,1),Cg(-1))},i.disconnect=function(t){var e=this,n=ch.get(t);n.observationTargets.slice().forEach(function(r){return e.unobserve(t,r.target)}),n.activeTargets.splice(0,n.activeTargets.length)},i}(),vw=function(){function i(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");dh.connect(this,t)}return i.prototype.observe=function(t,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_g(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");dh.observe(this,t,e)},i.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_g(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");dh.unobserve(this,t)},i.prototype.disconnect=function(){dh.disconnect(this)},i.toString=function(){return"function ResizeObserver () { [polyfill code] }"},i}(),_w=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},yw=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},xw=function(){function i(t,e,n,r,o){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=n,this.index=t,this.slideIndex=e,this.eventHub=r,this.id=o}return i.prototype.apply=function(){return _w(this,void 0,void 0,function(){var t;return yw(this,function(e){switch(e.label){case 0:this.eventHub.emit("task-start",this),e.label=1;case 1:return e.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return e.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return t=e.sent(),this.eventHub.emit("task-error",{task:this,error:t}),[3,4];case 4:return[2]}})})},i}(),bw=function(){function i(){var t=this;this.eventHub=new yi.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(e){var n,r=t.tasks.findIndex(function(s){return s.index===e.index}),o=r+1;o>=0&&((n=t.tasks[o])===null||n===void 0||n.apply()),r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask()),t.eventHub.emit("task-end-"+e.id)}),this.eventHub.on("task-error",function(e){var n=e.task,r=t.tasks.findIndex(function(o){return o.index===n.index});r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask())})}return i.prototype.replaceIdleTask=function(){for(var t,e=this,n=new Set,r=0,o=this.tasks.length;r<o;r++)this.tasks[r].state==="idle"&&((t=this.tasks[r+1])===null||t===void 0?void 0:t.state)==="idle"&&n.add(r);Array.from(n).forEach(function(s){e.tasks.splice(s,1)})},i.prototype.addTask=function(t,e,n){var r=new xw(this.index++,e,t,this.eventHub,n);this.tasks.push(r),this.tasks.sort(function(o,s){return o.index-s.index}),this.replaceIdleTask(),this.tasks.length===1&&r.apply()},i.prototype.hasStartTask=function(){return this.tasks.some(function(t){return t.state==="start"})},i.prototype.destroy=function(){this.eventHub.removeAllListeners()},i}();function Zs(i,t){var e=i.__state.conversionName.toString(),n=Math.round(i.r),r=Math.round(i.g),o=Math.round(i.b),s=i.a,a=Math.round(i.h),l=i.s.toFixed(1),h=i.v.toFixed(1);if(t||e==="THREE_CHAR_HEX"||e==="SIX_CHAR_HEX"){for(var u=i.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return e==="CSS_RGB"?"rgb("+n+","+r+","+o+")":e==="CSS_RGBA"?"rgba("+n+","+r+","+o+","+s+")":e==="HEX"?"0x"+i.hex.toString(16):e==="RGB_ARRAY"?"["+n+","+r+","+o+"]":e==="RGBA_ARRAY"?"["+n+","+r+","+o+","+s+"]":e==="RGB_OBJ"?"{r:"+n+",g:"+r+",b:"+o+"}":e==="RGBA_OBJ"?"{r:"+n+",g:"+r+",b:"+o+",a:"+s+"}":e==="HSV_OBJ"?"{h:"+a+",s:"+l+",v:"+h+"}":e==="HSVA_OBJ"?"{h:"+a+",s:"+l+",v:"+h+",a:"+s+"}":"unknown format"}var Ig=Array.prototype.forEach,Ua=Array.prototype.slice,Ne={BREAK:{},extend:function(i){return this.each(Ua.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(i[e]=t[e])}.bind(this))},this),i},defaults:function(i){return this.each(Ua.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(i[e])&&(i[e]=t[e])}.bind(this))},this),i},compose:function(){var i=Ua.call(arguments);return function(){for(var t=Ua.call(arguments),e=i.length-1;e>=0;e--)t=[i[e].apply(this,t)];return t[0]}},each:function(i,t,e){if(i){if(Ig&&i.forEach&&i.forEach===Ig)i.forEach(t,e);else if(i.length===i.length+0){var n,r=void 0;for(r=0,n=i.length;r<n;r++)if(r in i&&t.call(e,i[r],r)===this.BREAK)return}else for(var o in i)if(t.call(e,i[o],o)===this.BREAK)return}},defer:function(i){setTimeout(i,0)},debounce:function(i,t,e){var n=void 0;return function(){var r=this,o=arguments;function s(){n=null,e||i.apply(r,o)}var a=e||!n;clearTimeout(n),n=setTimeout(s,t),a&&i.apply(r,o)}},toArray:function(i){return i.toArray?i.toArray():Ua.call(i)},isUndefined:function(i){return i===void 0},isNull:function(i){return i===null},isNaN:function(i){function t(e){return i.apply(this,arguments)}return t.toString=function(){return i.toString()},t}(function(i){return isNaN(i)}),isArray:Array.isArray||function(i){return i.constructor===Array},isObject:function(i){return i===Object(i)},isNumber:function(i){return i===i+0},isString:function(i){return i===i+""},isBoolean:function(i){return i===!1||i===!0},isFunction:function(i){return i instanceof Function}},Tw=[{litmus:Ne.isString,conversions:{THREE_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Zs},SIX_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9]{6})$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Zs},CSS_RGB:{read:function(i){var t=i.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Zs},CSS_RGBA:{read:function(i){var t=i.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Zs}}},{litmus:Ne.isNumber,conversions:{HEX:{read:function(i){return{space:"HEX",hex:i,conversionName:"HEX"}},write:function(i){return i.hex}}}},{litmus:Ne.isArray,conversions:{RGB_ARRAY:{read:function(i){return i.length===3&&{space:"RGB",r:i[0],g:i[1],b:i[2]}},write:function(i){return[i.r,i.g,i.b]}},RGBA_ARRAY:{read:function(i){return i.length===4&&{space:"RGB",r:i[0],g:i[1],b:i[2],a:i[3]}},write:function(i){return[i.r,i.g,i.b,i.a]}}}},{litmus:Ne.isObject,conversions:{RGBA_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b)&&Ne.isNumber(i.a))&&{space:"RGB",r:i.r,g:i.g,b:i.b,a:i.a}},write:function(i){return{r:i.r,g:i.g,b:i.b,a:i.a}}},RGB_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b))&&{space:"RGB",r:i.r,g:i.g,b:i.b}},write:function(i){return{r:i.r,g:i.g,b:i.b}}},HSVA_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v)&&Ne.isNumber(i.a))&&{space:"HSV",h:i.h,s:i.s,v:i.v,a:i.a}},write:function(i){return{h:i.h,s:i.s,v:i.v,a:i.a}}},HSV_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v))&&{space:"HSV",h:i.h,s:i.s,v:i.v}},write:function(i){return{h:i.h,s:i.s,v:i.v}}}}}],Ga=void 0,ph=void 0,cc=function(){ph=!1;var i=arguments.length>1?Ne.toArray(arguments):arguments[0];return Ne.each(Tw,function(t){if(t.litmus(i))return Ne.each(t.conversions,function(e,n){if(Ga=e.read(i),ph===!1&&Ga!==!1)return ph=Ga,Ga.conversionName=n,Ga.conversion=e,Ne.BREAK}),Ne.BREAK}),ph},Pg=void 0,fh={hsv_to_rgb:function(i,t,e){var n=Math.floor(i/60)%6,r=i/60-Math.floor(i/60),o=e*(1-t),s=e*(1-r*t),a=e*(1-(1-r)*t),l=[[e,a,o],[s,e,o],[o,e,a],[o,s,e],[a,o,e],[e,o,s]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(i,t,e){var n=Math.min(i,t,e),r=Math.max(i,t,e),o=r-n,s=void 0;return r===0?{h:NaN,s:0,v:0}:(s=i===r?(t-e)/o:t===r?2+(e-i)/o:4+(i-t)/o,(s/=6)<0&&(s+=1),{h:360*s,s:o/r,v:r/255})},rgb_to_hex:function(i,t,e){var n=this.hex_with_component(0,2,i);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,e)},component_from_hex:function(i,t){return i>>8*t&255},hex_with_component:function(i,t,e){return e<<(Pg=8*t)|i&~(255<<Pg)}},ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},jr=function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")},zr=function(){function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),Go=function i(t,e,n){t===null&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(r===void 0){var o=Object.getPrototypeOf(t);return o===null?void 0:i(o,e,n)}if("value"in r)return r.value;var s=r.get;return s!==void 0?s.call(n):void 0},Ho=function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(i,t):i.__proto__=t)},jo=function(i,t){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?i:t},Wi=function(){function i(){if(jr(this,i),this.__state=cc.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return zr(i,[{key:"toString",value:function(){return Zs(this)}},{key:"toHexString",value:function(){return Zs(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),i}();function dc(i,t,e){Object.defineProperty(i,t,{get:function(){return this.__state.space==="RGB"||Wi.recalculateRGB(this,t,e),this.__state[t]},set:function(n){this.__state.space!=="RGB"&&(Wi.recalculateRGB(this,t,e),this.__state.space="RGB"),this.__state[t]=n}})}function pc(i,t){Object.defineProperty(i,t,{get:function(){return this.__state.space==="HSV"||Wi.recalculateHSV(this),this.__state[t]},set:function(e){this.__state.space!=="HSV"&&(Wi.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}Wi.recalculateRGB=function(i,t,e){if(i.__state.space==="HEX")i.__state[t]=fh.component_from_hex(i.__state.hex,e);else{if(i.__state.space!=="HSV")throw new Error("Corrupted color state");Ne.extend(i.__state,fh.hsv_to_rgb(i.__state.h,i.__state.s,i.__state.v))}},Wi.recalculateHSV=function(i){var t=fh.rgb_to_hsv(i.r,i.g,i.b);Ne.extend(i.__state,{s:t.s,v:t.v}),Ne.isNaN(t.h)?Ne.isUndefined(i.__state.h)&&(i.__state.h=0):i.__state.h=t.h},Wi.COMPONENTS=["r","g","b","h","s","v","hex","a"],dc(Wi.prototype,"r",2),dc(Wi.prototype,"g",1),dc(Wi.prototype,"b",0),pc(Wi.prototype,"h"),pc(Wi.prototype,"s"),pc(Wi.prototype,"v"),Object.defineProperty(Wi.prototype,"a",{get:function(){return this.__state.a},set:function(i){this.__state.a=i}}),Object.defineProperty(Wi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=fh.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(i){this.__state.space="HEX",this.__state.hex=i}});var ds=function(){function i(t,e){jr(this,i),this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0}return zr(i,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),i}(),Og={};Ne.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(i,t){Ne.each(i,function(e){Og[e]=t})});var Ew=/(\d+(\.\d+)?)px/;function $r(i){if(i==="0"||Ne.isUndefined(i))return 0;var t=i.match(Ew);return Ne.isNull(t)?0:parseFloat(t[1])}var de={makeSelectable:function(i,t){i!==void 0&&i.style!==void 0&&(i.onselectstart=t?function(){return!1}:function(){},i.style.MozUserSelect=t?"auto":"none",i.style.KhtmlUserSelect=t?"auto":"none",i.unselectable=t?"on":"off")},makeFullscreen:function(i,t,e){var n=e,r=t;Ne.isUndefined(r)&&(r=!0),Ne.isUndefined(n)&&(n=!0),i.style.position="absolute",r&&(i.style.left=0,i.style.right=0),n&&(i.style.top=0,i.style.bottom=0)},fakeEvent:function(i,t,e,n){var r=e||{},o=Og[t];if(!o)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var a=r.x||r.clientX||0,l=r.y||r.clientY||0;s.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,a,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var h=s.initKeyboardEvent||s.initKeyEvent;Ne.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),h(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(t,r.bubbles||!1,r.cancelable||!0)}Ne.defaults(s,n),i.dispatchEvent(s)},bind:function(i,t,e,n){var r=n||!1;return i.addEventListener?i.addEventListener(t,e,r):i.attachEvent&&i.attachEvent("on"+t,e),de},unbind:function(i,t,e,n){var r=n||!1;return i.removeEventListener?i.removeEventListener(t,e,r):i.detachEvent&&i.detachEvent("on"+t,e),de},addClass:function(i,t){if(i.className===void 0)i.className=t;else if(i.className!==t){var e=i.className.split(/ +/);e.indexOf(t)===-1&&(e.push(t),i.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return de},removeClass:function(i,t){if(t)if(i.className===t)i.removeAttribute("class");else{var e=i.className.split(/ +/),n=e.indexOf(t);n!==-1&&(e.splice(n,1),i.className=e.join(" "))}else i.className=void 0;return de},hasClass:function(i,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(i.className)||!1},getWidth:function(i){var t=getComputedStyle(i);return $r(t["border-left-width"])+$r(t["border-right-width"])+$r(t["padding-left"])+$r(t["padding-right"])+$r(t.width)},getHeight:function(i){var t=getComputedStyle(i);return $r(t["border-top-width"])+$r(t["border-bottom-width"])+$r(t["padding-top"])+$r(t["padding-bottom"])+$r(t.height)},getOffset:function(i){var t=i,e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;while(t);return e},isActive:function(i){return i===document.activeElement&&(i.type||i.href)}},Ng=function(i){function t(e,n){jr(this,t);var r=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),de.bind(r.__checkbox,"change",function(){o.setValue(!o.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return Ho(t,i),zr(t,[{key:"setValue",value:function(e){var n=Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ds),Sw=function(i){function t(e,n,r){jr(this,t);var o=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r,a=o;if(o.__select=document.createElement("select"),Ne.isArray(s)){var l={};Ne.each(s,function(h){l[h]=h}),s=l}return Ne.each(s,function(h,u){var p=document.createElement("option");p.innerHTML=u,p.setAttribute("value",h),a.__select.appendChild(p)}),o.updateDisplay(),de.bind(o.__select,"change",function(){var h=this.options[this.selectedIndex].value;a.setValue(h)}),o.domElement.appendChild(o.__select),o}return Ho(t,i),zr(t,[{key:"setValue",value:function(e){var n=Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return de.isActive(this.__select)?this:(this.__select.value=this.getValue(),Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(ds),Aw=function(i){function t(e,n){jr(this,t);var r=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;function s(){o.setValue(o.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),de.bind(r.__input,"keyup",s),de.bind(r.__input,"change",s),de.bind(r.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),de.bind(r.__input,"keydown",function(a){a.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Ho(t,i),zr(t,[{key:"updateDisplay",value:function(){return de.isActive(this.__input)||(this.__input.value=this.getValue()),Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ds);function Lg(i){var t=i.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var Dg=function(i){function t(e,n,r){jr(this,t);var o=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r||{};return o.__min=s.min,o.__max=s.max,o.__step=s.step,Ne.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Lg(o.__impliedStep),o}return Ho(t,i),zr(t,[{key:"setValue",value:function(e){var n=e;return this.__min!==void 0&&n<this.__min?n=this.__min:this.__max!==void 0&&n>this.__max&&(n=this.__max),this.__step!==void 0&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Lg(e),this}}]),t}(ds),mh=function(i){function t(e,n,r){jr(this,t);var o=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));o.__truncationSuspended=!1;var s=o,a=void 0;function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function h(p){var _=a-p.clientY;s.setValue(s.getValue()+_*s.__impliedStep),a=p.clientY}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),de.bind(o.__input,"change",function(){var p=parseFloat(s.__input.value);Ne.isNaN(p)||s.setValue(p)}),de.bind(o.__input,"blur",function(){l()}),de.bind(o.__input,"mousedown",function(p){de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),a=p.clientY}),de.bind(o.__input,"keydown",function(p){p.keyCode===13&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,l())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return Ho(t,i),zr(t,[{key:"updateDisplay",value:function(){var e,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(e*r)/r),Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Dg);function Fg(i,t,e,n,r){return n+(i-t)/(e-t)*(r-n)}var fc=function(i){function t(e,n,r,o,s){jr(this,t);var a=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:r,max:o,step:s})),l=a;function h(x){x.preventDefault();var w=l.__background.getBoundingClientRect();return l.setValue(Fg(x.clientX,w.left,w.right,l.__min,l.__max)),!1}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function p(x){var w=x.touches[0].clientX,M=l.__background.getBoundingClientRect();l.setValue(Fg(w,M.left,M.right,l.__min,l.__max))}function _(){de.unbind(window,"touchmove",p),de.unbind(window,"touchend",_),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),de.bind(a.__background,"mousedown",function(x){document.activeElement.blur(),de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),h(x)}),de.bind(a.__background,"touchstart",function(x){x.touches.length===1&&(de.bind(window,"touchmove",p),de.bind(window,"touchend",_),p(x))}),de.addClass(a.__background,"slider"),de.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Ho(t,i),zr(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",Go(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Dg),Bg=function(i){function t(e,n,r){jr(this,t);var o=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o;return o.__button=document.createElement("div"),o.__button.innerHTML=r===void 0?"Fire":r,de.bind(o.__button,"click",function(a){return a.preventDefault(),s.fire(),!1}),de.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return Ho(t,i),zr(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(ds),mc=function(i){function t(e,n){jr(this,t);var r=jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.__color=new Wi(r.getValue()),r.__temp=new Wi(0);var o=r;r.domElement=document.createElement("div"),de.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",de.bind(r.__input,"keydown",function(C){C.keyCode===13&&_.call(this)}),de.bind(r.__input,"blur",_),de.bind(r.__selector,"mousedown",function(){de.addClass(this,"drag").bind(window,"mouseup",function(){de.removeClass(o.__selector,"drag")})}),de.bind(r.__selector,"touchstart",function(){de.addClass(this,"drag").bind(window,"touchend",function(){de.removeClass(o.__selector,"drag")})});var s,a=document.createElement("div");function l(C){w(C),de.bind(window,"mousemove",w),de.bind(window,"touchmove",w),de.bind(window,"mouseup",u),de.bind(window,"touchend",u)}function h(C){M(C),de.bind(window,"mousemove",M),de.bind(window,"touchmove",M),de.bind(window,"mouseup",p),de.bind(window,"touchend",p)}function u(){de.unbind(window,"mousemove",w),de.unbind(window,"touchmove",w),de.unbind(window,"mouseup",u),de.unbind(window,"touchend",u),x()}function p(){de.unbind(window,"mousemove",M),de.unbind(window,"touchmove",M),de.unbind(window,"mouseup",p),de.unbind(window,"touchend",p),x()}function _(){var C=cc(this.value);C!==!1?(o.__color.__state=C,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function x(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function w(C){C.type.indexOf("touch")===-1&&C.preventDefault();var G=o.__saturation_field.getBoundingClientRect(),Q=C.touches&&C.touches[0]||C,nt=Q.clientX,ct=Q.clientY,it=(nt-G.left)/(G.right-G.left),mt=1-(ct-G.top)/(G.bottom-G.top);return mt>1?mt=1:mt<0&&(mt=0),it>1?it=1:it<0&&(it=0),o.__color.v=mt,o.__color.s=it,o.setValue(o.__color.toOriginal()),!1}function M(C){C.type.indexOf("touch")===-1&&C.preventDefault();var G=o.__hue_field.getBoundingClientRect(),Q=1-((C.touches&&C.touches[0]||C).clientY-G.top)/(G.bottom-G.top);return Q>1?Q=1:Q<0&&(Q=0),o.__color.h=360*Q,o.setValue(o.__color.toOriginal()),!1}return Ne.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Ne.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Ne.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Ne.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Ne.extend(a.style,{width:"100%",height:"100%",background:"none"}),kg(a,"top","rgba(0,0,0,0)","#000"),Ne.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(s=r.__hue_field).style.background="",s.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",s.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Ne.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),de.bind(r.__saturation_field,"mousedown",l),de.bind(r.__saturation_field,"touchstart",l),de.bind(r.__field_knob,"mousedown",l),de.bind(r.__field_knob,"touchstart",l),de.bind(r.__hue_field,"mousedown",h),de.bind(r.__hue_field,"touchstart",h),r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return Ho(t,i),zr(t,[{key:"updateDisplay",value:function(){var e=cc(this.getValue());if(e!==!1){var n=!1;Ne.each(Wi.COMPONENTS,function(s){if(!Ne.isUndefined(e[s])&&!Ne.isUndefined(this.__color.__state[s])&&e[s]!==this.__color.__state[s])return n=!0,{}},this),n&&Ne.extend(this.__color.__state,e)}Ne.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,o=255-r;Ne.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,kg(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Ne.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(ds),Mw=["-moz-","-o-","-webkit-","-ms-",""];function kg(i,t,e,n){i.style.background="",Ne.each(Mw,function(r){i.style.cssText+="background: "+r+"linear-gradient("+t+", "+e+" 0%, "+n+" 100%); "})}var Cw=function(i,t){var e=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=i;var r=e.getElementsByTagName("head")[0];try{r.appendChild(n)}catch{}},Rw=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Iw=function(i,t){var e=i[t];return Ne.isArray(arguments[2])||Ne.isObject(arguments[2])?new Sw(i,t,arguments[2]):Ne.isNumber(e)?Ne.isNumber(arguments[2])&&Ne.isNumber(arguments[3])?Ne.isNumber(arguments[4])?new fc(i,t,arguments[2],arguments[3],arguments[4]):new fc(i,t,arguments[2],arguments[3]):Ne.isNumber(arguments[4])?new mh(i,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new mh(i,t,{min:arguments[2],max:arguments[3]}):Ne.isString(e)?new Aw(i,t):Ne.isFunction(e)?new Bg(i,t,""):Ne.isBoolean(e)?new Ng(i,t):null},Pw=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){setTimeout(i,1e3/60)},Ow=function(){function i(){jr(this,i),this.backgroundElement=document.createElement("div"),Ne.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),de.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Ne.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;de.bind(this.backgroundElement,"click",function(){t.hide()})}return zr(i,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Ne.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function n(){t.domElement.style.display="none",t.backgroundElement.style.display="none",de.unbind(t.domElement,"webkitTransitionEnd",n),de.unbind(t.domElement,"transitionend",n),de.unbind(t.domElement,"oTransitionEnd",n)};de.bind(this.domElement,"webkitTransitionEnd",e),de.bind(this.domElement,"transitionend",e),de.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-de.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-de.getHeight(this.domElement)/2+"px"}}]),i}();Cw(function(i){if(i&&typeof window!="undefined"){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=i,document.head.appendChild(t),i}}(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`));var Ha=function(){try{return!!window.localStorage}catch{return!1}}(),gh=void 0,Ug=!0,Ks=void 0,gc=!1,Gg=[],si=function i(t){var e=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),de.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Ne.defaults(n,{closeOnTop:!1,autoPlace:!0,width:i.DEFAULT_WIDTH}),n=Ne.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Ne.isUndefined(n.load)?n.load={preset:"Default"}:n.preset&&(n.load.preset=n.preset),Ne.isUndefined(n.parent)&&n.hideable&&Gg.push(this),n.resizable=Ne.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Ne.isUndefined(n.scrollable)&&(n.scrollable=!0);var r,o=Ha&&localStorage.getItem(Qs(this,"isLocal"))==="true",s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return e.parent?e.getRoot().preset:n.load.preset},set:function(u){e.parent?e.getRoot().preset=u:n.load.preset=u,function(p){for(var _=0;_<p.__preset_select.length;_++)p.__preset_select[_].value===p.preset&&(p.__preset_select.selectedIndex=_)}(this),e.revert()}},width:{get:function(){return n.width},set:function(u){n.width=u,xc(e,u)}},name:{get:function(){return n.name},set:function(u){n.name=u,a&&(a.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(u){n.closed=u,n.closed?de.addClass(e.__ul,i.CLASS_CLOSED):de.removeClass(e.__ul,i.CLASS_CLOSED),this.onResize(),e.__closeButton&&(e.__closeButton.innerHTML=u?i.TEXT_OPEN:i.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return o},set:function(u){Ha&&(o=u,u?de.bind(window,"unload",s):de.unbind(window,"unload",s),localStorage.setItem(Qs(e,"isLocal"),u))}}}),Ne.isUndefined(n.parent)){if(this.closed=n.closed||!1,de.addClass(this.domElement,i.CLASS_MAIN),de.makeSelectable(this.domElement,!1),Ha&&o){e.useLocalStorage=!0;var l=localStorage.getItem(Qs(this,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=i.TEXT_CLOSED,de.addClass(this.__closeButton,i.CLASS_CLOSE_BUTTON),n.closeOnTop?(de.addClass(this.__closeButton,i.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(de.addClass(this.__closeButton,i.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),de.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{n.closed===void 0&&(n.closed=!0);var h=document.createTextNode(n.name);de.addClass(h,"controller-name"),a=vc(e,h),de.addClass(this.__ul,i.CLASS_CLOSED),de.addClass(a,"title"),de.bind(a,"click",function(u){return u.preventDefault(),e.closed=!e.closed,!1}),n.closed||(this.closed=!1)}n.autoPlace&&(Ne.isUndefined(n.parent)&&(Ug&&(Ks=document.createElement("div"),de.addClass(Ks,"dg"),de.addClass(Ks,i.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Ks),Ug=!1),Ks.appendChild(this.domElement),de.addClass(this.domElement,i.CLASS_AUTO_PLACE)),this.parent||xc(e,n.width)),this.__resizeHandler=function(){e.onResizeDebounced()},de.bind(window,"resize",this.__resizeHandler),de.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),de.bind(this.__ul,"transitionend",this.__resizeHandler),de.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&Lw(this),s=function(){Ha&&localStorage.getItem(Qs(e,"isLocal"))==="true"&&localStorage.setItem(Qs(e,"gui"),JSON.stringify(e.getSaveObject()))},this.saveToLocalStorageIfPossible=s,n.parent||((r=e.getRoot()).width+=1,Ne.defer(function(){r.width-=1}))};function vc(i,t,e){var n=document.createElement("li");return t&&n.appendChild(t),e?i.__ul.insertBefore(n,e):i.__ul.appendChild(n),i.onResize(),n}function Hg(i){de.unbind(window,"resize",i.__resizeHandler),i.saveToLocalStorageIfPossible&&de.unbind(window,"unload",i.saveToLocalStorageIfPossible)}function _c(i,t){var e=i.__preset_select[i.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function jg(i,t){var e=i.getRoot(),n=e.__rememberedObjects.indexOf(t.object);if(n!==-1){var r=e.__rememberedObjectIndecesToControllers[n];if(r===void 0&&(r={},e.__rememberedObjectIndecesToControllers[n]=r),r[t.property]=t,e.load&&e.load.remembered){var o=e.load.remembered,s=void 0;if(o[i.preset])s=o[i.preset];else{if(!o.Default)return;s=o.Default}if(s[n]&&s[n][t.property]!==void 0){var a=s[n][t.property];t.initialValue=a,t.setValue(a)}}}}function ja(i,t,e,n){if(t[e]===void 0)throw new Error('Object "'+t+'" has no property "'+e+'"');var r=void 0;if(n.color)r=new mc(t,e);else{var o=[t,e].concat(n.factoryArgs);r=Iw.apply(i,o)}n.before instanceof ds&&(n.before=n.before.__li),jg(i,r),de.addClass(r.domElement,"c");var s=document.createElement("span");de.addClass(s,"property-name"),s.innerHTML=r.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(r.domElement);var l=vc(i,a,n.before);return de.addClass(l,si.CLASS_CONTROLLER_ROW),r instanceof mc?de.addClass(l,"color"):de.addClass(l,ww(r.getValue())),function(h,u,p){if(p.__li=u,p.__gui=h,Ne.extend(p,{options:function(w){if(arguments.length>1){var M=p.__li.nextElementSibling;return p.remove(),ja(h,p.object,p.property,{before:M,factoryArgs:[Ne.toArray(arguments)]})}if(Ne.isArray(w)||Ne.isObject(w)){var C=p.__li.nextElementSibling;return p.remove(),ja(h,p.object,p.property,{before:C,factoryArgs:[w]})}},name:function(w){return p.__li.firstElementChild.firstElementChild.innerHTML=w,p},listen:function(){return p.__gui.listen(p),p},remove:function(){return p.__gui.remove(p),p}}),p instanceof fc){var _=new mh(p.object,p.property,{min:p.__min,max:p.__max,step:p.__step});Ne.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(w){var M=p[w],C=_[w];p[w]=_[w]=function(){var G=Array.prototype.slice.call(arguments);return C.apply(_,G),M.apply(p,G)}}),de.addClass(u,"has-slider"),p.domElement.insertBefore(_.domElement,p.domElement.firstElementChild)}else if(p instanceof mh){var x=function(w){if(Ne.isNumber(p.__min)&&Ne.isNumber(p.__max)){var M=p.__li.firstElementChild.firstElementChild.innerHTML,C=p.__gui.__listening.indexOf(p)>-1;p.remove();var G=ja(h,p.object,p.property,{before:p.__li.nextElementSibling,factoryArgs:[p.__min,p.__max,p.__step]});return G.name(M),C&&G.listen(),G}return w};p.min=Ne.compose(x,p.min),p.max=Ne.compose(x,p.max)}else p instanceof Ng?(de.bind(u,"click",function(){de.fakeEvent(p.__checkbox,"click")}),de.bind(p.__checkbox,"click",function(w){w.stopPropagation()})):p instanceof Bg?(de.bind(u,"click",function(){de.fakeEvent(p.__button,"click")}),de.bind(u,"mouseover",function(){de.addClass(p.__button,"hover")}),de.bind(u,"mouseout",function(){de.removeClass(p.__button,"hover")})):p instanceof mc&&(de.addClass(u,"color"),p.updateDisplay=Ne.compose(function(w){return u.style.borderLeftColor=p.__color.toString(),w},p.updateDisplay),p.updateDisplay());p.setValue=Ne.compose(function(w){return h.getRoot().__preset_select&&p.isModified()&&_c(h.getRoot(),!0),w},p.setValue)}(i,l,r),i.__controllers.push(r),r}function Qs(i,t){return document.location.href+"."+t}function yc(i,t,e){var n=document.createElement("option");n.innerHTML=t,n.value=t,i.__preset_select.appendChild(n),e&&(i.__preset_select.selectedIndex=i.__preset_select.length-1)}function zg(i,t){t.style.display=i.useLocalStorage?"block":"none"}function Nw(i){var t=i.__save_row=document.createElement("li");de.addClass(i.domElement,"has-save"),i.__ul.insertBefore(t,i.__ul.firstChild),de.addClass(t,"save-row");var e=document.createElement("span");e.innerHTML="&nbsp;",de.addClass(e,"button gears");var n=document.createElement("span");n.innerHTML="Save",de.addClass(n,"button"),de.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",de.addClass(r,"button"),de.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",de.addClass(o,"button"),de.addClass(o,"revert");var s=i.__preset_select=document.createElement("select");if(i.load&&i.load.remembered?Ne.each(i.load.remembered,function(u,p){yc(i,p,p===i.preset)}):yc(i,"Default",!1),de.bind(s,"change",function(){for(var u=0;u<i.__preset_select.length;u++)i.__preset_select[u].innerHTML=i.__preset_select[u].value;i.preset=this.value}),t.appendChild(s),t.appendChild(e),t.appendChild(n),t.appendChild(r),t.appendChild(o),Ha){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block",localStorage.getItem(Qs(0,"isLocal"))==="true"&&l.setAttribute("checked","checked"),zg(i,a),de.bind(l,"change",function(){i.useLocalStorage=!i.useLocalStorage,zg(i,a)})}var h=document.getElementById("dg-new-constructor");de.bind(h,"keydown",function(u){!u.metaKey||u.which!==67&&u.keyCode!==67||gh.hide()}),de.bind(e,"click",function(){h.innerHTML=JSON.stringify(i.getSaveObject(),void 0,2),gh.show(),h.focus(),h.select()}),de.bind(n,"click",function(){i.save()}),de.bind(r,"click",function(){var u=prompt("Enter a new preset name.");u&&i.saveAs(u)}),de.bind(o,"click",function(){i.revert()})}function Lw(i){var t=void 0;function e(o){return o.preventDefault(),i.width+=t-o.clientX,i.onResize(),t=o.clientX,!1}function n(){de.removeClass(i.__closeButton,si.CLASS_DRAG),de.unbind(window,"mousemove",e),de.unbind(window,"mouseup",n)}function r(o){return o.preventDefault(),t=o.clientX,de.addClass(i.__closeButton,si.CLASS_DRAG),de.bind(window,"mousemove",e),de.bind(window,"mouseup",n),!1}i.__resize_handle=document.createElement("div"),Ne.extend(i.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),de.bind(i.__resize_handle,"mousedown",r),de.bind(i.__closeButton,"mousedown",r),i.domElement.insertBefore(i.__resize_handle,i.domElement.firstElementChild)}function xc(i,t){i.domElement.style.width=t+"px",i.__save_row&&i.autoPlace&&(i.__save_row.style.width=t+"px"),i.__closeButton&&(i.__closeButton.style.width=t+"px")}function vh(i,t){var e={};return Ne.each(i.__rememberedObjects,function(n,r){var o={},s=i.__rememberedObjectIndecesToControllers[r];Ne.each(s,function(a,l){o[l]=t?a.initialValue:a.getValue()}),e[r]=o}),e}si.toggleHide=function(){gc=!gc,Ne.each(Gg,function(i){i.domElement.style.display=gc?"none":""})},si.CLASS_AUTO_PLACE="a",si.CLASS_AUTO_PLACE_CONTAINER="ac",si.CLASS_MAIN="main",si.CLASS_CONTROLLER_ROW="cr",si.CLASS_TOO_TALL="taller-than-window",si.CLASS_CLOSED="closed",si.CLASS_CLOSE_BUTTON="close-button",si.CLASS_CLOSE_TOP="close-top",si.CLASS_CLOSE_BOTTOM="close-bottom",si.CLASS_DRAG="drag",si.DEFAULT_WIDTH=245,si.TEXT_CLOSED="Close Controls",si.TEXT_OPEN="Open Controls",si._keydownHandler=function(i){document.activeElement.type==="text"||i.which!==72&&i.keyCode!==72||si.toggleHide()},de.bind(window,"keydown",si._keydownHandler,!1),Ne.extend(si.prototype,{add:function(i,t){return ja(this,i,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(i,t){return ja(this,i,t,{color:!0})},remove:function(i){this.__ul.removeChild(i.__li),this.__controllers.splice(this.__controllers.indexOf(i),1);var t=this;Ne.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Ks.removeChild(this.domElement);var i=this;Ne.each(this.__folders,function(t){i.removeFolder(t)}),de.unbind(window,"keydown",si._keydownHandler,!1),Hg(this)},addFolder:function(i){if(this.__folders[i]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+i+'"');var t={name:i,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[i]&&(t.closed=this.load.folders[i].closed,t.load=this.load.folders[i]);var e=new si(t);this.__folders[i]=e;var n=vc(this,e.domElement);return de.addClass(n,"folder"),e},removeFolder:function(i){this.__ul.removeChild(i.domElement.parentElement),delete this.__folders[i.name],this.load&&this.load.folders&&this.load.folders[i.name]&&delete this.load.folders[i.name],Hg(i);var t=this;Ne.each(i.__folders,function(e){i.removeFolder(e)}),Ne.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var i=this.getRoot();if(i.scrollable){var t=de.getOffset(i.__ul).top,e=0;Ne.each(i.__ul.childNodes,function(n){i.autoPlace&&n===i.__save_row||(e+=de.getHeight(n))}),window.innerHeight-t-20<e?(de.addClass(i.domElement,si.CLASS_TOO_TALL),i.__ul.style.height=window.innerHeight-t-20+"px"):(de.removeClass(i.domElement,si.CLASS_TOO_TALL),i.__ul.style.height="auto")}i.__resize_handle&&Ne.defer(function(){i.__resize_handle.style.height=i.__ul.offsetHeight+"px"}),i.__closeButton&&(i.__closeButton.style.width=i.width+"px")},onResizeDebounced:Ne.debounce(function(){this.onResize()},50),remember:function(){if(Ne.isUndefined(gh)&&((gh=new Ow).domElement.innerHTML=Rw),this.parent)throw new Error("You can only call remember on a top level GUI.");var i=this;Ne.each(Array.prototype.slice.call(arguments),function(t){i.__rememberedObjects.length===0&&Nw(i),i.__rememberedObjects.indexOf(t)===-1&&i.__rememberedObjects.push(t)}),this.autoPlace&&xc(this,this.width)},getRoot:function(){for(var i=this;i.parent;)i=i.parent;return i},getSaveObject:function(){var i=this.load;return i.closed=this.closed,this.__rememberedObjects.length>0&&(i.preset=this.preset,i.remembered||(i.remembered={}),i.remembered[this.preset]=vh(this)),i.folders={},Ne.each(this.__folders,function(t,e){i.folders[e]=t.getSaveObject()}),i},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=vh(this),_c(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(i){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=vh(this,!0)),this.load.remembered[i]=vh(this),this.preset=i,yc(this,i,!0),this.saveToLocalStorageIfPossible()},revert:function(i){Ne.each(this.__controllers,function(t){this.getRoot().load.remembered?jg(i||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Ne.each(this.__folders,function(t){t.revert(t)}),i||_c(this.getRoot(),!1)},listen:function(i){var t=this.__listening.length===0;this.__listening.push(i),t&&function e(n){n.length!==0&&Pw.call(window,function(){e(n)}),Ne.each(n,function(r){r.updateDisplay()})}(this.__listening)},updateDisplay:function(){Ne.each(this.__controllers,function(i){i.updateDisplay()}),Ne.each(this.__folders,function(i){i.updateDisplay()})}});var Dw=si,Fw=function(){function i(t){this.player=t}return Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.player.fps.value},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawFrames",{get:function(){return this.player.runtime.fps},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"resolution",{get:function(){return this.player.config.resolution},set:function(t){this.player.updateConfig({resolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){var t,e;return((t=this.player.view)===null||t===void 0?void 0:t.width)+"*"+((e=this.player.view)===null||e===void 0?void 0:e.height)},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"minFPS",{get:function(){return this.player.config.minFPS},set:function(t){this.player.updateConfig({minFPS:t,maxFPS:this.player.config.maxFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxFPS",{get:function(){return this.player.config.maxFPS},set:function(t){this.player.updateConfig({maxFPS:t,minFPS:this.player.config.minFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoResolution",{get:function(){return this.player.config.autoResolution},set:function(t){this.player.updateConfig({autoResolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoFPS",{get:function(){return this.player.config.autoFPS},set:function(t){this.player.updateConfig({autoFPS:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"backgroundColor",{get:function(){return this.player.config.transactionBgColor},set:function(t){this.player.updateConfig({transactionBgColor:t})},enumerable:!1,configurable:!0}),i}(),Bw=function(){function i(t,e){var n;this.config=new Fw(t),this.anchor=e,n=this.createControllerGUI(),this.gui=n[0],this.controller=n[1],this.createStats()}return i.prototype.createStats=function(){var t=this;this.stateId=setInterval(function(){t.controller.frameRate.updateDisplay(),t.controller.size.updateDisplay(),t.controller.minFPS.updateDisplay(),t.controller.drawFrames.updateDisplay(),t.controller.maxFPS.updateDisplay(),t.controller.resolution.updateDisplay(),t.controller.autoFps.updateDisplay(),t.controller.autoResolution.updateDisplay(),t.controller.drawCall.updateDisplay()},16)},i.prototype.createControllerGUI=function(){var t=new Dw({autoPlace:!0,closed:!0});t.domElement.style.opacity=".6",t.domElement.style.transformOrigin="100% 0",t.domElement.style.transform="scale(1)",this.anchor.appendChild(t.domElement),t.domElement.style.position="absolute",t.domElement.style.right="0",t.domElement.style.top="0",t.domElement.style.zIndex="2";var e={frameRate:t.add(this.config,"frameRate"),drawFrames:t.add(this.config,"drawFrames"),drawCall:t.add(this.config,"drawCall"),size:t.add(this.config,"size"),minFPS:t.add(this.config,"minFPS",0,60),maxFPS:t.add(this.config,"maxFPS",0,60),resolution:t.add(this.config,"resolution",.5,8,.5),autoResolution:t.add(this.config,"autoResolution"),autoFps:t.add(this.config,"autoFPS"),transactionBgColor:t.addColor(this.config,"backgroundColor")};return[t,e]},i.prototype.destroy=function(){try{window.clearInterval(this.stateId),this.anchor.removeChild(this.gui.domElement),this.gui.destroy()}catch{}},i}(),kw=function(){function i(t){var e=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){e.isScheduling=!0;var n=e.tasks.shift();n&&!e.isDestroy&&e.fn(n).then(function(){e.tasks.length>0?window.requestAnimationFrame(e.schedule):e.isScheduling=!1})},this.fn=t}return i.prototype.destroy=function(){this.isDestroy=!0},i.prototype.addTask=function(t){this.tasks.push(t),this.isScheduling||this.schedule()},i}(),Uw=function(){function i(t){this.autoUnlock=Object.create(null),this.locks=Object.create(null),this.available=!1,this.available=t}return i.prototype.addLock=function(t,e){var n=this;this.available&&(this.locks[t]=e,this.autoUnlock[t]=window.setTimeout(function(){delete n.locks[t]},3e3))},i.prototype.unlock=function(t,e){this.available&&e&&this.locks[t]&&this.locks[t]===e&&(window.clearTimeout(this.autoUnlock[t]),delete this.locks[t])},i.prototype.isLocked=function(t){return!!this.available&&!!this.locks[t]},i}(),Gw=function(){function i(){var t=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){t.isScheduling=!0;var e=t.tasks.shift();e&&!t.isDestroy&&(e.status="running",e.fn.apply(null).then(function(){t.tasks.length>0?window.requestAnimationFrame(t.schedule):t.isScheduling=!1}).catch(function(){t.tasks.length>0?window.requestAnimationFrame(t.schedule):t.isScheduling=!1}))}}return i.prototype.getRunningTask=function(){return this.tasks[0]&&this.tasks[0].status==="running"?this.tasks[0]:null},i.prototype.addTask=function(t,e){var n={type:t,status:"wait",fn:e},r=this.getRunningTask();r&&t===r.type||(this.tasks=this.tasks.filter(function(o){return o.type!==t}),this.tasks.push(n),this.isScheduling||this.schedule())},i.prototype.destroy=function(){this.isDestroy=!0},i}(),bc=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},Tc=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},Hw=function(){function i(){var t=this;this.logList=[],this.checkTimer=null,this.retryTimes=0,this.enable=!1,this.uploadLoggerGlobalEvent=function(e){e.data.type==="@slide/_upload_log_"&&t.start()},this.config={checkTime:3e3,buffer:300},window.addEventListener("message",this.uploadLoggerGlobalEvent),this.start()}return i.prototype.start=function(){return bc(this,void 0,void 0,function(){var t=this;return Tc(this,function(e){return clearInterval(this.checkTimer),this.checkTimer=setInterval(function(){return bc(t,void 0,void 0,function(){return Tc(this,function(n){switch(n.label){case 0:return[4,this.uploadLog()];case 1:return n.sent(),[2]}})})},this.config.checkTime),[2]})})},i.prototype.pause=function(){clearInterval(this.checkTimer)},i.prototype.addLog=function(t,e,n,r){this.logList.push({level:e,taskId:n,message:t,randomId:r})},i.prototype.destroy=function(){clearInterval(this.checkTimer),window.removeEventListener("message",this.uploadLoggerGlobalEvent)},i.prototype.uploadLog=function(t){return t===void 0&&(t=!1),bc(this,void 0,void 0,function(){var e,n,r,o=this;return Tc(this,function(s){switch(s.label){case 0:if(!(this.logList.length>=this.config.buffer||t))return[2];e=this.logList.splice(0),n=function(){o.logList=e.concat(o.logList),o.retryTimes>3&&o.pause(),o.retryTimes+=1},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch("https://netless-ppt-plugin-dev.cn-hangzhou.log.aliyuncs.com/logstores/netless-ppt-plugin-dev/track",{method:"POST",headers:{"x-log-apiversion":"0.6.0","Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({__topic__:"netless-ppt-plugin-dev",__source__:"netless-ppt-plugin-dev",__logs__:e})})];case 2:return s.sent().ok?this.retryTimes=0:n(),[3,4];case 3:return r=s.sent(),console.warn(r),n(),[3,4];case 4:return[2]}})})},i.prototype.setEnable=function(t){this.enable!==t&&(t?this.start():this.pause())},i}(),jw=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},zw=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}};function Vw(i,t,e,n){return jw(this,void 0,void 0,function(){var r,o,s,a;return zw(this,function(l){switch(l.label){case 0:return r=document.createElement("div"),(o=new to({anchor:r,renderOptions:{minFPS:1,maxFPS:1,resolution:1,maxResolutionLevel:e,forceCanvas:!0},mode:"local",interactive:!1,useLocalCache:!0})).setResource(i,t),[4,o.getSlideCountAsync()];case 1:s=l.sent(),a=1,l.label=2;case 2:return a<=s?[4,o.player.stagePool.preload(a,!0)]:[3,5];case 3:l.sent(),n(Math.round(a/s*100)/100),l.label=4;case 4:return a++,[3,2];case 5:return o.destroy(),[2]}})})}var Ww=function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])})(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ps=function(){return(ps=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}).apply(this,arguments)},Xw=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Xi=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},Yi=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},Yw=window.ResizeObserver||vw,_h=function(i){return new Promise(function(t){return setTimeout(t,i)})};function qw(i,t){return Xi(this,void 0,void 0,function(){var e;return Yi(this,function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return!i()&&Date.now()-e<t?[4,_h(50)]:[3,3];case 2:return n.sent(),e=Date.now(),[3,1];case 3:return[2]}})})}var lr={syncDispatch:"syncDispatch",syncReceive:"syncReceive",syncEventLag:"syncEventLag",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd",stateChange:"stateChange",slideStepEnd:"slideEnd",slideStepStart:"slideStart"},Vg={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,mediaState:Object.create(null),interactiveSeqState:Object.create(null)},wc="";try{wc="1.4.12-alpha.0"}catch{wc="dev"}var cr=null;try{(cr=I.createInstance({name:"__slide_local_log__",driver:I.INDEXEDDB,version:1})).ready(function(i){}).catch(function(i){})}catch{}navigator.userAgent.toUpperCase().includes("HUAWEI")&&document.createElement("canvas").getContext("2d").fillText("\u9065\u9065\u9886\u5148",0,10);var to=function(i){function t(r){var o=i.call(this)||this;return o.iosResetCache=[],o.needClearCacheImage=!1,o.version=wc,o.__slideState=fg()(Vg),o.userInputTime=0,o.isSyncingSlideState=!1,o.frozenTaskManager=new Gw,o.randomId=S(),o.resize=!1,o.isAnimating=!1,o.renderingTaskManager=new bw,o.isLoading=!1,o.interactive=!0,o.renderingIndex=0,o.frameWidth=1,o.frameHeight=1,o.frame=document.createElement("div"),o.canvasContainer=document.createElement("div"),o.medianController=document.createElement("div"),o.frameResizeObserver=new Yw(function(){return o.frameResizeHandler()}),o.timestamp=function(){return Date.now()},o.mode="local",o.enableGlobalClick=!1,o.lastEmitedState=null,o.playerController=null,o.isInitResized=!1,o.cacheImage=document.createElement("img"),o.isTouchStart=!1,o.touchStartId=void 0,o.taskId="",o.volumeAdjuster=new dg,o.designWidth=0,o.designHeight=0,o._slideCount=0,o._dispatchIncrId=0,o._receiveIncrId=0,o.resizeView=hh()(o._resizeView.bind(o),50),o.handleViewClick=hh()(o._handleViewClick.bind(o),300),o.resourceList=[],o._updateVolumeByStaticAdjuster=function(s){o.volumeAdjuster.volume=s},o.recoverHandler=function(s){if(s.data.type==="@slide/_recover_"&&s.data.slideId===o.randomId){var a=s.data,l=a.recoverBy,h=a.payload;if(!h)return;l==="renderOtherPage"&&h.slideIndex?o.doRenderSlide(h.slideIndex).catch(function(u){o.logger.error(u,o.taskId)}):l==="reloadCurrentPage"&&o.doRenderSlide(o.renderingIndex).catch(function(u){o.logger.error(u,o.taskId)})}},o.urlInterrupter=function(s){return Xi(o,void 0,void 0,function(){var a,l;return Yi(this,function(h){return a=s,this.resourceList.length>0&&(l=s.replace(/^.*__internal__/,""),a=this.resourceList.find(function(u){return u.indexOf(l)>=0})||s),this.config.urlInterrupter?[2,this.config.urlInterrupter(a)]:[2,Promise.resolve(a)]})})},o.userInputHandle=function(){o.userInputTime=Date.now()},o.handleViewTouchStart=function(){window.clearTimeout(o.touchStartId),o.isTouchStart=!0,o.touchStartId=setTimeout(function(){o.isTouchStart=!1},350)},o.handleViewTouchEnd=function(){o.isTouchStart&&(o.isTouchStart=!1,o.handleViewClick())},o.handleSlideRef=function(){console.log(o),window.__slide=o},o.receiveSyncHandler=function(s){return Xi(o,void 0,void 0,function(){var a,l,h,u,p,_=this;return Yi(this,function(x){switch(x.label){case 0:return Fo()(s.incrId)&&(s.incrId&&s.incrId-this._receiveIncrId!=1&&this.emit(lr.syncEventLag),this._receiveIncrId=s.incrId||0),this.logger.info("sync receive "+JSON.stringify(s),this.taskId),s.type!=="nextStep"?[3,1]:(this.mainSeqStep!==s.next-1&&this.mainSeqStep+1!==this.mainSeqLength&&this.player?(this.setMainSeqStep(s.next,"start"),this.player.nextTick(function(){_.doNextStep(!0,s.clientId||"")})):this.doNextStep(!0,s.clientId||""),[3,6]);case 1:return s.type!=="prevStep"?[3,2]:(this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===s.next+1||this.mainSeqStep+1===this.mainSeqLength?this.doPrevStep(!0):(this.setMainSeqStep(s.next+1,"start"),(a=this.player)===null||a===void 0||a.nextTick(function(){_.doPrevStep(!0)})),[3,6]);case 2:return s.type!=="interactiveAnim"?[3,3]:(this.player?this.player.applyInteractiveAction(s.action):this.__slideState.interactiveSeqState[s.seqId]?this.__slideState.interactiveSeqState[s.seqId].step+=1:this.__slideState.interactiveSeqState[s.seqId]={step:0,state:"end"},[3,6]);case 3:return s.type!=="renderSlide"?[3,5]:[4,this.doRenderSlide(s.index,s.isForward)];case 4:return x.sent(),[3,6];case 5:s.type==="mediaPlay"?((l=this.player)===null||l===void 0||l.setMediaState(s.id,!0),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaPause"?((h=this.player)===null||h===void 0||h.setMediaState(s.id,!1),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaSeek"?((u=this.player)===null||u===void 0||u.setMediaCurrentTime(s.id,s.time),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaFullscreen"&&(s.targetId&&this.__slideState.mediaState[s.targetId]?this.__slideState.mediaState[s.targetId].fullscreen=s.state:this.__slideState.mediaState[s.targetId]={fullscreen:s.state,type:"pause",time:0},(p=this.player)===null||p===void 0||p.syncFullscreenVideoState({targetId:s.targetId,state:s.state,slideIndex:s.slideIndex})),x.label=6;case 6:return[2]}})})},o.flushDebounce=function(){o.resizeView.flush(),o.handleViewClick.flush()},o.handlePrevSlide=function(s){return s===void 0&&(s=!1),Xi(o,void 0,void 0,function(){var a,l;return Yi(this,function(h){return this.player?((a=this.player.prevSlideIndex)>=1&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!1):this.renderSlide(a,!1)),[2]):[2]})})},o.handleNextSlide=function(s){return s===void 0&&(s=!1),Xi(o,void 0,void 0,function(){var a,l;return Yi(this,function(h){return this.player?((a=this.player.nextSlideIndex)<=this.slideCount&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!0):this.renderSlide(a,!0)),[2]):[2]})})},o.handleGotoSlide=function(s){if(s<=o.slideCount&&s>=1){var a=o.slideState.currentSlideIndex<=s;o.renderSlide(s,a)}else s===-1&&o.renderSlide(o.slideCount,!0)},t.instances.push(o),o.config=o.initSlideConfig(r),o.tracker=function(s){r.whiteTracker&&r.whiteTracker.commit({name:s.name,reason:s.reason,result:s.result,payload:ps(ps({},s.payload),{slideId:o.randomId,taskId:o.taskId})},{slideVersion:o.version||""})},t.trackLogger.setEnable(!!o.config.enableTracking),o.logger={info:function(s,a){var l;t.appendLogString("INFO - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"info",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.info;h&&h("["+a+"] "+s)},warn:function(s,a){var l;t.appendLogString("WARN - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"warn",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.warn;h&&h("["+a+"] "+s)},error:function(s,a){var l;t.appendLogString("ERROR - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"error",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.error;h&&h("["+a+"] "+s)}},o.logger.info("new slide with clientId: "+o.config.clientId+", version: "+o.version,o.taskId),o.tracker({name:"initSlide",result:"",reason:"",payload:{taskId:o.taskId}}),o.anchor=o.config.anchor,o.syncQueue=new kw(o.receiveSyncHandler),o.lock=new Uw(o.mode==="interactive"),o.cacheImage.style.position="absolute",o.cacheImage.style.zIndex="100",o.setMedianControllerAttribute(),o.canvasContainer.style.position="relative",o.canvasContainer.style.fontSize="0",o.canvasContainer.appendChild(o.medianController),o.frame.appendChild(o.canvasContainer),o.frameResizeObserver.observe(o.frame),o.on(lr.syncReceive,function(s){o.lock.unlock(s.type,s.uuid),o.syncQueue.addTask(s)}),o.renderingTaskManager.eventHub.on("task-error",function(s){var a=s.error,l=s.task,h=xi.transform(a);h.errorType===Vi.RuntimeWarn?o.logger.warn(h.message,o.taskId):o.logger.error(h.message,o.taskId),o.isLoading=!1,o.reportError(h,l.slideIndex)}),window.addEventListener("__slide_ref__",o.handleSlideRef),o.resizeView=hh()(o.resizeView.bind(o),50),o.player=o.initPlayer(o.config),o.config.controller&&o.createController(),o.player.view&&o.canvasContainer.appendChild(o.player.view),o.handleViewClick=hh()(o.handleViewClick,300),o.player.errorChannel.on("error",function(s,a){var l=xi.transform(s);l.errorType===Vi.RuntimeWarn?o.logger.warn(l.message,o.taskId):o.logger.error(l.message,o.taskId),o.isLoading=!1,o.reportError(s,a),o.tracker({name:"slideError",reason:l.errorMsg,result:"",payload:{code:l.errorType}})}),window.addEventListener("message",o.recoverHandler),t.volumeAdjuster.on("update",o._updateVolumeByStaticAdjuster),o.volumeAdjuster.volume=t.volumeAdjuster.volume,o}var e,n;return Ww(t,i),t.flushLog=function(r){return r===void 0&&(r=!1),Xi(this,void 0,void 0,function(){return Yi(this,function(o){switch(o.label){case 0:if(!(t._tempLog.length>131072||r&&t._tempLog.length>0))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,cr==null?void 0:cr.setItem("run_time_log_"+t._tempLogIndex,t._tempLog)];case 2:return o.sent(),[3,4];case 3:return o.sent(),[3,4];case 4:t._tempLog="",t._tempLogIndex+=1,o.label=5;case 5:return[2]}})})},t.stopRemoteLog=function(){t.remoteLogAddress=null},t.startRemoteLog=function(r){return Xi(this,void 0,void 0,function(){var o,s,a,l,h;return Yi(this,function(u){switch(u.label){case 0:return t.remoteLogAddress=r,[4,t.flushLog(!0)];case 1:if(u.sent(),!cr)return[3,13];o=[],u.label=2;case 2:return u.trys.push([2,4,,5]),[4,cr.keys()];case 3:return o=(u.sent()||[]).sort(function(p,_){return parseInt(p.replace("run_time_log_",""))-parseInt(_.replace("run_time_log_",""))}),[3,5];case 4:return u.sent(),[3,5];case 5:s=0,a=o,u.label=6;case 6:if(!(s<a.length))return[3,13];l=a[s],l.replace("run_time_log_",""),h="",u.label=7;case 7:return u.trys.push([7,9,,10]),[4,cr.getItem(l)];case 8:return h=u.sent()||"",[3,10];case 9:return u.sent(),[3,10];case 10:return[4,fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:h})})];case 11:u.sent(),u.label=12;case 12:return s++,[3,6];case 13:return[2]}})})},t.appendLogString=function(r){t._tempLog+=r,t.remoteLogAddress&&fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:r})}).catch(function(){})},Object.defineProperty(t.prototype,"dispatchIncrId",{get:function(){return this._dispatchIncrId++},enumerable:!1,configurable:!0}),t.prototype.reportError=function(r,o){this.emit(lr.renderError,{error:r,index:o}),window.postMessage({type:"@slide/_error_",errorType:r.errorType,errorMsg:r.errorMsg,slideId:this.randomId,slideIndex:o,customMessage:"@slide/_error_"},"*"),t.trackLogger.uploadLog(!0)},t.prototype.initSlideConfig=function(r){return r.timestamp&&(this.timestamp=r.timestamp),r.rtcAudio&&(ar.RtcAudioClazz=r.rtcAudio),this.mode=r.mode,this.anchor=r.anchor,this.anchor.appendChild(this.frame),this.enableGlobalClick=!Hi()(r.enableGlobalClick)&&r.enableGlobalClick,this.resize=r.resize||!1,this.interactive=r.interactive,this.frame.style.cssText=r.fixedFrameSize?"width:"+r.fixedFrameSize.width+"px;height:"+r.fixedFrameSize.height+"px;":"width:100%;height:100%",this.frame.style.cssText+="display:flex;justify-content:center;align-items:center;visibility:hidden;position:relative;z-index:1;",r.fixedFrameSize&&(this.frameWidth=r.fixedFrameSize.width,this.frameHeight=r.fixedFrameSize.height),r},t.prototype.initPlayer=function(r){var o,s,a,l=this,h=new ar({mode:this.mode,useLocalCache:!!Hi()(this.config.useLocalCache)||this.config.useLocalCache,logger:this.logger,resourceTimeout:Hi()(this.config.resourceTimeout)?15e3:this.config.resourceTimeout,loadDelegate:this.config.loaderDelegate,volumeAdjuster:this.volumeAdjuster,urlInterrupter:this.urlInterrupter,tracker:this.tracker},r.renderOptions);return h.setInteractive(this.interactive),h.updateConfig(r.renderOptions||{}),h.on(Ze.renderStart,function(u){l.isLoading=!0,l.emit(lr.renderStart,u),window.postMessage({type:"@slide/_render_start_",taskId:l.taskId,index:u},"*")}),h.on(Ze.renderEnd,function(u){l.isLoading=!1,l.player&&(l.designHeight=l.player.designHeight,l.designWidth=l.player.designWidth,l.cacheImage.style.width=l.player.designWidth+"px",l.cacheImage.style.height=l.player.designHeight+"px",l._slideCount=l.player.slideCount),l.emit(lr.renderEnd,u),window.postMessage({type:"@slide/_render_end_",taskId:l.taskId,index:u},"*")}),h.on(Ze.slideChange,function(u){l.__slideState.currentSlideIndex=u,l.emitStateChange(),l.emit(lr.slideChange,u)}),h.on(Ze.mainSeqStateChange,function(u){l.__slideState.mainSeqState=u,l.emitStateChange()}),h.on(Ze.mainSeqStepChange,function(u){l.__slideState.mainSeqStep=u,l.emitStateChange()}),h.on(Ze.interactiveSeqStateChange,function(u){var p=u.id,_=u.state;l.__slideState.interactiveSeqState[p]=_,l.emitStateChange()}),h.on(Ze.animateStart,function(){l.isAnimating!==!0&&(l.isAnimating=!0,l.emit(lr.animateStart))}),h.on(Ze.animateEnd,function(){l.isAnimating!==!1&&(l.isAnimating=!1,l.emit(lr.animateEnd))}),h.on(Ze.interactiveSeqAction,function(u){var p=u.action,_=u.seqId;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"interactiveAnim",action:p,seqId:_}),l.emitStateChange()}),h.on(Ze.mainSeqStepStart,function(u){l.emit(lr.mainSeqStepStart,u)}),h.on(Ze.mainSeqStepEnd,function(u){l.emit(lr.mainSeqStepEnd,u)}),h.on(Ze.mediaPlay,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};_.type="play",_.time=l.timestamp()-1e3*u.time,l.__slideState.mediaState[u.id]=_,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:_}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:_}),l.emitStateChange()}),h.on(Ze.mediaStop,function(u){delete l.__slideState.mediaState[u.id],l.emitStateChange()}),h.on(Ze.mediaPause,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};_.type="pause",_.time=u.time,l.__slideState.mediaState[u.id]=_,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:_}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:_}),l.emitStateChange()}),h.on(Ze.mediaSeek,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};u.isPlaying?(_.type="play",_.time=l.timestamp()-1e3*u.time):(_.type="pause",_.time=u.time),l.__slideState.mediaState[u.id]=_,l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaSeek",id:u.id,time:u.time,state:_}),l.emitStateChange()}),h.on(Ze.requestPrevSlide,function(u){l.handlePrevSlide(u)}),h.on(Ze.requestNextSlide,function(u){l.handleNextSlide(u)}),h.on(Ze.requestGotoSlide,function(u){var p;!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.gotoPage?l.config.navigatorDelegate.gotoPage(u):l.handleGotoSlide(u)}),h.on(Ze.requestOpenUrl,function(u){var p;console.log(l.config.navigatorDelegate),!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.openUrl&&l.config.navigatorDelegate.openUrl(u)}),h.on(Ze.fullscreenChange,function(u){var p,_=u.targetId,x=u.state;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaFullscreen",targetId:_,state:x});var w=(p=l.__slideState.mediaState[_])!==null&&p!==void 0?p:{};w.fullscreen=x,l.__slideState.mediaState[_]=w,l.emitStateChange()}),h.on(Ze.changeLocalFullscreenState,function(u){u.slideIndex===l.__slideState.currentSlideIndex?(u.targetId&&l.__slideState.mediaState[u.targetId]&&(l.__slideState.mediaState[u.targetId].fullscreen=u.status),l.emitStateChange()):l.logger.info("event slideIndex: "+u.slideIndex+", current slideIndex: "+l.__slideState.currentSlideIndex,l.taskId)}),(o=h.view)===null||o===void 0||o.addEventListener("touchend",this.handleViewTouchEnd),(s=h.view)===null||s===void 0||s.addEventListener("touchstart",this.handleViewTouchStart),(a=h.view)===null||a===void 0||a.addEventListener("click",this.handleViewClick),h.on(Ze.userInput,this.userInputHandle),h},t.prototype._handleViewClick=function(){var r=this;setTimeout(function(){var o=Date.now();Math.abs(o-r.userInputTime)>500&&r.enableGlobalClick&&r.nextStep()})},t.prototype.createController=function(){this.player&&(this.playerController=new Bw(this.player,this.frame))},t.prototype.setMedianControllerAttribute=function(){this.medianController.className="median-container",this.medianController.style.position="absolute",this.medianController.style.left="0",this.medianController.style.top="0",this.medianController.style.zIndex="2",this.medianController.style.fontSize="16px"},t.prototype.frameResizeHandler=function(){if(!this.config.fixedFrameSize){var r=this.frame.getBoundingClientRect(),o=r.width,s=r.height;this.frameWidth=o,this.frameHeight=s,this.resizeView()}},t.prototype.updateFixedFrameSize=function(r,o,s){this.config.fixedFrameSize&&(this.frameWidth=r,this.frameHeight=o,this.frame.style.width=r+"px",this.frame.style.height=o+"px",this.resizeView(s))},t.prototype._resizeView=function(r){var o,s,a=this,l=this.width,h=this.height;if(l>0&&h>0){var u=this.frameWidth/l,p=u*h;p>this.frameHeight&&(u*=this.frameHeight/p),(o=this.player)===null||o===void 0||o.scaleView(u,this.resize,r),this.cacheImage.style.transform="scale("+u+")",this.medianController.style.transform="scale("+u+")",this.medianController.setAttribute("data-scale",u.toString()),this.isInitResized||(this.isInitResized=!0,(s=this.player)===null||s===void 0||s.clock.setTimeout(function(){a.frame.style.visibility="visible"},32))}},t.prototype.setSlideState=function(r){var o,s,a;return Xi(this,void 0,void 0,function(){var l,h=this;return Yi(this,function(u){switch(u.label){case 0:return this.isSyncingSlideState=!0,this.logger.info("stateChange receive "+JSON.stringify(r),this.taskId),r.taskId&&r.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=r.taskId,(o=this.player)===null||o===void 0||o.setResourceData(r.taskId,this.__slideState.url)),r.url&&r.url!==this.__slideState.url&&(this.__slideState.url=r.url,(s=this.player)===null||s===void 0||s.setResourceData(this.__slideState.taskId,r.url)),Number.isInteger(r.currentSlideIndex)&&r.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=r.currentSlideIndex,[4,this.doRenderSlide(r.currentSlideIndex)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[4,(a=this.player)===null||a===void 0?void 0:a.clock.waitUntil(function(){var p,_;return((p=h.player)===null||p===void 0?void 0:p.currentIndex)===r.currentSlideIndex&&((_=h.player)===null||_===void 0?void 0:_.currentStage)},3e3)];case 3:return u.sent(),l=!1,Number.isInteger(r.mainSeqStep)&&r.mainSeqStep!==this.__slideState.mainSeqStep&&(l=!0,this.__slideState.mainSeqStep=r.mainSeqStep),r.mainSeqState&&r.mainSeqState!==this.__slideState.mainSeqState&&(l=!0,this.__slideState.mainSeqState=r.mainSeqState),l&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),r.interactiveSeqState&&(this.initInteractiveSeq(r),this.__slideState.interactiveSeqState=r.interactiveSeqState),[4,_h(1500)];case 4:return u.sent(),r.mediaState&&(this.initMedia(r),this.__slideState.mediaState=r.mediaState),this.isSyncingSlideState=!1,[2]}})})},t.prototype.initInteractiveSeq=function(r){var o;for(var s in r.interactiveSeqState){var a=r.interactiveSeqState[s];(o=this.player)===null||o===void 0||o.setInteractiveSeqState(s,a.step,a.state==="idle"?"start":"end")}},t.prototype.initMedia=function(r){var o,s,a;for(var l in r.mediaState){var h=r.mediaState[l],u=this.__slideState.mediaState[l];if((o=this.player)===null||o===void 0||o.syncFullscreenVideoState({targetId:l,state:!!h.fullscreen,slideIndex:this.slideState.currentSlideIndex}),!u||h.type!==u.type||h.time!==u.time)if(h.type==="play"){var p=(this.timestamp()-h.time)/1e3;(s=this.player)===null||s===void 0||s.setMediaState(l,!0,p)}else(a=this.player)===null||a===void 0||a.setMediaState(l,!1,h.time)}},Object.defineProperty(t.prototype,"slideCount",{get:function(){return this._slideCount},enumerable:!1,configurable:!0}),t.prototype.getSizeAsync=function(){return Xi(this,void 0,void 0,function(){var r;return Yi(this,function(o){switch(o.label){case 0:if(this.width>0&&this.height>0)return[2,[this.width,this.height]];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,o.sent().json()];case 3:return[2,[(r=o.sent()).width,r.height]];case 4:return o.sent(),[2,[0,0]];case 5:return[2]}})})},t.prototype.getSlideCountAsync=function(){return Xi(this,void 0,void 0,function(){return Yi(this,function(r){switch(r.label){case 0:if(this._slideCount>0)return[2,this._slideCount];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,r.sent().json()];case 3:return[2,r.sent().slideCount];case 4:return r.sent(),[2,0];case 5:return[2]}})})},Object.defineProperty(t.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqLength",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqLength())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqStep",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqStep())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqState",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqState())||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderOptions",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.config)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drawCall",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.drawCall)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.fps)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"runtimeFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.fps.value)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.view)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.designWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.designHeight},enumerable:!1,configurable:!0}),t.prototype.updateRenderOption=function(r){this.player&&(this.player.updateConfig(r),this.renderOptions&&(this.config.renderOptions=this.renderOptions))},t.prototype.setResource=function(r,o){var s;this.taskId=r,(s=this.player)===null||s===void 0||s.setResourceData(r,o),this.__slideState.taskId=r,this.__slideState.url=o,this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"setResource",taskId:r,url:o})},t.prototype.setResourceList=function(r,o){var s;this.taskId=r,this.resourceList=o,(s=this.player)===null||s===void 0||s.setResourceData(r,"__internal__"),this.__slideState.taskId=r,this.__slideState.url="__internal__"},t.prototype._renderSlide=function(r){var o;return Xi(this,void 0,void 0,function(){var s=this;return Yi(this,function(a){switch(a.label){case 0:return this.renderingIndex=r,this.player&&r===this.player.currentIndex?[2]:((ar.platform.isIOS()||ar.platform.isAndroid())&&this.iosResetCache.indexOf(r)<0&&this.iosResetCache.push(r),this.flushDebounce(),[4,(o=this.player)===null||o===void 0?void 0:o.renderSlide(r)]);case 1:return a.sent(),this.__slideState.currentSlideIndex=r,this.resizeView(),this.__slideState.interactiveSeqState={},this.__slideState.mediaState={},this.emitStateChange(),setTimeout(function(){var l,h;if(((h=(l=s.player)===null||l===void 0?void 0:l.view)===null||h===void 0?void 0:h.style.visibility)==="hidden"&&(s.player.view.style.visibility="visible"),s.frame.style.visibility==="hidden"&&(s.frame.style.visibility="visible"),s.needClearCacheImage)try{s.frame.removeChild(s.cacheImage)}catch{s.logger.error("removeChild error Slide.ts:1553",s.taskId)}},100),[2]}})})},t.prototype.renderSlide=function(r,o){if(o===void 0&&(o=!0),this.player){var s=Number(r);(s!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(s>this.slideCount&&this.slideCount>0||this.poseRenderSlide(s,o))}},t.prototype.needCreateNewPlayer=function(){var r=ar.platform.isLowGpuMemory()?15:30;return(ar.platform.isIOS()||ar.platform.isAndroid())&&this.iosResetCache.length>r},t.prototype.poseRenderSlide=function(r,o){this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o}):this.mode==="sync"?(this.doRenderSlide(r,o),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o})):this.doRenderSlide(r,o)},t.prototype.doRenderSlide=function(r,o){var s,a,l,h=this;if(o===void 0&&(o=!0),!this.player)return Promise.resolve();if(this.needCreateNewPlayer()&&(this.iosResetCache=[],this.iosNewPlayer=this.initPlayer(this.config),this.iosNewPlayer.setResourceData(this.__slideState.taskId,this.__slideState.url)),this.iosNewPlayer){var u=this.player.getSnapshot();this.cacheImage.src=u,this.frame.appendChild(this.cacheImage),this.player.destroy(),(s=this.playerController)===null||s===void 0||s.destroy(),this.player=this.iosNewPlayer,this.iosNewPlayer=void 0,!((a=this.config)===null||a===void 0)&&a.controller&&this.createController(),this.needClearCacheImage=!0,!((l=this==null?void 0:this.player)===null||l===void 0)&&l.view&&(this.player.view.style.visibility="hidden",this.canvasContainer.appendChild(this.player.view))}var p=Math.random().toString(32).substr(2);return this.player.isForward=o,this.renderingTaskManager.addTask(function(){return h._renderSlide(r)},r,p),new Promise(function(_){h.renderingTaskManager.eventHub.once("task-end-"+p,_)})},t.prototype.getSnapshot=function(){var r,o;return(o=(r=this.player)===null||r===void 0?void 0:r.getSnapshot())!==null&&o!==void 0?o:null},t.prototype.nextStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasNextStep()||this.emit(lr.slideStepEnd),this.player.mainSeqHasNextStep()?this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()+1}):this.mode==="sync"?(this.doNextStep(!1,""),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()})):this.doNextStep(!1,""):this.handleNextSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+!!this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doNextStep=function(r,o){if(this.player){var s=!this.config.clientId||o===this.config.clientId;this.player.nextStep(r,s);var a=this.player.mainSeqStep();this.__slideState.mainSeqStep=a,this.emitStateChange()}},t.prototype.prevStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasPrevStep()||this.emit(lr.slideStepStart),this.player.mainSeqHasPrevStep()?this.mode==="interactive"?this.emitSyncDispatch({type:"prevStep",slideIndex:this.__slideState.currentSlideIndex,next:this.player.mainSeqStep()-1}):this.mode==="sync"?(this.doPrevStep(),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"prevStep",next:this.player.mainSeqStep()})):this.doPrevStep():this.handlePrevSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doPrevStep=function(r){if(r===void 0&&(r=!1),this.player){this.player.prevStep(r);var o=this.player.mainSeqStep();this.__slideState.mainSeqStep=o,this.emitStateChange()}},t.prototype.isSlideStateReady=function(r){return r.taskId.length>0&&r.url.length>0&&r.currentSlideIndex>0},t.prototype.emitStateChange=function(){if(this.mode!=="local"&&!this.isSyncingSlideState){var r=this.slideState;!rw()(this.lastEmitedState,r)&&this.isSlideStateReady(r)&&(this.lastEmitedState=r,this.emit(lr.stateChange,r),this.logger.info("stateChange dispatch "+JSON.stringify(this.slideState),this.taskId))}},t.prototype.emitSyncDispatch=function(r){if(!this.lock.isLocked(r.type)){var o=Math.random().toString(32).substr(2);this.lock.addLock(r.type,o);var s=ps(ps({},r),{uuid:o,clientId:this.config.clientId});this.config.mode==="sync"&&(s.incrId=this.dispatchIncrId),this.emit(lr.syncDispatch,s),this.logger.info("sync dispatch "+JSON.stringify(s),this.taskId)}},t.prototype.setMainSeqStep=function(r,o){var s;(s=this.player)===null||s===void 0||s.setMainSeqStep(r,o)},t.prototype.setInteractive=function(r){var o;this.interactive=r,(o=this.player)===null||o===void 0||o.setInteractive(r)},t.prototype.pause=function(){var r;(r=this.player)===null||r===void 0||r.pause()},t.prototype.resume=function(){var r;(r=this.player)===null||r===void 0||r.resume()},t.prototype._doFrozen=function(){var r;return Xi(this,void 0,void 0,function(){var o,s,a,l=this;return Yi(this,function(h){switch(h.label){case 0:return this.logger.info("frozen with player["+!!this.player+"]",this.taskId),this.tracker({name:"frozenSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.view&&this.player?[4,this.player.clock.waitUntil(function(){return!l.isLoading},6e4)]:[3,2];case 1:for(s in h.sent(),o=this.player.getSnapshot()||"",this.cacheImage.src=o,this.frame.appendChild(this.cacheImage),this.player.destroy(),(r=this.playerController)===null||r===void 0||r.destroy(),this.player=void 0,this.__slideState.mediaState)a=this.__slideState.mediaState[s],this.__slideState.mediaState[s]=ps(ps({},a),{frozenTime:this.timestamp()});h.label=2;case 2:return[2]}})})},t.prototype.frozen=function(){var r=this;this.frozenTaskManager.addTask("frozen",function(){return r._doFrozen()})},t.prototype._doRelease=function(){var r,o;return Xi(this,void 0,void 0,function(){var s,a,l,h;return Yi(this,function(u){switch(u.label){case 0:if(this.logger.info("do release slide",this.taskId),this.tracker({name:"releaseSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.player)return[2];for(a in this.player=this.initPlayer(this.config),!((r=this.config)===null||r===void 0)&&r.controller&&this.createController(),this.player.view&&(this.canvasContainer.appendChild(this.player.view),this.player.view.style.visibility="hidden"),s=this.__slideState,this.__slideState=fg()(Vg),s.mediaState)(l=s.mediaState[a]).type==="play"&&(h=Math.max((o=l.frozenTime)!==null&&o!==void 0?o:0,l.time),l.time=this.timestamp()-(h-l.time),l.frozenTime=void 0);return[4,this.setSlideState(s)];case 1:return u.sent(),[4,this.player.clock.delay(333)];case 2:u.sent(),this.player.view&&(this.player.view.style.visibility="visible");try{this.frame.removeChild(this.cacheImage)}catch{this.logger.error("removeChild error Slide.ts:1934",this.taskId)}return[2]}})})},t.prototype.release=function(){var r=this;this.frozenTaskManager.addTask("release",function(){return r._doRelease()})},t.prototype._doDestroy=function(){var r,o,s,a,l=this;this.logger.info("do destroy slide",this.taskId),this.tracker({name:"destroySlide",reason:"",result:"",payload:{taskId:this.taskId}});var h=t.instances.findIndex(function(u){return u.randomId===l.randomId});if(h>=0&&t.instances.splice(h,1),this.playerController&&this.playerController.destroy(),this.frameResizeObserver.disconnect(),(r=this.player)===null||r===void 0||r.removeAllListeners(),(o=this.player)===null||o===void 0||o.destroy(),(s=this.player)===null||s===void 0||s.removeAllListeners(),this.logger={warn:function(){return{}},info:function(){return{}},error:function(){return{}}},this.syncQueue.destroy(),this.renderingTaskManager.destroy(),this.frozenTaskManager.destroy(),window.removeEventListener("__slide_ref__",this.handleSlideRef),window.removeEventListener("message",this.recoverHandler),this.removeAllListeners(),(a=this.player)===null||a===void 0?void 0:a.view)try{this.anchor.removeChild(this.player.view)}catch{this.logger.error("removeChild error Slide.ts:1982",this.taskId)}try{this.anchor.removeChild(this.frame)}catch{this.logger.error("removeChild error Slide.ts:1988",this.taskId)}t.volumeAdjuster.off("update",this._updateVolumeByStaticAdjuster)},t.prototype.waitLoadEnd=function(){return Xi(this,void 0,void 0,function(){var r;return Yi(this,function(o){switch(o.label){case 0:r=0,o.label=1;case 1:return this.isLoading&&r<10?[4,_h(100)]:[3,3];case 2:return o.sent(),r+=1,[3,1];case 3:return[2]}})})},t.prototype.preload=function(r){return this.player?this.player.preload(r):Promise.resolve()},t.prototype.destroy=function(){var r=this;this.logger.info("pre destroy slide",""),this.isLoading?this.waitLoadEnd().then(function(){r._doDestroy()}):this._doDestroy()},t.prototype.clearSlideCache=function(){var r;(r=this.player)===null||r===void 0||r.clearLocalCache()},t.prototype.hasNextStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===this.slideCount,o=this.mainSeqLength===0||this.mainSeqStep>=this.mainSeqLength-1,s=this.mainSeqState==="end"||this.mainSeqState==="running"||this.mainSeqState==null;return!(r&&o&&s)},t.prototype.hasPrevStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===1,o=this.mainSeqLength===0||this.mainSeqStep===0,s=this.mainSeqState==="idle"||this.mainSeqState===null;return!(r&&o&&s)},t.prototype.snapshot=function(){return Xi(this,void 0,void 0,function(){return Yi(this,function(r){return this.player?[2,this.player.getSnapshot()]:[2,null]})})},t.prototype.snapshotWithTimingEnd=function(r){return Xi(this,void 0,void 0,function(){return Yi(this,function(o){return this.player?[2,this.player.snapshotWithTimingEnd(r)]:[2,null]})})},t.prototype.updateGlobalVolume=function(r){this.volumeAdjuster.volume=r},t.prototype.getGlobalVolume=function(){return this.volumeAdjuster.volume},t.clearLocalCache=function(){ar.clearLocalCache()},t.disposeLocalCache=function(){},e=t,t.preloadResource=Vw,t.instances=[],t._tempFrozenIds=[],t._tempLog="",t._tempLogIndex=1,t.remoteLogAddress=null,t.usePlugin=function(r){r.context({logger:{info:function(o){t.appendLogString("INFO - "+new Date().toISOString()+" - "+o+`
`)},warn:function(o){t.appendLogString("WARN - "+new Date().toISOString()+" - "+o+`
`)},error:function(o){t.appendLogString("ERROR - "+new Date().toISOString()+" - "+o+`
`)}}}),function(o){var s=oc.get(o.hookPoint)||[];s.push(o),oc.set(o.hookPoint,s)}(r)},t.volumeAdjuster=new dg,t.trackLogger=new Hw,t.handleFrozenAllSlide=function(){t.instances.forEach(function(r){r.player&&(t._tempFrozenIds.push(r.randomId),r.frozen())})},t.handleReleaseAllSlide=function(){t._tempFrozenIds.forEach(function(r){var o=t.instances.find(function(s){return s.randomId===r});o&&o.release()}),t._tempFrozenIds=[]},t.handleLogReport=function(r){return Xi(void 0,void 0,void 0,function(){var o,s,a,l,h,u;return Yi(e,function(p){switch(p.label){case 0:return[4,t.flushLog(!0)];case 1:if(p.sent(),!cr)return[3,12];o=[],p.label=2;case 2:return p.trys.push([2,4,,5]),[4,cr.keys()];case 3:return o=(p.sent()||[]).sort(function(_,x){return parseInt(_.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),[3,5];case 4:return p.sent(),[3,5];case 5:if(o.length===0)return window.postMessage({type:"@slide/_report_log_",log:"",index:1,total:1,customMessage:"@slide/_report_log_",sessionId:r},"*"),[2];s=0,a=o,p.label=6;case 6:if(!(s<a.length))return[3,12];l=a[s],h=l.replace("run_time_log_",""),u="",p.label=7;case 7:return p.trys.push([7,9,,10]),[4,cr.getItem(l)];case 8:return u=p.sent()||"",[3,10];case 9:return p.sent(),[3,10];case 10:window.postMessage({type:"@slide/_report_log_",log:u,index:parseInt(h,10),total:o.length,customMessage:"@slide/_report_log_",sessionId:r},"*"),p.label=11;case 11:return s++,[3,6];case 12:return[2]}})})},t.handleLogDownload=function(){return Xi(void 0,void 0,void 0,function(){var r,o,s,a,l,h,u;return Yi(e,function(p){switch(p.label){case 0:return p.trys.push([0,7,,8]),[4,t.flushLog(!0)];case 1:return p.sent(),r="",cr?[4,cr.keys()]:[3,6];case 2:o=(p.sent()||[]).sort(function(_,x){return parseInt(_.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),s=0,a=o,p.label=3;case 3:return s<a.length?(l=a[s],h=r,[4,cr.getItem(l)]):[3,6];case 4:r=h+(p.sent()||""),p.label=5;case 5:return s++,[3,3];case 6:return(u=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(r)),u.setAttribute("download","slide_log"),u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),[3,8];case 7:return p.sent(),[3,8];case 8:return[2]}})})},Xw([(n="Slide.initConfig",function(r,o,s){var a=s.value;s.value=function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];for(var u=oc.get(n)||[],p=l,_=0,x=u;_<x.length;_++){var w=x[_];try{p=w.before(p)}catch{}if(!Array.isArray(p)||p.length!==l.length)throw new Error("plugin before hook return invalid args")}for(var M=a.bind(this).apply(void 0,p),C=0,G=u.reverse();C<G.length;C++){w=G[C];try{M=w.after(M)}catch{}if(!M)throw new Error("plugin after hook return undefined result")}return M}})],t.prototype,"initSlideConfig",null),t}(yi.a);cr==null||cr.clear().catch(function(){}),window.addEventListener("__slide_log__",to.handleLogDownload),window.addEventListener("message",function(i){if(i.data.type==="@slide/_request_log_")to.handleLogReport(i.data.sessionId).catch(function(){});else if(i.data.type==="@slide/_request_frozen_")to.handleFrozenAllSlide();else if(i.data.type==="@slide/_request_release_")to.handleReleaseAllSlide();else if(i.data.type==="@slide/_update_volume_"){var t=.5;try{t=parseFloat(i.data.volume.toString())}catch{}to.volumeAdjuster.volume=t}else i.data.type==="@slide/_get_volume_"?window.postMessage({type:"@slide/_report_volume_",volume:to.volumeAdjuster.volume,customMessage:"@slide/_report_volume_"},"*"):i.data.type==="@slide/_preload_slide_"&&to.preloadResource(i.data.taskId,i.data.prefix,i.data.maxResolutionLevel,function(e){window.postMessage({type:"@slide/_preload_slide_progress_",taskId:i.data.taskId,progress:e},"*")}).catch(function(e){window.postMessage({type:"@slide/_preload_slide_error_",taskId:i.data.taskId,error:e},"*")})}),window.setInterval(function(){to.flushLog().catch(function(){})},2e3)}]);const eE="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",nE=87,iE=20,rv=[],rE=()=>{for(let b=0;b<iE;b++)rv[b]=eE.charAt(Math.random()*nE);return rv.join("")};function dv(b){try{return b()}catch(E){console.error(E)}}class Za{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(E,v=this.genUID()){return this.flush(v),this.disposers.set(v,Array.isArray(E)?oE(E):E),v}add(E,v=this.genUID()){const O=E();return O?this.addDisposer(O,v):v}addEventListener(E,v,O,S,I=this.genUID()){return E.addEventListener(v,O,S),this.addDisposer(()=>E.removeEventListener(v,O,S),I),I}setTimeout(E,v,O=this.genUID()){const S=window.setTimeout(()=>{this.remove(O),E()},v);return this.addDisposer(()=>window.clearTimeout(S),O)}setInterval(E,v,O=this.genUID()){const S=window.setInterval(E,v);return this.addDisposer(()=>window.clearInterval(S),O)}remove(E){const v=this.disposers.get(E);return this.disposers.delete(E),v}flush(E){const v=this.remove(E);v&&v()}flushAll(){this.disposers.forEach(dv),this.disposers.clear()}genUID(){let E;do E=rE();while(this.disposers.has(E));return E}}function oE(b){return()=>b.forEach(dv)}function pv(b,E,v){return Math.min(Math.max(b,E),v)}function sE(b){return typeof b=="object"&&b!==null}function aE(b){if(!b)return!1;const E=b.tagName;return E==="INPUT"||E==="TEXTAREA"||E==="SELECT"}var fv={exports:{}},lE={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},mv={exports:{}},hE=function(E){return!E||typeof E=="string"?!1:E instanceof Array||Array.isArray(E)||E.length>=0&&(E.splice instanceof Function||Object.getOwnPropertyDescriptor(E,E.length-1)&&E.constructor.name!=="String")},uE=hE,cE=Array.prototype.concat,dE=Array.prototype.slice,ov=mv.exports=function(E){for(var v=[],O=0,S=E.length;O<S;O++){var I=E[O];uE(I)?v=cE.call(v,dE.call(I)):v.push(I)}return v};ov.wrap=function(b){return function(){return b(ov(arguments))}};var qa=lE,Ka=mv.exports,gv=Object.hasOwnProperty,vv=Object.create(null);for(var Mc in qa)gv.call(qa,Mc)&&(vv[qa[Mc]]=Mc);var Er=fv.exports={to:{},get:{}};Er.get=function(b){var E=b.substring(0,3).toLowerCase(),v,O;switch(E){case"hsl":v=Er.get.hsl(b),O="hsl";break;case"hwb":v=Er.get.hwb(b),O="hwb";break;default:v=Er.get.rgb(b),O="rgb";break}return v?{model:O,value:v}:null};Er.get.rgb=function(b){if(!b)return null;var E=/^#([a-f0-9]{3,4})$/i,v=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,O=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,S=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,I=/^(\w+)$/,D=[0,0,0,1],F,z,J;if(F=b.match(v)){for(J=F[2],F=F[1],z=0;z<3;z++){var X=z*2;D[z]=parseInt(F.slice(X,X+2),16)}J&&(D[3]=parseInt(J,16)/255)}else if(F=b.match(E)){for(F=F[1],J=F[3],z=0;z<3;z++)D[z]=parseInt(F[z]+F[z],16);J&&(D[3]=parseInt(J+J,16)/255)}else if(F=b.match(O)){for(z=0;z<3;z++)D[z]=parseInt(F[z+1],0);F[4]&&(F[5]?D[3]=parseFloat(F[4])*.01:D[3]=parseFloat(F[4]))}else if(F=b.match(S)){for(z=0;z<3;z++)D[z]=Math.round(parseFloat(F[z+1])*2.55);F[4]&&(F[5]?D[3]=parseFloat(F[4])*.01:D[3]=parseFloat(F[4]))}else return(F=b.match(I))?F[1]==="transparent"?[0,0,0,0]:gv.call(qa,F[1])?(D=qa[F[1]],D[3]=1,D):null:null;for(z=0;z<3;z++)D[z]=zo(D[z],0,255);return D[3]=zo(D[3],0,1),D};Er.get.hsl=function(b){if(!b)return null;var E=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(E);if(v){var O=parseFloat(v[4]),S=(parseFloat(v[1])%360+360)%360,I=zo(parseFloat(v[2]),0,100),D=zo(parseFloat(v[3]),0,100),F=zo(isNaN(O)?1:O,0,1);return[S,I,D,F]}return null};Er.get.hwb=function(b){if(!b)return null;var E=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(E);if(v){var O=parseFloat(v[4]),S=(parseFloat(v[1])%360+360)%360,I=zo(parseFloat(v[2]),0,100),D=zo(parseFloat(v[3]),0,100),F=zo(isNaN(O)?1:O,0,1);return[S,I,D,F]}return null};Er.to.hex=function(){var b=Ka(arguments);return"#"+xh(b[0])+xh(b[1])+xh(b[2])+(b[3]<1?xh(Math.round(b[3]*255)):"")};Er.to.rgb=function(){var b=Ka(arguments);return b.length<4||b[3]===1?"rgb("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+")":"rgba("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+", "+b[3]+")"};Er.to.rgb.percent=function(){var b=Ka(arguments),E=Math.round(b[0]/255*100),v=Math.round(b[1]/255*100),O=Math.round(b[2]/255*100);return b.length<4||b[3]===1?"rgb("+E+"%, "+v+"%, "+O+"%)":"rgba("+E+"%, "+v+"%, "+O+"%, "+b[3]+")"};Er.to.hsl=function(){var b=Ka(arguments);return b.length<4||b[3]===1?"hsl("+b[0]+", "+b[1]+"%, "+b[2]+"%)":"hsla("+b[0]+", "+b[1]+"%, "+b[2]+"%, "+b[3]+")"};Er.to.hwb=function(){var b=Ka(arguments),E="";return b.length>=4&&b[3]!==1&&(E=", "+b[3]),"hwb("+b[0]+", "+b[1]+"%, "+b[2]+"%"+E+")"};Er.to.keyword=function(b){return vv[b.slice(0,3)]};function zo(b,E,v){return Math.min(Math.max(E,b),v)}function xh(b){var E=Math.round(b).toString(16).toUpperCase();return E.length<2?"0"+E:E}var pE=fv.exports;class fE{constructor(E){this.enable=E,this.apps={},this.level="debug",this.roomLogger=null,this._onMessage=v=>{let O;v instanceof CustomEvent?O=v.detail:sE(v.data)&&(O=v.data),O&&(typeof O.slide=="boolean"?this.enable=O.slide:O.slide==="__instance"?console.log(this):O.slide==="__debug"&&Object.values(this.apps).forEach(S=>{var I,D;(D=(I=S.controller)==null?void 0:I.slide)==null||D.createController()}))},this.initialize()}setAppContext(E,v){var O;((O=this.apps)[E]||(O[E]={})).context=v,this.log(`[Slide] new ${E}`)}setAppController(E,v){var O;((O=this.apps)[E]||(O[E]={})).controller=v}deleteApp(E){delete this.apps[E],this.log(`[Slide] delete ${E}`)}initialize(){window.addEventListener("message",this._onMessage)}dispose(){window.removeEventListener("message",this._onMessage)}log(...E){this.roomLogger?this.roomLogger.info(...E):this.enable&&console.log(...E)}verbose(...E){this.roomLogger?this.roomLogger.debug(...E):this.enable&&this.level==="verbose"&&console.log(...E)}warn(...E){this.roomLogger?this.roomLogger.warn(...E):console.warn(...E)}}const Nr=new fE(!1),Pi=Nr.log.bind(Nr),Cc=Nr.verbose.bind(Nr),mE=b=>{Nr.roomLogger=b.logger};function _v(b){try{const E=window.getComputedStyle(b).backgroundColor;if(E!=="rgba(0, 0, 0, 0)"&&E!=="transparent")return E;if(b.parentElement)return _v(b.parentElement)}catch{}return"#ffffff"}function gE(b){const E=pE.get(b);if(E&&E.model==="rgb"){const v=E.value,S=(((Math.round(v[0])&255)<<16)+((Math.round(v[1])&255)<<8)+(Math.round(v[2])&255)).toString(16);return"#"+"000000".substring(S.length)+S}else return b}let bh="";function yv(b){return bh||(bh=gE(_v(b)),Pi("[Slide] guess bg color",bh)),bh}const vE=b=>b.tracker;function xv(b,E=[]){const{width:v,height:O,slideCount:S,slideState:I}=b,{taskId:D,url:F}=I,z=[];for(let J=1;J<=S;++J){const X=E.find(et=>et.indexOf(`preview/${J}.png`)>=0);X?z.push({width:v,height:O,thumbnail:X,src:"ppt"}):z.push({width:v,height:O,thumbnail:`${F}/${D}/preview/${J}.png`,src:"ppt"})}return z}function sv(b,E,v,O){var F;const S=v.slideState.currentSlideIndex;if(!(S>0)||!E.getIsWritable())return;const I=[O,S].join("/");if(b.scenePathType(I)!=="page"){b.removeScenes(O);const z=v.slideCount,J=[];for(let X=1;X<=z;++X)J.push({name:`${X}`});b.putScenes(O,J)}let D;E.getBox().focus?D=b.state.sceneState.scenePath:D=((F=E.getView())==null?void 0:F.focusScenePath)||"",D!==I&&E.setScenePath(I)}const Dc="https://convertcdn.netless.link/dynamicConvert",_E=40,Rc={taskId:"",url:"",state:null,resourceList:[],previewList:[]},yE=function(){};class xE{constructor({context:E,anchor:v,onRenderStart:O,onPageChanged:S,onTransitionStart:I,onTransitionEnd:D,onNavigate:F,onError:z,onRenderError:J,showRenderError:X,invisibleBehavior:et}){this.sideEffect=new Za,this.previewList=[],this.ready=!1,this.readyPromise=new Promise(ut=>{this.resolveReady=()=>{this.ready?Pi("[Slide] render end"):setTimeout(()=>{this.ready=!0,ut()},1e3)}}),this.onSyncDispatch=ut=>{if(this.context.getIsWritable()&&this.room){const Rt={type:li.SLIDE_EVENTS.syncDispatch,payload:ut};Cc("[Slide] dispatch",JSON.stringify(ut)),this.context.dispatchMagixEvent(li.SLIDE_EVENTS.syncDispatch,Rt)}},this.magixEventListener=ut=>{const{type:Rt,payload:St}=ut.payload;Rt===li.SLIDE_EVENTS.syncDispatch&&(this.syncStateOnce(),Cc("[Slide] receive",JSON.stringify(St)),this.slide.emit(li.SLIDE_EVENTS.syncReceive,St))},this.onStateChange=ut=>{this.context.getIsWritable()&&(Cc("[Slide] state change",JSON.stringify(ut,null,2)),this.context.storage.setState({state:ut}))},this.pollCount=0,this.pollReadyState=()=>{this.ready?this._toFreeze===1?this.freeze():this._toFreeze===-1&&this.unfreeze():this.pollCount<_E?(this.pollCount++,setTimeout(this.pollReadyState,500)):(this.pollCount=0,Pi("[Slide] init timeout"))},this._pageCount=0,this.destroyed=!1,this.timestamp=()=>this.room&&this.room.calibrationTimestamp?this.room.calibrationTimestamp:this.player?this.player.beginTimestamp+this.player.progressTime:Date.now(),this.isFrozen=!1,this._toFreeze=0,this.freeze=()=>{this.isFrozen=!0,this.ready?(Pi("[Slide] freeze",this.context.appId),this.invisibleBehavior==="frozen"?this.slide.frozen():this.slide.pause()):this._toFreeze=1},this.unfreeze=async()=>{var ut;if(!!this.visible)if(this.isFrozen=!1,this.ready){Pi("[Slide] unfreeze",this.context.appId),this.invisibleBehavior==="frozen"?this.slide.release():this.slide.resume();const Rt=(ut=this.context.storage.state.state)==null?void 0:ut.currentSlideIndex;Rt&&(Pi("[Slide] sync storage",Rt),this.slide.setSlideState({currentSlideIndex:Rt}))}else this._toFreeze=-1},this.onVisibilityChange=async()=>{(this.visible=document.visibilityState==="visible")?(Pi("[Slide] unfreeze because tab becomes visible",{savedIsFrozen:this.savedIsFrozen}),this.savedIsFrozen||this.unfreeze()):(this.savedIsFrozen=this.isFrozen,Pi("[Slide] freeze because tab becomes invisible"),this.freeze())},this.invisibleBehavior=et!=null?et:"frozen",this.onRenderStart=O,this.onPageChanged=S,this.onTransitionStart=I,this.onTransitionEnd=D,this.onNavigate=F||yE,this.onError=z,this.onRenderError=J,this.showRenderError=X!=null?X:!0,this.context=E,this.room=E.getRoom(),this.player=this.room?void 0:E.getDisplayer(),mE(this.room||this.player),this.slide=this.createSlide(v,{whiteTracker:vE(E.getDisplayer())}),this.syncStateOnceFlag=!this.context.isAddApp,this.visible=document.visibilityState==="visible",this.savedIsFrozen=!1,this.initialize()}jumpToPage(E,v){this.ready&&(E=pv(E,1,this.pageCount),this.onNavigate(E,v),this.slide.renderSlide(E))}initialize(){this.registerEventListeners(),this.kickStart()}kickStart(){const{context:E,slide:v}=this;E.getIsWritable()&&E.storage.ensureState(Rc);const{taskId:O,url:S,resourceList:I,previewList:D,state:F}=E.storage.state;this.previewList=D,I&&I.length>0?v.setResourceList(O,I):v.setResource(O,S||Dc),F?(Pi("[Slide] init with state",JSON.stringify(F)),this.syncStateOnceFlag=!1,v.setSlideState(F)):E.isAddApp&&(Pi("[Slide] init by renderSlide",1),v.renderSlide(1)),this.pollReadyState()}registerEventListeners(){const{context:E,slide:v}=this,O=this.sideEffect.addDisposer(E.storage.addStateChangedListener(()=>{E.storage.state.state&&(this.syncStateOnce(),this.sideEffect.flush(O))}));this.sideEffect.add(()=>E.addMagixEventListener(li.SLIDE_EVENTS.syncDispatch,this.magixEventListener,{fireSelfEventAfterCommit:!0})),v.on(li.SLIDE_EVENTS.renderStart,this.onRenderStart),v.on(li.SLIDE_EVENTS.slideChange,this.onPageChanged),v.on(li.SLIDE_EVENTS.renderEnd,this.onTransitionEnd),v.on(li.SLIDE_EVENTS.mainSeqStepStart,this.onTransitionStart),v.on(li.SLIDE_EVENTS.mainSeqStepEnd,this.onTransitionEnd),v.on(li.SLIDE_EVENTS.renderError,this.onError),v.on(li.SLIDE_EVENTS.stateChange,this.onStateChange),v.on(li.SLIDE_EVENTS.syncDispatch,this.onSyncDispatch),v.on(li.SLIDE_EVENTS.renderEnd,this.resolveReady),this.sideEffect.add(()=>(document.addEventListener("visibilitychange",this.onVisibilityChange),()=>document.removeEventListener("visibilitychange",this.onVisibilityChange)))}syncStateOnce(){if(this.syncStateOnceFlag){this.context.getIsWritable()&&this.context.storage.ensureState(Rc);const{state:E}=this.context.storage.state;E&&(Pi("[Slide] sync with state (once)",JSON.stringify(E)),this.slide.setSlideState(E),this.syncStateOnceFlag=!1)}}get pageCount(){return this._pageCount>0?this._pageCount:(this._pageCount=this.slide.slideCount,this._pageCount)}get page(){return this.slide.slideState.currentSlideIndex}createSlide(E,v={}){var I,D,F;const O=this.context.getAppOptions()||{};return new li.Slide({anchor:E,interactive:!0,mode:"interactive",controller:Nr.enable,enableGlobalClick:(I=O.enableGlobalClick)!=null?I:!0,renderOptions:{minFPS:O.minFPS||25,maxFPS:O.maxFPS||30,autoFPS:(D=O.autoFPS)!=null?D:!0,autoResolution:(F=O.autoResolution)!=null?F:!0,resolution:O.resolution,transactionBgColor:O.bgColor||yv(E),maxResolutionLevel:O.maxResolutionLevel,forceCanvas:O.forceCanvas,enableNvidiaDetect:O.enableNvidiaDetect},fixedFrameSize:O.fixedFrameSize,loaderDelegate:O.loaderDelegate,navigatorDelegate:O.navigatorDelegate,urlInterrupter:O.urlInterrupter,resourceTimeout:O.resourceTimeout,rtcAudio:O.rtcAudio,useLocalCache:O.useLocalCache,logger:O.logger,whiteTracker:v.whiteTracker,timestamp:this.timestamp})}destroy(){this.sideEffect.flushAll(),this.destroyed||(Pi("[Slide] destroy slide (once)"),this.slide.destroy(),this.destroyed=!0)}}function bE(b){const E="http://www.w3.org/2000/svg",v=document.createElementNS(E,"svg");return v.setAttribute("class",`${b}-footer-icon-arrow-left`),v.setAttribute("viewBox","0 0 20 20"),v.innerHTML=`<g clip-path="url(#clip0_11800_99864)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5283 4.86182L12.4711 5.80463L8.22849 10.0473L12.4711 14.2899L11.5283 15.2327L6.34287 10.0473L11.5283 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99864">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,v}function TE(b){const E="http://www.w3.org/2000/svg",v=document.createElementNS(E,"svg");return v.setAttribute("class",`${b}-footer-icon-arrow-right`),v.setAttribute("viewBox","0 0 20 20"),v.innerHTML=`<g clip-path="url(#clip0_11800_99870)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.1377 4.86182L7.19489 5.80463L11.4375 10.0473L7.19489 14.2899L8.1377 15.2327L13.3231 10.0473L8.1377 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99870">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,v}const Wo=typeof window!="undefined",bv=Wo&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),Tv=Wo&&"IntersectionObserver"in window,wv=Wo&&"classList"in document.createElement("p"),Ev=Wo&&window.devicePixelRatio>1,wE={elements_selector:".lazy",container:bv||Wo?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},Sv=b=>Object.assign({},wE,b),av=function(b,E){let v;const O="LazyLoad::Initialized",S=new b(E);try{v=new CustomEvent(O,{detail:{instance:S}})}catch{v=document.createEvent("CustomEvent"),v.initCustomEvent(O,!1,!1,{instance:S})}window.dispatchEvent(v)},EE=(b,E)=>{if(!!E)if(!E.length)av(b,E);else for(let v=0,O;O=E[v];v+=1)av(b,O)},po="src",Fc="srcset",Bc="sizes",Av="poster",Qa="llOriginalAttrs",Mv="data",kc="loading",Cv="loaded",Rv="applied",SE="entered",Uc="error",Iv="native",Pv="data-",Ov="ll-status",fr=(b,E)=>b.getAttribute(Pv+E),AE=(b,E,v)=>{var O=Pv+E;if(v===null){b.removeAttribute(O);return}b.setAttribute(O,v)},$a=b=>fr(b,Ov),gs=(b,E)=>AE(b,Ov,E),Eh=b=>gs(b,null),Gc=b=>$a(b)===null,ME=b=>$a(b)===kc,CE=b=>$a(b)===Uc,Hc=b=>$a(b)===Iv,RE=[kc,Cv,Rv,Uc],IE=b=>RE.indexOf($a(b))>=0,Xo=(b,E,v,O)=>{if(!!b){if(O!==void 0){b(E,v,O);return}if(v!==void 0){b(E,v);return}b(E)}},ta=(b,E)=>{if(wv){b.classList.add(E);return}b.className+=(b.className?" ":"")+E},no=(b,E)=>{if(wv){b.classList.remove(E);return}b.className=b.className.replace(new RegExp("(^|\\s+)"+E+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},PE=b=>{b.llTempImage=document.createElement("IMG")},OE=b=>{delete b.llTempImage},Nv=b=>b.llTempImage,Sh=(b,E)=>{if(!E)return;const v=E._observer;!v||v.unobserve(b)},NE=b=>{b.disconnect()},LE=(b,E,v)=>{E.unobserve_entered&&Sh(b,v)},jc=(b,E)=>{!b||(b.loadingCount+=E)},DE=b=>{!b||(b.toLoadCount-=1)},Lv=(b,E)=>{!b||(b.toLoadCount=E)},FE=b=>b.loadingCount>0,BE=b=>b.toLoadCount>0,Dv=b=>{let E=[];for(let v=0,O;O=b.children[v];v+=1)O.tagName==="SOURCE"&&E.push(O);return E},zc=(b,E)=>{const v=b.parentNode;if(!v||v.tagName!=="PICTURE")return;Dv(v).forEach(E)},Fv=(b,E)=>{Dv(b).forEach(E)},Ah=[po],Bv=[po,Av],Ja=[po,Fc,Bc],kv=[Mv],Mh=b=>!!b[Qa],Uv=b=>b[Qa],Gv=b=>delete b[Qa],$s=(b,E)=>{if(Mh(b))return;const v={};E.forEach(O=>{v[O]=b.getAttribute(O)}),b[Qa]=v},kE=b=>{Mh(b)||(b[Qa]={backgroundImage:b.style.backgroundImage})},UE=(b,E,v)=>{if(!v){b.removeAttribute(E);return}b.setAttribute(E,v)},ms=(b,E)=>{if(!Mh(b))return;const v=Uv(b);E.forEach(O=>{UE(b,O,v[O])})},GE=b=>{if(!Mh(b))return;const E=Uv(b);b.style.backgroundImage=E.backgroundImage},Hv=(b,E,v)=>{ta(b,E.class_applied),gs(b,Rv),v&&(E.unobserve_completed&&Sh(b,E),Xo(E.callback_applied,b,v))},jv=(b,E,v)=>{ta(b,E.class_loading),gs(b,kc),v&&(jc(v,1),Xo(E.callback_loading,b,v))},Vo=(b,E,v)=>{!v||b.setAttribute(E,v)},lv=(b,E)=>{Vo(b,Bc,fr(b,E.data_sizes)),Vo(b,Fc,fr(b,E.data_srcset)),Vo(b,po,fr(b,E.data_src))},HE=(b,E)=>{zc(b,v=>{$s(v,Ja),lv(v,E)}),$s(b,Ja),lv(b,E)},jE=(b,E)=>{$s(b,Ah),Vo(b,po,fr(b,E.data_src))},zE=(b,E)=>{Fv(b,v=>{$s(v,Ah),Vo(v,po,fr(v,E.data_src))}),$s(b,Bv),Vo(b,Av,fr(b,E.data_poster)),Vo(b,po,fr(b,E.data_src)),b.load()},VE=(b,E)=>{$s(b,kv),Vo(b,Mv,fr(b,E.data_src))},WE=(b,E,v)=>{const O=fr(b,E.data_bg),S=fr(b,E.data_bg_hidpi),I=Ev&&S?S:O;!I||(b.style.backgroundImage=`url("${I}")`,Nv(b).setAttribute(po,I),jv(b,E,v))},XE=(b,E,v)=>{const O=fr(b,E.data_bg_multi),S=fr(b,E.data_bg_multi_hidpi),I=Ev&&S?S:O;!I||(b.style.backgroundImage=I,Hv(b,E,v))},YE=(b,E,v)=>{const O=fr(b,E.data_bg_set);if(!O)return;const S=O.split("|");let I=S.map(D=>`image-set(${D})`);b.style.backgroundImage=I.join(),b.style.backgroundImage===""&&(I=S.map(D=>`-webkit-image-set(${D})`),b.style.backgroundImage=I.join()),Hv(b,E,v)},zv={IMG:HE,IFRAME:jE,VIDEO:zE,OBJECT:VE},qE=(b,E)=>{const v=zv[b.tagName];!v||v(b,E)},JE=(b,E,v)=>{const O=zv[b.tagName];!O||(O(b,E),jv(b,E,v))},ZE=["IMG","IFRAME","VIDEO","OBJECT"],KE=b=>ZE.indexOf(b.tagName)>-1,Vv=(b,E)=>{E&&!FE(E)&&!BE(E)&&Xo(b.callback_finish,E)},hv=(b,E,v)=>{b.addEventListener(E,v),b.llEvLisnrs[E]=v},QE=(b,E,v)=>{b.removeEventListener(E,v)},Vc=b=>!!b.llEvLisnrs,$E=(b,E,v)=>{Vc(b)||(b.llEvLisnrs={});const O=b.tagName==="VIDEO"?"loadeddata":"load";hv(b,O,E),hv(b,"error",v)},Ic=b=>{if(!Vc(b))return;const E=b.llEvLisnrs;for(let v in E){const O=E[v];QE(b,v,O)}delete b.llEvLisnrs},Wv=(b,E,v)=>{OE(b),jc(v,-1),DE(v),no(b,E.class_loading),E.unobserve_completed&&Sh(b,v)},tS=(b,E,v,O)=>{const S=Hc(E);Wv(E,v,O),ta(E,v.class_loaded),gs(E,Cv),Xo(v.callback_loaded,E,O),S||Vv(v,O)},eS=(b,E,v,O)=>{const S=Hc(E);Wv(E,v,O),ta(E,v.class_error),gs(E,Uc),Xo(v.callback_error,E,O),v.restore_on_error&&ms(E,Ja),S||Vv(v,O)},Wc=(b,E,v)=>{const O=Nv(b)||b;if(Vc(O))return;$E(O,D=>{tS(D,b,E,v),Ic(O)},D=>{eS(D,b,E,v),Ic(O)})},nS=(b,E,v)=>{PE(b),Wc(b,E,v),kE(b),WE(b,E,v),XE(b,E,v),YE(b,E,v)},iS=(b,E,v)=>{Wc(b,E,v),JE(b,E,v)},Xc=(b,E,v)=>{KE(b)?iS(b,E,v):nS(b,E,v)},rS=(b,E,v)=>{b.setAttribute("loading","lazy"),Wc(b,E,v),qE(b,E),gs(b,Iv)},uv=b=>{b.removeAttribute(po),b.removeAttribute(Fc),b.removeAttribute(Bc)},oS=b=>{zc(b,E=>{uv(E)}),uv(b)},Xv=b=>{zc(b,E=>{ms(E,Ja)}),ms(b,Ja)},sS=b=>{Fv(b,E=>{ms(E,Ah)}),ms(b,Bv),b.load()},aS=b=>{ms(b,Ah)},lS=b=>{ms(b,kv)},hS={IMG:Xv,IFRAME:aS,VIDEO:sS,OBJECT:lS},uS=b=>{const E=hS[b.tagName];if(!E){GE(b);return}E(b)},cS=(b,E)=>{Gc(b)||Hc(b)||(no(b,E.class_entered),no(b,E.class_exited),no(b,E.class_applied),no(b,E.class_loading),no(b,E.class_loaded),no(b,E.class_error))},dS=(b,E)=>{uS(b),cS(b,E),Eh(b),Gv(b)},pS=(b,E,v,O)=>{!v.cancel_on_exit||!ME(b)||b.tagName==="IMG"&&(Ic(b),oS(b),Xv(b),no(b,v.class_loading),jc(O,-1),Eh(b),Xo(v.callback_cancel,b,E,O))},fS=(b,E,v,O)=>{const S=IE(b);gs(b,SE),ta(b,v.class_entered),no(b,v.class_exited),LE(b,v,O),Xo(v.callback_enter,b,E,O),!S&&Xc(b,v,O)},mS=(b,E,v,O)=>{Gc(b)||(ta(b,v.class_exited),pS(b,E,v,O),Xo(v.callback_exit,b,E,O))},gS=["IMG","IFRAME","VIDEO"],Yv=b=>b.use_native&&"loading"in HTMLImageElement.prototype,vS=(b,E,v)=>{b.forEach(O=>{gS.indexOf(O.tagName)!==-1&&rS(O,E,v)}),Lv(v,0)},_S=b=>b.isIntersecting||b.intersectionRatio>0,yS=b=>({root:b.container===document?null:b.container,rootMargin:b.thresholds||b.threshold+"px"}),xS=(b,E,v)=>{b.forEach(O=>_S(O)?fS(O.target,O,E,v):mS(O.target,O,E,v))},bS=(b,E)=>{E.forEach(v=>{b.observe(v)})},TS=(b,E)=>{NE(b),bS(b,E)},wS=(b,E)=>{!Tv||Yv(b)||(E._observer=new IntersectionObserver(v=>{xS(v,b,E)},yS(b)))},qv=b=>Array.prototype.slice.call(b),Th=b=>b.container.querySelectorAll(b.elements_selector),ES=b=>qv(b).filter(Gc),SS=b=>CE(b),AS=b=>qv(b).filter(SS),cv=(b,E)=>ES(b||Th(E)),MS=(b,E)=>{AS(Th(b)).forEach(O=>{no(O,b.class_error),Eh(O)}),E.update()},CS=(b,E)=>{!Wo||(E._onlineHandler=()=>{MS(b,E)},window.addEventListener("online",E._onlineHandler))},RS=b=>{!Wo||window.removeEventListener("online",b._onlineHandler)},tl=function(b,E){const v=Sv(b);this._settings=v,this.loadingCount=0,wS(v,this),CS(v,this),this.update(E)};tl.prototype={update:function(b){const E=this._settings,v=cv(b,E);if(Lv(this,v.length),bv||!Tv){this.loadAll(v);return}if(Yv(E)){vS(v,E,this);return}TS(this._observer,v)},destroy:function(){this._observer&&this._observer.disconnect(),RS(this),Th(this._settings).forEach(b=>{Gv(b)}),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(b){const E=this._settings;cv(b,E).forEach(O=>{Sh(O,this),Xc(O,E,this)})},restoreAll:function(){const b=this._settings;Th(b).forEach(E=>{dS(E,b)})}};tl.load=(b,E)=>{const v=Sv(E);Xc(b,v)};tl.resetStatus=b=>{Eh(b)};Wo&&EE(tl,window.lazyLoadOptions);function IS(b){return b.map(E=>{const v=`
      text-align: ${E.align==="l"?"left":E.align};
      text-indent: ${E.indent}px;
      margin-left: ${E.marginLeft}px;
      margin-right: ${E.marginRight}px;
    `,O=E.runs.map(S=>{const I=`word-spacing: ${S.wordSpace}px; baseline-shift: ${S.baseline}px;`;let F=S.text.split(/(https?:\/\/[^\s]+)/g).map(z=>/^https?:\/\/[^\s]+$/.test(z)?`<a href="${z}" onclick="return false;">${z}</a>`:z).join("");return S.bold&&(F=`<strong>${F}</strong>`),S.italic&&(F=`<em>${F}</em>`),`<span style="${I}">${F}</span>`}).join("");return`<div style="${v}">${O}</div>`}).join("")}class Jv{constructor({readonly:E,onNewPageIndex:v,onPlay:O,onPagesReady:S,urlInterrupter:I,box:D,context:F}){this._pages=[],this.pageIndex=0,this.setPaused=()=>{},this.setPlaying=()=>{},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new Za,this.readonly=E,this.onNewPageIndex=v,this.onPlay=O,this.onPagesReady=S,this.urlInterrupter=I||(z=>z),this.box=D,this.context=F,this.render()}set pages(E){this._pages=E,this.refreshPreview().then(this.refreshBtnSidebar.bind(this)),this.refreshTotalPage(),this.onPagesReady&&this.onPagesReady(E)}get pages(){return this._pages}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(E){this.readonly=E,this.$content.classList.toggle(this.wrapClassName("readonly"),E),this.$footer.classList.toggle(this.wrapClassName("readonly"),E)}destroy(){var E;(E=this.previewLazyLoad)==null||E.destroy(),this.sideEffect.flushAll(),this.unmount()}setPageIndex(E){Number.isNaN(E)||(this.scrollPreview(E),this.pageIndex=E,this.$pageNumberInput.textContent=String(E+1),this.$btnPageBack.classList.toggle(this.wrapClassName("footer-btn-disable"),E==0),this.$btnPageNext.classList.toggle(this.wrapClassName("footer-btn-disable"),E==this.pages.length-1),this.renderNoteContent())}scrollPreview(E){var F;const v=(F=this.$preview)==null?void 0:F.querySelectorAll("."+this.wrapClassName("preview-page"));v==null||v.forEach((z,J)=>{var X;(X=z.querySelector("img"))==null||X.classList.toggle(this.wrapClassName("active"),Number(E)==J)});const O=Array.prototype.slice.call(v).find(z=>z.querySelector("img").className.includes(this.wrapClassName("active")));if(!O)return;const S=this.$preview.getBoundingClientRect(),I=O==null?void 0:O.getBoundingClientRect();I.top>=S.top&&I.bottom<=S.bottom||this.$preview.scrollTo({top:O.offsetTop-16,behavior:this.isShowPreview?"smooth":"auto"})}refreshTotalPage(){this.pages.length?this.$totalPage.textContent=" / "+this.pages.length:this.$totalPage.textContent=""}setSmallBox(E){this.isSmallBox!==E&&(this.isSmallBox=E,this.$footer.classList.toggle(this.wrapClassName("float-footer"),E))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const E=document.createElement("div");E.className=this.wrapClassName("content"),this.$content=E,this.readonly&&E.classList.add(this.wrapClassName("readonly")),E.appendChild(this.renderPreviewMask()),E.appendChild(this.renderPreview()),E.appendChild(this.renderNote())}return this.$content}renderNote(){var v,O;const E=document.createElement("div");return E.className=this.wrapClassName("note")+" tele-fancy-scrollbar",this.note$=E,(v=this.context)!=null&&v.storage.state.note&&fetch((O=this.context)==null?void 0:O.storage.state.note).then(S=>S.json()).then(S=>{this.notes=S,this.renderNoteContent()}),this.sideEffect.addEventListener(E,"click",S=>{var D;if(this.readonly)return;const I=S.target;if(I.tagName.toLocaleLowerCase()=="a"){S.preventDefault(),S.stopPropagation(),S.stopImmediatePropagation();const z=I.href;(D=this.context)==null||D.dispatchAppEvent("open-note-link",z)}}),E}renderNoteContent(){var S,I,D,F,z;const E=document.createElement("div");E.className=this.wrapClassName("note-content");const v=(S=this.notes)==null?void 0:S[this.pageIndex+1];if((I=this.note$)==null||I.classList.toggle(this.wrapClassName("note-hide"),!v),!v)return;const O=IS(v);E.innerHTML=O,(D=this.note$)!=null&&D.firstElementChild?(F=this.note$)==null||F.replaceChild(E,this.note$.firstElementChild):(z=this.note$)==null||z.appendChild(E)}renderPreview(){if(!this.$preview){const E=document.createElement("div");E.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=E,this.refreshPreview(),this.sideEffect.addEventListener(E,"click",v=>{var S;if(this.readonly)return;const O=(S=v.target.dataset)==null?void 0:S.pageIndex;O&&(v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation(),this.onNewPageIndex(Number(O),"preview"))})}return this.$preview}async refreshPreview(){var I,D;const{$preview:E}=this,v=this.wrapClassName("preview-page"),O=this.wrapClassName("preview-page-name");for(;E.firstChild;)E.firstChild.remove();const S=[];for(let F=0,z=this.pages.length;F<z;F++){const J=this.pages[F],X=(I=J.thumbnail)!=null?I:J.src.startsWith("ppt")?void 0:J.src;X&&(S[F]=this.urlInterrupter(X))}for(let F=0,z=this.pages.length;F<z;F++)S[F]=await S[F];this.pages.forEach((F,z)=>{const J=S[z];if(!J)return;const X=String(z),et=document.createElement("a");et.className=v+" "+this.wrapClassName(`preview-page-${z}`),et.setAttribute("href","#"),et.dataset.pageIndex=X;const ut=document.createElement("span");ut.className=O,ut.textContent=String(z+1),ut.dataset.pageIndex=X;const Rt=document.createElement("img");Rt.width=F.width,Rt.height=F.height,Rt.dataset.src=J,Rt.dataset.pageIndex=X,Rt.classList.toggle(this.wrapClassName("active"),this.pageIndex==z),et.appendChild(ut),et.appendChild(Rt),E.appendChild(et)}),(D=this.previewLazyLoad)==null||D.update()}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",E=>{this.readonly||E.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){}renderFooter(){if(!this.$footer){const E=document.createElement("div");E.className=this.wrapClassName("footer"),this.$footer=E,this.readonly&&E.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&E.classList.add(this.wrapClassName("float-footer"));const v=document.createElement("div");v.className=this.wrapClassName("page-jumps");const O=this.renderFooterBtn("btn-page-back",bE(this.namespace));this.sideEffect.addEventListener(O,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1,"navigation")}),v.appendChild(O),this.$btnPageBack=O;const S=document.createElement("div");S.className=this.wrapClassName("page-number");const I=document.createElement("span");I.className=this.wrapClassName("page-number-input"),I.textContent=String(this.pageIndex+1),this.$pageNumberInput=I;const D=document.createElement("span");this.$totalPage=D,S.appendChild(I),S.appendChild(D),v.appendChild(S);const F=this.renderFooterBtn("btn-page-next",TE(this.namespace));this.sideEffect.addEventListener(F,"click",()=>{this.readonly||(this.setPlaying(),this.onPlay?this.onPlay():this.onNewPageIndex(this.pageIndex+1,"navigation"))}),v.appendChild(F),this.$btnPageNext=F,this.$footer.appendChild(v),this.box.events.on("maximized",z=>{this.$footer.classList.toggle(this.wrapClassName("hide"),z)})}return this.$footer}renderFooterBtn(E,v,O){const S=document.createElement("button");return S.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(E),S.appendChild(v),O&&S.appendChild(O),S}togglePreview(E){if(this.isShowPreview=E!=null?E:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview){const v=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));v&&(this.previewLazyLoad||(this.previewLazyLoad=new tl({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`})),this.$preview.scrollTo({top:v.offsetTop-16}))}}wrapClassName(E){return`${this.namespace}-${E}`}}const PS=new Set(["clicker"]),OS=function(){};class NS{constructor({context:E,box:v,view:O,mountSlideController:S,mountWhiteboard:I,baseScenePath:D,appId:F,urlInterrupter:z,onPagesReady:J,onNavigate:X}){this.slideController=null,this.isViewMounted=!1,this.onError=({error:et,index:ut})=>{var Rt,St;this.viewer.setPaused(),(Rt=this.slideController)!=null&&Rt.showRenderError&&(this.$overlay.textContent=`Error on slide[page=${this.slideController.page}]: ${et.message}`,this.$overlay.style.opacity="1"),(St=this.slideController)!=null&&St.onRenderError&&this.slideController.onRenderError(et,ut),Nr.warn("[Slide] render error",et)},this.onRenderStart=()=>{this.$whiteboardView.classList.add(this.wrapClassName("wb-view-hidden")),this.viewer.setPlaying()},this.onRenderEnd=()=>{},this.onPageChanged=()=>{clearTimeout(this._onPageChangedTimer),this._onPageChangedTimer=setTimeout(this._onPageChanged,200)},this._onPageChangedTimer=0,this._onPageChanged=()=>{this.$overlay.style.opacity="",this.$whiteboardView.classList.remove(this.wrapClassName("wb-view-hidden"))},this.refreshPages=()=>{this.slideController&&(this.viewer.pages=xv(this.slideController.slide,this.slideController.previewList),this.viewer.setPageIndex(this.getPageIndex(this.slideController.page)),this.scaleDocsToFit())},this.scaleDocsToFit=()=>{if(this.slideController){const{width:et,height:ut}=this.slideController.slide;et&&ut&&(this.whiteboardView.moveCameraToContain({originX:-et/2,originY:-ut/2,width:et,height:ut,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.whiteboardView.camera.scale,minContentMode:()=>this.whiteboardView.camera.scale,centerX:0,centerY:0,width:et,height:ut}),this.isViewMounted||(this.isViewMounted=!0,console.log("[Slide] mount whiteboard view"),this.mountWhiteboard(this.$whiteboardView)))}},this.onPlay=()=>{this.slideController&&this.slideController.slide.nextStep()},this.onNewPageIndex=(et,ut)=>{this.slideController&&this.slideController.jumpToPage(et+1,ut)},this.sideEffect=new Za,this.namespace="netless-app-slide",this.toPdf=async()=>{if(!this.slideController){this.reportProgress(100,null);return}const{slide:et}=this.slideController,ut=1920,Rt=document.createElement("canvas"),St=Rt.getContext("2d"),{slideCount:L,width:R,height:U}=et;let W=Math.floor(R),P=Math.floor(U);W>ut&&(W=ut,P=Math.floor(U*W/R)),P>ut&&(P=ut,W=Math.floor(R*P/U)),Rt.width=W,Rt.height=P;const j=document.createElement("canvas");j.width=W,j.height=P;const $=j.getContext("2d");if(!$||!this.getWhiteSnapshot||!St)return this.reportProgress(100,null),null;const H=W>P?"l":"p",{jsPDF:Nt}=await Promise.resolve().then(function(){return tE(require("jspdf"))}),Vt=new Nt({format:[W,P],orientation:H,compress:!0});for(let B=1;B<=L;B++){let ft=null;try{ft=await this.slideController.slide.snapshotWithTimingEnd(B)}catch{}if(ft){const Dt=document.createElement("img");Dt.src=ft,await new Promise(Z=>Dt.onload=Z),St.drawImage(Dt,0,0,W,P)}$.clearRect(0,0,W,P),await this.getWhiteSnapshot(B,j,$,R,U);try{const Dt=j.toDataURL("image/png"),Z=document.createElement("img");Z.src=Dt,await new Promise(pt=>Z.onload=pt),St.drawImage(Z,0,0,W,P)}catch{}const tt=Rt.toDataURL("image/jpeg",.6);B>1&&Vt.addPage(),Vt.addImage(tt,"JPEG",0,0,W,P,"","FAST"),St.clearRect(0,0,W,P),Math.ceil(B/L*100)<100&&this.reportProgress(Math.ceil(B/L*100),null)}const st=Vt.output("arraybuffer"),V=this.box.title;this.reportProgress(100,{pdf:st,title:V})},this.context=E,this.box=v,this.whiteboardView=O,this.mountSlideController=S,this.mountWhiteboard=I,this.onNavigate=X||OS,this.baseScenePath=D,this.appId=F,this.viewer=new Jv({readonly:v.readonly,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay,urlInterrupter:z,onPagesReady:J,box:v,context:E}),this.sideEffect.add(()=>{const et=ut=>{this.setReadonly(ut)};return v.events.on("readonly",et),()=>v.events.off("readonly",et)}),this.sideEffect.add(()=>{const et=ut=>{ut.data.type==="@netless/_request_save_pdf_"&&ut.data.appId===this.appId&&this.toPdf().catch(()=>this.reportProgress(100,null))};return window.addEventListener("message",et),()=>{window.removeEventListener("message",et)}}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.viewer.$content.appendChild(this.renderOverlay()),this.sideEffect.addEventListener(window,"keydown",E=>{if(this.box.focus&&this.slideController&&!aE(E.target))switch(E.key){case"ArrowUp":case"ArrowLeft":{this.slideController.slide.prevStep(),this.onNavigate(this.slideController.page,"keydown");break}case"ArrowRight":case"ArrowDown":{this.slideController.slide.nextStep(),this.onNavigate(this.slideController.page,"keydown");break}}})}renderOverlay(){if(!this.$overlay){const E=document.createElement("div");E.className=this.wrapClassName("overlay"),this.$overlay=E}return this.$overlay}renderSlideContainer(){if(!this.$slide){const E=document.createElement("div");E.className=this.wrapClassName("slide"),E.dataset.appKind="Slide",this.$slide=E}return this.$slide}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view")),this.$whiteboardView}mount(){return this.box.mountContent(this.viewer.$content),this.box.mountFooter(this.viewer.$footer),this.slideController=this.mountSlideController({anchor:this.$slide,onRenderStart:this.onRenderStart,onRenderEnd:this.onRenderEnd,onTransitionStart:this.viewer.setPlaying,onTransitionEnd:this.viewer.setPaused,onReady:this.refreshPages,onNavigate:this.onNavigate,onError:this.onError}),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit))),this}getPageIndex(E){return(E>0?E:1)-1}unmount(){return this.slideController&&(this.slideController.destroy(),this.slideController=null),this.viewer.unmount(),this}setReadonly(E){this.viewer.setReadonly(E)}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}toggleClickThrough(E){this.$whiteboardView.style.pointerEvents=!E||PS.has(E)?"none":"auto"}wrapClassName(E){return`${this.namespace}-${E}`}async getWhiteSnapshot(E,v,O,S,I){const D={centerX:0,centerY:0,scale:Math.min(v.width/S,v.height/I)},F=`${this.baseScenePath}/${E}`,z=this.context.manager.windowManger;z._appliancePlugin?await z._appliancePlugin.screenshotToCanvasAsync(O,F,v.width,v.height,D):this.whiteboardView.screenshotToCanvas(O,F,v.width,v.height,D)}reportProgress(E,v){window.postMessage({type:"@netless/_result_save_pdf_",appId:this.appId,progress:E,result:v})}}let Pc=!1;exports.FreezerLength=2;function LS(){return exports.FreezerLength}function DS(b){exports.FreezerLength=b<1?1/0:b}const Ya=b=>"["+b+"]",wh={map:new Map,boxes:new Map,queue:[],validateQueue(){for(this.queue.sort((b,E)=>{var S,I,D,F;const v=(I=(S=this.boxes.get(b))==null?void 0:S.zIndex)!=null?I:0,O=(F=(D=this.boxes.get(E))==null?void 0:D.zIndex)!=null?F:0;return-(v-O)}),Pi("[Slide] freezer: validate",Ya(this.queue));this.queue.length>exports.FreezerLength;){const b=this.queue.pop(),E=this.map.get(b);E&&(Pi("[Slide] freezer: validate-freeze",b,Ya(this.queue)),E.freeze())}},set(b,E,v){Pi("[Slide] freezer: add",b,Ya(this.queue)),this.map.set(b,E),this.boxes.set(b,v),this.queue.includes(b)||this.queue.unshift(b),this.validateQueue()},delete(b){this.map.delete(b),this.boxes.delete(b),this.queue=this.queue.filter(E=>E!==b),Pi("[Slide] freezer: delete",b,Ya(this.queue))},focus(b){const E=this.map.get(b),v=this.queue.indexOf(b);v>-1&&this.queue.splice(v,1),this.queue.unshift(b),this.validateQueue(),Pi("[Slide] freezer: focus",b,Ya(this.queue)),E&&E.unfreeze()}},Oc=new Set;function FS(b){return Oc.add(b),()=>Oc.delete(b)}const Nc=new Set;function BS(b){return Nc.add(b),()=>Nc.delete(b)}const kS=b=>{Pc=!0,b.on("focus",({appId:E})=>{wh.focus(E)}),b.on("created",({appId:E})=>{Oc.forEach(v=>v(E))}),b.on("destroy",({appId:E})=>{Nc.forEach(v=>v(E))})};var Zv=(()=>`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;z-index:300;top:0;right:0;width:23%;padding:12px;transform:translate(100%);box-shadow:-4.8px -3.2px 20px #20233826;transition:transform .4s;background:#f5f5fc;border-radius:4px;-webkit-box-shadow:-4.8px -3.2px 20px rgba(32,35,56,.15);height:100%;position:absolute;opacity:0}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0);opacity:1}.netless-app-slide-preview-head{display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:10px}.netless-app-slide-preview-head>h3{color:#484c70;font-weight:400;font-size:14px;width:calc(100% - 20px);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.netless-app-slide-preview-head .netless-app-slide-close{width:25px;height:25px;padding:0;outline:none;border:none;background:#fff;display:flex;justify-content:center;align-items:center;border-radius:100%;cursor:pointer}.netless-app-slide-preview-head .netless-app-slide-close button{width:22px;height:22px;padding:0;outline:none;border:none;background:center/cover no-repeat;background-image:url(./icons/close.svg)}.netless-app-slide-preview-page{position:relative;display:flex;width:100%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border-radius:4px;transition:border-color .3s;user-select:none;align-items:flex-end}.netless-app-slide-preview-page>img{width:calc(90% - 10px);height:auto;box-sizing:border-box;border:2px solid rgba(0,0,0,.5);border-radius:2px;background-color:#fff}.netless-app-slide-preview-page>img.netless-app-slide-active{border-color:#ff5353}.netless-app-slide-preview-page-name{text-align:right;font-size:12px;color:#8d8fa6;user-select:none;margin-right:10px;width:5%}.netless-app-slide-footer{box-sizing:border-box;height:40px;display:flex;align-items:center;padding:0 16px;color:#191919;background:#ebecfa}.netless-app-slide-note{width:80%;max-height:200px;padding:14px;position:absolute;left:10%;bottom:15px;z-index:102;background-color:#00000080;border-radius:14px}.netless-app-slide-note-content,.netless-app-slide-note-content a{color:#fff}.netless-app-slide-note-hide{display:none}.netless-app-slide-float-footer{width:100%;min-height:40px;position:absolute;left:0;bottom:0;z-index:2000;transition:opacity .4s;color:#191919}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:4px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);color:#8d8fa6}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-disable{color:#c6c7d2;cursor:not-allowed}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-disable .arrow{fill:#c6c7d2}.netless-app-slide-footer-btn .arrow{fill:#8d8fa6}.netless-app-slide-footer-btn:hover{background-color:#1b1f4d0a}@media (hover: none){.netless-app-slide-footer-btn:hover{background:transparent!important}}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-hide{visibility:hidden}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center;gap:8px}.netless-app-slide-page-number{font-size:14px;color:#8d8fa6;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 2px;text-align:right;font-size:13px;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer{display:none}.telebox-color-scheme-dark .netless-app-slide-page-number-input{color:#a6a6a8}.telebox-color-scheme-dark .netless-app-slide-page-number-input:active,.telebox-color-scheme-dark .netless-app-slide-page-number-input:focus,.telebox-color-scheme-dark .netless-app-slide-page-number-input:hover{color:#222}.telebox-color-scheme-dark .netless-app-slide-footer{color:#a6a6a8;background:#2d2d33;border-top:none}.telebox-color-scheme-dark .netless-app-slide-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-slide-preview{background:rgba(50,50,50,.9)}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden;transition:opacity .2s}.netless-app-slide-wb-view-hidden{opacity:0}.netless-app-slide-overlay{display:flex;align-items:center;justify-content:center;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%;padding:8px;background:rgba(255,0,0,.25);transition:opacity .3s;opacity:0;pointer-events:none}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`)();function US({container:b,taskId:E,resourceList:v=[],url:O=Dc,debug:S=!1,box:I}){if(!E)throw new Error("[Slide] taskId is required");b.style.cssText+="display:flex;flex-direction:column";const D=new Kv({target:b,box:I});return D.debug=!!S,D.mount(E,O,v),D}class Kv{constructor(E){this.slide=null,this.debug=!1,this.previewList=[],this.sideEffect=new Za,this.ready=!1,this.readyPromise=new Promise(v=>{this.resolveReady=()=>{this.ready=!0,v()}}),this.hotkeyListener=v=>{if(this.slide)switch(v.key){case"ArrowUp":case"ArrowLeft":{this.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slide.nextStep();break}}},this.onPageChanged=v=>{this.viewer.setPageIndex(v-1)},this.onTransitionStart=()=>{this.viewer.setPlaying()},this.onTransitionEnd=()=>{this.viewer.setPaused()},this.onError=({error:v})=>{this.viewer.setPaused(),console.warn("[Slide] render error",v)},this.destroyed=!1,this.refreshPages=()=>{this.slide&&(this.viewer.pages=xv(this.slide,this.previewList),this.viewer.setPageIndex(this.getPageIndex(this.slide.slideState.currentSlideIndex)))},this.onPlay=()=>{this.slide&&this.slide.nextStep()},this.onNewPageIndex=v=>{this.slide&&this.slide.slideCount>0&&this.slide.renderSlide(pv(v+1,1,this.slide.slideCount))},this.namespace="netless-app-slide",this.target=E.target,this.bgColor=yv(this.target),this.viewer=new Jv({readonly:!1,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay,box:E.box}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.registerHotKeys(window)}registerHotKeys(E){this.sideEffect.addEventListener(E,"keydown",this.hotkeyListener,void 0,"hotkey")}mount(E,v,O,S=[]){this.target.appendChild(this.renderStyle()),this.target.appendChild(this.viewer.$content),this.target.appendChild(this.viewer.$footer),this.slide=new li.Slide({anchor:this.$slide,interactive:!0,mode:"local",controller:this.debug,enableGlobalClick:!0,renderOptions:{minFPS:25,maxFPS:30,autoFPS:!0,autoResolution:!0,transactionBgColor:this.bgColor}}),this.registerEventListeners(),O.length>0?this.slide.setResourceList(E,O):this.slide.setResource(E,v),this.slide.renderSlide(1),this.previewList=S}renderStyle(){const E=document.createElement("style");return E.appendChild(document.createTextNode(Zv)),E}registerEventListeners(){if(!this.slide)return;const{slide:E}=this;E.on(li.SLIDE_EVENTS.slideChange,this.onPageChanged),E.on(li.SLIDE_EVENTS.renderStart,this.onTransitionStart),E.on(li.SLIDE_EVENTS.renderEnd,this.onTransitionEnd),E.on(li.SLIDE_EVENTS.mainSeqStepStart,this.onTransitionStart),E.on(li.SLIDE_EVENTS.mainSeqStepEnd,this.onTransitionEnd),E.on(li.SLIDE_EVENTS.renderError,this.onError),E.on(li.SLIDE_EVENTS.renderEnd,this.resolveReady),this.readyPromise.then(this.refreshPages)}destroy(){this.sideEffect.flushAll(),this.slide&&!this.destroyed&&(this.slide.destroy(),this.destroyed=!0),this.viewer.destroy()}getPageIndex(E){return(E>0?E:1)-1}renderSlideContainer(){if(!this.$slide){const E=document.createElement("div");E.className=this.wrapClassName("slide"),E.dataset.appKind="Slide",this.$slide=E}return this.$slide}wrapClassName(E){return`${this.namespace}-${E}`}}const GS=li.Slide.usePlugin.bind(li.Slide),Lc="0.2.63",HS={kind:"Slide",setup(b){var J;if(console.log("[Slide] setup @ "+Lc),b.getIsWritable()&&b.storage.ensureState(Rc),!b.storage.state.taskId)throw new Error("[Slide] no taskId");const E=b.getView();if(!E)throw new Error("[Slide] no view, please set scenePath on addApp()");E.disableCameraTransform=!0;const v=b.getBox();v.mountStyles(Zv);try{v.$content.dataset.appSlideVersion=Lc}catch{}const O=b.getInitScenePath();let S=null;const I=X=>{const et=b.getRoom();if(S&&S.slideController){let ut=!1;et&&b.getIsWritable()&&(sv(et,b,S.slideController.slide,O),ut=!0),Pi("[Slide] page to",X,ut?"(synced)":""),S.viewer.setPageIndex(X-1),S.viewer.setPaused(),S.onPageChanged();const Rt=S.viewer.pages.length;Rt>0&&b.dispatchAppEvent("pageStateChange",{index:X-1,length:Rt})}},D=X=>{const et=b.getAppOptions()||{},ut=new xE(iv(Ac({context:b},X),{onPageChanged:I,onNavigate:X.onNavigate,onRenderError:et.onRenderError,showRenderError:et.showRenderError,invisibleBehavior:et.invisibleBehavior}));return Pc&&wh.set(b.appId,ut,v),Nr.setAppController(b.appId,ut),ut.readyPromise.then(X.onReady).then(()=>{const Rt=b.getRoom();let St=!1;Rt&&b.getIsWritable()&&(sv(Rt,b,ut.slide,O),St=!0);const L=ut.slide.slideState.currentSlideIndex;Pi("[Slide] page to",L,St?"(synced)":"","(on ready)"),ut.slide.on("renderEnd",X.onRenderEnd)}),ut};S=new NS({context:b,box:v,view:E,mountSlideController:D,mountWhiteboard:b.mountView.bind(b),baseScenePath:O,appId:b.appId,urlInterrupter:(J=b.getAppOptions())==null?void 0:J.urlInterrupter,onPagesReady:({length:X})=>{const et=(S==null?void 0:S.viewer.pageIndex)||0;b.dispatchAppEvent("pageStateChange",{index:et,length:X})},onNavigate:(X,et)=>{Pi("[Slide] user navigate to",X,et?`(${et})`:"")}});const F=b.getRoom(),z=new Za;return z.add(()=>{var X;return Nr.setAppContext(b.appId,b),Nr.enable=((X=b.getAppOptions())==null?void 0:X.debug)||!1,Nr.level="debug",()=>Nr.deleteApp(b.appId)}),F&&(S.toggleClickThrough(F.state.memberState.currentApplianceName),z.add(()=>{const X=et=>{et.memberState&&S&&S.toggleClickThrough(et.memberState.currentApplianceName)};return F.callbacks.on("onRoomStateChanged",X),()=>F.callbacks.off("onRoomStateChanged",X)})),b.emitter.on("destroy",()=>{Pi("[Slide] destroy",b.appId),Pc&&wh.delete(b.appId),z.flushAll(),S&&(S.destroy(),S=null)}),S.mount(),{viewer:()=>S,controller:()=>S==null?void 0:S.slideController,slide:()=>{var X;return(X=S==null?void 0:S.slideController)==null?void 0:X.slide},nextStep:()=>{var X;if(S){if((X=S==null?void 0:S.slideController)!=null&&X.slide.hasNextStep())S.slideController.slide.nextStep();else{const et=S==null?void 0:S.slideController;if(et){const{page:ut,pageCount:Rt}=et;Rt>0&&ut<Rt&&et.jumpToPage(ut+1)}}return!0}return!1},prevStep:()=>{var X;return S&&S.slideController?((X=S==null?void 0:S.slideController)==null||X.slide.prevStep(),!0):!1},position:()=>{const X=S==null?void 0:S.slideController;if(X)return[X.page,X.pageCount]},nextPage:()=>{const X=S==null?void 0:S.slideController;if(X){const{page:et,pageCount:ut}=X;if(ut>0&&et<ut)return X.jumpToPage(et+1),!0}return!1},prevPage:()=>{const X=S==null?void 0:S.slideController;if(X){const{page:et,pageCount:ut}=X;if(ut>0&&et>1)return X.jumpToPage(et-1),!0}return!1},jumpToPage:X=>{const et=S==null?void 0:S.slideController;if(et){const{page:ut,pageCount:Rt}=et;if(Rt>0&&ut>0&&ut<=Rt)return et.jumpToPage(X),!0}return!1},togglePreview:X=>{S==null||S.viewer.togglePreview(X)}}}};exports.DefaultUrl=Dc;exports.Slide=li.Slide;exports.SlidePreviewer=Kv;exports.addHooks=kS;exports.apps=wh;exports.default=HS;exports.getFreezerLength=LS;exports.onCreated=FS;exports.onDestroyed=BS;exports.previewSlide=US;exports.setFreezerLength=DS;exports.usePlugin=GS;exports.version=Lc;
//# sourceMappingURL=main.cjs.js.map
