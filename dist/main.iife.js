var NetlessAppSlide=function(Fi){var Xd;"use strict";var ai=function(b){var S={};function v(O){if(S[O])return S[O].exports;var R=S[O]={i:O,l:!1,exports:{}};return b[O].call(R.exports,R,R.exports,v),R.l=!0,R.exports}return v.m=b,v.c=S,v.d=function(O,R,M){v.o(O,R)||Object.defineProperty(O,R,{enumerable:!0,get:M})},v.r=function(O){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})},v.t=function(O,R){if(1&R&&(O=v(O)),8&R||4&R&&typeof O=="object"&&O&&O.__esModule)return O;var M=Object.create(null);if(v.r(M),Object.defineProperty(M,"default",{enumerable:!0,value:O}),2&R&&typeof O!="string")for(var D in O)v.d(M,D,function(B){return O[B]}.bind(null,D));return M},v.n=function(O){var R=O&&O.__esModule?function(){return O.default}:function(){return O};return v.d(R,"a",R),R},v.o=function(O,R){return Object.prototype.hasOwnProperty.call(O,R)},v.p="",v(v.s=229)}([function(b,S,v){/*!
* @pixi/constants - v6.4.2
* Compiled Thu, 02 Jun 2022 15:39:26 UTC
*
* @pixi/constants is licensed under the MIT License.
* http://www.opensource.org/licenses/mit-license
*/var O,R,M,D,B,z,X,J,et,pt,Nt,vt,L,I,F,W,P,j,Q;v.d(S,"a",function(){return L}),v.d(S,"b",function(){return D}),v.d(S,"c",function(){return M}),v.d(S,"d",function(){return Q}),v.d(S,"e",function(){return I}),v.d(S,"f",function(){return B}),v.d(S,"g",function(){return O}),v.d(S,"h",function(){return z}),v.d(S,"i",function(){return F}),v.d(S,"j",function(){return P}),v.d(S,"k",function(){return vt}),v.d(S,"l",function(){return j}),v.d(S,"m",function(){return W}),v.d(S,"n",function(){return R}),v.d(S,"o",function(){return et}),v.d(S,"p",function(){return pt}),v.d(S,"q",function(){return X}),v.d(S,"r",function(){return J}),v.d(S,"s",function(){return Nt}),function(H){H[H.WEBGL_LEGACY=0]="WEBGL_LEGACY",H[H.WEBGL=1]="WEBGL",H[H.WEBGL2=2]="WEBGL2"}(O||(O={})),function(H){H[H.UNKNOWN=0]="UNKNOWN",H[H.WEBGL=1]="WEBGL",H[H.CANVAS=2]="CANVAS"}(R||(R={})),function(H){H[H.COLOR=16384]="COLOR",H[H.DEPTH=256]="DEPTH",H[H.STENCIL=1024]="STENCIL"}(M||(M={})),function(H){H[H.NORMAL=0]="NORMAL",H[H.ADD=1]="ADD",H[H.MULTIPLY=2]="MULTIPLY",H[H.SCREEN=3]="SCREEN",H[H.OVERLAY=4]="OVERLAY",H[H.DARKEN=5]="DARKEN",H[H.LIGHTEN=6]="LIGHTEN",H[H.COLOR_DODGE=7]="COLOR_DODGE",H[H.COLOR_BURN=8]="COLOR_BURN",H[H.HARD_LIGHT=9]="HARD_LIGHT",H[H.SOFT_LIGHT=10]="SOFT_LIGHT",H[H.DIFFERENCE=11]="DIFFERENCE",H[H.EXCLUSION=12]="EXCLUSION",H[H.HUE=13]="HUE",H[H.SATURATION=14]="SATURATION",H[H.COLOR=15]="COLOR",H[H.LUMINOSITY=16]="LUMINOSITY",H[H.NORMAL_NPM=17]="NORMAL_NPM",H[H.ADD_NPM=18]="ADD_NPM",H[H.SCREEN_NPM=19]="SCREEN_NPM",H[H.NONE=20]="NONE",H[H.SRC_OVER=0]="SRC_OVER",H[H.SRC_IN=21]="SRC_IN",H[H.SRC_OUT=22]="SRC_OUT",H[H.SRC_ATOP=23]="SRC_ATOP",H[H.DST_OVER=24]="DST_OVER",H[H.DST_IN=25]="DST_IN",H[H.DST_OUT=26]="DST_OUT",H[H.DST_ATOP=27]="DST_ATOP",H[H.ERASE=26]="ERASE",H[H.SUBTRACT=28]="SUBTRACT",H[H.XOR=29]="XOR"}(D||(D={})),function(H){H[H.POINTS=0]="POINTS",H[H.LINES=1]="LINES",H[H.LINE_LOOP=2]="LINE_LOOP",H[H.LINE_STRIP=3]="LINE_STRIP",H[H.TRIANGLES=4]="TRIANGLES",H[H.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",H[H.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(B||(B={})),function(H){H[H.RGBA=6408]="RGBA",H[H.RGB=6407]="RGB",H[H.RG=33319]="RG",H[H.RED=6403]="RED",H[H.RGBA_INTEGER=36249]="RGBA_INTEGER",H[H.RGB_INTEGER=36248]="RGB_INTEGER",H[H.RG_INTEGER=33320]="RG_INTEGER",H[H.RED_INTEGER=36244]="RED_INTEGER",H[H.ALPHA=6406]="ALPHA",H[H.LUMINANCE=6409]="LUMINANCE",H[H.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",H[H.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",H[H.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(z||(z={})),function(H){H[H.TEXTURE_2D=3553]="TEXTURE_2D",H[H.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",H[H.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",H[H.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",H[H.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",H[H.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",H[H.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",H[H.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",H[H.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(X||(X={})),function(H){H[H.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",H[H.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",H[H.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",H[H.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",H[H.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",H[H.UNSIGNED_INT=5125]="UNSIGNED_INT",H[H.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",H[H.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",H[H.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",H[H.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",H[H.BYTE=5120]="BYTE",H[H.SHORT=5122]="SHORT",H[H.INT=5124]="INT",H[H.FLOAT=5126]="FLOAT",H[H.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",H[H.HALF_FLOAT=36193]="HALF_FLOAT"}(J||(J={})),function(H){H[H.FLOAT=0]="FLOAT",H[H.INT=1]="INT",H[H.UINT=2]="UINT"}(et||(et={})),function(H){H[H.NEAREST=0]="NEAREST",H[H.LINEAR=1]="LINEAR"}(pt||(pt={})),function(H){H[H.CLAMP=33071]="CLAMP",H[H.REPEAT=10497]="REPEAT",H[H.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Nt||(Nt={})),function(H){H[H.OFF=0]="OFF",H[H.POW2=1]="POW2",H[H.ON=2]="ON",H[H.ON_MANUAL=3]="ON_MANUAL"}(vt||(vt={})),function(H){H[H.NPM=0]="NPM",H[H.UNPACK=1]="UNPACK",H[H.PMA=2]="PMA",H[H.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",H[H.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",H[H.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",H[H.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(L||(L={})),function(H){H[H.NO=0]="NO",H[H.YES=1]="YES",H[H.AUTO=2]="AUTO",H[H.BLEND=0]="BLEND",H[H.CLEAR=1]="CLEAR",H[H.BLIT=2]="BLIT"}(I||(I={})),function(H){H[H.AUTO=0]="AUTO",H[H.MANUAL=1]="MANUAL"}(F||(F={})),function(H){H.LOW="lowp",H.MEDIUM="mediump",H.HIGH="highp"}(W||(W={})),function(H){H[H.NONE=0]="NONE",H[H.SCISSOR=1]="SCISSOR",H[H.STENCIL=2]="STENCIL",H[H.SPRITE=3]="SPRITE"}(P||(P={})),function(H){H[H.NONE=0]="NONE",H[H.LOW=2]="LOW",H[H.MEDIUM=4]="MEDIUM",H[H.HIGH=8]="HIGH"}(j||(j={})),function(H){H[H.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",H[H.ARRAY_BUFFER=34962]="ARRAY_BUFFER",H[H.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Q||(Q={}))},function(b,S,v){v.d(S,"a",function(){return J}),v.d(S,"b",function(){return D}),v.d(S,"c",function(){return et}),v.d(S,"d",function(){return L}),v.d(S,"e",function(){return vt}),v.d(S,"f",function(){return R}),v.d(S,"g",function(){return B}),v.d(S,"h",function(){return pt}),v.d(S,"i",function(){return M}),v.d(S,"j",function(){return X}),v.d(S,"k",function(){return Nt}),v.d(S,"l",function(){return O}),v.d(S,"m",function(){return Vt}),v.d(S,"n",function(){return Ot});/*!
 * @pixi/math - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var O,R=2*Math.PI,M=180/Math.PI,D=Math.PI/180;(function(st){st[st.POLY=0]="POLY",st[st.RECT=1]="RECT",st[st.CIRC=2]="CIRC",st[st.ELIP=3]="ELIP",st[st.RREC=4]="RREC"})(O||(O={}));var B=function(){function st(V,k){V===void 0&&(V=0),k===void 0&&(k=0),this.x=0,this.y=0,this.x=V,this.y=k}return st.prototype.clone=function(){return new st(this.x,this.y)},st.prototype.copyFrom=function(V){return this.set(V.x,V.y),this},st.prototype.copyTo=function(V){return V.set(this.x,this.y),V},st.prototype.equals=function(V){return V.x===this.x&&V.y===this.y},st.prototype.set=function(V,k){return V===void 0&&(V=0),k===void 0&&(k=V),this.x=V,this.y=k,this},st.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},st}(),z=[new B,new B,new B,new B],X=function(){function st(V,k,mt,tt){V===void 0&&(V=0),k===void 0&&(k=0),mt===void 0&&(mt=0),tt===void 0&&(tt=0),this.x=Number(V),this.y=Number(k),this.width=Number(mt),this.height=Number(tt),this.type=O.RECT}return Object.defineProperty(st.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(st,"EMPTY",{get:function(){return new st(0,0,0,0)},enumerable:!1,configurable:!0}),st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.copyFrom=function(V){return this.x=V.x,this.y=V.y,this.width=V.width,this.height=V.height,this},st.prototype.copyTo=function(V){return V.x=this.x,V.y=this.y,V.width=this.width,V.height=this.height,V},st.prototype.contains=function(V,k){return!(this.width<=0||this.height<=0)&&V>=this.x&&V<this.x+this.width&&k>=this.y&&k<this.y+this.height},st.prototype.intersects=function(V,k){if(!k){var mt=this.x<V.x?V.x:this.x;if((this.right>V.right?V.right:this.right)<=mt)return!1;var tt=this.y<V.y?V.y:this.y;return(this.bottom>V.bottom?V.bottom:this.bottom)>tt}var _t=this.left,Dt=this.right,Z=this.top,ct=this.bottom;if(Dt<=_t||ct<=Z)return!1;var rt=z[0].set(V.left,V.top),yt=z[1].set(V.left,V.bottom),At=z[2].set(V.right,V.top),Gt=z[3].set(V.right,V.bottom);if(At.x<=rt.x||yt.y<=rt.y)return!1;var Yt=Math.sign(k.a*k.d-k.b*k.c);if(Yt===0||(k.apply(rt,rt),k.apply(yt,yt),k.apply(At,At),k.apply(Gt,Gt),Math.max(rt.x,yt.x,At.x,Gt.x)<=_t||Math.min(rt.x,yt.x,At.x,Gt.x)>=Dt||Math.max(rt.y,yt.y,At.y,Gt.y)<=Z||Math.min(rt.y,yt.y,At.y,Gt.y)>=ct))return!1;var Jt=Yt*(yt.y-rt.y),at=Yt*(rt.x-yt.x),_e=Jt*_t+at*Z,ke=Jt*Dt+at*Z,Le=Jt*_t+at*ct,Ae=Jt*Dt+at*ct;if(Math.max(_e,ke,Le,Ae)<=Jt*rt.x+at*rt.y||Math.min(_e,ke,Le,Ae)>=Jt*Gt.x+at*Gt.y)return!1;var ze=Yt*(rt.y-At.y),Qe=Yt*(At.x-rt.x),cn=ze*_t+Qe*Z,Ue=ze*Dt+Qe*Z,Ge=ze*_t+Qe*ct,Rn=ze*Dt+Qe*ct;return!(Math.max(cn,Ue,Ge,Rn)<=ze*rt.x+Qe*rt.y||Math.min(cn,Ue,Ge,Rn)>=ze*Gt.x+Qe*Gt.y)},st.prototype.pad=function(V,k){return V===void 0&&(V=0),k===void 0&&(k=V),this.x-=V,this.y-=k,this.width+=2*V,this.height+=2*k,this},st.prototype.fit=function(V){var k=Math.max(this.x,V.x),mt=Math.min(this.x+this.width,V.x+V.width),tt=Math.max(this.y,V.y),_t=Math.min(this.y+this.height,V.y+V.height);return this.x=k,this.width=Math.max(mt-k,0),this.y=tt,this.height=Math.max(_t-tt,0),this},st.prototype.ceil=function(V,k){V===void 0&&(V=1),k===void 0&&(k=.001);var mt=Math.ceil((this.x+this.width-k)*V)/V,tt=Math.ceil((this.y+this.height-k)*V)/V;return this.x=Math.floor((this.x+k)*V)/V,this.y=Math.floor((this.y+k)*V)/V,this.width=mt-this.x,this.height=tt-this.y,this},st.prototype.enlarge=function(V){var k=Math.min(this.x,V.x),mt=Math.max(this.x+this.width,V.x+V.width),tt=Math.min(this.y,V.y),_t=Math.max(this.y+this.height,V.y+V.height);return this.x=k,this.width=mt-k,this.y=tt,this.height=_t-tt,this},st.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),J=function(){function st(V,k,mt){V===void 0&&(V=0),k===void 0&&(k=0),mt===void 0&&(mt=0),this.x=V,this.y=k,this.radius=mt,this.type=O.CIRC}return st.prototype.clone=function(){return new st(this.x,this.y,this.radius)},st.prototype.contains=function(V,k){if(this.radius<=0)return!1;var mt=this.radius*this.radius,tt=this.x-V,_t=this.y-k;return(tt*=tt)+(_t*=_t)<=mt},st.prototype.getBounds=function(){return new X(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},st.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},st}(),et=function(){function st(V,k,mt,tt){V===void 0&&(V=0),k===void 0&&(k=0),mt===void 0&&(mt=0),tt===void 0&&(tt=0),this.x=V,this.y=k,this.width=mt,this.height=tt,this.type=O.ELIP}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.contains=function(V,k){if(this.width<=0||this.height<=0)return!1;var mt=(V-this.x)/this.width,tt=(k-this.y)/this.height;return(mt*=mt)+(tt*=tt)<=1},st.prototype.getBounds=function(){return new X(this.x-this.width,this.y-this.height,this.width,this.height)},st.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),pt=function(){function st(){for(var V=arguments,k=[],mt=0;mt<arguments.length;mt++)k[mt]=V[mt];var tt=Array.isArray(k[0])?k[0]:k;if(typeof tt[0]!="number"){for(var _t=[],Dt=0,Z=tt.length;Dt<Z;Dt++)_t.push(tt[Dt].x,tt[Dt].y);tt=_t}this.points=tt,this.type=O.POLY,this.closeStroke=!0}return st.prototype.clone=function(){var V=new st(this.points.slice());return V.closeStroke=this.closeStroke,V},st.prototype.contains=function(V,k){for(var mt=!1,tt=this.points.length/2,_t=0,Dt=tt-1;_t<tt;Dt=_t++){var Z=this.points[2*_t],ct=this.points[2*_t+1],rt=this.points[2*Dt],yt=this.points[2*Dt+1];ct>k!=yt>k&&V<(k-ct)/(yt-ct)*(rt-Z)+Z&&(mt=!mt)}return mt},st.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(V,k){return V+", "+k},"")+"]"},st}(),Nt=function(){function st(V,k,mt,tt,_t){V===void 0&&(V=0),k===void 0&&(k=0),mt===void 0&&(mt=0),tt===void 0&&(tt=0),_t===void 0&&(_t=20),this.x=V,this.y=k,this.width=mt,this.height=tt,this.radius=_t,this.type=O.RREC}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height,this.radius)},st.prototype.contains=function(V,k){if(this.width<=0||this.height<=0)return!1;if(V>=this.x&&V<=this.x+this.width&&k>=this.y&&k<=this.y+this.height){var mt=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(k>=this.y+mt&&k<=this.y+this.height-mt||V>=this.x+mt&&V<=this.x+this.width-mt)return!0;var tt=V-(this.x+mt),_t=k-(this.y+mt),Dt=mt*mt;if(tt*tt+_t*_t<=Dt||(tt=V-(this.x+this.width-mt))*tt+_t*_t<=Dt||tt*tt+(_t=k-(this.y+this.height-mt))*_t<=Dt||(tt=V-(this.x+mt))*tt+_t*_t<=Dt)return!0}return!1},st.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},st}(),vt=function(){function st(V,k,mt,tt){mt===void 0&&(mt=0),tt===void 0&&(tt=0),this._x=mt,this._y=tt,this.cb=V,this.scope=k}return st.prototype.clone=function(V,k){return V===void 0&&(V=this.cb),k===void 0&&(k=this.scope),new st(V,k,this._x,this._y)},st.prototype.set=function(V,k){return V===void 0&&(V=0),k===void 0&&(k=V),this._x===V&&this._y===k||(this._x=V,this._y=k,this.cb.call(this.scope)),this},st.prototype.copyFrom=function(V){return this._x===V.x&&this._y===V.y||(this._x=V.x,this._y=V.y,this.cb.call(this.scope)),this},st.prototype.copyTo=function(V){return V.set(this._x,this._y),V},st.prototype.equals=function(V){return V.x===this._x&&V.y===this._y},st.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(st.prototype,"x",{get:function(){return this._x},set:function(V){this._x!==V&&(this._x=V,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"y",{get:function(){return this._y},set:function(V){this._y!==V&&(this._y=V,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),st}(),L=function(){function st(V,k,mt,tt,_t,Dt){V===void 0&&(V=1),k===void 0&&(k=0),mt===void 0&&(mt=0),tt===void 0&&(tt=1),_t===void 0&&(_t=0),Dt===void 0&&(Dt=0),this.array=null,this.a=V,this.b=k,this.c=mt,this.d=tt,this.tx=_t,this.ty=Dt}return st.prototype.fromArray=function(V){this.a=V[0],this.b=V[1],this.c=V[3],this.d=V[4],this.tx=V[2],this.ty=V[5]},st.prototype.set=function(V,k,mt,tt,_t,Dt){return this.a=V,this.b=k,this.c=mt,this.d=tt,this.tx=_t,this.ty=Dt,this},st.prototype.toArray=function(V,k){this.array||(this.array=new Float32Array(9));var mt=k||this.array;return V?(mt[0]=this.a,mt[1]=this.b,mt[2]=0,mt[3]=this.c,mt[4]=this.d,mt[5]=0,mt[6]=this.tx,mt[7]=this.ty,mt[8]=1):(mt[0]=this.a,mt[1]=this.c,mt[2]=this.tx,mt[3]=this.b,mt[4]=this.d,mt[5]=this.ty,mt[6]=0,mt[7]=0,mt[8]=1),mt},st.prototype.apply=function(V,k){k=k||new B;var mt=V.x,tt=V.y;return k.x=this.a*mt+this.c*tt+this.tx,k.y=this.b*mt+this.d*tt+this.ty,k},st.prototype.applyInverse=function(V,k){k=k||new B;var mt=1/(this.a*this.d+this.c*-this.b),tt=V.x,_t=V.y;return k.x=this.d*mt*tt+-this.c*mt*_t+(this.ty*this.c-this.tx*this.d)*mt,k.y=this.a*mt*_t+-this.b*mt*tt+(-this.ty*this.a+this.tx*this.b)*mt,k},st.prototype.translate=function(V,k){return this.tx+=V,this.ty+=k,this},st.prototype.scale=function(V,k){return this.a*=V,this.d*=k,this.c*=V,this.b*=k,this.tx*=V,this.ty*=k,this},st.prototype.rotate=function(V){var k=Math.cos(V),mt=Math.sin(V),tt=this.a,_t=this.c,Dt=this.tx;return this.a=tt*k-this.b*mt,this.b=tt*mt+this.b*k,this.c=_t*k-this.d*mt,this.d=_t*mt+this.d*k,this.tx=Dt*k-this.ty*mt,this.ty=Dt*mt+this.ty*k,this},st.prototype.append=function(V){var k=this.a,mt=this.b,tt=this.c,_t=this.d;return this.a=V.a*k+V.b*tt,this.b=V.a*mt+V.b*_t,this.c=V.c*k+V.d*tt,this.d=V.c*mt+V.d*_t,this.tx=V.tx*k+V.ty*tt+this.tx,this.ty=V.tx*mt+V.ty*_t+this.ty,this},st.prototype.setTransform=function(V,k,mt,tt,_t,Dt,Z,ct,rt){return this.a=Math.cos(Z+rt)*_t,this.b=Math.sin(Z+rt)*_t,this.c=-Math.sin(Z-ct)*Dt,this.d=Math.cos(Z-ct)*Dt,this.tx=V-(mt*this.a+tt*this.c),this.ty=k-(mt*this.b+tt*this.d),this},st.prototype.prepend=function(V){var k=this.tx;if(V.a!==1||V.b!==0||V.c!==0||V.d!==1){var mt=this.a,tt=this.c;this.a=mt*V.a+this.b*V.c,this.b=mt*V.b+this.b*V.d,this.c=tt*V.a+this.d*V.c,this.d=tt*V.b+this.d*V.d}return this.tx=k*V.a+this.ty*V.c+V.tx,this.ty=k*V.b+this.ty*V.d+V.ty,this},st.prototype.decompose=function(V){var k=this.a,mt=this.b,tt=this.c,_t=this.d,Dt=V.pivot,Z=-Math.atan2(-tt,_t),ct=Math.atan2(mt,k),rt=Math.abs(Z+ct);return rt<1e-5||Math.abs(R-rt)<1e-5?(V.rotation=ct,V.skew.x=V.skew.y=0):(V.rotation=0,V.skew.x=Z,V.skew.y=ct),V.scale.x=Math.sqrt(k*k+mt*mt),V.scale.y=Math.sqrt(tt*tt+_t*_t),V.position.x=this.tx+(Dt.x*k+Dt.y*tt),V.position.y=this.ty+(Dt.x*mt+Dt.y*_t),V},st.prototype.invert=function(){var V=this.a,k=this.b,mt=this.c,tt=this.d,_t=this.tx,Dt=V*tt-k*mt;return this.a=tt/Dt,this.b=-k/Dt,this.c=-mt/Dt,this.d=V/Dt,this.tx=(mt*this.ty-tt*_t)/Dt,this.ty=-(V*this.ty-k*_t)/Dt,this},st.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},st.prototype.clone=function(){var V=new st;return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},st.prototype.copyTo=function(V){return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},st.prototype.copyFrom=function(V){return this.a=V.a,this.b=V.b,this.c=V.c,this.d=V.d,this.tx=V.tx,this.ty=V.ty,this},st.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(st,"IDENTITY",{get:function(){return new st},enumerable:!1,configurable:!0}),Object.defineProperty(st,"TEMP_MATRIX",{get:function(){return new st},enumerable:!1,configurable:!0}),st}(),I=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],F=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],W=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],P=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],j=[],Q=[],H=Math.sign;(function(){for(var st=0;st<16;st++){var V=[];j.push(V);for(var k=0;k<16;k++)for(var mt=H(I[st]*I[k]+W[st]*F[k]),tt=H(F[st]*I[k]+P[st]*F[k]),_t=H(I[st]*W[k]+W[st]*P[k]),Dt=H(F[st]*W[k]+P[st]*P[k]),Z=0;Z<16;Z++)if(I[Z]===mt&&F[Z]===tt&&W[Z]===_t&&P[Z]===Dt){V.push(Z);break}}for(st=0;st<16;st++){var ct=new L;ct.set(I[st],F[st],W[st],P[st],0,0),Q.push(ct)}})();var Ot={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(st){return I[st]},uY:function(st){return F[st]},vX:function(st){return W[st]},vY:function(st){return P[st]},inv:function(st){return 8&st?15&st:7&-st},add:function(st,V){return j[st][V]},sub:function(st,V){return j[st][Ot.inv(V)]},rotate180:function(st){return 4^st},isVertical:function(st){return(3&st)==2},byDirection:function(st,V){return 2*Math.abs(st)<=Math.abs(V)?V>=0?Ot.S:Ot.N:2*Math.abs(V)<=Math.abs(st)?st>0?Ot.E:Ot.W:V>0?st>0?Ot.SE:Ot.SW:st>0?Ot.NE:Ot.NW},matrixAppendRotationInv:function(st,V,k,mt){k===void 0&&(k=0),mt===void 0&&(mt=0);var tt=Q[Ot.inv(V)];tt.tx=k,tt.ty=mt,st.append(tt)}},Vt=function(){function st(){this.worldTransform=new L,this.localTransform=new L,this.position=new vt(this.onChange,this,0,0),this.scale=new vt(this.onChange,this,1,1),this.pivot=new vt(this.onChange,this,0,0),this.skew=new vt(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return st.prototype.onChange=function(){this._localID++},st.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},st.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},st.prototype.updateLocalTransform=function(){var V=this.localTransform;this._localID!==this._currentLocalID&&(V.a=this._cx*this.scale.x,V.b=this._sx*this.scale.x,V.c=this._cy*this.scale.y,V.d=this._sy*this.scale.y,V.tx=this.position.x-(this.pivot.x*V.a+this.pivot.y*V.c),V.ty=this.position.y-(this.pivot.x*V.b+this.pivot.y*V.d),this._currentLocalID=this._localID,this._parentID=-1)},st.prototype.updateTransform=function(V){var k=this.localTransform;if(this._localID!==this._currentLocalID&&(k.a=this._cx*this.scale.x,k.b=this._sx*this.scale.x,k.c=this._cy*this.scale.y,k.d=this._sy*this.scale.y,k.tx=this.position.x-(this.pivot.x*k.a+this.pivot.y*k.c),k.ty=this.position.y-(this.pivot.x*k.b+this.pivot.y*k.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==V._worldID){var mt=V.worldTransform,tt=this.worldTransform;tt.a=k.a*mt.a+k.b*mt.c,tt.b=k.a*mt.b+k.b*mt.d,tt.c=k.c*mt.a+k.d*mt.c,tt.d=k.c*mt.b+k.d*mt.d,tt.tx=k.tx*mt.a+k.ty*mt.c+mt.tx,tt.ty=k.tx*mt.b+k.ty*mt.d+mt.ty,this._parentID=V._worldID,this._worldID++}},st.prototype.setFromMatrix=function(V){V.decompose(this),this._localID++},Object.defineProperty(st.prototype,"rotation",{get:function(){return this._rotation},set:function(V){this._rotation!==V&&(this._rotation=V,this.updateSkew())},enumerable:!1,configurable:!0}),st.IDENTITY=new st,st}()},function(b,S,v){v.d(S,"a",function(){return wi}),v.d(S,"b",function(){return tt}),v.d(S,"c",function(){return F}),v.d(S,"d",function(){return Io}),v.d(S,"e",function(){return ar}),v.d(S,"f",function(){return No}),v.d(S,"g",function(){return Br}),v.d(S,"h",function(){return Yt}),v.d(S,"i",function(){return L}),v.d(S,"j",function(){return Q}),v.d(S,"k",function(){return Ri}),v.d(S,"l",function(){return Le}),v.d(S,"m",function(){return fe}),v.d(S,"n",function(){return jn}),v.d(S,"o",function(){return ze}),v.d(S,"p",function(){return rt}),v.d(S,"q",function(){return Ni}),v.d(S,"r",function(){return Qi}),v.d(S,"s",function(){return Yr}),v.d(S,"t",function(){return ct}),v.d(S,"u",function(){return Dr}),v.d(S,"v",function(){return cn}),v.d(S,"w",function(){return st}),v.d(S,"x",function(){return Po}),v.d(S,"y",function(){return lo}),v.d(S,"z",function(){return Wn}),v.d(S,"A",function(){return vi});var O=v(4),R=v(0),M=v(3),D=v(12),B=v(7),z=v(1);/*!
 * @pixi/core - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */O.b.PREFER_ENV=M.isMobile.any?R.g.WEBGL:R.g.WEBGL2,O.b.STRICT_TEXTURE_CACHE=!1;var X=[];function J(Y,g){if(!Y)return null;var m="";if(typeof Y=="string"){var y=/\.(\w{3,4})(?:$|\?|#)/i.exec(Y);y&&(m=y[1].toLowerCase())}for(var N=X.length-1;N>=0;--N){var q=X[N];if(q.test&&q.test(Y,m))return new q(Y,g)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var et=function(Y,g){return(et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var N in y)y.hasOwnProperty(N)&&(m[N]=y[N])})(Y,g)};function pt(Y,g){function m(){this.constructor=Y}et(Y,g),Y.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}var Nt=function(){return(Nt=Object.assign||function(Y){for(var g,m=arguments,y=1,N=arguments.length;y<N;y++)for(var q in g=m[y])Object.prototype.hasOwnProperty.call(g,q)&&(Y[q]=g[q]);return Y}).apply(this,arguments)},vt=function(){function Y(g,m){g===void 0&&(g=0),m===void 0&&(m=0),this._width=g,this._height=m,this.destroyed=!1,this.internal=!1,this.onResize=new D.a("setRealSize"),this.onUpdate=new D.a("update"),this.onError=new D.a("onError")}return Y.prototype.bind=function(g){this.onResize.add(g),this.onUpdate.add(g),this.onError.add(g),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},Y.prototype.unbind=function(g){this.onResize.remove(g),this.onUpdate.remove(g),this.onError.remove(g)},Y.prototype.resize=function(g,m){g===this._width&&m===this._height||(this._width=g,this._height=m,this.onResize.emit(g,m))},Object.defineProperty(Y.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),Y.prototype.update=function(){this.destroyed||this.onUpdate.emit()},Y.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(Y.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Y.prototype.style=function(g,m,y){return!1},Y.prototype.dispose=function(){},Y.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Y.test=function(g,m){return!1},Y}(),L=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,bt=q.height;if(!ht||!bt)throw new Error("BufferResource width or height invalid");return(N=Y.call(this,ht,bt)||this).data=m,N}return pt(g,Y),g.prototype.upload=function(m,y,N){var q=m.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===R.a.UNPACK);var ht=y.realWidth,bt=y.realHeight;return N.width===ht&&N.height===bt?q.texSubImage2D(y.target,0,0,0,ht,bt,y.format,N.type,this.data):(N.width=ht,N.height=bt,q.texImage2D(y.target,0,N.internalFormat,ht,bt,0,y.format,N.type,this.data)),!0},g.prototype.dispose=function(){this.data=null},g.test=function(m){return m instanceof Float32Array||m instanceof Uint8Array||m instanceof Uint32Array},g}(vt),I={scaleMode:R.p.NEAREST,format:R.h.RGBA,alphaMode:R.a.NPM},F=function(Y){function g(m,y){m===void 0&&(m=null),y===void 0&&(y=null);var N=Y.call(this)||this,q=(y=y||{}).alphaMode,ht=y.mipmap,bt=y.anisotropicLevel,wt=y.scaleMode,Kt=y.width,ne=y.height,Fe=y.wrapMode,Te=y.format,$e=y.type,hn=y.target,vn=y.resolution,un=y.resourceOptions;return!m||m instanceof vt||((m=J(m,un)).internal=!0),N.resolution=vn||O.b.RESOLUTION,N.width=Math.round((Kt||0)*N.resolution)/N.resolution,N.height=Math.round((ne||0)*N.resolution)/N.resolution,N._mipmap=ht!==void 0?ht:O.b.MIPMAP_TEXTURES,N.anisotropicLevel=bt!==void 0?bt:O.b.ANISOTROPIC_LEVEL,N._wrapMode=Fe||O.b.WRAP_MODE,N._scaleMode=wt!==void 0?wt:O.b.SCALE_MODE,N.format=Te||R.h.RGBA,N.type=$e||R.r.UNSIGNED_BYTE,N.target=hn||R.q.TEXTURE_2D,N.alphaMode=q!==void 0?q:R.a.UNPACK,N.uid=Object(M.uid)(),N.touched=0,N.isPowerOfTwo=!1,N._refreshPOT(),N._glTextures={},N.dirtyId=0,N.dirtyStyleId=0,N.cacheId=null,N.valid=Kt>0&&ne>0,N.textureCacheIds=[],N.destroyed=!1,N.resource=null,N._batchEnabled=0,N._batchLocation=0,N.parentTextureArray=null,N.setResource(m),N}return pt(g,Y),Object.defineProperty(g.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"mipmap",{get:function(){return this._mipmap},set:function(m){this._mipmap!==m&&(this._mipmap=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(m){this._scaleMode!==m&&(this._scaleMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(m){this._wrapMode!==m&&(this._wrapMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),g.prototype.setStyle=function(m,y){var N;return m!==void 0&&m!==this.scaleMode&&(this.scaleMode=m,N=!0),y!==void 0&&y!==this.mipmap&&(this.mipmap=y,N=!0),N&&this.dirtyStyleId++,this},g.prototype.setSize=function(m,y,N){return N=N||this.resolution,this.setRealSize(m*N,y*N,N)},g.prototype.setRealSize=function(m,y,N){return this.resolution=N||this.resolution,this.width=Math.round(m)/this.resolution,this.height=Math.round(y)/this.resolution,this._refreshPOT(),this.update(),this},g.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(M.isPow2)(this.realWidth)&&Object(M.isPow2)(this.realHeight)},g.prototype.setResolution=function(m){var y=this.resolution;return y===m||(this.resolution=m,this.valid&&(this.width=Math.round(this.width*y)/m,this.height=Math.round(this.height*y)/m,this.emit("update",this)),this._refreshPOT()),this},g.prototype.setResource=function(m){if(this.resource===m)return this;if(this.resource)throw new Error("Resource can be set only once");return m.bind(this),this.resource=m,this},g.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},g.prototype.onError=function(m){this.emit("error",this,m)},g.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete M.BaseTextureCache[this.cacheId],delete M.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),g.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},g.prototype.dispose=function(){this.emit("dispose",this)},g.prototype.castToBaseTexture=function(){return this},g.from=function(m,y,N){N===void 0&&(N=O.b.STRICT_TEXTURE_CACHE);var q=typeof m=="string",ht=null;if(q)ht=m;else{if(!m._pixiId){var bt=y&&y.pixiIdPrefix||"pixiid";m._pixiId=bt+"_"+Object(M.uid)()}ht=m._pixiId}var wt=M.BaseTextureCache[ht];if(q&&N&&!wt)throw new Error('The cacheId "'+ht+'" does not exist in BaseTextureCache.');return wt||((wt=new g(m,y)).cacheId=ht,g.addToCache(wt,ht)),wt},g.fromBuffer=function(m,y,N,q){m=m||new Float32Array(y*N*4);var ht=new L(m,{width:y,height:N}),bt=m instanceof Float32Array?R.r.FLOAT:R.r.UNSIGNED_BYTE;return new g(ht,Object.assign(I,q||{width:y,height:N,type:bt}))},g.addToCache=function(m,y){y&&(m.textureCacheIds.indexOf(y)===-1&&m.textureCacheIds.push(y),M.BaseTextureCache[y]&&console.warn("BaseTexture added to the cache with an id ["+y+"] that already had an entry"),M.BaseTextureCache[y]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var y=M.BaseTextureCache[m];if(y){var N=y.textureCacheIds.indexOf(m);return N>-1&&y.textureCacheIds.splice(N,1),delete M.BaseTextureCache[m],y}}else if(m&&m.textureCacheIds){for(var q=0;q<m.textureCacheIds.length;++q)delete M.BaseTextureCache[m.textureCacheIds[q]];return m.textureCacheIds.length=0,m}return null},g._globalBatch=0,g}(M.EventEmitter),W=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,bt=q.height;(N=Y.call(this,ht,bt)||this).items=[],N.itemDirtyIds=[];for(var wt=0;wt<m;wt++){var Kt=new F;N.items.push(Kt),N.itemDirtyIds.push(-2)}return N.length=m,N._load=null,N.baseTexture=null,N}return pt(g,Y),g.prototype.initFromArray=function(m,y){for(var N=0;N<this.length;N++)m[N]&&(m[N].castToBaseTexture?this.addBaseTextureAt(m[N].castToBaseTexture(),N):m[N]instanceof vt?this.addResourceAt(m[N],N):this.addResourceAt(J(m[N],y),N))},g.prototype.dispose=function(){for(var m=0,y=this.length;m<y;m++)this.items[m].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},g.prototype.addResourceAt=function(m,y){if(!this.items[y])throw new Error("Index "+y+" is out of bounds");return m.valid&&!this.valid&&this.resize(m.width,m.height),this.items[y].setResource(m),this},g.prototype.bind=function(m){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");Y.prototype.bind.call(this,m);for(var y=0;y<this.length;y++)this.items[y].parentTextureArray=m,this.items[y].on("update",m.update,m)},g.prototype.unbind=function(m){Y.prototype.unbind.call(this,m);for(var y=0;y<this.length;y++)this.items[y].parentTextureArray=null,this.items[y].off("update",m.update,m)},g.prototype.load=function(){var m=this;if(this._load)return this._load;var y=this.items.map(function(N){return N.resource}).filter(function(N){return N}).map(function(N){return N.load()});return this._load=Promise.all(y).then(function(){var N=m.items[0],q=N.realWidth,ht=N.realHeight;return m.resize(q,ht),Promise.resolve(m)}),this._load},g}(vt),P=function(Y){function g(m,y){var N,q,ht=this,bt=y||{},wt=bt.width,Kt=bt.height;return Array.isArray(m)?(N=m,q=m.length):q=m,ht=Y.call(this,q,{width:wt,height:Kt})||this,N&&ht.initFromArray(N,y),ht}return pt(g,Y),g.prototype.addBaseTextureAt=function(m,y){if(!m.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(m.resource,y),this},g.prototype.bind=function(m){Y.prototype.bind.call(this,m),m.target=R.q.TEXTURE_2D_ARRAY},g.prototype.upload=function(m,y,N){var q=this.length,ht=this.itemDirtyIds,bt=this.items,wt=m.gl;N.dirtyId<0&&wt.texImage3D(wt.TEXTURE_2D_ARRAY,0,N.internalFormat,this._width,this._height,q,0,y.format,N.type,null);for(var Kt=0;Kt<q;Kt++){var ne=bt[Kt];ht[Kt]<ne.dirtyId&&(ht[Kt]=ne.dirtyId,ne.valid&&wt.texSubImage3D(wt.TEXTURE_2D_ARRAY,0,0,0,Kt,ne.resource.width,ne.resource.height,1,y.format,N.type,ne.resource.source))}return!0},g}(W),j=function(Y){function g(m){var y=this,N=m,q=N.naturalWidth||N.videoWidth||N.width,ht=N.naturalHeight||N.videoHeight||N.height;return(y=Y.call(this,q,ht)||this).source=m,y.noSubImage=!1,y}return pt(g,Y),g.crossOrigin=function(m,y,N){N===void 0&&y.indexOf("data:")!==0?m.crossOrigin=Object(M.determineCrossOrigin)(y):N!==!1&&(m.crossOrigin=typeof N=="string"?N:"anonymous")},g.prototype.upload=function(m,y,N,q){var ht=m.gl,bt=y.realWidth,wt=y.realHeight;if((q=q||this.source)instanceof HTMLImageElement){if(!q.complete||q.naturalWidth===0)return!1}else if(q instanceof HTMLVideoElement&&q.readyState<=1)return!1;return ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===R.a.UNPACK),this.noSubImage||y.target!==ht.TEXTURE_2D||N.width!==bt||N.height!==wt?(N.width=bt,N.height=wt,ht.texImage2D(y.target,0,N.internalFormat,y.format,N.type,q)):ht.texSubImage2D(ht.TEXTURE_2D,0,0,0,y.format,N.type,q),!0},g.prototype.update=function(){if(!this.destroyed){var m=this.source,y=m.naturalWidth||m.videoWidth||m.width,N=m.naturalHeight||m.videoHeight||m.height;this.resize(y,N),Y.prototype.update.call(this)}},g.prototype.dispose=function(){this.source=null},g}(vt),Q=function(Y){function g(m){return Y.call(this,m)||this}return pt(g,Y),g.test=function(m){var y=globalThis.OffscreenCanvas;return!!(y&&m instanceof y)||globalThis.HTMLCanvasElement&&m instanceof HTMLCanvasElement},g}(j),H=function(Y){function g(m,y){var N=this,q=y||{},ht=q.width,bt=q.height,wt=q.autoLoad,Kt=q.linkBaseTexture;if(m&&m.length!==g.SIDES)throw new Error("Invalid length. Got "+m.length+", expected 6");N=Y.call(this,6,{width:ht,height:bt})||this;for(var ne=0;ne<g.SIDES;ne++)N.items[ne].target=R.q.TEXTURE_CUBE_MAP_POSITIVE_X+ne;return N.linkBaseTexture=Kt!==!1,m&&N.initFromArray(m,y),wt!==!1&&N.load(),N}return pt(g,Y),g.prototype.bind=function(m){Y.prototype.bind.call(this,m),m.target=R.q.TEXTURE_CUBE_MAP},g.prototype.addBaseTextureAt=function(m,y,N){if(!this.items[y])throw new Error("Index "+y+" is out of bounds");if(!this.linkBaseTexture||m.parentTextureArray||Object.keys(m._glTextures).length>0){if(!m.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(m.resource,y)}else m.target=R.q.TEXTURE_CUBE_MAP_POSITIVE_X+y,m.parentTextureArray=this.baseTexture,this.items[y]=m;return m.valid&&!this.valid&&this.resize(m.realWidth,m.realHeight),this.items[y]=m,this},g.prototype.upload=function(m,y,N){for(var q=this.itemDirtyIds,ht=0;ht<g.SIDES;ht++){var bt=this.items[ht];q[ht]<bt.dirtyId&&(bt.valid&&bt.resource?(bt.resource.upload(m,bt,N),q[ht]=bt.dirtyId):q[ht]<-1&&(m.gl.texImage2D(bt.target,0,N.internalFormat,y.realWidth,y.realHeight,0,y.format,N.type,null),q[ht]=-1))}return!0},g.test=function(m){return Array.isArray(m)&&m.length===g.SIDES},g.SIDES=6,g}(W),Ot=function(Y){function g(m,y){var N=this;if(y=y||{},!(m instanceof HTMLImageElement)){var q=new Image;j.crossOrigin(q,m,y.crossorigin),q.src=m,m=q}return N=Y.call(this,m)||this,!m.complete&&N._width&&N._height&&(N._width=0,N._height=0),N.url=m.src,N._process=null,N.preserveBitmap=!1,N.createBitmap=(y.createBitmap!==void 0?y.createBitmap:O.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,N.alphaMode=typeof y.alphaMode=="number"?y.alphaMode:null,N.bitmap=null,N._load=null,y.autoLoad!==!1&&N.load(),N}return pt(g,Y),g.prototype.load=function(m){var y=this;return this._load||(m!==void 0&&(this.createBitmap=m),this._load=new Promise(function(N,q){var ht=y.source;y.url=ht.src;var bt=function(){y.destroyed||(ht.onload=null,ht.onerror=null,y.resize(ht.width,ht.height),y._load=null,y.createBitmap?N(y.process()):N(y))};ht.complete&&ht.src?bt():(ht.onload=bt,ht.onerror=function(wt){q(wt),y.onError.emit(wt)})})),this._load},g.prototype.process=function(){var m=this,y=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var N=globalThis.createImageBitmap,q=!y.crossOrigin||y.crossOrigin==="anonymous";return this._process=fetch(y.src,{mode:q?"cors":"no-cors"}).then(function(ht){return ht.blob()}).then(function(ht){return N(ht,0,0,y.width,y.height,{premultiplyAlpha:m.alphaMode===R.a.UNPACK?"premultiply":"none"})}).then(function(ht){return m.destroyed?Promise.reject():(m.bitmap=ht,m.update(),m._process=null,Promise.resolve(m))}),this._process},g.prototype.upload=function(m,y,N){if(typeof this.alphaMode=="number"&&(y.alphaMode=this.alphaMode),!this.createBitmap)return Y.prototype.upload.call(this,m,y,N);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(Y.prototype.upload.call(this,m,y,N,this.bitmap),!this.preserveBitmap){var q=!0,ht=y._glTextures;for(var bt in ht){var wt=ht[bt];if(wt!==N&&wt.dirtyId!==y.dirtyId){q=!1;break}}q&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},g.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,Y.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},g.test=function(m){return typeof m=="string"||m instanceof HTMLImageElement},g}(j),Vt=function(Y){function g(m,y){var N=this;return y=y||{},(N=Y.call(this,document.createElement("canvas"))||this)._width=0,N._height=0,N.svg=m,N.scale=y.scale||1,N._overrideWidth=y.width,N._overrideHeight=y.height,N._resolve=null,N._crossorigin=y.crossorigin,N._load=null,y.autoLoad!==!1&&N.load(),N}return pt(g,Y),g.prototype.load=function(){var m=this;return this._load||(this._load=new Promise(function(y){if(m._resolve=function(){m.resize(m.source.width,m.source.height),y(m)},g.SVG_XML.test(m.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");m.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(m.svg)))}m._loadSvg()})),this._load},g.prototype._loadSvg=function(){var m=this,y=new Image;j.crossOrigin(y,this.svg,this._crossorigin),y.src=this.svg,y.onerror=function(N){m._resolve&&(y.onerror=null,m.onError.emit(N))},y.onload=function(){if(m._resolve){var N=y.width,q=y.height;if(!N||!q)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var ht=N*m.scale,bt=q*m.scale;(m._overrideWidth||m._overrideHeight)&&(ht=m._overrideWidth||m._overrideHeight/q*N,bt=m._overrideHeight||m._overrideWidth/N*q),ht=Math.round(ht),bt=Math.round(bt);var wt=m.source;wt.width=ht,wt.height=bt,wt._pixiId="canvas_"+Object(M.uid)(),wt.getContext("2d").drawImage(y,0,0,N,q,0,0,ht,bt),m._resolve(),m._resolve=null}}},g.getSize=function(m){var y=g.SVG_SIZE.exec(m),N={};return y&&(N[y[1]]=Math.round(parseFloat(y[3])),N[y[5]]=Math.round(parseFloat(y[7]))),N},g.prototype.dispose=function(){Y.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},g.test=function(m,y){return y==="svg"||typeof m=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(m)||typeof m=="string"&&g.SVG_XML.test(m)},g.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,g.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,g}(j),st=function(Y){function g(m,y){var N=this;if(y=y||{},!(m instanceof HTMLVideoElement)){var q=document.createElement("video");q.setAttribute("preload","auto"),q.setAttribute("webkit-playsinline",""),q.setAttribute("playsinline",""),typeof m=="string"&&(m=[m]);var ht=m[0].src||m[0];j.crossOrigin(q,ht,y.crossorigin);for(var bt=0;bt<m.length;++bt){var wt=document.createElement("source"),Kt=m[bt],ne=Kt.src,Fe=Kt.mime,Te=(ne=ne||m[bt]).split("?").shift().toLowerCase(),$e=Te.slice(Te.lastIndexOf(".")+1);Fe=Fe||g.MIME_TYPES[$e]||"video/"+$e,wt.src=ne,wt.type=Fe,q.appendChild(wt)}m=q}return(N=Y.call(this,m)||this).noSubImage=!0,N._autoUpdate=!0,N._isConnectedToTicker=!1,N._updateFPS=y.updateFPS||0,N._msToNextUpdate=0,N.autoPlay=y.autoPlay!==!1,N._load=null,N._resolve=null,N._onCanPlay=N._onCanPlay.bind(N),N._onError=N._onError.bind(N),y.autoLoad!==!1&&N.load(),N}return pt(g,Y),g.prototype.update=function(m){if(!this.destroyed){var y=B.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-y),(!this._updateFPS||this._msToNextUpdate<=0)&&(Y.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},g.prototype.load=function(){var m=this;if(this._load)return this._load;var y=this.source;return(y.readyState===y.HAVE_ENOUGH_DATA||y.readyState===y.HAVE_FUTURE_DATA)&&y.width&&y.height&&(y.complete=!0),y.addEventListener("play",this._onPlayStart.bind(this)),y.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(y.addEventListener("canplay",this._onCanPlay),y.addEventListener("canplaythrough",this._onCanPlay),y.addEventListener("error",this._onError,!0)),this._load=new Promise(function(N){m.valid?N(m):(m._resolve=N,y.load())}),this._load},g.prototype._onError=function(m){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(m)},g.prototype._isSourcePlaying=function(){var m=this.source;return m.currentTime>0&&m.paused===!1&&m.ended===!1&&m.readyState>2},g.prototype._isSourceReady=function(){var m=this.source;return m.readyState===3||m.readyState===4},g.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(B.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},g.prototype._onPlayStop=function(){this._isConnectedToTicker&&(B.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},g.prototype._onCanPlay=function(){var m=this.source;m.removeEventListener("canplay",this._onCanPlay),m.removeEventListener("canplaythrough",this._onCanPlay);var y=this.valid;this.resize(m.videoWidth,m.videoHeight),!y&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&m.play()},g.prototype.dispose=function(){this._isConnectedToTicker&&(B.a.shared.remove(this.update,this),this._isConnectedToTicker=!1);var m=this.source;m&&(m.removeEventListener("error",this._onError,!0),m.pause(),m.src="",m.load()),Y.prototype.dispose.call(this)},Object.defineProperty(g.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(m){m!==this._autoUpdate&&(this._autoUpdate=m,!this._autoUpdate&&this._isConnectedToTicker?(B.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(B.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(m){m!==this._updateFPS&&(this._updateFPS=m)},enumerable:!1,configurable:!0}),g.test=function(m,y){return globalThis.HTMLVideoElement&&m instanceof HTMLVideoElement||g.TYPES.indexOf(y)>-1},g.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],g.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},g}(j),V=function(Y){function g(m){return Y.call(this,m)||this}return pt(g,Y),g.test=function(m){return!!globalThis.createImageBitmap&&m instanceof ImageBitmap},g}(j);X.push(Ot,V,Q,st,Vt,L,H,P);var k=function(Y){function g(){return Y!==null&&Y.apply(this,arguments)||this}return pt(g,Y),g.prototype.upload=function(m,y,N){var q=m.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.alphaMode===R.a.UNPACK);var ht=y.realWidth,bt=y.realHeight;return N.width===ht&&N.height===bt?q.texSubImage2D(y.target,0,0,0,ht,bt,y.format,N.type,this.data):(N.width=ht,N.height=bt,q.texImage2D(y.target,0,N.internalFormat,ht,bt,0,y.format,N.type,this.data)),!0},g}(L),mt=function(){function Y(g,m){this.width=Math.round(g||100),this.height=Math.round(m||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new D.a("disposeFramebuffer"),this.multisample=R.l.NONE}return Object.defineProperty(Y.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),Y.prototype.addColorTexture=function(g,m){return g===void 0&&(g=0),this.colorTextures[g]=m||new F(null,{scaleMode:R.p.NEAREST,resolution:1,mipmap:R.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Y.prototype.addDepthTexture=function(g){return this.depthTexture=g||new F(new k(null,{width:this.width,height:this.height}),{scaleMode:R.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:R.k.OFF,format:R.h.DEPTH_COMPONENT,type:R.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Y.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Y.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Y.prototype.resize=function(g,m){if(g=Math.round(g),m=Math.round(m),g!==this.width||m!==this.height){this.width=g,this.height=m,this.dirtyId++,this.dirtySize++;for(var y=0;y<this.colorTextures.length;y++){var N=this.colorTextures[y],q=N.resolution;N.setSize(g/q,m/q)}this.depthTexture&&(q=this.depthTexture.resolution,this.depthTexture.setSize(g/q,m/q))}},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},Y}(),tt=function(Y){function g(m){m===void 0&&(m={});var y=this;if(typeof m=="number"){var N=arguments[0],q=arguments[1],ht=arguments[2],bt=arguments[3];m={width:N,height:q,scaleMode:ht,resolution:bt}}return m.width=m.width||100,m.height=m.height||100,m.multisample=m.multisample!==void 0?m.multisample:R.l.NONE,(y=Y.call(this,null,m)||this).mipmap=R.k.OFF,y.valid=!0,y.clearColor=[0,0,0,0],y.framebuffer=new mt(y.realWidth,y.realHeight).addColorTexture(0,y),y.framebuffer.multisample=m.multisample,y.maskStack=[],y.filterStack=[{}],y}return pt(g,Y),g.prototype.resize=function(m,y){this.framebuffer.resize(m*this.resolution,y*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},g.prototype.dispose=function(){this.framebuffer.dispose(),Y.prototype.dispose.call(this)},g.prototype.destroy=function(){Y.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},g}(F),_t=function(){function Y(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return Y.prototype.set=function(g,m,y){var N=m.width,q=m.height;if(y){var ht=g.width/2/N,bt=g.height/2/q,wt=g.x/N+ht,Kt=g.y/q+bt;y=z.n.add(y,z.n.NW),this.x0=wt+ht*z.n.uX(y),this.y0=Kt+bt*z.n.uY(y),y=z.n.add(y,2),this.x1=wt+ht*z.n.uX(y),this.y1=Kt+bt*z.n.uY(y),y=z.n.add(y,2),this.x2=wt+ht*z.n.uX(y),this.y2=Kt+bt*z.n.uY(y),y=z.n.add(y,2),this.x3=wt+ht*z.n.uX(y),this.y3=Kt+bt*z.n.uY(y)}else this.x0=g.x/N,this.y0=g.y/q,this.x1=(g.x+g.width)/N,this.y1=g.y/q,this.x2=(g.x+g.width)/N,this.y2=(g.y+g.height)/q,this.x3=g.x/N,this.y3=(g.y+g.height)/q;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},Y.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},Y}(),Dt=new _t;function Z(Y){Y.destroy=function(){},Y.on=function(){},Y.once=function(){},Y.emit=function(){}}var ct=function(Y){function g(m,y,N,q,ht,bt){var wt=Y.call(this)||this;if(wt.noFrame=!1,y||(wt.noFrame=!0,y=new z.j(0,0,1,1)),m instanceof g&&(m=m.baseTexture),wt.baseTexture=m,wt._frame=y,wt.trim=q,wt.valid=!1,wt._uvs=Dt,wt.uvMatrix=null,wt.orig=N||y,wt._rotate=Number(ht||0),ht===!0)wt._rotate=2;else if(wt._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return wt.defaultAnchor=bt?new z.g(bt.x,bt.y):new z.g(0,0),wt._updateID=0,wt.textureCacheIds=[],m.valid?wt.noFrame?m.valid&&wt.onBaseTextureUpdated(m):wt.frame=y:m.once("loaded",wt.onBaseTextureUpdated,wt),wt.noFrame&&m.on("update",wt.onBaseTextureUpdated,wt),wt}return pt(g,Y),g.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},g.prototype.onBaseTextureUpdated=function(m){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=m.width,this._frame.height=m.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},g.prototype.destroy=function(m){if(this.baseTexture){if(m){var y=this.baseTexture.resource;y&&y.url&&M.TextureCache[y.url]&&g.removeFromCache(y.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,g.removeFromCache(this),this.textureCacheIds=null},g.prototype.clone=function(){var m=this._frame.clone(),y=this._frame===this.orig?m:this.orig.clone(),N=new g(this.baseTexture,!this.noFrame&&m,y,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(N._frame=m),N},g.prototype.updateUvs=function(){this._uvs===Dt&&(this._uvs=new _t),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},g.from=function(m,y,N){y===void 0&&(y={}),N===void 0&&(N=O.b.STRICT_TEXTURE_CACHE);var q=typeof m=="string",ht=null;if(q)ht=m;else if(m instanceof F){if(!m.cacheId){var bt=y&&y.pixiIdPrefix||"pixiid";m.cacheId=bt+"-"+Object(M.uid)(),F.addToCache(m,m.cacheId)}ht=m.cacheId}else m._pixiId||(bt=y&&y.pixiIdPrefix||"pixiid",m._pixiId=bt+"_"+Object(M.uid)()),ht=m._pixiId;var wt=M.TextureCache[ht];if(q&&N&&!wt)throw new Error('The cacheId "'+ht+'" does not exist in TextureCache.');return wt||m instanceof F?!wt&&m instanceof F&&(wt=new g(m),g.addToCache(wt,ht)):(y.resolution||(y.resolution=Object(M.getResolutionOfUrl)(m)),(wt=new g(new F(m,y))).baseTexture.cacheId=ht,F.addToCache(wt.baseTexture,ht),g.addToCache(wt,ht)),wt},g.fromURL=function(m,y){var N=Object.assign({autoLoad:!1},y==null?void 0:y.resourceOptions),q=g.from(m,Object.assign({resourceOptions:N},y),!1),ht=q.baseTexture.resource;return q.baseTexture.valid?Promise.resolve(q):ht.load().then(function(){return Promise.resolve(q)})},g.fromBuffer=function(m,y,N,q){return new g(F.fromBuffer(m,y,N,q))},g.fromLoader=function(m,y,N,q){var ht=new F(m,Object.assign({scaleMode:O.b.SCALE_MODE,resolution:Object(M.getResolutionOfUrl)(y)},q)),bt=ht.resource;bt instanceof Ot&&(bt.url=y);var wt=new g(ht);return N||(N=y),F.addToCache(wt.baseTexture,N),g.addToCache(wt,N),N!==y&&(F.addToCache(wt.baseTexture,y),g.addToCache(wt,y)),wt.baseTexture.valid?Promise.resolve(wt):new Promise(function(Kt){wt.baseTexture.once("loaded",function(){return Kt(wt)})})},g.addToCache=function(m,y){y&&(m.textureCacheIds.indexOf(y)===-1&&m.textureCacheIds.push(y),M.TextureCache[y]&&console.warn("Texture added to the cache with an id ["+y+"] that already had an entry"),M.TextureCache[y]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var y=M.TextureCache[m];if(y){var N=y.textureCacheIds.indexOf(m);return N>-1&&y.textureCacheIds.splice(N,1),delete M.TextureCache[m],y}}else if(m&&m.textureCacheIds){for(var q=0;q<m.textureCacheIds.length;++q)M.TextureCache[m.textureCacheIds[q]]===m&&delete M.TextureCache[m.textureCacheIds[q]];return m.textureCacheIds.length=0,m}return null},Object.defineProperty(g.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"frame",{get:function(){return this._frame},set:function(m){this._frame=m,this.noFrame=!1;var y=m.x,N=m.y,q=m.width,ht=m.height,bt=y+q>this.baseTexture.width,wt=N+ht>this.baseTexture.height;if(bt||wt){var Kt=bt&&wt?"and":"or",ne="X: "+y+" + "+q+" = "+(y+q)+" > "+this.baseTexture.width,Fe="Y: "+N+" + "+ht+" = "+(N+ht)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+ne+" "+Kt+" "+Fe)}this.valid=q&&ht&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=m),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"rotate",{get:function(){return this._rotate},set:function(m){this._rotate=m,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),g.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(g,"EMPTY",{get:function(){return g._EMPTY||(g._EMPTY=new g(new F),Z(g._EMPTY),Z(g._EMPTY.baseTexture)),g._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(g,"WHITE",{get:function(){if(!g._WHITE){var m=document.createElement("canvas"),y=m.getContext("2d");m.width=16,m.height=16,y.fillStyle="white",y.fillRect(0,0,16,16),g._WHITE=new g(new F(new Q(m))),Z(g._WHITE),Z(g._WHITE.baseTexture)}return g._WHITE},enumerable:!1,configurable:!0}),g}(M.EventEmitter),rt=function(Y){function g(m,y){var N=Y.call(this,m,y)||this;return N.valid=!0,N.filterFrame=null,N.filterPoolKey=null,N.updateUvs(),N}return pt(g,Y),Object.defineProperty(g.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(m){this.framebuffer.multisample=m},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,y,N){N===void 0&&(N=!0);var q=this.baseTexture.resolution,ht=Math.round(m*q)/q,bt=Math.round(y*q)/q;this.valid=ht>0&&bt>0,this._frame.width=this.orig.width=ht,this._frame.height=this.orig.height=bt,N&&this.baseTexture.resize(ht,bt),this.updateUvs()},g.prototype.setResolution=function(m){var y=this.baseTexture;y.resolution!==m&&(y.setResolution(m),this.resize(y.width,y.height,!1))},g.create=function(m){for(var y=arguments,N=[],q=1;q<arguments.length;q++)N[q-1]=y[q];return typeof m=="number"&&(Object(M.deprecation)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),m={width:m,height:N[0],scaleMode:N[1],resolution:N[2]}),new g(new tt(m))},g}(ct),yt=function(){function Y(g){this.texturePool={},this.textureOptions=g||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return Y.prototype.createTexture=function(g,m,y){y===void 0&&(y=R.l.NONE);var N=new tt(Object.assign({width:g,height:m,resolution:1,multisample:y},this.textureOptions));return new rt(N)},Y.prototype.getOptimalTexture=function(g,m,y,N){var q;y===void 0&&(y=1),N===void 0&&(N=R.l.NONE),g=Math.ceil(g*y-1e-6),m=Math.ceil(m*y-1e-6),this.enableFullScreen&&g===this._pixelsWidth&&m===this._pixelsHeight?q=N>1?-N:-1:(q=((65535&(g=Object(M.nextPow2)(g)))<<16|65535&(m=Object(M.nextPow2)(m)))>>>0,N>1&&(q+=4294967296*N)),this.texturePool[q]||(this.texturePool[q]=[]);var ht=this.texturePool[q].pop();return ht||(ht=this.createTexture(g,m,N)),ht.filterPoolKey=q,ht.setResolution(y),ht},Y.prototype.getFilterTexture=function(g,m,y){var N=this.getOptimalTexture(g.width,g.height,m||g.resolution,y||R.l.NONE);return N.filterFrame=g.filterFrame,N},Y.prototype.returnTexture=function(g){var m=g.filterPoolKey;g.filterFrame=null,this.texturePool[m].push(g)},Y.prototype.returnFilterTexture=function(g){this.returnTexture(g)},Y.prototype.clear=function(g){if(g=g!==!1)for(var m in this.texturePool){var y=this.texturePool[m];if(y)for(var N=0;N<y.length;N++)y[N].destroy(!0)}this.texturePool={}},Y.prototype.setScreenSize=function(g){if(g.width!==this._pixelsWidth||g.height!==this._pixelsHeight){for(var m in this.enableFullScreen=g.width>0&&g.height>0,this.texturePool)if(Number(m)<0){var y=this.texturePool[m];if(y)for(var N=0;N<y.length;N++)y[N].destroy(!0);this.texturePool[m]=[]}this._pixelsWidth=g.width,this._pixelsHeight=g.height}},Y.SCREEN_KEY=-1,Y}(),At=function(){function Y(g,m,y,N,q,ht,bt){m===void 0&&(m=0),y===void 0&&(y=!1),N===void 0&&(N=R.r.FLOAT),this.buffer=g,this.size=m,this.normalized=y,this.type=N,this.stride=q,this.start=ht,this.instance=bt}return Y.prototype.destroy=function(){this.buffer=null},Y.from=function(g,m,y,N,q){return new Y(g,m,y,N,q)},Y}(),Gt=0,Yt=function(){function Y(g,m,y){m===void 0&&(m=!0),y===void 0&&(y=!1),this.data=g||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=y,this.static=m,this.id=Gt++,this.disposeRunner=new D.a("disposeBuffer")}return Y.prototype.update=function(g){g instanceof Array&&(g=new Float32Array(g)),this.data=g||this.data,this._updateID++},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(Y.prototype,"index",{get:function(){return this.type===R.d.ELEMENT_ARRAY_BUFFER},set:function(g){this.type=g?R.d.ELEMENT_ARRAY_BUFFER:R.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),Y.from=function(g){return g instanceof Array&&(g=new Float32Array(g)),new Y(g)},Y}(),Jt={Float32Array,Uint32Array,Int32Array,Uint8Array},at={5126:4,5123:2,5121:1},_e=0,ke={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Le=function(){function Y(g,m){g===void 0&&(g=[]),m===void 0&&(m={}),this.buffers=g,this.indexBuffer=null,this.attributes=m,this.glVertexArrayObjects={},this.id=_e++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new D.a("disposeGeometry"),this.refCount=0}return Y.prototype.addAttribute=function(g,m,y,N,q,ht,bt,wt){if(y===void 0&&(y=0),N===void 0&&(N=!1),wt===void 0&&(wt=!1),!m)throw new Error("You must pass a buffer when creating an attribute");m instanceof Yt||(m instanceof Array&&(m=new Float32Array(m)),m=new Yt(m));var Kt=g.split("|");if(Kt.length>1){for(var ne=0;ne<Kt.length;ne++)this.addAttribute(Kt[ne],m,y,N,q);return this}var Fe=this.buffers.indexOf(m);return Fe===-1&&(this.buffers.push(m),Fe=this.buffers.length-1),this.attributes[g]=new At(Fe,y,N,q,ht,bt,wt),this.instanced=this.instanced||wt,this},Y.prototype.getAttribute=function(g){return this.attributes[g]},Y.prototype.getBuffer=function(g){return this.buffers[this.getAttribute(g).buffer]},Y.prototype.addIndex=function(g){return g instanceof Yt||(g instanceof Array&&(g=new Uint16Array(g)),g=new Yt(g)),g.type=R.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=g,this.buffers.indexOf(g)===-1&&this.buffers.push(g),this},Y.prototype.getIndex=function(){return this.indexBuffer},Y.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var g,m=[],y=[],N=new Yt;for(g in this.attributes){var q=this.attributes[g],ht=this.buffers[q.buffer];m.push(ht.data),y.push(q.size*at[q.type]/4),q.buffer=0}for(N.data=function(bt,wt){for(var Kt=0,ne=0,Fe={},Te=0;Te<bt.length;Te++)ne+=wt[Te],Kt+=bt[Te].length;var $e=new ArrayBuffer(4*Kt),hn=null,vn=0;for(Te=0;Te<bt.length;Te++){var un=wt[Te],Kn=bt[Te],_i=Object(M.getBufferType)(Kn);Fe[_i]||(Fe[_i]=new Jt[_i]($e)),hn=Fe[_i];for(var yi=0;yi<Kn.length;yi++)hn[(yi/un|0)*ne+vn+yi%un]=Kn[yi];vn+=un}return new Float32Array($e)}(m,y),g=0;g<this.buffers.length;g++)this.buffers[g]!==this.indexBuffer&&this.buffers[g].destroy();return this.buffers=[N],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Y.prototype.getSize=function(){for(var g in this.attributes){var m=this.attributes[g];return this.buffers[m.buffer].data.length/(m.stride/4||m.size)}return 0},Y.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Y.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Y.prototype.clone=function(){for(var g=new Y,m=0;m<this.buffers.length;m++)g.buffers[m]=new Yt(this.buffers[m].data.slice(0));for(var m in this.attributes){var y=this.attributes[m];g.attributes[m]=new At(y.buffer,y.size,y.normalized,y.type,y.stride,y.start,y.instance)}return this.indexBuffer&&(g.indexBuffer=g.buffers[this.buffers.indexOf(this.indexBuffer)],g.indexBuffer.type=R.d.ELEMENT_ARRAY_BUFFER),g},Y.merge=function(g){for(var m,y=new Y,N=[],q=[],ht=[],bt=0;bt<g.length;bt++){m=g[bt];for(var wt=0;wt<m.buffers.length;wt++)q[wt]=q[wt]||0,q[wt]+=m.buffers[wt].data.length,ht[wt]=0}for(bt=0;bt<m.buffers.length;bt++)N[bt]=new ke[Object(M.getBufferType)(m.buffers[bt].data)](q[bt]),y.buffers[bt]=new Yt(N[bt]);for(bt=0;bt<g.length;bt++)for(m=g[bt],wt=0;wt<m.buffers.length;wt++)N[wt].set(m.buffers[wt].data,ht[wt]),ht[wt]+=m.buffers[wt].data.length;if(y.attributes=m.attributes,m.indexBuffer){y.indexBuffer=y.buffers[m.buffers.indexOf(m.indexBuffer)],y.indexBuffer.type=R.d.ELEMENT_ARRAY_BUFFER;var Kt=0,ne=0,Fe=0,Te=0;for(bt=0;bt<m.buffers.length;bt++)if(m.buffers[bt]!==m.indexBuffer){Te=bt;break}for(var bt in m.attributes){var $e=m.attributes[bt];(0|$e.buffer)===Te&&(ne+=$e.size*at[$e.type]/4)}for(bt=0;bt<g.length;bt++){var hn=g[bt].indexBuffer.data;for(wt=0;wt<hn.length;wt++)y.indexBuffer.data[wt+Fe]+=Kt;Kt+=g[bt].buffers[Te].data.length/ne,Fe+=hn.length}}return y},Y}(),Ae=function(Y){function g(){var m=Y.call(this)||this;return m.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),m}return pt(g,Y),g}(Le),ze=function(Y){function g(){var m=Y.call(this)||this;return m.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),m.uvs=new Float32Array([0,0,1,0,1,1,0,1]),m.vertexBuffer=new Yt(m.vertices),m.uvBuffer=new Yt(m.uvs),m.addAttribute("aVertexPosition",m.vertexBuffer).addAttribute("aTextureCoord",m.uvBuffer).addIndex([0,1,2,0,2,3]),m}return pt(g,Y),g.prototype.map=function(m,y){var N=0,q=0;return this.uvs[0]=N,this.uvs[1]=q,this.uvs[2]=N+y.width/m.width,this.uvs[3]=q,this.uvs[4]=N+y.width/m.width,this.uvs[5]=q+y.height/m.height,this.uvs[6]=N,this.uvs[7]=q+y.height/m.height,N=y.x,q=y.y,this.vertices[0]=N,this.vertices[1]=q,this.vertices[2]=N+y.width,this.vertices[3]=q,this.vertices[4]=N+y.width,this.vertices[5]=q+y.height,this.vertices[6]=N,this.vertices[7]=q+y.height,this.invalidate(),this},g.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},g}(Le),Qe=0,cn=function(){function Y(g,m,y){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Qe++,this.static=!!m,this.ubo=!!y,g instanceof Yt?(this.buffer=g,this.buffer.type=R.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=g,this.ubo&&(this.buffer=new Yt(new Float32Array(1)),this.buffer.type=R.d.UNIFORM_BUFFER,this.autoManage=!0))}return Y.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},Y.prototype.add=function(g,m,y){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[g]=new Y(m,y)},Y.from=function(g,m,y){return new Y(g,m,y)},Y.uboFrom=function(g,m){return new Y(g,m==null||m,!0)},Y}(),Ue=function(){function Y(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=R.l.NONE,this.sourceFrame=new z.j,this.destinationFrame=new z.j,this.bindingSourceFrame=new z.j,this.bindingDestinationFrame=new z.j,this.filters=[],this.transform=null}return Y.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},Y}(),Ge=[new z.g,new z.g,new z.g,new z.g],Rn=new z.d,re=function(){function Y(g){this.renderer=g,this.defaultFilterStack=[{}],this.texturePool=new yt,this.texturePool.setScreenSize(g.view),this.statePool=[],this.quad=new Ae,this.quadUv=new ze,this.tempRect=new z.j,this.activeState={},this.globalUniforms=new cn({outputFrame:new z.j,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return Y.prototype.push=function(g,m){for(var y,N,q=this.renderer,ht=this.defaultFilterStack,bt=this.statePool.pop()||new Ue,wt=this.renderer.renderTexture,Kt=m[0].resolution,ne=m[0].multisample,Fe=m[0].padding,Te=m[0].autoFit,$e=(y=m[0].legacy)===null||y===void 0||y,hn=1;hn<m.length;hn++){var vn=m[hn];Kt=Math.min(Kt,vn.resolution),ne=Math.min(ne,vn.multisample),Fe=this.useMaxPadding?Math.max(Fe,vn.padding):Fe+vn.padding,Te=Te&&vn.autoFit,$e=$e||(N=vn.legacy)===null||N===void 0||N}ht.length===1&&(this.defaultFilterStack[0].renderTexture=wt.current),ht.push(bt),bt.resolution=Kt,bt.multisample=ne,bt.legacy=$e,bt.target=g,bt.sourceFrame.copyFrom(g.filterArea||g.getBounds(!0)),bt.sourceFrame.pad(Fe);var un=this.tempRect.copyFrom(wt.sourceFrame);q.projection.transform&&this.transformAABB(Rn.copyFrom(q.projection.transform).invert(),un),Te?(bt.sourceFrame.fit(un),(bt.sourceFrame.width<=0||bt.sourceFrame.height<=0)&&(bt.sourceFrame.width=0,bt.sourceFrame.height=0)):bt.sourceFrame.intersects(un)||(bt.sourceFrame.width=0,bt.sourceFrame.height=0),this.roundFrame(bt.sourceFrame,wt.current?wt.current.resolution:q.resolution,wt.sourceFrame,wt.destinationFrame,q.projection.transform),bt.renderTexture=this.getOptimalFilterTexture(bt.sourceFrame.width,bt.sourceFrame.height,Kt,ne),bt.filters=m,bt.destinationFrame.width=bt.renderTexture.width,bt.destinationFrame.height=bt.renderTexture.height;var Kn=this.tempRect;Kn.x=0,Kn.y=0,Kn.width=bt.sourceFrame.width,Kn.height=bt.sourceFrame.height,bt.renderTexture.filterFrame=bt.sourceFrame,bt.bindingSourceFrame.copyFrom(wt.sourceFrame),bt.bindingDestinationFrame.copyFrom(wt.destinationFrame),bt.transform=q.projection.transform,q.projection.transform=null,wt.bind(bt.renderTexture,bt.sourceFrame,Kn),q.framebuffer.clear(0,0,0,0)},Y.prototype.pop=function(){var g=this.defaultFilterStack,m=g.pop(),y=m.filters;this.activeState=m;var N=this.globalUniforms.uniforms;N.outputFrame=m.sourceFrame,N.resolution=m.resolution;var q=N.inputSize,ht=N.inputPixel,bt=N.inputClamp;if(q[0]=m.destinationFrame.width,q[1]=m.destinationFrame.height,q[2]=1/q[0],q[3]=1/q[1],ht[0]=Math.round(q[0]*m.resolution),ht[1]=Math.round(q[1]*m.resolution),ht[2]=1/ht[0],ht[3]=1/ht[1],bt[0]=.5*ht[2],bt[1]=.5*ht[3],bt[2]=m.sourceFrame.width*q[2]-.5*ht[2],bt[3]=m.sourceFrame.height*q[3]-.5*ht[3],m.legacy){var wt=N.filterArea;wt[0]=m.destinationFrame.width,wt[1]=m.destinationFrame.height,wt[2]=m.sourceFrame.x,wt[3]=m.sourceFrame.y,N.filterClamp=N.inputClamp}this.globalUniforms.update();var Kt=g[g.length-1];if(this.renderer.framebuffer.blit(),y.length===1)y[0].apply(this,m.renderTexture,Kt.renderTexture,R.e.BLEND,m),this.returnFilterTexture(m.renderTexture);else{var ne=m.renderTexture,Fe=this.getOptimalFilterTexture(ne.width,ne.height,m.resolution);Fe.filterFrame=ne.filterFrame;var Te=0;for(Te=0;Te<y.length-1;++Te){Te===1&&m.multisample>1&&((Fe=this.getOptimalFilterTexture(ne.width,ne.height,m.resolution)).filterFrame=ne.filterFrame),y[Te].apply(this,ne,Fe,R.e.CLEAR,m);var $e=ne;ne=Fe,Fe=$e}y[Te].apply(this,ne,Kt.renderTexture,R.e.BLEND,m),Te>1&&m.multisample>1&&this.returnFilterTexture(m.renderTexture),this.returnFilterTexture(ne),this.returnFilterTexture(Fe)}m.clear(),this.statePool.push(m)},Y.prototype.bindAndClear=function(g,m){m===void 0&&(m=R.e.CLEAR);var y=this.renderer,N=y.renderTexture,q=y.state;if(g===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,g&&g.filterFrame){var ht=this.tempRect;ht.x=0,ht.y=0,ht.width=g.filterFrame.width,ht.height=g.filterFrame.height,N.bind(g,g.filterFrame,ht)}else g!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?N.bind(g):this.renderer.renderTexture.bind(g,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var bt=1&q.stateId||this.forceClear;(m===R.e.CLEAR||m===R.e.BLIT&&bt)&&this.renderer.framebuffer.clear(0,0,0,0)},Y.prototype.applyFilter=function(g,m,y,N){var q=this.renderer;q.state.set(g.state),this.bindAndClear(y,N),g.uniforms.uSampler=m,g.uniforms.filterGlobals=this.globalUniforms,q.shader.bind(g),g.legacy=!!g.program.attributeData.aTextureCoord,g.legacy?(this.quadUv.map(m._frame,m.filterFrame),q.geometry.bind(this.quadUv),q.geometry.draw(R.f.TRIANGLES)):(q.geometry.bind(this.quad),q.geometry.draw(R.f.TRIANGLE_STRIP))},Y.prototype.calculateSpriteMatrix=function(g,m){var y=this.activeState,N=y.sourceFrame,q=y.destinationFrame,ht=m._texture.orig,bt=g.set(q.width,0,0,q.height,N.x,N.y),wt=m.worldTransform.copyTo(z.d.TEMP_MATRIX);return wt.invert(),bt.prepend(wt),bt.scale(1/ht.width,1/ht.height),bt.translate(m.anchor.x,m.anchor.y),bt},Y.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},Y.prototype.getOptimalFilterTexture=function(g,m,y,N){return y===void 0&&(y=1),N===void 0&&(N=R.l.NONE),this.texturePool.getOptimalTexture(g,m,y,N)},Y.prototype.getFilterTexture=function(g,m,y){if(typeof g=="number"){var N=g;g=m,m=N}g=g||this.activeState.renderTexture;var q=this.texturePool.getOptimalTexture(g.width,g.height,m||g.resolution,y||R.l.NONE);return q.filterFrame=g.filterFrame,q},Y.prototype.returnFilterTexture=function(g){this.texturePool.returnTexture(g)},Y.prototype.emptyPool=function(){this.texturePool.clear(!0)},Y.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},Y.prototype.transformAABB=function(g,m){var y=Ge[0],N=Ge[1],q=Ge[2],ht=Ge[3];y.set(m.left,m.top),N.set(m.left,m.bottom),q.set(m.right,m.top),ht.set(m.right,m.bottom),g.apply(y,y),g.apply(N,N),g.apply(q,q),g.apply(ht,ht);var bt=Math.min(y.x,N.x,q.x,ht.x),wt=Math.min(y.y,N.y,q.y,ht.y),Kt=Math.max(y.x,N.x,q.x,ht.x),ne=Math.max(y.y,N.y,q.y,ht.y);m.x=bt,m.y=wt,m.width=Kt-bt,m.height=ne-wt},Y.prototype.roundFrame=function(g,m,y,N,q){if(!(g.width<=0||g.height<=0||y.width<=0||y.height<=0)){if(q){var ht=q.a,bt=q.b,wt=q.c,Kt=q.d;if((Math.abs(bt)>1e-4||Math.abs(wt)>1e-4)&&(Math.abs(ht)>1e-4||Math.abs(Kt)>1e-4))return}(q=q?Rn.copyFrom(q):Rn.identity()).translate(-y.x,-y.y).scale(N.width/y.width,N.height/y.height).translate(N.x,N.y),this.transformAABB(q,g),g.ceil(m),this.transformAABB(q.invert(),g)}},Y}(),fe=function(){function Y(g){this.renderer=g}return Y.prototype.flush=function(){},Y.prototype.destroy=function(){this.renderer=null},Y.prototype.start=function(){},Y.prototype.stop=function(){this.flush()},Y.prototype.render=function(g){},Y}(),we=function(){function Y(g){this.renderer=g,this.emptyRenderer=new fe(g),this.currentRenderer=this.emptyRenderer}return Y.prototype.setObjectRenderer=function(g){this.currentRenderer!==g&&(this.currentRenderer.stop(),this.currentRenderer=g,this.currentRenderer.start())},Y.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},Y.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},Y.prototype.copyBoundTextures=function(g,m){for(var y=this.renderer.texture.boundTextures,N=m-1;N>=0;--N)g[N]=y[N]||null,g[N]&&(g[N]._batchLocation=N)},Y.prototype.boundArray=function(g,m,y,N){for(var q=g.elements,ht=g.ids,bt=g.count,wt=0,Kt=0;Kt<bt;Kt++){var ne=q[Kt],Fe=ne._batchLocation;if(Fe>=0&&Fe<N&&m[Fe]===ne)ht[Kt]=Fe;else for(;wt<N;){var Te=m[wt];if(!Te||Te._batchEnabled!==y||Te._batchLocation!==wt){ht[Kt]=wt,ne._batchLocation=wt,m[wt]=ne;break}wt++}}},Y.prototype.destroy=function(){this.renderer=null},Y}(),ln=0,In=function(){function Y(g){this.renderer=g,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),g.view.addEventListener("webglcontextlost",this.handleContextLost,!1),g.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(Y.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),Y.prototype.contextChange=function(g){this.gl=g,this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,g.isContextLost()&&g.getExtension("WEBGL_lose_context")&&g.getExtension("WEBGL_lose_context").restoreContext()},Y.prototype.initFromContext=function(g){this.gl=g,this.validateContext(g),this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,this.renderer.runners.contextChange.emit(g)},Y.prototype.initFromOptions=function(g){var m=this.createContext(this.renderer.view,g);this.initFromContext(m)},Y.prototype.createContext=function(g,m){var y;if(O.b.PREFER_ENV>=R.g.WEBGL2&&(y=g.getContext("webgl2",m)),y)this.webGLVersion=2;else if(this.webGLVersion=1,!(y=g.getContext("webgl",m)||g.getContext("experimental-webgl",m)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=y,this.getExtensions(),this.gl},Y.prototype.getExtensions=function(){var g=this.gl,m={anisotropicFiltering:g.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),s3tc:g.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:g.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:g.getExtension("WEBGL_compressed_texture_etc"),etc1:g.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:g.getExtension("WEBGL_compressed_texture_pvrtc")||g.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:g.getExtension("WEBGL_compressed_texture_atc"),astc:g.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,m,{drawBuffers:g.getExtension("WEBGL_draw_buffers"),depthTexture:g.getExtension("WEBGL_depth_texture"),loseContext:g.getExtension("WEBGL_lose_context"),vertexArrayObject:g.getExtension("OES_vertex_array_object")||g.getExtension("MOZ_OES_vertex_array_object")||g.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:g.getExtension("OES_element_index_uint"),floatTexture:g.getExtension("OES_texture_float"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),textureHalfFloat:g.getExtension("OES_texture_half_float"),textureHalfFloatLinear:g.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,m,{colorBufferFloat:g.getExtension("EXT_color_buffer_float")})},Y.prototype.handleContextLost=function(g){g.preventDefault()},Y.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},Y.prototype.destroy=function(){var g=this.renderer.view;this.renderer=null,g.removeEventListener("webglcontextlost",this.handleContextLost),g.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},Y.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},Y.prototype.validateContext=function(g){var m=g.getContextAttributes(),y="WebGL2RenderingContext"in globalThis&&g instanceof globalThis.WebGL2RenderingContext;y&&(this.webGLVersion=2),m&&!m.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var N=y||!!g.getExtension("OES_element_index_uint");this.supports.uint32Indices=N,N||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},Y}(),Zn=function(Y){this.framebuffer=Y,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=R.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},gi=new z.j,tn=function(){function Y(g){this.renderer=g,this.managedFramebuffers=[],this.unknownFramebuffer=new mt(10,10),this.msaaSamples=null}return Y.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new z.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var m=this.renderer.context.extensions.drawBuffers,y=this.renderer.context.extensions.depthTexture;O.b.PREFER_ENV===R.g.WEBGL_LEGACY&&(m=null,y=null),m?g.drawBuffers=function(N){return m.drawBuffersWEBGL(N)}:(this.hasMRT=!1,g.drawBuffers=function(){}),y||(this.writeDepthTexture=!1)}else this.msaaSamples=g.getInternalformatParameter(g.RENDERBUFFER,g.RGBA8,g.SAMPLES)},Y.prototype.bind=function(g,m,y){y===void 0&&(y=0);var N=this.gl;if(g){var q=g.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(g);this.current!==g&&(this.current=g,N.bindFramebuffer(N.FRAMEBUFFER,q.framebuffer)),q.mipLevel!==y&&(g.dirtyId++,g.dirtyFormat++,q.mipLevel=y),q.dirtyId!==g.dirtyId&&(q.dirtyId=g.dirtyId,q.dirtyFormat!==g.dirtyFormat?(q.dirtyFormat=g.dirtyFormat,q.dirtySize=g.dirtySize,this.updateFramebuffer(g,y)):q.dirtySize!==g.dirtySize&&(q.dirtySize=g.dirtySize,this.resizeFramebuffer(g)));for(var ht=0;ht<g.colorTextures.length;ht++){var bt=g.colorTextures[ht];this.renderer.texture.unbind(bt.parentTextureArray||bt)}if(g.depthTexture&&this.renderer.texture.unbind(g.depthTexture),m){var wt=m.width>>y,Kt=m.height>>y,ne=wt/m.width;this.setViewport(m.x*ne,m.y*ne,wt,Kt)}else wt=g.width>>y,Kt=g.height>>y,this.setViewport(0,0,wt,Kt)}else this.current&&(this.current=null,N.bindFramebuffer(N.FRAMEBUFFER,null)),m?this.setViewport(m.x,m.y,m.width,m.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},Y.prototype.setViewport=function(g,m,y,N){var q=this.viewport;g=Math.round(g),m=Math.round(m),y=Math.round(y),N=Math.round(N),q.width===y&&q.height===N&&q.x===g&&q.y===m||(q.x=g,q.y=m,q.width=y,q.height=N,this.gl.viewport(g,m,y,N))},Object.defineProperty(Y.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),Y.prototype.clear=function(g,m,y,N,q){q===void 0&&(q=R.c.COLOR|R.c.DEPTH);var ht=this.gl;ht.clearColor(g,m,y,N),ht.clear(q)},Y.prototype.initFramebuffer=function(g){var m=this.gl,y=new Zn(m.createFramebuffer());return y.multisample=this.detectSamples(g.multisample),g.glFramebuffers[this.CONTEXT_UID]=y,this.managedFramebuffers.push(g),g.disposeRunner.add(this),y},Y.prototype.resizeFramebuffer=function(g){var m=this.gl,y=g.glFramebuffers[this.CONTEXT_UID];y.msaaBuffer&&(m.bindRenderbuffer(m.RENDERBUFFER,y.msaaBuffer),m.renderbufferStorageMultisample(m.RENDERBUFFER,y.multisample,m.RGBA8,g.width,g.height)),y.stencil&&(m.bindRenderbuffer(m.RENDERBUFFER,y.stencil),y.msaaBuffer?m.renderbufferStorageMultisample(m.RENDERBUFFER,y.multisample,m.DEPTH24_STENCIL8,g.width,g.height):m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,g.width,g.height));var N=g.colorTextures,q=N.length;m.drawBuffers||(q=Math.min(q,1));for(var ht=0;ht<q;ht++){var bt=N[ht],wt=bt.parentTextureArray||bt;this.renderer.texture.bind(wt,0)}g.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(g.depthTexture,0)},Y.prototype.updateFramebuffer=function(g,m){var y=this.gl,N=g.glFramebuffers[this.CONTEXT_UID],q=g.colorTextures,ht=q.length;y.drawBuffers||(ht=Math.min(ht,1)),N.multisample>1&&this.canMultisampleFramebuffer(g)?(N.msaaBuffer=N.msaaBuffer||y.createRenderbuffer(),y.bindRenderbuffer(y.RENDERBUFFER,N.msaaBuffer),y.renderbufferStorageMultisample(y.RENDERBUFFER,N.multisample,y.RGBA8,g.width,g.height),y.framebufferRenderbuffer(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.RENDERBUFFER,N.msaaBuffer)):N.msaaBuffer&&(y.deleteRenderbuffer(N.msaaBuffer),N.msaaBuffer=null,N.blitFramebuffer&&(N.blitFramebuffer.dispose(),N.blitFramebuffer=null));for(var bt=[],wt=0;wt<ht;wt++){var Kt=q[wt],ne=Kt.parentTextureArray||Kt;this.renderer.texture.bind(ne,0),wt===0&&N.msaaBuffer||(y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0+wt,Kt.target,ne._glTextures[this.CONTEXT_UID].texture,m),bt.push(y.COLOR_ATTACHMENT0+wt))}if(bt.length>1&&y.drawBuffers(bt),g.depthTexture&&this.writeDepthTexture){var Fe=g.depthTexture;this.renderer.texture.bind(Fe,0),y.framebufferTexture2D(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.TEXTURE_2D,Fe._glTextures[this.CONTEXT_UID].texture,m)}!g.stencil&&!g.depth||g.depthTexture&&this.writeDepthTexture?N.stencil&&(y.deleteRenderbuffer(N.stencil),N.stencil=null):(N.stencil=N.stencil||y.createRenderbuffer(),y.bindRenderbuffer(y.RENDERBUFFER,N.stencil),N.msaaBuffer?y.renderbufferStorageMultisample(y.RENDERBUFFER,N.multisample,y.DEPTH24_STENCIL8,g.width,g.height):y.renderbufferStorage(y.RENDERBUFFER,y.DEPTH_STENCIL,g.width,g.height),y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_STENCIL_ATTACHMENT,y.RENDERBUFFER,N.stencil))},Y.prototype.canMultisampleFramebuffer=function(g){return this.renderer.context.webGLVersion!==1&&g.colorTextures.length<=1&&!g.depthTexture},Y.prototype.detectSamples=function(g){var m=this.msaaSamples,y=R.l.NONE;if(g<=1||m===null)return y;for(var N=0;N<m.length;N++)if(m[N]<=g){y=m[N];break}return y===1&&(y=R.l.NONE),y},Y.prototype.blit=function(g,m,y){var N=this.current,q=this.renderer,ht=this.gl,bt=this.CONTEXT_UID;if(q.context.webGLVersion===2&&N){var wt=N.glFramebuffers[bt];if(wt){if(!g){if(!wt.msaaBuffer)return;var Kt=N.colorTextures[0];if(!Kt)return;wt.blitFramebuffer||(wt.blitFramebuffer=new mt(N.width,N.height),wt.blitFramebuffer.addColorTexture(0,Kt)),(g=wt.blitFramebuffer).colorTextures[0]!==Kt&&(g.colorTextures[0]=Kt,g.dirtyId++,g.dirtyFormat++),g.width===N.width&&g.height===N.height||(g.width=N.width,g.height=N.height,g.dirtyId++,g.dirtySize++)}m||((m=gi).width=N.width,m.height=N.height),y||(y=m);var ne=m.width===y.width&&m.height===y.height;this.bind(g),ht.bindFramebuffer(ht.READ_FRAMEBUFFER,wt.framebuffer),ht.blitFramebuffer(m.left,m.top,m.right,m.bottom,y.left,y.top,y.right,y.bottom,ht.COLOR_BUFFER_BIT,ne?ht.NEAREST:ht.LINEAR)}}},Y.prototype.disposeFramebuffer=function(g,m){var y=g.glFramebuffers[this.CONTEXT_UID],N=this.gl;if(y){delete g.glFramebuffers[this.CONTEXT_UID];var q=this.managedFramebuffers.indexOf(g);q>=0&&this.managedFramebuffers.splice(q,1),g.disposeRunner.remove(this),m||(N.deleteFramebuffer(y.framebuffer),y.msaaBuffer&&N.deleteRenderbuffer(y.msaaBuffer),y.stencil&&N.deleteRenderbuffer(y.stencil)),y.blitFramebuffer&&y.blitFramebuffer.dispose()}},Y.prototype.disposeAll=function(g){var m=this.managedFramebuffers;this.managedFramebuffers=[];for(var y=0;y<m.length;y++)this.disposeFramebuffer(m[y],g)},Y.prototype.forceStencil=function(){var g=this.current;if(g){var m=g.glFramebuffers[this.CONTEXT_UID];if(m&&!m.stencil){g.stencil=!0;var y=g.width,N=g.height,q=this.gl,ht=q.createRenderbuffer();q.bindRenderbuffer(q.RENDERBUFFER,ht),m.msaaBuffer?q.renderbufferStorageMultisample(q.RENDERBUFFER,m.multisample,q.DEPTH24_STENCIL8,y,N):q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_STENCIL,y,N),m.stencil=ht,q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,ht)}}},Y.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new z.j},Y.prototype.destroy=function(){this.renderer=null},Y}(),xt={5126:4,5123:2,5121:1},St=function(){function Y(g){this.renderer=g,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return Y.prototype.contextChange=function(){this.disposeAll(!0);var g=this.gl=this.renderer.gl,m=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,m.webGLVersion!==2){var y=this.renderer.context.extensions.vertexArrayObject;O.b.PREFER_ENV===R.g.WEBGL_LEGACY&&(y=null),y?(g.createVertexArray=function(){return y.createVertexArrayOES()},g.bindVertexArray=function(q){return y.bindVertexArrayOES(q)},g.deleteVertexArray=function(q){return y.deleteVertexArrayOES(q)}):(this.hasVao=!1,g.createVertexArray=function(){return null},g.bindVertexArray=function(){return null},g.deleteVertexArray=function(){return null})}if(m.webGLVersion!==2){var N=g.getExtension("ANGLE_instanced_arrays");N?(g.vertexAttribDivisor=function(q,ht){return N.vertexAttribDivisorANGLE(q,ht)},g.drawElementsInstanced=function(q,ht,bt,wt,Kt){return N.drawElementsInstancedANGLE(q,ht,bt,wt,Kt)},g.drawArraysInstanced=function(q,ht,bt,wt){return N.drawArraysInstancedANGLE(q,ht,bt,wt)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=m.webGLVersion===2||!!m.extensions.uint32ElementIndex},Y.prototype.bind=function(g,m){m=m||this.renderer.shader.shader;var y=this.gl,N=g.glVertexArrayObjects[this.CONTEXT_UID],q=!1;N||(this.managedGeometries[g.id]=g,g.disposeRunner.add(this),g.glVertexArrayObjects[this.CONTEXT_UID]=N={},q=!0);var ht=N[m.program.id]||this.initGeometryVao(g,m,q);this._activeGeometry=g,this._activeVao!==ht&&(this._activeVao=ht,this.hasVao?y.bindVertexArray(ht):this.activateVao(g,m.program)),this.updateBuffers()},Y.prototype.reset=function(){this.unbind()},Y.prototype.updateBuffers=function(){for(var g=this._activeGeometry,m=this.renderer.buffer,y=0;y<g.buffers.length;y++){var N=g.buffers[y];m.update(N)}},Y.prototype.checkCompatibility=function(g,m){var y=g.attributes,N=m.attributeData;for(var q in N)if(!y[q])throw new Error('shader and geometry incompatible, geometry missing the "'+q+'" attribute')},Y.prototype.getSignature=function(g,m){var y=g.attributes,N=m.attributeData,q=["g",g.id];for(var ht in y)N[ht]&&q.push(ht,N[ht].location);return q.join("-")},Y.prototype.initGeometryVao=function(g,m,y){y===void 0&&(y=!0);var N=this.gl,q=this.CONTEXT_UID,ht=this.renderer.buffer,bt=m.program;bt.glPrograms[q]||this.renderer.shader.generateProgram(m),this.checkCompatibility(g,bt);var wt=this.getSignature(g,bt),Kt=g.glVertexArrayObjects[this.CONTEXT_UID],ne=Kt[wt];if(ne)return Kt[bt.id]=ne,ne;var Fe=g.buffers,Te=g.attributes,$e={},hn={};for(var vn in Fe)$e[vn]=0,hn[vn]=0;for(var vn in Te)!Te[vn].size&&bt.attributeData[vn]?Te[vn].size=bt.attributeData[vn].size:Te[vn].size||console.warn("PIXI Geometry attribute '"+vn+"' size cannot be determined (likely the bound shader does not have the attribute)"),$e[Te[vn].buffer]+=Te[vn].size*xt[Te[vn].type];for(var vn in Te){var un=Te[vn],Kn=un.size;un.stride===void 0&&($e[un.buffer]===Kn*xt[un.type]?un.stride=0:un.stride=$e[un.buffer]),un.start===void 0&&(un.start=hn[un.buffer],hn[un.buffer]+=Kn*xt[un.type])}ne=N.createVertexArray(),N.bindVertexArray(ne);for(var _i=0;_i<Fe.length;_i++){var yi=Fe[_i];ht.bind(yi),y&&yi._glBuffers[q].refCount++}return this.activateVao(g,bt),this._activeVao=ne,Kt[bt.id]=ne,Kt[wt]=ne,ne},Y.prototype.disposeGeometry=function(g,m){var y;if(this.managedGeometries[g.id]){delete this.managedGeometries[g.id];var N=g.glVertexArrayObjects[this.CONTEXT_UID],q=this.gl,ht=g.buffers,bt=(y=this.renderer)===null||y===void 0?void 0:y.buffer;if(g.disposeRunner.remove(this),N){if(bt)for(var wt=0;wt<ht.length;wt++){var Kt=ht[wt]._glBuffers[this.CONTEXT_UID];Kt&&(Kt.refCount--,Kt.refCount!==0||m||bt.dispose(ht[wt],m))}if(!m){for(var ne in N)if(ne[0]==="g"){var Fe=N[ne];this._activeVao===Fe&&this.unbind(),q.deleteVertexArray(Fe)}}delete g.glVertexArrayObjects[this.CONTEXT_UID]}}},Y.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedGeometries),y=0;y<m.length;y++)this.disposeGeometry(this.managedGeometries[m[y]],g)},Y.prototype.activateVao=function(g,m){var y=this.gl,N=this.CONTEXT_UID,q=this.renderer.buffer,ht=g.buffers,bt=g.attributes;g.indexBuffer&&q.bind(g.indexBuffer);var wt=null;for(var Kt in bt){var ne=bt[Kt],Fe=ht[ne.buffer],Te=Fe._glBuffers[N];if(m.attributeData[Kt]){wt!==Te&&(q.bind(Fe),wt=Te);var $e=m.attributeData[Kt].location;if(y.enableVertexAttribArray($e),y.vertexAttribPointer($e,ne.size,ne.type||y.FLOAT,ne.normalized,ne.stride,ne.start),ne.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");y.vertexAttribDivisor($e,1)}}}},Y.prototype.draw=function(g,m,y,N){var q=this.gl,ht=this._activeGeometry;if(ht.indexBuffer){var bt=ht.indexBuffer.data.BYTES_PER_ELEMENT,wt=bt===2?q.UNSIGNED_SHORT:q.UNSIGNED_INT;bt===2||bt===4&&this.canUseUInt32ElementIndex?ht.instanced?q.drawElementsInstanced(g,m||ht.indexBuffer.data.length,wt,(y||0)*bt,N||1):q.drawElements(g,m||ht.indexBuffer.data.length,wt,(y||0)*bt):console.warn("unsupported index buffer type: uint32")}else ht.instanced?q.drawArraysInstanced(g,y,m||ht.getSize(),N||1):q.drawArrays(g,y,m||ht.getSize());return this},Y.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},Y.prototype.destroy=function(){this.renderer=null},Y}(),Rt=function(){function Y(g){g===void 0&&(g=null),this.type=R.j.NONE,this.autoDetect=!0,this.maskObject=g||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=O.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(Y.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(g){g?this._filters?this._filters[0]=g:this._filters=[g]:this._filters=null},enumerable:!1,configurable:!0}),Y.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=R.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},Y.prototype.copyCountersOrReset=function(g){g?(this._stencilCounter=g._stencilCounter,this._scissorCounter=g._scissorCounter,this._scissorRect=g._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},Y}();function Qt(Y,g,m){var y=Y.createShader(g);return Y.shaderSource(y,m),Y.compileShader(y),y}function Wt(Y,g){var m=Y.getShaderSource(g).split(`
`).map(function(Kt,ne){return ne+": "+Kt}),y=Y.getShaderInfoLog(g),N=y.split(`
`),q={},ht=N.map(function(Kt){return parseFloat(Kt.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(Kt){return!(!Kt||q[Kt])&&(q[Kt]=!0,!0)}),bt=[""];ht.forEach(function(Kt){m[Kt-1]="%c"+m[Kt-1]+"%c",bt.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var wt=m.join(`
`);bt[0]=wt,console.error(y),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,bt),console.groupEnd()}function Zt(Y){for(var g=new Array(Y),m=0;m<g.length;m++)g[m]=!1;return g}function oe(Y,g){switch(Y){case"float":return 0;case"vec2":return new Float32Array(2*g);case"vec3":return new Float32Array(3*g);case"vec4":return new Float32Array(4*g);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*g);case"ivec3":return new Int32Array(3*g);case"ivec4":return new Int32Array(4*g);case"uvec2":return new Uint32Array(2*g);case"uvec3":return new Uint32Array(3*g);case"uvec4":return new Uint32Array(4*g);case"bool":return!1;case"bvec2":return Zt(2*g);case"bvec3":return Zt(3*g);case"bvec4":return Zt(4*g);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Me,Ee={},Se=Ee;function Ve(){if(!Me){Me=R.m.MEDIUM;var Y=function(){if(Se===Ee||Se&&Se.isContextLost()){var m=document.createElement("canvas"),y=void 0;O.b.PREFER_ENV>=R.g.WEBGL2&&(y=m.getContext("webgl2",{})),y||((y=m.getContext("webgl",{})||m.getContext("experimental-webgl",{}))?y.getExtension("WEBGL_draw_buffers"):y=null),Se=y}return Se}();if(Y&&Y.getShaderPrecisionFormat){var g=Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.HIGH_FLOAT);Me=g.precision?R.m.HIGH:R.m.MEDIUM}}return Me}function en(Y,g,m){if(Y.substring(0,9)!=="precision"){var y=g;return g===R.m.HIGH&&m!==R.m.HIGH&&(y=R.m.MEDIUM),"precision "+y+` float;
`+Y}return m!==R.m.HIGH&&Y.substring(0,15)==="precision highp"?Y.replace("precision highp","precision mediump"):Y}var dn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Tn(Y){return dn[Y]}var yn=null,Xn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Pn(Y,g){if(!yn){var m=Object.keys(Xn);yn={};for(var y=0;y<m.length;++y){var N=m[y];yn[Y[N]]=Xn[N]}}return yn[g]}var Vi=[{test:function(Y){return Y.type==="float"&&Y.size===1},code:function(Y){return`
            if(uv["`+Y+'"] !== ud["'+Y+`"].value)
            {
                ud["`+Y+'"].value = uv["'+Y+`"]
                gl.uniform1f(ud["`+Y+'"].location, uv["'+Y+`"])
            }
            `}},{test:function(Y){return(Y.type==="sampler2D"||Y.type==="samplerCube"||Y.type==="sampler2DArray")&&Y.size===1&&!Y.isArray},code:function(Y){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+Y+`"], t);

            if(ud["`+Y+`"].value !== t)
            {
                ud["`+Y+`"].value = t;
                gl.uniform1i(ud["`+Y+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(Y,g){return Y.type==="mat3"&&Y.size===1&&g.a!==void 0},code:function(Y){return`
            gl.uniformMatrix3fv(ud["`+Y+'"].location, false, uv["'+Y+`"].toArray(true));
            `},codeUbo:function(Y){return`
                var `+Y+"_matrix = uv."+Y+`.toArray(true);

                data[offset] = `+Y+`_matrix[0];
                data[offset+1] = `+Y+`_matrix[1];
                data[offset+2] = `+Y+`_matrix[2];
        
                data[offset + 4] = `+Y+`_matrix[3];
                data[offset + 5] = `+Y+`_matrix[4];
                data[offset + 6] = `+Y+`_matrix[5];
        
                data[offset + 8] = `+Y+`_matrix[6];
                data[offset + 9] = `+Y+`_matrix[7];
                data[offset + 10] = `+Y+`_matrix[8];
            `}},{test:function(Y,g){return Y.type==="vec2"&&Y.size===1&&g.x!==void 0},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+Y+`"].location, v.x, v.y);
                }`},codeUbo:function(Y){return`
                v = uv.`+Y+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(Y){return Y.type==="vec2"&&Y.size===1},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+Y+`"].location, v[0], v[1]);
                }
            `}},{test:function(Y,g){return Y.type==="vec4"&&Y.size===1&&g.width!==void 0},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+Y+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(Y){return`
                    v = uv.`+Y+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(Y){return Y.type==="vec4"&&Y.size===1},code:function(Y){return`
                cv = ud["`+Y+`"].value;
                v = uv["`+Y+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+Y+`"].location, v[0], v[1], v[2], v[3])
                }`}}],To={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},oo={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Fn,$o=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function so(Y){for(var g="",m=0;m<Y;++m)m>0&&(g+=`
else `),m<Y-1&&(g+="if(test == "+m+".0){}");return g}var wo=0,kn={},jn=function(){function Y(g,m,y){y===void 0&&(y="pixi-shader"),this.id=wo++,this.vertexSrc=g||Y.defaultVertexSrc,this.fragmentSrc=m||Y.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(y=y.replace(/\s+/g,"-"),kn[y]?(kn[y]++,y+="-"+kn[y]):kn[y]=1,this.vertexSrc="#define SHADER_NAME "+y+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+y+`
`+this.fragmentSrc,this.vertexSrc=en(this.vertexSrc,O.b.PRECISION_VERTEX,R.m.HIGH),this.fragmentSrc=en(this.fragmentSrc,O.b.PRECISION_FRAGMENT,Ve())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(Y,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(Y,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),Y.from=function(g,m,y){var N=g+m,q=M.ProgramCache[N];return q||(M.ProgramCache[N]=q=new Y(g,m,y)),q},Y}(),Qi=function(){function Y(g,m){this.uniformBindCount=0,this.program=g,this.uniformGroup=m?m instanceof cn?m:new cn(m):new cn({})}return Y.prototype.checkUniformExists=function(g,m){if(m.uniforms[g])return!0;for(var y in m.uniforms){var N=m.uniforms[y];if(N.group&&this.checkUniformExists(g,N))return!0}return!1},Y.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(Y.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),Y.from=function(g,m,y){return new Y(jn.from(g,m),y)},Y}(),Yr=function(){function Y(){this.data=0,this.blendMode=R.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(Y.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(g){!!(1&this.data)!==g&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(g){!!(2&this.data)!==g&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(g){!!(4&this.data)!==g&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(g){!!(8&this.data)!==g&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(g){!!(32&this.data)!==g&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(g){!!(16&this.data)!==g&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"blendMode",{get:function(){return this._blendMode},set:function(g){this.blend=g!==R.b.NONE,this._blendMode=g},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(g){this.offsets=!!g,this._polygonOffset=g},enumerable:!1,configurable:!0}),Y.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},Y.for2d=function(){var g=new Y;return g.depthTest=!1,g.blend=!0,g},Y}(),Ri=function(Y){function g(m,y,N){var q=this,ht=jn.from(m||g.defaultVertexSrc,y||g.defaultFragmentSrc);return(q=Y.call(this,ht,N)||this).padding=0,q.resolution=O.b.FILTER_RESOLUTION,q.multisample=O.b.FILTER_MULTISAMPLE,q.enabled=!0,q.autoFit=!0,q.state=new Yr,q}return pt(g,Y),g.prototype.apply=function(m,y,N,q,ht){m.applyFilter(this,y,N,q)},Object.defineProperty(g.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(m){this.state.blendMode=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"resolution",{get:function(){return this._resolution},set:function(m){this._resolution=m},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),g}(Qi),Mr=new z.d,Dr=function(){function Y(g,m){this._texture=g,this.mapCoord=new z.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=m===void 0?.5:m,this.isSimple=!1}return Object.defineProperty(Y.prototype,"texture",{get:function(){return this._texture},set:function(g){this._texture=g,this._textureID=-1},enumerable:!1,configurable:!0}),Y.prototype.multiplyUvs=function(g,m){m===void 0&&(m=g);for(var y=this.mapCoord,N=0;N<g.length;N+=2){var q=g[N],ht=g[N+1];m[N]=q*y.a+ht*y.c+y.tx,m[N+1]=q*y.b+ht*y.d+y.ty}return m},Y.prototype.update=function(g){var m=this._texture;if(!m||!m.valid||!g&&this._textureID===m._updateID)return!1;this._textureID=m._updateID,this._updateID++;var y=m._uvs;this.mapCoord.set(y.x1-y.x0,y.y1-y.y0,y.x3-y.x0,y.y3-y.y0,y.x0,y.y0);var N=m.orig,q=m.trim;q&&(Mr.set(N.width/q.width,0,0,N.height/q.height,-q.x/q.width,-q.y/q.height),this.mapCoord.append(Mr));var ht=m.baseTexture,bt=this.uClampFrame,wt=this.clampMargin/ht.resolution,Kt=this.clampOffset;return bt[0]=(m._frame.x+wt+Kt)/ht.width,bt[1]=(m._frame.y+wt+Kt)/ht.height,bt[2]=(m._frame.x+m._frame.width-wt+Kt)/ht.width,bt[3]=(m._frame.y+m._frame.height-wt+Kt)/ht.height,this.uClampOffset[0]=Kt/ht.realWidth,this.uClampOffset[1]=Kt/ht.realHeight,this.isSimple=m._frame.width===ht.width&&m._frame.height===ht.height&&m.rotate===0,!0},Y}(),Qo=function(Y){function g(m,y,N){var q=this,ht=null;return typeof m!="string"&&y===void 0&&N===void 0&&(ht=m,m=void 0,y=void 0,N=void 0),(q=Y.call(this,m||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,y||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,N)||this).maskSprite=ht,q.maskMatrix=new z.d,q}return pt(g,Y),Object.defineProperty(g.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(m){this._maskSprite=m,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),g.prototype.apply=function(m,y,N,q){var ht=this._maskSprite,bt=ht._texture;bt.valid&&(bt.uvMatrix||(bt.uvMatrix=new Dr(bt,0)),bt.uvMatrix.update(),this.uniforms.npmAlpha=bt.baseTexture.alphaMode?0:1,this.uniforms.mask=bt,this.uniforms.otherMatrix=m.calculateSpriteMatrix(this.maskMatrix,ht).prepend(bt.uvMatrix.mapCoord),this.uniforms.alpha=ht.worldAlpha,this.uniforms.maskClamp=bt.uvMatrix.uClampFrame,m.applyFilter(this,y,N,q))},g}(Ri),ts=function(){function Y(g){this.renderer=g,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return Y.prototype.setMaskStack=function(g){this.maskStack=g,this.renderer.scissor.setMaskStack(g),this.renderer.stencil.setMaskStack(g)},Y.prototype.push=function(g,m){var y=m;if(!y.isMaskData){var N=this.maskDataPool.pop()||new Rt;N.pooled=!0,N.maskObject=m,y=N}var q=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(y.copyCountersOrReset(q),y.autoDetect&&this.detect(y),y._target=g,y.type!==R.j.SPRITE&&this.maskStack.push(y),y.enabled)switch(y.type){case R.j.SCISSOR:this.renderer.scissor.push(y);break;case R.j.STENCIL:this.renderer.stencil.push(y);break;case R.j.SPRITE:y.copyCountersOrReset(null),this.pushSpriteMask(y)}y.type===R.j.SPRITE&&this.maskStack.push(y)},Y.prototype.pop=function(g){var m=this.maskStack.pop();if(m&&m._target===g){if(m.enabled)switch(m.type){case R.j.SCISSOR:this.renderer.scissor.pop();break;case R.j.STENCIL:this.renderer.stencil.pop(m.maskObject);break;case R.j.SPRITE:this.popSpriteMask(m)}if(m.reset(),m.pooled&&this.maskDataPool.push(m),this.maskStack.length!==0){var y=this.maskStack[this.maskStack.length-1];y.type===R.j.SPRITE&&y._filters&&(y._filters[0].maskSprite=y.maskObject)}}},Y.prototype.detect=function(g){g.maskObject.isSprite?g.type=R.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(g)?g.type=R.j.SCISSOR:g.type=R.j.STENCIL},Y.prototype.pushSpriteMask=function(g){var m,y,N=g.maskObject,q=g._target,ht=g._filters;ht||(ht=this.alphaMaskPool[this.alphaMaskIndex])||(ht=this.alphaMaskPool[this.alphaMaskIndex]=[new Qo]);var bt,wt,Kt=this.renderer,ne=Kt.renderTexture;if(ne.current){var Fe=ne.current;bt=g.resolution||Fe.resolution,wt=(m=g.multisample)!==null&&m!==void 0?m:Fe.multisample}else bt=g.resolution||Kt.resolution,wt=(y=g.multisample)!==null&&y!==void 0?y:Kt.multisample;ht[0].resolution=bt,ht[0].multisample=wt,ht[0].maskSprite=N;var Te=q.filterArea;q.filterArea=N.getBounds(!0),Kt.filter.push(q,ht),q.filterArea=Te,g._filters||this.alphaMaskIndex++},Y.prototype.popSpriteMask=function(g){this.renderer.filter.pop(),g._filters?g._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},Y.prototype.destroy=function(){this.renderer=null},Y}(),So=function(){function Y(g){this.renderer=g,this.maskStack=[],this.glConst=0}return Y.prototype.getStackLength=function(){return this.maskStack.length},Y.prototype.setMaskStack=function(g){var m=this.renderer.gl,y=this.getStackLength();this.maskStack=g;var N=this.getStackLength();N!==y&&(N===0?m.disable(this.glConst):(m.enable(this.glConst),this._useCurrent()))},Y.prototype._useCurrent=function(){},Y.prototype.destroy=function(){this.renderer=null,this.maskStack=null},Y}(),Eo=new z.d,di=function(Y){function g(m){var y=Y.call(this,m)||this;return y.glConst=WebGLRenderingContext.SCISSOR_TEST,y}return pt(g,Y),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._scissorCounter:0},g.prototype.calcScissorRect=function(m){if(!m._scissorRectLocal){var y=m._scissorRect,N=m.maskObject,q=this.renderer,ht=q.renderTexture;N.renderable=!0;var bt=N.getBounds();this.roundFrameToPixels(bt,ht.current?ht.current.resolution:q.resolution,ht.sourceFrame,ht.destinationFrame,q.projection.transform),N.renderable=!1,y&&bt.fit(y),m._scissorRectLocal=bt}},g.isMatrixRotated=function(m){if(!m)return!1;var y=m.a,N=m.b,q=m.c,ht=m.d;return(Math.abs(N)>1e-4||Math.abs(q)>1e-4)&&(Math.abs(y)>1e-4||Math.abs(ht)>1e-4)},g.prototype.testScissor=function(m){var y=m.maskObject;if(!y.isFastRect||!y.isFastRect()||g.isMatrixRotated(y.worldTransform)||g.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(m);var N=m._scissorRectLocal;return N.width>0&&N.height>0},g.prototype.roundFrameToPixels=function(m,y,N,q,ht){g.isMatrixRotated(ht)||((ht=ht?Eo.copyFrom(ht):Eo.identity()).translate(-N.x,-N.y).scale(q.width/N.width,q.height/N.height).translate(q.x,q.y),this.renderer.filter.transformAABB(ht,m),m.fit(q),m.x=Math.round(m.x*y),m.y=Math.round(m.y*y),m.width=Math.round(m.width*y),m.height=Math.round(m.height*y))},g.prototype.push=function(m){m._scissorRectLocal||this.calcScissorRect(m);var y=this.renderer.gl;m._scissorRect||y.enable(y.SCISSOR_TEST),m._scissorCounter++,m._scissorRect=m._scissorRectLocal,this._useCurrent()},g.prototype.pop=function(){var m=this.renderer.gl;this.getStackLength()>0?this._useCurrent():m.disable(m.SCISSOR_TEST)},g.prototype._useCurrent=function(){var m,y=this.maskStack[this.maskStack.length-1]._scissorRect;m=this.renderer.renderTexture.current?y.y:this.renderer.height-y.height-y.y,this.renderer.gl.scissor(y.x,m,y.width,y.height)},g}(So),es=function(Y){function g(m){var y=Y.call(this,m)||this;return y.glConst=WebGLRenderingContext.STENCIL_TEST,y}return pt(g,Y),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._stencilCounter:0},g.prototype.push=function(m){var y=m.maskObject,N=this.renderer.gl,q=m._stencilCounter;q===0&&(this.renderer.framebuffer.forceStencil(),N.clearStencil(0),N.clear(N.STENCIL_BUFFER_BIT),N.enable(N.STENCIL_TEST)),m._stencilCounter++,N.colorMask(!1,!1,!1,!1),N.stencilFunc(N.EQUAL,q,4294967295),N.stencilOp(N.KEEP,N.KEEP,N.INCR),y.renderable=!0,y.render(this.renderer),this.renderer.batch.flush(),y.renderable=!1,this._useCurrent()},g.prototype.pop=function(m){var y=this.renderer.gl;this.getStackLength()===0?y.disable(y.STENCIL_TEST):(y.colorMask(!1,!1,!1,!1),y.stencilOp(y.KEEP,y.KEEP,y.DECR),m.renderable=!0,m.render(this.renderer),this.renderer.batch.flush(),m.renderable=!1,this._useCurrent())},g.prototype._useCurrent=function(){var m=this.renderer.gl;m.colorMask(!0,!0,!0,!0),m.stencilFunc(m.EQUAL,this.getStackLength(),4294967295),m.stencilOp(m.KEEP,m.KEEP,m.KEEP)},g}(So),Ii=function(){function Y(g){this.renderer=g,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new z.d,this.transform=null}return Y.prototype.update=function(g,m,y,N){this.destinationFrame=g||this.destinationFrame||this.defaultFrame,this.sourceFrame=m||this.sourceFrame||g,this.calculateProjection(this.destinationFrame,this.sourceFrame,y,N),this.transform&&this.projectionMatrix.append(this.transform);var q=this.renderer;q.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,q.globalUniforms.update(),q.shader.shader&&q.shader.syncUniformGroup(q.shader.shader.uniforms.globals)},Y.prototype.calculateProjection=function(g,m,y,N){var q=this.projectionMatrix,ht=N?-1:1;q.identity(),q.a=1/m.width*2,q.d=ht*(1/m.height*2),q.tx=-1-m.x*q.a,q.ty=-ht-m.y*q.d},Y.prototype.setTransform=function(g){},Y.prototype.destroy=function(){this.renderer=null},Y}(),_r=new z.j,Li=new z.j,Fr=function(){function Y(g){this.renderer=g,this.clearColor=g._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new z.j,this.destinationFrame=new z.j,this.viewportFrame=new z.j}return Y.prototype.bind=function(g,m,y){g===void 0&&(g=null);var N,q,ht,bt=this.renderer;this.current=g,g?(ht=(N=g.baseTexture).resolution,m||(_r.width=g.frame.width,_r.height=g.frame.height,m=_r),y||(Li.x=g.frame.x,Li.y=g.frame.y,Li.width=m.width,Li.height=m.height,y=Li),q=N.framebuffer):(ht=bt.resolution,m||(_r.width=bt.screen.width,_r.height=bt.screen.height,m=_r),y||((y=_r).width=m.width,y.height=m.height));var wt=this.viewportFrame;wt.x=y.x*ht,wt.y=y.y*ht,wt.width=y.width*ht,wt.height=y.height*ht,g||(wt.y=bt.view.height-(wt.y+wt.height)),wt.ceil(),this.renderer.framebuffer.bind(q,wt),this.renderer.projection.update(y,m,ht,!q),g?this.renderer.mask.setMaskStack(N.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(m),this.destinationFrame.copyFrom(y)},Y.prototype.clear=function(g,m){g=this.current?g||this.current.baseTexture.clearColor:g||this.clearColor;var y=this.destinationFrame,N=this.current?this.current.baseTexture:this.renderer.screen,q=y.width!==N.width||y.height!==N.height;if(q){var ht=this.viewportFrame,bt=ht.x,wt=ht.y,Kt=ht.width,ne=ht.height;bt=Math.round(bt),wt=Math.round(wt),Kt=Math.round(Kt),ne=Math.round(ne),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(bt,wt,Kt,ne)}this.renderer.framebuffer.clear(g[0],g[1],g[2],g[3],m),q&&this.renderer.scissor.pop()},Y.prototype.resize=function(){this.bind(null)},Y.prototype.reset=function(){this.bind(null)},Y.prototype.destroy=function(){this.renderer=null},Y}();function Ao(Y,g,m,y,N){m.buffer.update(N)}var ao={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Mo={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function fn(Y,g){if(!Y.autoManage)return{size:0,syncFunc:Ao};for(var m=function(_i){for(var yi=_i.map(function(kr){return{data:kr,offset:0,dataLen:0,dirty:0}}),ni=0,Bi=0,ki=0,ui=0;ui<yi.length;ui++){var Si=yi[ui];if(ni=Mo[Si.data.type],Si.data.size>1&&(ni=Math.max(ni,16)*Si.data.size),Si.dataLen=ni,Bi%ni!=0&&Bi<16){var xr=Bi%ni%16;Bi+=xr,ki+=xr}Bi+ni>16?(ki=16*Math.ceil(ki/16),Si.offset=ki,ki+=ni,Bi=ni):(Si.offset=ki,Bi+=ni,ki+=ni)}return{uboElements:yi,size:ki=16*Math.ceil(ki/16)}}(function(_i,yi){var ni=[];for(var Bi in _i)yi[Bi]&&ni.push(yi[Bi]);return ni.sort(function(ki,ui){return ki.index-ui.index}),ni}(Y.uniforms,g)),y=m.uboElements,N=m.size,q=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],ht=0;ht<y.length;ht++){for(var bt=y[ht],wt=Y.uniforms[bt.data.name],Kt=bt.data.name,ne=!1,Fe=0;Fe<Vi.length;Fe++){var Te=Vi[Fe];if(Te.codeUbo&&Te.test(bt.data,wt)){q.push("offset = "+bt.offset/4+";",Vi[Fe].codeUbo(bt.data.name,wt)),ne=!0;break}}if(!ne)if(bt.data.size>1){var $e=Tn(bt.data.type),hn=Math.max(Mo[bt.data.type]/16,1),vn=$e/hn,un=(4-vn%4)%4;q.push(`
                cv = ud.`+Kt+`.value;
                v = uv.`+Kt+`;
                offset = `+bt.offset/4+`;

                t = 0;

                for(var i=0; i < `+bt.data.size*hn+`; i++)
                {
                    for(var j = 0; j < `+vn+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+un+`;
                }

                `)}else{var Kn=ao[bt.data.type];q.push(`
                cv = ud.`+Kt+`.value;
                v = uv.`+Kt+`;
                offset = `+bt.offset/4+`;
                `+Kn+`;
                `)}}return q.push(`
       renderer.buffer.update(buffer);
    `),{size:N,syncFunc:new Function("ud","uv","renderer","syncData","buffer",q.join(`
`))}}var tr=function(){function Y(g,m){this.program=g,this.uniformData=m,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return Y.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},Y}();function Mn(Y,g){var m=Qt(Y,Y.VERTEX_SHADER,g.vertexSrc),y=Qt(Y,Y.FRAGMENT_SHADER,g.fragmentSrc),N=Y.createProgram();if(Y.attachShader(N,m),Y.attachShader(N,y),Y.linkProgram(N),Y.getProgramParameter(N,Y.LINK_STATUS)||function(Kt,ne,Fe,Te){Kt.getProgramParameter(ne,Kt.LINK_STATUS)||(Kt.getShaderParameter(Fe,Kt.COMPILE_STATUS)||Wt(Kt,Fe),Kt.getShaderParameter(Te,Kt.COMPILE_STATUS)||Wt(Kt,Te),console.error("PixiJS Error: Could not initialize shader."),Kt.getProgramInfoLog(ne)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",Kt.getProgramInfoLog(ne)))}(Y,N,m,y),g.attributeData=function(Kt,ne){for(var Fe={},Te=ne.getProgramParameter(Kt,ne.ACTIVE_ATTRIBUTES),$e=0;$e<Te;$e++){var hn=ne.getActiveAttrib(Kt,$e);if(hn.name.indexOf("gl_")!==0){var vn=Pn(ne,hn.type),un={type:vn,name:hn.name,size:Tn(vn),location:ne.getAttribLocation(Kt,hn.name)};Fe[hn.name]=un}}return Fe}(N,Y),g.uniformData=function(Kt,ne){for(var Fe={},Te=ne.getProgramParameter(Kt,ne.ACTIVE_UNIFORMS),$e=0;$e<Te;$e++){var hn=ne.getActiveUniform(Kt,$e),vn=hn.name.replace(/\[.*?\]$/,""),un=!!hn.name.match(/\[.*?\]$/),Kn=Pn(ne,hn.type);Fe[vn]={name:vn,index:$e,type:Kn,size:hn.size,isArray:un,value:oe(Kn,hn.size)}}return Fe}(N,Y),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(g.vertexSrc)){var q=Object.keys(g.attributeData);q.sort(function(Kt,ne){return Kt>ne?1:-1});for(var ht=0;ht<q.length;ht++)g.attributeData[q[ht]].location=ht,Y.bindAttribLocation(N,ht,q[ht]);Y.linkProgram(N)}Y.deleteShader(m),Y.deleteShader(y);var bt={};for(var ht in g.uniformData){var wt=g.uniformData[ht];bt[ht]={location:Y.getUniformLocation(N,ht),value:oe(wt.type,wt.size)}}return new tr(N,bt)}var Co=0,Yn={textureCount:0,uboCount:0},Ss=function(){function Y(g){this.destroyed=!1,this.renderer=g,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Co++}return Y.prototype.systemCheck=function(){if(!function(){if(typeof Fn=="boolean")return Fn;try{var g=new Function("param1","param2","param3","return param1[param2] === param3;");Fn=g({a:"b"},"a","b")===!0}catch{Fn=!1}return Fn}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},Y.prototype.contextChange=function(g){this.gl=g,this.reset()},Y.prototype.bind=function(g,m){g.uniforms.globals=this.renderer.globalUniforms;var y=g.program,N=y.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(g);return this.shader=g,this.program!==y&&(this.program=y,this.gl.useProgram(N.program)),m||(Yn.textureCount=0,Yn.uboCount=0,this.syncUniformGroup(g.uniformGroup,Yn)),N},Y.prototype.setUniforms=function(g){var m=this.shader.program,y=m.glPrograms[this.renderer.CONTEXT_UID];m.syncUniforms(y.uniformData,g,this.renderer)},Y.prototype.syncUniformGroup=function(g,m){var y=this.getGlProgram();g.static&&g.dirtyId===y.uniformDirtyGroups[g.id]||(y.uniformDirtyGroups[g.id]=g.dirtyId,this.syncUniforms(g,y,m))},Y.prototype.syncUniforms=function(g,m,y){(g.syncUniforms[this.shader.program.id]||this.createSyncGroups(g))(m.uniformData,g.uniforms,this.renderer,y)},Y.prototype.createSyncGroups=function(g){var m=this.getSignature(g,this.shader.program.uniformData,"u");return this.cache[m]||(this.cache[m]=function(y,N){var q,ht=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var bt in y.uniforms){var wt=N[bt];if(wt){for(var Kt=y.uniforms[bt],ne=!1,Fe=0;Fe<Vi.length;Fe++)if(Vi[Fe].test(wt,Kt)){ht.push(Vi[Fe].code(bt,Kt)),ne=!0;break}if(!ne){var Te=(wt.size===1?To:oo)[wt.type].replace("location",'ud["'+bt+'"].location');ht.push(`
            cu = ud["`+bt+`"];
            cv = cu.value;
            v = uv["`+bt+`"];
            `+Te+";")}}else!((q=y.uniforms[bt])===null||q===void 0)&&q.group&&(y.uniforms[bt].ubo?ht.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+bt+", '"+bt+`');
                    `):ht.push(`
                        renderer.shader.syncUniformGroup(uv.`+bt+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",ht.join(`
`))}(g,this.shader.program.uniformData)),g.syncUniforms[this.shader.program.id]=this.cache[m],g.syncUniforms[this.shader.program.id]},Y.prototype.syncUniformBufferGroup=function(g,m){var y=this.getGlProgram();if(!g.static||g.dirtyId!==0||!y.uniformGroups[g.id]){g.dirtyId=0;var N=y.uniformGroups[g.id]||this.createSyncBufferGroup(g,y,m);g.buffer.update(),N(y.uniformData,g.uniforms,this.renderer,Yn,g.buffer)}this.renderer.buffer.bindBufferBase(g.buffer,y.uniformBufferBindings[m])},Y.prototype.createSyncBufferGroup=function(g,m,y){var N=this.renderer.gl;this.renderer.buffer.bind(g.buffer);var q=this.gl.getUniformBlockIndex(m.program,y);m.uniformBufferBindings[y]=this.shader.uniformBindCount,N.uniformBlockBinding(m.program,q,this.shader.uniformBindCount),this.shader.uniformBindCount++;var ht=this.getSignature(g,this.shader.program.uniformData,"ubo"),bt=this._uboCache[ht];if(bt||(bt=this._uboCache[ht]=fn(g,this.shader.program.uniformData)),g.autoManage){var wt=new Float32Array(bt.size/4);g.buffer.update(wt)}return m.uniformGroups[g.id]=bt.syncFunc,m.uniformGroups[g.id]},Y.prototype.getSignature=function(g,m,y){var N=g.uniforms,q=[y+"-"];for(var ht in N)q.push(ht),m[ht]&&q.push(m[ht].type);return q.join("-")},Y.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},Y.prototype.generateProgram=function(g){var m=this.gl,y=g.program,N=Mn(m,y);return y.glPrograms[this.renderer.CONTEXT_UID]=N,N},Y.prototype.reset=function(){this.program=null,this.shader=null},Y.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},Y}(),ma=function(){function Y(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=R.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Yr,this.defaultState.blend=!0}return Y.prototype.contextChange=function(g){this.gl=g,this.blendModes=function(m,y){return y===void 0&&(y=[]),y[R.b.NORMAL]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.ADD]=[m.ONE,m.ONE],y[R.b.MULTIPLY]=[m.DST_COLOR,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.SCREEN]=[m.ONE,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.OVERLAY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.DARKEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.LIGHTEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.COLOR_DODGE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.COLOR_BURN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.HARD_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.SOFT_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.DIFFERENCE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.EXCLUSION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.HUE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.SATURATION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.COLOR]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.LUMINOSITY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.NONE]=[0,0],y[R.b.NORMAL_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.ADD_NPM]=[m.SRC_ALPHA,m.ONE,m.ONE,m.ONE],y[R.b.SCREEN_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],y[R.b.SRC_IN]=[m.DST_ALPHA,m.ZERO],y[R.b.SRC_OUT]=[m.ONE_MINUS_DST_ALPHA,m.ZERO],y[R.b.SRC_ATOP]=[m.DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],y[R.b.DST_OVER]=[m.ONE_MINUS_DST_ALPHA,m.ONE],y[R.b.DST_IN]=[m.ZERO,m.SRC_ALPHA],y[R.b.DST_OUT]=[m.ZERO,m.ONE_MINUS_SRC_ALPHA],y[R.b.DST_ATOP]=[m.ONE_MINUS_DST_ALPHA,m.SRC_ALPHA],y[R.b.XOR]=[m.ONE_MINUS_DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],y[R.b.SUBTRACT]=[m.ONE,m.ONE,m.ONE,m.ONE,m.FUNC_REVERSE_SUBTRACT,m.FUNC_ADD],y}(g),this.set(this.defaultState),this.reset()},Y.prototype.set=function(g){if(g=g||this.defaultState,this.stateId!==g.data){for(var m=this.stateId^g.data,y=0;m;)1&m&&this.map[y].call(this,!!(g.data&1<<y)),m>>=1,y++;this.stateId=g.data}for(y=0;y<this.checks.length;y++)this.checks[y](this,g)},Y.prototype.forceState=function(g){g=g||this.defaultState;for(var m=0;m<this.map.length;m++)this.map[m].call(this,!!(g.data&1<<m));for(m=0;m<this.checks.length;m++)this.checks[m](this,g);this.stateId=g.data},Y.prototype.setBlend=function(g){this.updateCheck(Y.checkBlendMode,g),this.gl[g?"enable":"disable"](this.gl.BLEND)},Y.prototype.setOffset=function(g){this.updateCheck(Y.checkPolygonOffset,g),this.gl[g?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},Y.prototype.setDepthTest=function(g){this.gl[g?"enable":"disable"](this.gl.DEPTH_TEST)},Y.prototype.setDepthMask=function(g){this.gl.depthMask(g)},Y.prototype.setCullFace=function(g){this.gl[g?"enable":"disable"](this.gl.CULL_FACE)},Y.prototype.setFrontFace=function(g){this.gl.frontFace(this.gl[g?"CW":"CCW"])},Y.prototype.setBlendMode=function(g){if(g!==this.blendMode){this.blendMode=g;var m=this.blendModes[g],y=this.gl;m.length===2?y.blendFunc(m[0],m[1]):y.blendFuncSeparate(m[0],m[1],m[2],m[3]),m.length===6?(this._blendEq=!0,y.blendEquationSeparate(m[4],m[5])):this._blendEq&&(this._blendEq=!1,y.blendEquationSeparate(y.FUNC_ADD,y.FUNC_ADD))}},Y.prototype.setPolygonOffset=function(g,m){this.gl.polygonOffset(g,m)},Y.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},Y.prototype.updateCheck=function(g,m){var y=this.checks.indexOf(g);m&&y===-1?this.checks.push(g):m||y===-1||this.checks.splice(y,1)},Y.checkBlendMode=function(g,m){g.setBlendMode(m.blendMode)},Y.checkPolygonOffset=function(g,m){g.setPolygonOffset(1,m.polygonOffset)},Y.prototype.destroy=function(){this.gl=null},Y}(),Ro=function(){function Y(g){this.renderer=g,this.count=0,this.checkCount=0,this.maxIdle=O.b.GC_MAX_IDLE,this.checkCountMax=O.b.GC_MAX_CHECK_COUNT,this.mode=O.b.GC_MODE}return Y.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==R.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},Y.prototype.run=function(){for(var g=this.renderer.texture,m=g.managedTextures,y=!1,N=0;N<m.length;N++){var q=m[N];!q.framebuffer&&this.count-q.touched>this.maxIdle&&(g.destroyTexture(q,!0),m[N]=null,y=!0)}if(y){var ht=0;for(N=0;N<m.length;N++)m[N]!==null&&(m[ht++]=m[N]);m.length=ht}},Y.prototype.unload=function(g){var m=this.renderer.texture,y=g._texture;y&&!y.framebuffer&&m.destroyTexture(y);for(var N=g.children.length-1;N>=0;N--)this.unload(g.children[N])},Y.prototype.destroy=function(){this.renderer=null},Y}(),An=function(Y){this.texture=Y,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=R.r.UNSIGNED_BYTE,this.internalFormat=R.h.RGBA,this.samplerType=0},Es=function(){function Y(g){this.renderer=g,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new F,this.hasIntegerTextures=!1}return Y.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(q){var ht,bt,wt,Kt,ne,Fe,Te,$e,hn,vn,un,Kn,_i,yi,ni,Bi,ki,ui,Si,xr,kr,rs,os;return"WebGL2RenderingContext"in globalThis&&q instanceof globalThis.WebGL2RenderingContext?((ht={})[R.r.UNSIGNED_BYTE]=((bt={})[R.h.RGBA]=q.RGBA8,bt[R.h.RGB]=q.RGB8,bt[R.h.RG]=q.RG8,bt[R.h.RED]=q.R8,bt[R.h.RGBA_INTEGER]=q.RGBA8UI,bt[R.h.RGB_INTEGER]=q.RGB8UI,bt[R.h.RG_INTEGER]=q.RG8UI,bt[R.h.RED_INTEGER]=q.R8UI,bt[R.h.ALPHA]=q.ALPHA,bt[R.h.LUMINANCE]=q.LUMINANCE,bt[R.h.LUMINANCE_ALPHA]=q.LUMINANCE_ALPHA,bt),ht[R.r.BYTE]=((wt={})[R.h.RGBA]=q.RGBA8_SNORM,wt[R.h.RGB]=q.RGB8_SNORM,wt[R.h.RG]=q.RG8_SNORM,wt[R.h.RED]=q.R8_SNORM,wt[R.h.RGBA_INTEGER]=q.RGBA8I,wt[R.h.RGB_INTEGER]=q.RGB8I,wt[R.h.RG_INTEGER]=q.RG8I,wt[R.h.RED_INTEGER]=q.R8I,wt),ht[R.r.UNSIGNED_SHORT]=((Kt={})[R.h.RGBA_INTEGER]=q.RGBA16UI,Kt[R.h.RGB_INTEGER]=q.RGB16UI,Kt[R.h.RG_INTEGER]=q.RG16UI,Kt[R.h.RED_INTEGER]=q.R16UI,Kt[R.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT16,Kt),ht[R.r.SHORT]=((ne={})[R.h.RGBA_INTEGER]=q.RGBA16I,ne[R.h.RGB_INTEGER]=q.RGB16I,ne[R.h.RG_INTEGER]=q.RG16I,ne[R.h.RED_INTEGER]=q.R16I,ne),ht[R.r.UNSIGNED_INT]=((Fe={})[R.h.RGBA_INTEGER]=q.RGBA32UI,Fe[R.h.RGB_INTEGER]=q.RGB32UI,Fe[R.h.RG_INTEGER]=q.RG32UI,Fe[R.h.RED_INTEGER]=q.R32UI,Fe[R.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT24,Fe),ht[R.r.INT]=((Te={})[R.h.RGBA_INTEGER]=q.RGBA32I,Te[R.h.RGB_INTEGER]=q.RGB32I,Te[R.h.RG_INTEGER]=q.RG32I,Te[R.h.RED_INTEGER]=q.R32I,Te),ht[R.r.FLOAT]=(($e={})[R.h.RGBA]=q.RGBA32F,$e[R.h.RGB]=q.RGB32F,$e[R.h.RG]=q.RG32F,$e[R.h.RED]=q.R32F,$e[R.h.DEPTH_COMPONENT]=q.DEPTH_COMPONENT32F,$e),ht[R.r.HALF_FLOAT]=((hn={})[R.h.RGBA]=q.RGBA16F,hn[R.h.RGB]=q.RGB16F,hn[R.h.RG]=q.RG16F,hn[R.h.RED]=q.R16F,hn),ht[R.r.UNSIGNED_SHORT_5_6_5]=((vn={})[R.h.RGB]=q.RGB565,vn),ht[R.r.UNSIGNED_SHORT_4_4_4_4]=((un={})[R.h.RGBA]=q.RGBA4,un),ht[R.r.UNSIGNED_SHORT_5_5_5_1]=((Kn={})[R.h.RGBA]=q.RGB5_A1,Kn),ht[R.r.UNSIGNED_INT_2_10_10_10_REV]=((_i={})[R.h.RGBA]=q.RGB10_A2,_i[R.h.RGBA_INTEGER]=q.RGB10_A2UI,_i),ht[R.r.UNSIGNED_INT_10F_11F_11F_REV]=((yi={})[R.h.RGB]=q.R11F_G11F_B10F,yi),ht[R.r.UNSIGNED_INT_5_9_9_9_REV]=((ni={})[R.h.RGB]=q.RGB9_E5,ni),ht[R.r.UNSIGNED_INT_24_8]=((Bi={})[R.h.DEPTH_STENCIL]=q.DEPTH24_STENCIL8,Bi),ht[R.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((ki={})[R.h.DEPTH_STENCIL]=q.DEPTH32F_STENCIL8,ki),os=ht):((ui={})[R.r.UNSIGNED_BYTE]=((Si={})[R.h.RGBA]=q.RGBA,Si[R.h.RGB]=q.RGB,Si[R.h.ALPHA]=q.ALPHA,Si[R.h.LUMINANCE]=q.LUMINANCE,Si[R.h.LUMINANCE_ALPHA]=q.LUMINANCE_ALPHA,Si),ui[R.r.UNSIGNED_SHORT_5_6_5]=((xr={})[R.h.RGB]=q.RGB,xr),ui[R.r.UNSIGNED_SHORT_4_4_4_4]=((kr={})[R.h.RGBA]=q.RGBA,kr),ui[R.r.UNSIGNED_SHORT_5_5_5_1]=((rs={})[R.h.RGBA]=q.RGBA,rs),os=ui),os}(g);var m=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=m;for(var y=0;y<m;y++)this.boundTextures[y]=null;this.emptyTextures={};var N=new An(g.createTexture());for(g.bindTexture(g.TEXTURE_2D,N.texture),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[g.TEXTURE_2D]=N,this.emptyTextures[g.TEXTURE_CUBE_MAP]=new An(g.createTexture()),g.bindTexture(g.TEXTURE_CUBE_MAP,this.emptyTextures[g.TEXTURE_CUBE_MAP].texture),y=0;y<6;y++)g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,null);for(g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MIN_FILTER,g.LINEAR),y=0;y<this.boundTextures.length;y++)this.bind(null,y)},Y.prototype.bind=function(g,m){m===void 0&&(m=0);var y=this.gl;if((g=g==null?void 0:g.castToBaseTexture())&&g.valid&&!g.parentTextureArray){g.touched=this.renderer.textureGC.count;var N=g._glTextures[this.CONTEXT_UID]||this.initTexture(g);this.boundTextures[m]!==g&&(this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),y.bindTexture(g.target,N.texture)),N.dirtyId!==g.dirtyId&&(this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),this.updateTexture(g)),this.boundTextures[m]=g}else this.currentLocation!==m&&(this.currentLocation=m,y.activeTexture(y.TEXTURE0+m)),y.bindTexture(y.TEXTURE_2D,this.emptyTextures[y.TEXTURE_2D].texture),this.boundTextures[m]=null},Y.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var g=0;g<this.boundTextures.length;g++)this.boundTextures[g]=this.unknownTexture},Y.prototype.unbind=function(g){var m=this.gl,y=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var N=0;N<y.length;N++)y[N]===this.unknownTexture&&this.bind(null,N)}for(N=0;N<y.length;N++)y[N]===g&&(this.currentLocation!==N&&(m.activeTexture(m.TEXTURE0+N),this.currentLocation=N),m.bindTexture(g.target,this.emptyTextures[g.target].texture),y[N]=null)},Y.prototype.ensureSamplerType=function(g){var m=this.boundTextures,y=this.hasIntegerTextures,N=this.CONTEXT_UID;if(y)for(var q=g-1;q>=0;--q){var ht=m[q];ht&&ht._glTextures[N].samplerType!==R.o.FLOAT&&this.renderer.texture.unbind(ht)}},Y.prototype.initTexture=function(g){var m=new An(this.gl.createTexture());return m.dirtyId=-1,g._glTextures[this.CONTEXT_UID]=m,this.managedTextures.push(g),g.on("dispose",this.destroyTexture,this),m},Y.prototype.initTextureType=function(g,m){var y,N;m.internalFormat=(N=(y=this.internalFormats[g.type])===null||y===void 0?void 0:y[g.format])!==null&&N!==void 0?N:g.format,this.webGLVersion===2&&g.type===R.r.HALF_FLOAT?m.type=this.gl.HALF_FLOAT:m.type=g.type},Y.prototype.updateTexture=function(g){var m=g._glTextures[this.CONTEXT_UID];if(m){var y=this.renderer;if(this.initTextureType(g,m),g.resource&&g.resource.upload(y,g,m))m.samplerType!==R.o.FLOAT&&(this.hasIntegerTextures=!0);else{var N=g.realWidth,q=g.realHeight,ht=y.gl;(m.width!==N||m.height!==q||m.dirtyId<0)&&(m.width=N,m.height=q,ht.texImage2D(g.target,0,m.internalFormat,N,q,0,g.format,m.type,null))}g.dirtyStyleId!==m.dirtyStyleId&&this.updateTextureStyle(g),m.dirtyId=g.dirtyId}},Y.prototype.destroyTexture=function(g,m){var y=this.gl;if((g=g.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(g),y.deleteTexture(g._glTextures[this.CONTEXT_UID].texture),g.off("dispose",this.destroyTexture,this),delete g._glTextures[this.CONTEXT_UID],!m)){var N=this.managedTextures.indexOf(g);N!==-1&&Object(M.removeItems)(this.managedTextures,N,1)}},Y.prototype.updateTextureStyle=function(g){var m=g._glTextures[this.CONTEXT_UID];m&&(g.mipmap!==R.k.POW2&&this.webGLVersion===2||g.isPowerOfTwo?m.mipmap=g.mipmap>=1:m.mipmap=!1,this.webGLVersion===2||g.isPowerOfTwo?m.wrapMode=g.wrapMode:m.wrapMode=R.s.CLAMP,g.resource&&g.resource.style(this.renderer,g,m)||this.setStyle(g,m),m.dirtyStyleId=g.dirtyStyleId)},Y.prototype.setStyle=function(g,m){var y=this.gl;if(m.mipmap&&g.mipmap!==R.k.ON_MANUAL&&y.generateMipmap(g.target),y.texParameteri(g.target,y.TEXTURE_WRAP_S,m.wrapMode),y.texParameteri(g.target,y.TEXTURE_WRAP_T,m.wrapMode),m.mipmap){y.texParameteri(g.target,y.TEXTURE_MIN_FILTER,g.scaleMode===R.p.LINEAR?y.LINEAR_MIPMAP_LINEAR:y.NEAREST_MIPMAP_NEAREST);var N=this.renderer.context.extensions.anisotropicFiltering;if(N&&g.anisotropicLevel>0&&g.scaleMode===R.p.LINEAR){var q=Math.min(g.anisotropicLevel,y.getParameter(N.MAX_TEXTURE_MAX_ANISOTROPY_EXT));y.texParameterf(g.target,N.TEXTURE_MAX_ANISOTROPY_EXT,q)}}else y.texParameteri(g.target,y.TEXTURE_MIN_FILTER,g.scaleMode===R.p.LINEAR?y.LINEAR:y.NEAREST);y.texParameteri(g.target,y.TEXTURE_MAG_FILTER,g.scaleMode===R.p.LINEAR?y.LINEAR:y.NEAREST)},Y.prototype.destroy=function(){this.renderer=null},Y}(),ns=new z.d,wi=function(Y){function g(m,y){m===void 0&&(m=R.n.UNKNOWN);var N=Y.call(this)||this;return y=Object.assign({},O.b.RENDER_OPTIONS,y),N.options=y,N.type=m,N.screen=new z.j(0,0,y.width,y.height),N.view=y.view||document.createElement("canvas"),N.resolution=y.resolution||O.b.RESOLUTION,N.useContextAlpha=y.useContextAlpha,N.autoDensity=!!y.autoDensity,N.preserveDrawingBuffer=y.preserveDrawingBuffer,N.clearBeforeRender=y.clearBeforeRender,N._backgroundColor=0,N._backgroundColorRgba=[0,0,0,1],N._backgroundColorString="#000000",N.backgroundColor=y.backgroundColor||N._backgroundColor,N.backgroundAlpha=y.backgroundAlpha,y.transparent!==void 0&&(Object(M.deprecation)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),N.useContextAlpha=y.transparent,N.backgroundAlpha=y.transparent?0:1),N._lastObjectRendered=null,N.plugins={},N}return pt(g,Y),g.prototype.initPlugins=function(m){for(var y in m)this.plugins[y]=new m[y](this)},Object.defineProperty(g.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,y){this.view.width=Math.round(m*this.resolution),this.view.height=Math.round(y*this.resolution);var N=this.view.width/this.resolution,q=this.view.height/this.resolution;this.screen.width=N,this.screen.height=q,this.autoDensity&&(this.view.style.width=N+"px",this.view.style.height=q+"px"),this.emit("resize",N,q)},g.prototype.generateTexture=function(m,y,N,q){y===void 0&&(y={}),typeof y=="number"&&(Object(M.deprecation)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),y={scaleMode:y,resolution:N,region:q});var ht=y.region,bt=function(Kt,ne){var Fe={};for(var Te in Kt)Object.prototype.hasOwnProperty.call(Kt,Te)&&ne.indexOf(Te)<0&&(Fe[Te]=Kt[Te]);if(Kt!=null&&typeof Object.getOwnPropertySymbols=="function"){var $e=0;for(Te=Object.getOwnPropertySymbols(Kt);$e<Te.length;$e++)ne.indexOf(Te[$e])<0&&(Fe[Te[$e]]=Kt[Te[$e]])}return Fe}(y,["region"]);(q=ht||m.getLocalBounds(null,!0)).width===0&&(q.width=1),q.height===0&&(q.height=1);var wt=rt.create(Nt({width:q.width,height:q.height},bt));return ns.tx=-q.x,ns.ty=-q.y,this.render(m,{renderTexture:wt,clear:!1,transform:ns,skipUpdateTransform:!!m.parent}),wt},g.prototype.destroy=function(m){for(var y in this.plugins)this.plugins[y].destroy(),this.plugins[y]=null;m&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=R.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(g.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(m){this._backgroundColor=m,this._backgroundColorString=Object(M.hex2string)(m),Object(M.hex2rgb)(m,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(m){this._backgroundColorRgba[3]=m},enumerable:!1,configurable:!0}),g}(M.EventEmitter),is=function(Y){this.buffer=Y||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},yr=function(){function Y(g){this.renderer=g,this.managedBuffers={},this.boundBufferBases={}}return Y.prototype.destroy=function(){this.renderer=null},Y.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},Y.prototype.bind=function(g){var m=this.gl,y=this.CONTEXT_UID,N=g._glBuffers[y]||this.createGLBuffer(g);m.bindBuffer(g.type,N.buffer)},Y.prototype.bindBufferBase=function(g,m){var y=this.gl,N=this.CONTEXT_UID;if(this.boundBufferBases[m]!==g){var q=g._glBuffers[N]||this.createGLBuffer(g);this.boundBufferBases[m]=g,y.bindBufferBase(y.UNIFORM_BUFFER,m,q.buffer)}},Y.prototype.bindBufferRange=function(g,m,y){var N=this.gl,q=this.CONTEXT_UID;y=y||0;var ht=g._glBuffers[q]||this.createGLBuffer(g);N.bindBufferRange(N.UNIFORM_BUFFER,m||0,ht.buffer,256*y,256)},Y.prototype.update=function(g){var m=this.gl,y=this.CONTEXT_UID,N=g._glBuffers[y];if(g._updateID!==N.updateID)if(N.updateID=g._updateID,m.bindBuffer(g.type,N.buffer),N.byteLength>=g.data.byteLength)m.bufferSubData(g.type,0,g.data);else{var q=g.static?m.STATIC_DRAW:m.DYNAMIC_DRAW;N.byteLength=g.data.byteLength,m.bufferData(g.type,g.data,q)}},Y.prototype.dispose=function(g,m){if(this.managedBuffers[g.id]){delete this.managedBuffers[g.id];var y=g._glBuffers[this.CONTEXT_UID],N=this.gl;g.disposeRunner.remove(this),y&&(m||N.deleteBuffer(y.buffer),delete g._glBuffers[this.CONTEXT_UID])}},Y.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedBuffers),y=0;y<m.length;y++)this.dispose(this.managedBuffers[m[y]],g)},Y.prototype.createGLBuffer=function(g){var m=this.CONTEXT_UID,y=this.gl;return g._glBuffers[m]=new is(y.createBuffer()),this.managedBuffers[g.id]=g,g.disposeRunner.add(this),g._glBuffers[m]},Y}(),Ni=function(Y){function g(m){var y=Y.call(this,R.n.WEBGL,m)||this;return m=y.options,y.gl=null,y.CONTEXT_UID=0,y.runners={destroy:new D.a("destroy"),contextChange:new D.a("contextChange"),reset:new D.a("reset"),update:new D.a("update"),postrender:new D.a("postrender"),prerender:new D.a("prerender"),resize:new D.a("resize")},y.runners.contextChange.add(y),y.globalUniforms=new cn({projectionMatrix:new z.d},!0),y.addSystem(ts,"mask").addSystem(In,"context").addSystem(ma,"state").addSystem(Ss,"shader").addSystem(Es,"texture").addSystem(yr,"buffer").addSystem(St,"geometry").addSystem(tn,"framebuffer").addSystem(di,"scissor").addSystem(es,"stencil").addSystem(Ii,"projection").addSystem(Ro,"textureGC").addSystem(re,"filter").addSystem(Fr,"renderTexture").addSystem(we,"batch"),y.initPlugins(g.__plugins),y.multisample=void 0,m.context?y.context.initFromContext(m.context):y.context.initFromOptions({alpha:!!y.useContextAlpha,antialias:m.antialias,premultipliedAlpha:y.useContextAlpha&&y.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:m.preserveDrawingBuffer,powerPreference:y.options.powerPreference}),y.renderingToScreen=!0,Object(M.sayHello)(y.context.webGLVersion===2?"WebGL 2":"WebGL 1"),y.resize(y.options.width,y.options.height),y}return pt(g,Y),g.create=function(m){if(Object(M.isWebGLSupported)())return new g(m);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},g.prototype.contextChange=function(){var m,y=this.gl;if(this.context.webGLVersion===1){var N=y.getParameter(y.FRAMEBUFFER_BINDING);y.bindFramebuffer(y.FRAMEBUFFER,null),m=y.getParameter(y.SAMPLES),y.bindFramebuffer(y.FRAMEBUFFER,N)}else N=y.getParameter(y.DRAW_FRAMEBUFFER_BINDING),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,null),m=y.getParameter(y.SAMPLES),y.bindFramebuffer(y.DRAW_FRAMEBUFFER,N);m>=R.l.HIGH?this.multisample=R.l.HIGH:m>=R.l.MEDIUM?this.multisample=R.l.MEDIUM:m>=R.l.LOW?this.multisample=R.l.LOW:this.multisample=R.l.NONE},g.prototype.addSystem=function(m,y){var N=new m(this);if(this[y])throw new Error('Whoops! The name "'+y+'" is already in use');for(var q in this[y]=N,this.runners)this.runners[q].add(N);return this},g.prototype.render=function(m,y){var N,q,ht,bt;if(y&&(y instanceof rt?(Object(M.deprecation)("6.0.0","Renderer#render arguments changed, use options instead."),N=y,q=arguments[2],ht=arguments[3],bt=arguments[4]):(N=y.renderTexture,q=y.clear,ht=y.transform,bt=y.skipUpdateTransform)),this.renderingToScreen=!N,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=ht,!this.context.isLost){if(N||(this._lastObjectRendered=m),!bt){var wt=m.enableTempParent();m.updateTransform(),m.disableTempParent(wt)}this.renderTexture.bind(N),this.batch.currentRenderer.start(),(q!==void 0?q:this.clearBeforeRender)&&this.renderTexture.clear(),m.render(this),this.batch.currentRenderer.flush(),N&&N.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},g.prototype.generateTexture=function(m,y,N,q){y===void 0&&(y={});var ht=Y.prototype.generateTexture.call(this,m,y,N,q);return this.framebuffer.blit(),ht},g.prototype.resize=function(m,y){Y.prototype.resize.call(this,m,y),this.runners.resize.emit(this.screen.height,this.screen.width)},g.prototype.reset=function(){return this.runners.reset.emit(),this},g.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},g.prototype.destroy=function(m){for(var y in this.runners.destroy.emit(),this.runners)this.runners[y].destroy();Y.prototype.destroy.call(this,m),this.gl=null},Object.defineProperty(g.prototype,"extract",{get:function(){return Object(M.deprecation)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),g.registerPlugin=function(m,y){g.__plugins=g.__plugins||{},g.__plugins[m]=y},g}(wi);function lo(Y){return Ni.create(Y)}var vi=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Wn=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Io=function(){this.texArray=null,this.blend=0,this.type=R.f.TRIANGLES,this.start=0,this.size=0,this.data=null},Br=function(){function Y(){this.elements=[],this.ids=[],this.count=0}return Y.prototype.clear=function(){for(var g=0;g<this.count;g++)this.elements[g]=null;this.count=0},Y}(),Po=function(){function Y(g){typeof g=="number"?this.rawBinaryData=new ArrayBuffer(g):g instanceof Uint8Array?this.rawBinaryData=g.buffer:this.rawBinaryData=g,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(Y.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),Y.prototype.view=function(g){return this[g+"View"]},Y.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Y.sizeOf=function(g){switch(g){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(g+" isn't a valid view type")}},Y}(),Cr=function(Y){function g(m){var y=Y.call(this,m)||this;return y.shaderGenerator=null,y.geometryClass=null,y.vertexSize=null,y.state=Yr.for2d(),y.size=4*O.b.SPRITE_BATCH_SIZE,y._vertexCount=0,y._indexCount=0,y._bufferedElements=[],y._bufferedTextures=[],y._bufferSize=0,y._shader=null,y._packedGeometries=[],y._packedGeometryPoolSize=2,y._flushId=0,y._aBuffers={},y._iBuffers={},y.MAX_TEXTURES=1,y.renderer.on("prerender",y.onPrerender,y),m.runners.contextChange.add(y),y._dcIndex=0,y._aIndex=0,y._iIndex=0,y._attributeBuffer=null,y._indexBuffer=null,y._tempBoundTextures=[],y}return pt(g,Y),g.prototype.contextChange=function(){var m=this.renderer.gl;O.b.PREFER_ENV===R.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS),O.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(N,q){if(N===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var ht=q.createShader(q.FRAGMENT_SHADER);;){var bt=$o.replace(/%forloop%/gi,so(N));if(q.shaderSource(ht,bt),q.compileShader(ht),q.getShaderParameter(ht,q.COMPILE_STATUS))break;N=N/2|0}return N}(this.MAX_TEXTURES,m)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var y=0;y<this._packedGeometryPoolSize;y++)this._packedGeometries[y]=new this.geometryClass;this.initFlushBuffers()},g.prototype.initFlushBuffers=function(){for(var m=g._drawCallPool,y=g._textureArrayPool,N=this.size/4,q=Math.floor(N/this.MAX_TEXTURES)+1;m.length<N;)m.push(new Io);for(;y.length<q;)y.push(new Br);for(var ht=0;ht<this.MAX_TEXTURES;ht++)this._tempBoundTextures[ht]=null},g.prototype.onPrerender=function(){this._flushId=0},g.prototype.render=function(m){m._texture.valid&&(this._vertexCount+m.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=m.vertexData.length/2,this._indexCount+=m.indices.length,this._bufferedTextures[this._bufferSize]=m._texture.baseTexture,this._bufferedElements[this._bufferSize++]=m)},g.prototype.buildTexturesAndDrawCalls=function(){var m=this._bufferedTextures,y=this.MAX_TEXTURES,N=g._textureArrayPool,q=this.renderer.batch,ht=this._tempBoundTextures,bt=this.renderer.textureGC.count,wt=++F._globalBatch,Kt=0,ne=N[0],Fe=0;q.copyBoundTextures(ht,y);for(var Te=0;Te<this._bufferSize;++Te){var $e=m[Te];m[Te]=null,$e._batchEnabled!==wt&&(ne.count>=y&&(q.boundArray(ne,ht,wt,y),this.buildDrawCalls(ne,Fe,Te),Fe=Te,ne=N[++Kt],++wt),$e._batchEnabled=wt,$e.touched=bt,ne.elements[ne.count++]=$e)}for(ne.count>0&&(q.boundArray(ne,ht,wt,y),this.buildDrawCalls(ne,Fe,this._bufferSize),++Kt,++wt),Te=0;Te<ht.length;Te++)ht[Te]=null;F._globalBatch=wt},g.prototype.buildDrawCalls=function(m,y,N){var q=this._bufferedElements,ht=this._attributeBuffer,bt=this._indexBuffer,wt=this.vertexSize,Kt=g._drawCallPool,ne=this._dcIndex,Fe=this._aIndex,Te=this._iIndex,$e=Kt[ne];$e.start=this._iIndex,$e.texArray=m;for(var hn=y;hn<N;++hn){var vn=q[hn],un=vn._texture.baseTexture,Kn=M.premultiplyBlendMode[un.alphaMode?1:0][vn.blendMode];q[hn]=null,y<hn&&$e.blend!==Kn&&($e.size=Te-$e.start,y=hn,($e=Kt[++ne]).texArray=m,$e.start=Te),this.packInterleavedGeometry(vn,ht,bt,Fe,Te),Fe+=vn.vertexData.length/2*wt,Te+=vn.indices.length,$e.blend=Kn}y<N&&($e.size=Te-$e.start,++ne),this._dcIndex=ne,this._aIndex=Fe,this._iIndex=Te},g.prototype.bindAndClearTexArray=function(m){for(var y=this.renderer.texture,N=0;N<m.count;N++)y.bind(m.elements[N],m.ids[N]),m.elements[N]=null;m.count=0},g.prototype.updateGeometry=function(){var m=this._packedGeometries,y=this._attributeBuffer,N=this._indexBuffer;O.b.CAN_UPLOAD_SAME_BUFFER?(m[this._flushId]._buffer.update(y.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,m[this._flushId]=new this.geometryClass),m[this._flushId]._buffer.update(y.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.bind(m[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},g.prototype.drawBatches=function(){for(var m=this._dcIndex,y=this.renderer,N=y.gl,q=y.state,ht=g._drawCallPool,bt=null,wt=0;wt<m;wt++){var Kt=ht[wt],ne=Kt.texArray,Fe=Kt.type,Te=Kt.size,$e=Kt.start,hn=Kt.blend;bt!==ne&&(bt=ne,this.bindAndClearTexArray(ne)),this.state.blendMode=hn,q.set(this.state),N.drawElements(Fe,Te,N.UNSIGNED_SHORT,2*$e)}},g.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},g.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),O.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},g.prototype.stop=function(){this.flush()},g.prototype.destroy=function(){for(var m=0;m<this._packedGeometryPoolSize;m++)this._packedGeometries[m]&&this._packedGeometries[m].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),Y.prototype.destroy.call(this)},g.prototype.getAttributeBuffer=function(m){var y=Object(M.nextPow2)(Math.ceil(m/8)),N=Object(M.log2)(y),q=8*y;this._aBuffers.length<=N&&(this._iBuffers.length=N+1);var ht=this._aBuffers[q];return ht||(this._aBuffers[q]=ht=new Po(q*this.vertexSize*4)),ht},g.prototype.getIndexBuffer=function(m){var y=Object(M.nextPow2)(Math.ceil(m/12)),N=Object(M.log2)(y),q=12*y;this._iBuffers.length<=N&&(this._iBuffers.length=N+1);var ht=this._iBuffers[N];return ht||(this._iBuffers[N]=ht=new Uint16Array(q)),ht},g.prototype.packInterleavedGeometry=function(m,y,N,q,ht){for(var bt=y.uint32View,wt=y.float32View,Kt=q/this.vertexSize,ne=m.uvs,Fe=m.indices,Te=m.vertexData,$e=m._texture.baseTexture._batchLocation,hn=Math.min(m.worldAlpha,1),vn=hn<1&&m._texture.baseTexture.alphaMode?Object(M.premultiplyTint)(m._tintRGB,hn):m._tintRGB+(255*hn<<24),un=0;un<Te.length;un+=2)wt[q++]=Te[un],wt[q++]=Te[un+1],wt[q++]=ne[un],wt[q++]=ne[un+1],bt[q++]=vn,wt[q++]=$e;for(un=0;un<Fe.length;un++)N[ht++]=Kt+Fe[un]},g._drawCallPool=[],g._textureArrayPool=[],g}(fe),Rr=function(){function Y(g,m){if(this.vertexSrc=g,this.fragTemplate=m,this.programCache={},this.defaultGroupCache={},m.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(m.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return Y.prototype.generateShader=function(g){if(!this.programCache[g]){for(var m=new Int32Array(g),y=0;y<g;y++)m[y]=y;this.defaultGroupCache[g]=cn.from({uSamplers:m},!0);var N=this.fragTemplate;N=(N=N.replace(/%count%/gi,""+g)).replace(/%forloop%/gi,this.generateSampleSrc(g)),this.programCache[g]=new jn(this.vertexSrc,N)}var q={tint:new Float32Array([1,1,1,1]),translationMatrix:new z.d,default:this.defaultGroupCache[g]};return new Qi(this.programCache[g],q)},Y.prototype.generateSampleSrc=function(g){var m="";m+=`
`,m+=`
`;for(var y=0;y<g;y++)y>0&&(m+=`
else `),y<g-1&&(m+="if(vTextureId < "+y+".5)"),m+=`
{`,m+=`
	color = texture2D(uSamplers[`+y+"], vTextureCoord);",m+=`
}`;return m+=`
`,m+=`
`},Y}(),ar=function(Y){function g(m){m===void 0&&(m=!1);var y=Y.call(this)||this;return y._buffer=new Yt(null,m,!1),y._indexBuffer=new Yt(null,m,!0),y.addAttribute("aVertexPosition",y._buffer,2,!1,R.r.FLOAT).addAttribute("aTextureCoord",y._buffer,2,!1,R.r.FLOAT).addAttribute("aColor",y._buffer,4,!0,R.r.UNSIGNED_BYTE).addAttribute("aTextureId",y._buffer,1,!0,R.r.FLOAT).addIndex(y._indexBuffer),y}return pt(g,Y),g}(Le),Oo=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Lo=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,No=function(){function Y(){}return Y.create=function(g){var m=Object.assign({vertex:Oo,fragment:Lo,geometryClass:ar,vertexSize:6},g),y=m.vertex,N=m.fragment,q=m.vertexSize,ht=m.geometryClass;return function(bt){function wt(Kt){var ne=bt.call(this,Kt)||this;return ne.shaderGenerator=new Rr(y,N),ne.geometryClass=ht,ne.vertexSize=q,ne}return pt(wt,bt),wt}(Cr)},Object.defineProperty(Y,"defaultVertexSrc",{get:function(){return Oo},enumerable:!1,configurable:!0}),Object.defineProperty(Y,"defaultFragmentTemplate",{get:function(){return Lo},enumerable:!1,configurable:!0}),Y}().create()},function(b,S,v){v.r(S),v.d(S,"BaseTextureCache",function(){return _e}),v.d(S,"CanvasRenderTarget",function(){return Ae}),v.d(S,"DATA_URI",function(){return cn}),v.d(S,"ProgramCache",function(){return Jt}),v.d(S,"TextureCache",function(){return at}),v.d(S,"clearTextureCache",function(){return Le}),v.d(S,"correctBlendMode",function(){return H}),v.d(S,"createIndicesForQuads",function(){return V}),v.d(S,"decomposeDataUri",function(){return Ue}),v.d(S,"deprecation",function(){return Yt}),v.d(S,"destroyTextureCache",function(){return ke}),v.d(S,"determineCrossOrigin",function(){return Ge}),v.d(S,"getBufferType",function(){return k}),v.d(S,"getResolutionOfUrl",function(){return Rn}),v.d(S,"hex2rgb",function(){return F}),v.d(S,"hex2string",function(){return W}),v.d(S,"interleaveTypedArrays",function(){return tt}),v.d(S,"isPow2",function(){return Dt}),v.d(S,"isWebGLSupported",function(){return L}),v.d(S,"log2",function(){return Z}),v.d(S,"nextPow2",function(){return _t}),v.d(S,"premultiplyBlendMode",function(){return Q}),v.d(S,"premultiplyRgba",function(){return Ot}),v.d(S,"premultiplyTint",function(){return Vt}),v.d(S,"premultiplyTintToRgba",function(){return st}),v.d(S,"removeItems",function(){return ct}),v.d(S,"rgb2hex",function(){return j}),v.d(S,"sayHello",function(){return vt}),v.d(S,"sign",function(){return rt}),v.d(S,"skipHello",function(){return Nt}),v.d(S,"string2hex",function(){return P}),v.d(S,"trimCanvas",function(){return ze}),v.d(S,"uid",function(){return At}),v.d(S,"url",function(){return J});var O=v(4);v.d(S,"isMobile",function(){return O.a});var R=v(52),M=v.n(R);v.d(S,"EventEmitter",function(){return M.a});var D=v(53),B=v.n(D);v.d(S,"earcut",function(){return B.a});var z=v(36),X=v(0),J={parse:z.parse,format:z.format,resolve:z.resolve};O.b.RETINA_PREFIX=/@([0-9\.]+)x/,O.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var et,pt=!1;function Nt(){pt=!0}function vt(re){var fe;if(!pt){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var we=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+re+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(fe=globalThis.console).log.apply(fe,we)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+re+" - http://www.pixijs.com/");pt=!0}}function L(){return et===void 0&&(et=function(){var re={stencil:!0,failIfMajorPerformanceCaveat:O.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var fe=document.createElement("canvas"),we=fe.getContext("webgl",re)||fe.getContext("experimental-webgl",re),ln=!(!we||!we.getContextAttributes().stencil);if(we){var In=we.getExtension("WEBGL_lose_context");In&&In.loseContext()}return we=null,ln}catch{return!1}}()),et}var I={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function F(re,fe){return fe===void 0&&(fe=[]),fe[0]=(re>>16&255)/255,fe[1]=(re>>8&255)/255,fe[2]=(255&re)/255,fe}function W(re){var fe=re.toString(16);return"#"+(fe="000000".substring(0,6-fe.length)+fe)}function P(re){return typeof re=="string"&&(re=I[re.toLowerCase()]||re)[0]==="#"&&(re=re.slice(1)),parseInt(re,16)}function j(re){return(255*re[0]<<16)+(255*re[1]<<8)+(255*re[2]|0)}var Q=function(){for(var re=[],fe=[],we=0;we<32;we++)re[we]=we,fe[we]=we;re[X.b.NORMAL_NPM]=X.b.NORMAL,re[X.b.ADD_NPM]=X.b.ADD,re[X.b.SCREEN_NPM]=X.b.SCREEN,fe[X.b.NORMAL]=X.b.NORMAL_NPM,fe[X.b.ADD]=X.b.ADD_NPM,fe[X.b.SCREEN]=X.b.SCREEN_NPM;var ln=[];return ln.push(fe),ln.push(re),ln}();function H(re,fe){return Q[fe?1:0][re]}function Ot(re,fe,we,ln){return we=we||new Float32Array(4),ln||ln===void 0?(we[0]=re[0]*fe,we[1]=re[1]*fe,we[2]=re[2]*fe):(we[0]=re[0],we[1]=re[1],we[2]=re[2]),we[3]=fe,we}function Vt(re,fe){if(fe===1)return(255*fe<<24)+re;if(fe===0)return 0;var we=re>>16&255,ln=re>>8&255,In=255&re;return(255*fe<<24)+((we=we*fe+.5|0)<<16)+((ln=ln*fe+.5|0)<<8)+(In=In*fe+.5|0)}function st(re,fe,we,ln){return(we=we||new Float32Array(4))[0]=(re>>16&255)/255,we[1]=(re>>8&255)/255,we[2]=(255&re)/255,(ln||ln===void 0)&&(we[0]*=fe,we[1]*=fe,we[2]*=fe),we[3]=fe,we}function V(re,fe){fe===void 0&&(fe=null);var we=6*re;if((fe=fe||new Uint16Array(we)).length!==we)throw new Error("Out buffer length is incorrect, got "+fe.length+" and expected "+we);for(var ln=0,In=0;ln<we;ln+=6,In+=4)fe[ln+0]=In+0,fe[ln+1]=In+1,fe[ln+2]=In+2,fe[ln+3]=In+0,fe[ln+4]=In+2,fe[ln+5]=In+3;return fe}function k(re){if(re.BYTES_PER_ELEMENT===4)return re instanceof Float32Array?"Float32Array":re instanceof Uint32Array?"Uint32Array":"Int32Array";if(re.BYTES_PER_ELEMENT===2){if(re instanceof Uint16Array)return"Uint16Array"}else if(re.BYTES_PER_ELEMENT===1&&re instanceof Uint8Array)return"Uint8Array";return null}var mt={Float32Array,Uint32Array,Int32Array,Uint8Array};function tt(re,fe){for(var we=0,ln=0,In={},Zn=0;Zn<re.length;Zn++)ln+=fe[Zn],we+=re[Zn].length;var gi=new ArrayBuffer(4*we),tn=null,xt=0;for(Zn=0;Zn<re.length;Zn++){var St=fe[Zn],Rt=re[Zn],Qt=k(Rt);In[Qt]||(In[Qt]=new mt[Qt](gi)),tn=In[Qt];for(var Wt=0;Wt<Rt.length;Wt++)tn[(Wt/St|0)*ln+xt+Wt%St]=Rt[Wt];xt+=St}return new Float32Array(gi)}function _t(re){return re+=re===0?1:0,--re,re|=re>>>1,re|=re>>>2,re|=re>>>4,re|=re>>>8,(re|=re>>>16)+1}function Dt(re){return!(re&re-1||!re)}function Z(re){var fe=(re>65535?1:0)<<4,we=((re>>>=fe)>255?1:0)<<3;return fe|=we,fe|=we=((re>>>=we)>15?1:0)<<2,(fe|=we=((re>>>=we)>3?1:0)<<1)|(re>>>=we)>>1}function ct(re,fe,we){var ln,In=re.length;if(!(fe>=In||we===0)){var Zn=In-(we=fe+we>In?In-fe:we);for(ln=fe;ln<Zn;++ln)re[ln]=re[ln+we];re.length=Zn}}function rt(re){return re===0?0:re<0?-1:1}var yt=0;function At(){return++yt}var Gt={};function Yt(re,fe,we){if(we===void 0&&(we=3),!Gt[fe]){var ln=new Error().stack;ln===void 0?console.warn("PixiJS Deprecation Warning: ",fe+`
Deprecated since v`+re):(ln=ln.split(`
`).splice(we).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",fe+`
Deprecated since v`+re),console.warn(ln),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",fe+`
Deprecated since v`+re),console.warn(ln))),Gt[fe]=!0}}var Jt={},at=Object.create(null),_e=Object.create(null);function ke(){var re;for(re in at)at[re].destroy();for(re in _e)_e[re].destroy()}function Le(){var re;for(re in at)delete at[re];for(re in _e)delete _e[re]}var Ae=function(){function re(fe,we,ln){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=ln||O.b.RESOLUTION,this.resize(fe,we)}return re.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},re.prototype.resize=function(fe,we){this.canvas.width=Math.round(fe*this.resolution),this.canvas.height=Math.round(we*this.resolution)},re.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(re.prototype,"width",{get:function(){return this.canvas.width},set:function(fe){this.canvas.width=Math.round(fe)},enumerable:!1,configurable:!0}),Object.defineProperty(re.prototype,"height",{get:function(){return this.canvas.height},set:function(fe){this.canvas.height=Math.round(fe)},enumerable:!1,configurable:!0}),re}();function ze(re){var fe,we,ln,In=re.width,Zn=re.height,gi=re.getContext("2d"),tn=gi.getImageData(0,0,In,Zn).data,xt=tn.length,St={top:null,left:null,right:null,bottom:null},Rt=null;for(fe=0;fe<xt;fe+=4)tn[fe+3]!==0&&(we=fe/4%In,ln=~~(fe/4/In),St.top===null&&(St.top=ln),(St.left===null||we<St.left)&&(St.left=we),(St.right===null||St.right<we)&&(St.right=we+1),(St.bottom===null||St.bottom<ln)&&(St.bottom=ln));return St.top!==null&&(In=St.right-St.left,Zn=St.bottom-St.top+1,Rt=gi.getImageData(St.left,St.top,In,Zn)),{height:Zn,width:In,data:Rt}}var Qe,cn=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Ue(re){var fe=cn.exec(re);if(fe)return{mediaType:fe[1]?fe[1].toLowerCase():void 0,subType:fe[2]?fe[2].toLowerCase():void 0,charset:fe[3]?fe[3].toLowerCase():void 0,encoding:fe[4]?fe[4].toLowerCase():void 0,data:fe[5]}}function Ge(re,fe){if(fe===void 0&&(fe=globalThis.location),re.indexOf("data:")===0)return"";fe=fe||globalThis.location,Qe||(Qe=document.createElement("a")),Qe.href=re;var we=J.parse(Qe.href),ln=!we.port&&fe.port===""||we.port===fe.port;return we.hostname===fe.hostname&&ln&&we.protocol===fe.protocol?"":"anonymous"}function Rn(re,fe){var we=O.b.RETINA_PREFIX.exec(re);return we?parseFloat(we[1]):fe!==void 0?fe:1}},function(b,S,v){v.d(S,"a",function(){return Yt}),v.d(S,"b",function(){return Jt});var O=/iPhone/i,R=/iPod/i,M=/iPad/i,D=/\biOS-universal(?:.+)Mac\b/i,B=/\bAndroid(?:.+)Mobile\b/i,z=/Android/i,X=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,J=/Silk/i,et=/Windows Phone/i,pt=/\bWindows(?:.+)ARM\b/i,Nt=/BlackBerry/i,vt=/BB10/i,L=/Opera Mini/i,I=/\b(CriOS|Chrome)(?:.+)Mobile/i,F=/Mobile(?:.+)Firefox\b/i,W=function(at){return at!==void 0&&at.platform==="MacIntel"&&typeof at.maxTouchPoints=="number"&&at.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var P,j,Q,H,Ot,Vt,st,V,k,mt,tt,_t,Dt,Z,ct,rt,yt,At,Gt,Yt=function(at){var _e={userAgent:"",platform:"",maxTouchPoints:0};at||typeof navigator=="undefined"?typeof at=="string"?_e.userAgent=at:at&&at.userAgent&&(_e={userAgent:at.userAgent,platform:at.platform,maxTouchPoints:at.maxTouchPoints||0}):_e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var ke=_e.userAgent,Le=ke.split("[FBAN");Le[1]!==void 0&&(ke=Le[0]),(Le=ke.split("Twitter"))[1]!==void 0&&(ke=Le[0]);var Ae=function(Qe){return function(cn){return cn.test(Qe)}}(ke),ze={apple:{phone:Ae(O)&&!Ae(et),ipod:Ae(R),tablet:!Ae(O)&&(Ae(M)||W(_e))&&!Ae(et),universal:Ae(D),device:(Ae(O)||Ae(R)||Ae(M)||Ae(D)||W(_e))&&!Ae(et)},amazon:{phone:Ae(X),tablet:!Ae(X)&&Ae(J),device:Ae(X)||Ae(J)},android:{phone:!Ae(et)&&Ae(X)||!Ae(et)&&Ae(B),tablet:!Ae(et)&&!Ae(X)&&!Ae(B)&&(Ae(J)||Ae(z)),device:!Ae(et)&&(Ae(X)||Ae(J)||Ae(B)||Ae(z))||Ae(/\bokhttp\b/i)},windows:{phone:Ae(et),tablet:Ae(pt),device:Ae(et)||Ae(pt)},other:{blackberry:Ae(Nt),blackberry10:Ae(vt),opera:Ae(L),firefox:Ae(F),chrome:Ae(I),device:Ae(Nt)||Ae(vt)||Ae(L)||Ae(F)||Ae(I)},any:!1,phone:!1,tablet:!1};return ze.any=ze.apple.device||ze.android.device||ze.windows.device||ze.other.device,ze.phone=ze.apple.phone||ze.android.phone||ze.windows.phone,ze.tablet=ze.apple.tablet||ze.android.tablet||ze.windows.tablet,ze}(globalThis.navigator);(function(at){at[at.WEBGL_LEGACY=0]="WEBGL_LEGACY",at[at.WEBGL=1]="WEBGL",at[at.WEBGL2=2]="WEBGL2"})(P||(P={})),function(at){at[at.UNKNOWN=0]="UNKNOWN",at[at.WEBGL=1]="WEBGL",at[at.CANVAS=2]="CANVAS"}(j||(j={})),function(at){at[at.COLOR=16384]="COLOR",at[at.DEPTH=256]="DEPTH",at[at.STENCIL=1024]="STENCIL"}(Q||(Q={})),function(at){at[at.NORMAL=0]="NORMAL",at[at.ADD=1]="ADD",at[at.MULTIPLY=2]="MULTIPLY",at[at.SCREEN=3]="SCREEN",at[at.OVERLAY=4]="OVERLAY",at[at.DARKEN=5]="DARKEN",at[at.LIGHTEN=6]="LIGHTEN",at[at.COLOR_DODGE=7]="COLOR_DODGE",at[at.COLOR_BURN=8]="COLOR_BURN",at[at.HARD_LIGHT=9]="HARD_LIGHT",at[at.SOFT_LIGHT=10]="SOFT_LIGHT",at[at.DIFFERENCE=11]="DIFFERENCE",at[at.EXCLUSION=12]="EXCLUSION",at[at.HUE=13]="HUE",at[at.SATURATION=14]="SATURATION",at[at.COLOR=15]="COLOR",at[at.LUMINOSITY=16]="LUMINOSITY",at[at.NORMAL_NPM=17]="NORMAL_NPM",at[at.ADD_NPM=18]="ADD_NPM",at[at.SCREEN_NPM=19]="SCREEN_NPM",at[at.NONE=20]="NONE",at[at.SRC_OVER=0]="SRC_OVER",at[at.SRC_IN=21]="SRC_IN",at[at.SRC_OUT=22]="SRC_OUT",at[at.SRC_ATOP=23]="SRC_ATOP",at[at.DST_OVER=24]="DST_OVER",at[at.DST_IN=25]="DST_IN",at[at.DST_OUT=26]="DST_OUT",at[at.DST_ATOP=27]="DST_ATOP",at[at.ERASE=26]="ERASE",at[at.SUBTRACT=28]="SUBTRACT",at[at.XOR=29]="XOR"}(H||(H={})),function(at){at[at.POINTS=0]="POINTS",at[at.LINES=1]="LINES",at[at.LINE_LOOP=2]="LINE_LOOP",at[at.LINE_STRIP=3]="LINE_STRIP",at[at.TRIANGLES=4]="TRIANGLES",at[at.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",at[at.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ot||(Ot={})),function(at){at[at.RGBA=6408]="RGBA",at[at.RGB=6407]="RGB",at[at.RG=33319]="RG",at[at.RED=6403]="RED",at[at.RGBA_INTEGER=36249]="RGBA_INTEGER",at[at.RGB_INTEGER=36248]="RGB_INTEGER",at[at.RG_INTEGER=33320]="RG_INTEGER",at[at.RED_INTEGER=36244]="RED_INTEGER",at[at.ALPHA=6406]="ALPHA",at[at.LUMINANCE=6409]="LUMINANCE",at[at.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",at[at.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",at[at.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Vt||(Vt={})),function(at){at[at.TEXTURE_2D=3553]="TEXTURE_2D",at[at.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",at[at.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",at[at.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",at[at.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",at[at.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",at[at.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(st||(st={})),function(at){at[at.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",at[at.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",at[at.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",at[at.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",at[at.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",at[at.UNSIGNED_INT=5125]="UNSIGNED_INT",at[at.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",at[at.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",at[at.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",at[at.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",at[at.BYTE=5120]="BYTE",at[at.SHORT=5122]="SHORT",at[at.INT=5124]="INT",at[at.FLOAT=5126]="FLOAT",at[at.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",at[at.HALF_FLOAT=36193]="HALF_FLOAT"}(V||(V={})),function(at){at[at.FLOAT=0]="FLOAT",at[at.INT=1]="INT",at[at.UINT=2]="UINT"}(k||(k={})),function(at){at[at.NEAREST=0]="NEAREST",at[at.LINEAR=1]="LINEAR"}(mt||(mt={})),function(at){at[at.CLAMP=33071]="CLAMP",at[at.REPEAT=10497]="REPEAT",at[at.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(tt||(tt={})),function(at){at[at.OFF=0]="OFF",at[at.POW2=1]="POW2",at[at.ON=2]="ON",at[at.ON_MANUAL=3]="ON_MANUAL"}(_t||(_t={})),function(at){at[at.NPM=0]="NPM",at[at.UNPACK=1]="UNPACK",at[at.PMA=2]="PMA",at[at.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",at[at.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",at[at.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",at[at.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Dt||(Dt={})),function(at){at[at.NO=0]="NO",at[at.YES=1]="YES",at[at.AUTO=2]="AUTO",at[at.BLEND=0]="BLEND",at[at.CLEAR=1]="CLEAR",at[at.BLIT=2]="BLIT"}(Z||(Z={})),function(at){at[at.AUTO=0]="AUTO",at[at.MANUAL=1]="MANUAL"}(ct||(ct={})),function(at){at.LOW="lowp",at.MEDIUM="mediump",at.HIGH="highp"}(rt||(rt={})),function(at){at[at.NONE=0]="NONE",at[at.SCISSOR=1]="SCISSOR",at[at.STENCIL=2]="STENCIL",at[at.SPRITE=3]="SPRITE"}(yt||(yt={})),function(at){at[at.NONE=0]="NONE",at[at.LOW=2]="LOW",at[at.MEDIUM=4]="MEDIUM",at[at.HIGH=8]="HIGH"}(At||(At={})),function(at){at[at.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",at[at.ARRAY_BUFFER=34962]="ARRAY_BUFFER",at[at.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Gt||(Gt={}));var Jt={MIPMAP_TEXTURES:_t.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:At.NONE,SPRITE_MAX_TEXTURES:function(at){var _e=!0;if(Yt.tablet||Yt.phone){var ke;Yt.apple.device&&(ke=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(ke[1],10)<11&&(_e=!1),Yt.android.device&&(ke=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(ke[1],10)<7&&(_e=!1)}return _e?at:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:ct.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:tt.CLAMP,SCALE_MODE:mt.LINEAR,PRECISION_VERTEX:rt.HIGH,PRECISION_FRAGMENT:Yt.apple.device?rt.HIGH:rt.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Yt.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},function(b,S,v){v.d(S,"a",function(){return D}),v.d(S,"b",function(){return Dt}),v.d(S,"c",function(){return mt}),v.d(S,"d",function(){return tt});var O=v(4),R=v(1),M=v(3);/*!
 * @pixi/display - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */O.b.SORTABLE_CHILDREN=!1;var D=function(){function Z(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return Z.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Z.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Z.prototype.getRectangle=function(ct){return this.minX>this.maxX||this.minY>this.maxY?R.j.EMPTY:((ct=ct||new R.j(0,0,1,1)).x=this.minX,ct.y=this.minY,ct.width=this.maxX-this.minX,ct.height=this.maxY-this.minY,ct)},Z.prototype.addPoint=function(ct){this.minX=Math.min(this.minX,ct.x),this.maxX=Math.max(this.maxX,ct.x),this.minY=Math.min(this.minY,ct.y),this.maxY=Math.max(this.maxY,ct.y)},Z.prototype.addPointMatrix=function(ct,rt){var yt=ct.a,At=ct.b,Gt=ct.c,Yt=ct.d,Jt=ct.tx,at=ct.ty,_e=yt*rt.x+Gt*rt.y+Jt,ke=At*rt.x+Yt*rt.y+at;this.minX=Math.min(this.minX,_e),this.maxX=Math.max(this.maxX,_e),this.minY=Math.min(this.minY,ke),this.maxY=Math.max(this.maxY,ke)},Z.prototype.addQuad=function(ct){var rt=this.minX,yt=this.minY,At=this.maxX,Gt=this.maxY,Yt=ct[0],Jt=ct[1];rt=Yt<rt?Yt:rt,yt=Jt<yt?Jt:yt,At=Yt>At?Yt:At,Gt=Jt>Gt?Jt:Gt,rt=(Yt=ct[2])<rt?Yt:rt,yt=(Jt=ct[3])<yt?Jt:yt,At=Yt>At?Yt:At,Gt=Jt>Gt?Jt:Gt,rt=(Yt=ct[4])<rt?Yt:rt,yt=(Jt=ct[5])<yt?Jt:yt,At=Yt>At?Yt:At,Gt=Jt>Gt?Jt:Gt,rt=(Yt=ct[6])<rt?Yt:rt,yt=(Jt=ct[7])<yt?Jt:yt,At=Yt>At?Yt:At,Gt=Jt>Gt?Jt:Gt,this.minX=rt,this.minY=yt,this.maxX=At,this.maxY=Gt},Z.prototype.addFrame=function(ct,rt,yt,At,Gt){this.addFrameMatrix(ct.worldTransform,rt,yt,At,Gt)},Z.prototype.addFrameMatrix=function(ct,rt,yt,At,Gt){var Yt=ct.a,Jt=ct.b,at=ct.c,_e=ct.d,ke=ct.tx,Le=ct.ty,Ae=this.minX,ze=this.minY,Qe=this.maxX,cn=this.maxY,Ue=Yt*rt+at*yt+ke,Ge=Jt*rt+_e*yt+Le;Ae=Ue<Ae?Ue:Ae,ze=Ge<ze?Ge:ze,Qe=Ue>Qe?Ue:Qe,cn=Ge>cn?Ge:cn,Ae=(Ue=Yt*At+at*yt+ke)<Ae?Ue:Ae,ze=(Ge=Jt*At+_e*yt+Le)<ze?Ge:ze,Qe=Ue>Qe?Ue:Qe,cn=Ge>cn?Ge:cn,Ae=(Ue=Yt*rt+at*Gt+ke)<Ae?Ue:Ae,ze=(Ge=Jt*rt+_e*Gt+Le)<ze?Ge:ze,Qe=Ue>Qe?Ue:Qe,cn=Ge>cn?Ge:cn,Ae=(Ue=Yt*At+at*Gt+ke)<Ae?Ue:Ae,ze=(Ge=Jt*At+_e*Gt+Le)<ze?Ge:ze,Qe=Ue>Qe?Ue:Qe,cn=Ge>cn?Ge:cn,this.minX=Ae,this.minY=ze,this.maxX=Qe,this.maxY=cn},Z.prototype.addVertexData=function(ct,rt,yt){for(var At=this.minX,Gt=this.minY,Yt=this.maxX,Jt=this.maxY,at=rt;at<yt;at+=2){var _e=ct[at],ke=ct[at+1];At=_e<At?_e:At,Gt=ke<Gt?ke:Gt,Yt=_e>Yt?_e:Yt,Jt=ke>Jt?ke:Jt}this.minX=At,this.minY=Gt,this.maxX=Yt,this.maxY=Jt},Z.prototype.addVertices=function(ct,rt,yt,At){this.addVerticesMatrix(ct.worldTransform,rt,yt,At)},Z.prototype.addVerticesMatrix=function(ct,rt,yt,At,Gt,Yt){Gt===void 0&&(Gt=0),Yt===void 0&&(Yt=Gt);for(var Jt=ct.a,at=ct.b,_e=ct.c,ke=ct.d,Le=ct.tx,Ae=ct.ty,ze=this.minX,Qe=this.minY,cn=this.maxX,Ue=this.maxY,Ge=yt;Ge<At;Ge+=2){var Rn=rt[Ge],re=rt[Ge+1],fe=Jt*Rn+_e*re+Le,we=ke*re+at*Rn+Ae;ze=Math.min(ze,fe-Gt),cn=Math.max(cn,fe+Gt),Qe=Math.min(Qe,we-Yt),Ue=Math.max(Ue,we+Yt)}this.minX=ze,this.minY=Qe,this.maxX=cn,this.maxY=Ue},Z.prototype.addBounds=function(ct){var rt=this.minX,yt=this.minY,At=this.maxX,Gt=this.maxY;this.minX=ct.minX<rt?ct.minX:rt,this.minY=ct.minY<yt?ct.minY:yt,this.maxX=ct.maxX>At?ct.maxX:At,this.maxY=ct.maxY>Gt?ct.maxY:Gt},Z.prototype.addBoundsMask=function(ct,rt){var yt=ct.minX>rt.minX?ct.minX:rt.minX,At=ct.minY>rt.minY?ct.minY:rt.minY,Gt=ct.maxX<rt.maxX?ct.maxX:rt.maxX,Yt=ct.maxY<rt.maxY?ct.maxY:rt.maxY;if(yt<=Gt&&At<=Yt){var Jt=this.minX,at=this.minY,_e=this.maxX,ke=this.maxY;this.minX=yt<Jt?yt:Jt,this.minY=At<at?At:at,this.maxX=Gt>_e?Gt:_e,this.maxY=Yt>ke?Yt:ke}},Z.prototype.addBoundsMatrix=function(ct,rt){this.addFrameMatrix(rt,ct.minX,ct.minY,ct.maxX,ct.maxY)},Z.prototype.addBoundsArea=function(ct,rt){var yt=ct.minX>rt.x?ct.minX:rt.x,At=ct.minY>rt.y?ct.minY:rt.y,Gt=ct.maxX<rt.x+rt.width?ct.maxX:rt.x+rt.width,Yt=ct.maxY<rt.y+rt.height?ct.maxY:rt.y+rt.height;if(yt<=Gt&&At<=Yt){var Jt=this.minX,at=this.minY,_e=this.maxX,ke=this.maxY;this.minX=yt<Jt?yt:Jt,this.minY=At<at?At:at,this.maxX=Gt>_e?Gt:_e,this.maxY=Yt>ke?Yt:ke}},Z.prototype.pad=function(ct,rt){ct===void 0&&(ct=0),rt===void 0&&(rt=ct),this.isEmpty()||(this.minX-=ct,this.maxX+=ct,this.minY-=rt,this.maxY+=rt)},Z.prototype.addFramePad=function(ct,rt,yt,At,Gt,Yt){ct-=Gt,rt-=Yt,yt+=Gt,At+=Yt,this.minX=this.minX<ct?this.minX:ct,this.maxX=this.maxX>yt?this.maxX:yt,this.minY=this.minY<rt?this.minY:rt,this.maxY=this.maxY>At?this.maxY:At},Z}(),B=function(Z,ct){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(rt,yt){rt.__proto__=yt}||function(rt,yt){for(var At in yt)yt.hasOwnProperty(At)&&(rt[At]=yt[At])})(Z,ct)};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function z(Z,ct){function rt(){this.constructor=Z}B(Z,ct),Z.prototype=ct===null?Object.create(ct):(rt.prototype=ct.prototype,new rt)}var X,J,et,pt,Nt,vt,L,I,F,W,P,j,Q,H,Ot,Vt,st,V,k,mt=function(Z){function ct(){var rt=Z.call(this)||this;return rt.tempDisplayObjectParent=null,rt.transform=new R.m,rt.alpha=1,rt.visible=!0,rt.renderable=!0,rt.cullable=!1,rt.cullArea=null,rt.parent=null,rt.worldAlpha=1,rt._lastSortedIndex=0,rt._zIndex=0,rt.filterArea=null,rt.filters=null,rt._enabledFilters=null,rt._bounds=new D,rt._localBounds=null,rt._boundsID=0,rt._boundsRect=null,rt._localBoundsRect=null,rt._mask=null,rt._maskRefCount=0,rt._destroyed=!1,rt.isSprite=!1,rt.isMask=!1,rt}return z(ct,Z),ct.mixin=function(rt){for(var yt=Object.keys(rt),At=0;At<yt.length;++At){var Gt=yt[At];Object.defineProperty(ct.prototype,Gt,Object.getOwnPropertyDescriptor(rt,Gt))}},Object.defineProperty(ct.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),ct.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},ct.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},ct.prototype.getBounds=function(rt,yt){return rt||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),yt||(this._boundsRect||(this._boundsRect=new R.j),yt=this._boundsRect),this._bounds.getRectangle(yt)},ct.prototype.getLocalBounds=function(rt){rt||(this._localBoundsRect||(this._localBoundsRect=new R.j),rt=this._localBoundsRect),this._localBounds||(this._localBounds=new D);var yt=this.transform,At=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var Gt=this._bounds,Yt=this._boundsID;this._bounds=this._localBounds;var Jt=this.getBounds(!1,rt);return this.parent=At,this.transform=yt,this._bounds=Gt,this._bounds.updateID+=this._boundsID-Yt,Jt},ct.prototype.toGlobal=function(rt,yt,At){return At===void 0&&(At=!1),At||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(rt,yt)},ct.prototype.toLocal=function(rt,yt,At,Gt){return yt&&(rt=yt.toGlobal(rt,At,Gt)),Gt||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(rt,At)},ct.prototype.setParent=function(rt){if(!rt||!rt.addChild)throw new Error("setParent: Argument must be a Container");return rt.addChild(this),rt},ct.prototype.setTransform=function(rt,yt,At,Gt,Yt,Jt,at,_e,ke){return rt===void 0&&(rt=0),yt===void 0&&(yt=0),At===void 0&&(At=1),Gt===void 0&&(Gt=1),Yt===void 0&&(Yt=0),Jt===void 0&&(Jt=0),at===void 0&&(at=0),_e===void 0&&(_e=0),ke===void 0&&(ke=0),this.position.x=rt,this.position.y=yt,this.scale.x=At||1,this.scale.y=Gt||1,this.rotation=Yt,this.skew.x=Jt,this.skew.y=at,this.pivot.x=_e,this.pivot.y=ke,this},ct.prototype.destroy=function(rt){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(ct.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new tt),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),ct.prototype.enableTempParent=function(){var rt=this.parent;return this.parent=this._tempDisplayObjectParent,rt},ct.prototype.disableTempParent=function(rt){this.parent=rt},Object.defineProperty(ct.prototype,"x",{get:function(){return this.position.x},set:function(rt){this.transform.position.x=rt},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"y",{get:function(){return this.position.y},set:function(rt){this.transform.position.y=rt},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"position",{get:function(){return this.transform.position},set:function(rt){this.transform.position.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"scale",{get:function(){return this.transform.scale},set:function(rt){this.transform.scale.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(rt){this.transform.pivot.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"skew",{get:function(){return this.transform.skew},set:function(rt){this.transform.skew.copyFrom(rt)},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(rt){this.transform.rotation=rt},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"angle",{get:function(){return this.transform.rotation*R.i},set:function(rt){this.transform.rotation=rt*R.b},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"zIndex",{get:function(){return this._zIndex},set:function(rt){this._zIndex=rt,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"worldVisible",{get:function(){var rt=this;do{if(!rt.visible)return!1;rt=rt.parent}while(rt);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"mask",{get:function(){return this._mask},set:function(rt){if(this._mask!==rt){var yt;this._mask&&((yt=this._mask.maskObject||this._mask)._maskRefCount--,yt._maskRefCount===0&&(yt.renderable=!0,yt.isMask=!1)),this._mask=rt,this._mask&&((yt=this._mask.maskObject||this._mask)._maskRefCount===0&&(yt.renderable=!1,yt.isMask=!0),yt._maskRefCount++)}},enumerable:!1,configurable:!0}),ct}(M.EventEmitter),tt=function(Z){function ct(){var rt=Z!==null&&Z.apply(this,arguments)||this;return rt.sortDirty=null,rt}return z(ct,Z),ct}(mt);function _t(Z,ct){return Z.zIndex===ct.zIndex?Z._lastSortedIndex-ct._lastSortedIndex:Z.zIndex-ct.zIndex}mt.prototype.displayObjectUpdateTransform=mt.prototype.updateTransform,function(Z){Z[Z.WEBGL_LEGACY=0]="WEBGL_LEGACY",Z[Z.WEBGL=1]="WEBGL",Z[Z.WEBGL2=2]="WEBGL2"}(X||(X={})),function(Z){Z[Z.UNKNOWN=0]="UNKNOWN",Z[Z.WEBGL=1]="WEBGL",Z[Z.CANVAS=2]="CANVAS"}(J||(J={})),function(Z){Z[Z.COLOR=16384]="COLOR",Z[Z.DEPTH=256]="DEPTH",Z[Z.STENCIL=1024]="STENCIL"}(et||(et={})),function(Z){Z[Z.NORMAL=0]="NORMAL",Z[Z.ADD=1]="ADD",Z[Z.MULTIPLY=2]="MULTIPLY",Z[Z.SCREEN=3]="SCREEN",Z[Z.OVERLAY=4]="OVERLAY",Z[Z.DARKEN=5]="DARKEN",Z[Z.LIGHTEN=6]="LIGHTEN",Z[Z.COLOR_DODGE=7]="COLOR_DODGE",Z[Z.COLOR_BURN=8]="COLOR_BURN",Z[Z.HARD_LIGHT=9]="HARD_LIGHT",Z[Z.SOFT_LIGHT=10]="SOFT_LIGHT",Z[Z.DIFFERENCE=11]="DIFFERENCE",Z[Z.EXCLUSION=12]="EXCLUSION",Z[Z.HUE=13]="HUE",Z[Z.SATURATION=14]="SATURATION",Z[Z.COLOR=15]="COLOR",Z[Z.LUMINOSITY=16]="LUMINOSITY",Z[Z.NORMAL_NPM=17]="NORMAL_NPM",Z[Z.ADD_NPM=18]="ADD_NPM",Z[Z.SCREEN_NPM=19]="SCREEN_NPM",Z[Z.NONE=20]="NONE",Z[Z.SRC_OVER=0]="SRC_OVER",Z[Z.SRC_IN=21]="SRC_IN",Z[Z.SRC_OUT=22]="SRC_OUT",Z[Z.SRC_ATOP=23]="SRC_ATOP",Z[Z.DST_OVER=24]="DST_OVER",Z[Z.DST_IN=25]="DST_IN",Z[Z.DST_OUT=26]="DST_OUT",Z[Z.DST_ATOP=27]="DST_ATOP",Z[Z.ERASE=26]="ERASE",Z[Z.SUBTRACT=28]="SUBTRACT",Z[Z.XOR=29]="XOR"}(pt||(pt={})),function(Z){Z[Z.POINTS=0]="POINTS",Z[Z.LINES=1]="LINES",Z[Z.LINE_LOOP=2]="LINE_LOOP",Z[Z.LINE_STRIP=3]="LINE_STRIP",Z[Z.TRIANGLES=4]="TRIANGLES",Z[Z.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Z[Z.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Nt||(Nt={})),function(Z){Z[Z.RGBA=6408]="RGBA",Z[Z.RGB=6407]="RGB",Z[Z.RG=33319]="RG",Z[Z.RED=6403]="RED",Z[Z.RGBA_INTEGER=36249]="RGBA_INTEGER",Z[Z.RGB_INTEGER=36248]="RGB_INTEGER",Z[Z.RG_INTEGER=33320]="RG_INTEGER",Z[Z.RED_INTEGER=36244]="RED_INTEGER",Z[Z.ALPHA=6406]="ALPHA",Z[Z.LUMINANCE=6409]="LUMINANCE",Z[Z.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Z[Z.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Z[Z.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(vt||(vt={})),function(Z){Z[Z.TEXTURE_2D=3553]="TEXTURE_2D",Z[Z.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Z[Z.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Z[Z.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",Z[Z.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(L||(L={})),function(Z){Z[Z.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Z[Z.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Z[Z.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",Z[Z.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Z[Z.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Z[Z.UNSIGNED_INT=5125]="UNSIGNED_INT",Z[Z.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",Z[Z.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",Z[Z.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",Z[Z.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",Z[Z.BYTE=5120]="BYTE",Z[Z.SHORT=5122]="SHORT",Z[Z.INT=5124]="INT",Z[Z.FLOAT=5126]="FLOAT",Z[Z.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",Z[Z.HALF_FLOAT=36193]="HALF_FLOAT"}(I||(I={})),function(Z){Z[Z.FLOAT=0]="FLOAT",Z[Z.INT=1]="INT",Z[Z.UINT=2]="UINT"}(F||(F={})),function(Z){Z[Z.NEAREST=0]="NEAREST",Z[Z.LINEAR=1]="LINEAR"}(W||(W={})),function(Z){Z[Z.CLAMP=33071]="CLAMP",Z[Z.REPEAT=10497]="REPEAT",Z[Z.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(P||(P={})),function(Z){Z[Z.OFF=0]="OFF",Z[Z.POW2=1]="POW2",Z[Z.ON=2]="ON",Z[Z.ON_MANUAL=3]="ON_MANUAL"}(j||(j={})),function(Z){Z[Z.NPM=0]="NPM",Z[Z.UNPACK=1]="UNPACK",Z[Z.PMA=2]="PMA",Z[Z.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Z[Z.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Z[Z.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",Z[Z.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Q||(Q={})),function(Z){Z[Z.NO=0]="NO",Z[Z.YES=1]="YES",Z[Z.AUTO=2]="AUTO",Z[Z.BLEND=0]="BLEND",Z[Z.CLEAR=1]="CLEAR",Z[Z.BLIT=2]="BLIT"}(H||(H={})),function(Z){Z[Z.AUTO=0]="AUTO",Z[Z.MANUAL=1]="MANUAL"}(Ot||(Ot={})),function(Z){Z.LOW="lowp",Z.MEDIUM="mediump",Z.HIGH="highp"}(Vt||(Vt={})),function(Z){Z[Z.NONE=0]="NONE",Z[Z.SCISSOR=1]="SCISSOR",Z[Z.STENCIL=2]="STENCIL",Z[Z.SPRITE=3]="SPRITE"}(st||(st={})),function(Z){Z[Z.NONE=0]="NONE",Z[Z.LOW=2]="LOW",Z[Z.MEDIUM=4]="MEDIUM",Z[Z.HIGH=8]="HIGH"}(V||(V={})),function(Z){Z[Z.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",Z[Z.ARRAY_BUFFER=34962]="ARRAY_BUFFER",Z[Z.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(k||(k={}));var Dt=function(Z){function ct(){var rt=Z.call(this)||this;return rt.children=[],rt.sortableChildren=O.b.SORTABLE_CHILDREN,rt.sortDirty=!1,rt}return z(ct,Z),ct.prototype.onChildrenChange=function(rt){},ct.prototype.addChild=function(){for(var rt=arguments,yt=[],At=0;At<arguments.length;At++)yt[At]=rt[At];if(yt.length>1)for(var Gt=0;Gt<yt.length;Gt++)this.addChild(yt[Gt]);else{var Yt=yt[0];Yt.parent&&Yt.parent.removeChild(Yt),Yt.parent=this,this.sortDirty=!0,Yt.transform._parentID=-1,this.children.push(Yt),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",Yt,this,this.children.length-1),Yt.emit("added",this)}return yt[0]},ct.prototype.addChildAt=function(rt,yt){if(yt<0||yt>this.children.length)throw new Error(rt+"addChildAt: The index "+yt+" supplied is out of bounds "+this.children.length);return rt.parent&&rt.parent.removeChild(rt),rt.parent=this,this.sortDirty=!0,rt.transform._parentID=-1,this.children.splice(yt,0,rt),this._boundsID++,this.onChildrenChange(yt),rt.emit("added",this),this.emit("childAdded",rt,this,yt),rt},ct.prototype.swapChildren=function(rt,yt){if(rt!==yt){var At=this.getChildIndex(rt),Gt=this.getChildIndex(yt);this.children[At]=yt,this.children[Gt]=rt,this.onChildrenChange(At<Gt?At:Gt)}},ct.prototype.getChildIndex=function(rt){var yt=this.children.indexOf(rt);if(yt===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return yt},ct.prototype.setChildIndex=function(rt,yt){if(yt<0||yt>=this.children.length)throw new Error("The index "+yt+" supplied is out of bounds "+this.children.length);var At=this.getChildIndex(rt);Object(M.removeItems)(this.children,At,1),this.children.splice(yt,0,rt),this.onChildrenChange(yt)},ct.prototype.getChildAt=function(rt){if(rt<0||rt>=this.children.length)throw new Error("getChildAt: Index ("+rt+") does not exist.");return this.children[rt]},ct.prototype.removeChild=function(){for(var rt=arguments,yt=[],At=0;At<arguments.length;At++)yt[At]=rt[At];if(yt.length>1)for(var Gt=0;Gt<yt.length;Gt++)this.removeChild(yt[Gt]);else{var Yt=yt[0],Jt=this.children.indexOf(Yt);if(Jt===-1)return null;Yt.parent=null,Yt.transform._parentID=-1,Object(M.removeItems)(this.children,Jt,1),this._boundsID++,this.onChildrenChange(Jt),Yt.emit("removed",this),this.emit("childRemoved",Yt,this,Jt)}return yt[0]},ct.prototype.removeChildAt=function(rt){var yt=this.getChildAt(rt);return yt.parent=null,yt.transform._parentID=-1,Object(M.removeItems)(this.children,rt,1),this._boundsID++,this.onChildrenChange(rt),yt.emit("removed",this),this.emit("childRemoved",yt,this,rt),yt},ct.prototype.removeChildren=function(rt,yt){rt===void 0&&(rt=0),yt===void 0&&(yt=this.children.length);var At,Gt=rt,Yt=yt-Gt;if(Yt>0&&Yt<=yt){At=this.children.splice(Gt,Yt);for(var Jt=0;Jt<At.length;++Jt)At[Jt].parent=null,At[Jt].transform&&(At[Jt].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(rt),Jt=0;Jt<At.length;++Jt)At[Jt].emit("removed",this),this.emit("childRemoved",At[Jt],this,Jt);return At}if(Yt===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},ct.prototype.sortChildren=function(){for(var rt=!1,yt=0,At=this.children.length;yt<At;++yt){var Gt=this.children[yt];Gt._lastSortedIndex=yt,rt||Gt.zIndex===0||(rt=!0)}rt&&this.children.length>1&&this.children.sort(_t),this.sortDirty=!1},ct.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var rt=0,yt=this.children.length;rt<yt;++rt){var At=this.children[rt];At.visible&&At.updateTransform()}},ct.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var rt=0;rt<this.children.length;rt++){var yt=this.children[rt];if(yt.visible&&yt.renderable)if(yt.calculateBounds(),yt._mask){var At=yt._mask.maskObject||yt._mask;At.calculateBounds(),this._bounds.addBoundsMask(yt._bounds,At._bounds)}else yt.filterArea?this._bounds.addBoundsArea(yt._bounds,yt.filterArea):this._bounds.addBounds(yt._bounds)}this._bounds.updateID=this._boundsID},ct.prototype.getLocalBounds=function(rt,yt){yt===void 0&&(yt=!1);var At=Z.prototype.getLocalBounds.call(this,rt);if(!yt)for(var Gt=0,Yt=this.children.length;Gt<Yt;++Gt){var Jt=this.children[Gt];Jt.visible&&Jt.updateTransform()}return At},ct.prototype._calculateBounds=function(){},ct.prototype._renderWithCulling=function(rt){var yt=rt.renderTexture.sourceFrame;if(yt.width>0&&yt.height>0){var At,Gt;if(this.cullArea?(At=this.cullArea,Gt=this.worldTransform):this._render!==ct.prototype._render&&(At=this.getBounds(!0)),At&&yt.intersects(At,Gt))this._render(rt);else if(this.cullArea)return;for(var Yt=0,Jt=this.children.length;Yt<Jt;++Yt){var at=this.children[Yt],_e=at.cullable;at.cullable=_e||!this.cullArea,at.render(rt),at.cullable=_e}}},ct.prototype.render=function(rt){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(rt);else if(this.cullable)this._renderWithCulling(rt);else{this._render(rt);for(var yt=0,At=this.children.length;yt<At;++yt)this.children[yt].render(rt)}},ct.prototype.renderAdvanced=function(rt){var yt=this.filters,At=this._mask;if(yt){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var Gt=0;Gt<yt.length;Gt++)yt[Gt].enabled&&this._enabledFilters.push(yt[Gt])}var Yt=yt&&this._enabledFilters&&this._enabledFilters.length||At&&(!At.isMaskData||At.enabled&&(At.autoDetect||At.type!==st.NONE));if(Yt&&rt.batch.flush(),yt&&this._enabledFilters&&this._enabledFilters.length&&rt.filter.push(this,this._enabledFilters),At&&rt.mask.push(this,this._mask),this.cullable)this._renderWithCulling(rt);else{this._render(rt),Gt=0;for(var Jt=this.children.length;Gt<Jt;++Gt)this.children[Gt].render(rt)}Yt&&rt.batch.flush(),At&&rt.mask.pop(this),yt&&this._enabledFilters&&this._enabledFilters.length&&rt.filter.pop()},ct.prototype._render=function(rt){},ct.prototype.destroy=function(rt){Z.prototype.destroy.call(this),this.sortDirty=!1;var yt=typeof rt=="boolean"?rt:rt&&rt.children,At=this.removeChildren(0,this.children.length);if(yt)for(var Gt=0;Gt<At.length;++Gt)At[Gt].destroy(rt)},Object.defineProperty(ct.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(rt){var yt=this.getLocalBounds().width;this.scale.x=yt!==0?rt/yt:1,this._width=rt},enumerable:!1,configurable:!0}),Object.defineProperty(ct.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(rt){var yt=this.getLocalBounds().height;this.scale.y=yt!==0?rt/yt:1,this._height=rt},enumerable:!1,configurable:!0}),ct}(mt);Dt.prototype.containerUpdateTransform=Dt.prototype.updateTransform},function(b,S,v){var O=Object.prototype.hasOwnProperty,R="~";function M(){}function D(J,et,pt){this.fn=J,this.context=et,this.once=pt||!1}function B(J,et,pt,Nt,vt){if(typeof pt!="function")throw new TypeError("The listener must be a function");var L=new D(pt,Nt||J,vt),I=R?R+et:et;return J._events[I]?J._events[I].fn?J._events[I]=[J._events[I],L]:J._events[I].push(L):(J._events[I]=L,J._eventsCount++),J}function z(J,et){--J._eventsCount==0?J._events=new M:delete J._events[et]}function X(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),new M().__proto__||(R=!1)),X.prototype.eventNames=function(){var J,et,pt=[];if(this._eventsCount===0)return pt;for(et in J=this._events)O.call(J,et)&&pt.push(R?et.slice(1):et);return Object.getOwnPropertySymbols?pt.concat(Object.getOwnPropertySymbols(J)):pt},X.prototype.listeners=function(J){var et=R?R+J:J,pt=this._events[et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Nt=0,vt=pt.length,L=new Array(vt);Nt<vt;Nt++)L[Nt]=pt[Nt].fn;return L},X.prototype.listenerCount=function(J){var et=R?R+J:J,pt=this._events[et];return pt?pt.fn?1:pt.length:0},X.prototype.emit=function(J,et,pt,Nt,vt,L){var I=R?R+J:J;if(!this._events[I])return!1;var F,W,P=this._events[I],j=arguments.length;if(P.fn){switch(P.once&&this.removeListener(J,P.fn,void 0,!0),j){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,et),!0;case 3:return P.fn.call(P.context,et,pt),!0;case 4:return P.fn.call(P.context,et,pt,Nt),!0;case 5:return P.fn.call(P.context,et,pt,Nt,vt),!0;case 6:return P.fn.call(P.context,et,pt,Nt,vt,L),!0}for(W=1,F=new Array(j-1);W<j;W++)F[W-1]=arguments[W];P.fn.apply(P.context,F)}else{var Q,H=P.length;for(W=0;W<H;W++)switch(P[W].once&&this.removeListener(J,P[W].fn,void 0,!0),j){case 1:P[W].fn.call(P[W].context);break;case 2:P[W].fn.call(P[W].context,et);break;case 3:P[W].fn.call(P[W].context,et,pt);break;case 4:P[W].fn.call(P[W].context,et,pt,Nt);break;default:if(!F)for(Q=1,F=new Array(j-1);Q<j;Q++)F[Q-1]=arguments[Q];P[W].fn.apply(P[W].context,F)}}return!0},X.prototype.on=function(J,et,pt){return B(this,J,et,pt,!1)},X.prototype.once=function(J,et,pt){return B(this,J,et,pt,!0)},X.prototype.removeListener=function(J,et,pt,Nt){var vt=R?R+J:J;if(!this._events[vt])return this;if(!et)return z(this,vt),this;var L=this._events[vt];if(L.fn)L.fn!==et||Nt&&!L.once||pt&&L.context!==pt||z(this,vt);else{for(var I=0,F=[],W=L.length;I<W;I++)(L[I].fn!==et||Nt&&!L[I].once||pt&&L[I].context!==pt)&&F.push(L[I]);F.length?this._events[vt]=F.length===1?F[0]:F:z(this,vt)}return this},X.prototype.removeAllListeners=function(J){var et;return J?(et=R?R+J:J,this._events[et]&&z(this,et)):(this._events=new M,this._eventsCount=0),this},X.prototype.off=X.prototype.removeListener,X.prototype.addListener=X.prototype.on,X.prefixed=R,X.EventEmitter=X,b.exports=X},function(b,S,v){v.d(S,"a",function(){return D}),v.d(S,"b",function(){return B}),v.d(S,"c",function(){return O});var O,R=v(4);/*!
 * @pixi/ticker - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */R.b.TARGET_FPMS=.06,function(z){z[z.INTERACTION=50]="INTERACTION",z[z.HIGH=25]="HIGH",z[z.NORMAL=0]="NORMAL",z[z.LOW=-25]="LOW",z[z.UTILITY=-50]="UTILITY"}(O||(O={}));var M=function(){function z(X,J,et,pt){J===void 0&&(J=null),et===void 0&&(et=0),pt===void 0&&(pt=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=X,this.context=J,this.priority=et,this.once=pt}return z.prototype.match=function(X,J){return J===void 0&&(J=null),this.fn===X&&this.context===J},z.prototype.emit=function(X){this.fn&&(this.context?this.fn.call(this.context,X):this.fn(X));var J=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),J},z.prototype.connect=function(X){this.previous=X,X.next&&(X.next.previous=this),this.next=X.next,X.next=this},z.prototype.destroy=function(X){X===void 0&&(X=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var J=this.next;return this.next=X?null:J,this.previous=null,J},z}(),D=function(){function z(){var X=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new M(null,null,1/0),this.deltaMS=1/R.b.TARGET_FPMS,this.elapsedMS=1/R.b.TARGET_FPMS,this._tick=function(J){X._requestId=null,X.started&&(X.update(J),X.started&&X._requestId===null&&X._head.next&&(X._requestId=requestAnimationFrame(X._tick)))}}return z.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},z.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},z.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},z.prototype.add=function(X,J,et){return et===void 0&&(et=O.NORMAL),this._addListener(new M(X,J,et))},z.prototype.addOnce=function(X,J,et){return et===void 0&&(et=O.NORMAL),this._addListener(new M(X,J,et,!0))},z.prototype._addListener=function(X){var J=this._head.next,et=this._head;if(J){for(;J;){if(X.priority>J.priority){X.connect(et);break}et=J,J=J.next}X.previous||X.connect(et)}else X.connect(et);return this._startIfPossible(),this},z.prototype.remove=function(X,J){for(var et=this._head.next;et;)et=et.match(X,J)?et.destroy():et.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(z.prototype,"count",{get:function(){if(!this._head)return 0;for(var X=0,J=this._head;J=J.next;)X++;return X},enumerable:!1,configurable:!0}),z.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},z.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},z.prototype.destroy=function(){if(!this._protected){this.stop();for(var X=this._head.next;X;)X=X.destroy(!0);this._head.destroy(),this._head=null}},z.prototype.update=function(X){var J;if(X===void 0&&(X=performance.now()),X>this.lastTime){if((J=this.elapsedMS=X-this.lastTime)>this._maxElapsedMS&&(J=this._maxElapsedMS),J*=this.speed,this._minElapsedMS){var et=X-this._lastFrame|0;if(et<this._minElapsedMS)return;this._lastFrame=X-et%this._minElapsedMS}this.deltaMS=J,this.deltaTime=this.deltaMS*R.b.TARGET_FPMS;for(var pt=this._head,Nt=pt.next;Nt;)Nt=Nt.emit(this.deltaTime);pt.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=X},Object.defineProperty(z.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(X){var J=Math.min(this.maxFPS,X),et=Math.min(Math.max(0,J)/1e3,R.b.TARGET_FPMS);this._maxElapsedMS=1/et},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(X){if(X===0)this._minElapsedMS=0;else{var J=Math.max(this.minFPS,X);this._minElapsedMS=1/(J/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(z,"shared",{get:function(){if(!z._shared){var X=z._shared=new z;X.autoStart=!0,X._protected=!0}return z._shared},enumerable:!1,configurable:!0}),Object.defineProperty(z,"system",{get:function(){if(!z._system){var X=z._system=new z;X.autoStart=!0,X._protected=!0}return z._system},enumerable:!1,configurable:!0}),z}(),B=function(){function z(){}return z.init=function(X){var J=this;X=Object.assign({autoStart:!0,sharedTicker:!1},X),Object.defineProperty(this,"ticker",{set:function(et){this._ticker&&this._ticker.remove(this.render,this),this._ticker=et,et&&et.add(this.render,this,O.LOW)},get:function(){return this._ticker}}),this.stop=function(){J._ticker.stop()},this.start=function(){J._ticker.start()},this._ticker=null,this.ticker=X.sharedTicker?D.shared:new D,X.autoStart&&this.start()},z.destroy=function(){if(this._ticker){var X=this._ticker;this.ticker=null,X.destroy()}},z}()},function(b,S,v){v.d(S,"a",function(){return vt}),v.d(S,"b",function(){return I}),v.d(S,"c",function(){return L});var O=v(2),R=v(1),M=v(0),D=v(5),B=v(4),z=v(3),X=function(F,W){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,j){P.__proto__=j}||function(P,j){for(var Q in j)j.hasOwnProperty(Q)&&(P[Q]=j[Q])})(F,W)};function J(F,W){function P(){this.constructor=F}X(F,W),F.prototype=W===null?Object.create(W):(P.prototype=W.prototype,new P)}var et=function(){function F(W,P){this.uvBuffer=W,this.uvMatrix=P,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return F.prototype.update=function(W){if(W||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var P=this.uvBuffer.data;this.data&&this.data.length===P.length||(this.data=new Float32Array(P.length)),this.uvMatrix.multiplyUvs(P,this.data),this._updateID++}},F}(),pt=new R.g,Nt=new R.h,vt=function(F){function W(P,j,Q,H){H===void 0&&(H=M.f.TRIANGLES);var Ot=F.call(this)||this;return Ot.geometry=P,Ot.shader=j,Ot.state=Q||O.s.for2d(),Ot.drawMode=H,Ot.start=0,Ot.size=0,Ot.uvs=null,Ot.indices=null,Ot.vertexData=new Float32Array(1),Ot.vertexDirty=-1,Ot._transformID=-1,Ot._roundPixels=B.b.ROUND_PIXELS,Ot.batchUvs=null,Ot}return J(W,F),Object.defineProperty(W.prototype,"geometry",{get:function(){return this._geometry},set:function(P){this._geometry!==P&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=P,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"material",{get:function(){return this.shader},set:function(P){this.shader=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(P){this.state.blendMode=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(P){this._roundPixels!==P&&(this._transformID=-1),this._roundPixels=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(P){this.shader.tint=P},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(P){this.shader.texture=P},enumerable:!1,configurable:!0}),W.prototype._render=function(P){var j=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===M.f.TRIANGLES&&j.length<2*W.BATCHABLE_SIZE?this._renderToBatch(P):this._renderDefault(P)},W.prototype._renderDefault=function(P){var j=this.shader;j.alpha=this.worldAlpha,j.update&&j.update(),P.batch.flush(),j.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),P.shader.bind(j),P.state.set(this.state),P.geometry.bind(this.geometry,j),P.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},W.prototype._renderToBatch=function(P){var j=this.geometry,Q=this.shader;Q.uvMatrix&&(Q.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=j.indexBuffer.data,this._tintRGB=Q._tintRGB,this._texture=Q.texture;var H=this.material.pluginName;P.batch.setObjectRenderer(P.plugins[H]),P.plugins[H].render(this)},W.prototype.calculateVertices=function(){var P=this.geometry.buffers[0],j=P.data,Q=P._updateID;if(Q!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==j.length&&(this.vertexData=new Float32Array(j.length));for(var H=this.transform.worldTransform,Ot=H.a,Vt=H.b,st=H.c,V=H.d,k=H.tx,mt=H.ty,tt=this.vertexData,_t=0;_t<tt.length/2;_t++){var Dt=j[2*_t],Z=j[2*_t+1];tt[2*_t]=Ot*Dt+st*Z+k,tt[2*_t+1]=Vt*Dt+V*Z+mt}if(this._roundPixels){var ct=B.b.RESOLUTION;for(_t=0;_t<tt.length;++_t)tt[_t]=Math.round((tt[_t]*ct|0)/ct)}this.vertexDirty=Q}},W.prototype.calculateUvs=function(){var P=this.geometry.buffers[1],j=this.shader;j.uvMatrix.isSimple?this.uvs=P.data:(this.batchUvs||(this.batchUvs=new et(P,j.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},W.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},W.prototype.containsPoint=function(P){if(!this.getBounds().contains(P.x,P.y))return!1;this.worldTransform.applyInverse(P,pt);for(var j=this.geometry.getBuffer("aVertexPosition").data,Q=Nt.points,H=this.geometry.getIndex().data,Ot=H.length,Vt=this.drawMode===4?3:1,st=0;st+2<Ot;st+=Vt){var V=2*H[st],k=2*H[st+1],mt=2*H[st+2];if(Q[0]=j[V],Q[1]=j[V+1],Q[2]=j[k],Q[3]=j[k+1],Q[4]=j[mt],Q[5]=j[mt+1],Nt.contains(pt.x,pt.y))return!0}return!1},W.prototype.destroy=function(P){F.prototype.destroy.call(this,P),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},W.BATCHABLE_SIZE=100,W}(D.b),L=function(F){function W(P,j){var Q=this,H={uSampler:P,alpha:1,uTextureMatrix:R.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(j=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},j)).uniforms&&Object.assign(H,j.uniforms),(Q=F.call(this,j.program||O.n.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),H)||this)._colorDirty=!1,Q.uvMatrix=new O.u(P),Q.batchable=j.program===void 0,Q.pluginName=j.pluginName,Q.tint=j.tint,Q.alpha=j.alpha,Q}return J(W,F),Object.defineProperty(W.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(P){this.uniforms.uSampler!==P&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!P.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=P,this.uvMatrix.texture=P)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"alpha",{get:function(){return this._alpha},set:function(P){P!==this._alpha&&(this._alpha=P,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"tint",{get:function(){return this._tint},set:function(P){P!==this._tint&&(this._tint=P,this._tintRGB=(P>>16)+(65280&P)+((255&P)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),W.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var P=this.texture.baseTexture;Object(z.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,P.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},W}(O.r),I=function(F){function W(P,j,Q){var H=F.call(this)||this,Ot=new O.h(P),Vt=new O.h(j,!0),st=new O.h(Q,!0,!0);return H.addAttribute("aVertexPosition",Ot,2,!1,M.r.FLOAT).addAttribute("aTextureCoord",Vt,2,!1,M.r.FLOAT).addIndex(st),H._updateId=-1,H}return J(W,F),Object.defineProperty(W.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),W}(O.l)},function(b,S){b.exports=function(v){return v===void 0}},function(b,S){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,S,v){v.d(S,"a",function(){return Nt}),v.d(S,"b",function(){return vt});var O=v(2),R=v(3),M=v(1),D=v(0),B=v(4),z=function(I,F){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(W,P){W.__proto__=P}||function(W,P){for(var j in P)P.hasOwnProperty(j)&&(W[j]=P[j])})(I,F)},X=function(){function I(F){this._foundShapes=[],this.renderer=F}return I.prototype.pushMask=function(F){var W=this.renderer,P=F.maskObject||F;W.context.save();var j=this._foundShapes;if(this.recursiveFindShapes(P,j),j.length>0){var Q=W.context;Q.beginPath();for(var H=0;H<j.length;H++){var Ot=j[H],Vt=Ot.transform.worldTransform;this.renderer.setContextTransform(Vt),this.renderGraphicsShape(Ot)}j.length=0,Q.clip()}},I.prototype.recursiveFindShapes=function(F,W){F.geometry&&F.geometry.graphicsData&&W.push(F);var P=F.children;if(P)for(var j=0;j<P.length;j++)this.recursiveFindShapes(P[j],W)},I.prototype.renderGraphicsShape=function(F){F.finishPoly();var W=this.renderer.context,P=F.geometry.graphicsData,j=P.length;if(j!==0)for(var Q=0;Q<j;Q++){var H=P[Q],Ot=H.shape;if(Ot.type===M.l.POLY){var Vt=Ot.points,st=H.holes,V=void 0,k=void 0,mt=void 0,tt=void 0;W.moveTo(Vt[0],Vt[1]);for(var _t=1;_t<Vt.length/2;_t++)W.lineTo(Vt[2*_t],Vt[2*_t+1]);if(st.length>0){for(V=0,mt=Vt[0],tt=Vt[1],_t=2;_t+2<Vt.length;_t+=2)V+=(Vt[_t]-mt)*(Vt[_t+3]-tt)-(Vt[_t+2]-mt)*(Vt[_t+1]-tt);for(var Dt=0;Dt<st.length;Dt++)if(Vt=st[Dt].shape.points){for(k=0,mt=Vt[0],tt=Vt[1],_t=2;_t+2<Vt.length;_t+=2)k+=(Vt[_t]-mt)*(Vt[_t+3]-tt)-(Vt[_t+2]-mt)*(Vt[_t+1]-tt);if(k*V<0)for(W.moveTo(Vt[0],Vt[1]),_t=2;_t<Vt.length;_t+=2)W.lineTo(Vt[_t],Vt[_t+1]);else for(W.moveTo(Vt[Vt.length-2],Vt[Vt.length-1]),_t=Vt.length-4;_t>=0;_t-=2)W.lineTo(Vt[_t],Vt[_t+1]);st[Dt].shape.closeStroke&&W.closePath()}}Vt[0]===Vt[Vt.length-2]&&Vt[1]===Vt[Vt.length-1]&&W.closePath()}else if(Ot.type===M.l.RECT)W.rect(Ot.x,Ot.y,Ot.width,Ot.height),W.closePath();else if(Ot.type===M.l.CIRC)W.arc(Ot.x,Ot.y,Ot.radius,0,2*Math.PI),W.closePath();else if(Ot.type===M.l.ELIP){var Z=2*Ot.width,ct=2*Ot.height,rt=Ot.x-Z/2,yt=Ot.y-ct/2,At=Z/2*.5522848,Gt=ct/2*.5522848,Yt=rt+Z,Jt=yt+ct,at=rt+Z/2,_e=yt+ct/2;W.moveTo(rt,_e),W.bezierCurveTo(rt,_e-Gt,at-At,yt,at,yt),W.bezierCurveTo(at+At,yt,Yt,_e-Gt,Yt,_e),W.bezierCurveTo(Yt,_e+Gt,at+At,Jt,at,Jt),W.bezierCurveTo(at-At,Jt,rt,_e+Gt,rt,_e),W.closePath()}else if(Ot.type===M.l.RREC){var ke=Ot.x,Le=Ot.y,Ae=Ot.width,ze=Ot.height,Qe=Ot.radius,cn=Math.min(Ae,ze)/2;Qe=Qe>cn?cn:Qe,W.moveTo(ke,Le+Qe),W.lineTo(ke,Le+ze-Qe),W.quadraticCurveTo(ke,Le+ze,ke+Qe,Le+ze),W.lineTo(ke+Ae-Qe,Le+ze),W.quadraticCurveTo(ke+Ae,Le+ze,ke+Ae,Le+ze-Qe),W.lineTo(ke+Ae,Le+Qe),W.quadraticCurveTo(ke+Ae,Le,ke+Ae-Qe,Le),W.lineTo(ke+Qe,Le),W.quadraticCurveTo(ke,Le,ke,Le+Qe),W.closePath()}}},I.prototype.popMask=function(F){F.context.restore(),F.invalidateBlendMode()},I.prototype.destroy=function(){},I}();function J(I){var F=document.createElement("canvas");F.width=6,F.height=1;var W=F.getContext("2d");return W.fillStyle=I,W.fillRect(0,0,6,1),F}function et(){if(typeof document=="undefined")return!1;var I=J("#ff00ff"),F=J("#ffff00"),W=document.createElement("canvas");W.width=6,W.height=1;var P=W.getContext("2d");P.globalCompositeOperation="multiply",P.drawImage(I,0,0),P.drawImage(F,2,0);var j=P.getImageData(2,0,1,1);if(!j)return!1;var Q=j.data;return Q[0]===255&&Q[1]===0&&Q[2]===0}var pt=new M.d,Nt=function(I){function F(W){var P,j=I.call(this,D.n.CANVAS,W)||this;if(j.refresh=!0,j.maskManager=new X(j),j.smoothProperty="imageSmoothingEnabled",j.blendModes=(P===void 0&&(P=[]),et()?(P[D.b.NORMAL]="source-over",P[D.b.ADD]="lighter",P[D.b.MULTIPLY]="multiply",P[D.b.SCREEN]="screen",P[D.b.OVERLAY]="overlay",P[D.b.DARKEN]="darken",P[D.b.LIGHTEN]="lighten",P[D.b.COLOR_DODGE]="color-dodge",P[D.b.COLOR_BURN]="color-burn",P[D.b.HARD_LIGHT]="hard-light",P[D.b.SOFT_LIGHT]="soft-light",P[D.b.DIFFERENCE]="difference",P[D.b.EXCLUSION]="exclusion",P[D.b.HUE]="hue",P[D.b.SATURATION]="saturate",P[D.b.COLOR]="color",P[D.b.LUMINOSITY]="luminosity"):(P[D.b.NORMAL]="source-over",P[D.b.ADD]="lighter",P[D.b.MULTIPLY]="source-over",P[D.b.SCREEN]="source-over",P[D.b.OVERLAY]="source-over",P[D.b.DARKEN]="source-over",P[D.b.LIGHTEN]="source-over",P[D.b.COLOR_DODGE]="source-over",P[D.b.COLOR_BURN]="source-over",P[D.b.HARD_LIGHT]="source-over",P[D.b.SOFT_LIGHT]="source-over",P[D.b.DIFFERENCE]="source-over",P[D.b.EXCLUSION]="source-over",P[D.b.HUE]="source-over",P[D.b.SATURATION]="source-over",P[D.b.COLOR]="source-over",P[D.b.LUMINOSITY]="source-over"),P[D.b.NORMAL_NPM]=P[D.b.NORMAL],P[D.b.ADD_NPM]=P[D.b.ADD],P[D.b.SCREEN_NPM]=P[D.b.SCREEN],P[D.b.SRC_IN]="source-in",P[D.b.SRC_OUT]="source-out",P[D.b.SRC_ATOP]="source-atop",P[D.b.DST_OVER]="destination-over",P[D.b.DST_IN]="destination-in",P[D.b.DST_OUT]="destination-out",P[D.b.DST_ATOP]="destination-atop",P[D.b.XOR]="xor",P[D.b.SUBTRACT]="source-over",P),j.renderingToScreen=!1,j._activeBlendMode=null,j._projTransform=null,j._outerBlend=!1,j.rootContext=j.view.getContext("2d",{alpha:j.useContextAlpha}),j.context=j.rootContext,!j.rootContext.imageSmoothingEnabled){var Q=j.rootContext;Q.webkitImageSmoothingEnabled?j.smoothProperty="webkitImageSmoothingEnabled":Q.mozImageSmoothingEnabled?j.smoothProperty="mozImageSmoothingEnabled":Q.oImageSmoothingEnabled?j.smoothProperty="oImageSmoothingEnabled":Q.msImageSmoothingEnabled&&(j.smoothProperty="msImageSmoothingEnabled")}return j.initPlugins(F.__plugins),Object(R.sayHello)("Canvas"),j.resize(j.options.width,j.options.height),j}return function(W,P){function j(){this.constructor=W}z(W,P),W.prototype=P===null?Object.create(P):(j.prototype=P.prototype,new j)}(F,I),F.prototype.addSystem=function(){return this},F.prototype.render=function(W,P){if(this.view){var j,Q,H,Ot;P&&(P instanceof O.p||P instanceof O.b?(Object(R.deprecation)("6.0.0","CanvasRenderer#render arguments changed, use options instead."),j=P,Q=arguments[2],H=arguments[3],Ot=arguments[4]):(j=P.renderTexture,Q=P.clear,H=P.transform,Ot=P.skipUpdateTransform)),this.renderingToScreen=!j,this.emit("prerender");var Vt=this.resolution;j?((j=j.castToBaseTexture())._canvasRenderTarget||(j._canvasRenderTarget=new R.CanvasRenderTarget(j.width,j.height,j.resolution),j.resource=new O.j(j._canvasRenderTarget.canvas),j.valid=!0),this.context=j._canvasRenderTarget.context,this.resolution=j._canvasRenderTarget.resolution):this.context=this.rootContext;var st=this.context;if(this._projTransform=H||null,j||(this._lastObjectRendered=W),!Ot){var V=W.enableTempParent();W.updateTransform(),W.disableTempParent(V)}if(st.save(),st.setTransform(1,0,0,1,0,0),st.globalAlpha=1,this._activeBlendMode=D.b.NORMAL,this._outerBlend=!1,st.globalCompositeOperation=this.blendModes[D.b.NORMAL],Q!==void 0?Q:this.clearBeforeRender)if(this.renderingToScreen)st.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(st.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,st.fillStyle=this._backgroundColorString,st.fillRect(0,0,this.width,this.height),st.globalAlpha=1);else{(j=j)._canvasRenderTarget.clear();var k=j.clearColor;k[3]>0&&(st.globalAlpha=this.useContextAlpha?k[3]:1,st.fillStyle=Object(R.hex2string)(Object(R.rgb2hex)(k)),st.fillRect(0,0,j.realWidth,j.realHeight),st.globalAlpha=1)}var mt=this.context;this.context=st,W.renderCanvas(this),this.context=mt,st.restore(),this.resolution=Vt,this._projTransform=null,this.emit("postrender")}},F.prototype.setContextTransform=function(W,P,j){var Q=W,H=this._projTransform,Ot=this.resolution;j=j||Ot,H&&((Q=pt).copyFrom(W),Q.prepend(H)),P?this.context.setTransform(Q.a*j,Q.b*j,Q.c*j,Q.d*j,Q.tx*Ot|0,Q.ty*Ot|0):this.context.setTransform(Q.a*j,Q.b*j,Q.c*j,Q.d*j,Q.tx*Ot,Q.ty*Ot)},F.prototype.clear=function(W,P){W===void 0&&(W=this._backgroundColorString),P===void 0&&(P=this.backgroundAlpha);var j=this.context;j.clearRect(0,0,this.width,this.height),W&&(j.globalAlpha=this.useContextAlpha?P:1,j.fillStyle=W,j.fillRect(0,0,this.width,this.height),j.globalAlpha=1)},F.prototype.setBlendMode=function(W,P){var j=W===D.b.SRC_IN||W===D.b.SRC_OUT||W===D.b.DST_IN||W===D.b.DST_ATOP;!P&&j&&(W=D.b.NORMAL),this._activeBlendMode!==W&&(this._activeBlendMode=W,this._outerBlend=j,this.context.globalCompositeOperation=this.blendModes[W])},F.prototype.destroy=function(W){I.prototype.destroy.call(this,W),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},F.prototype.resize=function(W,P){I.prototype.resize.call(this,W,P),this.smoothProperty&&(this.rootContext[this.smoothProperty]=B.b.SCALE_MODE===D.p.LINEAR)},F.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},F.registerPlugin=function(W,P){F.__plugins=F.__plugins||{},F.__plugins[W]=P},F}(O.a),vt={canvas:null,getTintedCanvas:function(I,F){var W=I.texture,P="#"+("00000"+(0|(F=vt.roundColor(F))).toString(16)).slice(-6);W.tintCache=W.tintCache||{};var j,Q=W.tintCache[P];if(Q){if(Q.tintId===W._updateID)return W.tintCache[P];j=W.tintCache[P]}else j=document.createElement("canvas");if(vt.tintMethod(W,F,j),j.tintId=W._updateID,vt.convertTintToImage){var H=new Image;H.src=j.toDataURL(),W.tintCache[P]=H}else W.tintCache[P]=j;return j},getTintedPattern:function(I,F){var W="#"+("00000"+(0|(F=vt.roundColor(F))).toString(16)).slice(-6);I.patternCache=I.patternCache||{};var P=I.patternCache[W];return P&&P.tintId===I._updateID||(vt.canvas||(vt.canvas=document.createElement("canvas")),vt.tintMethod(I,F,vt.canvas),(P=vt.canvas.getContext("2d").createPattern(vt.canvas,"repeat")).tintId=I._updateID,I.patternCache[W]=P),P},tintWithMultiply:function(I,F,W){var P=W.getContext("2d"),j=I._frame.clone(),Q=I.baseTexture.resolution;j.x*=Q,j.y*=Q,j.width*=Q,j.height*=Q,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.fillStyle="#"+("00000"+(0|F).toString(16)).slice(-6),P.fillRect(0,0,j.width,j.height),P.globalCompositeOperation="multiply";var H=I.baseTexture.getDrawableSource();P.drawImage(H,j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.globalCompositeOperation="destination-atop",P.drawImage(H,j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore()},tintWithOverlay:function(I,F,W){var P=W.getContext("2d"),j=I._frame.clone(),Q=I.baseTexture.resolution;j.x*=Q,j.y*=Q,j.width*=Q,j.height*=Q,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.globalCompositeOperation="copy",P.fillStyle="#"+("00000"+(0|F).toString(16)).slice(-6),P.fillRect(0,0,j.width,j.height),P.globalCompositeOperation="destination-atop",P.drawImage(I.baseTexture.getDrawableSource(),j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore()},tintWithPerPixel:function(I,F,W){var P=W.getContext("2d"),j=I._frame.clone(),Q=I.baseTexture.resolution;j.x*=Q,j.y*=Q,j.width*=Q,j.height*=Q,W.width=Math.ceil(j.width),W.height=Math.ceil(j.height),P.save(),P.globalCompositeOperation="copy",P.drawImage(I.baseTexture.getDrawableSource(),j.x,j.y,j.width,j.height,0,0,j.width,j.height),P.restore();for(var H=Object(R.hex2rgb)(F),Ot=H[0],Vt=H[1],st=H[2],V=P.getImageData(0,0,j.width,j.height),k=V.data,mt=0;mt<k.length;mt+=4)k[mt+0]*=Ot,k[mt+1]*=Vt,k[mt+2]*=st;P.putImageData(V,0,0)},roundColor:function(I){var F=vt.cacheStepsPerColorChannel,W=Object(R.hex2rgb)(I);return W[0]=Math.min(255,W[0]/F*F),W[1]=Math.min(255,W[1]/F*F),W[2]=Math.min(255,W[2]/F*F),Object(R.rgb2hex)(W)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:et(),tintMethod:null};vt.tintMethod=vt.canUseMultiply?vt.tintWithMultiply:vt.tintWithPerPixel;var L=O.q.create;O.q.create=function(I){if(!(I&&I.forceCanvas))try{return L(I)}catch{}return new Nt(I)},O.c.prototype.getDrawableSource=function(){var I=this.resource;return I?I.bitmap||I.source:null},O.b.prototype._canvasRenderTarget=null,O.t.prototype.patternCache=null,O.t.prototype.tintCache=null},function(b,S,v){v.d(S,"a",function(){return O});/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var O=function(){function R(M){this.items=[],this._name=M,this._aliasCount=0}return R.prototype.emit=function(M,D,B,z,X,J,et,pt){if(arguments.length>8)throw new Error("max arguments reached");var Nt=this,vt=Nt.name,L=Nt.items;this._aliasCount++;for(var I=0,F=L.length;I<F;I++)L[I][vt](M,D,B,z,X,J,et,pt);return L===this.items&&this._aliasCount--,this},R.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},R.prototype.add=function(M){return M[this._name]&&(this.ensureNonAliasedItems(),this.remove(M),this.items.push(M)),this},R.prototype.remove=function(M){var D=this.items.indexOf(M);return D!==-1&&(this.ensureNonAliasedItems(),this.items.splice(D,1)),this},R.prototype.contains=function(M){return this.items.indexOf(M)!==-1},R.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},R.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(R.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),R}();Object.defineProperties(O.prototype,{dispatch:{value:O.prototype.emit},run:{value:O.prototype.emit}})},function(b,S,v){var O=v(20),R=v(15);b.exports=function(M){return typeof M=="number"||R(M)&&O(M)=="[object Number]"}},function(b,S,v){var O=v(51),R=typeof self=="object"&&self&&self.Object===Object&&self,M=O||R||Function("return this")();b.exports=M},function(b,S){b.exports=function(v){return v!=null&&typeof v=="object"}},function(b,S,v){v.d(S,"a",function(){return Nt}),v.d(S,"b",function(){return pt}),v.d(S,"c",function(){return J});var O=v(8),R=v(0),M=v(2),D=function(vt,L){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var W in F)F.hasOwnProperty(W)&&(I[W]=F[W])})(vt,L)};function B(vt,L){function I(){this.constructor=vt}D(vt,L),vt.prototype=L===null?Object.create(L):(I.prototype=L.prototype,new I)}var z=function(vt){function L(I,F,W,P){I===void 0&&(I=100),F===void 0&&(F=100),W===void 0&&(W=10),P===void 0&&(P=10);var j=vt.call(this)||this;return j.segWidth=W,j.segHeight=P,j.width=I,j.height=F,j.build(),j}return B(L,vt),L.prototype.build=function(){for(var I=this.segWidth*this.segHeight,F=[],W=[],P=[],j=this.segWidth-1,Q=this.segHeight-1,H=this.width/j,Ot=this.height/Q,Vt=0;Vt<I;Vt++){var st=Vt%this.segWidth,V=Vt/this.segWidth|0;F.push(st*H,V*Ot),W.push(st/j,V/Q)}var k=j*Q;for(Vt=0;Vt<k;Vt++){var mt=Vt%j,tt=Vt/j|0,_t=tt*this.segWidth+mt,Dt=tt*this.segWidth+mt+1,Z=(tt+1)*this.segWidth+mt,ct=(tt+1)*this.segWidth+mt+1;P.push(_t,Dt,Z,Dt,ct,Z)}this.buffers[0].data=new Float32Array(F),this.buffers[1].data=new Float32Array(W),this.indexBuffer.data=new Uint16Array(P),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},L}(O.b),X=function(vt){function L(I,F,W){I===void 0&&(I=200),W===void 0&&(W=0);var P=vt.call(this,new Float32Array(4*F.length),new Float32Array(4*F.length),new Uint16Array(6*(F.length-1)))||this;return P.points=F,P._width=I,P.textureScale=W,P.build(),P}return B(L,vt),Object.defineProperty(L.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),L.prototype.build=function(){var I=this.points;if(I){var F=this.getBuffer("aVertexPosition"),W=this.getBuffer("aTextureCoord"),P=this.getIndex();if(!(I.length<1)){F.data.length/4!==I.length&&(F.data=new Float32Array(4*I.length),W.data=new Float32Array(4*I.length),P.data=new Uint16Array(6*(I.length-1)));var j=W.data,Q=P.data;j[0]=0,j[1]=0,j[2]=0,j[3]=1;for(var H=0,Ot=I[0],Vt=this._width*this.textureScale,st=I.length,V=0;V<st;V++){var k=4*V;if(this.textureScale>0){var mt=Ot.x-I[V].x,tt=Ot.y-I[V].y,_t=Math.sqrt(mt*mt+tt*tt);Ot=I[V],H+=_t/Vt}else H=V/(st-1);j[k]=H,j[k+1]=0,j[k+2]=H,j[k+3]=1}var Dt=0;for(V=0;V<st-1;V++)k=2*V,Q[Dt++]=k,Q[Dt++]=k+1,Q[Dt++]=k+2,Q[Dt++]=k+2,Q[Dt++]=k+1,Q[Dt++]=k+3;W.update(),P.update(),this.updateVertices()}}},L.prototype.updateVertices=function(){var I=this.points;if(!(I.length<1)){for(var F,W=I[0],P=0,j=0,Q=this.buffers[0].data,H=I.length,Ot=0;Ot<H;Ot++){var Vt=I[Ot],st=4*Ot;j=-((F=Ot<I.length-1?I[Ot+1]:Vt).x-W.x),P=F.y-W.y;var V=Math.sqrt(P*P+j*j),k=this.textureScale>0?this.textureScale*this._width/2:this._width/2;P/=V,j/=V,P*=k,j*=k,Q[st]=Vt.x+P,Q[st+1]=Vt.y+j,Q[st+2]=Vt.x-P,Q[st+3]=Vt.y-j,W=Vt}this.buffers[0].update()}},L.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},L}(O.b),J=function(vt){function L(I,F,W){W===void 0&&(W=0);var P=this,j=new X(I.height,F,W),Q=new O.c(I);return W>0&&(I.baseTexture.wrapMode=R.s.REPEAT),(P=vt.call(this,j,Q)||this).autoUpdate=!0,P}return B(L,vt),L.prototype._render=function(I){var F=this.geometry;(this.autoUpdate||F._width!==this.shader.texture.height)&&(F._width=this.shader.texture.height,F.update()),vt.prototype._render.call(this,I)},L}(O.a),et=function(vt){function L(I,F,W){var P=this,j=new z(I.width,I.height,F,W),Q=new O.c(M.t.WHITE);return(P=vt.call(this,j,Q)||this).texture=I,P.autoResize=!0,P}return B(L,vt),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var I=this.geometry,F=this.shader.texture,W=F.width,P=F.height;!this.autoResize||I.width===W&&I.height===P||(I.width=this.shader.texture.width,I.height=this.shader.texture.height,I.build())},Object.defineProperty(L.prototype,"texture",{get:function(){return this.shader.texture},set:function(I){this.shader.texture!==I&&(this.shader.texture=I,this._textureID=-1,I.baseTexture.valid?this.textureUpdated():I.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),L.prototype._render=function(I){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),vt.prototype._render.call(this,I)},L.prototype.destroy=function(I){this.shader.texture.off("update",this.textureUpdated,this),vt.prototype.destroy.call(this,I)},L}(O.a),pt=function(vt){function L(I,F,W,P,j){I===void 0&&(I=M.t.EMPTY);var Q=this,H=new O.b(F,W,P);H.getBuffer("aVertexPosition").static=!1;var Ot=new O.c(I);return(Q=vt.call(this,H,Ot,null,j)||this).autoUpdate=!0,Q}return B(L,vt),Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(I){this.geometry.getBuffer("aVertexPosition").data=I},enumerable:!1,configurable:!0}),L.prototype._render=function(I){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),vt.prototype._render.call(this,I)},L}(O.a),Nt=function(vt){function L(I,F,W,P,j){F===void 0&&(F=10),W===void 0&&(W=10),P===void 0&&(P=10),j===void 0&&(j=10);var Q=vt.call(this,M.t.WHITE,4,4)||this;return Q._origWidth=I.orig.width,Q._origHeight=I.orig.height,Q._width=Q._origWidth,Q._height=Q._origHeight,Q._leftWidth=F,Q._rightWidth=P,Q._topHeight=W,Q._bottomHeight=j,Q.texture=I,Q}return B(L,vt),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(I){this.geometry.getBuffer("aVertexPosition").data=I},enumerable:!1,configurable:!0}),L.prototype.updateHorizontalVertices=function(){var I=this.vertices,F=this._getMinScale();I[9]=I[11]=I[13]=I[15]=this._topHeight*F,I[17]=I[19]=I[21]=I[23]=this._height-this._bottomHeight*F,I[25]=I[27]=I[29]=I[31]=this._height},L.prototype.updateVerticalVertices=function(){var I=this.vertices,F=this._getMinScale();I[2]=I[10]=I[18]=I[26]=this._leftWidth*F,I[4]=I[12]=I[20]=I[28]=this._width-this._rightWidth*F,I[6]=I[14]=I[22]=I[30]=this._width},L.prototype._getMinScale=function(){var I=this._leftWidth+this._rightWidth,F=this._width>I?1:this._width/I,W=this._topHeight+this._bottomHeight,P=this._height>W?1:this._height/W;return Math.min(F,P)},Object.defineProperty(L.prototype,"width",{get:function(){return this._width},set:function(I){this._width=I,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"height",{get:function(){return this._height},set:function(I){this._height=I,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(I){this._leftWidth=I,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(I){this._rightWidth=I,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"topHeight",{get:function(){return this._topHeight},set:function(I){this._topHeight=I,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(I){this._bottomHeight=I,this._refresh()},enumerable:!1,configurable:!0}),L.prototype._refresh=function(){var I=this.texture,F=this.geometry.buffers[1].data;this._origWidth=I.orig.width,this._origHeight=I.orig.height;var W=1/this._origWidth,P=1/this._origHeight;F[0]=F[8]=F[16]=F[24]=0,F[1]=F[3]=F[5]=F[7]=0,F[6]=F[14]=F[22]=F[30]=1,F[25]=F[27]=F[29]=F[31]=1,F[2]=F[10]=F[18]=F[26]=W*this._leftWidth,F[4]=F[12]=F[20]=F[28]=1-W*this._rightWidth,F[9]=F[11]=F[13]=F[15]=P*this._topHeight,F[17]=F[19]=F[21]=F[23]=1-P*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},L}(et)},function(b,S){var v;v=function(){return this}();try{v=v||new Function("return this")()}catch{typeof window=="object"&&(v=window)}b.exports=v},function(b,S,v){var O;(function(R){function M(P,j){var Q=(65535&P)+(65535&j);return(P>>16)+(j>>16)+(Q>>16)<<16|65535&Q}function D(P,j,Q,H,Ot,Vt){return M((st=M(M(j,P),M(H,Vt)))<<(V=Ot)|st>>>32-V,Q);var st,V}function B(P,j,Q,H,Ot,Vt,st){return D(j&Q|~j&H,P,j,Ot,Vt,st)}function z(P,j,Q,H,Ot,Vt,st){return D(j&H|Q&~H,P,j,Ot,Vt,st)}function X(P,j,Q,H,Ot,Vt,st){return D(j^Q^H,P,j,Ot,Vt,st)}function J(P,j,Q,H,Ot,Vt,st){return D(Q^(j|~H),P,j,Ot,Vt,st)}function et(P,j){var Q,H,Ot,Vt,st;P[j>>5]|=128<<j%32,P[14+(j+64>>>9<<4)]=j;var V=1732584193,k=-271733879,mt=-1732584194,tt=271733878;for(Q=0;Q<P.length;Q+=16)H=V,Ot=k,Vt=mt,st=tt,V=B(V,k,mt,tt,P[Q],7,-680876936),tt=B(tt,V,k,mt,P[Q+1],12,-389564586),mt=B(mt,tt,V,k,P[Q+2],17,606105819),k=B(k,mt,tt,V,P[Q+3],22,-1044525330),V=B(V,k,mt,tt,P[Q+4],7,-176418897),tt=B(tt,V,k,mt,P[Q+5],12,1200080426),mt=B(mt,tt,V,k,P[Q+6],17,-1473231341),k=B(k,mt,tt,V,P[Q+7],22,-45705983),V=B(V,k,mt,tt,P[Q+8],7,1770035416),tt=B(tt,V,k,mt,P[Q+9],12,-1958414417),mt=B(mt,tt,V,k,P[Q+10],17,-42063),k=B(k,mt,tt,V,P[Q+11],22,-1990404162),V=B(V,k,mt,tt,P[Q+12],7,1804603682),tt=B(tt,V,k,mt,P[Q+13],12,-40341101),mt=B(mt,tt,V,k,P[Q+14],17,-1502002290),V=z(V,k=B(k,mt,tt,V,P[Q+15],22,1236535329),mt,tt,P[Q+1],5,-165796510),tt=z(tt,V,k,mt,P[Q+6],9,-1069501632),mt=z(mt,tt,V,k,P[Q+11],14,643717713),k=z(k,mt,tt,V,P[Q],20,-373897302),V=z(V,k,mt,tt,P[Q+5],5,-701558691),tt=z(tt,V,k,mt,P[Q+10],9,38016083),mt=z(mt,tt,V,k,P[Q+15],14,-660478335),k=z(k,mt,tt,V,P[Q+4],20,-405537848),V=z(V,k,mt,tt,P[Q+9],5,568446438),tt=z(tt,V,k,mt,P[Q+14],9,-1019803690),mt=z(mt,tt,V,k,P[Q+3],14,-187363961),k=z(k,mt,tt,V,P[Q+8],20,1163531501),V=z(V,k,mt,tt,P[Q+13],5,-1444681467),tt=z(tt,V,k,mt,P[Q+2],9,-51403784),mt=z(mt,tt,V,k,P[Q+7],14,1735328473),V=X(V,k=z(k,mt,tt,V,P[Q+12],20,-1926607734),mt,tt,P[Q+5],4,-378558),tt=X(tt,V,k,mt,P[Q+8],11,-2022574463),mt=X(mt,tt,V,k,P[Q+11],16,1839030562),k=X(k,mt,tt,V,P[Q+14],23,-35309556),V=X(V,k,mt,tt,P[Q+1],4,-1530992060),tt=X(tt,V,k,mt,P[Q+4],11,1272893353),mt=X(mt,tt,V,k,P[Q+7],16,-155497632),k=X(k,mt,tt,V,P[Q+10],23,-1094730640),V=X(V,k,mt,tt,P[Q+13],4,681279174),tt=X(tt,V,k,mt,P[Q],11,-358537222),mt=X(mt,tt,V,k,P[Q+3],16,-722521979),k=X(k,mt,tt,V,P[Q+6],23,76029189),V=X(V,k,mt,tt,P[Q+9],4,-640364487),tt=X(tt,V,k,mt,P[Q+12],11,-421815835),mt=X(mt,tt,V,k,P[Q+15],16,530742520),V=J(V,k=X(k,mt,tt,V,P[Q+2],23,-995338651),mt,tt,P[Q],6,-198630844),tt=J(tt,V,k,mt,P[Q+7],10,1126891415),mt=J(mt,tt,V,k,P[Q+14],15,-1416354905),k=J(k,mt,tt,V,P[Q+5],21,-57434055),V=J(V,k,mt,tt,P[Q+12],6,1700485571),tt=J(tt,V,k,mt,P[Q+3],10,-1894986606),mt=J(mt,tt,V,k,P[Q+10],15,-1051523),k=J(k,mt,tt,V,P[Q+1],21,-2054922799),V=J(V,k,mt,tt,P[Q+8],6,1873313359),tt=J(tt,V,k,mt,P[Q+15],10,-30611744),mt=J(mt,tt,V,k,P[Q+6],15,-1560198380),k=J(k,mt,tt,V,P[Q+13],21,1309151649),V=J(V,k,mt,tt,P[Q+4],6,-145523070),tt=J(tt,V,k,mt,P[Q+11],10,-1120210379),mt=J(mt,tt,V,k,P[Q+2],15,718787259),k=J(k,mt,tt,V,P[Q+9],21,-343485551),V=M(V,H),k=M(k,Ot),mt=M(mt,Vt),tt=M(tt,st);return[V,k,mt,tt]}function pt(P){var j,Q="",H=32*P.length;for(j=0;j<H;j+=8)Q+=String.fromCharCode(P[j>>5]>>>j%32&255);return Q}function Nt(P){var j,Q=[];for(Q[(P.length>>2)-1]=void 0,j=0;j<Q.length;j+=1)Q[j]=0;var H=8*P.length;for(j=0;j<H;j+=8)Q[j>>5]|=(255&P.charCodeAt(j/8))<<j%32;return Q}function vt(P){var j,Q,H="";for(Q=0;Q<P.length;Q+=1)j=P.charCodeAt(Q),H+="0123456789abcdef".charAt(j>>>4&15)+"0123456789abcdef".charAt(15&j);return H}function L(P){return unescape(encodeURIComponent(P))}function I(P){return function(j){return pt(et(Nt(j),8*j.length))}(L(P))}function F(P,j){return function(Q,H){var Ot,Vt,st=Nt(Q),V=[],k=[];for(V[15]=k[15]=void 0,st.length>16&&(st=et(st,8*Q.length)),Ot=0;Ot<16;Ot+=1)V[Ot]=909522486^st[Ot],k[Ot]=1549556828^st[Ot];return Vt=et(V.concat(Nt(H)),512+8*H.length),pt(et(k.concat(Vt),640))}(L(P),L(j))}function W(P,j,Q){return j?Q?F(j,P):vt(F(j,P)):Q?I(P):vt(I(P))}(O=function(){return W}.call(S,v,S,b))===void 0||(b.exports=O)})()},function(b,S){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,S,v){var O=v(25),R=v(137),M=v(138),D=O?O.toStringTag:void 0;b.exports=function(B){return B==null?B===void 0?"[object Undefined]":"[object Null]":D&&D in Object(B)?R(B):M(B)}},function(b,S){b.exports=function(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}},function(b,S,v){var O=v(162),R=v(165);b.exports=function(M,D){var B=R(M,D);return O(B)?B:void 0}},function(b,S,v){(function(O){b.exports=function R(M,D,B){function z(et,pt){if(!D[et]){if(!M[et]){if(X)return X(et,!0);var Nt=new Error("Cannot find module '"+et+"'");throw Nt.code="MODULE_NOT_FOUND",Nt}var vt=D[et]={exports:{}};M[et][0].call(vt.exports,function(L){var I=M[et][1][L];return z(I||L)},vt,vt.exports,R,M,D,B)}return D[et].exports}for(var X=!1,J=0;J<B.length;J++)z(B[J]);return z}({1:[function(R,M,D){(function(B){var z,X,J=B.MutationObserver||B.WebKitMutationObserver;if(J){var et=0,pt=new J(I),Nt=B.document.createTextNode("");pt.observe(Nt,{characterData:!0}),z=function(){Nt.data=et=++et%2}}else if(B.setImmediate||B.MessageChannel===void 0)z="document"in B&&"onreadystatechange"in B.document.createElement("script")?function(){var F=B.document.createElement("script");F.onreadystatechange=function(){I(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},B.document.documentElement.appendChild(F)}:function(){setTimeout(I,0)};else{var vt=new B.MessageChannel;vt.port1.onmessage=I,z=function(){vt.port2.postMessage(0)}}var L=[];function I(){var F,W;X=!0;for(var P=L.length;P;){for(W=L,L=[],F=-1;++F<P;)W[F]();P=L.length}X=!1}M.exports=function(F){L.push(F)!==1||X||z()}}).call(this,O!==void 0?O:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(R,M,D){var B=R(1);function z(){}var X={},J=["REJECTED"],et=["FULFILLED"],pt=["PENDING"];function Nt(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=pt,this.queue=[],this.outcome=void 0,P!==z&&F(this,P)}function vt(P,j,Q){this.promise=P,typeof j=="function"&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),typeof Q=="function"&&(this.onRejected=Q,this.callRejected=this.otherCallRejected)}function L(P,j,Q){B(function(){var H;try{H=j(Q)}catch(Ot){return X.reject(P,Ot)}H===P?X.reject(P,new TypeError("Cannot resolve promise with itself")):X.resolve(P,H)})}function I(P){var j=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof j=="function")return function(){j.apply(P,arguments)}}function F(P,j){var Q=!1;function H(st){Q||(Q=!0,X.reject(P,st))}function Ot(st){Q||(Q=!0,X.resolve(P,st))}var Vt=W(function(){j(Ot,H)});Vt.status==="error"&&H(Vt.value)}function W(P,j){var Q={};try{Q.value=P(j),Q.status="success"}catch(H){Q.status="error",Q.value=H}return Q}M.exports=Nt,Nt.prototype.catch=function(P){return this.then(null,P)},Nt.prototype.then=function(P,j){if(typeof P!="function"&&this.state===et||typeof j!="function"&&this.state===J)return this;var Q=new this.constructor(z);return this.state!==pt?L(Q,this.state===et?P:j,this.outcome):this.queue.push(new vt(Q,P,j)),Q},vt.prototype.callFulfilled=function(P){X.resolve(this.promise,P)},vt.prototype.otherCallFulfilled=function(P){L(this.promise,this.onFulfilled,P)},vt.prototype.callRejected=function(P){X.reject(this.promise,P)},vt.prototype.otherCallRejected=function(P){L(this.promise,this.onRejected,P)},X.resolve=function(P,j){var Q=W(I,j);if(Q.status==="error")return X.reject(P,Q.value);var H=Q.value;if(H)F(P,H);else{P.state=et,P.outcome=j;for(var Ot=-1,Vt=P.queue.length;++Ot<Vt;)P.queue[Ot].callFulfilled(j)}return P},X.reject=function(P,j){P.state=J,P.outcome=j;for(var Q=-1,H=P.queue.length;++Q<H;)P.queue[Q].callRejected(j);return P},Nt.resolve=function(P){return P instanceof this?P:X.resolve(new this(z),P)},Nt.reject=function(P){var j=new this(z);return X.reject(j,P)},Nt.all=function(P){var j=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Q=P.length,H=!1;if(!Q)return this.resolve([]);for(var Ot=new Array(Q),Vt=0,st=-1,V=new this(z);++st<Q;)k(P[st],st);return V;function k(mt,tt){j.resolve(mt).then(function(_t){Ot[tt]=_t,++Vt!==Q||H||(H=!0,X.resolve(V,Ot))},function(_t){H||(H=!0,X.reject(V,_t))})}},Nt.race=function(P){var j=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Q=P.length,H=!1;if(!Q)return this.resolve([]);for(var Ot,Vt=-1,st=new this(z);++Vt<Q;)Ot=P[Vt],j.resolve(Ot).then(function(V){H||(H=!0,X.resolve(st,V))},function(V){H||(H=!0,X.reject(st,V))});return st}},{1:1}],3:[function(R,M,D){(function(B){typeof B.Promise!="function"&&(B.Promise=R(2))}).call(this,O!==void 0?O:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(R,M,D){var B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(xt){return typeof xt}:function(xt){return xt&&typeof Symbol=="function"&&xt.constructor===Symbol&&xt!==Symbol.prototype?"symbol":typeof xt},z=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function X(xt,St){xt=xt||[],St=St||{};try{return new Blob(xt,St)}catch(Wt){if(Wt.name!=="TypeError")throw Wt;for(var Rt=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Qt=0;Qt<xt.length;Qt+=1)Rt.append(xt[Qt]);return Rt.getBlob(St.type)}}typeof Promise=="undefined"&&R(3);var J=Promise;function et(xt,St){St&&xt.then(function(Rt){St(null,Rt)},function(Rt){St(Rt)})}function pt(xt,St,Rt){typeof St=="function"&&xt.then(St),typeof Rt=="function"&&xt.catch(Rt)}function Nt(xt){return typeof xt!="string"&&(console.warn(xt+" used as a key, but it is not a string."),xt=String(xt)),xt}function vt(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L=void 0,I={},F=Object.prototype.toString;function W(xt){return typeof L=="boolean"?J.resolve(L):function(St){return new J(function(Rt){var Qt=St.transaction("local-forage-detect-blob-support","readwrite"),Wt=X([""]);Qt.objectStore("local-forage-detect-blob-support").put(Wt,"key"),Qt.onabort=function(Zt){Zt.preventDefault(),Zt.stopPropagation(),Rt(!1)},Qt.oncomplete=function(){var Zt=navigator.userAgent.match(/Chrome\/(\d+)/),oe=navigator.userAgent.match(/Edge\//);Rt(oe||!Zt||parseInt(Zt[1],10)>=43)}}).catch(function(){return!1})}(xt).then(function(St){return L=St})}function P(xt){var St=I[xt.name],Rt={};Rt.promise=new J(function(Qt,Wt){Rt.resolve=Qt,Rt.reject=Wt}),St.deferredOperations.push(Rt),St.dbReady?St.dbReady=St.dbReady.then(function(){return Rt.promise}):St.dbReady=Rt.promise}function j(xt){var St=I[xt.name].deferredOperations.pop();if(St)return St.resolve(),St.promise}function Q(xt,St){var Rt=I[xt.name].deferredOperations.pop();if(Rt)return Rt.reject(St),Rt.promise}function H(xt,St){return new J(function(Rt,Qt){if(I[xt.name]=I[xt.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},xt.db){if(!St)return Rt(xt.db);P(xt),xt.db.close()}var Wt=[xt.name];St&&Wt.push(xt.version);var Zt=z.open.apply(z,Wt);St&&(Zt.onupgradeneeded=function(oe){var Me=Zt.result;try{Me.createObjectStore(xt.storeName),oe.oldVersion<=1&&Me.createObjectStore("local-forage-detect-blob-support")}catch(Ee){if(Ee.name!=="ConstraintError")throw Ee;console.warn('The database "'+xt.name+'" has been upgraded from version '+oe.oldVersion+" to version "+oe.newVersion+', but the storage "'+xt.storeName+'" already exists.')}}),Zt.onerror=function(oe){oe.preventDefault(),Qt(Zt.error)},Zt.onsuccess=function(){var oe=Zt.result;oe.onversionchange=function(Me){Me.target.close()},Rt(oe),j(xt)}})}function Ot(xt){return H(xt,!1)}function Vt(xt){return H(xt,!0)}function st(xt,St){if(!xt.db)return!0;var Rt=!xt.db.objectStoreNames.contains(xt.storeName),Qt=xt.version<xt.db.version,Wt=xt.version>xt.db.version;if(Qt&&(xt.version!==St&&console.warn('The database "'+xt.name+`" can't be downgraded from version `+xt.db.version+" to version "+xt.version+"."),xt.version=xt.db.version),Wt||Rt){if(Rt){var Zt=xt.db.version+1;Zt>xt.version&&(xt.version=Zt)}return!0}return!1}function V(xt){return X([function(St){for(var Rt=St.length,Qt=new ArrayBuffer(Rt),Wt=new Uint8Array(Qt),Zt=0;Zt<Rt;Zt++)Wt[Zt]=St.charCodeAt(Zt);return Qt}(atob(xt.data))],{type:xt.type})}function k(xt){return xt&&xt.__local_forage_encoded_blob}function mt(xt){var St=this,Rt=St._initReady().then(function(){var Qt=I[St._dbInfo.name];if(Qt&&Qt.dbReady)return Qt.dbReady});return pt(Rt,xt,xt),Rt}function tt(xt,St,Rt,Qt){Qt===void 0&&(Qt=1);try{var Wt=xt.db.transaction(xt.storeName,St);Rt(null,Wt)}catch(Zt){if(Qt>0&&(!xt.db||Zt.name==="InvalidStateError"||Zt.name==="NotFoundError"))return J.resolve().then(function(){if(!xt.db||Zt.name==="NotFoundError"&&!xt.db.objectStoreNames.contains(xt.storeName)&&xt.version<=xt.db.version)return xt.db&&(xt.version=xt.db.version+1),Vt(xt)}).then(function(){return function(oe){P(oe);for(var Me=I[oe.name],Ee=Me.forages,Se=0;Se<Ee.length;Se++){var Ve=Ee[Se];Ve._dbInfo.db&&(Ve._dbInfo.db.close(),Ve._dbInfo.db=null)}return oe.db=null,Ot(oe).then(function(en){return oe.db=en,st(oe)?Vt(oe):en}).then(function(en){oe.db=Me.db=en;for(var dn=0;dn<Ee.length;dn++)Ee[dn]._dbInfo.db=en}).catch(function(en){throw Q(oe,en),en})}(xt).then(function(){tt(xt,St,Rt,Qt-1)})}).catch(Rt);Rt(Zt)}}var _t={_driver:"asyncStorage",_initStorage:function(xt){var St=this,Rt={db:null};if(xt)for(var Qt in xt)Rt[Qt]=xt[Qt];var Wt=I[Rt.name];Wt||(Wt={forages:[],db:null,dbReady:null,deferredOperations:[]},I[Rt.name]=Wt),Wt.forages.push(St),St._initReady||(St._initReady=St.ready,St.ready=mt);var Zt=[];function oe(){return J.resolve()}for(var Me=0;Me<Wt.forages.length;Me++){var Ee=Wt.forages[Me];Ee!==St&&Zt.push(Ee._initReady().catch(oe))}var Se=Wt.forages.slice(0);return J.all(Zt).then(function(){return Rt.db=Wt.db,Ot(Rt)}).then(function(Ve){return Rt.db=Ve,st(Rt,St._defaultConfig.version)?Vt(Rt):Ve}).then(function(Ve){Rt.db=Wt.db=Ve,St._dbInfo=Rt;for(var en=0;en<Se.length;en++){var dn=Se[en];dn!==St&&(dn._dbInfo.db=Rt.db,dn._dbInfo.version=Rt.version)}})},_support:function(){try{if(!z||!z.open)return!1;var xt=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),St=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!xt||St)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(xt,St){var Rt=this,Qt=new J(function(Wt,Zt){Rt.ready().then(function(){tt(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Ee=Me.objectStore(Rt._dbInfo.storeName).openCursor(),Se=1;Ee.onsuccess=function(){var Ve=Ee.result;if(Ve){var en=Ve.value;k(en)&&(en=V(en));var dn=xt(en,Ve.key,Se++);dn!==void 0?Wt(dn):Ve.continue()}else Wt()},Ee.onerror=function(){Zt(Ee.error)}}catch(Ve){Zt(Ve)}})}).catch(Zt)});return et(Qt,St),Qt},getItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=new J(function(Wt,Zt){Rt.ready().then(function(){tt(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Ee=Me.objectStore(Rt._dbInfo.storeName).get(xt);Ee.onsuccess=function(){var Se=Ee.result;Se===void 0&&(Se=null),k(Se)&&(Se=V(Se)),Wt(Se)},Ee.onerror=function(){Zt(Ee.error)}}catch(Se){Zt(Se)}})}).catch(Zt)});return et(Qt,St),Qt},setItem:function(xt,St,Rt){var Qt=this;xt=Nt(xt);var Wt=new J(function(Zt,oe){var Me;Qt.ready().then(function(){return Me=Qt._dbInfo,F.call(St)==="[object Blob]"?W(Me.db).then(function(Ee){return Ee?St:(Se=St,new J(function(Ve,en){var dn=new FileReader;dn.onerror=en,dn.onloadend=function(Tn){var yn=btoa(Tn.target.result||"");Ve({__local_forage_encoded_blob:!0,data:yn,type:Se.type})},dn.readAsBinaryString(Se)}));var Se}):St}).then(function(Ee){tt(Qt._dbInfo,"readwrite",function(Se,Ve){if(Se)return oe(Se);try{var en=Ve.objectStore(Qt._dbInfo.storeName);Ee===null&&(Ee=void 0);var dn=en.put(Ee,xt);Ve.oncomplete=function(){Ee===void 0&&(Ee=null),Zt(Ee)},Ve.onabort=Ve.onerror=function(){var Tn=dn.error?dn.error:dn.transaction.error;oe(Tn)}}catch(Tn){oe(Tn)}})}).catch(oe)});return et(Wt,Rt),Wt},removeItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=new J(function(Wt,Zt){Rt.ready().then(function(){tt(Rt._dbInfo,"readwrite",function(oe,Me){if(oe)return Zt(oe);try{var Ee=Me.objectStore(Rt._dbInfo.storeName).delete(xt);Me.oncomplete=function(){Wt()},Me.onerror=function(){Zt(Ee.error)},Me.onabort=function(){var Se=Ee.error?Ee.error:Ee.transaction.error;Zt(Se)}}catch(Se){Zt(Se)}})}).catch(Zt)});return et(Qt,St),Qt},clear:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){tt(St._dbInfo,"readwrite",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(St._dbInfo.storeName).clear();oe.oncomplete=function(){Qt()},oe.onabort=oe.onerror=function(){var Ee=Me.error?Me.error:Me.transaction.error;Wt(Ee)}}catch(Ee){Wt(Ee)}})}).catch(Wt)});return et(Rt,xt),Rt},length:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){tt(St._dbInfo,"readonly",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(St._dbInfo.storeName).count();Me.onsuccess=function(){Qt(Me.result)},Me.onerror=function(){Wt(Me.error)}}catch(Ee){Wt(Ee)}})}).catch(Wt)});return et(Rt,xt),Rt},key:function(xt,St){var Rt=this,Qt=new J(function(Wt,Zt){xt<0?Wt(null):Rt.ready().then(function(){tt(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Zt(oe);try{var Ee=Me.objectStore(Rt._dbInfo.storeName),Se=!1,Ve=Ee.openKeyCursor();Ve.onsuccess=function(){var en=Ve.result;en?xt===0||Se?Wt(en.key):(Se=!0,en.advance(xt)):Wt(null)},Ve.onerror=function(){Zt(Ve.error)}}catch(en){Zt(en)}})}).catch(Zt)});return et(Qt,St),Qt},keys:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){tt(St._dbInfo,"readonly",function(Zt,oe){if(Zt)return Wt(Zt);try{var Me=oe.objectStore(St._dbInfo.storeName).openKeyCursor(),Ee=[];Me.onsuccess=function(){var Se=Me.result;Se?(Ee.push(Se.key),Se.continue()):Qt(Ee)},Me.onerror=function(){Wt(Me.error)}}catch(Se){Wt(Se)}})}).catch(Wt)});return et(Rt,xt),Rt},dropInstance:function(xt,St){St=vt.apply(this,arguments);var Rt=this.config();(xt=typeof xt!="function"&&xt||{}).name||(xt.name=xt.name||Rt.name,xt.storeName=xt.storeName||Rt.storeName);var Qt,Wt=this;if(xt.name){var Zt=xt.name===Rt.name&&Wt._dbInfo.db,oe=Zt?J.resolve(Wt._dbInfo.db):Ot(xt).then(function(Me){var Ee=I[xt.name],Se=Ee.forages;Ee.db=Me;for(var Ve=0;Ve<Se.length;Ve++)Se[Ve]._dbInfo.db=Me;return Me});Qt=xt.storeName?oe.then(function(Me){if(Me.objectStoreNames.contains(xt.storeName)){var Ee=Me.version+1;P(xt);var Se=I[xt.name],Ve=Se.forages;Me.close();for(var en=0;en<Ve.length;en++){var dn=Ve[en];dn._dbInfo.db=null,dn._dbInfo.version=Ee}return new J(function(Tn,yn){var Xn=z.open(xt.name,Ee);Xn.onerror=function(Pn){Xn.result.close(),yn(Pn)},Xn.onupgradeneeded=function(){Xn.result.deleteObjectStore(xt.storeName)},Xn.onsuccess=function(){var Pn=Xn.result;Pn.close(),Tn(Pn)}}).then(function(Tn){Se.db=Tn;for(var yn=0;yn<Ve.length;yn++){var Xn=Ve[yn];Xn._dbInfo.db=Tn,j(Xn._dbInfo)}}).catch(function(Tn){throw(Q(xt,Tn)||J.resolve()).catch(function(){}),Tn})}}):oe.then(function(Me){P(xt);var Ee=I[xt.name],Se=Ee.forages;Me.close();for(var Ve=0;Ve<Se.length;Ve++)Se[Ve]._dbInfo.db=null;return new J(function(en,dn){var Tn=z.deleteDatabase(xt.name);Tn.onerror=function(){var yn=Tn.result;yn&&yn.close(),dn(Tn.error)},Tn.onblocked=function(){console.warn('dropInstance blocked for database "'+xt.name+'" until all open connections are closed')},Tn.onsuccess=function(){var yn=Tn.result;yn&&yn.close(),en(yn)}}).then(function(en){Ee.db=en;for(var dn=0;dn<Se.length;dn++)j(Se[dn]._dbInfo)}).catch(function(en){throw(Q(xt,en)||J.resolve()).catch(function(){}),en})})}else Qt=J.reject("Invalid arguments");return et(Qt,St),Qt}},Dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=/^~~local_forage_type~([^~]+)~/,ct=9,rt=ct+4,yt=Object.prototype.toString;function At(xt){var St,Rt,Qt,Wt,Zt,oe=.75*xt.length,Me=xt.length,Ee=0;xt[xt.length-1]==="="&&(oe--,xt[xt.length-2]==="="&&oe--);var Se=new ArrayBuffer(oe),Ve=new Uint8Array(Se);for(St=0;St<Me;St+=4)Rt=Dt.indexOf(xt[St]),Qt=Dt.indexOf(xt[St+1]),Wt=Dt.indexOf(xt[St+2]),Zt=Dt.indexOf(xt[St+3]),Ve[Ee++]=Rt<<2|Qt>>4,Ve[Ee++]=(15&Qt)<<4|Wt>>2,Ve[Ee++]=(3&Wt)<<6|63&Zt;return Se}function Gt(xt){var St,Rt=new Uint8Array(xt),Qt="";for(St=0;St<Rt.length;St+=3)Qt+=Dt[Rt[St]>>2],Qt+=Dt[(3&Rt[St])<<4|Rt[St+1]>>4],Qt+=Dt[(15&Rt[St+1])<<2|Rt[St+2]>>6],Qt+=Dt[63&Rt[St+2]];return Rt.length%3==2?Qt=Qt.substring(0,Qt.length-1)+"=":Rt.length%3==1&&(Qt=Qt.substring(0,Qt.length-2)+"=="),Qt}var Yt={serialize:function(xt,St){var Rt="";if(xt&&(Rt=yt.call(xt)),xt&&(Rt==="[object ArrayBuffer]"||xt.buffer&&yt.call(xt.buffer)==="[object ArrayBuffer]")){var Qt,Wt="__lfsc__:";xt instanceof ArrayBuffer?(Qt=xt,Wt+="arbf"):(Qt=xt.buffer,Rt==="[object Int8Array]"?Wt+="si08":Rt==="[object Uint8Array]"?Wt+="ui08":Rt==="[object Uint8ClampedArray]"?Wt+="uic8":Rt==="[object Int16Array]"?Wt+="si16":Rt==="[object Uint16Array]"?Wt+="ur16":Rt==="[object Int32Array]"?Wt+="si32":Rt==="[object Uint32Array]"?Wt+="ui32":Rt==="[object Float32Array]"?Wt+="fl32":Rt==="[object Float64Array]"?Wt+="fl64":St(new Error("Failed to get type for BinaryArray"))),St(Wt+Gt(Qt))}else if(Rt==="[object Blob]"){var Zt=new FileReader;Zt.onload=function(){var oe="~~local_forage_type~"+xt.type+"~"+Gt(this.result);St("__lfsc__:blob"+oe)},Zt.readAsArrayBuffer(xt)}else try{St(JSON.stringify(xt))}catch(oe){console.error("Couldn't convert value into a JSON string: ",xt),St(null,oe)}},deserialize:function(xt){if(xt.substring(0,ct)!=="__lfsc__:")return JSON.parse(xt);var St,Rt=xt.substring(rt),Qt=xt.substring(ct,rt);if(Qt==="blob"&&Z.test(Rt)){var Wt=Rt.match(Z);St=Wt[1],Rt=Rt.substring(Wt[0].length)}var Zt=At(Rt);switch(Qt){case"arbf":return Zt;case"blob":return X([Zt],{type:St});case"si08":return new Int8Array(Zt);case"ui08":return new Uint8Array(Zt);case"uic8":return new Uint8ClampedArray(Zt);case"si16":return new Int16Array(Zt);case"ur16":return new Uint16Array(Zt);case"si32":return new Int32Array(Zt);case"ui32":return new Uint32Array(Zt);case"fl32":return new Float32Array(Zt);case"fl64":return new Float64Array(Zt);default:throw new Error("Unkown type: "+Qt)}},stringToBuffer:At,bufferToString:Gt};function Jt(xt,St,Rt,Qt){xt.executeSql("CREATE TABLE IF NOT EXISTS "+St.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Rt,Qt)}function at(xt,St,Rt,Qt,Wt,Zt){xt.executeSql(Rt,Qt,Wt,function(oe,Me){Me.code===Me.SYNTAX_ERR?oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[St.storeName],function(Ee,Se){Se.rows.length?Zt(Ee,Me):Jt(Ee,St,function(){Ee.executeSql(Rt,Qt,Wt,Zt)},Zt)},Zt):Zt(oe,Me)},Zt)}function _e(xt,St,Rt,Qt){var Wt=this;xt=Nt(xt);var Zt=new J(function(oe,Me){Wt.ready().then(function(){St===void 0&&(St=null);var Ee=St,Se=Wt._dbInfo;Se.serializer.serialize(St,function(Ve,en){en?Me(en):Se.db.transaction(function(dn){at(dn,Se,"INSERT OR REPLACE INTO "+Se.storeName+" (key, value) VALUES (?, ?)",[xt,Ve],function(){oe(Ee)},function(Tn,yn){Me(yn)})},function(dn){if(dn.code===dn.QUOTA_ERR){if(Qt>0)return void oe(_e.apply(Wt,[xt,Ee,Rt,Qt-1]));Me(dn)}})})}).catch(Me)});return et(Zt,Rt),Zt}function ke(xt){return new J(function(St,Rt){xt.transaction(function(Qt){Qt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Wt,Zt){for(var oe=[],Me=0;Me<Zt.rows.length;Me++)oe.push(Zt.rows.item(Me).name);St({db:xt,storeNames:oe})},function(Wt,Zt){Rt(Zt)})},function(Qt){Rt(Qt)})})}var Le={_driver:"webSQLStorage",_initStorage:function(xt){var St=this,Rt={db:null};if(xt)for(var Qt in xt)Rt[Qt]=typeof xt[Qt]!="string"?xt[Qt].toString():xt[Qt];var Wt=new J(function(Zt,oe){try{Rt.db=openDatabase(Rt.name,String(Rt.version),Rt.description,Rt.size)}catch(Me){return oe(Me)}Rt.db.transaction(function(Me){Jt(Me,Rt,function(){St._dbInfo=Rt,Zt()},function(Ee,Se){oe(Se)})},oe)});return Rt.serializer=Yt,Wt},_support:typeof openDatabase=="function",iterate:function(xt,St){var Rt=this,Qt=new J(function(Wt,Zt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName,[],function(Ee,Se){for(var Ve=Se.rows,en=Ve.length,dn=0;dn<en;dn++){var Tn=Ve.item(dn),yn=Tn.value;if(yn&&(yn=oe.serializer.deserialize(yn)),(yn=xt(yn,Tn.key,dn+1))!==void 0)return void Wt(yn)}Wt()},function(Ee,Se){Zt(Se)})})}).catch(Zt)});return et(Qt,St),Qt},getItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=new J(function(Wt,Zt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName+" WHERE key = ? LIMIT 1",[xt],function(Ee,Se){var Ve=Se.rows.length?Se.rows.item(0).value:null;Ve&&(Ve=oe.serializer.deserialize(Ve)),Wt(Ve)},function(Ee,Se){Zt(Se)})})}).catch(Zt)});return et(Qt,St),Qt},setItem:function(xt,St,Rt){return _e.apply(this,[xt,St,Rt,1])},removeItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=new J(function(Wt,Zt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"DELETE FROM "+oe.storeName+" WHERE key = ?",[xt],function(){Wt()},function(Ee,Se){Zt(Se)})})}).catch(Zt)});return et(Qt,St),Qt},clear:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){var Zt=St._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"DELETE FROM "+Zt.storeName,[],function(){Qt()},function(Me,Ee){Wt(Ee)})})}).catch(Wt)});return et(Rt,xt),Rt},length:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){var Zt=St._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"SELECT COUNT(key) as c FROM "+Zt.storeName,[],function(Me,Ee){var Se=Ee.rows.item(0).c;Qt(Se)},function(Me,Ee){Wt(Ee)})})}).catch(Wt)});return et(Rt,xt),Rt},key:function(xt,St){var Rt=this,Qt=new J(function(Wt,Zt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT key FROM "+oe.storeName+" WHERE id = ? LIMIT 1",[xt+1],function(Ee,Se){var Ve=Se.rows.length?Se.rows.item(0).key:null;Wt(Ve)},function(Ee,Se){Zt(Se)})})}).catch(Zt)});return et(Qt,St),Qt},keys:function(xt){var St=this,Rt=new J(function(Qt,Wt){St.ready().then(function(){var Zt=St._dbInfo;Zt.db.transaction(function(oe){at(oe,Zt,"SELECT key FROM "+Zt.storeName,[],function(Me,Ee){for(var Se=[],Ve=0;Ve<Ee.rows.length;Ve++)Se.push(Ee.rows.item(Ve).key);Qt(Se)},function(Me,Ee){Wt(Ee)})})}).catch(Wt)});return et(Rt,xt),Rt},dropInstance:function(xt,St){St=vt.apply(this,arguments);var Rt=this.config();(xt=typeof xt!="function"&&xt||{}).name||(xt.name=xt.name||Rt.name,xt.storeName=xt.storeName||Rt.storeName);var Qt,Wt=this;return et(Qt=xt.name?new J(function(Zt){var oe;oe=xt.name===Rt.name?Wt._dbInfo.db:openDatabase(xt.name,"","",0),xt.storeName?Zt({db:oe,storeNames:[xt.storeName]}):Zt(ke(oe))}).then(function(Zt){return new J(function(oe,Me){Zt.db.transaction(function(Ee){function Se(Tn){return new J(function(yn,Xn){Ee.executeSql("DROP TABLE IF EXISTS "+Tn,[],function(){yn()},function(Pn,Vi){Xn(Vi)})})}for(var Ve=[],en=0,dn=Zt.storeNames.length;en<dn;en++)Ve.push(Se(Zt.storeNames[en]));J.all(Ve).then(function(){oe()}).catch(function(Tn){Me(Tn)})},function(Ee){Me(Ee)})})}):J.reject("Invalid arguments"),St),Qt}};function Ae(xt,St){var Rt=xt.name+"/";return xt.storeName!==St.storeName&&(Rt+=xt.storeName+"/"),Rt}function ze(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var Qe={_driver:"localStorageWrapper",_initStorage:function(xt){var St={};if(xt)for(var Rt in xt)St[Rt]=xt[Rt];return St.keyPrefix=Ae(xt,this._defaultConfig),ze()?(this._dbInfo=St,St.serializer=Yt,J.resolve()):J.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(xt,St){var Rt=this,Qt=Rt.ready().then(function(){for(var Wt=Rt._dbInfo,Zt=Wt.keyPrefix,oe=Zt.length,Me=localStorage.length,Ee=1,Se=0;Se<Me;Se++){var Ve=localStorage.key(Se);if(Ve.indexOf(Zt)===0){var en=localStorage.getItem(Ve);if(en&&(en=Wt.serializer.deserialize(en)),(en=xt(en,Ve.substring(oe),Ee++))!==void 0)return en}}});return et(Qt,St),Qt},getItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=Rt.ready().then(function(){var Wt=Rt._dbInfo,Zt=localStorage.getItem(Wt.keyPrefix+xt);return Zt&&(Zt=Wt.serializer.deserialize(Zt)),Zt});return et(Qt,St),Qt},setItem:function(xt,St,Rt){var Qt=this;xt=Nt(xt);var Wt=Qt.ready().then(function(){St===void 0&&(St=null);var Zt=St;return new J(function(oe,Me){var Ee=Qt._dbInfo;Ee.serializer.serialize(St,function(Se,Ve){if(Ve)Me(Ve);else try{localStorage.setItem(Ee.keyPrefix+xt,Se),oe(Zt)}catch(en){en.name!=="QuotaExceededError"&&en.name!=="NS_ERROR_DOM_QUOTA_REACHED"||Me(en),Me(en)}})})});return et(Wt,Rt),Wt},removeItem:function(xt,St){var Rt=this;xt=Nt(xt);var Qt=Rt.ready().then(function(){var Wt=Rt._dbInfo;localStorage.removeItem(Wt.keyPrefix+xt)});return et(Qt,St),Qt},clear:function(xt){var St=this,Rt=St.ready().then(function(){for(var Qt=St._dbInfo.keyPrefix,Wt=localStorage.length-1;Wt>=0;Wt--){var Zt=localStorage.key(Wt);Zt.indexOf(Qt)===0&&localStorage.removeItem(Zt)}});return et(Rt,xt),Rt},length:function(xt){var St=this.keys().then(function(Rt){return Rt.length});return et(St,xt),St},key:function(xt,St){var Rt=this,Qt=Rt.ready().then(function(){var Wt,Zt=Rt._dbInfo;try{Wt=localStorage.key(xt)}catch{Wt=null}return Wt&&(Wt=Wt.substring(Zt.keyPrefix.length)),Wt});return et(Qt,St),Qt},keys:function(xt){var St=this,Rt=St.ready().then(function(){for(var Qt=St._dbInfo,Wt=localStorage.length,Zt=[],oe=0;oe<Wt;oe++){var Me=localStorage.key(oe);Me.indexOf(Qt.keyPrefix)===0&&Zt.push(Me.substring(Qt.keyPrefix.length))}return Zt});return et(Rt,xt),Rt},dropInstance:function(xt,St){if(St=vt.apply(this,arguments),!(xt=typeof xt!="function"&&xt||{}).name){var Rt=this.config();xt.name=xt.name||Rt.name,xt.storeName=xt.storeName||Rt.storeName}var Qt,Wt=this;return et(Qt=xt.name?new J(function(Zt){xt.storeName?Zt(Ae(xt,Wt._defaultConfig)):Zt(xt.name+"/")}).then(function(Zt){for(var oe=localStorage.length-1;oe>=0;oe--){var Me=localStorage.key(oe);Me.indexOf(Zt)===0&&localStorage.removeItem(Me)}}):J.reject("Invalid arguments"),St),Qt}},cn=function(xt,St){for(var Rt,Qt,Wt=xt.length,Zt=0;Zt<Wt;){if((Rt=xt[Zt])===(Qt=St)||typeof Rt=="number"&&typeof Qt=="number"&&isNaN(Rt)&&isNaN(Qt))return!0;Zt++}return!1},Ue=Array.isArray||function(xt){return Object.prototype.toString.call(xt)==="[object Array]"},Ge={},Rn={},re={INDEXEDDB:_t,WEBSQL:Le,LOCALSTORAGE:Qe},fe=[re.INDEXEDDB._driver,re.WEBSQL._driver,re.LOCALSTORAGE._driver],we=["dropInstance"],ln=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(we),In={description:"",driver:fe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Zn(xt,St){xt[St]=function(){var Rt=arguments;return xt.ready().then(function(){return xt[St].apply(xt,Rt)})}}function gi(){for(var xt=1;xt<arguments.length;xt++){var St=arguments[xt];if(St)for(var Rt in St)St.hasOwnProperty(Rt)&&(Ue(St[Rt])?arguments[0][Rt]=St[Rt].slice():arguments[0][Rt]=St[Rt])}return arguments[0]}var tn=new(function(){function xt(St){for(var Rt in function(Zt,oe){if(!(Zt instanceof oe))throw new TypeError("Cannot call a class as a function")}(this,xt),re)if(re.hasOwnProperty(Rt)){var Qt=re[Rt],Wt=Qt._driver;this[Rt]=Wt,Ge[Wt]||this.defineDriver(Qt)}this._defaultConfig=gi({},In),this._config=gi({},this._defaultConfig,St),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return xt.prototype.config=function(St){if((St===void 0?"undefined":B(St))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Rt in St){if(Rt==="storeName"&&(St[Rt]=St[Rt].replace(/\W/g,"_")),Rt==="version"&&typeof St[Rt]!="number")return new Error("Database version must be a number.");this._config[Rt]=St[Rt]}return!("driver"in St)||!St.driver||this.setDriver(this._config.driver)}return typeof St=="string"?this._config[St]:this._config},xt.prototype.defineDriver=function(St,Rt,Qt){var Wt=new J(function(Zt,oe){try{var Me=St._driver,Ee=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!St._driver)return void oe(Ee);for(var Se=ln.concat("_initStorage"),Ve=0,en=Se.length;Ve<en;Ve++){var dn=Se[Ve];if((!cn(we,dn)||St[dn])&&typeof St[dn]!="function")return void oe(Ee)}(function(){for(var yn=function(To){return function(){var oo=new Error("Method "+To+" is not implemented by the current driver"),Fn=J.reject(oo);return et(Fn,arguments[arguments.length-1]),Fn}},Xn=0,Pn=we.length;Xn<Pn;Xn++){var Vi=we[Xn];St[Vi]||(St[Vi]=yn(Vi))}})();var Tn=function(yn){Ge[Me]&&console.info("Redefining LocalForage driver: "+Me),Ge[Me]=St,Rn[Me]=yn,Zt()};"_support"in St?St._support&&typeof St._support=="function"?St._support().then(Tn,oe):Tn(!!St._support):Tn(!0)}catch(yn){oe(yn)}});return pt(Wt,Rt,Qt),Wt},xt.prototype.driver=function(){return this._driver||null},xt.prototype.getDriver=function(St,Rt,Qt){var Wt=Ge[St]?J.resolve(Ge[St]):J.reject(new Error("Driver not found."));return pt(Wt,Rt,Qt),Wt},xt.prototype.getSerializer=function(St){var Rt=J.resolve(Yt);return pt(Rt,St),Rt},xt.prototype.ready=function(St){var Rt=this,Qt=Rt._driverSet.then(function(){return Rt._ready===null&&(Rt._ready=Rt._initDriver()),Rt._ready});return pt(Qt,St,St),Qt},xt.prototype.setDriver=function(St,Rt,Qt){var Wt=this;Ue(St)||(St=[St]);var Zt=this._getSupportedDrivers(St);function oe(){Wt._config.driver=Wt.driver()}function Me(Se){return Wt._extend(Se),oe(),Wt._ready=Wt._initStorage(Wt._config),Wt._ready}var Ee=this._driverSet!==null?this._driverSet.catch(function(){return J.resolve()}):J.resolve();return this._driverSet=Ee.then(function(){var Se=Zt[0];return Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(Se).then(function(Ve){Wt._driver=Ve._driver,oe(),Wt._wrapLibraryMethodsWithReady(),Wt._initDriver=function(en){return function(){var dn=0;return function Tn(){for(;dn<en.length;){var yn=en[dn];return dn++,Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(yn).then(Me).catch(Tn)}oe();var Xn=new Error("No available storage method found.");return Wt._driverSet=J.reject(Xn),Wt._driverSet}()}}(Zt)})}).catch(function(){oe();var Se=new Error("No available storage method found.");return Wt._driverSet=J.reject(Se),Wt._driverSet}),pt(this._driverSet,Rt,Qt),this._driverSet},xt.prototype.supports=function(St){return!!Rn[St]},xt.prototype._extend=function(St){gi(this,St)},xt.prototype._getSupportedDrivers=function(St){for(var Rt=[],Qt=0,Wt=St.length;Qt<Wt;Qt++){var Zt=St[Qt];this.supports(Zt)&&Rt.push(Zt)}return Rt},xt.prototype._wrapLibraryMethodsWithReady=function(){for(var St=0,Rt=ln.length;St<Rt;St++)Zn(this,ln[St])},xt.prototype.createInstance=function(St){return new xt(St)},xt}());M.exports=tn},{3:3}]},{},[4])(4)}).call(this,v(17))},function(b,S,v){var O=v(21),R=v(200),M=v(201),D=Math.max,B=Math.min;b.exports=function(z,X,J){var et,pt,Nt,vt,L,I,F=0,W=!1,P=!1,j=!0;if(typeof z!="function")throw new TypeError("Expected a function");function Q(k){var mt=et,tt=pt;return et=pt=void 0,F=k,vt=z.apply(tt,mt)}function H(k){return F=k,L=setTimeout(Vt,X),W?Q(k):vt}function Ot(k){var mt=k-I;return I===void 0||mt>=X||mt<0||P&&k-F>=Nt}function Vt(){var k=R();if(Ot(k))return st(k);L=setTimeout(Vt,function(mt){var tt=X-(mt-I);return P?B(tt,Nt-(mt-F)):tt}(k))}function st(k){return L=void 0,j&&et?Q(k):(et=pt=void 0,vt)}function V(){var k=R(),mt=Ot(k);if(et=arguments,pt=this,I=k,mt){if(L===void 0)return H(I);if(P)return clearTimeout(L),L=setTimeout(Vt,X),Q(I)}return L===void 0&&(L=setTimeout(Vt,X)),vt}return X=M(X)||0,O(J)&&(W=!!J.leading,Nt=(P="maxWait"in J)?D(M(J.maxWait)||0,X):Nt,j="trailing"in J?!!J.trailing:j),V.cancel=function(){L!==void 0&&clearTimeout(L),F=0,et=I=pt=L=void 0},V.flush=function(){return L===void 0?vt:st(R())},V}},function(b,S,v){var O=v(14).Symbol;b.exports=O},function(b,S){b.exports=function(v){return v.webpackPolyfill||(v.deprecate=function(){},v.paths=[],v.children||(v.children=[]),Object.defineProperty(v,"loaded",{enumerable:!0,get:function(){return v.l}}),Object.defineProperty(v,"id",{enumerable:!0,get:function(){return v.i}}),v.webpackPolyfill=1),v}},function(b,S,v){var O=v(152),R=v(153),M=v(154),D=v(155),B=v(156);function z(X){var J=-1,et=X==null?0:X.length;for(this.clear();++J<et;){var pt=X[J];this.set(pt[0],pt[1])}}z.prototype.clear=O,z.prototype.delete=R,z.prototype.get=M,z.prototype.has=D,z.prototype.set=B,b.exports=z},function(b,S,v){var O=v(37);b.exports=function(R,M){for(var D=R.length;D--;)if(O(R[D][0],M))return D;return-1}},function(b,S,v){var O=v(22)(Object,"create");b.exports=O},function(b,S,v){var O=v(174);b.exports=function(R,M){var D=R.__data__;return O(M)?D[typeof M=="string"?"string":"hash"]:D.map}},function(b,S){var v=Array.isArray;b.exports=v},function(b,S,v){var O=v(196),R=v(38),M=v(197),D=v(198),B=v(199),z=v(20),X=v(55),J=X(O),et=X(R),pt=X(M),Nt=X(D),vt=X(B),L=z;(O&&L(new O(new ArrayBuffer(1)))!="[object DataView]"||R&&L(new R)!="[object Map]"||M&&L(M.resolve())!="[object Promise]"||D&&L(new D)!="[object Set]"||B&&L(new B)!="[object WeakMap]")&&(L=function(I){var F=z(I),W=F=="[object Object]"?I.constructor:void 0,P=W?X(W):"";if(P)switch(P){case J:return"[object DataView]";case et:return"[object Map]";case pt:return"[object Promise]";case Nt:return"[object Set]";case vt:return"[object WeakMap]"}return F}),b.exports=L},function(b,S,v){var O=v(68),R=v(69);b.exports=function(M,D,B,z){var X=!B;B||(B={});for(var J=-1,et=D.length;++J<et;){var pt=D[J],Nt=z?z(B[pt],M[pt],pt,B,M):void 0;Nt===void 0&&(Nt=M[pt]),X?R(B,pt,Nt):O(B,pt,Nt)}return B}},function(b,S,v){var O=v(20),R=v(21);b.exports=function(M){if(!R(M))return!1;var D=O(M);return D=="[object Function]"||D=="[object GeneratorFunction]"||D=="[object AsyncFunction]"||D=="[object Proxy]"}},function(b,S,v){(function(O){v.d(S,"a",function(){return uu});var R=v(4),M=v(0),D=v(11),B=v(8),z=v(16),X=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:O!==void 0?O:typeof self!="undefined"?self:{};function J(T,d,c){return T(c={path:d,exports:{},require:function(f,E){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(E==null&&c.path)}},c.exports),c.exports}var et=J(function(T){var d=Object.prototype.hasOwnProperty,c="~";function f(){}function E(ut,It,kt){this.fn=ut,this.context=It,this.once=kt||!1}function U(ut,It,kt,he,te){if(typeof kt!="function")throw new TypeError("The listener must be a function");var ge=new E(kt,he||ut,te),xe=c?c+It:It;return ut._events[xe]?ut._events[xe].fn?ut._events[xe]=[ut._events[xe],ge]:ut._events[xe].push(ge):(ut._events[xe]=ge,ut._eventsCount++),ut}function $(ut,It){--ut._eventsCount==0?ut._events=new f:delete ut._events[It]}function ot(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(c=!1)),ot.prototype.eventNames=function(){var ut,It,kt=[];if(this._eventsCount===0)return kt;for(It in ut=this._events)d.call(ut,It)&&kt.push(c?It.slice(1):It);return Object.getOwnPropertySymbols?kt.concat(Object.getOwnPropertySymbols(ut)):kt},ot.prototype.listeners=function(ut){var It=c?c+ut:ut,kt=this._events[It];if(!kt)return[];if(kt.fn)return[kt.fn];for(var he=0,te=kt.length,ge=new Array(te);he<te;he++)ge[he]=kt[he].fn;return ge},ot.prototype.listenerCount=function(ut){var It=c?c+ut:ut,kt=this._events[It];return kt?kt.fn?1:kt.length:0},ot.prototype.emit=function(ut,It,kt,he,te,ge){var xe=arguments,Be=c?c+ut:ut;if(!this._events[Be])return!1;var Je,qe,Ze=this._events[Be],je=arguments.length;if(Ze.fn){switch(Ze.once&&this.removeListener(ut,Ze.fn,void 0,!0),je){case 1:return Ze.fn.call(Ze.context),!0;case 2:return Ze.fn.call(Ze.context,It),!0;case 3:return Ze.fn.call(Ze.context,It,kt),!0;case 4:return Ze.fn.call(Ze.context,It,kt,he),!0;case 5:return Ze.fn.call(Ze.context,It,kt,he,te),!0;case 6:return Ze.fn.call(Ze.context,It,kt,he,te,ge),!0}for(qe=1,Je=new Array(je-1);qe<je;qe++)Je[qe-1]=xe[qe];Ze.fn.apply(Ze.context,Je)}else{var pn,_n=Ze.length;for(qe=0;qe<_n;qe++)switch(Ze[qe].once&&this.removeListener(ut,Ze[qe].fn,void 0,!0),je){case 1:Ze[qe].fn.call(Ze[qe].context);break;case 2:Ze[qe].fn.call(Ze[qe].context,It);break;case 3:Ze[qe].fn.call(Ze[qe].context,It,kt);break;case 4:Ze[qe].fn.call(Ze[qe].context,It,kt,he);break;default:if(!Je)for(pn=1,Je=new Array(je-1);pn<je;pn++)Je[pn-1]=xe[pn];Ze[qe].fn.apply(Ze[qe].context,Je)}}return!0},ot.prototype.on=function(ut,It,kt){return U(this,ut,It,kt,!1)},ot.prototype.once=function(ut,It,kt){return U(this,ut,It,kt,!0)},ot.prototype.removeListener=function(ut,It,kt,he){var te=c?c+ut:ut;if(!this._events[te])return this;if(!It)return $(this,te),this;var ge=this._events[te];if(ge.fn)ge.fn!==It||he&&!ge.once||kt&&ge.context!==kt||$(this,te);else{for(var xe=0,Be=[],Je=ge.length;xe<Je;xe++)(ge[xe].fn!==It||he&&!ge[xe].once||kt&&ge[xe].context!==kt)&&Be.push(ge[xe]);Be.length?this._events[te]=Be.length===1?Be[0]:Be:$(this,te)}return this},ot.prototype.removeAllListeners=function(ut){var It;return ut?(It=c?c+ut:ut,this._events[It]&&$(this,It)):(this._events=new f,this._eventsCount=0),this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.addListener=ot.prototype.on,ot.prefixed=c,ot.EventEmitter=ot,T.exports=ot}),pt=J(function(T,d){(function(c){var f=d&&!d.nodeType&&d,E=T&&!T.nodeType&&T,U=typeof X=="object"&&X;U.global!==U&&U.window!==U&&U.self!==U||(c=U);var $,ot,ut=2147483647,It=/^xn--/,kt=/[^\x20-\x7E]/,he=/[\x2E\u3002\uFF0E\uFF61]/g,te={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ge=Math.floor,xe=String.fromCharCode;function Be(Ye){throw RangeError(te[Ye])}function Je(Ye,an){for(var bn=Ye.length,Gn=[];bn--;)Gn[bn]=an(Ye[bn]);return Gn}function qe(Ye,an){var bn=Ye.split("@"),Gn="";return bn.length>1&&(Gn=bn[0]+"@",Ye=bn[1]),Gn+Je((Ye=Ye.replace(he,".")).split("."),an).join(".")}function Ze(Ye){for(var an,bn,Gn=[],qn=0,Ei=Ye.length;qn<Ei;)(an=Ye.charCodeAt(qn++))>=55296&&an<=56319&&qn<Ei?(64512&(bn=Ye.charCodeAt(qn++)))==56320?Gn.push(((1023&an)<<10)+(1023&bn)+65536):(Gn.push(an),qn--):Gn.push(an);return Gn}function je(Ye){return Je(Ye,function(an){var bn="";return an>65535&&(bn+=xe((an-=65536)>>>10&1023|55296),an=56320|1023&an),bn+=xe(an)}).join("")}function pn(Ye,an){return Ye+22+75*(Ye<26)-((an!=0)<<5)}function _n(Ye,an,bn){var Gn=0;for(Ye=bn?ge(Ye/700):Ye>>1,Ye+=ge(Ye/an);Ye>455;Gn+=36)Ye=ge(Ye/35);return ge(Gn+36*Ye/(Ye+38))}function Un(Ye){var an,bn,Gn,qn,Ei,Qn,xi,Pi,Zi,Gi,ii,Ai=[],Hi=Ye.length,ji=0,er=128,ri=72;for((bn=Ye.lastIndexOf("-"))<0&&(bn=0),Gn=0;Gn<bn;++Gn)Ye.charCodeAt(Gn)>=128&&Be("not-basic"),Ai.push(Ye.charCodeAt(Gn));for(qn=bn>0?bn+1:0;qn<Hi;){for(Ei=ji,Qn=1,xi=36;qn>=Hi&&Be("invalid-input"),((Pi=(ii=Ye.charCodeAt(qn++))-48<10?ii-22:ii-65<26?ii-65:ii-97<26?ii-97:36)>=36||Pi>ge((ut-ji)/Qn))&&Be("overflow"),ji+=Pi*Qn,!(Pi<(Zi=xi<=ri?1:xi>=ri+26?26:xi-ri));xi+=36)Qn>ge(ut/(Gi=36-Zi))&&Be("overflow"),Qn*=Gi;ri=_n(ji-Ei,an=Ai.length+1,Ei==0),ge(ji/an)>ut-er&&Be("overflow"),er+=ge(ji/an),ji%=an,Ai.splice(ji++,0,er)}return je(Ai)}function Dn(Ye){var an,bn,Gn,qn,Ei,Qn,xi,Pi,Zi,Gi,ii,Ai,Hi,ji,er,ri=[];for(Ai=(Ye=Ze(Ye)).length,an=128,bn=0,Ei=72,Qn=0;Qn<Ai;++Qn)(ii=Ye[Qn])<128&&ri.push(xe(ii));for(Gn=qn=ri.length,qn&&ri.push("-");Gn<Ai;){for(xi=ut,Qn=0;Qn<Ai;++Qn)(ii=Ye[Qn])>=an&&ii<xi&&(xi=ii);for(xi-an>ge((ut-bn)/(Hi=Gn+1))&&Be("overflow"),bn+=(xi-an)*Hi,an=xi,Qn=0;Qn<Ai;++Qn)if((ii=Ye[Qn])<an&&++bn>ut&&Be("overflow"),ii==an){for(Pi=bn,Zi=36;!(Pi<(Gi=Zi<=Ei?1:Zi>=Ei+26?26:Zi-Ei));Zi+=36)er=Pi-Gi,ji=36-Gi,ri.push(xe(pn(Gi+er%ji,0))),Pi=ge(er/ji);ri.push(xe(pn(Pi,0))),Ei=_n(bn,Hi,Gn==qn),bn=0,++Gn}++bn,++an}return ri.join("")}if($={version:"1.3.2",ucs2:{decode:Ze,encode:je},decode:Un,encode:Dn,toASCII:function(Ye){return qe(Ye,function(an){return kt.test(an)?"xn--"+Dn(an):an})},toUnicode:function(Ye){return qe(Ye,function(an){return It.test(an)?Un(an.slice(4).toLowerCase()):an})}},f&&E)if(T.exports==f)E.exports=$;else for(ot in $)$.hasOwnProperty(ot)&&(f[ot]=$[ot]);else c.punycode=$})(X)}),Nt=function(T){return typeof T=="string"},vt=function(T){return typeof T=="object"&&T!==null},L=function(T){return T===null},I=function(T){return T==null};function F(T,d){return Object.prototype.hasOwnProperty.call(T,d)}var W=function(T,d,c,f){d=d||"&",c=c||"=";var E={};if(typeof T!="string"||T.length===0)return E;var U=/\+/g;T=T.split(d);var $=1e3;f&&typeof f.maxKeys=="number"&&($=f.maxKeys);var ot=T.length;$>0&&ot>$&&(ot=$);for(var ut=0;ut<ot;++ut){var It,kt,he,te,ge=T[ut].replace(U,"%20"),xe=ge.indexOf(c);xe>=0?(It=ge.substr(0,xe),kt=ge.substr(xe+1)):(It=ge,kt=""),he=decodeURIComponent(It),te=decodeURIComponent(kt),F(E,he)?Array.isArray(E[he])?E[he].push(te):E[he]=[E[he],te]:E[he]=te}return E},P=function(T){switch(typeof T){case"string":return T;case"boolean":return T?"true":"false";case"number":return isFinite(T)?T:"";default:return""}},j=function(T,d,c,f){return d=d||"&",c=c||"=",T===null&&(T=void 0),typeof T=="object"?Object.keys(T).map(function(E){var U=encodeURIComponent(P(E))+c;return Array.isArray(T[E])?T[E].map(function($){return U+encodeURIComponent(P($))}).join(d):U+encodeURIComponent(P(T[E]))}).join(d):f?encodeURIComponent(P(f))+c+encodeURIComponent(P(T)):""},Q=J(function(T,d){d.decode=d.parse=W,d.encode=d.stringify=j}),H=Yt,Ot=function(T,d){return Yt(T,!1,!0).resolve(d)},Vt=function(T){return Nt(T)&&(T=Yt(T)),T instanceof st?T.format():st.prototype.format.call(T)};function st(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var V=/^([a-z0-9.+-]+:)/i,k=/:[0-9]*$/,mt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,tt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),_t=["'"].concat(tt),Dt=["%","/","?",";","#"].concat(_t),Z=["/","?","#"],ct=/^[+a-z0-9A-Z_-]{0,63}$/,rt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,yt={javascript:!0,"javascript:":!0},At={javascript:!0,"javascript:":!0},Gt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Yt(T,d,c){if(T&&vt(T)&&T instanceof st)return T;var f=new st;return f.parse(T,d,c),f}st.prototype.parse=function(T,d,c){if(!Nt(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var f=T.indexOf("?"),E=f!==-1&&f<T.indexOf("#")?"?":"#",U=T.split(E);U[0]=U[0].replace(/\\/g,"/");var $=T=U.join(E);if($=$.trim(),!c&&T.split("#").length===1){var ot=mt.exec($);if(ot)return this.path=$,this.href=$,this.pathname=ot[1],ot[2]?(this.search=ot[2],this.query=d?Q.parse(this.search.substr(1)):this.search.substr(1)):d&&(this.search="",this.query={}),this}var ut=V.exec($);if(ut){var It=(ut=ut[0]).toLowerCase();this.protocol=It,$=$.substr(ut.length)}if(c||ut||$.match(/^\/\/[^@\/]+@[^@\/]+/)){var kt=$.substr(0,2)==="//";!kt||ut&&At[ut]||($=$.substr(2),this.slashes=!0)}if(!At[ut]&&(kt||ut&&!Gt[ut])){for(var he,te,ge=-1,xe=0;xe<Z.length;xe++)(Be=$.indexOf(Z[xe]))!==-1&&(ge===-1||Be<ge)&&(ge=Be);for((te=ge===-1?$.lastIndexOf("@"):$.lastIndexOf("@",ge))!==-1&&(he=$.slice(0,te),$=$.slice(te+1),this.auth=decodeURIComponent(he)),ge=-1,xe=0;xe<Dt.length;xe++){var Be;(Be=$.indexOf(Dt[xe]))!==-1&&(ge===-1||Be<ge)&&(ge=Be)}ge===-1&&(ge=$.length),this.host=$.slice(0,ge),$=$.slice(ge),this.parseHost(),this.hostname=this.hostname||"";var Je=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Je)for(var qe=this.hostname.split(/\./),Ze=(xe=0,qe.length);xe<Ze;xe++){var je=qe[xe];if(je&&!je.match(ct)){for(var pn="",_n=0,Un=je.length;_n<Un;_n++)je.charCodeAt(_n)>127?pn+="x":pn+=je[_n];if(!pn.match(ct)){var Dn=qe.slice(0,xe),Ye=qe.slice(xe+1),an=je.match(rt);an&&(Dn.push(an[1]),Ye.unshift(an[2])),Ye.length&&($="/"+Ye.join(".")+$),this.hostname=Dn.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Je||(this.hostname=pt.toASCII(this.hostname));var bn=this.port?":"+this.port:"",Gn=this.hostname||"";this.host=Gn+bn,this.href+=this.host,Je&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),$[0]!=="/"&&($="/"+$))}if(!yt[It])for(xe=0,Ze=_t.length;xe<Ze;xe++){var qn=_t[xe];if($.indexOf(qn)!==-1){var Ei=encodeURIComponent(qn);Ei===qn&&(Ei=escape(qn)),$=$.split(qn).join(Ei)}}var Qn=$.indexOf("#");Qn!==-1&&(this.hash=$.substr(Qn),$=$.slice(0,Qn));var xi=$.indexOf("?");if(xi!==-1?(this.search=$.substr(xi),this.query=$.substr(xi+1),d&&(this.query=Q.parse(this.query)),$=$.slice(0,xi)):d&&(this.search="",this.query={}),$&&(this.pathname=$),Gt[It]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){bn=this.pathname||"";var Pi=this.search||"";this.path=bn+Pi}return this.href=this.format(),this},st.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var d=this.protocol||"",c=this.pathname||"",f=this.hash||"",E=!1,U="";this.host?E=T+this.host:this.hostname&&(E=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(E+=":"+this.port)),this.query&&vt(this.query)&&Object.keys(this.query).length&&(U=Q.stringify(this.query));var $=this.search||U&&"?"+U||"";return d&&d.substr(-1)!==":"&&(d+=":"),this.slashes||(!d||Gt[d])&&E!==!1?(E="//"+(E||""),c&&c.charAt(0)!=="/"&&(c="/"+c)):E||(E=""),f&&f.charAt(0)!=="#"&&(f="#"+f),$&&$.charAt(0)!=="?"&&($="?"+$),d+E+(c=c.replace(/[?#]/g,function(ot){return encodeURIComponent(ot)}))+($=$.replace("#","%23"))+f},st.prototype.resolve=function(T){return this.resolveObject(Yt(T,!1,!0)).format()},st.prototype.resolveObject=function(T){if(Nt(T)){var d=new st;d.parse(T,!1,!0),T=d}for(var c=new st,f=Object.keys(this),E=0;E<f.length;E++){var U=f[E];c[U]=this[U]}if(c.hash=T.hash,T.href==="")return c.href=c.format(),c;if(T.slashes&&!T.protocol){for(var $=Object.keys(T),ot=0;ot<$.length;ot++){var ut=$[ot];ut!=="protocol"&&(c[ut]=T[ut])}return Gt[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c}if(T.protocol&&T.protocol!==c.protocol){if(!Gt[T.protocol]){for(var It=Object.keys(T),kt=0;kt<It.length;kt++){var he=It[kt];c[he]=T[he]}return c.href=c.format(),c}if(c.protocol=T.protocol,T.host||At[T.protocol])c.pathname=T.pathname;else{for(var te=(T.pathname||"").split("/");te.length&&!(T.host=te.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),te[0]!==""&&te.unshift(""),te.length<2&&te.unshift(""),c.pathname=te.join("/")}if(c.search=T.search,c.query=T.query,c.host=T.host||"",c.auth=T.auth,c.hostname=T.hostname||T.host,c.port=T.port,c.pathname||c.search){var ge=c.pathname||"",xe=c.search||"";c.path=ge+xe}return c.slashes=c.slashes||T.slashes,c.href=c.format(),c}var Be=c.pathname&&c.pathname.charAt(0)==="/",Je=T.host||T.pathname&&T.pathname.charAt(0)==="/",qe=Je||Be||c.host&&T.pathname,Ze=qe,je=c.pathname&&c.pathname.split("/")||[],pn=(te=T.pathname&&T.pathname.split("/")||[],c.protocol&&!Gt[c.protocol]);if(pn&&(c.hostname="",c.port=null,c.host&&(je[0]===""?je[0]=c.host:je.unshift(c.host)),c.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(te[0]===""?te[0]=T.host:te.unshift(T.host)),T.host=null),qe=qe&&(te[0]===""||je[0]==="")),Je)c.host=T.host||T.host===""?T.host:c.host,c.hostname=T.hostname||T.hostname===""?T.hostname:c.hostname,c.search=T.search,c.query=T.query,je=te;else if(te.length)je||(je=[]),je.pop(),je=je.concat(te),c.search=T.search,c.query=T.query;else if(!I(T.search))return pn&&(c.hostname=c.host=je.shift(),(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),c.search=T.search,c.query=T.query,L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c;if(!je.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var _n=je.slice(-1)[0],Un=(c.host||T.host||je.length>1)&&(_n==="."||_n==="..")||_n==="",Dn=0,Ye=je.length;Ye>=0;Ye--)(_n=je[Ye])==="."?je.splice(Ye,1):_n===".."?(je.splice(Ye,1),Dn++):Dn&&(je.splice(Ye,1),Dn--);if(!qe&&!Ze)for(;Dn--;Dn)je.unshift("..");!qe||je[0]===""||je[0]&&je[0].charAt(0)==="/"||je.unshift(""),Un&&je.join("/").substr(-1)!=="/"&&je.push("");var an,bn=je[0]===""||je[0]&&je[0].charAt(0)==="/";return pn&&(c.hostname=c.host=bn?"":je.length?je.shift():"",(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),(qe=qe||c.host&&je.length)&&!bn&&je.unshift(""),je.length?c.pathname=je.join("/"):(c.pathname=null,c.path=null),L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=T.auth||c.auth,c.slashes=c.slashes||T.slashes,c.href=c.format(),c},st.prototype.parseHost=function(){var T=this.host,d=k.exec(T);d&&((d=d[0])!==":"&&(this.port=d.substr(1)),T=T.substr(0,T.length-d.length)),T&&(this.hostname=T)};/*!
 * @pixi/utils - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Jt={parse:H,format:Vt,resolve:Ot};R.b.RETINA_PREFIX=/@([0-9\.]+)x/,R.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var at,_e=!1,ke=function(){for(var T=[],d=[],c=0;c<32;c++)T[c]=c,d[c]=c;T[M.b.NORMAL_NPM]=M.b.NORMAL,T[M.b.ADD_NPM]=M.b.ADD,T[M.b.SCREEN_NPM]=M.b.SCREEN,d[M.b.NORMAL]=M.b.NORMAL_NPM,d[M.b.ADD]=M.b.ADD_NPM,d[M.b.SCREEN]=M.b.SCREEN_NPM;var f=[];return f.push(d),f.push(T),f}();function Le(T){if(T.BYTES_PER_ELEMENT===4)return T instanceof Float32Array?"Float32Array":T instanceof Uint32Array?"Uint32Array":"Int32Array";if(T.BYTES_PER_ELEMENT===2){if(T instanceof Uint16Array)return"Uint16Array"}else if(T.BYTES_PER_ELEMENT===1&&T instanceof Uint8Array)return"Uint8Array";return null}function Ae(T){return T+=T===0?1:0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,(T|=T>>>16)+1}function ze(T){return!(T&T-1||!T)}function Qe(T){var d=(T>65535?1:0)<<4,c=((T>>>=d)>255?1:0)<<3;return d|=c,d|=c=((T>>>=c)>15?1:0)<<2,(d|=c=((T>>>=c)>3?1:0)<<1)|(T>>>=c)>>1}var cn=0;function Ue(){return++cn}var Ge={};function Rn(T,d,c){if(c===void 0&&(c=3),!Ge[d]){var f=new Error().stack;f===void 0?console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T):(f=f.split(`
`).splice(c).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",d+`
Deprecated since v`+T),console.warn(f),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T),console.warn(f))),Ge[d]=!0}}var re,fe={},we=Object.create(null),ln=Object.create(null);function In(T,d){if(d===void 0&&(d=globalThis.location),T.indexOf("data:")===0)return"";d=d||globalThis.location,re||(re=document.createElement("a")),re.href=T;var c=Jt.parse(re.href),f=!c.port&&d.port===""||c.port===d.port;return c.hostname===d.hostname&&f&&c.protocol===d.protocol?"":"anonymous"}function Zn(T,d){var c=R.b.RETINA_PREFIX.exec(T);return c?parseFloat(c[1]):d!==void 0?d:1}/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(){function T(d,c,f){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=f||R.b.RESOLUTION,this.resize(d,c)}T.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},T.prototype.resize=function(d,c){this.canvas.width=Math.round(d*this.resolution),this.canvas.height=Math.round(c*this.resolution)},T.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(T.prototype,"width",{get:function(){return this.canvas.width},set:function(d){this.canvas.width=Math.round(d)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this.canvas.height},set:function(d){this.canvas.height=Math.round(d)},enumerable:!1,configurable:!0})})();var gi,tn=function(){function T(d){this.items=[],this._name=d,this._aliasCount=0}return T.prototype.emit=function(d,c,f,E,U,$,ot,ut){if(arguments.length>8)throw new Error("max arguments reached");var It=this,kt=It.name,he=It.items;this._aliasCount++;for(var te=0,ge=he.length;te<ge;te++)he[te][kt](d,c,f,E,U,$,ot,ut);return he===this.items&&this._aliasCount--,this},T.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},T.prototype.add=function(d){return d[this._name]&&(this.ensureNonAliasedItems(),this.remove(d),this.items.push(d)),this},T.prototype.remove=function(d){var c=this.items.indexOf(d);return c!==-1&&(this.ensureNonAliasedItems(),this.items.splice(c,1)),this},T.prototype.contains=function(d){return this.items.indexOf(d)!==-1},T.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},T.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(T.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),T}();Object.defineProperties(tn.prototype,{dispatch:{value:tn.prototype.emit},run:{value:tn.prototype.emit}}),R.b.TARGET_FPMS=.06,function(T){T[T.INTERACTION=50]="INTERACTION",T[T.HIGH=25]="HIGH",T[T.NORMAL=0]="NORMAL",T[T.LOW=-25]="LOW",T[T.UTILITY=-50]="UTILITY"}(gi||(gi={}));var xt,St=function(){function T(d,c,f,E){c===void 0&&(c=null),f===void 0&&(f=0),E===void 0&&(E=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=d,this.context=c,this.priority=f,this.once=E}return T.prototype.match=function(d,c){return c===void 0&&(c=null),this.fn===d&&this.context===c},T.prototype.emit=function(d){this.fn&&(this.context?this.fn.call(this.context,d):this.fn(d));var c=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),c},T.prototype.connect=function(d){this.previous=d,d.next&&(d.next.previous=this),this.next=d.next,d.next=this},T.prototype.destroy=function(d){d===void 0&&(d=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var c=this.next;return this.next=d?null:c,this.previous=null,c},T}(),Rt=function(){function T(){var d=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new St(null,null,1/0),this.deltaMS=1/R.b.TARGET_FPMS,this.elapsedMS=1/R.b.TARGET_FPMS,this._tick=function(c){d._requestId=null,d.started&&(d.update(c),d.started&&d._requestId===null&&d._head.next&&(d._requestId=requestAnimationFrame(d._tick)))}}return T.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},T.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},T.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},T.prototype.add=function(d,c,f){return f===void 0&&(f=gi.NORMAL),this._addListener(new St(d,c,f))},T.prototype.addOnce=function(d,c,f){return f===void 0&&(f=gi.NORMAL),this._addListener(new St(d,c,f,!0))},T.prototype._addListener=function(d){var c=this._head.next,f=this._head;if(c){for(;c;){if(d.priority>c.priority){d.connect(f);break}f=c,c=c.next}d.previous||d.connect(f)}else d.connect(f);return this._startIfPossible(),this},T.prototype.remove=function(d,c){for(var f=this._head.next;f;)f=f.match(d,c)?f.destroy():f.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(T.prototype,"count",{get:function(){if(!this._head)return 0;for(var d=0,c=this._head;c=c.next;)d++;return d},enumerable:!1,configurable:!0}),T.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},T.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},T.prototype.destroy=function(){if(!this._protected){this.stop();for(var d=this._head.next;d;)d=d.destroy(!0);this._head.destroy(),this._head=null}},T.prototype.update=function(d){var c;if(d===void 0&&(d=performance.now()),d>this.lastTime){if((c=this.elapsedMS=d-this.lastTime)>this._maxElapsedMS&&(c=this._maxElapsedMS),c*=this.speed,this._minElapsedMS){var f=d-this._lastFrame|0;if(f<this._minElapsedMS)return;this._lastFrame=d-f%this._minElapsedMS}this.deltaMS=c,this.deltaTime=this.deltaMS*R.b.TARGET_FPMS;for(var E=this._head,U=E.next;U;)U=U.emit(this.deltaTime);E.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=d},Object.defineProperty(T.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(d){var c=Math.min(this.maxFPS,d),f=Math.min(Math.max(0,c)/1e3,R.b.TARGET_FPMS);this._maxElapsedMS=1/f},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(d){if(d===0)this._minElapsedMS=0;else{var c=Math.max(this.minFPS,d);this._minElapsedMS=1/(c/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(T,"shared",{get:function(){if(!T._shared){var d=T._shared=new T;d.autoStart=!0,d._protected=!0}return T._shared},enumerable:!1,configurable:!0}),Object.defineProperty(T,"system",{get:function(){if(!T._system){var d=T._system=new T;d.autoStart=!0,d._protected=!0}return T._system},enumerable:!1,configurable:!0}),T}(),Qt=2*Math.PI;(function(T){T[T.POLY=0]="POLY",T[T.RECT=1]="RECT",T[T.CIRC=2]="CIRC",T[T.ELIP=3]="ELIP",T[T.RREC=4]="RREC"})(xt||(xt={}));var Wt=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this.x=0,this.y=0,this.x=d,this.y=c}return T.prototype.clone=function(){return new T(this.x,this.y)},T.prototype.copyFrom=function(d){return this.set(d.x,d.y),this},T.prototype.copyTo=function(d){return d.set(this.x,this.y),d},T.prototype.equals=function(d){return d.x===this.x&&d.y===this.y},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x=d,this.y=c,this},T.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},T}(),Zt=[new Wt,new Wt,new Wt,new Wt],oe=function(){function T(d,c,f,E){d===void 0&&(d=0),c===void 0&&(c=0),f===void 0&&(f=0),E===void 0&&(E=0),this.x=Number(d),this.y=Number(c),this.width=Number(f),this.height=Number(E),this.type=xt.RECT}return Object.defineProperty(T.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(T,"EMPTY",{get:function(){return new T(0,0,0,0)},enumerable:!1,configurable:!0}),T.prototype.clone=function(){return new T(this.x,this.y,this.width,this.height)},T.prototype.copyFrom=function(d){return this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this},T.prototype.copyTo=function(d){return d.x=this.x,d.y=this.y,d.width=this.width,d.height=this.height,d},T.prototype.contains=function(d,c){return!(this.width<=0||this.height<=0)&&d>=this.x&&d<this.x+this.width&&c>=this.y&&c<this.y+this.height},T.prototype.intersects=function(d,c){if(!c){var f=this.x<d.x?d.x:this.x;if((this.right>d.right?d.right:this.right)<=f)return!1;var E=this.y<d.y?d.y:this.y;return(this.bottom>d.bottom?d.bottom:this.bottom)>E}var U=this.left,$=this.right,ot=this.top,ut=this.bottom;if($<=U||ut<=ot)return!1;var It=Zt[0].set(d.left,d.top),kt=Zt[1].set(d.left,d.bottom),he=Zt[2].set(d.right,d.top),te=Zt[3].set(d.right,d.bottom);if(he.x<=It.x||kt.y<=It.y)return!1;var ge=Math.sign(c.a*c.d-c.b*c.c);if(ge===0||(c.apply(It,It),c.apply(kt,kt),c.apply(he,he),c.apply(te,te),Math.max(It.x,kt.x,he.x,te.x)<=U||Math.min(It.x,kt.x,he.x,te.x)>=$||Math.max(It.y,kt.y,he.y,te.y)<=ot||Math.min(It.y,kt.y,he.y,te.y)>=ut))return!1;var xe=ge*(kt.y-It.y),Be=ge*(It.x-kt.x),Je=xe*U+Be*ot,qe=xe*$+Be*ot,Ze=xe*U+Be*ut,je=xe*$+Be*ut;if(Math.max(Je,qe,Ze,je)<=xe*It.x+Be*It.y||Math.min(Je,qe,Ze,je)>=xe*te.x+Be*te.y)return!1;var pn=ge*(It.y-he.y),_n=ge*(he.x-It.x),Un=pn*U+_n*ot,Dn=pn*$+_n*ot,Ye=pn*U+_n*ut,an=pn*$+_n*ut;return!(Math.max(Un,Dn,Ye,an)<=pn*It.x+_n*It.y||Math.min(Un,Dn,Ye,an)>=pn*te.x+_n*te.y)},T.prototype.pad=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x-=d,this.y-=c,this.width+=2*d,this.height+=2*c,this},T.prototype.fit=function(d){var c=Math.max(this.x,d.x),f=Math.min(this.x+this.width,d.x+d.width),E=Math.max(this.y,d.y),U=Math.min(this.y+this.height,d.y+d.height);return this.x=c,this.width=Math.max(f-c,0),this.y=E,this.height=Math.max(U-E,0),this},T.prototype.ceil=function(d,c){d===void 0&&(d=1),c===void 0&&(c=.001);var f=Math.ceil((this.x+this.width-c)*d)/d,E=Math.ceil((this.y+this.height-c)*d)/d;return this.x=Math.floor((this.x+c)*d)/d,this.y=Math.floor((this.y+c)*d)/d,this.width=f-this.x,this.height=E-this.y,this},T.prototype.enlarge=function(d){var c=Math.min(this.x,d.x),f=Math.max(this.x+this.width,d.x+d.width),E=Math.min(this.y,d.y),U=Math.max(this.y+this.height,d.y+d.height);return this.x=c,this.width=f-c,this.y=E,this.height=U-E,this},T.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},T}(),Me=function(){function T(d,c,f,E){f===void 0&&(f=0),E===void 0&&(E=0),this._x=f,this._y=E,this.cb=d,this.scope=c}return T.prototype.clone=function(d,c){return d===void 0&&(d=this.cb),c===void 0&&(c=this.scope),new T(d,c,this._x,this._y)},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this._x===d&&this._y===c||(this._x=d,this._y=c,this.cb.call(this.scope)),this},T.prototype.copyFrom=function(d){return this._x===d.x&&this._y===d.y||(this._x=d.x,this._y=d.y,this.cb.call(this.scope)),this},T.prototype.copyTo=function(d){return d.set(this._x,this._y),d},T.prototype.equals=function(d){return d.x===this._x&&d.y===this._y},T.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(T.prototype,"x",{get:function(){return this._x},set:function(d){this._x!==d&&(this._x=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"y",{get:function(){return this._y},set:function(d){this._y!==d&&(this._y=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),T}(),Ee=function(){function T(d,c,f,E,U,$){d===void 0&&(d=1),c===void 0&&(c=0),f===void 0&&(f=0),E===void 0&&(E=1),U===void 0&&(U=0),$===void 0&&($=0),this.array=null,this.a=d,this.b=c,this.c=f,this.d=E,this.tx=U,this.ty=$}return T.prototype.fromArray=function(d){this.a=d[0],this.b=d[1],this.c=d[3],this.d=d[4],this.tx=d[2],this.ty=d[5]},T.prototype.set=function(d,c,f,E,U,$){return this.a=d,this.b=c,this.c=f,this.d=E,this.tx=U,this.ty=$,this},T.prototype.toArray=function(d,c){this.array||(this.array=new Float32Array(9));var f=c||this.array;return d?(f[0]=this.a,f[1]=this.b,f[2]=0,f[3]=this.c,f[4]=this.d,f[5]=0,f[6]=this.tx,f[7]=this.ty,f[8]=1):(f[0]=this.a,f[1]=this.c,f[2]=this.tx,f[3]=this.b,f[4]=this.d,f[5]=this.ty,f[6]=0,f[7]=0,f[8]=1),f},T.prototype.apply=function(d,c){c=c||new Wt;var f=d.x,E=d.y;return c.x=this.a*f+this.c*E+this.tx,c.y=this.b*f+this.d*E+this.ty,c},T.prototype.applyInverse=function(d,c){c=c||new Wt;var f=1/(this.a*this.d+this.c*-this.b),E=d.x,U=d.y;return c.x=this.d*f*E+-this.c*f*U+(this.ty*this.c-this.tx*this.d)*f,c.y=this.a*f*U+-this.b*f*E+(-this.ty*this.a+this.tx*this.b)*f,c},T.prototype.translate=function(d,c){return this.tx+=d,this.ty+=c,this},T.prototype.scale=function(d,c){return this.a*=d,this.d*=c,this.c*=d,this.b*=c,this.tx*=d,this.ty*=c,this},T.prototype.rotate=function(d){var c=Math.cos(d),f=Math.sin(d),E=this.a,U=this.c,$=this.tx;return this.a=E*c-this.b*f,this.b=E*f+this.b*c,this.c=U*c-this.d*f,this.d=U*f+this.d*c,this.tx=$*c-this.ty*f,this.ty=$*f+this.ty*c,this},T.prototype.append=function(d){var c=this.a,f=this.b,E=this.c,U=this.d;return this.a=d.a*c+d.b*E,this.b=d.a*f+d.b*U,this.c=d.c*c+d.d*E,this.d=d.c*f+d.d*U,this.tx=d.tx*c+d.ty*E+this.tx,this.ty=d.tx*f+d.ty*U+this.ty,this},T.prototype.setTransform=function(d,c,f,E,U,$,ot,ut,It){return this.a=Math.cos(ot+It)*U,this.b=Math.sin(ot+It)*U,this.c=-Math.sin(ot-ut)*$,this.d=Math.cos(ot-ut)*$,this.tx=d-(f*this.a+E*this.c),this.ty=c-(f*this.b+E*this.d),this},T.prototype.prepend=function(d){var c=this.tx;if(d.a!==1||d.b!==0||d.c!==0||d.d!==1){var f=this.a,E=this.c;this.a=f*d.a+this.b*d.c,this.b=f*d.b+this.b*d.d,this.c=E*d.a+this.d*d.c,this.d=E*d.b+this.d*d.d}return this.tx=c*d.a+this.ty*d.c+d.tx,this.ty=c*d.b+this.ty*d.d+d.ty,this},T.prototype.decompose=function(d){var c=this.a,f=this.b,E=this.c,U=this.d,$=d.pivot,ot=-Math.atan2(-E,U),ut=Math.atan2(f,c),It=Math.abs(ot+ut);return It<1e-5||Math.abs(Qt-It)<1e-5?(d.rotation=ut,d.skew.x=d.skew.y=0):(d.rotation=0,d.skew.x=ot,d.skew.y=ut),d.scale.x=Math.sqrt(c*c+f*f),d.scale.y=Math.sqrt(E*E+U*U),d.position.x=this.tx+($.x*c+$.y*E),d.position.y=this.ty+($.x*f+$.y*U),d},T.prototype.invert=function(){var d=this.a,c=this.b,f=this.c,E=this.d,U=this.tx,$=d*E-c*f;return this.a=E/$,this.b=-c/$,this.c=-f/$,this.d=d/$,this.tx=(f*this.ty-E*U)/$,this.ty=-(d*this.ty-c*U)/$,this},T.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},T.prototype.clone=function(){var d=new T;return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyTo=function(d){return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyFrom=function(d){return this.a=d.a,this.b=d.b,this.c=d.c,this.d=d.d,this.tx=d.tx,this.ty=d.ty,this},T.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(T,"IDENTITY",{get:function(){return new T},enumerable:!1,configurable:!0}),Object.defineProperty(T,"TEMP_MATRIX",{get:function(){return new T},enumerable:!1,configurable:!0}),T}(),Se=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ve=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],en=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],dn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Tn=[],yn=[],Xn=Math.sign;(function(){for(var T=0;T<16;T++){var d=[];Tn.push(d);for(var c=0;c<16;c++)for(var f=Xn(Se[T]*Se[c]+en[T]*Ve[c]),E=Xn(Ve[T]*Se[c]+dn[T]*Ve[c]),U=Xn(Se[T]*en[c]+en[T]*dn[c]),$=Xn(Ve[T]*en[c]+dn[T]*dn[c]),ot=0;ot<16;ot++)if(Se[ot]===f&&Ve[ot]===E&&en[ot]===U&&dn[ot]===$){d.push(ot);break}}for(T=0;T<16;T++){var ut=new Ee;ut.set(Se[T],Ve[T],en[T],dn[T],0,0),yn.push(ut)}})();var Pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(T){return Se[T]},uY:function(T){return Ve[T]},vX:function(T){return en[T]},vY:function(T){return dn[T]},inv:function(T){return 8&T?15&T:7&-T},add:function(T,d){return Tn[T][d]},sub:function(T,d){return Tn[T][Pn.inv(d)]},rotate180:function(T){return 4^T},isVertical:function(T){return(3&T)==2},byDirection:function(T,d){return 2*Math.abs(T)<=Math.abs(d)?d>=0?Pn.S:Pn.N:2*Math.abs(d)<=Math.abs(T)?T>0?Pn.E:Pn.W:d>0?T>0?Pn.SE:Pn.SW:T>0?Pn.NE:Pn.NW},matrixAppendRotationInv:function(T,d,c,f){c===void 0&&(c=0),f===void 0&&(f=0);var E=yn[Pn.inv(d)];E.tx=c,E.ty=f,T.append(E)}};(function(){function T(){this.worldTransform=new Ee,this.localTransform=new Ee,this.position=new Me(this.onChange,this,0,0),this.scale=new Me(this.onChange,this,1,1),this.pivot=new Me(this.onChange,this,0,0),this.skew=new Me(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}T.prototype.onChange=function(){this._localID++},T.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},T.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},T.prototype.updateLocalTransform=function(){var d=this.localTransform;this._localID!==this._currentLocalID&&(d.a=this._cx*this.scale.x,d.b=this._sx*this.scale.x,d.c=this._cy*this.scale.y,d.d=this._sy*this.scale.y,d.tx=this.position.x-(this.pivot.x*d.a+this.pivot.y*d.c),d.ty=this.position.y-(this.pivot.x*d.b+this.pivot.y*d.d),this._currentLocalID=this._localID,this._parentID=-1)},T.prototype.updateTransform=function(d){var c=this.localTransform;if(this._localID!==this._currentLocalID&&(c.a=this._cx*this.scale.x,c.b=this._sx*this.scale.x,c.c=this._cy*this.scale.y,c.d=this._sy*this.scale.y,c.tx=this.position.x-(this.pivot.x*c.a+this.pivot.y*c.c),c.ty=this.position.y-(this.pivot.x*c.b+this.pivot.y*c.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==d._worldID){var f=d.worldTransform,E=this.worldTransform;E.a=c.a*f.a+c.b*f.c,E.b=c.a*f.b+c.b*f.d,E.c=c.c*f.a+c.d*f.c,E.d=c.c*f.b+c.d*f.d,E.tx=c.tx*f.a+c.ty*f.c+f.tx,E.ty=c.tx*f.b+c.ty*f.d+f.ty,this._parentID=d._worldID,this._worldID++}},T.prototype.setFromMatrix=function(d){d.decompose(this),this._localID++},Object.defineProperty(T.prototype,"rotation",{get:function(){return this._rotation},set:function(d){this._rotation!==d&&(this._rotation=d,this.updateSkew())},enumerable:!1,configurable:!0}),T.IDENTITY=new T})(),R.b.PREFER_ENV=R.a.any?M.g.WEBGL:M.g.WEBGL2,R.b.STRICT_TEXTURE_CACHE=!1;var Vi=[];function To(T,d){if(!T)return null;var c="";if(typeof T=="string"){var f=/\.(\w{3,4})(?:$|\?|#)/i.exec(T);f&&(c=f[1].toLowerCase())}for(var E=Vi.length-1;E>=0;--E){var U=Vi[E];if(U.test&&U.test(T,c))return new U(T,d)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var oo=function(T,d){return(oo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var E in f)f.hasOwnProperty(E)&&(c[E]=f[E])})(T,d)};function Fn(T,d){function c(){this.constructor=T}oo(T,d),T.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}var $o=function(){return($o=Object.assign||function(T){for(var d,c=arguments,f=1,E=arguments.length;f<E;f++)for(var U in d=c[f])Object.prototype.hasOwnProperty.call(d,U)&&(T[U]=d[U]);return T}).apply(this,arguments)},so=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this._width=d,this._height=c,this.destroyed=!1,this.internal=!1,this.onResize=new tn("setRealSize"),this.onUpdate=new tn("update"),this.onError=new tn("onError")}return T.prototype.bind=function(d){this.onResize.add(d),this.onUpdate.add(d),this.onError.add(d),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},T.prototype.unbind=function(d){this.onResize.remove(d),this.onUpdate.remove(d),this.onError.remove(d)},T.prototype.resize=function(d,c){d===this._width&&c===this._height||(this._width=d,this._height=c,this.onResize.emit(d,c))},Object.defineProperty(T.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),T.prototype.update=function(){this.destroyed||this.onUpdate.emit()},T.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(T.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),T.prototype.style=function(d,c,f){return!1},T.prototype.dispose=function(){},T.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},T.test=function(d,c){return!1},T}(),wo=function(T){function d(c,f){var E=this,U=f||{},$=U.width,ot=U.height;if(!$||!ot)throw new Error("BufferResource width or height invalid");return(E=T.call(this,$,ot)||this).data=c,E}return Fn(d,T),d.prototype.upload=function(c,f,E){var U=c.gl;U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===M.a.UNPACK);var $=f.realWidth,ot=f.realHeight;return E.width===$&&E.height===ot?U.texSubImage2D(f.target,0,0,0,$,ot,f.format,E.type,this.data):(E.width=$,E.height=ot,U.texImage2D(f.target,0,E.internalFormat,$,ot,0,f.format,E.type,this.data)),!0},d.prototype.dispose=function(){this.data=null},d.test=function(c){return c instanceof Float32Array||c instanceof Uint8Array||c instanceof Uint32Array},d}(so),kn={scaleMode:M.p.NEAREST,format:M.h.RGBA,alphaMode:M.a.NPM},jn=function(T){function d(c,f){c===void 0&&(c=null),f===void 0&&(f=null);var E=T.call(this)||this,U=(f=f||{}).alphaMode,$=f.mipmap,ot=f.anisotropicLevel,ut=f.scaleMode,It=f.width,kt=f.height,he=f.wrapMode,te=f.format,ge=f.type,xe=f.target,Be=f.resolution,Je=f.resourceOptions;return!c||c instanceof so||((c=To(c,Je)).internal=!0),E.resolution=Be||R.b.RESOLUTION,E.width=Math.round((It||0)*E.resolution)/E.resolution,E.height=Math.round((kt||0)*E.resolution)/E.resolution,E._mipmap=$!==void 0?$:R.b.MIPMAP_TEXTURES,E.anisotropicLevel=ot!==void 0?ot:R.b.ANISOTROPIC_LEVEL,E._wrapMode=he||R.b.WRAP_MODE,E._scaleMode=ut!==void 0?ut:R.b.SCALE_MODE,E.format=te||M.h.RGBA,E.type=ge||M.r.UNSIGNED_BYTE,E.target=xe||M.q.TEXTURE_2D,E.alphaMode=U!==void 0?U:M.a.UNPACK,E.uid=Ue(),E.touched=0,E.isPowerOfTwo=!1,E._refreshPOT(),E._glTextures={},E.dirtyId=0,E.dirtyStyleId=0,E.cacheId=null,E.valid=It>0&&kt>0,E.textureCacheIds=[],E.destroyed=!1,E.resource=null,E._batchEnabled=0,E._batchLocation=0,E.parentTextureArray=null,E.setResource(c),E}return Fn(d,T),Object.defineProperty(d.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mipmap",{get:function(){return this._mipmap},set:function(c){this._mipmap!==c&&(this._mipmap=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(c){this._scaleMode!==c&&(this._scaleMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(c){this._wrapMode!==c&&(this._wrapMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),d.prototype.setStyle=function(c,f){var E;return c!==void 0&&c!==this.scaleMode&&(this.scaleMode=c,E=!0),f!==void 0&&f!==this.mipmap&&(this.mipmap=f,E=!0),E&&this.dirtyStyleId++,this},d.prototype.setSize=function(c,f,E){return E=E||this.resolution,this.setRealSize(c*E,f*E,E)},d.prototype.setRealSize=function(c,f,E){return this.resolution=E||this.resolution,this.width=Math.round(c)/this.resolution,this.height=Math.round(f)/this.resolution,this._refreshPOT(),this.update(),this},d.prototype._refreshPOT=function(){this.isPowerOfTwo=ze(this.realWidth)&&ze(this.realHeight)},d.prototype.setResolution=function(c){var f=this.resolution;return f===c||(this.resolution=c,this.valid&&(this.width=Math.round(this.width*f)/c,this.height=Math.round(this.height*f)/c,this.emit("update",this)),this._refreshPOT()),this},d.prototype.setResource=function(c){if(this.resource===c)return this;if(this.resource)throw new Error("Resource can be set only once");return c.bind(this),this.resource=c,this},d.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},d.prototype.onError=function(c){this.emit("error",this,c)},d.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ln[this.cacheId],delete we[this.cacheId],this.cacheId=null),this.dispose(),d.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},d.prototype.dispose=function(){this.emit("dispose",this)},d.prototype.castToBaseTexture=function(){return this},d.from=function(c,f,E){E===void 0&&(E=R.b.STRICT_TEXTURE_CACHE);var U=typeof c=="string",$=null;if(U)$=c;else{if(!c._pixiId){var ot=f&&f.pixiIdPrefix||"pixiid";c._pixiId=ot+"_"+Ue()}$=c._pixiId}var ut=ln[$];if(U&&E&&!ut)throw new Error('The cacheId "'+$+'" does not exist in BaseTextureCache.');return ut||((ut=new d(c,f)).cacheId=$,d.addToCache(ut,$)),ut},d.fromBuffer=function(c,f,E,U){c=c||new Float32Array(f*E*4);var $=new wo(c,{width:f,height:E}),ot=c instanceof Float32Array?M.r.FLOAT:M.r.UNSIGNED_BYTE;return new d($,Object.assign(kn,U||{width:f,height:E,type:ot}))},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),ln[f]&&console.warn("BaseTexture added to the cache with an id ["+f+"] that already had an entry"),ln[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=ln[c];if(f){var E=f.textureCacheIds.indexOf(c);return E>-1&&f.textureCacheIds.splice(E,1),delete ln[c],f}}else if(c&&c.textureCacheIds){for(var U=0;U<c.textureCacheIds.length;++U)delete ln[c.textureCacheIds[U]];return c.textureCacheIds.length=0,c}return null},d._globalBatch=0,d}(et),Qi=function(T){function d(c,f){var E=this,U=f||{},$=U.width,ot=U.height;(E=T.call(this,$,ot)||this).items=[],E.itemDirtyIds=[];for(var ut=0;ut<c;ut++){var It=new jn;E.items.push(It),E.itemDirtyIds.push(-2)}return E.length=c,E._load=null,E.baseTexture=null,E}return Fn(d,T),d.prototype.initFromArray=function(c,f){for(var E=0;E<this.length;E++)c[E]&&(c[E].castToBaseTexture?this.addBaseTextureAt(c[E].castToBaseTexture(),E):c[E]instanceof so?this.addResourceAt(c[E],E):this.addResourceAt(To(c[E],f),E))},d.prototype.dispose=function(){for(var c=0,f=this.length;c<f;c++)this.items[c].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},d.prototype.addResourceAt=function(c,f){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");return c.valid&&!this.valid&&this.resize(c.width,c.height),this.items[f].setResource(c),this},d.prototype.bind=function(c){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");T.prototype.bind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=c,this.items[f].on("update",c.update,c)},d.prototype.unbind=function(c){T.prototype.unbind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=null,this.items[f].off("update",c.update,c)},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.items.map(function(E){return E.resource}).filter(function(E){return E}).map(function(E){return E.load()});return this._load=Promise.all(f).then(function(){var E=c.items[0],U=E.realWidth,$=E.realHeight;return c.resize(U,$),Promise.resolve(c)}),this._load},d}(so),Yr=function(T){function d(c,f){var E,U,$=this,ot=f||{},ut=ot.width,It=ot.height;return Array.isArray(c)?(E=c,U=c.length):U=c,$=T.call(this,U,{width:ut,height:It})||this,E&&$.initFromArray(E,f),$}return Fn(d,T),d.prototype.addBaseTextureAt=function(c,f){if(!c.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(c.resource,f),this},d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=M.q.TEXTURE_2D_ARRAY},d.prototype.upload=function(c,f,E){var U=this.length,$=this.itemDirtyIds,ot=this.items,ut=c.gl;E.dirtyId<0&&ut.texImage3D(ut.TEXTURE_2D_ARRAY,0,E.internalFormat,this._width,this._height,U,0,f.format,E.type,null);for(var It=0;It<U;It++){var kt=ot[It];$[It]<kt.dirtyId&&($[It]=kt.dirtyId,kt.valid&&ut.texSubImage3D(ut.TEXTURE_2D_ARRAY,0,0,0,It,kt.resource.width,kt.resource.height,1,f.format,E.type,kt.resource.source))}return!0},d}(Qi),Ri=function(T){function d(c){var f=this,E=c,U=E.naturalWidth||E.videoWidth||E.width,$=E.naturalHeight||E.videoHeight||E.height;return(f=T.call(this,U,$)||this).source=c,f.noSubImage=!1,f}return Fn(d,T),d.crossOrigin=function(c,f,E){E===void 0&&f.indexOf("data:")!==0?c.crossOrigin=In(f):E!==!1&&(c.crossOrigin=typeof E=="string"?E:"anonymous")},d.prototype.upload=function(c,f,E,U){var $=c.gl,ot=f.realWidth,ut=f.realHeight;if((U=U||this.source)instanceof HTMLImageElement){if(!U.complete||U.naturalWidth===0)return!1}else if(U instanceof HTMLVideoElement&&U.readyState<=1)return!1;return $.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===M.a.UNPACK),this.noSubImage||f.target!==$.TEXTURE_2D||E.width!==ot||E.height!==ut?(E.width=ot,E.height=ut,$.texImage2D(f.target,0,E.internalFormat,f.format,E.type,U)):$.texSubImage2D($.TEXTURE_2D,0,0,0,f.format,E.type,U),!0},d.prototype.update=function(){if(!this.destroyed){var c=this.source,f=c.naturalWidth||c.videoWidth||c.width,E=c.naturalHeight||c.videoHeight||c.height;this.resize(f,E),T.prototype.update.call(this)}},d.prototype.dispose=function(){this.source=null},d}(so),Mr=function(T){function d(c){return T.call(this,c)||this}return Fn(d,T),d.test=function(c){var f=globalThis.OffscreenCanvas;return!!(f&&c instanceof f)||globalThis.HTMLCanvasElement&&c instanceof HTMLCanvasElement},d}(Ri),Dr=function(T){function d(c,f){var E=this,U=f||{},$=U.width,ot=U.height,ut=U.autoLoad,It=U.linkBaseTexture;if(c&&c.length!==d.SIDES)throw new Error("Invalid length. Got "+c.length+", expected 6");E=T.call(this,6,{width:$,height:ot})||this;for(var kt=0;kt<d.SIDES;kt++)E.items[kt].target=M.q.TEXTURE_CUBE_MAP_POSITIVE_X+kt;return E.linkBaseTexture=It!==!1,c&&E.initFromArray(c,f),ut!==!1&&E.load(),E}return Fn(d,T),d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=M.q.TEXTURE_CUBE_MAP},d.prototype.addBaseTextureAt=function(c,f,E){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");if(!this.linkBaseTexture||c.parentTextureArray||Object.keys(c._glTextures).length>0){if(!c.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(c.resource,f)}else c.target=M.q.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.parentTextureArray=this.baseTexture,this.items[f]=c;return c.valid&&!this.valid&&this.resize(c.realWidth,c.realHeight),this.items[f]=c,this},d.prototype.upload=function(c,f,E){for(var U=this.itemDirtyIds,$=0;$<d.SIDES;$++){var ot=this.items[$];U[$]<ot.dirtyId&&(ot.valid&&ot.resource?(ot.resource.upload(c,ot,E),U[$]=ot.dirtyId):U[$]<-1&&(c.gl.texImage2D(ot.target,0,E.internalFormat,f.realWidth,f.realHeight,0,f.format,E.type,null),U[$]=-1))}return!0},d.test=function(c){return Array.isArray(c)&&c.length===d.SIDES},d.SIDES=6,d}(Qi),Qo=function(T){function d(c,f){var E=this;if(f=f||{},!(c instanceof HTMLImageElement)){var U=new Image;Ri.crossOrigin(U,c,f.crossorigin),U.src=c,c=U}return E=T.call(this,c)||this,!c.complete&&E._width&&E._height&&(E._width=0,E._height=0),E.url=c.src,E._process=null,E.preserveBitmap=!1,E.createBitmap=(f.createBitmap!==void 0?f.createBitmap:R.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,E.alphaMode=typeof f.alphaMode=="number"?f.alphaMode:null,E.bitmap=null,E._load=null,f.autoLoad!==!1&&E.load(),E}return Fn(d,T),d.prototype.load=function(c){var f=this;return this._load||(c!==void 0&&(this.createBitmap=c),this._load=new Promise(function(E,U){var $=f.source;f.url=$.src;var ot=function(){f.destroyed||($.onload=null,$.onerror=null,f.resize($.width,$.height),f._load=null,f.createBitmap?E(f.process()):E(f))};$.complete&&$.src?ot():($.onload=ot,$.onerror=function(ut){U(ut),f.onError.emit(ut)})})),this._load},d.prototype.process=function(){var c=this,f=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var E=globalThis.createImageBitmap,U=!f.crossOrigin||f.crossOrigin==="anonymous";return this._process=fetch(f.src,{mode:U?"cors":"no-cors"}).then(function($){return $.blob()}).then(function($){return E($,0,0,f.width,f.height,{premultiplyAlpha:c.alphaMode===M.a.UNPACK?"premultiply":"none"})}).then(function($){return c.destroyed?Promise.reject():(c.bitmap=$,c.update(),c._process=null,Promise.resolve(c))}),this._process},d.prototype.upload=function(c,f,E){if(typeof this.alphaMode=="number"&&(f.alphaMode=this.alphaMode),!this.createBitmap)return T.prototype.upload.call(this,c,f,E);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(T.prototype.upload.call(this,c,f,E,this.bitmap),!this.preserveBitmap){var U=!0,$=f._glTextures;for(var ot in $){var ut=$[ot];if(ut!==E&&ut.dirtyId!==f.dirtyId){U=!1;break}}U&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},d.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,T.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},d.test=function(c){return typeof c=="string"||c instanceof HTMLImageElement},d}(Ri),ts=function(T){function d(c,f){var E=this;return f=f||{},(E=T.call(this,document.createElement("canvas"))||this)._width=0,E._height=0,E.svg=c,E.scale=f.scale||1,E._overrideWidth=f.width,E._overrideHeight=f.height,E._resolve=null,E._crossorigin=f.crossorigin,E._load=null,f.autoLoad!==!1&&E.load(),E}return Fn(d,T),d.prototype.load=function(){var c=this;return this._load||(this._load=new Promise(function(f){if(c._resolve=function(){c.resize(c.source.width,c.source.height),f(c)},d.SVG_XML.test(c.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");c.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c.svg)))}c._loadSvg()})),this._load},d.prototype._loadSvg=function(){var c=this,f=new Image;Ri.crossOrigin(f,this.svg,this._crossorigin),f.src=this.svg,f.onerror=function(E){c._resolve&&(f.onerror=null,c.onError.emit(E))},f.onload=function(){if(c._resolve){var E=f.width,U=f.height;if(!E||!U)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var $=E*c.scale,ot=U*c.scale;(c._overrideWidth||c._overrideHeight)&&($=c._overrideWidth||c._overrideHeight/U*E,ot=c._overrideHeight||c._overrideWidth/E*U),$=Math.round($),ot=Math.round(ot);var ut=c.source;ut.width=$,ut.height=ot,ut._pixiId="canvas_"+Ue(),ut.getContext("2d").drawImage(f,0,0,E,U,0,0,$,ot),c._resolve(),c._resolve=null}}},d.getSize=function(c){var f=d.SVG_SIZE.exec(c),E={};return f&&(E[f[1]]=Math.round(parseFloat(f[3])),E[f[5]]=Math.round(parseFloat(f[7]))),E},d.prototype.dispose=function(){T.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},d.test=function(c,f){return f==="svg"||typeof c=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(c)||typeof c=="string"&&d.SVG_XML.test(c)},d.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,d.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,d}(Ri),So=function(T){function d(c,f){var E=this;if(f=f||{},!(c instanceof HTMLVideoElement)){var U=document.createElement("video");U.setAttribute("preload","auto"),U.setAttribute("webkit-playsinline",""),U.setAttribute("playsinline",""),typeof c=="string"&&(c=[c]);var $=c[0].src||c[0];Ri.crossOrigin(U,$,f.crossorigin);for(var ot=0;ot<c.length;++ot){var ut=document.createElement("source"),It=c[ot],kt=It.src,he=It.mime,te=(kt=kt||c[ot]).split("?").shift().toLowerCase(),ge=te.slice(te.lastIndexOf(".")+1);he=he||d.MIME_TYPES[ge]||"video/"+ge,ut.src=kt,ut.type=he,U.appendChild(ut)}c=U}return(E=T.call(this,c)||this).noSubImage=!0,E._autoUpdate=!0,E._isConnectedToTicker=!1,E._updateFPS=f.updateFPS||0,E._msToNextUpdate=0,E.autoPlay=f.autoPlay!==!1,E._load=null,E._resolve=null,E._onCanPlay=E._onCanPlay.bind(E),E._onError=E._onError.bind(E),f.autoLoad!==!1&&E.load(),E}return Fn(d,T),d.prototype.update=function(c){if(!this.destroyed){var f=Rt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-f),(!this._updateFPS||this._msToNextUpdate<=0)&&(T.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.source;return(f.readyState===f.HAVE_ENOUGH_DATA||f.readyState===f.HAVE_FUTURE_DATA)&&f.width&&f.height&&(f.complete=!0),f.addEventListener("play",this._onPlayStart.bind(this)),f.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(f.addEventListener("canplay",this._onCanPlay),f.addEventListener("canplaythrough",this._onCanPlay),f.addEventListener("error",this._onError,!0)),this._load=new Promise(function(E){c.valid?E(c):(c._resolve=E,f.load())}),this._load},d.prototype._onError=function(c){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(c)},d.prototype._isSourcePlaying=function(){var c=this.source;return c.currentTime>0&&c.paused===!1&&c.ended===!1&&c.readyState>2},d.prototype._isSourceReady=function(){var c=this.source;return c.readyState===3||c.readyState===4},d.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Rt.shared.add(this.update,this),this._isConnectedToTicker=!0)},d.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1)},d.prototype._onCanPlay=function(){var c=this.source;c.removeEventListener("canplay",this._onCanPlay),c.removeEventListener("canplaythrough",this._onCanPlay);var f=this.valid;this.resize(c.videoWidth,c.videoHeight),!f&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&c.play()},d.prototype.dispose=function(){this._isConnectedToTicker&&(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1);var c=this.source;c&&(c.removeEventListener("error",this._onError,!0),c.pause(),c.src="",c.load()),T.prototype.dispose.call(this)},Object.defineProperty(d.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(c){c!==this._autoUpdate&&(this._autoUpdate=c,!this._autoUpdate&&this._isConnectedToTicker?(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Rt.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(c){c!==this._updateFPS&&(this._updateFPS=c)},enumerable:!1,configurable:!0}),d.test=function(c,f){return globalThis.HTMLVideoElement&&c instanceof HTMLVideoElement||d.TYPES.indexOf(f)>-1},d.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],d.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},d}(Ri),Eo=function(T){function d(c){return T.call(this,c)||this}return Fn(d,T),d.test=function(c){return!!globalThis.createImageBitmap&&c instanceof ImageBitmap},d}(Ri);Vi.push(Qo,Eo,Mr,So,ts,wo,Dr,Yr);var di=function(T){function d(){return T!==null&&T.apply(this,arguments)||this}return Fn(d,T),d.prototype.upload=function(c,f,E){var U=c.gl;U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===M.a.UNPACK);var $=f.realWidth,ot=f.realHeight;return E.width===$&&E.height===ot?U.texSubImage2D(f.target,0,0,0,$,ot,f.format,E.type,this.data):(E.width=$,E.height=ot,U.texImage2D(f.target,0,E.internalFormat,$,ot,0,f.format,E.type,this.data)),!0},d}(wo),es=function(){function T(d,c){this.width=Math.round(d||100),this.height=Math.round(c||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new tn("disposeFramebuffer"),this.multisample=M.l.NONE}return Object.defineProperty(T.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),T.prototype.addColorTexture=function(d,c){return d===void 0&&(d=0),this.colorTextures[d]=c||new jn(null,{scaleMode:M.p.NEAREST,resolution:1,mipmap:M.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.addDepthTexture=function(d){return this.depthTexture=d||new jn(new di(null,{width:this.width,height:this.height}),{scaleMode:M.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:M.k.OFF,format:M.h.DEPTH_COMPONENT,type:M.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.resize=function(d,c){if(d=Math.round(d),c=Math.round(c),d!==this.width||c!==this.height){this.width=d,this.height=c,this.dirtyId++,this.dirtySize++;for(var f=0;f<this.colorTextures.length;f++){var E=this.colorTextures[f],U=E.resolution;E.setSize(d/U,c/U)}this.depthTexture&&(U=this.depthTexture.resolution,this.depthTexture.setSize(d/U,c/U))}},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},T}(),Ii=function(T){function d(c){c===void 0&&(c={});var f=this;if(typeof c=="number"){var E=arguments[0],U=arguments[1],$=arguments[2],ot=arguments[3];c={width:E,height:U,scaleMode:$,resolution:ot}}return c.width=c.width||100,c.height=c.height||100,c.multisample=c.multisample!==void 0?c.multisample:M.l.NONE,(f=T.call(this,null,c)||this).mipmap=M.k.OFF,f.valid=!0,f.clearColor=[0,0,0,0],f.framebuffer=new es(f.realWidth,f.realHeight).addColorTexture(0,f),f.framebuffer.multisample=c.multisample,f.maskStack=[],f.filterStack=[{}],f}return Fn(d,T),d.prototype.resize=function(c,f){this.framebuffer.resize(c*this.resolution,f*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},d.prototype.dispose=function(){this.framebuffer.dispose(),T.prototype.dispose.call(this)},d.prototype.destroy=function(){T.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},d}(jn),_r=function(){function T(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return T.prototype.set=function(d,c,f){var E=c.width,U=c.height;if(f){var $=d.width/2/E,ot=d.height/2/U,ut=d.x/E+$,It=d.y/U+ot;f=Pn.add(f,Pn.NW),this.x0=ut+$*Pn.uX(f),this.y0=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x1=ut+$*Pn.uX(f),this.y1=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x2=ut+$*Pn.uX(f),this.y2=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x3=ut+$*Pn.uX(f),this.y3=It+ot*Pn.uY(f)}else this.x0=d.x/E,this.y0=d.y/U,this.x1=(d.x+d.width)/E,this.y1=d.y/U,this.x2=(d.x+d.width)/E,this.y2=(d.y+d.height)/U,this.x3=d.x/E,this.y3=(d.y+d.height)/U;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},T.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},T}(),Li=new _r;function Fr(T){T.destroy=function(){},T.on=function(){},T.once=function(){},T.emit=function(){}}var Ao=function(T){function d(c,f,E,U,$,ot){var ut=T.call(this)||this;if(ut.noFrame=!1,f||(ut.noFrame=!0,f=new oe(0,0,1,1)),c instanceof d&&(c=c.baseTexture),ut.baseTexture=c,ut._frame=f,ut.trim=U,ut.valid=!1,ut._uvs=Li,ut.uvMatrix=null,ut.orig=E||f,ut._rotate=Number($||0),$===!0)ut._rotate=2;else if(ut._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return ut.defaultAnchor=ot?new Wt(ot.x,ot.y):new Wt(0,0),ut._updateID=0,ut.textureCacheIds=[],c.valid?ut.noFrame?c.valid&&ut.onBaseTextureUpdated(c):ut.frame=f:c.once("loaded",ut.onBaseTextureUpdated,ut),ut.noFrame&&c.on("update",ut.onBaseTextureUpdated,ut),ut}return Fn(d,T),d.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},d.prototype.onBaseTextureUpdated=function(c){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=c.width,this._frame.height=c.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},d.prototype.destroy=function(c){if(this.baseTexture){if(c){var f=this.baseTexture.resource;f&&f.url&&we[f.url]&&d.removeFromCache(f.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,d.removeFromCache(this),this.textureCacheIds=null},d.prototype.clone=function(){var c=this._frame.clone(),f=this._frame===this.orig?c:this.orig.clone(),E=new d(this.baseTexture,!this.noFrame&&c,f,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(E._frame=c),E},d.prototype.updateUvs=function(){this._uvs===Li&&(this._uvs=new _r),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},d.from=function(c,f,E){f===void 0&&(f={}),E===void 0&&(E=R.b.STRICT_TEXTURE_CACHE);var U=typeof c=="string",$=null;if(U)$=c;else if(c instanceof jn){if(!c.cacheId){var ot=f&&f.pixiIdPrefix||"pixiid";c.cacheId=ot+"-"+Ue(),jn.addToCache(c,c.cacheId)}$=c.cacheId}else c._pixiId||(ot=f&&f.pixiIdPrefix||"pixiid",c._pixiId=ot+"_"+Ue()),$=c._pixiId;var ut=we[$];if(U&&E&&!ut)throw new Error('The cacheId "'+$+'" does not exist in TextureCache.');return ut||c instanceof jn?!ut&&c instanceof jn&&(ut=new d(c),d.addToCache(ut,$)):(f.resolution||(f.resolution=Zn(c)),(ut=new d(new jn(c,f))).baseTexture.cacheId=$,jn.addToCache(ut.baseTexture,$),d.addToCache(ut,$)),ut},d.fromURL=function(c,f){var E=Object.assign({autoLoad:!1},f==null?void 0:f.resourceOptions),U=d.from(c,Object.assign({resourceOptions:E},f),!1),$=U.baseTexture.resource;return U.baseTexture.valid?Promise.resolve(U):$.load().then(function(){return Promise.resolve(U)})},d.fromBuffer=function(c,f,E,U){return new d(jn.fromBuffer(c,f,E,U))},d.fromLoader=function(c,f,E,U){var $=new jn(c,Object.assign({scaleMode:R.b.SCALE_MODE,resolution:Zn(f)},U)),ot=$.resource;ot instanceof Qo&&(ot.url=f);var ut=new d($);return E||(E=f),jn.addToCache(ut.baseTexture,E),d.addToCache(ut,E),E!==f&&(jn.addToCache(ut.baseTexture,f),d.addToCache(ut,f)),ut.baseTexture.valid?Promise.resolve(ut):new Promise(function(It){ut.baseTexture.once("loaded",function(){return It(ut)})})},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),we[f]&&console.warn("Texture added to the cache with an id ["+f+"] that already had an entry"),we[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=we[c];if(f){var E=f.textureCacheIds.indexOf(c);return E>-1&&f.textureCacheIds.splice(E,1),delete we[c],f}}else if(c&&c.textureCacheIds){for(var U=0;U<c.textureCacheIds.length;++U)we[c.textureCacheIds[U]]===c&&delete we[c.textureCacheIds[U]];return c.textureCacheIds.length=0,c}return null},Object.defineProperty(d.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"frame",{get:function(){return this._frame},set:function(c){this._frame=c,this.noFrame=!1;var f=c.x,E=c.y,U=c.width,$=c.height,ot=f+U>this.baseTexture.width,ut=E+$>this.baseTexture.height;if(ot||ut){var It=ot&&ut?"and":"or",kt="X: "+f+" + "+U+" = "+(f+U)+" > "+this.baseTexture.width,he="Y: "+E+" + "+$+" = "+(E+$)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+kt+" "+It+" "+he)}this.valid=U&&$&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=c),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"rotate",{get:function(){return this._rotate},set:function(c){this._rotate=c,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),d.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(d,"EMPTY",{get:function(){return d._EMPTY||(d._EMPTY=new d(new jn),Fr(d._EMPTY),Fr(d._EMPTY.baseTexture)),d._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(d,"WHITE",{get:function(){if(!d._WHITE){var c=document.createElement("canvas"),f=c.getContext("2d");c.width=16,c.height=16,f.fillStyle="white",f.fillRect(0,0,16,16),d._WHITE=new d(new jn(new Mr(c))),Fr(d._WHITE),Fr(d._WHITE.baseTexture)}return d._WHITE},enumerable:!1,configurable:!0}),d}(et),ao=function(T){function d(c,f){var E=T.call(this,c,f)||this;return E.valid=!0,E.filterFrame=null,E.filterPoolKey=null,E.updateUvs(),E}return Fn(d,T),Object.defineProperty(d.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(c){this.framebuffer.multisample=c},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f,E){E===void 0&&(E=!0);var U=this.baseTexture.resolution,$=Math.round(c*U)/U,ot=Math.round(f*U)/U;this.valid=$>0&&ot>0,this._frame.width=this.orig.width=$,this._frame.height=this.orig.height=ot,E&&this.baseTexture.resize($,ot),this.updateUvs()},d.prototype.setResolution=function(c){var f=this.baseTexture;f.resolution!==c&&(f.setResolution(c),this.resize(f.width,f.height,!1))},d.create=function(c){for(var f=arguments,E=[],U=1;U<arguments.length;U++)E[U-1]=f[U];return typeof c=="number"&&(Rn("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),c={width:c,height:E[0],scaleMode:E[1],resolution:E[2]}),new d(new Ii(c))},d}(Ao),Mo=function(){function T(d){this.texturePool={},this.textureOptions=d||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return T.prototype.createTexture=function(d,c,f){f===void 0&&(f=M.l.NONE);var E=new Ii(Object.assign({width:d,height:c,resolution:1,multisample:f},this.textureOptions));return new ao(E)},T.prototype.getOptimalTexture=function(d,c,f,E){var U;f===void 0&&(f=1),E===void 0&&(E=M.l.NONE),d=Math.ceil(d*f-1e-6),c=Math.ceil(c*f-1e-6),this.enableFullScreen&&d===this._pixelsWidth&&c===this._pixelsHeight?U=E>1?-E:-1:(U=((65535&(d=Ae(d)))<<16|65535&(c=Ae(c)))>>>0,E>1&&(U+=4294967296*E)),this.texturePool[U]||(this.texturePool[U]=[]);var $=this.texturePool[U].pop();return $||($=this.createTexture(d,c,E)),$.filterPoolKey=U,$.setResolution(f),$},T.prototype.getFilterTexture=function(d,c,f){var E=this.getOptimalTexture(d.width,d.height,c||d.resolution,f||M.l.NONE);return E.filterFrame=d.filterFrame,E},T.prototype.returnTexture=function(d){var c=d.filterPoolKey;d.filterFrame=null,this.texturePool[c].push(d)},T.prototype.returnFilterTexture=function(d){this.returnTexture(d)},T.prototype.clear=function(d){if(d=d!==!1)for(var c in this.texturePool){var f=this.texturePool[c];if(f)for(var E=0;E<f.length;E++)f[E].destroy(!0)}this.texturePool={}},T.prototype.setScreenSize=function(d){if(d.width!==this._pixelsWidth||d.height!==this._pixelsHeight){for(var c in this.enableFullScreen=d.width>0&&d.height>0,this.texturePool)if(Number(c)<0){var f=this.texturePool[c];if(f)for(var E=0;E<f.length;E++)f[E].destroy(!0);this.texturePool[c]=[]}this._pixelsWidth=d.width,this._pixelsHeight=d.height}},T.SCREEN_KEY=-1,T}(),fn=function(){function T(d,c,f,E,U,$,ot){c===void 0&&(c=0),f===void 0&&(f=!1),E===void 0&&(E=M.r.FLOAT),this.buffer=d,this.size=c,this.normalized=f,this.type=E,this.stride=U,this.start=$,this.instance=ot}return T.prototype.destroy=function(){this.buffer=null},T.from=function(d,c,f,E,U){return new T(d,c,f,E,U)},T}(),tr=0,Mn=function(){function T(d,c,f){c===void 0&&(c=!0),f===void 0&&(f=!1),this.data=d||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=f,this.static=c,this.id=tr++,this.disposeRunner=new tn("disposeBuffer")}return T.prototype.update=function(d){d instanceof Array&&(d=new Float32Array(d)),this.data=d||this.data,this._updateID++},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(T.prototype,"index",{get:function(){return this.type===M.d.ELEMENT_ARRAY_BUFFER},set:function(d){this.type=d?M.d.ELEMENT_ARRAY_BUFFER:M.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),T.from=function(d){return d instanceof Array&&(d=new Float32Array(d)),new T(d)},T}(),Co={Float32Array,Uint32Array,Int32Array,Uint8Array},Yn={5126:4,5123:2,5121:1},Ss=0,ma={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Ro=function(){function T(d,c){d===void 0&&(d=[]),c===void 0&&(c={}),this.buffers=d,this.indexBuffer=null,this.attributes=c,this.glVertexArrayObjects={},this.id=Ss++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new tn("disposeGeometry"),this.refCount=0}return T.prototype.addAttribute=function(d,c,f,E,U,$,ot,ut){if(f===void 0&&(f=0),E===void 0&&(E=!1),ut===void 0&&(ut=!1),!c)throw new Error("You must pass a buffer when creating an attribute");c instanceof Mn||(c instanceof Array&&(c=new Float32Array(c)),c=new Mn(c));var It=d.split("|");if(It.length>1){for(var kt=0;kt<It.length;kt++)this.addAttribute(It[kt],c,f,E,U);return this}var he=this.buffers.indexOf(c);return he===-1&&(this.buffers.push(c),he=this.buffers.length-1),this.attributes[d]=new fn(he,f,E,U,$,ot,ut),this.instanced=this.instanced||ut,this},T.prototype.getAttribute=function(d){return this.attributes[d]},T.prototype.getBuffer=function(d){return this.buffers[this.getAttribute(d).buffer]},T.prototype.addIndex=function(d){return d instanceof Mn||(d instanceof Array&&(d=new Uint16Array(d)),d=new Mn(d)),d.type=M.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=d,this.buffers.indexOf(d)===-1&&this.buffers.push(d),this},T.prototype.getIndex=function(){return this.indexBuffer},T.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var d,c=[],f=[],E=new Mn;for(d in this.attributes){var U=this.attributes[d],$=this.buffers[U.buffer];c.push($.data),f.push(U.size*Yn[U.type]/4),U.buffer=0}for(E.data=function(ot,ut){for(var It=0,kt=0,he={},te=0;te<ot.length;te++)kt+=ut[te],It+=ot[te].length;var ge=new ArrayBuffer(4*It),xe=null,Be=0;for(te=0;te<ot.length;te++){var Je=ut[te],qe=ot[te],Ze=Le(qe);he[Ze]||(he[Ze]=new Co[Ze](ge)),xe=he[Ze];for(var je=0;je<qe.length;je++)xe[(je/Je|0)*kt+Be+je%Je]=qe[je];Be+=Je}return new Float32Array(ge)}(c,f),d=0;d<this.buffers.length;d++)this.buffers[d]!==this.indexBuffer&&this.buffers[d].destroy();return this.buffers=[E],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},T.prototype.getSize=function(){for(var d in this.attributes){var c=this.attributes[d];return this.buffers[c.buffer].data.length/(c.stride/4||c.size)}return 0},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},T.prototype.clone=function(){for(var d=new T,c=0;c<this.buffers.length;c++)d.buffers[c]=new Mn(this.buffers[c].data.slice(0));for(var c in this.attributes){var f=this.attributes[c];d.attributes[c]=new fn(f.buffer,f.size,f.normalized,f.type,f.stride,f.start,f.instance)}return this.indexBuffer&&(d.indexBuffer=d.buffers[this.buffers.indexOf(this.indexBuffer)],d.indexBuffer.type=M.d.ELEMENT_ARRAY_BUFFER),d},T.merge=function(d){for(var c,f=new T,E=[],U=[],$=[],ot=0;ot<d.length;ot++){c=d[ot];for(var ut=0;ut<c.buffers.length;ut++)U[ut]=U[ut]||0,U[ut]+=c.buffers[ut].data.length,$[ut]=0}for(ot=0;ot<c.buffers.length;ot++)E[ot]=new ma[Le(c.buffers[ot].data)](U[ot]),f.buffers[ot]=new Mn(E[ot]);for(ot=0;ot<d.length;ot++)for(c=d[ot],ut=0;ut<c.buffers.length;ut++)E[ut].set(c.buffers[ut].data,$[ut]),$[ut]+=c.buffers[ut].data.length;if(f.attributes=c.attributes,c.indexBuffer){f.indexBuffer=f.buffers[c.buffers.indexOf(c.indexBuffer)],f.indexBuffer.type=M.d.ELEMENT_ARRAY_BUFFER;var It=0,kt=0,he=0,te=0;for(ot=0;ot<c.buffers.length;ot++)if(c.buffers[ot]!==c.indexBuffer){te=ot;break}for(var ot in c.attributes){var ge=c.attributes[ot];(0|ge.buffer)===te&&(kt+=ge.size*Yn[ge.type]/4)}for(ot=0;ot<d.length;ot++){var xe=d[ot].indexBuffer.data;for(ut=0;ut<xe.length;ut++)f.indexBuffer.data[ut+he]+=It;It+=d[ot].buffers[te].data.length/kt,he+=xe.length}}return f},T}(),An=function(T){function d(){var c=T.call(this)||this;return c.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),c}return Fn(d,T),d}(Ro),Es=function(T){function d(){var c=T.call(this)||this;return c.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),c.uvs=new Float32Array([0,0,1,0,1,1,0,1]),c.vertexBuffer=new Mn(c.vertices),c.uvBuffer=new Mn(c.uvs),c.addAttribute("aVertexPosition",c.vertexBuffer).addAttribute("aTextureCoord",c.uvBuffer).addIndex([0,1,2,0,2,3]),c}return Fn(d,T),d.prototype.map=function(c,f){var E=0,U=0;return this.uvs[0]=E,this.uvs[1]=U,this.uvs[2]=E+f.width/c.width,this.uvs[3]=U,this.uvs[4]=E+f.width/c.width,this.uvs[5]=U+f.height/c.height,this.uvs[6]=E,this.uvs[7]=U+f.height/c.height,E=f.x,U=f.y,this.vertices[0]=E,this.vertices[1]=U,this.vertices[2]=E+f.width,this.vertices[3]=U,this.vertices[4]=E+f.width,this.vertices[5]=U+f.height,this.vertices[6]=E,this.vertices[7]=U+f.height,this.invalidate(),this},d.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},d}(Ro),ns=0,wi=function(){function T(d,c,f){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ns++,this.static=!!c,this.ubo=!!f,d instanceof Mn?(this.buffer=d,this.buffer.type=M.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=d,this.ubo&&(this.buffer=new Mn(new Float32Array(1)),this.buffer.type=M.d.UNIFORM_BUFFER,this.autoManage=!0))}return T.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},T.prototype.add=function(d,c,f){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[d]=new T(c,f)},T.from=function(d,c,f){return new T(d,c,f)},T.uboFrom=function(d,c){return new T(d,c==null||c,!0)},T}(),is=function(){function T(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=M.l.NONE,this.sourceFrame=new oe,this.destinationFrame=new oe,this.bindingSourceFrame=new oe,this.bindingDestinationFrame=new oe,this.filters=[],this.transform=null}return T.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},T}(),yr=[new Wt,new Wt,new Wt,new Wt],Ni=new Ee,lo=function(){function T(d){this.renderer=d,this.defaultFilterStack=[{}],this.texturePool=new Mo,this.texturePool.setScreenSize(d.view),this.statePool=[],this.quad=new An,this.quadUv=new Es,this.tempRect=new oe,this.activeState={},this.globalUniforms=new wi({outputFrame:new oe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return T.prototype.push=function(d,c){for(var f,E,U=this.renderer,$=this.defaultFilterStack,ot=this.statePool.pop()||new is,ut=this.renderer.renderTexture,It=c[0].resolution,kt=c[0].multisample,he=c[0].padding,te=c[0].autoFit,ge=(f=c[0].legacy)===null||f===void 0||f,xe=1;xe<c.length;xe++){var Be=c[xe];It=Math.min(It,Be.resolution),kt=Math.min(kt,Be.multisample),he=this.useMaxPadding?Math.max(he,Be.padding):he+Be.padding,te=te&&Be.autoFit,ge=ge||(E=Be.legacy)===null||E===void 0||E}$.length===1&&(this.defaultFilterStack[0].renderTexture=ut.current),$.push(ot),ot.resolution=It,ot.multisample=kt,ot.legacy=ge,ot.target=d,ot.sourceFrame.copyFrom(d.filterArea||d.getBounds(!0)),ot.sourceFrame.pad(he);var Je=this.tempRect.copyFrom(ut.sourceFrame);U.projection.transform&&this.transformAABB(Ni.copyFrom(U.projection.transform).invert(),Je),te?(ot.sourceFrame.fit(Je),(ot.sourceFrame.width<=0||ot.sourceFrame.height<=0)&&(ot.sourceFrame.width=0,ot.sourceFrame.height=0)):ot.sourceFrame.intersects(Je)||(ot.sourceFrame.width=0,ot.sourceFrame.height=0),this.roundFrame(ot.sourceFrame,ut.current?ut.current.resolution:U.resolution,ut.sourceFrame,ut.destinationFrame,U.projection.transform),ot.renderTexture=this.getOptimalFilterTexture(ot.sourceFrame.width,ot.sourceFrame.height,It,kt),ot.filters=c,ot.destinationFrame.width=ot.renderTexture.width,ot.destinationFrame.height=ot.renderTexture.height;var qe=this.tempRect;qe.x=0,qe.y=0,qe.width=ot.sourceFrame.width,qe.height=ot.sourceFrame.height,ot.renderTexture.filterFrame=ot.sourceFrame,ot.bindingSourceFrame.copyFrom(ut.sourceFrame),ot.bindingDestinationFrame.copyFrom(ut.destinationFrame),ot.transform=U.projection.transform,U.projection.transform=null,ut.bind(ot.renderTexture,ot.sourceFrame,qe),U.framebuffer.clear(0,0,0,0)},T.prototype.pop=function(){var d=this.defaultFilterStack,c=d.pop(),f=c.filters;this.activeState=c;var E=this.globalUniforms.uniforms;E.outputFrame=c.sourceFrame,E.resolution=c.resolution;var U=E.inputSize,$=E.inputPixel,ot=E.inputClamp;if(U[0]=c.destinationFrame.width,U[1]=c.destinationFrame.height,U[2]=1/U[0],U[3]=1/U[1],$[0]=Math.round(U[0]*c.resolution),$[1]=Math.round(U[1]*c.resolution),$[2]=1/$[0],$[3]=1/$[1],ot[0]=.5*$[2],ot[1]=.5*$[3],ot[2]=c.sourceFrame.width*U[2]-.5*$[2],ot[3]=c.sourceFrame.height*U[3]-.5*$[3],c.legacy){var ut=E.filterArea;ut[0]=c.destinationFrame.width,ut[1]=c.destinationFrame.height,ut[2]=c.sourceFrame.x,ut[3]=c.sourceFrame.y,E.filterClamp=E.inputClamp}this.globalUniforms.update();var It=d[d.length-1];if(this.renderer.framebuffer.blit(),f.length===1)f[0].apply(this,c.renderTexture,It.renderTexture,M.e.BLEND,c),this.returnFilterTexture(c.renderTexture);else{var kt=c.renderTexture,he=this.getOptimalFilterTexture(kt.width,kt.height,c.resolution);he.filterFrame=kt.filterFrame;var te=0;for(te=0;te<f.length-1;++te){te===1&&c.multisample>1&&((he=this.getOptimalFilterTexture(kt.width,kt.height,c.resolution)).filterFrame=kt.filterFrame),f[te].apply(this,kt,he,M.e.CLEAR,c);var ge=kt;kt=he,he=ge}f[te].apply(this,kt,It.renderTexture,M.e.BLEND,c),te>1&&c.multisample>1&&this.returnFilterTexture(c.renderTexture),this.returnFilterTexture(kt),this.returnFilterTexture(he)}c.clear(),this.statePool.push(c)},T.prototype.bindAndClear=function(d,c){c===void 0&&(c=M.e.CLEAR);var f=this.renderer,E=f.renderTexture,U=f.state;if(d===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,d&&d.filterFrame){var $=this.tempRect;$.x=0,$.y=0,$.width=d.filterFrame.width,$.height=d.filterFrame.height,E.bind(d,d.filterFrame,$)}else d!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?E.bind(d):this.renderer.renderTexture.bind(d,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var ot=1&U.stateId||this.forceClear;(c===M.e.CLEAR||c===M.e.BLIT&&ot)&&this.renderer.framebuffer.clear(0,0,0,0)},T.prototype.applyFilter=function(d,c,f,E){var U=this.renderer;U.state.set(d.state),this.bindAndClear(f,E),d.uniforms.uSampler=c,d.uniforms.filterGlobals=this.globalUniforms,U.shader.bind(d),d.legacy=!!d.program.attributeData.aTextureCoord,d.legacy?(this.quadUv.map(c._frame,c.filterFrame),U.geometry.bind(this.quadUv),U.geometry.draw(M.f.TRIANGLES)):(U.geometry.bind(this.quad),U.geometry.draw(M.f.TRIANGLE_STRIP))},T.prototype.calculateSpriteMatrix=function(d,c){var f=this.activeState,E=f.sourceFrame,U=f.destinationFrame,$=c._texture.orig,ot=d.set(U.width,0,0,U.height,E.x,E.y),ut=c.worldTransform.copyTo(Ee.TEMP_MATRIX);return ut.invert(),ot.prepend(ut),ot.scale(1/$.width,1/$.height),ot.translate(c.anchor.x,c.anchor.y),ot},T.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},T.prototype.getOptimalFilterTexture=function(d,c,f,E){return f===void 0&&(f=1),E===void 0&&(E=M.l.NONE),this.texturePool.getOptimalTexture(d,c,f,E)},T.prototype.getFilterTexture=function(d,c,f){if(typeof d=="number"){var E=d;d=c,c=E}d=d||this.activeState.renderTexture;var U=this.texturePool.getOptimalTexture(d.width,d.height,c||d.resolution,f||M.l.NONE);return U.filterFrame=d.filterFrame,U},T.prototype.returnFilterTexture=function(d){this.texturePool.returnTexture(d)},T.prototype.emptyPool=function(){this.texturePool.clear(!0)},T.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},T.prototype.transformAABB=function(d,c){var f=yr[0],E=yr[1],U=yr[2],$=yr[3];f.set(c.left,c.top),E.set(c.left,c.bottom),U.set(c.right,c.top),$.set(c.right,c.bottom),d.apply(f,f),d.apply(E,E),d.apply(U,U),d.apply($,$);var ot=Math.min(f.x,E.x,U.x,$.x),ut=Math.min(f.y,E.y,U.y,$.y),It=Math.max(f.x,E.x,U.x,$.x),kt=Math.max(f.y,E.y,U.y,$.y);c.x=ot,c.y=ut,c.width=It-ot,c.height=kt-ut},T.prototype.roundFrame=function(d,c,f,E,U){if(!(d.width<=0||d.height<=0||f.width<=0||f.height<=0)){if(U){var $=U.a,ot=U.b,ut=U.c,It=U.d;if((Math.abs(ot)>1e-4||Math.abs(ut)>1e-4)&&(Math.abs($)>1e-4||Math.abs(It)>1e-4))return}(U=U?Ni.copyFrom(U):Ni.identity()).translate(-f.x,-f.y).scale(E.width/f.width,E.height/f.height).translate(E.x,E.y),this.transformAABB(U,d),d.ceil(c),this.transformAABB(U.invert(),d)}},T}(),vi=function(){function T(d){this.renderer=d}return T.prototype.flush=function(){},T.prototype.destroy=function(){this.renderer=null},T.prototype.start=function(){},T.prototype.stop=function(){this.flush()},T.prototype.render=function(d){},T}(),Wn=function(){function T(d){this.renderer=d,this.emptyRenderer=new vi(d),this.currentRenderer=this.emptyRenderer}return T.prototype.setObjectRenderer=function(d){this.currentRenderer!==d&&(this.currentRenderer.stop(),this.currentRenderer=d,this.currentRenderer.start())},T.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.copyBoundTextures=function(d,c){for(var f=this.renderer.texture.boundTextures,E=c-1;E>=0;--E)d[E]=f[E]||null,d[E]&&(d[E]._batchLocation=E)},T.prototype.boundArray=function(d,c,f,E){for(var U=d.elements,$=d.ids,ot=d.count,ut=0,It=0;It<ot;It++){var kt=U[It],he=kt._batchLocation;if(he>=0&&he<E&&c[he]===kt)$[It]=he;else for(;ut<E;){var te=c[ut];if(!te||te._batchEnabled!==f||te._batchLocation!==ut){$[It]=ut,kt._batchLocation=ut,c[ut]=kt;break}ut++}}},T.prototype.destroy=function(){this.renderer=null},T}(),Io=0,Br=function(){function T(d){this.renderer=d,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),d.view.addEventListener("webglcontextlost",this.handleContextLost,!1),d.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(T.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),T.prototype.contextChange=function(d){this.gl=d,this.renderer.gl=d,this.renderer.CONTEXT_UID=Io++,d.isContextLost()&&d.getExtension("WEBGL_lose_context")&&d.getExtension("WEBGL_lose_context").restoreContext()},T.prototype.initFromContext=function(d){this.gl=d,this.validateContext(d),this.renderer.gl=d,this.renderer.CONTEXT_UID=Io++,this.renderer.runners.contextChange.emit(d)},T.prototype.initFromOptions=function(d){var c=this.createContext(this.renderer.view,d);this.initFromContext(c)},T.prototype.createContext=function(d,c){var f;if(R.b.PREFER_ENV>=M.g.WEBGL2&&(f=d.getContext("webgl2",c)),f)this.webGLVersion=2;else if(this.webGLVersion=1,!(f=d.getContext("webgl",c)||d.getContext("experimental-webgl",c)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=f,this.getExtensions(),this.gl},T.prototype.getExtensions=function(){var d=this.gl,c={anisotropicFiltering:d.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),s3tc:d.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:d.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:d.getExtension("WEBGL_compressed_texture_etc"),etc1:d.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:d.getExtension("WEBGL_compressed_texture_pvrtc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:d.getExtension("WEBGL_compressed_texture_atc"),astc:d.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,c,{drawBuffers:d.getExtension("WEBGL_draw_buffers"),depthTexture:d.getExtension("WEBGL_depth_texture"),loseContext:d.getExtension("WEBGL_lose_context"),vertexArrayObject:d.getExtension("OES_vertex_array_object")||d.getExtension("MOZ_OES_vertex_array_object")||d.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:d.getExtension("OES_element_index_uint"),floatTexture:d.getExtension("OES_texture_float"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),textureHalfFloat:d.getExtension("OES_texture_half_float"),textureHalfFloatLinear:d.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,c,{colorBufferFloat:d.getExtension("EXT_color_buffer_float")})},T.prototype.handleContextLost=function(d){d.preventDefault()},T.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},T.prototype.destroy=function(){var d=this.renderer.view;this.renderer=null,d.removeEventListener("webglcontextlost",this.handleContextLost),d.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},T.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},T.prototype.validateContext=function(d){var c=d.getContextAttributes(),f="WebGL2RenderingContext"in globalThis&&d instanceof globalThis.WebGL2RenderingContext;f&&(this.webGLVersion=2),c&&!c.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var E=f||!!d.getExtension("OES_element_index_uint");this.supports.uint32Indices=E,E||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},T}(),Po=function(T){this.framebuffer=T,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=M.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},Cr=new oe,Rr=function(){function T(d){this.renderer=d,this.managedFramebuffers=[],this.unknownFramebuffer=new es(10,10),this.msaaSamples=null}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new oe,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var c=this.renderer.context.extensions.drawBuffers,f=this.renderer.context.extensions.depthTexture;R.b.PREFER_ENV===M.g.WEBGL_LEGACY&&(c=null,f=null),c?d.drawBuffers=function(E){return c.drawBuffersWEBGL(E)}:(this.hasMRT=!1,d.drawBuffers=function(){}),f||(this.writeDepthTexture=!1)}else this.msaaSamples=d.getInternalformatParameter(d.RENDERBUFFER,d.RGBA8,d.SAMPLES)},T.prototype.bind=function(d,c,f){f===void 0&&(f=0);var E=this.gl;if(d){var U=d.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(d);this.current!==d&&(this.current=d,E.bindFramebuffer(E.FRAMEBUFFER,U.framebuffer)),U.mipLevel!==f&&(d.dirtyId++,d.dirtyFormat++,U.mipLevel=f),U.dirtyId!==d.dirtyId&&(U.dirtyId=d.dirtyId,U.dirtyFormat!==d.dirtyFormat?(U.dirtyFormat=d.dirtyFormat,U.dirtySize=d.dirtySize,this.updateFramebuffer(d,f)):U.dirtySize!==d.dirtySize&&(U.dirtySize=d.dirtySize,this.resizeFramebuffer(d)));for(var $=0;$<d.colorTextures.length;$++){var ot=d.colorTextures[$];this.renderer.texture.unbind(ot.parentTextureArray||ot)}if(d.depthTexture&&this.renderer.texture.unbind(d.depthTexture),c){var ut=c.width>>f,It=c.height>>f,kt=ut/c.width;this.setViewport(c.x*kt,c.y*kt,ut,It)}else ut=d.width>>f,It=d.height>>f,this.setViewport(0,0,ut,It)}else this.current&&(this.current=null,E.bindFramebuffer(E.FRAMEBUFFER,null)),c?this.setViewport(c.x,c.y,c.width,c.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},T.prototype.setViewport=function(d,c,f,E){var U=this.viewport;d=Math.round(d),c=Math.round(c),f=Math.round(f),E=Math.round(E),U.width===f&&U.height===E&&U.x===d&&U.y===c||(U.x=d,U.y=c,U.width=f,U.height=E,this.gl.viewport(d,c,f,E))},Object.defineProperty(T.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),T.prototype.clear=function(d,c,f,E,U){U===void 0&&(U=M.c.COLOR|M.c.DEPTH);var $=this.gl;$.clearColor(d,c,f,E),$.clear(U)},T.prototype.initFramebuffer=function(d){var c=this.gl,f=new Po(c.createFramebuffer());return f.multisample=this.detectSamples(d.multisample),d.glFramebuffers[this.CONTEXT_UID]=f,this.managedFramebuffers.push(d),d.disposeRunner.add(this),f},T.prototype.resizeFramebuffer=function(d){var c=this.gl,f=d.glFramebuffers[this.CONTEXT_UID];f.msaaBuffer&&(c.bindRenderbuffer(c.RENDERBUFFER,f.msaaBuffer),c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.RGBA8,d.width,d.height)),f.stencil&&(c.bindRenderbuffer(c.RENDERBUFFER,f.stencil),f.msaaBuffer?c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.DEPTH24_STENCIL8,d.width,d.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,d.width,d.height));var E=d.colorTextures,U=E.length;c.drawBuffers||(U=Math.min(U,1));for(var $=0;$<U;$++){var ot=E[$],ut=ot.parentTextureArray||ot;this.renderer.texture.bind(ut,0)}d.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(d.depthTexture,0)},T.prototype.updateFramebuffer=function(d,c){var f=this.gl,E=d.glFramebuffers[this.CONTEXT_UID],U=d.colorTextures,$=U.length;f.drawBuffers||($=Math.min($,1)),E.multisample>1&&this.canMultisampleFramebuffer(d)?(E.msaaBuffer=E.msaaBuffer||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,E.msaaBuffer),f.renderbufferStorageMultisample(f.RENDERBUFFER,E.multisample,f.RGBA8,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.RENDERBUFFER,E.msaaBuffer)):E.msaaBuffer&&(f.deleteRenderbuffer(E.msaaBuffer),E.msaaBuffer=null,E.blitFramebuffer&&(E.blitFramebuffer.dispose(),E.blitFramebuffer=null));for(var ot=[],ut=0;ut<$;ut++){var It=U[ut],kt=It.parentTextureArray||It;this.renderer.texture.bind(kt,0),ut===0&&E.msaaBuffer||(f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+ut,It.target,kt._glTextures[this.CONTEXT_UID].texture,c),ot.push(f.COLOR_ATTACHMENT0+ut))}if(ot.length>1&&f.drawBuffers(ot),d.depthTexture&&this.writeDepthTexture){var he=d.depthTexture;this.renderer.texture.bind(he,0),f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,he._glTextures[this.CONTEXT_UID].texture,c)}!d.stencil&&!d.depth||d.depthTexture&&this.writeDepthTexture?E.stencil&&(f.deleteRenderbuffer(E.stencil),E.stencil=null):(E.stencil=E.stencil||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,E.stencil),E.msaaBuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,E.multisample,f.DEPTH24_STENCIL8,d.width,d.height):f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,E.stencil))},T.prototype.canMultisampleFramebuffer=function(d){return this.renderer.context.webGLVersion!==1&&d.colorTextures.length<=1&&!d.depthTexture},T.prototype.detectSamples=function(d){var c=this.msaaSamples,f=M.l.NONE;if(d<=1||c===null)return f;for(var E=0;E<c.length;E++)if(c[E]<=d){f=c[E];break}return f===1&&(f=M.l.NONE),f},T.prototype.blit=function(d,c,f){var E=this.current,U=this.renderer,$=this.gl,ot=this.CONTEXT_UID;if(U.context.webGLVersion===2&&E){var ut=E.glFramebuffers[ot];if(ut){if(!d){if(!ut.msaaBuffer)return;var It=E.colorTextures[0];if(!It)return;ut.blitFramebuffer||(ut.blitFramebuffer=new es(E.width,E.height),ut.blitFramebuffer.addColorTexture(0,It)),(d=ut.blitFramebuffer).colorTextures[0]!==It&&(d.colorTextures[0]=It,d.dirtyId++,d.dirtyFormat++),d.width===E.width&&d.height===E.height||(d.width=E.width,d.height=E.height,d.dirtyId++,d.dirtySize++)}c||((c=Cr).width=E.width,c.height=E.height),f||(f=c);var kt=c.width===f.width&&c.height===f.height;this.bind(d),$.bindFramebuffer($.READ_FRAMEBUFFER,ut.framebuffer),$.blitFramebuffer(c.left,c.top,c.right,c.bottom,f.left,f.top,f.right,f.bottom,$.COLOR_BUFFER_BIT,kt?$.NEAREST:$.LINEAR)}}},T.prototype.disposeFramebuffer=function(d,c){var f=d.glFramebuffers[this.CONTEXT_UID],E=this.gl;if(f){delete d.glFramebuffers[this.CONTEXT_UID];var U=this.managedFramebuffers.indexOf(d);U>=0&&this.managedFramebuffers.splice(U,1),d.disposeRunner.remove(this),c||(E.deleteFramebuffer(f.framebuffer),f.msaaBuffer&&E.deleteRenderbuffer(f.msaaBuffer),f.stencil&&E.deleteRenderbuffer(f.stencil)),f.blitFramebuffer&&f.blitFramebuffer.dispose()}},T.prototype.disposeAll=function(d){var c=this.managedFramebuffers;this.managedFramebuffers=[];for(var f=0;f<c.length;f++)this.disposeFramebuffer(c[f],d)},T.prototype.forceStencil=function(){var d=this.current;if(d){var c=d.glFramebuffers[this.CONTEXT_UID];if(c&&!c.stencil){d.stencil=!0;var f=d.width,E=d.height,U=this.gl,$=U.createRenderbuffer();U.bindRenderbuffer(U.RENDERBUFFER,$),c.msaaBuffer?U.renderbufferStorageMultisample(U.RENDERBUFFER,c.multisample,U.DEPTH24_STENCIL8,f,E):U.renderbufferStorage(U.RENDERBUFFER,U.DEPTH_STENCIL,f,E),c.stencil=$,U.framebufferRenderbuffer(U.FRAMEBUFFER,U.DEPTH_STENCIL_ATTACHMENT,U.RENDERBUFFER,$)}}},T.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new oe},T.prototype.destroy=function(){this.renderer=null},T}(),ar={5126:4,5123:2,5121:1},Oo=function(){function T(d){this.renderer=d,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return T.prototype.contextChange=function(){this.disposeAll(!0);var d=this.gl=this.renderer.gl,c=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,c.webGLVersion!==2){var f=this.renderer.context.extensions.vertexArrayObject;R.b.PREFER_ENV===M.g.WEBGL_LEGACY&&(f=null),f?(d.createVertexArray=function(){return f.createVertexArrayOES()},d.bindVertexArray=function(U){return f.bindVertexArrayOES(U)},d.deleteVertexArray=function(U){return f.deleteVertexArrayOES(U)}):(this.hasVao=!1,d.createVertexArray=function(){return null},d.bindVertexArray=function(){return null},d.deleteVertexArray=function(){return null})}if(c.webGLVersion!==2){var E=d.getExtension("ANGLE_instanced_arrays");E?(d.vertexAttribDivisor=function(U,$){return E.vertexAttribDivisorANGLE(U,$)},d.drawElementsInstanced=function(U,$,ot,ut,It){return E.drawElementsInstancedANGLE(U,$,ot,ut,It)},d.drawArraysInstanced=function(U,$,ot,ut){return E.drawArraysInstancedANGLE(U,$,ot,ut)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=c.webGLVersion===2||!!c.extensions.uint32ElementIndex},T.prototype.bind=function(d,c){c=c||this.renderer.shader.shader;var f=this.gl,E=d.glVertexArrayObjects[this.CONTEXT_UID],U=!1;E||(this.managedGeometries[d.id]=d,d.disposeRunner.add(this),d.glVertexArrayObjects[this.CONTEXT_UID]=E={},U=!0);var $=E[c.program.id]||this.initGeometryVao(d,c,U);this._activeGeometry=d,this._activeVao!==$&&(this._activeVao=$,this.hasVao?f.bindVertexArray($):this.activateVao(d,c.program)),this.updateBuffers()},T.prototype.reset=function(){this.unbind()},T.prototype.updateBuffers=function(){for(var d=this._activeGeometry,c=this.renderer.buffer,f=0;f<d.buffers.length;f++){var E=d.buffers[f];c.update(E)}},T.prototype.checkCompatibility=function(d,c){var f=d.attributes,E=c.attributeData;for(var U in E)if(!f[U])throw new Error('shader and geometry incompatible, geometry missing the "'+U+'" attribute')},T.prototype.getSignature=function(d,c){var f=d.attributes,E=c.attributeData,U=["g",d.id];for(var $ in f)E[$]&&U.push($,E[$].location);return U.join("-")},T.prototype.initGeometryVao=function(d,c,f){f===void 0&&(f=!0);var E=this.gl,U=this.CONTEXT_UID,$=this.renderer.buffer,ot=c.program;ot.glPrograms[U]||this.renderer.shader.generateProgram(c),this.checkCompatibility(d,ot);var ut=this.getSignature(d,ot),It=d.glVertexArrayObjects[this.CONTEXT_UID],kt=It[ut];if(kt)return It[ot.id]=kt,kt;var he=d.buffers,te=d.attributes,ge={},xe={};for(var Be in he)ge[Be]=0,xe[Be]=0;for(var Be in te)!te[Be].size&&ot.attributeData[Be]?te[Be].size=ot.attributeData[Be].size:te[Be].size||console.warn("PIXI Geometry attribute '"+Be+"' size cannot be determined (likely the bound shader does not have the attribute)"),ge[te[Be].buffer]+=te[Be].size*ar[te[Be].type];for(var Be in te){var Je=te[Be],qe=Je.size;Je.stride===void 0&&(ge[Je.buffer]===qe*ar[Je.type]?Je.stride=0:Je.stride=ge[Je.buffer]),Je.start===void 0&&(Je.start=xe[Je.buffer],xe[Je.buffer]+=qe*ar[Je.type])}kt=E.createVertexArray(),E.bindVertexArray(kt);for(var Ze=0;Ze<he.length;Ze++){var je=he[Ze];$.bind(je),f&&je._glBuffers[U].refCount++}return this.activateVao(d,ot),this._activeVao=kt,It[ot.id]=kt,It[ut]=kt,kt},T.prototype.disposeGeometry=function(d,c){var f;if(this.managedGeometries[d.id]){delete this.managedGeometries[d.id];var E=d.glVertexArrayObjects[this.CONTEXT_UID],U=this.gl,$=d.buffers,ot=(f=this.renderer)===null||f===void 0?void 0:f.buffer;if(d.disposeRunner.remove(this),E){if(ot)for(var ut=0;ut<$.length;ut++){var It=$[ut]._glBuffers[this.CONTEXT_UID];It&&(It.refCount--,It.refCount!==0||c||ot.dispose($[ut],c))}if(!c){for(var kt in E)if(kt[0]==="g"){var he=E[kt];this._activeVao===he&&this.unbind(),U.deleteVertexArray(he)}}delete d.glVertexArrayObjects[this.CONTEXT_UID]}}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedGeometries),f=0;f<c.length;f++)this.disposeGeometry(this.managedGeometries[c[f]],d)},T.prototype.activateVao=function(d,c){var f=this.gl,E=this.CONTEXT_UID,U=this.renderer.buffer,$=d.buffers,ot=d.attributes;d.indexBuffer&&U.bind(d.indexBuffer);var ut=null;for(var It in ot){var kt=ot[It],he=$[kt.buffer],te=he._glBuffers[E];if(c.attributeData[It]){ut!==te&&(U.bind(he),ut=te);var ge=c.attributeData[It].location;if(f.enableVertexAttribArray(ge),f.vertexAttribPointer(ge,kt.size,kt.type||f.FLOAT,kt.normalized,kt.stride,kt.start),kt.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");f.vertexAttribDivisor(ge,1)}}}},T.prototype.draw=function(d,c,f,E){var U=this.gl,$=this._activeGeometry;if($.indexBuffer){var ot=$.indexBuffer.data.BYTES_PER_ELEMENT,ut=ot===2?U.UNSIGNED_SHORT:U.UNSIGNED_INT;ot===2||ot===4&&this.canUseUInt32ElementIndex?$.instanced?U.drawElementsInstanced(d,c||$.indexBuffer.data.length,ut,(f||0)*ot,E||1):U.drawElements(d,c||$.indexBuffer.data.length,ut,(f||0)*ot):console.warn("unsupported index buffer type: uint32")}else $.instanced?U.drawArraysInstanced(d,f,c||$.getSize(),E||1):U.drawArrays(d,f,c||$.getSize());return this},T.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},T.prototype.destroy=function(){this.renderer=null},T}(),Lo=function(){function T(d){d===void 0&&(d=null),this.type=M.j.NONE,this.autoDetect=!0,this.maskObject=d||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=R.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(T.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(d){d?this._filters?this._filters[0]=d:this._filters=[d]:this._filters=null},enumerable:!1,configurable:!0}),T.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=M.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},T.prototype.copyCountersOrReset=function(d){d?(this._stencilCounter=d._stencilCounter,this._scissorCounter=d._scissorCounter,this._scissorRect=d._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},T}();function No(T,d,c){var f=T.createShader(d);return T.shaderSource(f,c),T.compileShader(f),f}function Y(T,d){var c=T.getShaderSource(d).split(`
`).map(function(It,kt){return kt+": "+It}),f=T.getShaderInfoLog(d),E=f.split(`
`),U={},$=E.map(function(It){return parseFloat(It.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(It){return!(!It||U[It])&&(U[It]=!0,!0)}),ot=[""];$.forEach(function(It){c[It-1]="%c"+c[It-1]+"%c",ot.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var ut=c.join(`
`);ot[0]=ut,console.error(f),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,ot),console.groupEnd()}function g(T){for(var d=new Array(T),c=0;c<d.length;c++)d[c]=!1;return d}function m(T,d){switch(T){case"float":return 0;case"vec2":return new Float32Array(2*d);case"vec3":return new Float32Array(3*d);case"vec4":return new Float32Array(4*d);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*d);case"ivec3":return new Int32Array(3*d);case"ivec4":return new Int32Array(4*d);case"uvec2":return new Uint32Array(2*d);case"uvec3":return new Uint32Array(3*d);case"uvec4":return new Uint32Array(4*d);case"bool":return!1;case"bvec2":return g(2*d);case"bvec3":return g(3*d);case"bvec4":return g(4*d);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var y,N={},q=N;function ht(){if(!y){y=M.m.MEDIUM;var T=function(){if(q===N||q&&q.isContextLost()){var c=document.createElement("canvas"),f=void 0;R.b.PREFER_ENV>=M.g.WEBGL2&&(f=c.getContext("webgl2",{})),f||((f=c.getContext("webgl",{})||c.getContext("experimental-webgl",{}))?f.getExtension("WEBGL_draw_buffers"):f=null),q=f}return q}();if(T&&T.getShaderPrecisionFormat){var d=T.getShaderPrecisionFormat(T.FRAGMENT_SHADER,T.HIGH_FLOAT);y=d.precision?M.m.HIGH:M.m.MEDIUM}}return y}function bt(T,d,c){if(T.substring(0,9)!=="precision"){var f=d;return d===M.m.HIGH&&c!==M.m.HIGH&&(f=M.m.MEDIUM),"precision "+f+` float;
`+T}return c!==M.m.HIGH&&T.substring(0,15)==="precision highp"?T.replace("precision highp","precision mediump"):T}var wt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Kt(T){return wt[T]}var ne=null,Fe={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Te(T,d){if(!ne){var c=Object.keys(Fe);ne={};for(var f=0;f<c.length;++f){var E=c[f];ne[T[E]]=Fe[E]}}return ne[d]}var $e=[{test:function(T){return T.type==="float"&&T.size===1},code:function(T){return`
            if(uv["`+T+'"] !== ud["'+T+`"].value)
            {
                ud["`+T+'"].value = uv["'+T+`"]
                gl.uniform1f(ud["`+T+'"].location, uv["'+T+`"])
            }
            `}},{test:function(T){return(T.type==="sampler2D"||T.type==="samplerCube"||T.type==="sampler2DArray")&&T.size===1&&!T.isArray},code:function(T){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+T+`"], t);

            if(ud["`+T+`"].value !== t)
            {
                ud["`+T+`"].value = t;
                gl.uniform1i(ud["`+T+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(T,d){return T.type==="mat3"&&T.size===1&&d.a!==void 0},code:function(T){return`
            gl.uniformMatrix3fv(ud["`+T+'"].location, false, uv["'+T+`"].toArray(true));
            `},codeUbo:function(T){return`
                var `+T+"_matrix = uv."+T+`.toArray(true);

                data[offset] = `+T+`_matrix[0];
                data[offset+1] = `+T+`_matrix[1];
                data[offset+2] = `+T+`_matrix[2];
        
                data[offset + 4] = `+T+`_matrix[3];
                data[offset + 5] = `+T+`_matrix[4];
                data[offset + 6] = `+T+`_matrix[5];
        
                data[offset + 8] = `+T+`_matrix[6];
                data[offset + 9] = `+T+`_matrix[7];
                data[offset + 10] = `+T+`_matrix[8];
            `}},{test:function(T,d){return T.type==="vec2"&&T.size===1&&d.x!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+T+`"].location, v.x, v.y);
                }`},codeUbo:function(T){return`
                v = uv.`+T+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(T){return T.type==="vec2"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+T+`"].location, v[0], v[1]);
                }
            `}},{test:function(T,d){return T.type==="vec4"&&T.size===1&&d.width!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+T+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(T){return`
                    v = uv.`+T+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(T){return T.type==="vec4"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+T+`"].location, v[0], v[1], v[2], v[3])
                }`}}],hn={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},vn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},un,Kn=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function _i(T){for(var d="",c=0;c<T;++c)c>0&&(d+=`
else `),c<T-1&&(d+="if(test == "+c+".0){}");return d}var yi=0,ni={},Bi=function(){function T(d,c,f){f===void 0&&(f="pixi-shader"),this.id=yi++,this.vertexSrc=d||T.defaultVertexSrc,this.fragmentSrc=c||T.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(f=f.replace(/\s+/g,"-"),ni[f]?(ni[f]++,f+="-"+ni[f]):ni[f]=1,this.vertexSrc="#define SHADER_NAME "+f+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+f+`
`+this.fragmentSrc,this.vertexSrc=bt(this.vertexSrc,R.b.PRECISION_VERTEX,M.m.HIGH),this.fragmentSrc=bt(this.fragmentSrc,R.b.PRECISION_FRAGMENT,ht())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(T,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),T.from=function(d,c,f){var E=d+c,U=fe[E];return U||(fe[E]=U=new T(d,c,f)),U},T}(),ki=function(){function T(d,c){this.uniformBindCount=0,this.program=d,this.uniformGroup=c?c instanceof wi?c:new wi(c):new wi({})}return T.prototype.checkUniformExists=function(d,c){if(c.uniforms[d])return!0;for(var f in c.uniforms){var E=c.uniforms[f];if(E.group&&this.checkUniformExists(d,E))return!0}return!1},T.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(T.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),T.from=function(d,c,f){return new T(Bi.from(d,c),f)},T}(),ui=function(){function T(){this.data=0,this.blendMode=M.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(T.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(d){!!(1&this.data)!==d&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(d){!!(2&this.data)!==d&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(d){!!(4&this.data)!==d&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(d){!!(8&this.data)!==d&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(d){!!(32&this.data)!==d&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(d){!!(16&this.data)!==d&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"blendMode",{get:function(){return this._blendMode},set:function(d){this.blend=d!==M.b.NONE,this._blendMode=d},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(d){this.offsets=!!d,this._polygonOffset=d},enumerable:!1,configurable:!0}),T.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},T.for2d=function(){var d=new T;return d.depthTest=!1,d.blend=!0,d},T}(),Si=function(T){function d(c,f,E){var U=this,$=Bi.from(c||d.defaultVertexSrc,f||d.defaultFragmentSrc);return(U=T.call(this,$,E)||this).padding=0,U.resolution=R.b.FILTER_RESOLUTION,U.multisample=R.b.FILTER_MULTISAMPLE,U.enabled=!0,U.autoFit=!0,U.state=new ui,U}return Fn(d,T),d.prototype.apply=function(c,f,E,U,$){c.applyFilter(this,f,E,U)},Object.defineProperty(d.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(c){this.state.blendMode=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"resolution",{get:function(){return this._resolution},set:function(c){this._resolution=c},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),d}(ki),xr=new Ee,kr=function(){function T(d,c){this._texture=d,this.mapCoord=new Ee,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=c===void 0?.5:c,this.isSimple=!1}return Object.defineProperty(T.prototype,"texture",{get:function(){return this._texture},set:function(d){this._texture=d,this._textureID=-1},enumerable:!1,configurable:!0}),T.prototype.multiplyUvs=function(d,c){c===void 0&&(c=d);for(var f=this.mapCoord,E=0;E<d.length;E+=2){var U=d[E],$=d[E+1];c[E]=U*f.a+$*f.c+f.tx,c[E+1]=U*f.b+$*f.d+f.ty}return c},T.prototype.update=function(d){var c=this._texture;if(!c||!c.valid||!d&&this._textureID===c._updateID)return!1;this._textureID=c._updateID,this._updateID++;var f=c._uvs;this.mapCoord.set(f.x1-f.x0,f.y1-f.y0,f.x3-f.x0,f.y3-f.y0,f.x0,f.y0);var E=c.orig,U=c.trim;U&&(xr.set(E.width/U.width,0,0,E.height/U.height,-U.x/U.width,-U.y/U.height),this.mapCoord.append(xr));var $=c.baseTexture,ot=this.uClampFrame,ut=this.clampMargin/$.resolution,It=this.clampOffset;return ot[0]=(c._frame.x+ut+It)/$.width,ot[1]=(c._frame.y+ut+It)/$.height,ot[2]=(c._frame.x+c._frame.width-ut+It)/$.width,ot[3]=(c._frame.y+c._frame.height-ut+It)/$.height,this.uClampOffset[0]=It/$.realWidth,this.uClampOffset[1]=It/$.realHeight,this.isSimple=c._frame.width===$.width&&c._frame.height===$.height&&c.rotate===0,!0},T}(),rs=function(T){function d(c,f,E){var U=this,$=null;return typeof c!="string"&&f===void 0&&E===void 0&&($=c,c=void 0,f=void 0,E=void 0),(U=T.call(this,c||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,f||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,E)||this).maskSprite=$,U.maskMatrix=new Ee,U}return Fn(d,T),Object.defineProperty(d.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(c){this._maskSprite=c,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),d.prototype.apply=function(c,f,E,U){var $=this._maskSprite,ot=$._texture;ot.valid&&(ot.uvMatrix||(ot.uvMatrix=new kr(ot,0)),ot.uvMatrix.update(),this.uniforms.npmAlpha=ot.baseTexture.alphaMode?0:1,this.uniforms.mask=ot,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,$).prepend(ot.uvMatrix.mapCoord),this.uniforms.alpha=$.worldAlpha,this.uniforms.maskClamp=ot.uvMatrix.uClampFrame,c.applyFilter(this,f,E,U))},d}(Si),os=function(){function T(d){this.renderer=d,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return T.prototype.setMaskStack=function(d){this.maskStack=d,this.renderer.scissor.setMaskStack(d),this.renderer.stencil.setMaskStack(d)},T.prototype.push=function(d,c){var f=c;if(!f.isMaskData){var E=this.maskDataPool.pop()||new Lo;E.pooled=!0,E.maskObject=c,f=E}var U=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(f.copyCountersOrReset(U),f.autoDetect&&this.detect(f),f._target=d,f.type!==M.j.SPRITE&&this.maskStack.push(f),f.enabled)switch(f.type){case M.j.SCISSOR:this.renderer.scissor.push(f);break;case M.j.STENCIL:this.renderer.stencil.push(f);break;case M.j.SPRITE:f.copyCountersOrReset(null),this.pushSpriteMask(f)}f.type===M.j.SPRITE&&this.maskStack.push(f)},T.prototype.pop=function(d){var c=this.maskStack.pop();if(c&&c._target===d){if(c.enabled)switch(c.type){case M.j.SCISSOR:this.renderer.scissor.pop();break;case M.j.STENCIL:this.renderer.stencil.pop(c.maskObject);break;case M.j.SPRITE:this.popSpriteMask(c)}if(c.reset(),c.pooled&&this.maskDataPool.push(c),this.maskStack.length!==0){var f=this.maskStack[this.maskStack.length-1];f.type===M.j.SPRITE&&f._filters&&(f._filters[0].maskSprite=f.maskObject)}}},T.prototype.detect=function(d){d.maskObject.isSprite?d.type=M.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(d)?d.type=M.j.SCISSOR:d.type=M.j.STENCIL},T.prototype.pushSpriteMask=function(d){var c,f,E=d.maskObject,U=d._target,$=d._filters;$||($=this.alphaMaskPool[this.alphaMaskIndex])||($=this.alphaMaskPool[this.alphaMaskIndex]=[new rs]);var ot,ut,It=this.renderer,kt=It.renderTexture;if(kt.current){var he=kt.current;ot=d.resolution||he.resolution,ut=(c=d.multisample)!==null&&c!==void 0?c:he.multisample}else ot=d.resolution||It.resolution,ut=(f=d.multisample)!==null&&f!==void 0?f:It.multisample;$[0].resolution=ot,$[0].multisample=ut,$[0].maskSprite=E;var te=U.filterArea;U.filterArea=E.getBounds(!0),It.filter.push(U,$),U.filterArea=te,d._filters||this.alphaMaskIndex++},T.prototype.popSpriteMask=function(d){this.renderer.filter.pop(),d._filters?d._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},T.prototype.destroy=function(){this.renderer=null},T}(),Ir=function(){function T(d){this.renderer=d,this.maskStack=[],this.glConst=0}return T.prototype.getStackLength=function(){return this.maskStack.length},T.prototype.setMaskStack=function(d){var c=this.renderer.gl,f=this.getStackLength();this.maskStack=d;var E=this.getStackLength();E!==f&&(E===0?c.disable(this.glConst):(c.enable(this.glConst),this._useCurrent()))},T.prototype._useCurrent=function(){},T.prototype.destroy=function(){this.renderer=null,this.maskStack=null},T}(),On=new Ee,sn=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.SCISSOR_TEST,f}return Fn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._scissorCounter:0},d.prototype.calcScissorRect=function(c){if(!c._scissorRectLocal){var f=c._scissorRect,E=c.maskObject,U=this.renderer,$=U.renderTexture;E.renderable=!0;var ot=E.getBounds();this.roundFrameToPixels(ot,$.current?$.current.resolution:U.resolution,$.sourceFrame,$.destinationFrame,U.projection.transform),E.renderable=!1,f&&ot.fit(f),c._scissorRectLocal=ot}},d.isMatrixRotated=function(c){if(!c)return!1;var f=c.a,E=c.b,U=c.c,$=c.d;return(Math.abs(E)>1e-4||Math.abs(U)>1e-4)&&(Math.abs(f)>1e-4||Math.abs($)>1e-4)},d.prototype.testScissor=function(c){var f=c.maskObject;if(!f.isFastRect||!f.isFastRect()||d.isMatrixRotated(f.worldTransform)||d.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(c);var E=c._scissorRectLocal;return E.width>0&&E.height>0},d.prototype.roundFrameToPixels=function(c,f,E,U,$){d.isMatrixRotated($)||(($=$?On.copyFrom($):On.identity()).translate(-E.x,-E.y).scale(U.width/E.width,U.height/E.height).translate(U.x,U.y),this.renderer.filter.transformAABB($,c),c.fit(U),c.x=Math.round(c.x*f),c.y=Math.round(c.y*f),c.width=Math.round(c.width*f),c.height=Math.round(c.height*f))},d.prototype.push=function(c){c._scissorRectLocal||this.calcScissorRect(c);var f=this.renderer.gl;c._scissorRect||f.enable(f.SCISSOR_TEST),c._scissorCounter++,c._scissorRect=c._scissorRectLocal,this._useCurrent()},d.prototype.pop=function(){var c=this.renderer.gl;this.getStackLength()>0?this._useCurrent():c.disable(c.SCISSOR_TEST)},d.prototype._useCurrent=function(){var c,f=this.maskStack[this.maskStack.length-1]._scissorRect;c=this.renderer.renderTexture.current?f.y:this.renderer.height-f.height-f.y,this.renderer.gl.scissor(f.x,c,f.width,f.height)},d}(Ir),Pr=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.STENCIL_TEST,f}return Fn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._stencilCounter:0},d.prototype.push=function(c){var f=c.maskObject,E=this.renderer.gl,U=c._stencilCounter;U===0&&(this.renderer.framebuffer.forceStencil(),E.clearStencil(0),E.clear(E.STENCIL_BUFFER_BIT),E.enable(E.STENCIL_TEST)),c._stencilCounter++,E.colorMask(!1,!1,!1,!1),E.stencilFunc(E.EQUAL,U,4294967295),E.stencilOp(E.KEEP,E.KEEP,E.INCR),f.renderable=!0,f.render(this.renderer),this.renderer.batch.flush(),f.renderable=!1,this._useCurrent()},d.prototype.pop=function(c){var f=this.renderer.gl;this.getStackLength()===0?f.disable(f.STENCIL_TEST):(f.colorMask(!1,!1,!1,!1),f.stencilOp(f.KEEP,f.KEEP,f.DECR),c.renderable=!0,c.render(this.renderer),this.renderer.batch.flush(),c.renderable=!1,this._useCurrent())},d.prototype._useCurrent=function(){var c=this.renderer.gl;c.colorMask(!0,!0,!0,!0),c.stencilFunc(c.EQUAL,this.getStackLength(),4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)},d}(Ir),Qh=function(){function T(d){this.renderer=d,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ee,this.transform=null}return T.prototype.update=function(d,c,f,E){this.destinationFrame=d||this.destinationFrame||this.defaultFrame,this.sourceFrame=c||this.sourceFrame||d,this.calculateProjection(this.destinationFrame,this.sourceFrame,f,E),this.transform&&this.projectionMatrix.append(this.transform);var U=this.renderer;U.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,U.globalUniforms.update(),U.shader.shader&&U.shader.syncUniformGroup(U.shader.shader.uniforms.globals)},T.prototype.calculateProjection=function(d,c,f,E){var U=this.projectionMatrix,$=E?-1:1;U.identity(),U.a=1/c.width*2,U.d=$*(1/c.height*2),U.tx=-1-c.x*U.a,U.ty=-$-c.y*U.d},T.prototype.setTransform=function(d){},T.prototype.destroy=function(){this.renderer=null},T}(),ho=new oe,ss=new oe,tu=function(){function T(d){this.renderer=d,this.clearColor=d._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new oe,this.destinationFrame=new oe,this.viewportFrame=new oe}return T.prototype.bind=function(d,c,f){d===void 0&&(d=null);var E,U,$,ot=this.renderer;this.current=d,d?($=(E=d.baseTexture).resolution,c||(ho.width=d.frame.width,ho.height=d.frame.height,c=ho),f||(ss.x=d.frame.x,ss.y=d.frame.y,ss.width=c.width,ss.height=c.height,f=ss),U=E.framebuffer):($=ot.resolution,c||(ho.width=ot.screen.width,ho.height=ot.screen.height,c=ho),f||((f=ho).width=c.width,f.height=c.height));var ut=this.viewportFrame;ut.x=f.x*$,ut.y=f.y*$,ut.width=f.width*$,ut.height=f.height*$,d||(ut.y=ot.view.height-(ut.y+ut.height)),ut.ceil(),this.renderer.framebuffer.bind(U,ut),this.renderer.projection.update(f,c,$,!U),d?this.renderer.mask.setMaskStack(E.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(c),this.destinationFrame.copyFrom(f)},T.prototype.clear=function(d,c){d=this.current?d||this.current.baseTexture.clearColor:d||this.clearColor;var f=this.destinationFrame,E=this.current?this.current.baseTexture:this.renderer.screen,U=f.width!==E.width||f.height!==E.height;if(U){var $=this.viewportFrame,ot=$.x,ut=$.y,It=$.width,kt=$.height;ot=Math.round(ot),ut=Math.round(ut),It=Math.round(It),kt=Math.round(kt),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(ot,ut,It,kt)}this.renderer.framebuffer.clear(d[0],d[1],d[2],d[3],c),U&&this.renderer.scissor.pop()},T.prototype.resize=function(){this.bind(null)},T.prototype.reset=function(){this.bind(null)},T.prototype.destroy=function(){this.renderer=null},T}();function eu(T,d,c,f,E){c.buffer.update(E)}var nu={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},fl={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function iu(T,d){if(!T.autoManage)return{size:0,syncFunc:eu};for(var c=function(Ze){for(var je=Ze.map(function(bn){return{data:bn,offset:0,dataLen:0,dirty:0}}),pn=0,_n=0,Un=0,Dn=0;Dn<je.length;Dn++){var Ye=je[Dn];if(pn=fl[Ye.data.type],Ye.data.size>1&&(pn=Math.max(pn,16)*Ye.data.size),Ye.dataLen=pn,_n%pn!=0&&_n<16){var an=_n%pn%16;_n+=an,Un+=an}_n+pn>16?(Un=16*Math.ceil(Un/16),Ye.offset=Un,Un+=pn,_n=pn):(Ye.offset=Un,_n+=pn,Un+=pn)}return{uboElements:je,size:Un=16*Math.ceil(Un/16)}}(function(Ze,je){var pn=[];for(var _n in Ze)je[_n]&&pn.push(je[_n]);return pn.sort(function(Un,Dn){return Un.index-Dn.index}),pn}(T.uniforms,d)),f=c.uboElements,E=c.size,U=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],$=0;$<f.length;$++){for(var ot=f[$],ut=T.uniforms[ot.data.name],It=ot.data.name,kt=!1,he=0;he<$e.length;he++){var te=$e[he];if(te.codeUbo&&te.test(ot.data,ut)){U.push("offset = "+ot.offset/4+";",$e[he].codeUbo(ot.data.name,ut)),kt=!0;break}}if(!kt)if(ot.data.size>1){var ge=Kt(ot.data.type),xe=Math.max(fl[ot.data.type]/16,1),Be=ge/xe,Je=(4-Be%4)%4;U.push(`
                cv = ud.`+It+`.value;
                v = uv.`+It+`;
                offset = `+ot.offset/4+`;

                t = 0;

                for(var i=0; i < `+ot.data.size*xe+`; i++)
                {
                    for(var j = 0; j < `+Be+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+Je+`;
                }

                `)}else{var qe=nu[ot.data.type];U.push(`
                cv = ud.`+It+`.value;
                v = uv.`+It+`;
                offset = `+ot.offset/4+`;
                `+qe+`;
                `)}}return U.push(`
       renderer.buffer.update(buffer);
    `),{size:E,syncFunc:new Function("ud","uv","renderer","syncData","buffer",U.join(`
`))}}var ru=function(){function T(d,c){this.program=d,this.uniformData=c,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return T.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},T}();function ou(T,d){var c=No(T,T.VERTEX_SHADER,d.vertexSrc),f=No(T,T.FRAGMENT_SHADER,d.fragmentSrc),E=T.createProgram();if(T.attachShader(E,c),T.attachShader(E,f),T.linkProgram(E),T.getProgramParameter(E,T.LINK_STATUS)||function(It,kt,he,te){It.getProgramParameter(kt,It.LINK_STATUS)||(It.getShaderParameter(he,It.COMPILE_STATUS)||Y(It,he),It.getShaderParameter(te,It.COMPILE_STATUS)||Y(It,te),console.error("PixiJS Error: Could not initialize shader."),It.getProgramInfoLog(kt)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",It.getProgramInfoLog(kt)))}(T,E,c,f),d.attributeData=function(It,kt){for(var he={},te=kt.getProgramParameter(It,kt.ACTIVE_ATTRIBUTES),ge=0;ge<te;ge++){var xe=kt.getActiveAttrib(It,ge);if(xe.name.indexOf("gl_")!==0){var Be=Te(kt,xe.type),Je={type:Be,name:xe.name,size:Kt(Be),location:kt.getAttribLocation(It,xe.name)};he[xe.name]=Je}}return he}(E,T),d.uniformData=function(It,kt){for(var he={},te=kt.getProgramParameter(It,kt.ACTIVE_UNIFORMS),ge=0;ge<te;ge++){var xe=kt.getActiveUniform(It,ge),Be=xe.name.replace(/\[.*?\]$/,""),Je=!!xe.name.match(/\[.*?\]$/),qe=Te(kt,xe.type);he[Be]={name:Be,index:ge,type:qe,size:xe.size,isArray:Je,value:m(qe,xe.size)}}return he}(E,T),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(d.vertexSrc)){var U=Object.keys(d.attributeData);U.sort(function(It,kt){return It>kt?1:-1});for(var $=0;$<U.length;$++)d.attributeData[U[$]].location=$,T.bindAttribLocation(E,$,U[$]);T.linkProgram(E)}T.deleteShader(c),T.deleteShader(f);var ot={};for(var $ in d.uniformData){var ut=d.uniformData[$];ot[$]={location:T.getUniformLocation(E,$),value:m(ut.type,ut.size)}}return new ru(E,ot)}var su=0,As={textureCount:0,uboCount:0},au=function(){function T(d){this.destroyed=!1,this.renderer=d,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=su++}return T.prototype.systemCheck=function(){if(!function(){if(typeof un=="boolean")return un;try{var d=new Function("param1","param2","param3","return param1[param2] === param3;");un=d({a:"b"},"a","b")===!0}catch{un=!1}return un}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},T.prototype.contextChange=function(d){this.gl=d,this.reset()},T.prototype.bind=function(d,c){d.uniforms.globals=this.renderer.globalUniforms;var f=d.program,E=f.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(d);return this.shader=d,this.program!==f&&(this.program=f,this.gl.useProgram(E.program)),c||(As.textureCount=0,As.uboCount=0,this.syncUniformGroup(d.uniformGroup,As)),E},T.prototype.setUniforms=function(d){var c=this.shader.program,f=c.glPrograms[this.renderer.CONTEXT_UID];c.syncUniforms(f.uniformData,d,this.renderer)},T.prototype.syncUniformGroup=function(d,c){var f=this.getGlProgram();d.static&&d.dirtyId===f.uniformDirtyGroups[d.id]||(f.uniformDirtyGroups[d.id]=d.dirtyId,this.syncUniforms(d,f,c))},T.prototype.syncUniforms=function(d,c,f){(d.syncUniforms[this.shader.program.id]||this.createSyncGroups(d))(c.uniformData,d.uniforms,this.renderer,f)},T.prototype.createSyncGroups=function(d){var c=this.getSignature(d,this.shader.program.uniformData,"u");return this.cache[c]||(this.cache[c]=function(f,E){var U,$=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var ot in f.uniforms){var ut=E[ot];if(ut){for(var It=f.uniforms[ot],kt=!1,he=0;he<$e.length;he++)if($e[he].test(ut,It)){$.push($e[he].code(ot,It)),kt=!0;break}if(!kt){var te=(ut.size===1?hn:vn)[ut.type].replace("location",'ud["'+ot+'"].location');$.push(`
            cu = ud["`+ot+`"];
            cv = cu.value;
            v = uv["`+ot+`"];
            `+te+";")}}else!((U=f.uniforms[ot])===null||U===void 0)&&U.group&&(f.uniforms[ot].ubo?$.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+ot+", '"+ot+`');
                    `):$.push(`
                        renderer.shader.syncUniformGroup(uv.`+ot+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",$.join(`
`))}(d,this.shader.program.uniformData)),d.syncUniforms[this.shader.program.id]=this.cache[c],d.syncUniforms[this.shader.program.id]},T.prototype.syncUniformBufferGroup=function(d,c){var f=this.getGlProgram();if(!d.static||d.dirtyId!==0||!f.uniformGroups[d.id]){d.dirtyId=0;var E=f.uniformGroups[d.id]||this.createSyncBufferGroup(d,f,c);d.buffer.update(),E(f.uniformData,d.uniforms,this.renderer,As,d.buffer)}this.renderer.buffer.bindBufferBase(d.buffer,f.uniformBufferBindings[c])},T.prototype.createSyncBufferGroup=function(d,c,f){var E=this.renderer.gl;this.renderer.buffer.bind(d.buffer);var U=this.gl.getUniformBlockIndex(c.program,f);c.uniformBufferBindings[f]=this.shader.uniformBindCount,E.uniformBlockBinding(c.program,U,this.shader.uniformBindCount),this.shader.uniformBindCount++;var $=this.getSignature(d,this.shader.program.uniformData,"ubo"),ot=this._uboCache[$];if(ot||(ot=this._uboCache[$]=iu(d,this.shader.program.uniformData)),d.autoManage){var ut=new Float32Array(ot.size/4);d.buffer.update(ut)}return c.uniformGroups[d.id]=ot.syncFunc,c.uniformGroups[d.id]},T.prototype.getSignature=function(d,c,f){var E=d.uniforms,U=[f+"-"];for(var $ in E)U.push($),c[$]&&U.push(c[$].type);return U.join("-")},T.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},T.prototype.generateProgram=function(d){var c=this.gl,f=d.program,E=ou(c,f);return f.glPrograms[this.renderer.CONTEXT_UID]=E,E},T.prototype.reset=function(){this.program=null,this.shader=null},T.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},T}(),lu=function(){function T(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=M.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new ui,this.defaultState.blend=!0}return T.prototype.contextChange=function(d){this.gl=d,this.blendModes=function(c,f){return f===void 0&&(f=[]),f[M.b.NORMAL]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.ADD]=[c.ONE,c.ONE],f[M.b.MULTIPLY]=[c.DST_COLOR,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.SCREEN]=[c.ONE,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.OVERLAY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.DARKEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.LIGHTEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.COLOR_DODGE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.COLOR_BURN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.HARD_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.SOFT_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.DIFFERENCE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.EXCLUSION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.HUE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.SATURATION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.COLOR]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.LUMINOSITY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.NONE]=[0,0],f[M.b.NORMAL_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.ADD_NPM]=[c.SRC_ALPHA,c.ONE,c.ONE,c.ONE],f[M.b.SCREEN_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[M.b.SRC_IN]=[c.DST_ALPHA,c.ZERO],f[M.b.SRC_OUT]=[c.ONE_MINUS_DST_ALPHA,c.ZERO],f[M.b.SRC_ATOP]=[c.DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[M.b.DST_OVER]=[c.ONE_MINUS_DST_ALPHA,c.ONE],f[M.b.DST_IN]=[c.ZERO,c.SRC_ALPHA],f[M.b.DST_OUT]=[c.ZERO,c.ONE_MINUS_SRC_ALPHA],f[M.b.DST_ATOP]=[c.ONE_MINUS_DST_ALPHA,c.SRC_ALPHA],f[M.b.XOR]=[c.ONE_MINUS_DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[M.b.SUBTRACT]=[c.ONE,c.ONE,c.ONE,c.ONE,c.FUNC_REVERSE_SUBTRACT,c.FUNC_ADD],f}(d),this.set(this.defaultState),this.reset()},T.prototype.set=function(d){if(d=d||this.defaultState,this.stateId!==d.data){for(var c=this.stateId^d.data,f=0;c;)1&c&&this.map[f].call(this,!!(d.data&1<<f)),c>>=1,f++;this.stateId=d.data}for(f=0;f<this.checks.length;f++)this.checks[f](this,d)},T.prototype.forceState=function(d){d=d||this.defaultState;for(var c=0;c<this.map.length;c++)this.map[c].call(this,!!(d.data&1<<c));for(c=0;c<this.checks.length;c++)this.checks[c](this,d);this.stateId=d.data},T.prototype.setBlend=function(d){this.updateCheck(T.checkBlendMode,d),this.gl[d?"enable":"disable"](this.gl.BLEND)},T.prototype.setOffset=function(d){this.updateCheck(T.checkPolygonOffset,d),this.gl[d?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},T.prototype.setDepthTest=function(d){this.gl[d?"enable":"disable"](this.gl.DEPTH_TEST)},T.prototype.setDepthMask=function(d){this.gl.depthMask(d)},T.prototype.setCullFace=function(d){this.gl[d?"enable":"disable"](this.gl.CULL_FACE)},T.prototype.setFrontFace=function(d){this.gl.frontFace(this.gl[d?"CW":"CCW"])},T.prototype.setBlendMode=function(d){if(d!==this.blendMode){this.blendMode=d;var c=this.blendModes[d],f=this.gl;c.length===2?f.blendFunc(c[0],c[1]):f.blendFuncSeparate(c[0],c[1],c[2],c[3]),c.length===6?(this._blendEq=!0,f.blendEquationSeparate(c[4],c[5])):this._blendEq&&(this._blendEq=!1,f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD))}},T.prototype.setPolygonOffset=function(d,c){this.gl.polygonOffset(d,c)},T.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},T.prototype.updateCheck=function(d,c){var f=this.checks.indexOf(d);c&&f===-1?this.checks.push(d):c||f===-1||this.checks.splice(f,1)},T.checkBlendMode=function(d,c){d.setBlendMode(c.blendMode)},T.checkPolygonOffset=function(d,c){d.setPolygonOffset(1,c.polygonOffset)},T.prototype.destroy=function(){this.gl=null},T}(),ml=function(){function T(d){this.renderer=d,this.count=0,this.checkCount=0,this.maxIdle=R.b.GC_MAX_IDLE,this.checkCountMax=R.b.GC_MAX_CHECK_COUNT,this.mode=R.b.GC_MODE}return T.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==M.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},T.prototype.run=function(){for(var d=this.renderer.texture,c=d.managedTextures,f=!1,E=0;E<c.length;E++){var U=c[E];!U.framebuffer&&this.count-U.touched>this.maxIdle&&(d.destroyTexture(U,!0),c[E]=null,f=!0)}if(f){var $=0;for(E=0;E<c.length;E++)c[E]!==null&&(c[$++]=c[E]);c.length=$}},T.prototype.unload=function(d){var c=this.renderer.texture,f=d._texture;f&&!f.framebuffer&&c.destroyTexture(f);for(var E=d.children.length-1;E>=0;E--)this.unload(d.children[E])},T.prototype.destroy=function(){this.renderer=null},T}(),Ms=function(T){this.texture=T,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=M.r.UNSIGNED_BYTE,this.internalFormat=M.h.RGBA,this.samplerType=0},gl=function(){function T(d){this.renderer=d,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new jn,this.hasIntegerTextures=!1}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(U){var $,ot,ut,It,kt,he,te,ge,xe,Be,Je,qe,Ze,je,pn,_n,Un,Dn,Ye,an,bn,Gn,qn;return"WebGL2RenderingContext"in globalThis&&U instanceof globalThis.WebGL2RenderingContext?(($={})[M.r.UNSIGNED_BYTE]=((ot={})[M.h.RGBA]=U.RGBA8,ot[M.h.RGB]=U.RGB8,ot[M.h.RG]=U.RG8,ot[M.h.RED]=U.R8,ot[M.h.RGBA_INTEGER]=U.RGBA8UI,ot[M.h.RGB_INTEGER]=U.RGB8UI,ot[M.h.RG_INTEGER]=U.RG8UI,ot[M.h.RED_INTEGER]=U.R8UI,ot[M.h.ALPHA]=U.ALPHA,ot[M.h.LUMINANCE]=U.LUMINANCE,ot[M.h.LUMINANCE_ALPHA]=U.LUMINANCE_ALPHA,ot),$[M.r.BYTE]=((ut={})[M.h.RGBA]=U.RGBA8_SNORM,ut[M.h.RGB]=U.RGB8_SNORM,ut[M.h.RG]=U.RG8_SNORM,ut[M.h.RED]=U.R8_SNORM,ut[M.h.RGBA_INTEGER]=U.RGBA8I,ut[M.h.RGB_INTEGER]=U.RGB8I,ut[M.h.RG_INTEGER]=U.RG8I,ut[M.h.RED_INTEGER]=U.R8I,ut),$[M.r.UNSIGNED_SHORT]=((It={})[M.h.RGBA_INTEGER]=U.RGBA16UI,It[M.h.RGB_INTEGER]=U.RGB16UI,It[M.h.RG_INTEGER]=U.RG16UI,It[M.h.RED_INTEGER]=U.R16UI,It[M.h.DEPTH_COMPONENT]=U.DEPTH_COMPONENT16,It),$[M.r.SHORT]=((kt={})[M.h.RGBA_INTEGER]=U.RGBA16I,kt[M.h.RGB_INTEGER]=U.RGB16I,kt[M.h.RG_INTEGER]=U.RG16I,kt[M.h.RED_INTEGER]=U.R16I,kt),$[M.r.UNSIGNED_INT]=((he={})[M.h.RGBA_INTEGER]=U.RGBA32UI,he[M.h.RGB_INTEGER]=U.RGB32UI,he[M.h.RG_INTEGER]=U.RG32UI,he[M.h.RED_INTEGER]=U.R32UI,he[M.h.DEPTH_COMPONENT]=U.DEPTH_COMPONENT24,he),$[M.r.INT]=((te={})[M.h.RGBA_INTEGER]=U.RGBA32I,te[M.h.RGB_INTEGER]=U.RGB32I,te[M.h.RG_INTEGER]=U.RG32I,te[M.h.RED_INTEGER]=U.R32I,te),$[M.r.FLOAT]=((ge={})[M.h.RGBA]=U.RGBA32F,ge[M.h.RGB]=U.RGB32F,ge[M.h.RG]=U.RG32F,ge[M.h.RED]=U.R32F,ge[M.h.DEPTH_COMPONENT]=U.DEPTH_COMPONENT32F,ge),$[M.r.HALF_FLOAT]=((xe={})[M.h.RGBA]=U.RGBA16F,xe[M.h.RGB]=U.RGB16F,xe[M.h.RG]=U.RG16F,xe[M.h.RED]=U.R16F,xe),$[M.r.UNSIGNED_SHORT_5_6_5]=((Be={})[M.h.RGB]=U.RGB565,Be),$[M.r.UNSIGNED_SHORT_4_4_4_4]=((Je={})[M.h.RGBA]=U.RGBA4,Je),$[M.r.UNSIGNED_SHORT_5_5_5_1]=((qe={})[M.h.RGBA]=U.RGB5_A1,qe),$[M.r.UNSIGNED_INT_2_10_10_10_REV]=((Ze={})[M.h.RGBA]=U.RGB10_A2,Ze[M.h.RGBA_INTEGER]=U.RGB10_A2UI,Ze),$[M.r.UNSIGNED_INT_10F_11F_11F_REV]=((je={})[M.h.RGB]=U.R11F_G11F_B10F,je),$[M.r.UNSIGNED_INT_5_9_9_9_REV]=((pn={})[M.h.RGB]=U.RGB9_E5,pn),$[M.r.UNSIGNED_INT_24_8]=((_n={})[M.h.DEPTH_STENCIL]=U.DEPTH24_STENCIL8,_n),$[M.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((Un={})[M.h.DEPTH_STENCIL]=U.DEPTH32F_STENCIL8,Un),qn=$):((Dn={})[M.r.UNSIGNED_BYTE]=((Ye={})[M.h.RGBA]=U.RGBA,Ye[M.h.RGB]=U.RGB,Ye[M.h.ALPHA]=U.ALPHA,Ye[M.h.LUMINANCE]=U.LUMINANCE,Ye[M.h.LUMINANCE_ALPHA]=U.LUMINANCE_ALPHA,Ye),Dn[M.r.UNSIGNED_SHORT_5_6_5]=((an={})[M.h.RGB]=U.RGB,an),Dn[M.r.UNSIGNED_SHORT_4_4_4_4]=((bn={})[M.h.RGBA]=U.RGBA,bn),Dn[M.r.UNSIGNED_SHORT_5_5_5_1]=((Gn={})[M.h.RGBA]=U.RGBA,Gn),qn=Dn),qn}(d);var c=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=c;for(var f=0;f<c;f++)this.boundTextures[f]=null;this.emptyTextures={};var E=new Ms(d.createTexture());for(d.bindTexture(d.TEXTURE_2D,E.texture),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[d.TEXTURE_2D]=E,this.emptyTextures[d.TEXTURE_CUBE_MAP]=new Ms(d.createTexture()),d.bindTexture(d.TEXTURE_CUBE_MAP,this.emptyTextures[d.TEXTURE_CUBE_MAP].texture),f=0;f<6;f++)d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,null);for(d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR),f=0;f<this.boundTextures.length;f++)this.bind(null,f)},T.prototype.bind=function(d,c){c===void 0&&(c=0);var f=this.gl;if((d=d==null?void 0:d.castToBaseTexture())&&d.valid&&!d.parentTextureArray){d.touched=this.renderer.textureGC.count;var E=d._glTextures[this.CONTEXT_UID]||this.initTexture(d);this.boundTextures[c]!==d&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(d.target,E.texture)),E.dirtyId!==d.dirtyId&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),this.updateTexture(d)),this.boundTextures[c]=d}else this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(f.TEXTURE_2D,this.emptyTextures[f.TEXTURE_2D].texture),this.boundTextures[c]=null},T.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var d=0;d<this.boundTextures.length;d++)this.boundTextures[d]=this.unknownTexture},T.prototype.unbind=function(d){var c=this.gl,f=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var E=0;E<f.length;E++)f[E]===this.unknownTexture&&this.bind(null,E)}for(E=0;E<f.length;E++)f[E]===d&&(this.currentLocation!==E&&(c.activeTexture(c.TEXTURE0+E),this.currentLocation=E),c.bindTexture(d.target,this.emptyTextures[d.target].texture),f[E]=null)},T.prototype.ensureSamplerType=function(d){var c=this.boundTextures,f=this.hasIntegerTextures,E=this.CONTEXT_UID;if(f)for(var U=d-1;U>=0;--U){var $=c[U];$&&$._glTextures[E].samplerType!==M.o.FLOAT&&this.renderer.texture.unbind($)}},T.prototype.initTexture=function(d){var c=new Ms(this.gl.createTexture());return c.dirtyId=-1,d._glTextures[this.CONTEXT_UID]=c,this.managedTextures.push(d),d.on("dispose",this.destroyTexture,this),c},T.prototype.initTextureType=function(d,c){var f,E;c.internalFormat=(E=(f=this.internalFormats[d.type])===null||f===void 0?void 0:f[d.format])!==null&&E!==void 0?E:d.format,this.webGLVersion===2&&d.type===M.r.HALF_FLOAT?c.type=this.gl.HALF_FLOAT:c.type=d.type},T.prototype.updateTexture=function(d){var c=d._glTextures[this.CONTEXT_UID];if(c){var f=this.renderer;if(this.initTextureType(d,c),d.resource&&d.resource.upload(f,d,c))c.samplerType!==M.o.FLOAT&&(this.hasIntegerTextures=!0);else{var E=d.realWidth,U=d.realHeight,$=f.gl;(c.width!==E||c.height!==U||c.dirtyId<0)&&(c.width=E,c.height=U,$.texImage2D(d.target,0,c.internalFormat,E,U,0,d.format,c.type,null))}d.dirtyStyleId!==c.dirtyStyleId&&this.updateTextureStyle(d),c.dirtyId=d.dirtyId}},T.prototype.destroyTexture=function(d,c){var f=this.gl;if((d=d.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(d),f.deleteTexture(d._glTextures[this.CONTEXT_UID].texture),d.off("dispose",this.destroyTexture,this),delete d._glTextures[this.CONTEXT_UID],!c)){var E=this.managedTextures.indexOf(d);E!==-1&&function(U,$,ot){var ut,It=U.length;if(!($>=It||ot===0)){var kt=It-(ot=$+ot>It?It-$:ot);for(ut=$;ut<kt;++ut)U[ut]=U[ut+ot];U.length=kt}}(this.managedTextures,E,1)}},T.prototype.updateTextureStyle=function(d){var c=d._glTextures[this.CONTEXT_UID];c&&(d.mipmap!==M.k.POW2&&this.webGLVersion===2||d.isPowerOfTwo?c.mipmap=d.mipmap>=1:c.mipmap=!1,this.webGLVersion===2||d.isPowerOfTwo?c.wrapMode=d.wrapMode:c.wrapMode=M.s.CLAMP,d.resource&&d.resource.style(this.renderer,d,c)||this.setStyle(d,c),c.dirtyStyleId=d.dirtyStyleId)},T.prototype.setStyle=function(d,c){var f=this.gl;if(c.mipmap&&d.mipmap!==M.k.ON_MANUAL&&f.generateMipmap(d.target),f.texParameteri(d.target,f.TEXTURE_WRAP_S,c.wrapMode),f.texParameteri(d.target,f.TEXTURE_WRAP_T,c.wrapMode),c.mipmap){f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===M.p.LINEAR?f.LINEAR_MIPMAP_LINEAR:f.NEAREST_MIPMAP_NEAREST);var E=this.renderer.context.extensions.anisotropicFiltering;if(E&&d.anisotropicLevel>0&&d.scaleMode===M.p.LINEAR){var U=Math.min(d.anisotropicLevel,f.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT));f.texParameterf(d.target,E.TEXTURE_MAX_ANISOTROPY_EXT,U)}}else f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===M.p.LINEAR?f.LINEAR:f.NEAREST);f.texParameteri(d.target,f.TEXTURE_MAG_FILTER,d.scaleMode===M.p.LINEAR?f.LINEAR:f.NEAREST)},T.prototype.destroy=function(){this.renderer=null},T}(),ga=new Ee,hu=function(T){function d(c,f){c===void 0&&(c=M.n.UNKNOWN);var E=T.call(this)||this;return f=Object.assign({},R.b.RENDER_OPTIONS,f),E.options=f,E.type=c,E.screen=new oe(0,0,f.width,f.height),E.view=f.view||document.createElement("canvas"),E.resolution=f.resolution||R.b.RESOLUTION,E.useContextAlpha=f.useContextAlpha,E.autoDensity=!!f.autoDensity,E.preserveDrawingBuffer=f.preserveDrawingBuffer,E.clearBeforeRender=f.clearBeforeRender,E._backgroundColor=0,E._backgroundColorRgba=[0,0,0,1],E._backgroundColorString="#000000",E.backgroundColor=f.backgroundColor||E._backgroundColor,E.backgroundAlpha=f.backgroundAlpha,f.transparent!==void 0&&(Rn("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),E.useContextAlpha=f.transparent,E.backgroundAlpha=f.transparent?0:1),E._lastObjectRendered=null,E.plugins={},E}return Fn(d,T),d.prototype.initPlugins=function(c){for(var f in c)this.plugins[f]=new c[f](this)},Object.defineProperty(d.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f){this.view.width=Math.round(c*this.resolution),this.view.height=Math.round(f*this.resolution);var E=this.view.width/this.resolution,U=this.view.height/this.resolution;this.screen.width=E,this.screen.height=U,this.autoDensity&&(this.view.style.width=E+"px",this.view.style.height=U+"px"),this.emit("resize",E,U)},d.prototype.generateTexture=function(c,f,E,U){f===void 0&&(f={}),typeof f=="number"&&(Rn("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),f={scaleMode:f,resolution:E,region:U});var $=f.region,ot=function(It,kt){var he={};for(var te in It)Object.prototype.hasOwnProperty.call(It,te)&&kt.indexOf(te)<0&&(he[te]=It[te]);if(It!=null&&typeof Object.getOwnPropertySymbols=="function"){var ge=0;for(te=Object.getOwnPropertySymbols(It);ge<te.length;ge++)kt.indexOf(te[ge])<0&&(he[te[ge]]=It[te[ge]])}return he}(f,["region"]);(U=$||c.getLocalBounds(null,!0)).width===0&&(U.width=1),U.height===0&&(U.height=1);var ut=ao.create($o({width:U.width,height:U.height},ot));return ga.tx=-U.x,ga.ty=-U.y,this.render(c,{renderTexture:ut,clear:!1,transform:ga,skipUpdateTransform:!!c.parent}),ut},d.prototype.destroy=function(c){for(var f in this.plugins)this.plugins[f].destroy(),this.plugins[f]=null;c&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=M.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(d.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(c){var f;this._backgroundColor=c,this._backgroundColorString=(f=c.toString(16),"#"+(f="000000".substring(0,6-f.length)+f)),function(E,U){U===void 0&&(U=[]),U[0]=(E>>16&255)/255,U[1]=(E>>8&255)/255,U[2]=(255&E)/255}(c,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(c){this._backgroundColorRgba[3]=c},enumerable:!1,configurable:!0}),d}(et),vl=function(T){this.buffer=T||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},_l=function(){function T(d){this.renderer=d,this.managedBuffers={},this.boundBufferBases={}}return T.prototype.destroy=function(){this.renderer=null},T.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},T.prototype.bind=function(d){var c=this.gl,f=this.CONTEXT_UID,E=d._glBuffers[f]||this.createGLBuffer(d);c.bindBuffer(d.type,E.buffer)},T.prototype.bindBufferBase=function(d,c){var f=this.gl,E=this.CONTEXT_UID;if(this.boundBufferBases[c]!==d){var U=d._glBuffers[E]||this.createGLBuffer(d);this.boundBufferBases[c]=d,f.bindBufferBase(f.UNIFORM_BUFFER,c,U.buffer)}},T.prototype.bindBufferRange=function(d,c,f){var E=this.gl,U=this.CONTEXT_UID;f=f||0;var $=d._glBuffers[U]||this.createGLBuffer(d);E.bindBufferRange(E.UNIFORM_BUFFER,c||0,$.buffer,256*f,256)},T.prototype.update=function(d){var c=this.gl,f=this.CONTEXT_UID,E=d._glBuffers[f];if(d._updateID!==E.updateID)if(E.updateID=d._updateID,c.bindBuffer(d.type,E.buffer),E.byteLength>=d.data.byteLength)c.bufferSubData(d.type,0,d.data);else{var U=d.static?c.STATIC_DRAW:c.DYNAMIC_DRAW;E.byteLength=d.data.byteLength,c.bufferData(d.type,d.data,U)}},T.prototype.dispose=function(d,c){if(this.managedBuffers[d.id]){delete this.managedBuffers[d.id];var f=d._glBuffers[this.CONTEXT_UID],E=this.gl;d.disposeRunner.remove(this),f&&(c||E.deleteBuffer(f.buffer),delete d._glBuffers[this.CONTEXT_UID])}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedBuffers),f=0;f<c.length;f++)this.dispose(this.managedBuffers[c[f]],d)},T.prototype.createGLBuffer=function(d){var c=this.CONTEXT_UID,f=this.gl;return d._glBuffers[c]=new vl(f.createBuffer()),this.managedBuffers[d.id]=d,d.disposeRunner.add(this),d._glBuffers[c]},T}();(function(T){function d(c){var f=T.call(this,M.n.WEBGL,c)||this;return c=f.options,f.gl=null,f.CONTEXT_UID=0,f.runners={destroy:new tn("destroy"),contextChange:new tn("contextChange"),reset:new tn("reset"),update:new tn("update"),postrender:new tn("postrender"),prerender:new tn("prerender"),resize:new tn("resize")},f.runners.contextChange.add(f),f.globalUniforms=new wi({projectionMatrix:new Ee},!0),f.addSystem(os,"mask").addSystem(Br,"context").addSystem(lu,"state").addSystem(au,"shader").addSystem(gl,"texture").addSystem(_l,"buffer").addSystem(Oo,"geometry").addSystem(Rr,"framebuffer").addSystem(sn,"scissor").addSystem(Pr,"stencil").addSystem(Qh,"projection").addSystem(ml,"textureGC").addSystem(lo,"filter").addSystem(tu,"renderTexture").addSystem(Wn,"batch"),f.initPlugins(d.__plugins),f.multisample=void 0,c.context?f.context.initFromContext(c.context):f.context.initFromOptions({alpha:!!f.useContextAlpha,antialias:c.antialias,premultipliedAlpha:f.useContextAlpha&&f.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer,powerPreference:f.options.powerPreference}),f.renderingToScreen=!0,function(E){var U;if(!_e){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var $=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+E+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(U=globalThis.console).log.apply(U,$)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+E+" - http://www.pixijs.com/");_e=!0}}(f.context.webGLVersion===2?"WebGL 2":"WebGL 1"),f.resize(f.options.width,f.options.height),f}Fn(d,T),d.create=function(c){if(at===void 0&&(at=function(){var f={stencil:!0,failIfMajorPerformanceCaveat:R.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var E=document.createElement("canvas"),U=E.getContext("webgl",f)||E.getContext("experimental-webgl",f),$=!(!U||!U.getContextAttributes().stencil);if(U){var ot=U.getExtension("WEBGL_lose_context");ot&&ot.loseContext()}return U=null,$}catch{return!1}}()),at)return new d(c);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},d.prototype.contextChange=function(){var c,f=this.gl;if(this.context.webGLVersion===1){var E=f.getParameter(f.FRAMEBUFFER_BINDING);f.bindFramebuffer(f.FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.FRAMEBUFFER,E)}else E=f.getParameter(f.DRAW_FRAMEBUFFER_BINDING),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,E);c>=M.l.HIGH?this.multisample=M.l.HIGH:c>=M.l.MEDIUM?this.multisample=M.l.MEDIUM:c>=M.l.LOW?this.multisample=M.l.LOW:this.multisample=M.l.NONE},d.prototype.addSystem=function(c,f){var E=new c(this);if(this[f])throw new Error('Whoops! The name "'+f+'" is already in use');for(var U in this[f]=E,this.runners)this.runners[U].add(E);return this},d.prototype.render=function(c,f){var E,U,$,ot;if(f&&(f instanceof ao?(Rn("6.0.0","Renderer#render arguments changed, use options instead."),E=f,U=arguments[2],$=arguments[3],ot=arguments[4]):(E=f.renderTexture,U=f.clear,$=f.transform,ot=f.skipUpdateTransform)),this.renderingToScreen=!E,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=$,!this.context.isLost){if(E||(this._lastObjectRendered=c),!ot){var ut=c.enableTempParent();c.updateTransform(),c.disableTempParent(ut)}this.renderTexture.bind(E),this.batch.currentRenderer.start(),(U!==void 0?U:this.clearBeforeRender)&&this.renderTexture.clear(),c.render(this),this.batch.currentRenderer.flush(),E&&E.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},d.prototype.generateTexture=function(c,f,E,U){f===void 0&&(f={});var $=T.prototype.generateTexture.call(this,c,f,E,U);return this.framebuffer.blit(),$},d.prototype.resize=function(c,f){T.prototype.resize.call(this,c,f),this.runners.resize.emit(this.screen.height,this.screen.width)},d.prototype.reset=function(){return this.runners.reset.emit(),this},d.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},d.prototype.destroy=function(c){for(var f in this.runners.destroy.emit(),this.runners)this.runners[f].destroy();T.prototype.destroy.call(this,c),this.gl=null},Object.defineProperty(d.prototype,"extract",{get:function(){return Rn("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),d.registerPlugin=function(c,f){d.__plugins=d.__plugins||{},d.__plugins[c]=f}})(hu);var yl=function(){this.texArray=null,this.blend=0,this.type=M.f.TRIANGLES,this.start=0,this.size=0,this.data=null},xl=function(){function T(){this.elements=[],this.ids=[],this.count=0}return T.prototype.clear=function(){for(var d=0;d<this.count;d++)this.elements[d]=null;this.count=0},T}(),bl=function(){function T(d){typeof d=="number"?this.rawBinaryData=new ArrayBuffer(d):d instanceof Uint8Array?this.rawBinaryData=d.buffer:this.rawBinaryData=d,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(T.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),T.prototype.view=function(d){return this[d+"View"]},T.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},T.sizeOf=function(d){switch(d){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(d+" isn't a valid view type")}},T}(),Tl=function(T){function d(c){var f=T.call(this,c)||this;return f.shaderGenerator=null,f.geometryClass=null,f.vertexSize=null,f.state=ui.for2d(),f.size=4*R.b.SPRITE_BATCH_SIZE,f._vertexCount=0,f._indexCount=0,f._bufferedElements=[],f._bufferedTextures=[],f._bufferSize=0,f._shader=null,f._packedGeometries=[],f._packedGeometryPoolSize=2,f._flushId=0,f._aBuffers={},f._iBuffers={},f.MAX_TEXTURES=1,f.renderer.on("prerender",f.onPrerender,f),c.runners.contextChange.add(f),f._dcIndex=0,f._aIndex=0,f._iIndex=0,f._attributeBuffer=null,f._indexBuffer=null,f._tempBoundTextures=[],f}return Fn(d,T),d.prototype.contextChange=function(){var c=this.renderer.gl;R.b.PREFER_ENV===M.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),R.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(E,U){if(E===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var $=U.createShader(U.FRAGMENT_SHADER);;){var ot=Kn.replace(/%forloop%/gi,_i(E));if(U.shaderSource($,ot),U.compileShader($),U.getShaderParameter($,U.COMPILE_STATUS))break;E=E/2|0}return E}(this.MAX_TEXTURES,c)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var f=0;f<this._packedGeometryPoolSize;f++)this._packedGeometries[f]=new this.geometryClass;this.initFlushBuffers()},d.prototype.initFlushBuffers=function(){for(var c=d._drawCallPool,f=d._textureArrayPool,E=this.size/4,U=Math.floor(E/this.MAX_TEXTURES)+1;c.length<E;)c.push(new yl);for(;f.length<U;)f.push(new xl);for(var $=0;$<this.MAX_TEXTURES;$++)this._tempBoundTextures[$]=null},d.prototype.onPrerender=function(){this._flushId=0},d.prototype.render=function(c){c._texture.valid&&(this._vertexCount+c.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=c.vertexData.length/2,this._indexCount+=c.indices.length,this._bufferedTextures[this._bufferSize]=c._texture.baseTexture,this._bufferedElements[this._bufferSize++]=c)},d.prototype.buildTexturesAndDrawCalls=function(){var c=this._bufferedTextures,f=this.MAX_TEXTURES,E=d._textureArrayPool,U=this.renderer.batch,$=this._tempBoundTextures,ot=this.renderer.textureGC.count,ut=++jn._globalBatch,It=0,kt=E[0],he=0;U.copyBoundTextures($,f);for(var te=0;te<this._bufferSize;++te){var ge=c[te];c[te]=null,ge._batchEnabled!==ut&&(kt.count>=f&&(U.boundArray(kt,$,ut,f),this.buildDrawCalls(kt,he,te),he=te,kt=E[++It],++ut),ge._batchEnabled=ut,ge.touched=ot,kt.elements[kt.count++]=ge)}for(kt.count>0&&(U.boundArray(kt,$,ut,f),this.buildDrawCalls(kt,he,this._bufferSize),++It,++ut),te=0;te<$.length;te++)$[te]=null;jn._globalBatch=ut},d.prototype.buildDrawCalls=function(c,f,E){var U=this._bufferedElements,$=this._attributeBuffer,ot=this._indexBuffer,ut=this.vertexSize,It=d._drawCallPool,kt=this._dcIndex,he=this._aIndex,te=this._iIndex,ge=It[kt];ge.start=this._iIndex,ge.texArray=c;for(var xe=f;xe<E;++xe){var Be=U[xe],Je=Be._texture.baseTexture,qe=ke[Je.alphaMode?1:0][Be.blendMode];U[xe]=null,f<xe&&ge.blend!==qe&&(ge.size=te-ge.start,f=xe,(ge=It[++kt]).texArray=c,ge.start=te),this.packInterleavedGeometry(Be,$,ot,he,te),he+=Be.vertexData.length/2*ut,te+=Be.indices.length,ge.blend=qe}f<E&&(ge.size=te-ge.start,++kt),this._dcIndex=kt,this._aIndex=he,this._iIndex=te},d.prototype.bindAndClearTexArray=function(c){for(var f=this.renderer.texture,E=0;E<c.count;E++)f.bind(c.elements[E],c.ids[E]),c.elements[E]=null;c.count=0},d.prototype.updateGeometry=function(){var c=this._packedGeometries,f=this._attributeBuffer,E=this._indexBuffer;R.b.CAN_UPLOAD_SAME_BUFFER?(c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(E),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,c[this._flushId]=new this.geometryClass),c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(E),this.renderer.geometry.bind(c[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},d.prototype.drawBatches=function(){for(var c=this._dcIndex,f=this.renderer,E=f.gl,U=f.state,$=d._drawCallPool,ot=null,ut=0;ut<c;ut++){var It=$[ut],kt=It.texArray,he=It.type,te=It.size,ge=It.start,xe=It.blend;ot!==kt&&(ot=kt,this.bindAndClearTexArray(kt)),this.state.blendMode=xe,U.set(this.state),E.drawElements(he,te,E.UNSIGNED_SHORT,2*ge)}},d.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},d.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),R.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},d.prototype.stop=function(){this.flush()},d.prototype.destroy=function(){for(var c=0;c<this._packedGeometryPoolSize;c++)this._packedGeometries[c]&&this._packedGeometries[c].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),T.prototype.destroy.call(this)},d.prototype.getAttributeBuffer=function(c){var f=Ae(Math.ceil(c/8)),E=Qe(f),U=8*f;this._aBuffers.length<=E&&(this._iBuffers.length=E+1);var $=this._aBuffers[U];return $||(this._aBuffers[U]=$=new bl(U*this.vertexSize*4)),$},d.prototype.getIndexBuffer=function(c){var f=Ae(Math.ceil(c/12)),E=Qe(f),U=12*f;this._iBuffers.length<=E&&(this._iBuffers.length=E+1);var $=this._iBuffers[E];return $||(this._iBuffers[E]=$=new Uint16Array(U)),$},d.prototype.packInterleavedGeometry=function(c,f,E,U,$){for(var ot=f.uint32View,ut=f.float32View,It=U/this.vertexSize,kt=c.uvs,he=c.indices,te=c.vertexData,ge=c._texture.baseTexture._batchLocation,xe=Math.min(c.worldAlpha,1),Be=xe<1&&c._texture.baseTexture.alphaMode?function(qe,Ze){if(Ze===1)return(255*Ze<<24)+qe;if(Ze===0)return 0;var je=qe>>16&255,pn=qe>>8&255,_n=255&qe;return(255*Ze<<24)+((je=je*Ze+.5|0)<<16)+((pn=pn*Ze+.5|0)<<8)+(_n=_n*Ze+.5|0)}(c._tintRGB,xe):c._tintRGB+(255*xe<<24),Je=0;Je<te.length;Je+=2)ut[U++]=te[Je],ut[U++]=te[Je+1],ut[U++]=kt[Je],ut[U++]=kt[Je+1],ot[U++]=Be,ut[U++]=ge;for(Je=0;Je<he.length;Je++)E[$++]=It+he[Je]},d._drawCallPool=[],d._textureArrayPool=[],d}(vi),Do=function(){function T(d,c){if(this.vertexSrc=d,this.fragTemplate=c,this.programCache={},this.defaultGroupCache={},c.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(c.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return T.prototype.generateShader=function(d){if(!this.programCache[d]){for(var c=new Int32Array(d),f=0;f<d;f++)c[f]=f;this.defaultGroupCache[d]=wi.from({uSamplers:c},!0);var E=this.fragTemplate;E=(E=E.replace(/%count%/gi,""+d)).replace(/%forloop%/gi,this.generateSampleSrc(d)),this.programCache[d]=new Bi(this.vertexSrc,E)}var U={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ee,default:this.defaultGroupCache[d]};return new ki(this.programCache[d],U)},T.prototype.generateSampleSrc=function(d){var c="";c+=`
`,c+=`
`;for(var f=0;f<d;f++)f>0&&(c+=`
else `),f<d-1&&(c+="if(vTextureId < "+f+".5)"),c+=`
{`,c+=`
	color = texture2D(uSamplers[`+f+"], vTextureCoord);",c+=`
}`;return c+=`
`,c+=`
`},T}(),Ji=function(T){function d(c){c===void 0&&(c=!1);var f=T.call(this)||this;return f._buffer=new Mn(null,c,!1),f._indexBuffer=new Mn(null,c,!0),f.addAttribute("aVertexPosition",f._buffer,2,!1,M.r.FLOAT).addAttribute("aTextureCoord",f._buffer,2,!1,M.r.FLOAT).addAttribute("aColor",f._buffer,4,!0,M.r.UNSIGNED_BYTE).addAttribute("aTextureId",f._buffer,1,!0,M.r.FLOAT).addIndex(f._indexBuffer),f}return Fn(d,T),d}(Ro),Ui=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,va=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;(function(){function T(){}return T.create=function(d){var c=Object.assign({vertex:Ui,fragment:va,geometryClass:Ji,vertexSize:6},d),f=c.vertex,E=c.fragment,U=c.vertexSize,$=c.geometryClass;return function(ot){function ut(It){var kt=ot.call(this,It)||this;return kt.shaderGenerator=new Do(f,E),kt.geometryClass=$,kt.vertexSize=U,kt}return Fn(ut,ot),ut}(Tl)},Object.defineProperty(T,"defaultVertexSrc",{get:function(){return Ui},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentTemplate",{get:function(){return va},enumerable:!1,configurable:!0}),T})().create();var uu=function(){function T(d){this.renderer=d}return T.prototype.render=function(d){var c=this.renderer,f=d.worldTransform;c.context.globalAlpha=d.worldAlpha,c.setBlendMode(d.blendMode),c.setContextTransform(f,d.roundPixels),d.drawMode!==M.f.TRIANGLES?this._renderTriangleMesh(d):this._renderTriangles(d)},T.prototype._renderTriangleMesh=function(d){for(var c=d.geometry.buffers[0].data.length,f=0;f<c-2;f++){var E=2*f;this._renderDrawTriangle(d,E,E+2,E+4)}},T.prototype._renderTriangles=function(d){for(var c=d.geometry.getIndex().data,f=c.length,E=0;E<f;E+=3){var U=2*c[E],$=2*c[E+1],ot=2*c[E+2];this._renderDrawTriangle(d,U,$,ot)}},T.prototype._renderDrawTriangle=function(d,c,f,E){var U=this.renderer.context,$=d.geometry.buffers[0].data,ot=d.uvs,ut=d.texture;if(ut.valid){var It=d.tint!==16777215,kt=ut.baseTexture,he=kt.width,te=kt.height;It&&d._cachedTint!==d.tint&&(d._cachedTint=d.tint,d._cachedTexture=d._cachedTexture||new Ao(kt),d._tintedCanvas=D.b.getTintedCanvas({texture:d._cachedTexture},d.tint));var ge=It?d._tintedCanvas:kt.getDrawableSource(),xe=ot[c]*kt.width,Be=ot[f]*kt.width,Je=ot[E]*kt.width,qe=ot[c+1]*kt.height,Ze=ot[f+1]*kt.height,je=ot[E+1]*kt.height,pn=$[c],_n=$[f],Un=$[E],Dn=$[c+1],Ye=$[f+1],an=$[E+1],bn=d.canvasPadding/this.renderer.resolution;if(bn>0){var Gn=d.worldTransform,qn=Gn.a,Ei=Gn.b,Qn=Gn.c,xi=Gn.d,Pi=(pn+_n+Un)/3,Zi=(Dn+Ye+an)/3,Gi=pn-Pi,ii=Dn-Zi,Ai=qn*Gi+Qn*ii,Hi=Ei*Gi+xi*ii,ji=Math.sqrt(Ai*Ai+Hi*Hi),er=1+bn/ji;pn=Pi+Gi*er,Dn=Zi+ii*er,Ai=qn*(Gi=_n-Pi)+Qn*(ii=Ye-Zi),Hi=Ei*Gi+xi*ii,_n=Pi+Gi*(er=1+bn/(ji=Math.sqrt(Ai*Ai+Hi*Hi))),Ye=Zi+ii*er,Ai=qn*(Gi=Un-Pi)+Qn*(ii=an-Zi),Hi=Ei*Gi+xi*ii,Un=Pi+Gi*(er=1+bn/(ji=Math.sqrt(Ai*Ai+Hi*Hi))),an=Zi+ii*er}U.save(),U.beginPath(),U.moveTo(pn,Dn),U.lineTo(_n,Ye),U.lineTo(Un,an),U.closePath(),U.clip();var ri=xe*Ze+qe*Je+Be*je-Ze*Je-qe*Be-xe*je,Sl=pn*Ze+qe*Un+_n*je-Ze*Un-qe*_n-pn*je,cu=xe*_n+pn*Je+Be*Un-_n*Je-pn*Be-xe*Un,El=xe*Ze*Un+qe*_n*Je+pn*Be*je-pn*Ze*Je-qe*Be*Un-xe*_n*je,Al=Dn*Ze+qe*an+Ye*je-Ze*an-qe*Ye-Dn*je,as=xe*Ye+Dn*Je+Be*an-Ye*Je-Dn*Be-xe*an,du=xe*Ze*an+qe*Ye*Je+Dn*Be*je-Dn*Ze*Je-qe*Be*an-xe*Ye*je;U.transform(Sl/ri,Al/ri,cu/ri,as/ri,El/ri,du/ri),U.drawImage(ge,0,0,he*kt.resolution,te*kt.resolution,0,0,he,te),U.restore(),this.renderer.invalidateBlendMode()}},T.prototype.renderMeshFlat=function(d){var c=this.renderer.context,f=d.geometry.getBuffer("aVertexPosition").data,E=f.length/2;c.beginPath();for(var U=1;U<E-2;++U){var $=2*U,ot=f[$],ut=f[$+1],It=f[$+2],kt=f[$+3],he=f[$+4],te=f[$+5];c.moveTo(ot,ut),c.lineTo(It,kt),c.lineTo(he,te)}c.fillStyle="#FF0000",c.fill(),c.closePath()},T.prototype.destroy=function(){this.renderer=null},T}();R.b.MESH_CANVAS_PADDING=0,B.c.prototype._renderCanvas=function(T,d){T.plugins.mesh.render(d)},z.a.prototype._cachedTint=16777215,z.a.prototype._tintedCanvas=null,z.a.prototype._canvasUvs=null,z.a.prototype._renderCanvas=function(T){var d=T.context,c=this.worldTransform,f=this.tint!==16777215,E=this.texture;if(E.valid){f&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=D.b.getTintedCanvas(this,this.tint));var U=f?this._tintedCanvas:E.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var $=this.vertices,ot=this._canvasUvs,ut=f?0:E.frame.x,It=f?0:E.frame.y,kt=ut+E.frame.width,he=It+E.frame.height;ot[0]=ut,ot[1]=ut+this._leftWidth,ot[2]=kt-this._rightWidth,ot[3]=kt,ot[4]=It,ot[5]=It+this._topHeight,ot[6]=he-this._bottomHeight,ot[7]=he;for(var te=0;te<8;te++)ot[te]*=E.baseTexture.resolution;d.globalAlpha=this.worldAlpha,T.setBlendMode(this.blendMode),T.setContextTransform(c,this.roundPixels);for(var ge=0;ge<3;ge++)for(var xe=0;xe<3;xe++){var Be=2*xe+8*ge,Je=Math.max(1,ot[xe+1]-ot[xe]),qe=Math.max(1,ot[ge+5]-ot[ge+4]),Ze=Math.max(1,$[Be+10]-$[Be]),je=Math.max(1,$[Be+11]-$[Be+1]);d.drawImage(U,ot[xe],ot[ge+4],Je,qe,$[Be],$[Be+1],Ze,je)}}};var wl=!1;B.a.prototype._cachedTint=16777215,B.a.prototype._tintedCanvas=null,B.a.prototype._cachedTexture=null,B.a.prototype._renderCanvas=function(T){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(T,this):wl||(wl=!0,globalThis.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},B.a.prototype._canvasPadding=null,Object.defineProperty(B.a.prototype,"canvasPadding",{get:function(){return this._canvasPadding!==null?this._canvasPadding:R.b.MESH_CANVAS_PADDING},set:function(T){this._canvasPadding=T}}),z.b.prototype._renderCanvas=function(T){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)},z.c.prototype._renderCanvas=function(T){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)}}).call(this,v(17))},function(b,S,v){var O=v(143),R=v(144);function M(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}S.parse=P,S.resolve=function(j,Q){return P(j,!1,!0).resolve(Q)},S.resolveObject=function(j,Q){return j?P(j,!1,!0).resolveObject(Q):Q},S.format=function(j){return R.isString(j)&&(j=P(j)),j instanceof M?j.format():M.prototype.format.call(j)},S.Url=M;var D=/^([a-z0-9.+-]+:)/i,B=/:[0-9]*$/,z=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,X=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),J=["'"].concat(X),et=["%","/","?",";","#"].concat(J),pt=["/","?","#"],Nt=/^[+a-z0-9A-Z_-]{0,63}$/,vt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,L={javascript:!0,"javascript:":!0},I={javascript:!0,"javascript:":!0},F={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},W=v(145);function P(j,Q,H){if(j&&R.isObject(j)&&j instanceof M)return j;var Ot=new M;return Ot.parse(j,Q,H),Ot}M.prototype.parse=function(j,Q,H){if(!R.isString(j))throw new TypeError("Parameter 'url' must be a string, not "+typeof j);var Ot=j.indexOf("?"),Vt=Ot!==-1&&Ot<j.indexOf("#")?"?":"#",st=j.split(Vt);st[0]=st[0].replace(/\\/g,"/");var V=j=st.join(Vt);if(V=V.trim(),!H&&j.split("#").length===1){var k=z.exec(V);if(k)return this.path=V,this.href=V,this.pathname=k[1],k[2]?(this.search=k[2],this.query=Q?W.parse(this.search.substr(1)):this.search.substr(1)):Q&&(this.search="",this.query={}),this}var mt=D.exec(V);if(mt){var tt=(mt=mt[0]).toLowerCase();this.protocol=tt,V=V.substr(mt.length)}if(H||mt||V.match(/^\/\/[^@\/]+@[^@\/]+/)){var _t=V.substr(0,2)==="//";!_t||mt&&I[mt]||(V=V.substr(2),this.slashes=!0)}if(!I[mt]&&(_t||mt&&!F[mt])){for(var Dt,Z,ct=-1,rt=0;rt<pt.length;rt++)(yt=V.indexOf(pt[rt]))!==-1&&(ct===-1||yt<ct)&&(ct=yt);for((Z=ct===-1?V.lastIndexOf("@"):V.lastIndexOf("@",ct))!==-1&&(Dt=V.slice(0,Z),V=V.slice(Z+1),this.auth=decodeURIComponent(Dt)),ct=-1,rt=0;rt<et.length;rt++){var yt;(yt=V.indexOf(et[rt]))!==-1&&(ct===-1||yt<ct)&&(ct=yt)}ct===-1&&(ct=V.length),this.host=V.slice(0,ct),V=V.slice(ct),this.parseHost(),this.hostname=this.hostname||"";var At=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!At)for(var Gt=this.hostname.split(/\./),Yt=(rt=0,Gt.length);rt<Yt;rt++){var Jt=Gt[rt];if(Jt&&!Jt.match(Nt)){for(var at="",_e=0,ke=Jt.length;_e<ke;_e++)Jt.charCodeAt(_e)>127?at+="x":at+=Jt[_e];if(!at.match(Nt)){var Le=Gt.slice(0,rt),Ae=Gt.slice(rt+1),ze=Jt.match(vt);ze&&(Le.push(ze[1]),Ae.unshift(ze[2])),Ae.length&&(V="/"+Ae.join(".")+V),this.hostname=Le.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),At||(this.hostname=O.toASCII(this.hostname));var Qe=this.port?":"+this.port:"",cn=this.hostname||"";this.host=cn+Qe,this.href+=this.host,At&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),V[0]!=="/"&&(V="/"+V))}if(!L[tt])for(rt=0,Yt=J.length;rt<Yt;rt++){var Ue=J[rt];if(V.indexOf(Ue)!==-1){var Ge=encodeURIComponent(Ue);Ge===Ue&&(Ge=escape(Ue)),V=V.split(Ue).join(Ge)}}var Rn=V.indexOf("#");Rn!==-1&&(this.hash=V.substr(Rn),V=V.slice(0,Rn));var re=V.indexOf("?");if(re!==-1?(this.search=V.substr(re),this.query=V.substr(re+1),Q&&(this.query=W.parse(this.query)),V=V.slice(0,re)):Q&&(this.search="",this.query={}),V&&(this.pathname=V),F[tt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Qe=this.pathname||"";var fe=this.search||"";this.path=Qe+fe}return this.href=this.format(),this},M.prototype.format=function(){var j=this.auth||"";j&&(j=(j=encodeURIComponent(j)).replace(/%3A/i,":"),j+="@");var Q=this.protocol||"",H=this.pathname||"",Ot=this.hash||"",Vt=!1,st="";this.host?Vt=j+this.host:this.hostname&&(Vt=j+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(Vt+=":"+this.port)),this.query&&R.isObject(this.query)&&Object.keys(this.query).length&&(st=W.stringify(this.query));var V=this.search||st&&"?"+st||"";return Q&&Q.substr(-1)!==":"&&(Q+=":"),this.slashes||(!Q||F[Q])&&Vt!==!1?(Vt="//"+(Vt||""),H&&H.charAt(0)!=="/"&&(H="/"+H)):Vt||(Vt=""),Ot&&Ot.charAt(0)!=="#"&&(Ot="#"+Ot),V&&V.charAt(0)!=="?"&&(V="?"+V),Q+Vt+(H=H.replace(/[?#]/g,function(k){return encodeURIComponent(k)}))+(V=V.replace("#","%23"))+Ot},M.prototype.resolve=function(j){return this.resolveObject(P(j,!1,!0)).format()},M.prototype.resolveObject=function(j){if(R.isString(j)){var Q=new M;Q.parse(j,!1,!0),j=Q}for(var H=new M,Ot=Object.keys(this),Vt=0;Vt<Ot.length;Vt++){var st=Ot[Vt];H[st]=this[st]}if(H.hash=j.hash,j.href==="")return H.href=H.format(),H;if(j.slashes&&!j.protocol){for(var V=Object.keys(j),k=0;k<V.length;k++){var mt=V[k];mt!=="protocol"&&(H[mt]=j[mt])}return F[H.protocol]&&H.hostname&&!H.pathname&&(H.path=H.pathname="/"),H.href=H.format(),H}if(j.protocol&&j.protocol!==H.protocol){if(!F[j.protocol]){for(var tt=Object.keys(j),_t=0;_t<tt.length;_t++){var Dt=tt[_t];H[Dt]=j[Dt]}return H.href=H.format(),H}if(H.protocol=j.protocol,j.host||I[j.protocol])H.pathname=j.pathname;else{for(var Z=(j.pathname||"").split("/");Z.length&&!(j.host=Z.shift()););j.host||(j.host=""),j.hostname||(j.hostname=""),Z[0]!==""&&Z.unshift(""),Z.length<2&&Z.unshift(""),H.pathname=Z.join("/")}if(H.search=j.search,H.query=j.query,H.host=j.host||"",H.auth=j.auth,H.hostname=j.hostname||j.host,H.port=j.port,H.pathname||H.search){var ct=H.pathname||"",rt=H.search||"";H.path=ct+rt}return H.slashes=H.slashes||j.slashes,H.href=H.format(),H}var yt=H.pathname&&H.pathname.charAt(0)==="/",At=j.host||j.pathname&&j.pathname.charAt(0)==="/",Gt=At||yt||H.host&&j.pathname,Yt=Gt,Jt=H.pathname&&H.pathname.split("/")||[],at=(Z=j.pathname&&j.pathname.split("/")||[],H.protocol&&!F[H.protocol]);if(at&&(H.hostname="",H.port=null,H.host&&(Jt[0]===""?Jt[0]=H.host:Jt.unshift(H.host)),H.host="",j.protocol&&(j.hostname=null,j.port=null,j.host&&(Z[0]===""?Z[0]=j.host:Z.unshift(j.host)),j.host=null),Gt=Gt&&(Z[0]===""||Jt[0]==="")),At)H.host=j.host||j.host===""?j.host:H.host,H.hostname=j.hostname||j.hostname===""?j.hostname:H.hostname,H.search=j.search,H.query=j.query,Jt=Z;else if(Z.length)Jt||(Jt=[]),Jt.pop(),Jt=Jt.concat(Z),H.search=j.search,H.query=j.query;else if(!R.isNullOrUndefined(j.search))return at&&(H.hostname=H.host=Jt.shift(),(ze=!!(H.host&&H.host.indexOf("@")>0)&&H.host.split("@"))&&(H.auth=ze.shift(),H.host=H.hostname=ze.shift())),H.search=j.search,H.query=j.query,R.isNull(H.pathname)&&R.isNull(H.search)||(H.path=(H.pathname?H.pathname:"")+(H.search?H.search:"")),H.href=H.format(),H;if(!Jt.length)return H.pathname=null,H.search?H.path="/"+H.search:H.path=null,H.href=H.format(),H;for(var _e=Jt.slice(-1)[0],ke=(H.host||j.host||Jt.length>1)&&(_e==="."||_e==="..")||_e==="",Le=0,Ae=Jt.length;Ae>=0;Ae--)(_e=Jt[Ae])==="."?Jt.splice(Ae,1):_e===".."?(Jt.splice(Ae,1),Le++):Le&&(Jt.splice(Ae,1),Le--);if(!Gt&&!Yt)for(;Le--;Le)Jt.unshift("..");!Gt||Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/"||Jt.unshift(""),ke&&Jt.join("/").substr(-1)!=="/"&&Jt.push("");var ze,Qe=Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/";return at&&(H.hostname=H.host=Qe?"":Jt.length?Jt.shift():"",(ze=!!(H.host&&H.host.indexOf("@")>0)&&H.host.split("@"))&&(H.auth=ze.shift(),H.host=H.hostname=ze.shift())),(Gt=Gt||H.host&&Jt.length)&&!Qe&&Jt.unshift(""),Jt.length?H.pathname=Jt.join("/"):(H.pathname=null,H.path=null),R.isNull(H.pathname)&&R.isNull(H.search)||(H.path=(H.pathname?H.pathname:"")+(H.search?H.search:"")),H.auth=j.auth||H.auth,H.slashes=H.slashes||j.slashes,H.href=H.format(),H},M.prototype.parseHost=function(){var j=this.host,Q=B.exec(j);Q&&((Q=Q[0])!==":"&&(this.port=Q.substr(1)),j=j.substr(0,j.length-Q.length)),j&&(this.hostname=j)}},function(b,S){b.exports=function(v,O){return v===O||v!=v&&O!=O}},function(b,S,v){var O=v(22)(v(14),"Map");b.exports=O},function(b,S,v){var O=v(187),R=v(62),M=Object.prototype.propertyIsEnumerable,D=Object.getOwnPropertySymbols,B=D?function(z){return z==null?[]:(z=Object(z),O(D(z),function(X){return M.call(z,X)}))}:R;b.exports=B},function(b,S,v){var O=v(63),R=v(194),M=v(67);b.exports=function(D){return M(D)?O(D):R(D)}},function(b,S,v){(function(O){var R=v(14),M=v(191),D=S&&!S.nodeType&&S,B=D&&typeof O=="object"&&O&&!O.nodeType&&O,z=B&&B.exports===D?R.Buffer:void 0,X=(z?z.isBuffer:void 0)||M;O.exports=X}).call(this,v(26)(b))},function(b,S){b.exports=function(v){return function(O){return v(O)}}},function(b,S,v){(function(O){var R=v(51),M=S&&!S.nodeType&&S,D=M&&typeof O=="object"&&O&&!O.nodeType&&O,B=D&&D.exports===M&&R.process,z=function(){try{var X=D&&D.require&&D.require("util").types;return X||B&&B.binding&&B.binding("util")}catch{}}();O.exports=z}).call(this,v(26)(b))},function(b,S){var v=Object.prototype;b.exports=function(O){var R=O&&O.constructor;return O===(typeof R=="function"&&R.prototype||v)}},function(b,S,v){var O=v(63),R=v(210),M=v(67);b.exports=function(D){return M(D)?O(D,!0):R(D)}},function(b,S,v){var O=v(58);b.exports=function(R){var M=new R.constructor(R.byteLength);return new O(M).set(new O(R)),M}},function(b,S){b.exports=`#define PI 3.14159265
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vUv = uv;
	float pixelHeight = (galleryHeight * 1.2) + 8.0;
	float pixelY = (pixelHeight * 0.5) - position.y;
	vPixelY = pixelY;
	vec4 newPosition = vec4(position, 1.0);
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D galleryTexture;
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vec4 color;
	if ((vPixelY >= 0.0) && (vPixelY <= galleryHeight)) {
		color = texture2D(galleryTexture, vec2(vUv.x, 1.0 - (vPixelY / galleryHeight)));
	}
	else if ((vPixelY > galleryHeight) && (vPixelY < (galleryHeight + 8.0))) {
		color = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		float alpha = 1.0 - ((vPixelY - (galleryHeight + 8.0)) / (galleryHeight * 0.2));
		color = texture2D(galleryTexture, vec2(vUv.x, ((vPixelY - galleryHeight) + 8.0) / galleryHeight));
		color.a = alpha;
		vec4 shadow = vec4(0.0, 0.0, 0.0, 1.0);
		color = blendSrcOver(color, shadow);
	}
	gl_FragColor = color;
}
`},function(b,S,v){var O=v(148);b.exports=function(R,M){M=M||{};var D=new O,B=M.inPlace||!1,z=R.map(function(J){return B?J:{width:J.width,height:J.height,item:J}});z=z.sort(function(J,et){return et.width*et.height-J.width*J.height}),D.fit(z);var X={width:z.reduce(function(J,et){return Math.max(J,et.x+et.width)},0),height:z.reduce(function(J,et){return Math.max(J,et.y+et.height)},0)};return B||(X.items=z),X}},function(b,S,v){var O=v(205);b.exports=function(R){return O(R,5)}},function(b,S,v){(function(O){var R=typeof O=="object"&&O&&O.Object===Object&&O;b.exports=R}).call(this,v(17))},function(b,S,v){var O=Object.prototype.hasOwnProperty,R="~";function M(){}function D(J,et,pt){this.fn=J,this.context=et,this.once=pt||!1}function B(J,et,pt,Nt,vt){if(typeof pt!="function")throw new TypeError("The listener must be a function");var L=new D(pt,Nt||J,vt),I=R?R+et:et;return J._events[I]?J._events[I].fn?J._events[I]=[J._events[I],L]:J._events[I].push(L):(J._events[I]=L,J._eventsCount++),J}function z(J,et){--J._eventsCount==0?J._events=new M:delete J._events[et]}function X(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),new M().__proto__||(R=!1)),X.prototype.eventNames=function(){var J,et,pt=[];if(this._eventsCount===0)return pt;for(et in J=this._events)O.call(J,et)&&pt.push(R?et.slice(1):et);return Object.getOwnPropertySymbols?pt.concat(Object.getOwnPropertySymbols(J)):pt},X.prototype.listeners=function(J){var et=R?R+J:J,pt=this._events[et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Nt=0,vt=pt.length,L=new Array(vt);Nt<vt;Nt++)L[Nt]=pt[Nt].fn;return L},X.prototype.listenerCount=function(J){var et=R?R+J:J,pt=this._events[et];return pt?pt.fn?1:pt.length:0},X.prototype.emit=function(J,et,pt,Nt,vt,L){var I=R?R+J:J;if(!this._events[I])return!1;var F,W,P=this._events[I],j=arguments.length;if(P.fn){switch(P.once&&this.removeListener(J,P.fn,void 0,!0),j){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,et),!0;case 3:return P.fn.call(P.context,et,pt),!0;case 4:return P.fn.call(P.context,et,pt,Nt),!0;case 5:return P.fn.call(P.context,et,pt,Nt,vt),!0;case 6:return P.fn.call(P.context,et,pt,Nt,vt,L),!0}for(W=1,F=new Array(j-1);W<j;W++)F[W-1]=arguments[W];P.fn.apply(P.context,F)}else{var Q,H=P.length;for(W=0;W<H;W++)switch(P[W].once&&this.removeListener(J,P[W].fn,void 0,!0),j){case 1:P[W].fn.call(P[W].context);break;case 2:P[W].fn.call(P[W].context,et);break;case 3:P[W].fn.call(P[W].context,et,pt);break;case 4:P[W].fn.call(P[W].context,et,pt,Nt);break;default:if(!F)for(Q=1,F=new Array(j-1);Q<j;Q++)F[Q-1]=arguments[Q];P[W].fn.apply(P[W].context,F)}}return!0},X.prototype.on=function(J,et,pt){return B(this,J,et,pt,!1)},X.prototype.once=function(J,et,pt){return B(this,J,et,pt,!0)},X.prototype.removeListener=function(J,et,pt,Nt){var vt=R?R+J:J;if(!this._events[vt])return this;if(!et)return z(this,vt),this;var L=this._events[vt];if(L.fn)L.fn!==et||Nt&&!L.once||pt&&L.context!==pt||z(this,vt);else{for(var I=0,F=[],W=L.length;I<W;I++)(L[I].fn!==et||Nt&&!L[I].once||pt&&L[I].context!==pt)&&F.push(L[I]);F.length?this._events[vt]=F.length===1?F[0]:F:z(this,vt)}return this},X.prototype.removeAllListeners=function(J){var et;return J?(et=R?R+J:J,this._events[et]&&z(this,et)):(this._events=new M,this._eventsCount=0),this},X.prototype.off=X.prototype.removeListener,X.prototype.addListener=X.prototype.on,X.prefixed=R,X.EventEmitter=X,b.exports=X},function(b,S,v){function O(tt,_t,Dt){Dt=Dt||2;var Z,ct,rt,yt,At,Gt,Yt,Jt=_t&&_t.length,at=Jt?_t[0]*Dt:tt.length,_e=R(tt,0,at,Dt,!0),ke=[];if(!_e||_e.next===_e.prev)return ke;if(Jt&&(_e=function(Ae,ze,Qe,cn){var Ue,Ge,Rn,re,fe,we=[];for(Ue=0,Ge=ze.length;Ue<Ge;Ue++)Rn=ze[Ue]*cn,re=Ue<Ge-1?ze[Ue+1]*cn:Ae.length,(fe=R(Ae,Rn,re,cn,!1))===fe.next&&(fe.steiner=!0),we.push(L(fe));for(we.sort(et),Ue=0;Ue<we.length;Ue++)Qe=pt(we[Ue],Qe);return Qe}(tt,_t,_e,Dt)),tt.length>80*Dt){Z=rt=tt[0],ct=yt=tt[1];for(var Le=Dt;Le<at;Le+=Dt)(At=tt[Le])<Z&&(Z=At),(Gt=tt[Le+1])<ct&&(ct=Gt),At>rt&&(rt=At),Gt>yt&&(yt=Gt);Yt=(Yt=Math.max(rt-Z,yt-ct))!==0?32767/Yt:0}return D(_e,ke,Dt,Z,ct,Yt,0),ke}function R(tt,_t,Dt,Z,ct){var rt,yt;if(ct===mt(tt,_t,Dt,Z)>0)for(rt=_t;rt<Dt;rt+=Z)yt=st(rt,tt[rt],tt[rt+1],yt);else for(rt=Dt-Z;rt>=_t;rt-=Z)yt=st(rt,tt[rt],tt[rt+1],yt);return yt&&P(yt,yt.next)&&(V(yt),yt=yt.next),yt}function M(tt,_t){if(!tt)return tt;_t||(_t=tt);var Dt,Z=tt;do if(Dt=!1,Z.steiner||!P(Z,Z.next)&&W(Z.prev,Z,Z.next)!==0)Z=Z.next;else{if(V(Z),(Z=_t=Z.prev)===Z.next)break;Dt=!0}while(Dt||Z!==_t);return _t}function D(tt,_t,Dt,Z,ct,rt,yt){if(tt){!yt&&rt&&function(Jt,at,_e,ke){var Le=Jt;do Le.z===0&&(Le.z=vt(Le.x,Le.y,at,_e,ke)),Le.prevZ=Le.prev,Le.nextZ=Le.next,Le=Le.next;while(Le!==Jt);Le.prevZ.nextZ=null,Le.prevZ=null,function(Ae){var ze,Qe,cn,Ue,Ge,Rn,re,fe,we=1;do{for(Qe=Ae,Ae=null,Ge=null,Rn=0;Qe;){for(Rn++,cn=Qe,re=0,ze=0;ze<we&&(re++,cn=cn.nextZ);ze++);for(fe=we;re>0||fe>0&&cn;)re!==0&&(fe===0||!cn||Qe.z<=cn.z)?(Ue=Qe,Qe=Qe.nextZ,re--):(Ue=cn,cn=cn.nextZ,fe--),Ge?Ge.nextZ=Ue:Ae=Ue,Ue.prevZ=Ge,Ge=Ue;Qe=cn}Ge.nextZ=null,we*=2}while(Rn>1)}(Le)}(tt,Z,ct,rt);for(var At,Gt,Yt=tt;tt.prev!==tt.next;)if(At=tt.prev,Gt=tt.next,rt?z(tt,Z,ct,rt):B(tt))_t.push(At.i/Dt|0),_t.push(tt.i/Dt|0),_t.push(Gt.i/Dt|0),V(tt),tt=Gt.next,Yt=Gt.next;else if((tt=Gt)===Yt){yt?yt===1?D(tt=X(M(tt),_t,Dt),_t,Dt,Z,ct,rt,2):yt===2&&J(tt,_t,Dt,Z,ct,rt):D(M(tt),_t,Dt,Z,ct,rt,1);break}}}function B(tt){var _t=tt.prev,Dt=tt,Z=tt.next;if(W(_t,Dt,Z)>=0)return!1;for(var ct=_t.x,rt=Dt.x,yt=Z.x,At=_t.y,Gt=Dt.y,Yt=Z.y,Jt=ct<rt?ct<yt?ct:yt:rt<yt?rt:yt,at=At<Gt?At<Yt?At:Yt:Gt<Yt?Gt:Yt,_e=ct>rt?ct>yt?ct:yt:rt>yt?rt:yt,ke=At>Gt?At>Yt?At:Yt:Gt>Yt?Gt:Yt,Le=Z.next;Le!==_t;){if(Le.x>=Jt&&Le.x<=_e&&Le.y>=at&&Le.y<=ke&&I(ct,At,rt,Gt,yt,Yt,Le.x,Le.y)&&W(Le.prev,Le,Le.next)>=0)return!1;Le=Le.next}return!0}function z(tt,_t,Dt,Z){var ct=tt.prev,rt=tt,yt=tt.next;if(W(ct,rt,yt)>=0)return!1;for(var At=ct.x,Gt=rt.x,Yt=yt.x,Jt=ct.y,at=rt.y,_e=yt.y,ke=At<Gt?At<Yt?At:Yt:Gt<Yt?Gt:Yt,Le=Jt<at?Jt<_e?Jt:_e:at<_e?at:_e,Ae=At>Gt?At>Yt?At:Yt:Gt>Yt?Gt:Yt,ze=Jt>at?Jt>_e?Jt:_e:at>_e?at:_e,Qe=vt(ke,Le,_t,Dt,Z),cn=vt(Ae,ze,_t,Dt,Z),Ue=tt.prevZ,Ge=tt.nextZ;Ue&&Ue.z>=Qe&&Ge&&Ge.z<=cn;){if(Ue.x>=ke&&Ue.x<=Ae&&Ue.y>=Le&&Ue.y<=ze&&Ue!==ct&&Ue!==yt&&I(At,Jt,Gt,at,Yt,_e,Ue.x,Ue.y)&&W(Ue.prev,Ue,Ue.next)>=0||(Ue=Ue.prevZ,Ge.x>=ke&&Ge.x<=Ae&&Ge.y>=Le&&Ge.y<=ze&&Ge!==ct&&Ge!==yt&&I(At,Jt,Gt,at,Yt,_e,Ge.x,Ge.y)&&W(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;Ue&&Ue.z>=Qe;){if(Ue.x>=ke&&Ue.x<=Ae&&Ue.y>=Le&&Ue.y<=ze&&Ue!==ct&&Ue!==yt&&I(At,Jt,Gt,at,Yt,_e,Ue.x,Ue.y)&&W(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.prevZ}for(;Ge&&Ge.z<=cn;){if(Ge.x>=ke&&Ge.x<=Ae&&Ge.y>=Le&&Ge.y<=ze&&Ge!==ct&&Ge!==yt&&I(At,Jt,Gt,at,Yt,_e,Ge.x,Ge.y)&&W(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function X(tt,_t,Dt){var Z=tt;do{var ct=Z.prev,rt=Z.next.next;!P(ct,rt)&&j(ct,Z,Z.next,rt)&&Ot(ct,rt)&&Ot(rt,ct)&&(_t.push(ct.i/Dt|0),_t.push(Z.i/Dt|0),_t.push(rt.i/Dt|0),V(Z),V(Z.next),Z=tt=rt),Z=Z.next}while(Z!==tt);return M(Z)}function J(tt,_t,Dt,Z,ct,rt){var yt=tt;do{for(var At=yt.next.next;At!==yt.prev;){if(yt.i!==At.i&&F(yt,At)){var Gt=Vt(yt,At);return yt=M(yt,yt.next),Gt=M(Gt,Gt.next),D(yt,_t,Dt,Z,ct,rt,0),void D(Gt,_t,Dt,Z,ct,rt,0)}At=At.next}yt=yt.next}while(yt!==tt)}function et(tt,_t){return tt.x-_t.x}function pt(tt,_t){var Dt=function(ct,rt){var yt,At=rt,Gt=ct.x,Yt=ct.y,Jt=-1/0;do{if(Yt<=At.y&&Yt>=At.next.y&&At.next.y!==At.y){var at=At.x+(Yt-At.y)*(At.next.x-At.x)/(At.next.y-At.y);if(at<=Gt&&at>Jt&&(Jt=at,yt=At.x<At.next.x?At:At.next,at===Gt))return yt}At=At.next}while(At!==rt);if(!yt)return null;var _e,ke=yt,Le=yt.x,Ae=yt.y,ze=1/0;At=yt;do Gt>=At.x&&At.x>=Le&&Gt!==At.x&&I(Yt<Ae?Gt:Jt,Yt,Le,Ae,Yt<Ae?Jt:Gt,Yt,At.x,At.y)&&(_e=Math.abs(Yt-At.y)/(Gt-At.x),Ot(At,ct)&&(_e<ze||_e===ze&&(At.x>yt.x||At.x===yt.x&&Nt(yt,At)))&&(yt=At,ze=_e)),At=At.next;while(At!==ke);return yt}(tt,_t);if(!Dt)return _t;var Z=Vt(Dt,tt);return M(Z,Z.next),M(Dt,Dt.next)}function Nt(tt,_t){return W(tt.prev,tt,_t.prev)<0&&W(_t.next,tt,tt.next)<0}function vt(tt,_t,Dt,Z,ct){return(tt=1431655765&((tt=858993459&((tt=252645135&((tt=16711935&((tt=(tt-Dt)*ct|0)|tt<<8))|tt<<4))|tt<<2))|tt<<1))|(_t=1431655765&((_t=858993459&((_t=252645135&((_t=16711935&((_t=(_t-Z)*ct|0)|_t<<8))|_t<<4))|_t<<2))|_t<<1))<<1}function L(tt){var _t=tt,Dt=tt;do(_t.x<Dt.x||_t.x===Dt.x&&_t.y<Dt.y)&&(Dt=_t),_t=_t.next;while(_t!==tt);return Dt}function I(tt,_t,Dt,Z,ct,rt,yt,At){return(ct-yt)*(_t-At)>=(tt-yt)*(rt-At)&&(tt-yt)*(Z-At)>=(Dt-yt)*(_t-At)&&(Dt-yt)*(rt-At)>=(ct-yt)*(Z-At)}function F(tt,_t){return tt.next.i!==_t.i&&tt.prev.i!==_t.i&&!function(Dt,Z){var ct=Dt;do{if(ct.i!==Dt.i&&ct.next.i!==Dt.i&&ct.i!==Z.i&&ct.next.i!==Z.i&&j(ct,ct.next,Dt,Z))return!0;ct=ct.next}while(ct!==Dt);return!1}(tt,_t)&&(Ot(tt,_t)&&Ot(_t,tt)&&function(Dt,Z){var ct=Dt,rt=!1,yt=(Dt.x+Z.x)/2,At=(Dt.y+Z.y)/2;do ct.y>At!=ct.next.y>At&&ct.next.y!==ct.y&&yt<(ct.next.x-ct.x)*(At-ct.y)/(ct.next.y-ct.y)+ct.x&&(rt=!rt),ct=ct.next;while(ct!==Dt);return rt}(tt,_t)&&(W(tt.prev,tt,_t.prev)||W(tt,_t.prev,_t))||P(tt,_t)&&W(tt.prev,tt,tt.next)>0&&W(_t.prev,_t,_t.next)>0)}function W(tt,_t,Dt){return(_t.y-tt.y)*(Dt.x-_t.x)-(_t.x-tt.x)*(Dt.y-_t.y)}function P(tt,_t){return tt.x===_t.x&&tt.y===_t.y}function j(tt,_t,Dt,Z){var ct=H(W(tt,_t,Dt)),rt=H(W(tt,_t,Z)),yt=H(W(Dt,Z,tt)),At=H(W(Dt,Z,_t));return ct!==rt&&yt!==At||!(ct!==0||!Q(tt,Dt,_t))||!(rt!==0||!Q(tt,Z,_t))||!(yt!==0||!Q(Dt,tt,Z))||!(At!==0||!Q(Dt,_t,Z))}function Q(tt,_t,Dt){return _t.x<=Math.max(tt.x,Dt.x)&&_t.x>=Math.min(tt.x,Dt.x)&&_t.y<=Math.max(tt.y,Dt.y)&&_t.y>=Math.min(tt.y,Dt.y)}function H(tt){return tt>0?1:tt<0?-1:0}function Ot(tt,_t){return W(tt.prev,tt,tt.next)<0?W(tt,_t,tt.next)>=0&&W(tt,tt.prev,_t)>=0:W(tt,_t,tt.prev)<0||W(tt,tt.next,_t)<0}function Vt(tt,_t){var Dt=new k(tt.i,tt.x,tt.y),Z=new k(_t.i,_t.x,_t.y),ct=tt.next,rt=_t.prev;return tt.next=_t,_t.prev=tt,Dt.next=ct,ct.prev=Dt,Z.next=Dt,Dt.prev=Z,rt.next=Z,Z.prev=rt,Z}function st(tt,_t,Dt,Z){var ct=new k(tt,_t,Dt);return Z?(ct.next=Z.next,ct.prev=Z,Z.next.prev=ct,Z.next=ct):(ct.prev=ct,ct.next=ct),ct}function V(tt){tt.next.prev=tt.prev,tt.prev.next=tt.next,tt.prevZ&&(tt.prevZ.nextZ=tt.nextZ),tt.nextZ&&(tt.nextZ.prevZ=tt.prevZ)}function k(tt,_t,Dt){this.i=tt,this.x=_t,this.y=Dt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mt(tt,_t,Dt,Z){for(var ct=0,rt=_t,yt=Dt-Z;rt<Dt;rt+=Z)ct+=(tt[yt]-tt[rt])*(tt[rt+1]+tt[yt+1]),yt=rt;return ct}b.exports=O,b.exports.default=O,O.deviation=function(tt,_t,Dt,Z){var ct=_t&&_t.length,rt=ct?_t[0]*Dt:tt.length,yt=Math.abs(mt(tt,0,rt,Dt));if(ct)for(var At=0,Gt=_t.length;At<Gt;At++){var Yt=_t[At]*Dt,Jt=At<Gt-1?_t[At+1]*Dt:tt.length;yt-=Math.abs(mt(tt,Yt,Jt,Dt))}var at=0;for(At=0;At<Z.length;At+=3){var _e=Z[At]*Dt,ke=Z[At+1]*Dt,Le=Z[At+2]*Dt;at+=Math.abs((tt[_e]-tt[Le])*(tt[ke+1]-tt[_e+1])-(tt[_e]-tt[ke])*(tt[Le+1]-tt[_e+1]))}return yt===0&&at===0?0:Math.abs((at-yt)/yt)},O.flatten=function(tt){for(var _t=tt[0][0].length,Dt={vertices:[],holes:[],dimensions:_t},Z=0,ct=0;ct<tt.length;ct++){for(var rt=0;rt<tt[ct].length;rt++)for(var yt=0;yt<_t;yt++)Dt.vertices.push(tt[ct][rt][yt]);ct>0&&(Z+=tt[ct-1].length,Dt.holes.push(Z))}return Dt}},function(b,S,v){var O=v(27),R=v(157),M=v(158),D=v(159),B=v(160),z=v(161);function X(J){var et=this.__data__=new O(J);this.size=et.size}X.prototype.clear=R,X.prototype.delete=M,X.prototype.get=D,X.prototype.has=B,X.prototype.set=z,b.exports=X},function(b,S){var v=Function.prototype.toString;b.exports=function(O){if(O!=null){try{return v.call(O)}catch{}try{return O+""}catch{}}return""}},function(b,S,v){var O=v(166),R=v(173),M=v(175),D=v(176),B=v(177);function z(X){var J=-1,et=X==null?0:X.length;for(this.clear();++J<et;){var pt=X[J];this.set(pt[0],pt[1])}}z.prototype.clear=O,z.prototype.delete=R,z.prototype.get=M,z.prototype.has=D,z.prototype.set=B,b.exports=z},function(b,S,v){var O=v(178),R=v(181),M=v(182);b.exports=function(D,B,z,X,J,et){var pt=1&z,Nt=D.length,vt=B.length;if(Nt!=vt&&!(pt&&vt>Nt))return!1;var L=et.get(D),I=et.get(B);if(L&&I)return L==B&&I==D;var F=-1,W=!0,P=2&z?new O:void 0;for(et.set(D,B),et.set(B,D);++F<Nt;){var j=D[F],Q=B[F];if(X)var H=pt?X(Q,j,F,B,D,et):X(j,Q,F,D,B,et);if(H!==void 0){if(H)continue;W=!1;break}if(P){if(!R(B,function(Ot,Vt){if(!M(P,Vt)&&(j===Ot||J(j,Ot,z,X,et)))return P.push(Vt)})){W=!1;break}}else if(j!==Q&&!J(j,Q,z,X,et)){W=!1;break}}return et.delete(D),et.delete(B),W}},function(b,S,v){var O=v(14).Uint8Array;b.exports=O},function(b,S,v){var O=v(60),R=v(39),M=v(40);b.exports=function(D){return O(D,M,R)}},function(b,S,v){var O=v(61),R=v(31);b.exports=function(M,D,B){var z=D(M);return R(M)?z:O(z,B(M))}},function(b,S){b.exports=function(v,O){for(var R=-1,M=O.length,D=v.length;++R<M;)v[D+R]=O[R];return v}},function(b,S){b.exports=function(){return[]}},function(b,S,v){var O=v(188),R=v(189),M=v(31),D=v(41),B=v(192),z=v(64),X=Object.prototype.hasOwnProperty;b.exports=function(J,et){var pt=M(J),Nt=!pt&&R(J),vt=!pt&&!Nt&&D(J),L=!pt&&!Nt&&!vt&&z(J),I=pt||Nt||vt||L,F=I?O(J.length,String):[],W=F.length;for(var P in J)!et&&!X.call(J,P)||I&&(P=="length"||vt&&(P=="offset"||P=="parent")||L&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||B(P,W))||F.push(P);return F}},function(b,S,v){var O=v(193),R=v(42),M=v(43),D=M&&M.isTypedArray,B=D?R(D):O;b.exports=B},function(b,S){b.exports=function(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=9007199254740991}},function(b,S){b.exports=function(v,O){return function(R){return v(O(R))}}},function(b,S,v){var O=v(34),R=v(65);b.exports=function(M){return M!=null&&R(M.length)&&!O(M)}},function(b,S,v){var O=v(69),R=v(37),M=Object.prototype.hasOwnProperty;b.exports=function(D,B,z){var X=D[B];M.call(D,B)&&R(X,z)&&(z!==void 0||B in D)||O(D,B,z)}},function(b,S,v){var O=v(207);b.exports=function(R,M,D){M=="__proto__"&&O?O(R,M,{configurable:!0,enumerable:!0,value:D,writable:!0}):R[M]=D}},function(b,S,v){var O=v(61),R=v(71),M=v(39),D=v(62),B=Object.getOwnPropertySymbols?function(z){for(var X=[];z;)O(X,M(z)),z=R(z);return X}:D;b.exports=B},function(b,S,v){var O=v(66)(Object.getPrototypeOf,Object);b.exports=O},function(b,S){b.exports=`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform float lines[26];
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float direction;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float middleAlpha = 0.0;
	float endAlpha = 0.0;
	float headLength = 0.0;
	if (timePercent < 0.5) {
		middleAlpha = 1.0;
		endAlpha = 1.0 - (timePercent / 0.5);
	}
	else {
		middleAlpha = 1.0 - ((timePercent - 0.5) / 0.5);
		endAlpha = 0.0;
	}
	for (int i = 0; i < 26; i++) {
		float halfDis = lines[i] / 2.0;
		float middle = headLength + halfDis;
		headLength += lines[i];
		if ((direction > 0.9) && (direction < 1.1)) {
			if (abs(vUv.y - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.y - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
		else {
			if (abs(vUv.x - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.x - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
	}
	gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	vec2 uv = vec2(vUv.x, vUv.y);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
vec2 transformTo(vec2 uv, vec2 origin) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(origin.x, (origin.y * height) / width);
}
vec2 offset(float progress[4], float band, float amp, float radius, vec2 centerPosition) {
	vec2 tc = vUv.xy;
	vec2 uv = vec2(0.0, 0.0);
	vec2 p;
	float len;
	vec2 uv_offset;
	float wave_width = band * radius;
	for (int i = 0; i < 4; i += 1) {
		if (progress[i] == -1.0) {
			continue;
		}
		p = tc - centerPosition;
		p.x = (p.x * width) / height;
		len = length(p);
		float current_progress = progress[i];
		float current_radius = radius * current_progress;
		float damp_factor = 1.0;
		if (current_progress > .5) {
			damp_factor = (1.0 - current_progress) * 2.0;
		}
		float cut_factor = clamp((wave_width * damp_factor) - abs(current_radius - len), 0.0, 1.0);
		float waves_factor = (4.0 * len) / radius;
		uv_offset = (((p / len) * cos((waves_factor - (current_progress * 10.0)) * 3.14)) * amp) * cut_factor;
		uv += uv_offset;
	}
	return uv;
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	float progress[4];
	vec2 uv = vUv.xy;
	vec2 uvOffset = vec2(0.0, 0.0);
	vec2 startPosition = vec2(0.5, 0.5);
	float redius = 2.0;
	if (option == 1) {
		startPosition = vec2(0.0, 0.0);
	}
	else if (option == 2) {
		startPosition = vec2(1.0, 0.0);
	}
	else if (option == 3) {
		startPosition = vec2(1.0, 1.0);
	}
	else if (option == 4) {
		startPosition = vec2(0.0, 1.0);
	}
	maxR = length(transformTo(vec2(1.0, 1.0), vec2(0.0, 0.0)));
	if (option == 0) {
		maxR = maxR / 2.0;
		redius = redius / 2.0;
	}
	dist = length(transformTo(uv, startPosition));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	for (int i = 0; i < 4; i++) {
		progress[i] = timePercent + (0.1 * float(i));
		if (progress[i] < 0.0) {
			progress[i] = 0.0;
		}
	}
	uvOffset = offset(progress, 0.2, 0.3, redius, startPosition);
	vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
	vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = option > 1 ? true : false;
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 0.5;
		rectEnd = isRevert ? 0.5 : 1.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 0.5) + 0.5 : 1.0 - (((timePercent - 0.33) / 0.33) * 0.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 0.5 : 0.0;
		rectEnd = isRevert ? 1.0 : 0.5;
	}
	float changAxis = (option % 2) == 0 ? vUv.x : vUv.y;
	if (changAxis >= rectEnd) {
		srcColor.a = isRevert ? 1.0 : 0.0;
	}
	else if (changAxis <= rectStart) {
		srcColor.a = isRevert ? 0.0 : 1.0;
	}
	else {
		srcColor.a = alphaStart + (((changAxis - rectStart) / 0.5) * (alphaEnd - alphaStart));
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 dissolveColor = texture2D(dissolveTexture, vUv);
	if (dissolveColor.r == 0.0) {
		result = srcColor;
	}
	else {
		result = distColor;
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	if (timePercent < 0.5) {
		float stagePercent = timePercent / 0.5;
		result = srcColor + (stagePercent * (1.0 - srcColor));
	}
	else {
		float stagePercent = (timePercent - 0.5) / 0.5;
		result = 1.0 - (stagePercent * (1.0 - distColor));
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (option == 1) {
		if (timePercent < 0.5) {
			srcColor.rgb *= (1.0 - (timePercent * 2.0));
			gl_FragColor = srcColor;
		}
		else {
			distColor.rgb *= ((timePercent - 0.5) * 2.0);
			gl_FragColor = distColor;
		}
	}
	else {
		srcColor.a = 1.0 - timePercent;
		gl_FragColor = blendSrcOver(srcColor, distColor);
	}
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float changeAxis = (option % 2) == 1 ? vUv.x : vUv.y;
	bool changeAxisX = (option % 2) == 1;
	bool isRevert = option > 1;
	float line;
	if (isRevert) {
		line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);
	}
	else {
		line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);
	}
	vec2 uv = vUv.xy;
	if (changeAxis > line) {
		if (changeAxisX) {
			uv.x -= line;
		}
		else {
			uv.y -= line;
		}
	}
	else {
		if (changeAxisX) {
			uv.x += (1.0 - line);
		}
		else {
			uv.y += (1.0 - line);
		}
	}
	if (isRevert) {
		result = changeAxis > line ? texture2D(textureNext, uv) : texture2D(texturePrev, uv);
	}
	else {
		result = changeAxis > line ? texture2D(texturePrev, uv) : texture2D(textureNext, uv);
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool orient;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 rectLeft = direction ? vec2(0.25, 0.0) : vec2(0.25, 0.5);
	vec2 rectRight = direction ? vec2(1, 0.75) : vec2(0.5, 0.75);
	vec2 alphaLeft = vec2(1.0, 1.0);
	vec2 alphaRight = vec2(1.0, 1.0);
	if (timePercent <= 0.333) {
		alphaLeft.y = 1.0 - (timePercent / 0.333);
		alphaRight.x = 1.0 - (timePercent / 0.333);
	}
	else if ((timePercent <= 0.666) && (timePercent > 0.333)) {
		rectLeft.x = direction ? (((timePercent - 0.333) / 0.333) * 0.25) + rectLeft.x : rectLeft.x - (((timePercent - 0.333) / 0.333) * 0.25);
		rectLeft.y = direction ? rectLeft.x - 0.25 : rectLeft.x + 0.25;
		rectRight.y = direction ? rectRight.y - (((timePercent - 0.333) / 0.333) * 0.25) : rectRight.y + (((timePercent - 0.333) / 0.333) * 0.25);
		rectRight.x = direction ? rectRight.y + 0.25 : rectRight.y - 0.25;
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
	}
	else {
		rectLeft = direction ? vec2(0.5, 0.25) : vec2(0.0, 0.25);
		rectRight = direction ? vec2(0.75, 0.5) : vec2(0.75, 1.0);
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
		alphaLeft.x = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
		alphaRight.y = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
	}
	float axis = orient ? vUv.x : vUv.y;
	if (direction) {
		if ((axis < rectLeft.y) || (axis > rectRight.x)) {
			srcColor.a = 0.0;
		}
		else if ((axis > rectLeft.x) && (axis < rectRight.y)) {
			srcColor.a = 1.0;
		}
		else {
			if ((axis < rectLeft.x) && (axis > rectLeft.y)) {
				srcColor.a = alphaLeft.y - (((axis - rectLeft.y) / (rectLeft.x - rectLeft.y)) * (alphaLeft.y - alphaLeft.x));
			}
			else {
				srcColor.a = alphaRight.x - (((rectRight.x - axis) / (rectLeft.x - rectLeft.y)) * (alphaRight.x - alphaRight.y));
			}
		}
	}
	else {
		if ((axis < rectLeft.x) || (axis > rectRight.y)) {
			srcColor.a = 1.0;
		}
		else if ((axis > rectLeft.y) && (axis < rectRight.x)) {
			srcColor.a = 0.0;
		}
		else {
			if ((axis >= rectLeft.x) && (axis <= rectLeft.y)) {
				srcColor.a = alphaLeft.x - (((axis - rectLeft.x) / (rectLeft.y - rectLeft.x)) * (alphaLeft.x - alphaLeft.y));
			}
			else {
				srcColor.a = alphaRight.y - (((rectRight.y - axis) / (rectLeft.y - rectLeft.x)) * (alphaRight.y - alphaRight.x));
			}
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool thruBlk;
varying vec2 vUv;
void main() {
	vec4 uv4 = vec4(vUv.xy, 1.0, 1.0);
	float scale;
	float transform;
	if (timePercent < 0.5) {
		scale = 1.0 - ((timePercent / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	else {
		scale = 0.95 + (((timePercent - 0.5) / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	mat4 matrix = mat4(scale, 0.0, 0.0, 0.0, 0.0, scale, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, transform, transform, 0.0, 1.0);
	vec4 uv = matrix * uv4;
	vec4 srcColor = texture2D(texturePrev, uv.xy);
	vec4 distColor = texture2D(textureNext, uv.xy);
	vec4 result = timePercent < 0.5 ? srcColor : distColor;
	vec3 start;
	vec3 end;
	vec3 middleColor = thruBlk ? vec3(0.0, 0.0, 0.0) : vec3(1.0, 1.0, 1.0);
	if ((timePercent < 0.25) || (timePercent > 0.75)) {
		result *= 1.0;
	}
	else if ((timePercent >= 0.25) && (timePercent <= 0.5)) {
		if (timePercent <= 0.375) {
			start = result.rgb;
			end = start + (((timePercent - 0.25) / 0.125) * (middleColor - result.rgb));
		}
		else {
			start = result.rgb + (((timePercent - 0.375) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	else if ((timePercent > 0.5) && (timePercent <= 0.75)) {
		if (timePercent < 0.625) {
			start = middleColor - (((timePercent - 0.5) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		else {
			start = result.rgb;
			end = middleColor - (((timePercent - 0.625) / 0.125) * (middleColor - result.rgb));
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x <= lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionX > 0) && (vUv.x >= lineX)) {
		uv.x -= lineX;
	}
	if ((optionY < 0) && (vUv.y <= lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionY > 0) && (vUv.y >= lineY)) {
		uv.y -= lineY;
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x > lineX)) {
		uv.x -= lineX;
	}
	if ((optionX > 0) && (vUv.x < lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionY < 0) && (vUv.y > lineY)) {
		uv.y -= lineY;
	}
	if ((optionY > 0) && (vUv.y < lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 result;
	float resultAlpha;
	if (timePercent < 0.5) {
		result = srcColor.rgb * rgb2yuv;
		result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
		resultAlpha = srcColor.a;
	}
	else {
		result = distColor.rgb * rgb2yuv;
		result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
		resultAlpha = distColor.a;
	}
	result *= yuv2rgb;
	gl_FragColor = vec4(result.rgb, resultAlpha);
}
`},function(b,S){b.exports=`uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute vec2 segment;
attribute float times;
attribute int option;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	vec4 newPosition = vec4(position, 1.0);
	vec2 segmentOrigin = vec2(((segment.x + 0.5) * segmentWidth) - (width * 0.5), (height * 0.5) - ((1.0 * (segment.y + 0.5)) * segmentHeight));
	if (timePercent > times) {
		float percent = (timePercent - times) / 0.7;
		if (percent > 1.0) {
			percent = 1.0;
		}
		if (percent > 0.5) {
			percent += 1.0;
		}
		mat4 matrix = mat4(cos((-1.0 * percent) * 3.14), 0.0, sin((-1.0 * percent) * 3.14), 0.0, 0.0, 1.0, 0.0, 0.0, -sin((-1.0 * percent) * 3.14), 0.0, cos((-1.0 * percent) * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		if (option == 1) {
			matrix = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(percent * 3.14), -sin(percent * 3.14), 0.0, 0.0, sin(percent * 3.13), cos(percent * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		}
		newPosition.x -= segmentOrigin.x;
		newPosition.y -= segmentOrigin.y;
		newPosition = matrix * newPosition;
		newPosition.x += segmentOrigin.x;
		newPosition.y += segmentOrigin.y;
		if (segment.x < (horizontalSegments / 2.0)) {
			fakePercent = percent - (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
		else {
			fakePercent = percent + (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (fakePercent > 0.5) {
		color = distColor;
	}
	if ((fakePercent < 0.5) && (fakePercent > 0.35)) {
		color.a = 0.5;
	}
	gl_FragColor = color;
}
`},function(b,S){b.exports=`#define PI 3.14159265
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	mat4 matrix;
	float stagePercent;
	vec4 newPosition = vec4(position, 1.0);
	float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
	if (selfTimePercent < 0.0) {
		selfTimePercent = 0.0;
	}
	else if (selfTimePercent > 1.0) {
		selfTimePercent = 1.0;
	}
	if (selfTimePercent < (2.0 / 5.0)) {
		stagePercent = selfTimePercent / (2.0 / 5.0);
		newPosition.x -= (0.5 * width);
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 0.5);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
	}
	else if ((selfTimePercent >= (2.0 / 5.0)) && (selfTimePercent < (3.0 / 5.0))) {
		stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);
		newPosition.x -= (0.5 * width);
		newPosition = rotateY((-1.0 * PI) * 0.5) * newPosition;
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 2.0);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= (width * stagePercent);
	}
	else {
		float offset = (((newPosition.x + (0.5 * width)) / width) * 2.0) / 5.0;
		stagePercent = (selfTimePercent - (1.0 / 5.0)) / ((2.0 / 5.0) + offset);
		if (stagePercent > 1.0) {
			stagePercent = 1.0;
		}
		vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
		vvUvv = rotateY(-1.0 * PI) * vvUvv;
		vUv = vvUvv.xy + 0.5;
		newPosition.x -= (0.5 * width);
		matrix = rotateY((((-1.0 * stagePercent) * PI) * 0.5) - (PI * 2.5));
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= width;
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		vUv = uv;
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (timePercent > 0.5) {
		color = distColor;
	}
	if (timePercent < 0.0001) {
		color = srcColor;
	}
	else if (timePercent > 0.9999) {
		color = distColor;
	}
	gl_FragColor = color;
}
`},function(b,S){b.exports=`#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;
uniform float timePercent;
uniform float segmentWidth;
uniform float segments;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	vType = type;
	vec4 newPosition = vec4(position, 1.0);
	float selfPercent = (timePercent - delay) / 0.7;
	rotatePercent = selfPercent;
	if (selfPercent < 0.0) {
		selfPercent = 0.0;
	}
	else if (selfPercent > 1.0) {
		selfPercent = 1.0;
	}
	float offsetX = ((segments * segmentWidth) * 0.5) - ((index + 0.5) * segmentWidth);
	float offsetZ = segmentWidth * 0.5;
	newPosition.x += offsetX;
	newPosition.z += offsetZ;
	newPosition.x *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition.z *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition = rotateY((PI * 0.5) * selfPercent) * newPosition;
	newPosition.x -= offsetX;
	newPosition.z -= offsetZ;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 srcYuv;
	vec3 distYuv;
	if (rotatePercent < 0.5) {
		distYuv = distColor.rgb * rgb2yuv;
		distYuv.r *= (1.0 - (abs(rotatePercent - 0.5) / 0.5));
		distColor = vec4(distYuv * yuv2rgb, distColor.a);
	}
	else {
		srcYuv = distColor.rgb * rgb2yuv;
		srcYuv.r *= (abs(rotatePercent - 0.5) / 0.5);
		srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
	}
	vec4 color = vType < 0.5 ? srcColor : distColor;
	gl_FragColor = color;
}
`},function(b,S){b.exports=`float easeInFloat(float t, float b, float c, float d) {
	t = t / d;
	return ((c * t) * t) + b;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.141592653
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute float isLeft;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vUv = uv;
	float scaleX;
	float transform;
	float displacement;
	vec4 newPosition = vec4(position, 1.0);
	vec4 glPosition = (projectionMatrix * modelViewMatrix) * newPosition;
	float crestCount = 24.0;
	float width = horizontalSegments * segmentWidth;
	float height = verticalSegments * segmentHeight;
	float heightFactor = (newPosition.y + (height * 0.5)) / height;
	float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
	newPosition.y += (height * 0.5);
	newPosition.y *= scaleY;
	newPosition.y -= (height * 0.5);
	newPosition.y += 10.0;
	if ((timePercent > 0.0) && (timePercent < 0.333)) {
		float delay = (1.0 - heightFactor) * 0.1;
		scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
	}
	else if ((timePercent >= 0.333) && (timePercent < 0.5)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if ((timePercent >= 0.5) && (timePercent < 0.583)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if (timePercent >= 0.583) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop + incr;
	}
	if (timePercent > 0.583) {
		displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
	}
	float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
	float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
	float amp = ampBottom + (heightFactor * abs(ampBottom - ampTop));
	float foo = newPosition.x * ((crestCount * PI) / width);
	newPosition.z = (amp * cos(foo + (PI / 2.0))) * 20.0;
	transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
	newPosition.x += transform;
	newPosition.x *= scaleX;
	newPosition.x -= transform;
	newPosition.x += displacement;
	shadow = vec4(0.0, 0.0, 0.0, 0.0);
	if (newPosition.z < 15.0) {
		float alpha = 0.3 * (1.0 - ((newPosition.z + 20.0) / 35.0));
		shadow.a = alpha * amp;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = blendSrcOver(shadow, srcColor);
	gl_FragColor = color;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265
uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float curve;
	float progress = option == 1 ? halfWidth - newPosition.x : newPosition.x + halfWidth;
	float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
	float aEnd = 0.0000009;
	float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
	float zEnd = 0.0;
	float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, progress, 0);
	float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.z -= (((-a * newPosition.y) * newPosition.y) + z);
	float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
	float scaleYEnd = 1.0;
	float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.y += halfHeight;
	newPosition.y *= scaleY;
	float angle = interpolationFloat(0.0, -((2.0 * PI) / 3.0), 0.111, 1.0, timePercent, 1);
	mat4 rotateX = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	newPosition = rotateX * newPosition;
	newPosition.y -= halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
varying float shadowAlpha;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec2 shadowPosition = vec2(position.xy);
	float presetAngle = option == 1 ? 0.77 : 0.27;
	float rotateAngle = PI * presetAngle;
	float min_r = halfWidth * 0.05;
	shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;
	vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);
	float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
	float dis2BaseLine = halfWidth - newPosition.x;
	float dis2Line = line - dis2BaseLine;
	float L = line <= (halfWidth * 2.0) ? line : halfWidth * 2.0;
	float r = L / PI;
	r = r < min_r ? min_r : r;
	float angle = dis2Line / r;
	if (((dis2Line > 0.0) && (dis2Line < (line * 0.5))) && (r > min_r)) {
		shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
	}
	else {
		shadowAlpha = 0.0;
	}
	if (dis2BaseLine < line) {
		newPosition.x = ((sin(angle) * r) + halfWidth) - line;
		newPosition.z = (r - (cos(angle) * r)) * 0.5;
	}
	vec2 finalPosition = vec2(newPosition.xy);
	finalPosition = rotateOrigin(-rotateAngle) * finalPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateX(float angle) {
	return mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float progress = option == 0 ? halfWidth - newPosition.x : halfWidth + newPosition.x;
	float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, progress, 0);
	float arc = halfHeight - newPosition.y;
	float L;
	if (timePercent < 0.8) {
		L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
	}
	else {
		L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
	}
	float r = L / (2.0 * PI);
	float angle = PI - (arc / r);
	float y = sin(angle) * r;
	float z = cos(angle) * r;
	newPosition.y = halfHeight - y;
	newPosition.z = (z + r) * 0.45;
	float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(rotateAngle) * newPosition;
	newPosition.y += halfHeight;
	float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate1) * newPosition;
	newPosition.y += halfHeight;
	float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate2) * newPosition;
	newPosition.y += halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);
	gl_FragColor = blendSrcOver(shadow, distColor);
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float shadowAngle = PI / 6.0;
	float clockAngle;
	vec2 a;
	vec2 b = transform(vUv);
	float angle;
	if (timePercent < 0.5) {
		a = vec2(0.0, 0.5);
		clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
		if (b.x > 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 1.0;
		}
	}
	else {
		a = vec2(0.0, -0.5);
		clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
		if (b.x <= 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 0.0;
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uv = vUv;
	bool useSrc = false;
	vec2 row;
	float delay = 0.02;
	bool isVert = bool(option);
	int segmentCount = isVert ? 10 : 7;
	float axis = isVert ? uv.y : uv.x;
	float compareAxis = isVert ? uv.x : uv.y;
	for (int i = 0; i < segmentCount; i++) {
		float fi = float(i);
		row.r = (fi * 1.0) / float(segmentCount);
		row.g = (float(i + 1) * 1.0) / float(segmentCount);
		if ((compareAxis <= row.g) && (compareAxis > row.r)) {
			if ((i % 2) == 0) {
				float line = interpolationFloat(0.0, 1.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					useSrc = false;
				}
				else {
					axis -= line;
					useSrc = true;
				}
			}
			else {
				float line = interpolationFloat(1.0, 0.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					axis = (1.0 - line) + axis;
					useSrc = true;
				}
				else {
					useSrc = false;
				}
			}
			break;
		}
	}
	if (isVert) {
		uv.y = axis;
	}
	else {
		uv.x = axis;
	}
	vec4 srcColor = texture2D(texturePrev, uv);
	vec4 distColor = texture2D(textureNext, uv);
	gl_FragColor = useSrc ? srcColor : distColor;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uvSrc = vUv;
	vec2 uvDist = vUv;
	float scaleSrc = option == 1 ? interpolationFloat(1.0, 2.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
	float scaleDist = option == 1 ? interpolationFloat(0.1, 1.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
	uvSrc -= 0.5;
	uvSrc *= scaleSrc;
	uvSrc += 0.5;
	uvDist -= 0.5;
	uvDist *= scaleDist;
	uvDist += 0.5;
	vec4 srcColor = texture2D(texturePrev, uvSrc);
	srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
	vec4 distColor;
	if ((((uvDist.x > 1.0) || (uvDist.x < 0.0)) || (uvDist.y > 1.0)) || (uvDist.y < 0.0)) {
		distColor = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		distColor = texture2D(textureNext, uvDist);
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateY(float angle) {
	if (option == 1) {
		angle *= -1.0;
	}
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float stageOneAngle = PI / 14.0;
	float stageTwoAngle = (PI * 12.0) / 14.0;
	float stage_1 = 0.1;
	float stage_2 = 0.8;
	if (timePercent < 0.5) {
		newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
	}
	else {
		newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
	}
	if (timePercent < stage_1) {
		float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
		newPosition.x += halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x -= halfWidth;
	}
	else if ((timePercent >= stage_1) && (timePercent < stage_2)) {
		if (timePercent > 0.5) {
			newPosition *= rotateY(PI);
		}
		float offset = halfWidth - (sin((PI * 0.5) - stageOneAngle) * halfWidth);
		float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
		newPosition *= rotateY(stageOneAngle);
		newPosition.x -= halfWidth;
		newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
	}
	else {
		float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
		newPosition.x -= halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = (option == 3) || (option == 2);
	bool rotateParam = (option == 3) || (option == 1);
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 1.5;
		rectEnd = isRevert ? 0.5 : 2.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 1.5) + 0.5 : 2.0 - (((timePercent - 0.33) / 0.33) * 1.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 1.5 : 0.0;
		rectEnd = isRevert ? 2.0 : 0.5;
	}
	if (!rotateParam) {
		rectStart -= 1.0;
		rectEnd -= 1.0;
	}
	float rotate = rotateParam ? PI * 0.25 : PI * 0.75;
	vec2 rotateUv = vUv * rotateOrigin(rotate);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 startPoint = vec2(rectStart, 0.0) * rotateOrigin(rotate);
	vec2 endPoint = vec2(rectEnd, 0.0) * rotateOrigin(rotate);
	if (rotateParam) {
		if (rotateUv.x >= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x <= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((rotateUv.x - startPoint.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	else {
		if (rotateUv.x <= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x >= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((startPoint.x - rotateUv.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,S){b.exports=`#define PI 3.14159265
attribute float left;
uniform float timePercent;
uniform float offset;
varying vec2 vUv;
uniform float option;
void main() {
	vUv = uv;
	float angle;
	if (left > 0.0) {
		angle = (PI / 6.0) * timePercent;
	}
	else {
		angle = (-PI / 6.0) * timePercent;
	}
	if (option > 0.5) {
		if (left > 0.0) {
			angle = (-PI / 6.0) * timePercent;
		}
		else {
			angle = (PI / 6.0) * timePercent;
		}
	}
	vec4 newPosition = vec4(position, 1.0);
	mat4 transform;
	mat4 rotateY = mat4(cos(angle), 0.0, -sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, sin(angle), 0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	if (option > 0.5) {
		rotateY = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), -sin(angle), 0.0, 0.0, sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	}
	if (option > 0.5) {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, offset * timePercent, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -offset * timePercent, 0.0, 1.0);
		}
	}
	else {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -offset * timePercent, 0.0, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, offset * timePercent, 0.0, 0.0, 1.0);
		}
	}
	newPosition = transform * newPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,S){b.exports=`uniform sampler2D prevTexture;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 color = texture2D(prevTexture, vUv);
	color.a = 1.0 - timePercent;
	gl_FragColor = color;
}
`},function(b,S,v){(function(O){var R=v(109),M=v(110),D=setTimeout;function B(I){return Boolean(I&&I.length!==void 0)}function z(){}function X(I){if(!(this instanceof X))throw new TypeError("Promises must be constructed via new");if(typeof I!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],L(I,this)}function J(I,F){for(;I._state===3;)I=I._value;I._state!==0?(I._handled=!0,X._immediateFn(function(){var W=I._state===1?F.onFulfilled:F.onRejected;if(W!==null){var P;try{P=W(I._value)}catch(j){return void pt(F.promise,j)}et(F.promise,P)}else(I._state===1?et:pt)(F.promise,I._value)})):I._deferreds.push(F)}function et(I,F){try{if(F===I)throw new TypeError("A promise cannot be resolved with itself.");if(F&&(typeof F=="object"||typeof F=="function")){var W=F.then;if(F instanceof X)return I._state=3,I._value=F,void Nt(I);if(typeof W=="function")return void L((P=W,j=F,function(){P.apply(j,arguments)}),I)}I._state=1,I._value=F,Nt(I)}catch(Q){pt(I,Q)}var P,j}function pt(I,F){I._state=2,I._value=F,Nt(I)}function Nt(I){I._state===2&&I._deferreds.length===0&&X._immediateFn(function(){I._handled||X._unhandledRejectionFn(I._value)});for(var F=0,W=I._deferreds.length;F<W;F++)J(I,I._deferreds[F]);I._deferreds=null}function vt(I,F,W){this.onFulfilled=typeof I=="function"?I:null,this.onRejected=typeof F=="function"?F:null,this.promise=W}function L(I,F){var W=!1;try{I(function(P){W||(W=!0,et(F,P))},function(P){W||(W=!0,pt(F,P))})}catch(P){if(W)return;W=!0,pt(F,P)}}X.prototype.catch=function(I){return this.then(null,I)},X.prototype.then=function(I,F){var W=new this.constructor(z);return J(this,new vt(I,F,W)),W},X.prototype.finally=R.a,X.all=function(I){return new X(function(F,W){if(!B(I))return W(new TypeError("Promise.all accepts an array"));var P=Array.prototype.slice.call(I);if(P.length===0)return F([]);var j=P.length;function Q(Ot,Vt){try{if(Vt&&(typeof Vt=="object"||typeof Vt=="function")){var st=Vt.then;if(typeof st=="function")return void st.call(Vt,function(V){Q(Ot,V)},W)}P[Ot]=Vt,--j==0&&F(P)}catch(V){W(V)}}for(var H=0;H<P.length;H++)Q(H,P[H])})},X.allSettled=M.a,X.resolve=function(I){return I&&typeof I=="object"&&I.constructor===X?I:new X(function(F){F(I)})},X.reject=function(I){return new X(function(F,W){W(I)})},X.race=function(I){return new X(function(F,W){if(!B(I))return W(new TypeError("Promise.race accepts an array"));for(var P=0,j=I.length;P<j;P++)X.resolve(I[P]).then(F,W)})},X._immediateFn=typeof O=="function"&&function(I){O(I)}||function(I){D(I,0)},X._unhandledRejectionFn=function(I){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",I)},S.a=X}).call(this,v(140).setImmediate)},function(b,S,v){S.a=function(O){var R=this.constructor;return this.then(function(M){return R.resolve(O()).then(function(){return M})},function(M){return R.resolve(O()).then(function(){return R.reject(M)})})}},function(b,S,v){S.a=function(O){return new this(function(R,M){if(!O||O.length===void 0)return M(new TypeError(typeof O+" "+O+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var D=Array.prototype.slice.call(O);if(D.length===0)return R([]);var B=D.length;function z(J,et){if(et&&(typeof et=="object"||typeof et=="function")){var pt=et.then;if(typeof pt=="function")return void pt.call(et,function(Nt){z(J,Nt)},function(Nt){D[J]={status:"rejected",reason:Nt},--B==0&&R(D)})}D[J]={status:"fulfilled",value:et},--B==0&&R(D)}for(var X=0;X<D.length;X++)z(X,D[X])})}},function(b,S,v){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var O=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;function D(B){if(B==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(B)}b.exports=function(){try{if(!Object.assign)return!1;var B=new String("abc");if(B[5]="de",Object.getOwnPropertyNames(B)[0]==="5")return!1;for(var z={},X=0;X<10;X++)z["_"+String.fromCharCode(X)]=X;if(Object.getOwnPropertyNames(z).map(function(et){return z[et]}).join("")!=="0123456789")return!1;var J={};return"abcdefghijklmnopqrst".split("").forEach(function(et){J[et]=et}),Object.keys(Object.assign({},J)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(B,z){for(var X,J,et=D(B),pt=1;pt<arguments.length;pt++){for(var Nt in X=Object(arguments[pt]))R.call(X,Nt)&&(et[Nt]=X[Nt]);if(O){J=O(X);for(var vt=0;vt<J.length;vt++)M.call(X,J[vt])&&(et[J[vt]]=X[J[vt]])}}return et}},function(b,S,v){var O=v(20),R=v(15);b.exports=function(M){return M===!0||M===!1||R(M)&&O(M)=="[object Boolean]"}},function(b,S){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,S){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 uGlowColor;
uniform vec2 uSdfPosition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	vec4 glowColor = vec4(uGlowColor.rgb * uGlowColor.a, uGlowColor.a);
	float a = 1.0;
	if (uSdfIsReady > 0.0) {
		vec2 cod = vec2(filterCoord.x / uShapeFilterArea.z, filterCoord.y / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod + uSdfPosition);
		float dis = sdfColor.a * uSdfMaxDis;
		if ((sdfColor.r <= 0.0) && (dis >= (uRad * 0.5))) {
			a = 1.0 - smoothstep(uRad * 0.5, uRad, dis);
		}
	}
	vec4 resultColor = blendSrcOver(texColor, glowColor);
	resultColor.rgb *= resultColor.a;
	resultColor.rgb *= a;
	resultColor.a *= a;
	gl_FragColor = uSdfIsReady > 0.0 ? resultColor : texColor;
}
`},function(b,S){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	float alpha = texColor.a;
	texColor /= texColor.a;
	if (uSdfIsReady > 0.0) {
		float dx = uShapeFilterArea.x < 0.0 ? -uShapeFilterArea.x : 0.0;
		float dy = uShapeFilterArea.y < 0.0 ? -uShapeFilterArea.y : 0.0;
		vec2 cod = vec2((filterCoord.x + dx) / uShapeFilterArea.z, (filterCoord.y + dy) / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod);
		float dis = sdfColor.a * uSdfMaxDis;
		if (texColor.a > 0.0392156862745098) {
			if (dis <= (uRad / 2.0)) {
				float a = smoothstep(0.0, uRad / 2.0, dis) * 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
			else if ((dis > (uRad / 2.0)) && (dis < (uRad * 1.2))) {
				float a = (smoothstep(uRad / 2.0, uRad * 1.2, dis) * 0.9) + 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
		}
		else {
			texColor.rgba *= 0.0;
		}
	}
	texColor *= alpha;
	gl_FragColor = texColor;
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 uColor;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	if (sourceColor.a == 0.0) {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
	else {
		gl_FragColor = uColor * sourceColor.a;
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform float uStartPos;
uniform float uEndPos;
uniform float uHeight;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	vec2 cod = vTextureCoord * inputSize.xy;
	float startY = uStartPos * uHeight;
	float endY = uEndPos * uHeight;
	if ((cod.y >= startY) && (cod.y <= endY)) {
		float alpha = uStartAlpha - (((cod.y - startY) / (endY - startY)) * (uStartAlpha - uEndAlpha));
		gl_FragColor = sourceColor * alpha;
	}
	else {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
}
`},function(b,S){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	if (texColor.r > 0.0) {
		vec2 translateCoord = vec2(filterCoord.x + 10.0, filterCoord.y);
		vec4 translateColor = texture2D(uSampler, translateCoord * inputSize.zw);
		if (translateColor.a > 0.0) {
			gl_FragColor = texColor;
		}
		else {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	else {
		gl_FragColor = texColor;
	}
}
`},function(b,S,v){var O;(function(R,M){var D="model",B="name",z="type",X="vendor",J="version",et="mobile",pt="tablet",Nt="smarttv",vt=function(st){for(var V={},k=0;k<st.length;k++)V[st[k].toUpperCase()]=st[k];return V},L=function(st,V){return typeof st=="string"&&I(V).indexOf(I(st))!==-1},I=function(st){return st.toLowerCase()},F=function(st,V){if(typeof st=="string")return st=st.replace(/^\s\s*/,"").replace(/\s\s*$/,""),V===void 0?st:st.substring(0,255)},W=function(st,V){for(var k,mt,tt,_t,Dt,Z,ct=0;ct<V.length&&!Dt;){var rt=V[ct],yt=V[ct+1];for(k=mt=0;k<rt.length&&!Dt;)if(Dt=rt[k++].exec(st))for(tt=0;tt<yt.length;tt++)Z=Dt[++mt],typeof(_t=yt[tt])=="object"&&_t.length>0?_t.length===2?typeof _t[1]=="function"?this[_t[0]]=_t[1].call(this,Z):this[_t[0]]=_t[1]:_t.length===3?typeof _t[1]!="function"||_t[1].exec&&_t[1].test?this[_t[0]]=Z?Z.replace(_t[1],_t[2]):void 0:this[_t[0]]=Z?_t[1].call(this,Z,_t[2]):void 0:_t.length===4&&(this[_t[0]]=Z?_t[3].call(this,Z.replace(_t[1],_t[2])):void 0):this[_t]=Z||void 0;ct+=2}},P=function(st,V){for(var k in V)if(typeof V[k]=="object"&&V[k].length>0){for(var mt=0;mt<V[k].length;mt++)if(L(V[k][mt],st))return k==="?"?void 0:k}else if(L(V[k],st))return k==="?"?void 0:k;return st},j={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[J,[B,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[J,[B,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[B,J],[/opios[\/ ]+([\w\.]+)/i],[J,[B,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[J,[B,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[B,J],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[J,[B,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[J,[B,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[J,[B,"WeChat"]],[/konqueror\/([\w\.]+)/i],[J,[B,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[J,[B,"IE"]],[/yabrowser\/([\w\.]+)/i],[J,[B,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[B,/(.+)/,"$1 Secure Browser"],J],[/\bfocus\/([\w\.]+)/i],[J,[B,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[J,[B,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[J,[B,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[J,[B,"Dolphin"]],[/coast\/([\w\.]+)/i],[J,[B,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[J,[B,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[J,[B,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[B,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[B,/(.+)/,"$1 Browser"],J],[/(comodo_dragon)\/([\w\.]+)/i],[[B,/_/g," "],J],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[B,J],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[B],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[B,"Facebook"],J],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[B,J],[/\bgsa\/([\w\.]+) .*safari\//i],[J,[B,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[J,[B,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[B,"Chrome WebView"],J],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[J,[B,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[B,J],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[J,[B,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[J,B],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[B,[J,P,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[B,J],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[B,"Netscape"],J],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[J,[B,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[B,J]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",I]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",I]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",I]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[D,[X,"Samsung"],[z,pt]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[D,[X,"Samsung"],[z,et]],[/\((ip(?:hone|od)[\w ]*);/i],[D,[X,"Apple"],[z,et]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[D,[X,"Apple"],[z,pt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[D,[X,"Huawei"],[z,pt]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[D,[X,"Huawei"],[z,et]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[D,/_/g," "],[X,"Xiaomi"],[z,et]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[D,/_/g," "],[X,"Xiaomi"],[z,pt]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[D,[X,"OPPO"],[z,et]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[D,[X,"Vivo"],[z,et]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[D,[X,"Realme"],[z,et]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[D,[X,"Motorola"],[z,et]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[D,[X,"Motorola"],[z,pt]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[D,[X,"LG"],[z,pt]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[D,[X,"LG"],[z,et]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[D,[X,"Lenovo"],[z,pt]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[D,/_/g," "],[X,"Nokia"],[z,et]],[/(pixel c)\b/i],[D,[X,"Google"],[z,pt]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[D,[X,"Google"],[z,et]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[D,[X,"Sony"],[z,et]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[D,"Xperia Tablet"],[X,"Sony"],[z,pt]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[D,[X,"OnePlus"],[z,et]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[D,[X,"Amazon"],[z,pt]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[D,/(.+)/g,"Fire Phone $1"],[X,"Amazon"],[z,et]],[/(playbook);[-\w\),; ]+(rim)/i],[D,X,[z,pt]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[D,[X,"BlackBerry"],[z,et]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[D,[X,"ASUS"],[z,pt]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[D,[X,"ASUS"],[z,et]],[/(nexus 9)/i],[D,[X,"HTC"],[z,pt]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[X,[D,/_/g," "],[z,et]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[D,[X,"Acer"],[z,pt]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[D,[X,"Meizu"],[z,et]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[D,[X,"Sharp"],[z,et]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[X,D,[z,et]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[X,D,[z,pt]],[/(surface duo)/i],[D,[X,"Microsoft"],[z,pt]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[D,[X,"Fairphone"],[z,et]],[/(u304aa)/i],[D,[X,"AT&T"],[z,et]],[/\bsie-(\w*)/i],[D,[X,"Siemens"],[z,et]],[/\b(rct\w+) b/i],[D,[X,"RCA"],[z,pt]],[/\b(venue[\d ]{2,7}) b/i],[D,[X,"Dell"],[z,pt]],[/\b(q(?:mv|ta)\w+) b/i],[D,[X,"Verizon"],[z,pt]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[D,[X,"Barnes & Noble"],[z,pt]],[/\b(tm\d{3}\w+) b/i],[D,[X,"NuVision"],[z,pt]],[/\b(k88) b/i],[D,[X,"ZTE"],[z,pt]],[/\b(nx\d{3}j) b/i],[D,[X,"ZTE"],[z,et]],[/\b(gen\d{3}) b.+49h/i],[D,[X,"Swiss"],[z,et]],[/\b(zur\d{3}) b/i],[D,[X,"Swiss"],[z,pt]],[/\b((zeki)?tb.*\b) b/i],[D,[X,"Zeki"],[z,pt]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[X,"Dragon Touch"],D,[z,pt]],[/\b(ns-?\w{0,9}) b/i],[D,[X,"Insignia"],[z,pt]],[/\b((nxa|next)-?\w{0,9}) b/i],[D,[X,"NextBook"],[z,pt]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[X,"Voice"],D,[z,et]],[/\b(lvtel\-)?(v1[12]) b/i],[[X,"LvTel"],D,[z,et]],[/\b(ph-1) /i],[D,[X,"Essential"],[z,et]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[D,[X,"Envizen"],[z,pt]],[/\b(trio[-\w\. ]+) b/i],[D,[X,"MachSpeed"],[z,pt]],[/\btu_(1491) b/i],[D,[X,"Rotor"],[z,pt]],[/(shield[\w ]+) b/i],[D,[X,"Nvidia"],[z,pt]],[/(sprint) (\w+)/i],[X,D,[z,et]],[/(kin\.[onetw]{3})/i],[[D,/\./g," "],[X,"Microsoft"],[z,et]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[D,[X,"Zebra"],[z,pt]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[D,[X,"Zebra"],[z,et]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[X,D,[z,"console"]],[/droid.+; (shield) bui/i],[D,[X,"Nvidia"],[z,"console"]],[/(playstation [345portablevi]+)/i],[D,[X,"Sony"],[z,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[D,[X,"Microsoft"],[z,"console"]],[/smart-tv.+(samsung)/i],[X,[z,Nt]],[/hbbtv.+maple;(\d+)/i],[[D,/^/,"SmartTV"],[X,"Samsung"],[z,Nt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[X,"LG"],[z,Nt]],[/(apple) ?tv/i],[X,[D,"Apple TV"],[z,Nt]],[/crkey/i],[[D,"Chromecast"],[X,"Google"],[z,Nt]],[/droid.+aft(\w)( bui|\))/i],[D,[X,"Amazon"],[z,Nt]],[/\(dtv[\);].+(aquos)/i],[D,[X,"Sharp"],[z,Nt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[X,F],[D,F],[z,Nt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[z,Nt]],[/((pebble))app/i],[X,D,[z,"wearable"]],[/droid.+; (glass) \d/i],[D,[X,"Google"],[z,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[D,[X,"Zebra"],[z,"wearable"]],[/(quest( 2)?)/i],[D,[X,"Facebook"],[z,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[X,[z,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[D,[z,et]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[D,[z,pt]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[z,pt]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[z,et]],[/(android[-\w\. ]{0,9});.+buil/i],[D,[X,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[J,[B,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[J,[B,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[B,J],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[J,B]],os:[[/microsoft (windows) (vista|xp)/i],[B,J],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[B,[J,P,j]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[B,"Windows"],[J,P,j]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[J,/_/g,"."],[B,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[B,"Mac OS"],[J,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[J,B],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[B,J],[/\(bb(10);/i],[J,[B,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[J,[B,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[J,[B,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[J,[B,"webOS"]],[/crkey\/([\d\.]+)/i],[J,[B,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[B,"Chromium OS"],J],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[B,J],[/(sunos) ?([\w\.\d]*)/i],[[B,"Solaris"],J],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[B,J]]},H=function(st,V){if(typeof st=="object"&&(V=st,st=void 0),!(this instanceof H))return new H(st,V).getResult();var k=st||(R!==void 0&&R.navigator&&R.navigator.userAgent?R.navigator.userAgent:""),mt=V?function(tt,_t){var Dt={};for(var Z in tt)_t[Z]&&_t[Z].length%2==0?Dt[Z]=_t[Z].concat(tt[Z]):Dt[Z]=tt[Z];return Dt}(Q,V):Q;return this.getBrowser=function(){var tt,_t={};return _t[B]=void 0,_t[J]=void 0,W.call(_t,k,mt.browser),_t.major=typeof(tt=_t.version)=="string"?tt.replace(/[^\d\.]/g,"").split(".")[0]:void 0,_t},this.getCPU=function(){var tt={architecture:void 0};return W.call(tt,k,mt.cpu),tt},this.getDevice=function(){var tt={vendor:void 0,model:void 0,type:void 0};return W.call(tt,k,mt.device),tt},this.getEngine=function(){var tt={name:void 0,version:void 0};return W.call(tt,k,mt.engine),tt},this.getOS=function(){var tt={name:void 0,version:void 0};return W.call(tt,k,mt.os),tt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return k},this.setUA=function(tt){return k=typeof tt=="string"&&tt.length>255?F(tt,255):tt,this},this.setUA(k),this};H.VERSION="1.0.2",H.BROWSER=vt([B,J,"major"]),H.CPU=vt(["architecture"]),H.DEVICE=vt([D,X,z,"console",et,Nt,pt,"wearable","embedded"]),H.ENGINE=H.OS=vt([B,J]),S!==void 0?(b!==void 0&&b.exports&&(S=b.exports=H),S.UAParser=H):v(149)?(O=function(){return H}.call(S,v,S,b))===void 0||(b.exports=O):R!==void 0&&(R.UAParser=H);var Ot=R!==void 0&&(R.jQuery||R.Zepto);if(Ot&&!Ot.ua){var Vt=new H;Ot.ua=Vt.getResult(),Ot.ua.get=function(){return Vt.getUA()},Ot.ua.set=function(st){Vt.setUA(st);var V=Vt.getResult();for(var k in V)Ot.ua[k]=V[k]}}})(typeof window=="object"?window:this)},function(b,S,v){(function(O){var R;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var M=function(){this.init()};M.prototype={init:function(){var L=this||D;return L._counter=1e3,L._html5AudioPool=[],L.html5PoolSize=10,L._codecs={},L._howls=[],L._muted=!1,L._volume=1,L._canPlayEvent="canplaythrough",L._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,L.masterGain=null,L.noAudio=!1,L.usingWebAudio=!0,L.autoSuspend=!0,L.ctx=null,L.autoUnlock=!0,L._setup(),L},volume:function(L){var I=this||D;if(L=parseFloat(L),I.ctx||vt(),L!==void 0&&L>=0&&L<=1){if(I._volume=L,I._muted)return I;I.usingWebAudio&&I.masterGain.gain.setValueAtTime(L,D.ctx.currentTime);for(var F=0;F<I._howls.length;F++)if(!I._howls[F]._webAudio)for(var W=I._howls[F]._getSoundIds(),P=0;P<W.length;P++){var j=I._howls[F]._soundById(W[P]);j&&j._node&&(j._node.volume=j._volume*L)}return I}return I._volume},mute:function(L){var I=this||D;I.ctx||vt(),I._muted=L,I.usingWebAudio&&I.masterGain.gain.setValueAtTime(L?0:I._volume,D.ctx.currentTime);for(var F=0;F<I._howls.length;F++)if(!I._howls[F]._webAudio)for(var W=I._howls[F]._getSoundIds(),P=0;P<W.length;P++){var j=I._howls[F]._soundById(W[P]);j&&j._node&&(j._node.muted=!!L||j._muted)}return I},stop:function(){for(var L=this||D,I=0;I<L._howls.length;I++)L._howls[I].stop();return L},unload:function(){for(var L=this||D,I=L._howls.length-1;I>=0;I--)L._howls[I].unload();return L.usingWebAudio&&L.ctx&&L.ctx.close!==void 0&&(L.ctx.close(),L.ctx=null,vt()),L},codecs:function(L){return(this||D)._codecs[L.replace(/^x-/,"")]},_setup:function(){var L=this||D;if(L.state=L.ctx&&L.ctx.state||"suspended",L._autoSuspend(),!L.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(L._canPlayEvent="canplay")}catch{L.noAudio=!0}else L.noAudio=!0;try{new Audio().muted&&(L.noAudio=!0)}catch{}return L.noAudio||L._setupCodecs(),L},_setupCodecs:function(){var L=this||D,I=null;try{I=typeof Audio!="undefined"?new Audio:null}catch{return L}if(!I||typeof I.canPlayType!="function")return L;var F=I.canPlayType("audio/mpeg;").replace(/^no$/,""),W=L._navigator?L._navigator.userAgent:"",P=W.match(/OPR\/([0-6].)/g),j=P&&parseInt(P[0].split("/")[1],10)<33,Q=W.indexOf("Safari")!==-1&&W.indexOf("Chrome")===-1,H=W.match(/Version\/(.*?) /),Ot=Q&&H&&parseInt(H[1],10)<15;return L._codecs={mp3:!(j||!F&&!I.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!F,opus:!!I.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!I.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!I.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(I.canPlayType('audio/wav; codecs="1"')||I.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!I.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!I.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(I.canPlayType("audio/x-m4a;")||I.canPlayType("audio/m4a;")||I.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(I.canPlayType("audio/x-m4b;")||I.canPlayType("audio/m4b;")||I.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(I.canPlayType("audio/x-mp4;")||I.canPlayType("audio/mp4;")||I.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(Ot||!I.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(Ot||!I.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!I.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(I.canPlayType("audio/x-flac;")||I.canPlayType("audio/flac;")).replace(/^no$/,"")},L},_unlockAudio:function(){var L=this||D;if(!L._audioUnlocked&&L.ctx){L._audioUnlocked=!1,L.autoUnlock=!1,L._mobileUnloaded||L.ctx.sampleRate===44100||(L._mobileUnloaded=!0,L.unload()),L._scratchBuffer=L.ctx.createBuffer(1,1,22050);var I=function(F){for(;L._html5AudioPool.length<L.html5PoolSize;)try{var W=new Audio;W._unlocked=!0,L._releaseHtml5Audio(W)}catch{L.noAudio=!0;break}for(var P=0;P<L._howls.length;P++)if(!L._howls[P]._webAudio)for(var j=L._howls[P]._getSoundIds(),Q=0;Q<j.length;Q++){var H=L._howls[P]._soundById(j[Q]);H&&H._node&&!H._node._unlocked&&(H._node._unlocked=!0,H._node.load())}L._autoResume();var Ot=L.ctx.createBufferSource();Ot.buffer=L._scratchBuffer,Ot.connect(L.ctx.destination),Ot.start===void 0?Ot.noteOn(0):Ot.start(0),typeof L.ctx.resume=="function"&&L.ctx.resume(),Ot.onended=function(){Ot.disconnect(0),L._audioUnlocked=!0,document.removeEventListener("touchstart",I,!0),document.removeEventListener("touchend",I,!0),document.removeEventListener("click",I,!0),document.removeEventListener("keydown",I,!0);for(var Vt=0;Vt<L._howls.length;Vt++)L._howls[Vt]._emit("unlock")}};return document.addEventListener("touchstart",I,!0),document.addEventListener("touchend",I,!0),document.addEventListener("click",I,!0),document.addEventListener("keydown",I,!0),L}},_obtainHtml5Audio:function(){var L=this||D;if(L._html5AudioPool.length)return L._html5AudioPool.pop();var I=new Audio().play();return I&&typeof Promise!="undefined"&&(I instanceof Promise||typeof I.then=="function")&&I.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(L){var I=this||D;return L._unlocked&&I._html5AudioPool.push(L),I},_autoSuspend:function(){var L=this;if(L.autoSuspend&&L.ctx&&L.ctx.suspend!==void 0&&D.usingWebAudio){for(var I=0;I<L._howls.length;I++)if(L._howls[I]._webAudio){for(var F=0;F<L._howls[I]._sounds.length;F++)if(!L._howls[I]._sounds[F]._paused)return L}return L._suspendTimer&&clearTimeout(L._suspendTimer),L._suspendTimer=setTimeout(function(){if(L.autoSuspend){L._suspendTimer=null,L.state="suspending";var W=function(){L.state="suspended",L._resumeAfterSuspend&&(delete L._resumeAfterSuspend,L._autoResume())};L.ctx.suspend().then(W,W)}},3e4),L}},_autoResume:function(){var L=this;if(L.ctx&&L.ctx.resume!==void 0&&D.usingWebAudio)return L.state==="running"&&L.ctx.state!=="interrupted"&&L._suspendTimer?(clearTimeout(L._suspendTimer),L._suspendTimer=null):L.state==="suspended"||L.state==="running"&&L.ctx.state==="interrupted"?(L.ctx.resume().then(function(){L.state="running";for(var I=0;I<L._howls.length;I++)L._howls[I]._emit("resume")}),L._suspendTimer&&(clearTimeout(L._suspendTimer),L._suspendTimer=null)):L.state==="suspending"&&(L._resumeAfterSuspend=!0),L}};var D=new M,B=function(L){L.src&&L.src.length!==0?this.init(L):console.error("An array of source files must be passed with any new Howl.")};B.prototype={init:function(L){var I=this;return D.ctx||vt(),I._autoplay=L.autoplay||!1,I._format=typeof L.format!="string"?L.format:[L.format],I._html5=L.html5||!1,I._muted=L.mute||!1,I._loop=L.loop||!1,I._pool=L.pool||5,I._preload=typeof L.preload!="boolean"&&L.preload!=="metadata"||L.preload,I._rate=L.rate||1,I._sprite=L.sprite||{},I._src=typeof L.src!="string"?L.src:[L.src],I._volume=L.volume!==void 0?L.volume:1,I._xhr={method:L.xhr&&L.xhr.method?L.xhr.method:"GET",headers:L.xhr&&L.xhr.headers?L.xhr.headers:null,withCredentials:!(!L.xhr||!L.xhr.withCredentials)&&L.xhr.withCredentials},I._duration=0,I._state="unloaded",I._sounds=[],I._endTimers={},I._queue=[],I._playLock=!1,I._onend=L.onend?[{fn:L.onend}]:[],I._onfade=L.onfade?[{fn:L.onfade}]:[],I._onload=L.onload?[{fn:L.onload}]:[],I._onloaderror=L.onloaderror?[{fn:L.onloaderror}]:[],I._onplayerror=L.onplayerror?[{fn:L.onplayerror}]:[],I._onpause=L.onpause?[{fn:L.onpause}]:[],I._onplay=L.onplay?[{fn:L.onplay}]:[],I._onstop=L.onstop?[{fn:L.onstop}]:[],I._onmute=L.onmute?[{fn:L.onmute}]:[],I._onvolume=L.onvolume?[{fn:L.onvolume}]:[],I._onrate=L.onrate?[{fn:L.onrate}]:[],I._onseek=L.onseek?[{fn:L.onseek}]:[],I._onunlock=L.onunlock?[{fn:L.onunlock}]:[],I._onresume=[],I._webAudio=D.usingWebAudio&&!I._html5,D.ctx!==void 0&&D.ctx&&D.autoUnlock&&D._unlockAudio(),D._howls.push(I),I._autoplay&&I._queue.push({event:"play",action:function(){I.play()}}),I._preload&&I._preload!=="none"&&I.load(),I},load:function(){var L=null;if(D.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var I=0;I<this._src.length;I++){var F,W;if(this._format&&this._format[I])F=this._format[I];else{if(typeof(W=this._src[I])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(F=/^data:audio\/([^;,]+);/i.exec(W))||(F=/\.([^.]+)$/.exec(W.split("?",1)[0])),F&&(F=F[1].toLowerCase())}if(F||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),F&&D.codecs(F)){L=this._src[I];break}}if(L)return this._src=L,this._state="loading",window.location.protocol==="https:"&&L.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new z(this),this._webAudio&&J(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(L,I){var F=this,W=null;if(typeof L=="number")W=L,L=null;else{if(typeof L=="string"&&F._state==="loaded"&&!F._sprite[L])return null;if(L===void 0&&(L="__default",!F._playLock)){for(var P=0,j=0;j<F._sounds.length;j++)F._sounds[j]._paused&&!F._sounds[j]._ended&&(P++,W=F._sounds[j]._id);P===1?L=null:W=null}}var Q=W?F._soundById(W):F._inactiveSound();if(!Q)return null;if(W&&!L&&(L=Q._sprite||"__default"),F._state!=="loaded"){Q._sprite=L,Q._ended=!1;var H=Q._id;return F._queue.push({event:"play",action:function(){F.play(H)}}),H}if(W&&!Q._paused)return I||F._loadQueue("play"),Q._id;F._webAudio&&D._autoResume();var Ot=Math.max(0,Q._seek>0?Q._seek:F._sprite[L][0]/1e3),Vt=Math.max(0,(F._sprite[L][0]+F._sprite[L][1])/1e3-Ot),st=1e3*Vt/Math.abs(Q._rate),V=F._sprite[L][0]/1e3,k=(F._sprite[L][0]+F._sprite[L][1])/1e3;Q._sprite=L,Q._ended=!1;var mt=function(){Q._paused=!1,Q._seek=Ot,Q._start=V,Q._stop=k,Q._loop=!(!Q._loop&&!F._sprite[L][2])};if(!(Ot>=k)){var tt=Q._node;if(F._webAudio){var _t=function(){F._playLock=!1,mt(),F._refreshBuffer(Q);var rt=Q._muted||F._muted?0:Q._volume;tt.gain.setValueAtTime(rt,D.ctx.currentTime),Q._playStart=D.ctx.currentTime,tt.bufferSource.start===void 0?Q._loop?tt.bufferSource.noteGrainOn(0,Ot,86400):tt.bufferSource.noteGrainOn(0,Ot,Vt):Q._loop?tt.bufferSource.start(0,Ot,86400):tt.bufferSource.start(0,Ot,Vt),st!==1/0&&(F._endTimers[Q._id]=setTimeout(F._ended.bind(F,Q),st)),I||setTimeout(function(){F._emit("play",Q._id),F._loadQueue()},0)};D.state==="running"&&D.ctx.state!=="interrupted"?_t():(F._playLock=!0,F.once("resume",_t),F._clearTimer(Q._id))}else{var Dt=function(){tt.currentTime=Ot,tt.muted=Q._muted||F._muted||D._muted||tt.muted,tt.volume=Q._volume*D.volume(),tt.playbackRate=Q._rate;try{var rt=tt.play();if(rt&&typeof Promise!="undefined"&&(rt instanceof Promise||typeof rt.then=="function")?(F._playLock=!0,mt(),rt.then(function(){F._playLock=!1,tt._unlocked=!0,I?F._loadQueue():F._emit("play",Q._id)}).catch(function(){F._playLock=!1,F._emit("playerror",Q._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),Q._ended=!0,Q._paused=!0})):I||(F._playLock=!1,mt(),F._emit("play",Q._id)),tt.playbackRate=Q._rate,tt.paused)return void F._emit("playerror",Q._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");L!=="__default"||Q._loop?F._endTimers[Q._id]=setTimeout(F._ended.bind(F,Q),st):(F._endTimers[Q._id]=function(){F._ended(Q),tt.removeEventListener("ended",F._endTimers[Q._id],!1)},tt.addEventListener("ended",F._endTimers[Q._id],!1))}catch(yt){F._emit("playerror",Q._id,yt)}};tt.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(tt.src=F._src,tt.load());var Z=window&&window.ejecta||!tt.readyState&&D._navigator.isCocoonJS;if(tt.readyState>=3||Z)Dt();else{F._playLock=!0,F._state="loading";var ct=function(){F._state="loaded",Dt(),tt.removeEventListener(D._canPlayEvent,ct,!1)};tt.addEventListener(D._canPlayEvent,ct,!1),F._clearTimer(Q._id)}}return Q._id}F._ended(Q)},pause:function(L){var I=this;if(I._state!=="loaded"||I._playLock)return I._queue.push({event:"pause",action:function(){I.pause(L)}}),I;for(var F=I._getSoundIds(L),W=0;W<F.length;W++){I._clearTimer(F[W]);var P=I._soundById(F[W]);if(P&&!P._paused&&(P._seek=I.seek(F[W]),P._rateSeek=0,P._paused=!0,I._stopFade(F[W]),P._node))if(I._webAudio){if(!P._node.bufferSource)continue;P._node.bufferSource.stop===void 0?P._node.bufferSource.noteOff(0):P._node.bufferSource.stop(0),I._cleanBuffer(P._node)}else isNaN(P._node.duration)&&P._node.duration!==1/0||P._node.pause();arguments[1]||I._emit("pause",P?P._id:null)}return I},stop:function(L,I){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"stop",action:function(){F.stop(L)}}),F;for(var W=F._getSoundIds(L),P=0;P<W.length;P++){F._clearTimer(W[P]);var j=F._soundById(W[P]);j&&(j._seek=j._start||0,j._rateSeek=0,j._paused=!0,j._ended=!0,F._stopFade(W[P]),j._node&&(F._webAudio?j._node.bufferSource&&(j._node.bufferSource.stop===void 0?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),F._cleanBuffer(j._node)):isNaN(j._node.duration)&&j._node.duration!==1/0||(j._node.currentTime=j._start||0,j._node.pause(),j._node.duration===1/0&&F._clearSound(j._node))),I||F._emit("stop",j._id))}return F},mute:function(L,I){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"mute",action:function(){F.mute(L,I)}}),F;if(I===void 0){if(typeof L!="boolean")return F._muted;F._muted=L}for(var W=F._getSoundIds(I),P=0;P<W.length;P++){var j=F._soundById(W[P]);j&&(j._muted=L,j._interval&&F._stopFade(j._id),F._webAudio&&j._node?j._node.gain.setValueAtTime(L?0:j._volume,D.ctx.currentTime):j._node&&(j._node.muted=!!D._muted||L),F._emit("mute",j._id))}return F},volume:function(){var L,I,F,W=this,P=arguments;if(P.length===0)return W._volume;if(P.length===1||P.length===2&&P[1]===void 0){var j=W._getSoundIds(),Q=j.indexOf(P[0]);Q>=0?I=parseInt(P[0],10):L=parseFloat(P[0])}else P.length>=2&&(L=parseFloat(P[0]),I=parseInt(P[1],10));if(!(L!==void 0&&L>=0&&L<=1))return(F=I?W._soundById(I):W._sounds[0])?F._volume:0;if(W._state!=="loaded"||W._playLock)return W._queue.push({event:"volume",action:function(){W.volume.apply(W,P)}}),W;I===void 0&&(W._volume=L),I=W._getSoundIds(I);for(var H=0;H<I.length;H++)(F=W._soundById(I[H]))&&(F._volume=L,P[2]||W._stopFade(I[H]),W._webAudio&&F._node&&!F._muted?F._node.gain.setValueAtTime(L,D.ctx.currentTime):F._node&&!F._muted&&(F._node.volume=L*D.volume()),W._emit("volume",F._id));return W},fade:function(L,I,F,W){var P=this;if(P._state!=="loaded"||P._playLock)return P._queue.push({event:"fade",action:function(){P.fade(L,I,F,W)}}),P;L=Math.min(Math.max(0,parseFloat(L)),1),I=Math.min(Math.max(0,parseFloat(I)),1),F=parseFloat(F),P.volume(L,W);for(var j=P._getSoundIds(W),Q=0;Q<j.length;Q++){var H=P._soundById(j[Q]);if(H){if(W||P._stopFade(j[Q]),P._webAudio&&!H._muted){var Ot=D.ctx.currentTime,Vt=Ot+F/1e3;H._volume=L,H._node.gain.setValueAtTime(L,Ot),H._node.gain.linearRampToValueAtTime(I,Vt)}P._startFadeInterval(H,L,I,F,j[Q],W===void 0)}}return P},_startFadeInterval:function(L,I,F,W,P,j){var Q=this,H=I,Ot=F-I,Vt=Math.abs(Ot/.01),st=Math.max(4,Vt>0?W/Vt:W),V=Date.now();L._fadeTo=F,L._interval=setInterval(function(){var k=(Date.now()-V)/W;V=Date.now(),H+=Ot*k,H=Math.round(100*H)/100,H=Ot<0?Math.max(F,H):Math.min(F,H),Q._webAudio?L._volume=H:Q.volume(H,L._id,!0),j&&(Q._volume=H),(F<I&&H<=F||F>I&&H>=F)&&(clearInterval(L._interval),L._interval=null,L._fadeTo=null,Q.volume(F,L._id),Q._emit("fade",L._id))},st)},_stopFade:function(L){var I=this._soundById(L);return I&&I._interval&&(this._webAudio&&I._node.gain.cancelScheduledValues(D.ctx.currentTime),clearInterval(I._interval),I._interval=null,this.volume(I._fadeTo,L),I._fadeTo=null,this._emit("fade",L)),this},loop:function(){var L,I,F,W=this,P=arguments;if(P.length===0)return W._loop;if(P.length===1){if(typeof P[0]!="boolean")return!!(F=W._soundById(parseInt(P[0],10)))&&F._loop;L=P[0],W._loop=L}else P.length===2&&(L=P[0],I=parseInt(P[1],10));for(var j=W._getSoundIds(I),Q=0;Q<j.length;Q++)(F=W._soundById(j[Q]))&&(F._loop=L,W._webAudio&&F._node&&F._node.bufferSource&&(F._node.bufferSource.loop=L,L&&(F._node.bufferSource.loopStart=F._start||0,F._node.bufferSource.loopEnd=F._stop,W.playing(j[Q])&&(W.pause(j[Q],!0),W.play(j[Q],!0)))));return W},rate:function(){var L,I,F,W=this,P=arguments;if(P.length===0)I=W._sounds[0]._id;else if(P.length===1){var j=W._getSoundIds(),Q=j.indexOf(P[0]);Q>=0?I=parseInt(P[0],10):L=parseFloat(P[0])}else P.length===2&&(L=parseFloat(P[0]),I=parseInt(P[1],10));if(typeof L!="number")return(F=W._soundById(I))?F._rate:W._rate;if(W._state!=="loaded"||W._playLock)return W._queue.push({event:"rate",action:function(){W.rate.apply(W,P)}}),W;I===void 0&&(W._rate=L),I=W._getSoundIds(I);for(var H=0;H<I.length;H++)if(F=W._soundById(I[H])){W.playing(I[H])&&(F._rateSeek=W.seek(I[H]),F._playStart=W._webAudio?D.ctx.currentTime:F._playStart),F._rate=L,W._webAudio&&F._node&&F._node.bufferSource?F._node.bufferSource.playbackRate.setValueAtTime(L,D.ctx.currentTime):F._node&&(F._node.playbackRate=L);var Ot=W.seek(I[H]),Vt=(W._sprite[F._sprite][0]+W._sprite[F._sprite][1])/1e3-Ot,st=1e3*Vt/Math.abs(F._rate);!W._endTimers[I[H]]&&F._paused||(W._clearTimer(I[H]),W._endTimers[I[H]]=setTimeout(W._ended.bind(W,F),st)),W._emit("rate",F._id)}return W},seek:function(){var L,I,F=this,W=arguments;if(W.length===0)F._sounds.length&&(I=F._sounds[0]._id);else if(W.length===1){var P=F._getSoundIds(),j=P.indexOf(W[0]);j>=0?I=parseInt(W[0],10):F._sounds.length&&(I=F._sounds[0]._id,L=parseFloat(W[0]))}else W.length===2&&(L=parseFloat(W[0]),I=parseInt(W[1],10));if(I===void 0)return 0;if(typeof L=="number"&&(F._state!=="loaded"||F._playLock))return F._queue.push({event:"seek",action:function(){F.seek.apply(F,W)}}),F;var Q=F._soundById(I);if(Q){if(!(typeof L=="number"&&L>=0)){if(F._webAudio){var H=F.playing(I)?D.ctx.currentTime-Q._playStart:0,Ot=Q._rateSeek?Q._rateSeek-Q._seek:0;return Q._seek+(Ot+H*Math.abs(Q._rate))}return Q._node.currentTime}var Vt=F.playing(I);Vt&&F.pause(I,!0),Q._seek=L,Q._ended=!1,F._clearTimer(I),F._webAudio||!Q._node||isNaN(Q._node.duration)||(Q._node.currentTime=L);var st=function(){Vt&&F.play(I,!0),F._emit("seek",I)};if(Vt&&!F._webAudio){var V=function(){F._playLock?setTimeout(V,0):st()};setTimeout(V,0)}else st()}return F},playing:function(L){if(typeof L=="number"){var I=this._soundById(L);return!!I&&!I._paused}for(var F=0;F<this._sounds.length;F++)if(!this._sounds[F]._paused)return!0;return!1},duration:function(L){var I=this._duration,F=this._soundById(L);return F&&(I=this._sprite[F._sprite][1]/1e3),I},state:function(){return this._state},unload:function(){for(var L=this,I=L._sounds,F=0;F<I.length;F++)I[F]._paused||L.stop(I[F]._id),L._webAudio||(L._clearSound(I[F]._node),I[F]._node.removeEventListener("error",I[F]._errorFn,!1),I[F]._node.removeEventListener(D._canPlayEvent,I[F]._loadFn,!1),I[F]._node.removeEventListener("ended",I[F]._endFn,!1),D._releaseHtml5Audio(I[F]._node)),delete I[F]._node,L._clearTimer(I[F]._id);var W=D._howls.indexOf(L);W>=0&&D._howls.splice(W,1);var P=!0;for(F=0;F<D._howls.length;F++)if(D._howls[F]._src===L._src||L._src.indexOf(D._howls[F]._src)>=0){P=!1;break}return X&&P&&delete X[L._src],D.noAudio=!1,L._state="unloaded",L._sounds=[],L=null,null},on:function(L,I,F,W){var P=this["_on"+L];return typeof I=="function"&&P.push(W?{id:F,fn:I,once:W}:{id:F,fn:I}),this},off:function(L,I,F){var W=this["_on"+L],P=0;if(typeof I=="number"&&(F=I,I=null),I||F)for(P=0;P<W.length;P++){var j=F===W[P].id;if(I===W[P].fn&&j||!I&&j){W.splice(P,1);break}}else if(L)this["_on"+L]=[];else{var Q=Object.keys(this);for(P=0;P<Q.length;P++)Q[P].indexOf("_on")===0&&Array.isArray(this[Q[P]])&&(this[Q[P]]=[])}return this},once:function(L,I,F){return this.on(L,I,F,1),this},_emit:function(L,I,F){for(var W=this["_on"+L],P=W.length-1;P>=0;P--)W[P].id&&W[P].id!==I&&L!=="load"||(setTimeout(function(j){j.call(this,I,F)}.bind(this,W[P].fn),0),W[P].once&&this.off(L,W[P].fn,W[P].id));return this._loadQueue(L),this},_loadQueue:function(L){if(this._queue.length>0){var I=this._queue[0];I.event===L&&(this._queue.shift(),this._loadQueue()),L||I.action()}return this},_ended:function(L){var I=L._sprite;if(!this._webAudio&&L._node&&!L._node.paused&&!L._node.ended&&L._node.currentTime<L._stop)return setTimeout(this._ended.bind(this,L),100),this;var F=!(!L._loop&&!this._sprite[I][2]);if(this._emit("end",L._id),!this._webAudio&&F&&this.stop(L._id,!0).play(L._id),this._webAudio&&F){this._emit("play",L._id),L._seek=L._start||0,L._rateSeek=0,L._playStart=D.ctx.currentTime;var W=1e3*(L._stop-L._start)/Math.abs(L._rate);this._endTimers[L._id]=setTimeout(this._ended.bind(this,L),W)}return this._webAudio&&!F&&(L._paused=!0,L._ended=!0,L._seek=L._start||0,L._rateSeek=0,this._clearTimer(L._id),this._cleanBuffer(L._node),D._autoSuspend()),this._webAudio||F||this.stop(L._id,!0),this},_clearTimer:function(L){if(this._endTimers[L]){if(typeof this._endTimers[L]!="function")clearTimeout(this._endTimers[L]);else{var I=this._soundById(L);I&&I._node&&I._node.removeEventListener("ended",this._endTimers[L],!1)}delete this._endTimers[L]}return this},_soundById:function(L){for(var I=0;I<this._sounds.length;I++)if(L===this._sounds[I]._id)return this._sounds[I];return null},_inactiveSound:function(){this._drain();for(var L=0;L<this._sounds.length;L++)if(this._sounds[L]._ended)return this._sounds[L].reset();return new z(this)},_drain:function(){var L=this._pool,I=0,F=0;if(!(this._sounds.length<L)){for(F=0;F<this._sounds.length;F++)this._sounds[F]._ended&&I++;for(F=this._sounds.length-1;F>=0;F--){if(I<=L)return;this._sounds[F]._ended&&(this._webAudio&&this._sounds[F]._node&&this._sounds[F]._node.disconnect(0),this._sounds.splice(F,1),I--)}}},_getSoundIds:function(L){if(L===void 0){for(var I=[],F=0;F<this._sounds.length;F++)I.push(this._sounds[F]._id);return I}return[L]},_refreshBuffer:function(L){return L._node.bufferSource=D.ctx.createBufferSource(),L._node.bufferSource.buffer=X[this._src],L._panner?L._node.bufferSource.connect(L._panner):L._node.bufferSource.connect(L._node),L._node.bufferSource.loop=L._loop,L._loop&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop||0),L._node.bufferSource.playbackRate.setValueAtTime(L._rate,D.ctx.currentTime),this},_cleanBuffer:function(L){var I=D._navigator&&D._navigator.vendor.indexOf("Apple")>=0;if(D._scratchBuffer&&L.bufferSource&&(L.bufferSource.onended=null,L.bufferSource.disconnect(0),I))try{L.bufferSource.buffer=D._scratchBuffer}catch{}return L.bufferSource=null,this},_clearSound:function(L){/MSIE |Trident\//.test(D._navigator&&D._navigator.userAgent)||(L.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var z=function(L){this._parent=L,this.init()};z.prototype={init:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,L._sounds.push(this),this.create(),this},create:function(){var L=this._parent,I=D._muted||this._muted||this._parent._muted?0:this._volume;return L._webAudio?(this._node=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),this._node.gain.setValueAtTime(I,D.ctx.currentTime),this._node.paused=!0,this._node.connect(D.masterGain)):D.noAudio||(this._node=D._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(D._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=L._src,this._node.preload=L._preload===!0?"auto":L._preload,this._node.volume=I*D.volume(),this._node.load()),this},reset:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var L=this._parent;L._duration=Math.ceil(10*this._node.duration)/10,Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue()),this._node.removeEventListener(D._canPlayEvent,this._loadFn,!1)},_endListener:function(){var L=this._parent;L._duration===1/0&&(L._duration=Math.ceil(10*this._node.duration)/10,L._sprite.__default[1]===1/0&&(L._sprite.__default[1]=1e3*L._duration),L._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var X={},J=function(L){var I=L._src;if(X[I])return L._duration=X[I].duration,void Nt(L);if(/^data:[^;]+;base64,/.test(I)){for(var F=atob(I.split(",")[1]),W=new Uint8Array(F.length),P=0;P<F.length;++P)W[P]=F.charCodeAt(P);pt(W.buffer,L)}else{var j=new XMLHttpRequest;j.open(L._xhr.method,I,!0),j.withCredentials=L._xhr.withCredentials,j.responseType="arraybuffer",L._xhr.headers&&Object.keys(L._xhr.headers).forEach(function(Q){j.setRequestHeader(Q,L._xhr.headers[Q])}),j.onload=function(){var Q=(j.status+"")[0];Q==="0"||Q==="2"||Q==="3"?pt(j.response,L):L._emit("loaderror",null,"Failed loading audio file with status: "+j.status+".")},j.onerror=function(){L._webAudio&&(L._html5=!0,L._webAudio=!1,L._sounds=[],delete X[I],L.load())},et(j)}},et=function(L){try{L.send()}catch{L.onerror()}},pt=function(L,I){var F=function(){I._emit("loaderror",null,"Decoding audio data failed.")},W=function(P){P&&I._sounds.length>0?(X[I._src]=P,Nt(I,P)):F()};typeof Promise!="undefined"&&D.ctx.decodeAudioData.length===1?D.ctx.decodeAudioData(L).then(W).catch(F):D.ctx.decodeAudioData(L,W,F)},Nt=function(L,I){I&&!L._duration&&(L._duration=I.duration),Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue())},vt=function(){if(D.usingWebAudio){try{typeof AudioContext!="undefined"?D.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?D.ctx=new webkitAudioContext:D.usingWebAudio=!1}catch{D.usingWebAudio=!1}D.ctx||(D.usingWebAudio=!1);var L=/iP(hone|od|ad)/.test(D._navigator&&D._navigator.platform),I=D._navigator&&D._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),F=I?parseInt(I[1],10):null;if(L&&F&&F<9){var W=/safari/.test(D._navigator&&D._navigator.userAgent.toLowerCase());D._navigator&&!W&&(D.usingWebAudio=!1)}D.usingWebAudio&&(D.masterGain=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),D.masterGain.gain.setValueAtTime(D._muted?0:D._volume,D.ctx.currentTime),D.masterGain.connect(D.ctx.destination)),D._setup()}};(R=function(){return{Howler:D,Howl:B}}.apply(S,[]))===void 0||(b.exports=R),S.Howler=D,S.Howl=B,O!==void 0?(O.HowlerGlobal=M,O.Howler=D,O.Howl=B,O.Sound=z):typeof window!="undefined"&&(window.HowlerGlobal=M,window.Howler=D,window.Howl=B,window.Sound=z)})(),function(){var M;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(B){if(!this.ctx||!this.ctx.listener)return this;for(var z=this._howls.length-1;z>=0;z--)this._howls[z].stereo(B);return this},HowlerGlobal.prototype.pos=function(B,z,X){return this.ctx&&this.ctx.listener?(z=typeof z!="number"?this._pos[1]:z,X=typeof X!="number"?this._pos[2]:X,typeof B!="number"?this._pos:(this._pos=[B,z,X],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(B,z,X,J,et,pt){if(!this.ctx||!this.ctx.listener)return this;var Nt=this._orientation;return z=typeof z!="number"?Nt[1]:z,X=typeof X!="number"?Nt[2]:X,J=typeof J!="number"?Nt[3]:J,et=typeof et!="number"?Nt[4]:et,pt=typeof pt!="number"?Nt[5]:pt,typeof B!="number"?Nt:(this._orientation=[B,z,X,J,et,pt],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(B,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(z,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(X,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(J,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(et,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(pt,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(B,z,X,J,et,pt),this)},Howl.prototype.init=(M=Howl.prototype.init,function(B){return this._orientation=B.orientation||[1,0,0],this._stereo=B.stereo||null,this._pos=B.pos||null,this._pannerAttr={coneInnerAngle:B.coneInnerAngle!==void 0?B.coneInnerAngle:360,coneOuterAngle:B.coneOuterAngle!==void 0?B.coneOuterAngle:360,coneOuterGain:B.coneOuterGain!==void 0?B.coneOuterGain:0,distanceModel:B.distanceModel!==void 0?B.distanceModel:"inverse",maxDistance:B.maxDistance!==void 0?B.maxDistance:1e4,panningModel:B.panningModel!==void 0?B.panningModel:"HRTF",refDistance:B.refDistance!==void 0?B.refDistance:1,rolloffFactor:B.rolloffFactor!==void 0?B.rolloffFactor:1},this._onstereo=B.onstereo?[{fn:B.onstereo}]:[],this._onpos=B.onpos?[{fn:B.onpos}]:[],this._onorientation=B.onorientation?[{fn:B.onorientation}]:[],M.call(this,B)}),Howl.prototype.stereo=function(B,z){var X=this;if(!X._webAudio)return X;if(X._state!=="loaded")return X._queue.push({event:"stereo",action:function(){X.stereo(B,z)}}),X;var J=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(z===void 0){if(typeof B!="number")return X._stereo;X._stereo=B,X._pos=[B,0,0]}for(var et=X._getSoundIds(z),pt=0;pt<et.length;pt++){var Nt=X._soundById(et[pt]);if(Nt){if(typeof B!="number")return Nt._stereo;Nt._stereo=B,Nt._pos=[B,0,0],Nt._node&&(Nt._pannerAttr.panningModel="equalpower",Nt._panner&&Nt._panner.pan||D(Nt,J),J==="spatial"?Nt._panner.positionX!==void 0?(Nt._panner.positionX.setValueAtTime(B,Howler.ctx.currentTime),Nt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Nt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Nt._panner.setPosition(B,0,0):Nt._panner.pan.setValueAtTime(B,Howler.ctx.currentTime)),X._emit("stereo",Nt._id)}}return X},Howl.prototype.pos=function(B,z,X,J){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"pos",action:function(){et.pos(B,z,X,J)}}),et;if(z=typeof z!="number"?0:z,X=typeof X!="number"?-.5:X,J===void 0){if(typeof B!="number")return et._pos;et._pos=[B,z,X]}for(var pt=et._getSoundIds(J),Nt=0;Nt<pt.length;Nt++){var vt=et._soundById(pt[Nt]);if(vt){if(typeof B!="number")return vt._pos;vt._pos=[B,z,X],vt._node&&(vt._panner&&!vt._panner.pan||D(vt,"spatial"),vt._panner.positionX!==void 0?(vt._panner.positionX.setValueAtTime(B,Howler.ctx.currentTime),vt._panner.positionY.setValueAtTime(z,Howler.ctx.currentTime),vt._panner.positionZ.setValueAtTime(X,Howler.ctx.currentTime)):vt._panner.setPosition(B,z,X)),et._emit("pos",vt._id)}}return et},Howl.prototype.orientation=function(B,z,X,J){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"orientation",action:function(){et.orientation(B,z,X,J)}}),et;if(z=typeof z!="number"?et._orientation[1]:z,X=typeof X!="number"?et._orientation[2]:X,J===void 0){if(typeof B!="number")return et._orientation;et._orientation=[B,z,X]}for(var pt=et._getSoundIds(J),Nt=0;Nt<pt.length;Nt++){var vt=et._soundById(pt[Nt]);if(vt){if(typeof B!="number")return vt._orientation;vt._orientation=[B,z,X],vt._node&&(vt._panner||(vt._pos||(vt._pos=et._pos||[0,0,-.5]),D(vt,"spatial")),vt._panner.orientationX!==void 0?(vt._panner.orientationX.setValueAtTime(B,Howler.ctx.currentTime),vt._panner.orientationY.setValueAtTime(z,Howler.ctx.currentTime),vt._panner.orientationZ.setValueAtTime(X,Howler.ctx.currentTime)):vt._panner.setOrientation(B,z,X)),et._emit("orientation",vt._id)}}return et},Howl.prototype.pannerAttr=function(){var B,z,X,J=this,et=arguments;if(!J._webAudio)return J;if(et.length===0)return J._pannerAttr;if(et.length===1){if(typeof et[0]!="object")return(X=J._soundById(parseInt(et[0],10)))?X._pannerAttr:J._pannerAttr;B=et[0],z===void 0&&(B.pannerAttr||(B.pannerAttr={coneInnerAngle:B.coneInnerAngle,coneOuterAngle:B.coneOuterAngle,coneOuterGain:B.coneOuterGain,distanceModel:B.distanceModel,maxDistance:B.maxDistance,refDistance:B.refDistance,rolloffFactor:B.rolloffFactor,panningModel:B.panningModel}),J._pannerAttr={coneInnerAngle:B.pannerAttr.coneInnerAngle!==void 0?B.pannerAttr.coneInnerAngle:J._coneInnerAngle,coneOuterAngle:B.pannerAttr.coneOuterAngle!==void 0?B.pannerAttr.coneOuterAngle:J._coneOuterAngle,coneOuterGain:B.pannerAttr.coneOuterGain!==void 0?B.pannerAttr.coneOuterGain:J._coneOuterGain,distanceModel:B.pannerAttr.distanceModel!==void 0?B.pannerAttr.distanceModel:J._distanceModel,maxDistance:B.pannerAttr.maxDistance!==void 0?B.pannerAttr.maxDistance:J._maxDistance,refDistance:B.pannerAttr.refDistance!==void 0?B.pannerAttr.refDistance:J._refDistance,rolloffFactor:B.pannerAttr.rolloffFactor!==void 0?B.pannerAttr.rolloffFactor:J._rolloffFactor,panningModel:B.pannerAttr.panningModel!==void 0?B.pannerAttr.panningModel:J._panningModel})}else et.length===2&&(B=et[0],z=parseInt(et[1],10));for(var pt=J._getSoundIds(z),Nt=0;Nt<pt.length;Nt++)if(X=J._soundById(pt[Nt])){var vt=X._pannerAttr;vt={coneInnerAngle:B.coneInnerAngle!==void 0?B.coneInnerAngle:vt.coneInnerAngle,coneOuterAngle:B.coneOuterAngle!==void 0?B.coneOuterAngle:vt.coneOuterAngle,coneOuterGain:B.coneOuterGain!==void 0?B.coneOuterGain:vt.coneOuterGain,distanceModel:B.distanceModel!==void 0?B.distanceModel:vt.distanceModel,maxDistance:B.maxDistance!==void 0?B.maxDistance:vt.maxDistance,refDistance:B.refDistance!==void 0?B.refDistance:vt.refDistance,rolloffFactor:B.rolloffFactor!==void 0?B.rolloffFactor:vt.rolloffFactor,panningModel:B.panningModel!==void 0?B.panningModel:vt.panningModel};var L=X._panner;L?(L.coneInnerAngle=vt.coneInnerAngle,L.coneOuterAngle=vt.coneOuterAngle,L.coneOuterGain=vt.coneOuterGain,L.distanceModel=vt.distanceModel,L.maxDistance=vt.maxDistance,L.refDistance=vt.refDistance,L.rolloffFactor=vt.rolloffFactor,L.panningModel=vt.panningModel):(X._pos||(X._pos=J._pos||[0,0,-.5]),D(X,"spatial"))}return J},Sound.prototype.init=function(B){return function(){var z=this._parent;this._orientation=z._orientation,this._stereo=z._stereo,this._pos=z._pos,this._pannerAttr=z._pannerAttr,B.call(this),this._stereo?z.stereo(this._stereo):this._pos&&z.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(B){return function(){var z=this._parent;return this._orientation=z._orientation,this._stereo=z._stereo,this._pos=z._pos,this._pannerAttr=z._pannerAttr,this._stereo?z.stereo(this._stereo):this._pos?z.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,z._refreshBuffer(this)),B.call(this)}}(Sound.prototype.reset);var D=function(B,z){(z=z||"spatial")==="spatial"?(B._panner=Howler.ctx.createPanner(),B._panner.coneInnerAngle=B._pannerAttr.coneInnerAngle,B._panner.coneOuterAngle=B._pannerAttr.coneOuterAngle,B._panner.coneOuterGain=B._pannerAttr.coneOuterGain,B._panner.distanceModel=B._pannerAttr.distanceModel,B._panner.maxDistance=B._pannerAttr.maxDistance,B._panner.refDistance=B._pannerAttr.refDistance,B._panner.rolloffFactor=B._pannerAttr.rolloffFactor,B._panner.panningModel=B._pannerAttr.panningModel,B._panner.positionX!==void 0?(B._panner.positionX.setValueAtTime(B._pos[0],Howler.ctx.currentTime),B._panner.positionY.setValueAtTime(B._pos[1],Howler.ctx.currentTime),B._panner.positionZ.setValueAtTime(B._pos[2],Howler.ctx.currentTime)):B._panner.setPosition(B._pos[0],B._pos[1],B._pos[2]),B._panner.orientationX!==void 0?(B._panner.orientationX.setValueAtTime(B._orientation[0],Howler.ctx.currentTime),B._panner.orientationY.setValueAtTime(B._orientation[1],Howler.ctx.currentTime),B._panner.orientationZ.setValueAtTime(B._orientation[2],Howler.ctx.currentTime)):B._panner.setOrientation(B._orientation[0],B._orientation[1],B._orientation[2])):(B._panner=Howler.ctx.createStereoPanner(),B._panner.pan.setValueAtTime(B._stereo,Howler.ctx.currentTime)),B._panner.connect(B._node),B._paused||B._parent.pause(B._id,!0).play(B._id,!0)}}()}).call(this,v(17))},function(b,S){b.exports=`varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform sampler2D uSampler;
void main() {
	vec4 outputColor;
	float percent = vPercent;
	float direction = vDirection;
	if (vTransition < 0.0) {
		percent = 1.0 - percent;
		if ((vDirection > 1.5) && (vDirection < 2.5)) {
			direction = 1.0;
		}
		else if ((vDirection > 0.5) && (vDirection < 1.5)) {
			direction = 2.0;
		}
		else if ((vDirection > 2.5) && (vDirection < 3.5)) {
			direction = 4.0;
		}
		else {
			direction = 3.0;
		}
	}
	if ((direction > 1.5) && (direction < 2.5)) {
		if (vVertexPosition.y >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y >= (1.0 - percent)) && (vVertexPosition.y <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
		}
	}
	else if ((direction > 0.5) && (direction < 1.5)) {
		if (vVertexPosition.y <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y <= percent) && (vVertexPosition.y >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.y - (percent - 0.2)) / 0.2));
		}
	}
	else if ((direction > 2.5) && (direction < 3.5)) {
		if (vVertexPosition.x <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x <= percent) && (vVertexPosition.x >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.x - (percent - 0.2)) / 0.2));
		}
	}
	else {
		if (vVertexPosition.x >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x >= (1.0 - percent)) && (vVertexPosition.x <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
		}
	}
	gl_FragColor = outputColor;
}
`},function(b,S){b.exports=`attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord(vec2 aVertexPosition) {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	vTransition = transition;
	vDirection = direction;
	vPercent = percent;
	vVertexPosition = aVertexPosition;
	vec2 localVertexPosition = aVertexPosition;
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord(localVertexPosition);
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
uniform float transition;
void main() {
	float alpha = (transition * (percent - 0.5)) + 0.5;
	vec4 color1 = texture2D(uSampler, vTextureCoord);
	gl_FragColor = color1 * alpha;
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float barWidth = (option < 0.5 ? uBoundRect.w : uBoundRect.z) / barCount;
	float alphaWidthPercent = 0.03;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.w : uBoundRect.z);
	float selectAxis = option < 0.5 ? -position.y : -position.x;
	float countAxis = floor(selectAxis / barWidth);
	float modAxis = mod(selectAxis, barWidth);
	float timePosition = barWidth * timePercent;
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float horizontalBarWidth = uBoundRect.z / barCount;
	float verticalBarWidth = uBoundRect.w / barCount;
	float alphaWidthPercent = 0.01;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.z : uBoundRect.w);
	float timePosition = horizontalBarWidth * timePercent;
	float countAxisY = floor(-position.y / verticalBarWidth);
	float modAxisY = mod(-position.y, verticalBarWidth);
	float countAxisX = floor(-position.x / horizontalBarWidth);
	float modAxisX = mod(-position.x, horizontalBarWidth);
	float modAxis = modAxisX;
	if (option < 0.5) {
		if (mod(countAxisY, 2.0) > 0.5) {
			countAxisX = floor(((horizontalBarWidth * 0.5) - position.x) / horizontalBarWidth);
			modAxisX = mod((horizontalBarWidth * 0.5) - position.x, horizontalBarWidth);
		}
		modAxis = modAxisX;
	}
	else {
		if (mod(countAxisX, 2.0) > 0.5) {
			countAxisY = floor(((verticalBarWidth * 0.5) - position.y) / verticalBarWidth);
			modAxisY = mod((verticalBarWidth * 0.5) - position.y, verticalBarWidth);
		}
		modAxis = modAxisY;
	}
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	float splitWidth = max(uBoundRect.z, uBoundRect.w) / 3.0;
	vec2 position = mod(filterCoord.xy, splitWidth);
	vec2 loopTime = floor(filterCoord.xy / splitWidth);
	if (loopTime.x > 0.5) {
		position.x = splitWidth - position.x;
	}
	if (loopTime.y > 0.5) {
		position.y = splitWidth - position.y;
	}
	vec4 dissolveColor = texture2D(dissolveSampler, position.xy / splitWidth);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	if (dissolveColor.r < percent) {
		gl_FragColor = outputColor;
	}
	else {
		gl_FragColor = vec4(0, 0, 0, 0);
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	vec4 dissolveColor;
	if (option > 0.5) {
		dissolveColor = texture2D(dissolveSampler, vec2(vTextureCoord.x, 0.0));
	}
	else {
		dissolveColor = texture2D(dissolveSampler, vec2(0.0, vTextureCoord.y));
	}
	if (transition > .0) {
		if (dissolveColor.r < percent) {
			gl_FragColor = outputColor;
		}
		else {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
	}
	else {
		if (dissolveColor.r < percent) {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		else {
			gl_FragColor = outputColor;
		}
	}
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	float radius = sqrt(pow(uBoundRect.z, 2.0) + pow(uBoundRect.w, 2.0)) / 2.0;
	float alphaWidth = 0.1;
	float pointDistance = sqrt(pow(point.x, 2.0) + pow(point.y, 2.0));
	float alphaRadiusFormula;
	if (option > 0.5) {
		if (transition > 0.0) {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * timePercent)) / (alphaWidth * radius));
		}
		else {
			alphaRadiusFormula = (pointDistance - (radius * timePercent)) / (alphaWidth * radius);
		}
	}
	else {
		if (transition > 0.0) {
			alphaRadiusFormula = (pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius);
		}
		else {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius));
		}
	}
	if (option > 0.5) {
		if (pointDistance < (radius * timePercent)) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if (pointDistance < (radius * (timePercent + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
	else {
		if (pointDistance < (radius * (1.0 - timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if (pointDistance < (radius * ((1.0 - timePercent) + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.2;
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 absPoint = abs(point.xy);
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (option < 0.5) {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.x : alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.y : alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
	else {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.x : 1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.y : 1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), (uBoundRect.w / 2.0) - filterCoord.y);
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	float rightTop = (((2.0 * uBoundRect.w) * timePercent) - ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float rightBottom = (((uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	float leftTop = (((2.0 * uBoundRect.w) * timePercent) + ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float leftBottom = (((-uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (-rightTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * rightBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (-leftTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * leftBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
	}
	else {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (rightTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (rightBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (leftTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (leftBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
	}
}
`},function(b,S){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = (outputColor * (1.0 - alphaFormula.x)) * (1.0 - alphaFormula.y);
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * (1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = outputColor;
		}
	}
	else {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = outputColor;
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = outputColor * (1.0 - ((1.0 - alphaFormula.x) * (1.0 - alphaFormula.y)));
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * alphaFormula.x;
			}
			else {
				gl_FragColor = outputColor * alphaFormula.y;
			}
		}
		else {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	float alphaWidth = 0.1;
	float timePercent = percent;
	if (option < 1.5) {
		timePercent = 1.0 - timePercent;
	}
	float axis = (option > 0.5) && (option < 2.5) ? absPoint.y : absPoint.x;
	float compareAxis = (option > 0.5) && (option < 2.5) ? halfRect.y : halfRect.x;
	float alphaColor = abs(((timePercent * compareAxis) - axis) / (alphaWidth * compareAxis));
	vec4 beginColor;
	vec4 endColor;
	if ((option > 1.5) && (option < 3.5)) {
		if (transition < 0.0) {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
		else {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
	}
	else {
		if (transition < 0.0) {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
		else {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
	}
	if (axis < (timePercent * compareAxis)) {
		gl_FragColor = beginColor;
	}
	else if (axis < ((timePercent + alphaWidth) * compareAxis)) {
		gl_FragColor = outputColor * alphaColor;
	}
	else {
		gl_FragColor = endColor;
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x, filterCoord.y);
	if ((option > 0.5) && (option < 1.5)) {
		point = filterCoord.xy;
	}
	else if ((option > 1.5) && (option < 2.5)) {
		point = uBoundRect.zw - point.xy;
	}
	else if ((option > 2.5) && (option < 3.5)) {
		point = vec2(uBoundRect.z - filterCoord.x, filterCoord.y);
	}
	else {
		point = vec2(filterCoord.x, uBoundRect.w - filterCoord.y);
	}
	float squareCount = 16.0;
	float horzBarWidth = uBoundRect.z / squareCount;
	float verticalBarWidth = uBoundRect.w / squareCount;
	float horzCount = floor(point.x / horzBarWidth);
	float verticalCount = floor(point.y / verticalBarWidth);
	float timePercent = (percent * squareCount) * 2.5;
	vec4 alphaStage;
	if (transition > 0.0) {
		alphaStage = vec4(0.2, 0.4, 0.6, 0.8);
	}
	else {
		alphaStage = vec4(0.8, 0.6, 0.4, 0.2);
	}
	if ((horzCount + verticalCount) < (timePercent - 4.0)) {
		gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
	}
	else if ((horzCount + verticalCount) < (timePercent - 3.0)) {
		gl_FragColor = outputColor * alphaStage.w;
	}
	else if ((horzCount + verticalCount) < (timePercent - 2.0)) {
		gl_FragColor = outputColor * alphaStage.z;
	}
	else if ((horzCount + verticalCount) < (timePercent - 1.0)) {
		gl_FragColor = outputColor * alphaStage.y;
	}
	else if ((horzCount + verticalCount) < timePercent) {
		gl_FragColor = outputColor * alphaStage.x;
	}
	else {
		gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	float alphaBarArcWidth = 0.3;
	float timePercent = (percent * PI) * (1.0 + alphaBarArcWidth);
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,S){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	if (point.x < 0.0) {
		arc = (2.0 * PI) - arc;
	}
	arc = arc == 0.0 ? arc : mod(arc, (2.0 * PI) / option);
	float totalAlphaBarArcWidth = 0.75;
	float alphaBarArcWidth = totalAlphaBarArcWidth / option;
	float timePercent = ((percent * PI) * (2.0 + totalAlphaBarArcWidth)) / option;
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,S,v){var O=v(150);b.exports=function(R,M){return O(R,M)}},function(b,S,v){var O=v(25),R=Object.prototype,M=R.hasOwnProperty,D=R.toString,B=O?O.toStringTag:void 0;b.exports=function(z){var X=M.call(z,B),J=z[B];try{z[B]=void 0;var et=!0}catch{}var pt=D.call(z);return et&&(X?z[B]=J:delete z[B]),pt}},function(b,S){var v=Object.prototype.toString;b.exports=function(O){return v.call(O)}},function(b,S,v){(function(O){var R=v(108),M=v(111),D=v.n(M);/*!
 * @pixi/polyfill - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(typeof globalThis=="undefined"&&(typeof self!="undefined"?self.globalThis=self:O!==void 0&&(O.globalThis=O)),globalThis.Promise||(globalThis.Promise=R.a),Object.assign||(Object.assign=D.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!globalThis.performance||!globalThis.performance.now){var B=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-B}}for(var z=Date.now(),X=["ms","moz","webkit","o"],J=0;J<X.length&&!globalThis.requestAnimationFrame;++J){var et=X[J];globalThis.requestAnimationFrame=globalThis[et+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[et+"CancelAnimationFrame"]||globalThis[et+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(pt){if(typeof pt!="function")throw new TypeError(pt+"is not a function");var Nt=Date.now(),vt=16+z-Nt;return vt<0&&(vt=0),z=Nt,globalThis.self.setTimeout(function(){z=Date.now(),pt(performance.now())},vt)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(pt){return clearTimeout(pt)}),Math.sign||(Math.sign=function(pt){return(pt=Number(pt))===0||isNaN(pt)?pt:pt>0?1:-1}),Number.isInteger||(Number.isInteger=function(pt){return typeof pt=="number"&&isFinite(pt)&&Math.floor(pt)===pt}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array)}).call(this,v(17))},function(b,S,v){(function(O){var R=O!==void 0&&O||typeof self!="undefined"&&self||window,M=Function.prototype.apply;function D(B,z){this._id=B,this._clearFn=z}S.setTimeout=function(){return new D(M.call(setTimeout,R,arguments),clearTimeout)},S.setInterval=function(){return new D(M.call(setInterval,R,arguments),clearInterval)},S.clearTimeout=S.clearInterval=function(B){B&&B.close()},D.prototype.unref=D.prototype.ref=function(){},D.prototype.close=function(){this._clearFn.call(R,this._id)},S.enroll=function(B,z){clearTimeout(B._idleTimeoutId),B._idleTimeout=z},S.unenroll=function(B){clearTimeout(B._idleTimeoutId),B._idleTimeout=-1},S._unrefActive=S.active=function(B){clearTimeout(B._idleTimeoutId);var z=B._idleTimeout;z>=0&&(B._idleTimeoutId=setTimeout(function(){B._onTimeout&&B._onTimeout()},z))},v(141),S.setImmediate=typeof self!="undefined"&&self.setImmediate||O!==void 0&&O.setImmediate||this&&this.setImmediate,S.clearImmediate=typeof self!="undefined"&&self.clearImmediate||O!==void 0&&O.clearImmediate||this&&this.clearImmediate}).call(this,v(17))},function(b,S,v){(function(O,R){(function(M,D){if(!M.setImmediate){var B,z,X,J,et,pt=1,Nt={},vt=!1,L=M.document,I=Object.getPrototypeOf&&Object.getPrototypeOf(M);I=I&&I.setTimeout?I:M,{}.toString.call(M.process)==="[object process]"?B=function(P){R.nextTick(function(){W(P)})}:function(){if(M.postMessage&&!M.importScripts){var P=!0,j=M.onmessage;return M.onmessage=function(){P=!1},M.postMessage("","*"),M.onmessage=j,P}}()?(J="setImmediate$"+Math.random()+"$",et=function(P){P.source===M&&typeof P.data=="string"&&P.data.indexOf(J)===0&&W(+P.data.slice(J.length))},M.addEventListener?M.addEventListener("message",et,!1):M.attachEvent("onmessage",et),B=function(P){M.postMessage(J+P,"*")}):M.MessageChannel?((X=new MessageChannel).port1.onmessage=function(P){W(P.data)},B=function(P){X.port2.postMessage(P)}):L&&"onreadystatechange"in L.createElement("script")?(z=L.documentElement,B=function(P){var j=L.createElement("script");j.onreadystatechange=function(){W(P),j.onreadystatechange=null,z.removeChild(j),j=null},z.appendChild(j)}):B=function(P){setTimeout(W,0,P)},I.setImmediate=function(P){typeof P!="function"&&(P=new Function(""+P));for(var j=new Array(arguments.length-1),Q=0;Q<j.length;Q++)j[Q]=arguments[Q+1];var H={callback:P,args:j};return Nt[pt]=H,B(pt),pt++},I.clearImmediate=F}function F(P){delete Nt[P]}function W(P){if(vt)setTimeout(W,0,P);else{var j=Nt[P];if(j){vt=!0;try{(function(Q){var H=Q.callback,Ot=Q.args;switch(Ot.length){case 0:H();break;case 1:H(Ot[0]);break;case 2:H(Ot[0],Ot[1]);break;case 3:H(Ot[0],Ot[1],Ot[2]);break;default:H.apply(void 0,Ot)}})(j)}finally{F(P),vt=!1}}}}})(typeof self=="undefined"?O===void 0?this:O:self)}).call(this,v(17),v(142))},function(b,S){var v,O,R=b.exports={};function M(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function B(I){if(v===setTimeout)return setTimeout(I,0);if((v===M||!v)&&setTimeout)return v=setTimeout,setTimeout(I,0);try{return v(I,0)}catch{try{return v.call(null,I,0)}catch{return v.call(this,I,0)}}}(function(){try{v=typeof setTimeout=="function"?setTimeout:M}catch{v=M}try{O=typeof clearTimeout=="function"?clearTimeout:D}catch{O=D}})();var z,X=[],J=!1,et=-1;function pt(){J&&z&&(J=!1,z.length?X=z.concat(X):et=-1,X.length&&Nt())}function Nt(){if(!J){var I=B(pt);J=!0;for(var F=X.length;F;){for(z=X,X=[];++et<F;)z&&z[et].run();et=-1,F=X.length}z=null,J=!1,function(W){if(O===clearTimeout)return clearTimeout(W);if((O===D||!O)&&clearTimeout)return O=clearTimeout,clearTimeout(W);try{O(W)}catch{try{return O.call(null,W)}catch{return O.call(this,W)}}}(I)}}function vt(I,F){this.fun=I,this.array=F}function L(){}R.nextTick=function(I){var F=new Array(arguments.length-1);if(arguments.length>1)for(var W=1;W<arguments.length;W++)F[W-1]=arguments[W];X.push(new vt(I,F)),X.length!==1||J||B(Nt)},vt.prototype.run=function(){this.fun.apply(null,this.array)},R.title="browser",R.browser=!0,R.env={},R.argv=[],R.version="",R.versions={},R.on=L,R.addListener=L,R.once=L,R.off=L,R.removeListener=L,R.removeAllListeners=L,R.emit=L,R.prependListener=L,R.prependOnceListener=L,R.listeners=function(I){return[]},R.binding=function(I){throw new Error("process.binding is not supported")},R.cwd=function(){return"/"},R.chdir=function(I){throw new Error("process.chdir is not supported")},R.umask=function(){return 0}},function(b,S,v){(function(O,R){var M;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(D){S&&S.nodeType,O&&O.nodeType;var B=typeof R=="object"&&R;B.global!==B&&B.window!==B&&B.self;var z,X=2147483647,J=/^xn--/,et=/[^\x20-\x7E]/,pt=/[\x2E\u3002\uFF0E\uFF61]/g,Nt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},vt=Math.floor,L=String.fromCharCode;function I(st){throw new RangeError(Nt[st])}function F(st,V){for(var k=st.length,mt=[];k--;)mt[k]=V(st[k]);return mt}function W(st,V){var k=st.split("@"),mt="";return k.length>1&&(mt=k[0]+"@",st=k[1]),mt+F((st=st.replace(pt,".")).split("."),V).join(".")}function P(st){for(var V,k,mt=[],tt=0,_t=st.length;tt<_t;)(V=st.charCodeAt(tt++))>=55296&&V<=56319&&tt<_t?(64512&(k=st.charCodeAt(tt++)))==56320?mt.push(((1023&V)<<10)+(1023&k)+65536):(mt.push(V),tt--):mt.push(V);return mt}function j(st){return F(st,function(V){var k="";return V>65535&&(k+=L((V-=65536)>>>10&1023|55296),V=56320|1023&V),k+=L(V)}).join("")}function Q(st,V){return st+22+75*(st<26)-((V!=0)<<5)}function H(st,V,k){var mt=0;for(st=k?vt(st/700):st>>1,st+=vt(st/V);st>455;mt+=36)st=vt(st/35);return vt(mt+36*st/(st+38))}function Ot(st){var V,k,mt,tt,_t,Dt,Z,ct,rt,yt,At,Gt=[],Yt=st.length,Jt=0,at=128,_e=72;for((k=st.lastIndexOf("-"))<0&&(k=0),mt=0;mt<k;++mt)st.charCodeAt(mt)>=128&&I("not-basic"),Gt.push(st.charCodeAt(mt));for(tt=k>0?k+1:0;tt<Yt;){for(_t=Jt,Dt=1,Z=36;tt>=Yt&&I("invalid-input"),((ct=(At=st.charCodeAt(tt++))-48<10?At-22:At-65<26?At-65:At-97<26?At-97:36)>=36||ct>vt((X-Jt)/Dt))&&I("overflow"),Jt+=ct*Dt,!(ct<(rt=Z<=_e?1:Z>=_e+26?26:Z-_e));Z+=36)Dt>vt(X/(yt=36-rt))&&I("overflow"),Dt*=yt;_e=H(Jt-_t,V=Gt.length+1,_t==0),vt(Jt/V)>X-at&&I("overflow"),at+=vt(Jt/V),Jt%=V,Gt.splice(Jt++,0,at)}return j(Gt)}function Vt(st){var V,k,mt,tt,_t,Dt,Z,ct,rt,yt,At,Gt,Yt,Jt,at,_e=[];for(Gt=(st=P(st)).length,V=128,k=0,_t=72,Dt=0;Dt<Gt;++Dt)(At=st[Dt])<128&&_e.push(L(At));for(mt=tt=_e.length,tt&&_e.push("-");mt<Gt;){for(Z=X,Dt=0;Dt<Gt;++Dt)(At=st[Dt])>=V&&At<Z&&(Z=At);for(Z-V>vt((X-k)/(Yt=mt+1))&&I("overflow"),k+=(Z-V)*Yt,V=Z,Dt=0;Dt<Gt;++Dt)if((At=st[Dt])<V&&++k>X&&I("overflow"),At==V){for(ct=k,rt=36;!(ct<(yt=rt<=_t?1:rt>=_t+26?26:rt-_t));rt+=36)at=ct-yt,Jt=36-yt,_e.push(L(Q(yt+at%Jt,0))),ct=vt(at/Jt);_e.push(L(Q(ct,0))),_t=H(k,Yt,mt==tt),k=0,++mt}++k,++V}return _e.join("")}z={version:"1.4.1",ucs2:{decode:P,encode:j},decode:Ot,encode:Vt,toASCII:function(st){return W(st,function(V){return et.test(V)?"xn--"+Vt(V):V})},toUnicode:function(st){return W(st,function(V){return J.test(V)?Ot(V.slice(4).toLowerCase()):V})}},(M=function(){return z}.call(S,v,S,O))===void 0||(O.exports=M)})()}).call(this,v(26)(b),v(17))},function(b,S,v){b.exports={isString:function(O){return typeof O=="string"},isObject:function(O){return typeof O=="object"&&O!==null},isNull:function(O){return O===null},isNullOrUndefined:function(O){return O==null}}},function(b,S,v){S.decode=S.parse=v(146),S.encode=S.stringify=v(147)},function(b,S,v){function O(M,D){return Object.prototype.hasOwnProperty.call(M,D)}b.exports=function(M,D,B,z){D=D||"&",B=B||"=";var X={};if(typeof M!="string"||M.length===0)return X;var J=/\+/g;M=M.split(D);var et=1e3;z&&typeof z.maxKeys=="number"&&(et=z.maxKeys);var pt=M.length;et>0&&pt>et&&(pt=et);for(var Nt=0;Nt<pt;++Nt){var vt,L,I,F,W=M[Nt].replace(J,"%20"),P=W.indexOf(B);P>=0?(vt=W.substr(0,P),L=W.substr(P+1)):(vt=W,L=""),I=decodeURIComponent(vt),F=decodeURIComponent(L),O(X,I)?R(X[I])?X[I].push(F):X[I]=[X[I],F]:X[I]=F}return X};var R=Array.isArray||function(M){return Object.prototype.toString.call(M)==="[object Array]"}},function(b,S,v){var O=function(B){switch(typeof B){case"string":return B;case"boolean":return B?"true":"false";case"number":return isFinite(B)?B:"";default:return""}};b.exports=function(B,z,X,J){return z=z||"&",X=X||"=",B===null&&(B=void 0),typeof B=="object"?M(D(B),function(et){var pt=encodeURIComponent(O(et))+X;return R(B[et])?M(B[et],function(Nt){return pt+encodeURIComponent(O(Nt))}).join(z):pt+encodeURIComponent(O(B[et]))}).join(z):J?encodeURIComponent(O(J))+X+encodeURIComponent(O(B)):""};var R=Array.isArray||function(B){return Object.prototype.toString.call(B)==="[object Array]"};function M(B,z){if(B.map)return B.map(z);for(var X=[],J=0;J<B.length;J++)X.push(z(B[J],J));return X}var D=Object.keys||function(B){var z=[];for(var X in B)Object.prototype.hasOwnProperty.call(B,X)&&z.push(X);return z}},function(b,S){var v=function(){};v.prototype={fit:function(O){var R,M,D,B,z=O.length,X=z>0?O[0].width:0,J=z>0?O[0].height:0;for(this.root={x:0,y:0,width:X,height:J},R=0;R<z;R++)D=O[R],(M=this.findNode(this.root,D.width,D.height))?(B=this.splitNode(M,D.width,D.height),D.x=B.x,D.y=B.y):(B=this.growNode(D.width,D.height),D.x=B.x,D.y=B.y)},findNode:function(O,R,M){return O.used?this.findNode(O.right,R,M)||this.findNode(O.down,R,M):R<=O.width&&M<=O.height?O:null},splitNode:function(O,R,M){return O.used=!0,O.down={x:O.x,y:O.y+M,width:O.width,height:O.height-M},O.right={x:O.x+R,y:O.y,width:O.width-R,height:M},O},growNode:function(O,R){var M=O<=this.root.width,D=R<=this.root.height,B=D&&this.root.height>=this.root.width+O,z=M&&this.root.width>=this.root.height+R;return B?this.growRight(O,R):z?this.growDown(O,R):D?this.growRight(O,R):M?this.growDown(O,R):null},growRight:function(O,R){var M;return this.root={used:!0,x:0,y:0,width:this.root.width+O,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:O,height:this.root.height}},(M=this.findNode(this.root,O,R))?this.splitNode(M,O,R):null},growDown:function(O,R){var M;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+R,down:{x:0,y:this.root.height,width:this.root.width,height:R},right:this.root},(M=this.findNode(this.root,O,R))?this.splitNode(M,O,R):null}},b.exports=v},function(b,S){(function(v){b.exports=v}).call(this,{})},function(b,S,v){var O=v(151),R=v(15);b.exports=function M(D,B,z,X,J){return D===B||(D==null||B==null||!R(D)&&!R(B)?D!=D&&B!=B:O(D,B,z,X,M,J))}},function(b,S,v){var O=v(54),R=v(57),M=v(183),D=v(186),B=v(32),z=v(31),X=v(41),J=v(64),et="[object Object]",pt=Object.prototype.hasOwnProperty;b.exports=function(Nt,vt,L,I,F,W){var P=z(Nt),j=z(vt),Q=P?"[object Array]":B(Nt),H=j?"[object Array]":B(vt),Ot=(Q=Q=="[object Arguments]"?et:Q)==et,Vt=(H=H=="[object Arguments]"?et:H)==et,st=Q==H;if(st&&X(Nt)){if(!X(vt))return!1;P=!0,Ot=!1}if(st&&!Ot)return W||(W=new O),P||J(Nt)?R(Nt,vt,L,I,F,W):M(Nt,vt,Q,L,I,F,W);if(!(1&L)){var V=Ot&&pt.call(Nt,"__wrapped__"),k=Vt&&pt.call(vt,"__wrapped__");if(V||k){var mt=V?Nt.value():Nt,tt=k?vt.value():vt;return W||(W=new O),F(mt,tt,L,I,W)}}return!!st&&(W||(W=new O),D(Nt,vt,L,I,F,W))}},function(b,S){b.exports=function(){this.__data__=[],this.size=0}},function(b,S,v){var O=v(28),R=Array.prototype.splice;b.exports=function(M){var D=this.__data__,B=O(D,M);return!(B<0)&&(B==D.length-1?D.pop():R.call(D,B,1),--this.size,!0)}},function(b,S,v){var O=v(28);b.exports=function(R){var M=this.__data__,D=O(M,R);return D<0?void 0:M[D][1]}},function(b,S,v){var O=v(28);b.exports=function(R){return O(this.__data__,R)>-1}},function(b,S,v){var O=v(28);b.exports=function(R,M){var D=this.__data__,B=O(D,R);return B<0?(++this.size,D.push([R,M])):D[B][1]=M,this}},function(b,S,v){var O=v(27);b.exports=function(){this.__data__=new O,this.size=0}},function(b,S){b.exports=function(v){var O=this.__data__,R=O.delete(v);return this.size=O.size,R}},function(b,S){b.exports=function(v){return this.__data__.get(v)}},function(b,S){b.exports=function(v){return this.__data__.has(v)}},function(b,S,v){var O=v(27),R=v(38),M=v(56);b.exports=function(D,B){var z=this.__data__;if(z instanceof O){var X=z.__data__;if(!R||X.length<199)return X.push([D,B]),this.size=++z.size,this;z=this.__data__=new M(X)}return z.set(D,B),this.size=z.size,this}},function(b,S,v){var O=v(34),R=v(163),M=v(21),D=v(55),B=/^\[object .+?Constructor\]$/,z=Function.prototype,X=Object.prototype,J=z.toString,et=X.hasOwnProperty,pt=RegExp("^"+J.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=function(Nt){return!(!M(Nt)||R(Nt))&&(O(Nt)?pt:B).test(D(Nt))}},function(b,S,v){var O,R=v(164),M=(O=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";b.exports=function(D){return!!M&&M in D}},function(b,S,v){var O=v(14)["__core-js_shared__"];b.exports=O},function(b,S){b.exports=function(v,O){return v==null?void 0:v[O]}},function(b,S,v){var O=v(167),R=v(27),M=v(38);b.exports=function(){this.size=0,this.__data__={hash:new O,map:new(M||R),string:new O}}},function(b,S,v){var O=v(168),R=v(169),M=v(170),D=v(171),B=v(172);function z(X){var J=-1,et=X==null?0:X.length;for(this.clear();++J<et;){var pt=X[J];this.set(pt[0],pt[1])}}z.prototype.clear=O,z.prototype.delete=R,z.prototype.get=M,z.prototype.has=D,z.prototype.set=B,b.exports=z},function(b,S,v){var O=v(29);b.exports=function(){this.__data__=O?O(null):{},this.size=0}},function(b,S){b.exports=function(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}},function(b,S,v){var O=v(29),R=Object.prototype.hasOwnProperty;b.exports=function(M){var D=this.__data__;if(O){var B=D[M];return B==="__lodash_hash_undefined__"?void 0:B}return R.call(D,M)?D[M]:void 0}},function(b,S,v){var O=v(29),R=Object.prototype.hasOwnProperty;b.exports=function(M){var D=this.__data__;return O?D[M]!==void 0:R.call(D,M)}},function(b,S,v){var O=v(29);b.exports=function(R,M){var D=this.__data__;return this.size+=this.has(R)?0:1,D[R]=O&&M===void 0?"__lodash_hash_undefined__":M,this}},function(b,S,v){var O=v(30);b.exports=function(R){var M=O(this,R).delete(R);return this.size-=M?1:0,M}},function(b,S){b.exports=function(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}},function(b,S,v){var O=v(30);b.exports=function(R){return O(this,R).get(R)}},function(b,S,v){var O=v(30);b.exports=function(R){return O(this,R).has(R)}},function(b,S,v){var O=v(30);b.exports=function(R,M){var D=O(this,R),B=D.size;return D.set(R,M),this.size+=D.size==B?0:1,this}},function(b,S,v){var O=v(56),R=v(179),M=v(180);function D(B){var z=-1,X=B==null?0:B.length;for(this.__data__=new O;++z<X;)this.add(B[z])}D.prototype.add=D.prototype.push=R,D.prototype.has=M,b.exports=D},function(b,S){b.exports=function(v){return this.__data__.set(v,"__lodash_hash_undefined__"),this}},function(b,S){b.exports=function(v){return this.__data__.has(v)}},function(b,S){b.exports=function(v,O){for(var R=-1,M=v==null?0:v.length;++R<M;)if(O(v[R],R,v))return!0;return!1}},function(b,S){b.exports=function(v,O){return v.has(O)}},function(b,S,v){var O=v(25),R=v(58),M=v(37),D=v(57),B=v(184),z=v(185),X=O?O.prototype:void 0,J=X?X.valueOf:void 0;b.exports=function(et,pt,Nt,vt,L,I,F){switch(Nt){case"[object DataView]":if(et.byteLength!=pt.byteLength||et.byteOffset!=pt.byteOffset)return!1;et=et.buffer,pt=pt.buffer;case"[object ArrayBuffer]":return!(et.byteLength!=pt.byteLength||!I(new R(et),new R(pt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return M(+et,+pt);case"[object Error]":return et.name==pt.name&&et.message==pt.message;case"[object RegExp]":case"[object String]":return et==pt+"";case"[object Map]":var W=B;case"[object Set]":var P=1&vt;if(W||(W=z),et.size!=pt.size&&!P)return!1;var j=F.get(et);if(j)return j==pt;vt|=2,F.set(et,pt);var Q=D(W(et),W(pt),vt,L,I,F);return F.delete(et),Q;case"[object Symbol]":if(J)return J.call(et)==J.call(pt)}return!1}},function(b,S){b.exports=function(v){var O=-1,R=Array(v.size);return v.forEach(function(M,D){R[++O]=[D,M]}),R}},function(b,S){b.exports=function(v){var O=-1,R=Array(v.size);return v.forEach(function(M){R[++O]=M}),R}},function(b,S,v){var O=v(59),R=Object.prototype.hasOwnProperty;b.exports=function(M,D,B,z,X,J){var et=1&B,pt=O(M),Nt=pt.length;if(Nt!=O(D).length&&!et)return!1;for(var vt=Nt;vt--;){var L=pt[vt];if(!(et?L in D:R.call(D,L)))return!1}var I=J.get(M),F=J.get(D);if(I&&F)return I==D&&F==M;var W=!0;J.set(M,D),J.set(D,M);for(var P=et;++vt<Nt;){var j=M[L=pt[vt]],Q=D[L];if(z)var H=et?z(Q,j,L,D,M,J):z(j,Q,L,M,D,J);if(!(H===void 0?j===Q||X(j,Q,B,z,J):H)){W=!1;break}P||(P=L=="constructor")}if(W&&!P){var Ot=M.constructor,Vt=D.constructor;Ot==Vt||!("constructor"in M)||!("constructor"in D)||typeof Ot=="function"&&Ot instanceof Ot&&typeof Vt=="function"&&Vt instanceof Vt||(W=!1)}return J.delete(M),J.delete(D),W}},function(b,S){b.exports=function(v,O){for(var R=-1,M=v==null?0:v.length,D=0,B=[];++R<M;){var z=v[R];O(z,R,v)&&(B[D++]=z)}return B}},function(b,S){b.exports=function(v,O){for(var R=-1,M=Array(v);++R<v;)M[R]=O(R);return M}},function(b,S,v){var O=v(190),R=v(15),M=Object.prototype,D=M.hasOwnProperty,B=M.propertyIsEnumerable,z=O(function(){return arguments}())?O:function(X){return R(X)&&D.call(X,"callee")&&!B.call(X,"callee")};b.exports=z},function(b,S,v){var O=v(20),R=v(15);b.exports=function(M){return R(M)&&O(M)=="[object Arguments]"}},function(b,S){b.exports=function(){return!1}},function(b,S){var v=/^(?:0|[1-9]\d*)$/;b.exports=function(O,R){var M=typeof O;return!!(R=R==null?9007199254740991:R)&&(M=="number"||M!="symbol"&&v.test(O))&&O>-1&&O%1==0&&O<R}},function(b,S,v){var O=v(20),R=v(65),M=v(15),D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Arguments]"]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object Boolean]"]=D["[object DataView]"]=D["[object Date]"]=D["[object Error]"]=D["[object Function]"]=D["[object Map]"]=D["[object Number]"]=D["[object Object]"]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object WeakMap]"]=!1,b.exports=function(B){return M(B)&&R(B.length)&&!!D[O(B)]}},function(b,S,v){var O=v(44),R=v(195),M=Object.prototype.hasOwnProperty;b.exports=function(D){if(!O(D))return R(D);var B=[];for(var z in Object(D))M.call(D,z)&&z!="constructor"&&B.push(z);return B}},function(b,S,v){var O=v(66)(Object.keys,Object);b.exports=O},function(b,S,v){var O=v(22)(v(14),"DataView");b.exports=O},function(b,S,v){var O=v(22)(v(14),"Promise");b.exports=O},function(b,S,v){var O=v(22)(v(14),"Set");b.exports=O},function(b,S,v){var O=v(22)(v(14),"WeakMap");b.exports=O},function(b,S,v){var O=v(14);b.exports=function(){return O.Date.now()}},function(b,S,v){var O=v(202),R=v(21),M=v(204),D=/^[-+]0x[0-9a-f]+$/i,B=/^0b[01]+$/i,z=/^0o[0-7]+$/i,X=parseInt;b.exports=function(J){if(typeof J=="number")return J;if(M(J))return NaN;if(R(J)){var et=typeof J.valueOf=="function"?J.valueOf():J;J=R(et)?et+"":et}if(typeof J!="string")return J===0?J:+J;J=O(J);var pt=B.test(J);return pt||z.test(J)?X(J.slice(2),pt?2:8):D.test(J)?NaN:+J}},function(b,S,v){var O=v(203),R=/^\s+/;b.exports=function(M){return M&&M.slice(0,O(M)+1).replace(R,"")}},function(b,S){var v=/\s/;b.exports=function(O){for(var R=O.length;R--&&v.test(O.charAt(R)););return R}},function(b,S,v){var O=v(20),R=v(15);b.exports=function(M){return typeof M=="symbol"||R(M)&&O(M)=="[object Symbol]"}},function(b,S,v){var O=v(54),R=v(206),M=v(68),D=v(208),B=v(209),z=v(212),X=v(213),J=v(214),et=v(215),pt=v(59),Nt=v(216),vt=v(32),L=v(217),I=v(218),F=v(223),W=v(31),P=v(41),j=v(225),Q=v(21),H=v(227),Ot=v(40),Vt=v(45),st={};st["[object Arguments]"]=st["[object Array]"]=st["[object ArrayBuffer]"]=st["[object DataView]"]=st["[object Boolean]"]=st["[object Date]"]=st["[object Float32Array]"]=st["[object Float64Array]"]=st["[object Int8Array]"]=st["[object Int16Array]"]=st["[object Int32Array]"]=st["[object Map]"]=st["[object Number]"]=st["[object Object]"]=st["[object RegExp]"]=st["[object Set]"]=st["[object String]"]=st["[object Symbol]"]=st["[object Uint8Array]"]=st["[object Uint8ClampedArray]"]=st["[object Uint16Array]"]=st["[object Uint32Array]"]=!0,st["[object Error]"]=st["[object Function]"]=st["[object WeakMap]"]=!1,b.exports=function V(k,mt,tt,_t,Dt,Z){var ct,rt=1&mt,yt=2&mt,At=4&mt;if(tt&&(ct=Dt?tt(k,_t,Dt,Z):tt(k)),ct!==void 0)return ct;if(!Q(k))return k;var Gt=W(k);if(Gt){if(ct=L(k),!rt)return X(k,ct)}else{var Yt=vt(k),Jt=Yt=="[object Function]"||Yt=="[object GeneratorFunction]";if(P(k))return z(k,rt);if(Yt=="[object Object]"||Yt=="[object Arguments]"||Jt&&!Dt){if(ct=yt||Jt?{}:F(k),!rt)return yt?et(k,B(ct,k)):J(k,D(ct,k))}else{if(!st[Yt])return Dt?k:{};ct=I(k,Yt,rt)}}Z||(Z=new O);var at=Z.get(k);if(at)return at;Z.set(k,ct),H(k)?k.forEach(function(ke){ct.add(V(ke,mt,tt,ke,k,Z))}):j(k)&&k.forEach(function(ke,Le){ct.set(Le,V(ke,mt,tt,Le,k,Z))});var _e=Gt?void 0:(At?yt?Nt:pt:yt?Vt:Ot)(k);return R(_e||k,function(ke,Le){_e&&(ke=k[Le=ke]),M(ct,Le,V(ke,mt,tt,Le,k,Z))}),ct}},function(b,S){b.exports=function(v,O){for(var R=-1,M=v==null?0:v.length;++R<M&&O(v[R],R,v)!==!1;);return v}},function(b,S,v){var O=v(22),R=function(){try{var M=O(Object,"defineProperty");return M({},"",{}),M}catch{}}();b.exports=R},function(b,S,v){var O=v(33),R=v(40);b.exports=function(M,D){return M&&O(D,R(D),M)}},function(b,S,v){var O=v(33),R=v(45);b.exports=function(M,D){return M&&O(D,R(D),M)}},function(b,S,v){var O=v(21),R=v(44),M=v(211),D=Object.prototype.hasOwnProperty;b.exports=function(B){if(!O(B))return M(B);var z=R(B),X=[];for(var J in B)(J!="constructor"||!z&&D.call(B,J))&&X.push(J);return X}},function(b,S){b.exports=function(v){var O=[];if(v!=null)for(var R in Object(v))O.push(R);return O}},function(b,S,v){(function(O){var R=v(14),M=S&&!S.nodeType&&S,D=M&&typeof O=="object"&&O&&!O.nodeType&&O,B=D&&D.exports===M?R.Buffer:void 0,z=B?B.allocUnsafe:void 0;O.exports=function(X,J){if(J)return X.slice();var et=X.length,pt=z?z(et):new X.constructor(et);return X.copy(pt),pt}}).call(this,v(26)(b))},function(b,S){b.exports=function(v,O){var R=-1,M=v.length;for(O||(O=Array(M));++R<M;)O[R]=v[R];return O}},function(b,S,v){var O=v(33),R=v(39);b.exports=function(M,D){return O(M,R(M),D)}},function(b,S,v){var O=v(33),R=v(70);b.exports=function(M,D){return O(M,R(M),D)}},function(b,S,v){var O=v(60),R=v(70),M=v(45);b.exports=function(D){return O(D,M,R)}},function(b,S){var v=Object.prototype.hasOwnProperty;b.exports=function(O){var R=O.length,M=new O.constructor(R);return R&&typeof O[0]=="string"&&v.call(O,"index")&&(M.index=O.index,M.input=O.input),M}},function(b,S,v){var O=v(46),R=v(219),M=v(220),D=v(221),B=v(222);b.exports=function(z,X,J){var et=z.constructor;switch(X){case"[object ArrayBuffer]":return O(z);case"[object Boolean]":case"[object Date]":return new et(+z);case"[object DataView]":return R(z,J);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return B(z,J);case"[object Map]":return new et;case"[object Number]":case"[object String]":return new et(z);case"[object RegExp]":return M(z);case"[object Set]":return new et;case"[object Symbol]":return D(z)}}},function(b,S,v){var O=v(46);b.exports=function(R,M){var D=M?O(R.buffer):R.buffer;return new R.constructor(D,R.byteOffset,R.byteLength)}},function(b,S){var v=/\w*$/;b.exports=function(O){var R=new O.constructor(O.source,v.exec(O));return R.lastIndex=O.lastIndex,R}},function(b,S,v){var O=v(25),R=O?O.prototype:void 0,M=R?R.valueOf:void 0;b.exports=function(D){return M?Object(M.call(D)):{}}},function(b,S,v){var O=v(46);b.exports=function(R,M){var D=M?O(R.buffer):R.buffer;return new R.constructor(D,R.byteOffset,R.length)}},function(b,S,v){var O=v(224),R=v(71),M=v(44);b.exports=function(D){return typeof D.constructor!="function"||M(D)?{}:O(R(D))}},function(b,S,v){var O=v(21),R=Object.create,M=function(){function D(){}return function(B){if(!O(B))return{};if(R)return R(B);D.prototype=B;var z=new D;return D.prototype=void 0,z}}();b.exports=M},function(b,S,v){var O=v(226),R=v(42),M=v(43),D=M&&M.isMap,B=D?R(D):O;b.exports=B},function(b,S,v){var O=v(32),R=v(15);b.exports=function(M){return R(M)&&O(M)=="[object Map]"}},function(b,S,v){var O=v(228),R=v(42),M=v(43),D=M&&M.isSet,B=D?R(D):O;b.exports=B},function(b,S,v){var O=v(32),R=v(15);b.exports=function(M){return R(M)&&O(M)=="[object Set]"}},function(b,S,v){v.r(S),v.d(S,"ErrorType",function(){return Wi}),v.d(S,"delay",function(){return Oh}),v.d(S,"waitUntil",function(){return kE}),v.d(S,"SLIDE_EVENTS",function(){return or}),v.d(S,"Slide",function(){return no});const O=[];for(let i=0;i<256;i++)O[i]=(i<16?"0":"")+i.toString(16);function R(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(O[255&i]+O[i>>8&255]+O[i>>16&255]+O[i>>24&255]+"-"+O[255&t]+O[t>>8&255]+"-"+O[t>>16&15|64]+O[t>>24&255]+"-"+O[63&e|128]+O[e>>8&255]+"-"+O[e>>16&255]+O[e>>24&255]+O[255&n]+O[n>>8&255]+O[n>>16&255]+O[n>>24&255]).toUpperCase()}var M=v(23);/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */class D{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const n=this._listeners[t];if(n!==void 0){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const e=this._listeners[t.type];if(e!==void 0){t.target=this;const n=e.slice(0);for(let r=0,o=n.length;r<o;r++)n[r].call(this,t);t.target=null}}}const B=[];for(let i=0;i<256;i++)B[i]=(i<16?"0":"")+i.toString(16);const z=Math.PI/180,X=180/Math.PI;function J(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(B[255&i]+B[i>>8&255]+B[i>>16&255]+B[i>>24&255]+"-"+B[255&t]+B[t>>8&255]+"-"+B[t>>16&15|64]+B[t>>24&255]+"-"+B[63&e|128]+B[e>>8&255]+"-"+B[e>>16&255]+B[e>>24&255]+B[255&n]+B[n>>8&255]+B[n>>16&255]+B[n>>24&255]).toUpperCase()}function et(i,t,e){return Math.max(t,Math.min(e,i))}function pt(i,t){return(i%t+t)%t}function Nt(i,t,e){return(1-e)*i+e*t}function vt(i){return(i&i-1)==0&&i!==0}function L(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}class I{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),o=this.x-t.x,s=this.y-t.y;return this.x=o*n-s*r+t.x,this.y=o*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}I.prototype.isVector2=!0;class F{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h){const u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=o,u[5]=l,u[6]=n,u[7]=s,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[3],l=n[6],h=n[1],u=n[4],p=n[7],_=n[2],x=n[5],w=n[8],A=r[0],C=r[3],G=r[6],K=r[1],it=r[4],ft=r[7],nt=r[2],gt=r[5],lt=r[8];return o[0]=s*A+a*K+l*nt,o[3]=s*C+a*it+l*gt,o[6]=s*G+a*ft+l*lt,o[1]=h*A+u*K+p*nt,o[4]=h*C+u*it+p*gt,o[7]=h*G+u*ft+p*lt,o[2]=_*A+x*K+w*nt,o[5]=_*C+x*it+w*gt,o[8]=_*G+x*ft+w*lt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*s*u-e*a*h-n*o*u+n*a*l+r*o*h-r*s*l}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=u*s-a*h,_=a*l-u*o,x=h*o-s*l,w=e*p+n*_+r*x;if(w===0)return this.set(0,0,0,0,0,0,0,0,0);const A=1/w;return t[0]=p*A,t[1]=(r*h-u*n)*A,t[2]=(a*n-r*s)*A,t[3]=_*A,t[4]=(u*e-r*l)*A,t[5]=(r*o-a*e)*A,t[6]=x*A,t[7]=(n*l-h*e)*A,t[8]=(s*e-n*o)*A,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,o,s,a){const l=Math.cos(o),h=Math.sin(o);return this.set(n*l,n*h,-n*(l*s+h*a)+s+t,-r*h,r*l,-r*(-h*s+l*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],h=r[4],u=r[7];return r[0]=e*o+n*l,r[3]=e*s+n*h,r[6]=e*a+n*u,r[1]=-n*o+e*l,r[4]=-n*s+e*h,r[7]=-n*a+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}let W;F.prototype.isMatrix3=!0;class P{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{W===void 0&&(W=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),W.width=t.width,W.height=t.height;const n=W.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=W}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let j=0;class Q extends D{constructor(t=Q.DEFAULT_IMAGE,e=Q.DEFAULT_MAPPING,n=1001,r=1001,o=1006,s=1008,a=1023,l=1009,h=1,u=3e3){super(),Object.defineProperty(this,"id",{value:j++}),this.uuid=J(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new I(0,0),this.repeat=new I(1,1),this.center=new I(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new F,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const r=this.image;if(r.uuid===void 0&&(r.uuid=J()),!e&&t.images[r.uuid]===void 0){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(H(r[s].image)):o.push(H(r[s]))}else o=H(r);t.images[r.uuid]={uuid:r.uuid,url:o}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}function H(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?P.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Q.DEFAULT_IMAGE=void 0,Q.DEFAULT_MAPPING=300,Q.prototype.isTexture=!0;class Ot{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*o,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*o,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*o,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,o;const s=t.elements,a=s[0],l=s[4],h=s[8],u=s[1],p=s[5],_=s[9],x=s[2],w=s[6],A=s[10];if(Math.abs(l-u)<.01&&Math.abs(h-x)<.01&&Math.abs(_-w)<.01){if(Math.abs(l+u)<.1&&Math.abs(h+x)<.1&&Math.abs(_+w)<.1&&Math.abs(a+p+A-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const G=(a+1)/2,K=(p+1)/2,it=(A+1)/2,ft=(l+u)/4,nt=(h+x)/4,gt=(_+w)/4;return G>K&&G>it?G<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(G),r=ft/n,o=nt/n):K>it?K<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(K),n=ft/r,o=gt/r):it<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(it),n=nt/o,r=gt/o),this.set(n,r,o,e),this}let C=Math.sqrt((w-_)*(w-_)+(h-x)*(h-x)+(u-l)*(u-l));return Math.abs(C)<.001&&(C=1),this.x=(w-_)/C,this.y=(h-x)/C,this.z=(u-l)/C,this.w=Math.acos((a+p+A-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Ot.prototype.isVector4=!0;class Vt extends D{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Ot(0,0,t,e),this.scissorTest=!1,this.viewport=new Ot(0,0,t,e),this.texture=new Q(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:1006,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Vt.prototype.isWebGLRenderTarget=!0,class extends Vt{constructor(i,t,e){super(i,t);const n=this.texture;this.texture=[];for(let r=0;r<e;r++)this.texture[r]=n.clone()}setSize(i,t,e=1){if(this.width!==i||this.height!==t||this.depth!==e){this.width=i,this.height=t,this.depth=e;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=i,this.texture[n].image.height=t,this.texture[n].image.depth=e;this.dispose()}return this.viewport.set(0,0,i,t),this.scissor.set(0,0,i,t),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.texture.length=0;for(let t=0,e=i.texture.length;t<e;t++)this.texture[t]=i.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class st extends Vt{constructor(t,e,n){super(t,e,n),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}st.prototype.isWebGLMultisampleRenderTarget=!0;class V{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,o,s,a){let l=n[r+0],h=n[r+1],u=n[r+2],p=n[r+3];const _=o[s+0],x=o[s+1],w=o[s+2],A=o[s+3];if(a===0)return t[e+0]=l,t[e+1]=h,t[e+2]=u,void(t[e+3]=p);if(a===1)return t[e+0]=_,t[e+1]=x,t[e+2]=w,void(t[e+3]=A);if(p!==A||l!==_||h!==x||u!==w){let C=1-a;const G=l*_+h*x+u*w+p*A,K=G>=0?1:-1,it=1-G*G;if(it>Number.EPSILON){const nt=Math.sqrt(it),gt=Math.atan2(nt,G*K);C=Math.sin(C*gt)/nt,a=Math.sin(a*gt)/nt}const ft=a*K;if(l=l*C+_*ft,h=h*C+x*ft,u=u*C+w*ft,p=p*C+A*ft,C===1-a){const nt=1/Math.sqrt(l*l+h*h+u*u+p*p);l*=nt,h*=nt,u*=nt,p*=nt}}t[e]=l,t[e+1]=h,t[e+2]=u,t[e+3]=p}static multiplyQuaternionsFlat(t,e,n,r,o,s){const a=n[r],l=n[r+1],h=n[r+2],u=n[r+3],p=o[s],_=o[s+1],x=o[s+2],w=o[s+3];return t[e]=a*w+u*p+l*x-h*_,t[e+1]=l*w+u*_+h*p-a*x,t[e+2]=h*w+u*x+a*_-l*p,t[e+3]=u*w-a*p-l*_-h*x,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,o=t._z,s=t._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(r/2),p=a(o/2),_=l(n/2),x=l(r/2),w=l(o/2);switch(s){case"XYZ":this._x=_*u*p+h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p-_*x*w;break;case"YXZ":this._x=_*u*p+h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p+_*x*w;break;case"ZXY":this._x=_*u*p-h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p-_*x*w;break;case"ZYX":this._x=_*u*p-h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p+_*x*w;break;case"YZX":this._x=_*u*p+h*x*w,this._y=h*x*p+_*u*w,this._z=h*u*w-_*x*p,this._w=h*u*p-_*x*w;break;case"XZY":this._x=_*u*p-h*x*w,this._y=h*x*p-_*u*w,this._z=h*u*w+_*x*p,this._w=h*u*p+_*x*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],o=e[8],s=e[1],a=e[5],l=e[9],h=e[2],u=e[6],p=e[10],_=n+a+p;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(u-l)*x,this._y=(o-h)*x,this._z=(s-r)*x}else if(n>a&&n>p){const x=2*Math.sqrt(1+n-a-p);this._w=(u-l)/x,this._x=.25*x,this._y=(r+s)/x,this._z=(o+h)/x}else if(a>p){const x=2*Math.sqrt(1+a-n-p);this._w=(o-h)/x,this._x=(r+s)/x,this._y=.25*x,this._z=(l+u)/x}else{const x=2*Math.sqrt(1+p-n-a);this._w=(s-r)/x,this._x=(o+h)/x,this._y=(l+u)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(et(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,o=t._z,s=t._w,a=e._x,l=e._y,h=e._z,u=e._w;return this._x=n*u+s*a+r*h-o*l,this._y=r*u+s*l+o*a-n*h,this._z=o*u+s*h+n*l-r*a,this._w=s*u-n*a-r*l-o*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,o=this._z,s=this._w;let a=s*t._w+n*t._x+r*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const x=1-e;return this._w=x*s+e*this._w,this._x=x*n+e*this._x,this._y=x*r+e*this._y,this._z=x*o+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),p=Math.sin((1-e)*u)/h,_=Math.sin(e*u)/h;return this._w=s*p+this._w*_,this._x=n*p+this._x*_,this._y=r*p+this._y*_,this._z=o*p+this._z*_,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}V.prototype.isQuaternion=!0;class k{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(tt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(tt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*n+o[6]*r,this.y=o[1]*e+o[4]*n+o[7]*r,this.z=o[2]*e+o[5]*n+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=t.elements,s=1/(o[3]*e+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*n+o[8]*r+o[12])*s,this.y=(o[1]*e+o[5]*n+o[9]*r+o[13])*s,this.z=(o[2]*e+o[6]*n+o[10]*r+o[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,o=t.x,s=t.y,a=t.z,l=t.w,h=l*e+s*r-a*n,u=l*n+a*e-o*r,p=l*r+o*n-s*e,_=-o*e-s*n-a*r;return this.x=h*l+_*-o+u*-a-p*-s,this.y=u*l+_*-s+p*-o-h*-a,this.z=p*l+_*-a+h*-s-u*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r,this.y=o[1]*e+o[5]*n+o[9]*r,this.z=o[2]*e+o[6]*n+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,o=t.z,s=e.x,a=e.y,l=e.z;return this.x=r*l-o*a,this.y=o*s-n*l,this.z=n*a-r*s,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return mt.copy(this).projectOnVector(t),this.sub(mt)}reflect(t){return this.sub(mt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(et(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}k.prototype.isVector3=!0;const mt=new k,tt=new V;class _t{constructor(t=new k(1/0,1/0,1/0),e=new k(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.length;l<h;l+=3){const u=t[l],p=t[l+1],_=t[l+2];u<e&&(e=u),p<n&&(n=p),_<r&&(r=_),u>o&&(o=u),p>s&&(s=p),_>a&&(a=_)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.count;l<h;l++){const u=t.getX(l),p=t.getY(l),_=t.getZ(l);u<e&&(e=u),p<n&&(n=p),_<r&&(r=_),u>o&&(o=u),p>s&&(s=p),_>a&&(a=_)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Z.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),ct.copy(e.boundingBox),ct.applyMatrix4(t.matrixWorld),this.union(ct));const n=t.children;for(let r=0,o=n.length;r<o;r++)this.expandByObject(n[r]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Z),Z.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(at),_e.subVectors(this.max,at),rt.subVectors(t.a,at),yt.subVectors(t.b,at),At.subVectors(t.c,at),Gt.subVectors(yt,rt),Yt.subVectors(At,yt),Jt.subVectors(rt,At);let e=[0,-Gt.z,Gt.y,0,-Yt.z,Yt.y,0,-Jt.z,Jt.y,Gt.z,0,-Gt.x,Yt.z,0,-Yt.x,Jt.z,0,-Jt.x,-Gt.y,Gt.x,0,-Yt.y,Yt.x,0,-Jt.y,Jt.x,0];return!!Ae(e,rt,yt,At,_e)&&(e=[1,0,0,0,1,0,0,0,1],!!Ae(e,rt,yt,At,_e)&&(ke.crossVectors(Gt,Yt),e=[ke.x,ke.y,ke.z],Ae(e,rt,yt,At,_e)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Z.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Z).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Dt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Dt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Dt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Dt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Dt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Dt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Dt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Dt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Dt)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}_t.prototype.isBox3=!0;const Dt=[new k,new k,new k,new k,new k,new k,new k,new k],Z=new k,ct=new _t,rt=new k,yt=new k,At=new k,Gt=new k,Yt=new k,Jt=new k,at=new k,_e=new k,ke=new k,Le=new k;function Ae(i,t,e,n,r){for(let o=0,s=i.length-3;o<=s;o+=3){Le.fromArray(i,o);const a=r.x*Math.abs(Le.x)+r.y*Math.abs(Le.y)+r.z*Math.abs(Le.z),l=t.dot(Le),h=e.dot(Le),u=n.dot(Le);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const ze=new _t,Qe=new k,cn=new k,Ue=new k;class Ge{constructor(t=new k,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):ze.setFromPoints(t).getCenter(n);let r=0;for(let o=0,s=t.length;o<s;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Ue.subVectors(t,this.center);const e=Ue.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=.5*(n-this.radius);this.center.add(Ue.multiplyScalar(r/n)),this.radius+=r}return this}union(t){return cn.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Qe.copy(t.center).add(cn)),this.expandByPoint(Qe.copy(t.center).sub(cn)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Rn=new k,re=new k,fe=new k,we=new k,ln=new k,In=new k,Zn=new k;class gi{constructor(t=new k,e=new k(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Rn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Rn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Rn.copy(this.direction).multiplyScalar(e).add(this.origin),Rn.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){re.copy(t).add(e).multiplyScalar(.5),fe.copy(e).sub(t).normalize(),we.copy(this.origin).sub(re);const o=.5*t.distanceTo(e),s=-this.direction.dot(fe),a=we.dot(this.direction),l=-we.dot(fe),h=we.lengthSq(),u=Math.abs(1-s*s);let p,_,x,w;if(u>0)if(p=s*l-a,_=s*a-l,w=o*u,p>=0)if(_>=-w)if(_<=w){const A=1/u;p*=A,_*=A,x=p*(p+s*_+2*a)+_*(s*p+_+2*l)+h}else _=o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;else _=-o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;else _<=-w?(p=Math.max(0,-(-s*o+a)),_=p>0?-o:Math.min(Math.max(-o,-l),o),x=-p*p+_*(_+2*l)+h):_<=w?(p=0,_=Math.min(Math.max(-o,-l),o),x=_*(_+2*l)+h):(p=Math.max(0,-(s*o+a)),_=p>0?o:Math.min(Math.max(-o,-l),o),x=-p*p+_*(_+2*l)+h);else _=s>0?-o:o,p=Math.max(0,-(s*_+a)),x=-p*p+_*(_+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(p).add(this.origin),r&&r.copy(fe).multiplyScalar(_).add(re),x}intersectSphere(t,e){Rn.subVectors(t.center,this.origin);const n=Rn.dot(this.direction),r=Rn.dot(Rn)-n*n,o=t.radius*t.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=n-s,l=n+s;return a<0&&l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0?!0:t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,o,s,a,l;const h=1/this.direction.x,u=1/this.direction.y,p=1/this.direction.z,_=this.origin;return h>=0?(n=(t.min.x-_.x)*h,r=(t.max.x-_.x)*h):(n=(t.max.x-_.x)*h,r=(t.min.x-_.x)*h),u>=0?(o=(t.min.y-_.y)*u,s=(t.max.y-_.y)*u):(o=(t.max.y-_.y)*u,s=(t.min.y-_.y)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),p>=0?(a=(t.min.z-_.z)*p,l=(t.max.z-_.z)*p):(a=(t.max.z-_.z)*p,l=(t.min.z-_.z)*p),n>l||a>r?null:((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return this.intersectBox(t,Rn)!==null}intersectTriangle(t,e,n,r,o){ln.subVectors(e,t),In.subVectors(n,t),Zn.crossVectors(ln,In);let s,a=this.direction.dot(Zn);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}we.subVectors(this.origin,t);const l=s*this.direction.dot(In.crossVectors(we,In));if(l<0)return null;const h=s*this.direction.dot(ln.cross(we));if(h<0||l+h>a)return null;const u=-s*we.dot(Zn);return u<0?null:this.at(u/a,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h,u,p,_,x,w,A,C){const G=this.elements;return G[0]=t,G[4]=e,G[8]=n,G[12]=r,G[1]=o,G[5]=s,G[9]=a,G[13]=l,G[2]=h,G[6]=u,G[10]=p,G[14]=_,G[3]=x,G[7]=w,G[11]=A,G[15]=C,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new tn().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/xt.setFromMatrixColumn(t,0).length(),o=1/xt.setFromMatrixColumn(t,1).length(),s=1/xt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,o=t.z,s=Math.cos(n),a=Math.sin(n),l=Math.cos(r),h=Math.sin(r),u=Math.cos(o),p=Math.sin(o);if(t.order==="XYZ"){const _=s*u,x=s*p,w=a*u,A=a*p;e[0]=l*u,e[4]=-l*p,e[8]=h,e[1]=x+w*h,e[5]=_-A*h,e[9]=-a*l,e[2]=A-_*h,e[6]=w+x*h,e[10]=s*l}else if(t.order==="YXZ"){const _=l*u,x=l*p,w=h*u,A=h*p;e[0]=_+A*a,e[4]=w*a-x,e[8]=s*h,e[1]=s*p,e[5]=s*u,e[9]=-a,e[2]=x*a-w,e[6]=A+_*a,e[10]=s*l}else if(t.order==="ZXY"){const _=l*u,x=l*p,w=h*u,A=h*p;e[0]=_-A*a,e[4]=-s*p,e[8]=w+x*a,e[1]=x+w*a,e[5]=s*u,e[9]=A-_*a,e[2]=-s*h,e[6]=a,e[10]=s*l}else if(t.order==="ZYX"){const _=s*u,x=s*p,w=a*u,A=a*p;e[0]=l*u,e[4]=w*h-x,e[8]=_*h+A,e[1]=l*p,e[5]=A*h+_,e[9]=x*h-w,e[2]=-h,e[6]=a*l,e[10]=s*l}else if(t.order==="YZX"){const _=s*l,x=s*h,w=a*l,A=a*h;e[0]=l*u,e[4]=A-_*p,e[8]=w*p+x,e[1]=p,e[5]=s*u,e[9]=-a*u,e[2]=-h*u,e[6]=x*p+w,e[10]=_-A*p}else if(t.order==="XZY"){const _=s*l,x=s*h,w=a*l,A=a*h;e[0]=l*u,e[4]=-p,e[8]=h*u,e[1]=_*p+A,e[5]=s*u,e[9]=x*p-w,e[2]=w*p-x,e[6]=a*u,e[10]=A*p+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Rt,t,Qt)}lookAt(t,e,n){const r=this.elements;return oe.subVectors(t,e),oe.lengthSq()===0&&(oe.z=1),oe.normalize(),Wt.crossVectors(n,oe),Wt.lengthSq()===0&&(Math.abs(n.z)===1?oe.x+=1e-4:oe.z+=1e-4,oe.normalize(),Wt.crossVectors(n,oe)),Wt.normalize(),Zt.crossVectors(oe,Wt),r[0]=Wt.x,r[4]=Zt.x,r[8]=oe.x,r[1]=Wt.y,r[5]=Zt.y,r[9]=oe.y,r[2]=Wt.z,r[6]=Zt.z,r[10]=oe.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[4],l=n[8],h=n[12],u=n[1],p=n[5],_=n[9],x=n[13],w=n[2],A=n[6],C=n[10],G=n[14],K=n[3],it=n[7],ft=n[11],nt=n[15],gt=r[0],lt=r[4],dt=r[8],Ut=r[12],Ft=r[1],Et=r[5],Mt=r[9],Lt=r[13],Pt=r[2],ee=r[6],$t=r[10],zt=r[14],Xt=r[3],pe=r[7],be=r[11],Pe=r[15];return o[0]=s*gt+a*Ft+l*Pt+h*Xt,o[4]=s*lt+a*Et+l*ee+h*pe,o[8]=s*dt+a*Mt+l*$t+h*be,o[12]=s*Ut+a*Lt+l*zt+h*Pe,o[1]=u*gt+p*Ft+_*Pt+x*Xt,o[5]=u*lt+p*Et+_*ee+x*pe,o[9]=u*dt+p*Mt+_*$t+x*be,o[13]=u*Ut+p*Lt+_*zt+x*Pe,o[2]=w*gt+A*Ft+C*Pt+G*Xt,o[6]=w*lt+A*Et+C*ee+G*pe,o[10]=w*dt+A*Mt+C*$t+G*be,o[14]=w*Ut+A*Lt+C*zt+G*Pe,o[3]=K*gt+it*Ft+ft*Pt+nt*Xt,o[7]=K*lt+it*Et+ft*ee+nt*pe,o[11]=K*dt+it*Mt+ft*$t+nt*be,o[15]=K*Ut+it*Lt+ft*zt+nt*Pe,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],o=t[12],s=t[1],a=t[5],l=t[9],h=t[13],u=t[2],p=t[6],_=t[10],x=t[14];return t[3]*(+o*l*p-r*h*p-o*a*_+n*h*_+r*a*x-n*l*x)+t[7]*(+e*l*x-e*h*_+o*s*_-r*s*x+r*h*u-o*l*u)+t[11]*(+e*h*p-e*a*x-o*s*p+n*s*x+o*a*u-n*h*u)+t[15]*(-r*a*u-e*l*p+e*a*_+r*s*p-n*s*_+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=t[9],_=t[10],x=t[11],w=t[12],A=t[13],C=t[14],G=t[15],K=p*C*h-A*_*h+A*l*x-a*C*x-p*l*G+a*_*G,it=w*_*h-u*C*h-w*l*x+s*C*x+u*l*G-s*_*G,ft=u*A*h-w*p*h+w*a*x-s*A*x-u*a*G+s*p*G,nt=w*p*l-u*A*l-w*a*_+s*A*_+u*a*C-s*p*C,gt=e*K+n*it+r*ft+o*nt;if(gt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const lt=1/gt;return t[0]=K*lt,t[1]=(A*_*o-p*C*o-A*r*x+n*C*x+p*r*G-n*_*G)*lt,t[2]=(a*C*o-A*l*o+A*r*h-n*C*h-a*r*G+n*l*G)*lt,t[3]=(p*l*o-a*_*o-p*r*h+n*_*h+a*r*x-n*l*x)*lt,t[4]=it*lt,t[5]=(u*C*o-w*_*o+w*r*x-e*C*x-u*r*G+e*_*G)*lt,t[6]=(w*l*o-s*C*o-w*r*h+e*C*h+s*r*G-e*l*G)*lt,t[7]=(s*_*o-u*l*o+u*r*h-e*_*h-s*r*x+e*l*x)*lt,t[8]=ft*lt,t[9]=(w*p*o-u*A*o-w*n*x+e*A*x+u*n*G-e*p*G)*lt,t[10]=(s*A*o-w*a*o+w*n*h-e*A*h-s*n*G+e*a*G)*lt,t[11]=(u*a*o-s*p*o-u*n*h+e*p*h+s*n*x-e*a*x)*lt,t[12]=nt*lt,t[13]=(u*A*r-w*p*r+w*n*_-e*A*_-u*n*C+e*p*C)*lt,t[14]=(w*a*r-s*A*r-w*n*l+e*A*l+s*n*C-e*a*C)*lt,t[15]=(s*p*r-u*a*r+u*n*l-e*p*l-s*n*_+e*a*_)*lt,this}scale(t){const e=this.elements,n=t.x,r=t.y,o=t.z;return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),o=1-n,s=t.x,a=t.y,l=t.z,h=o*s,u=o*a;return this.set(h*s+n,h*a-r*l,h*l+r*a,0,h*a+r*l,u*a+n,u*l-r*s,0,h*l-r*a,u*l+r*s,o*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,o,s){return this.set(1,n,o,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,o=e._x,s=e._y,a=e._z,l=e._w,h=o+o,u=s+s,p=a+a,_=o*h,x=o*u,w=o*p,A=s*u,C=s*p,G=a*p,K=l*h,it=l*u,ft=l*p,nt=n.x,gt=n.y,lt=n.z;return r[0]=(1-(A+G))*nt,r[1]=(x+ft)*nt,r[2]=(w-it)*nt,r[3]=0,r[4]=(x-ft)*gt,r[5]=(1-(_+G))*gt,r[6]=(C+K)*gt,r[7]=0,r[8]=(w+it)*lt,r[9]=(C-K)*lt,r[10]=(1-(_+A))*lt,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let o=xt.set(r[0],r[1],r[2]).length();const s=xt.set(r[4],r[5],r[6]).length(),a=xt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],St.copy(this);const l=1/o,h=1/s,u=1/a;return St.elements[0]*=l,St.elements[1]*=l,St.elements[2]*=l,St.elements[4]*=h,St.elements[5]*=h,St.elements[6]*=h,St.elements[8]*=u,St.elements[9]*=u,St.elements[10]*=u,e.setFromRotationMatrix(St),n.x=o,n.y=s,n.z=a,this}makePerspective(t,e,n,r,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*o/(e-t),h=2*o/(n-r),u=(e+t)/(e-t),p=(n+r)/(n-r),_=-(s+o)/(s-o),x=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=_,a[14]=x,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,o,s){const a=this.elements,l=1/(e-t),h=1/(n-r),u=1/(s-o),p=(e+t)*l,_=(n+r)*h,x=(s+o)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-_,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-x,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}tn.prototype.isMatrix4=!0;const xt=new k,St=new tn,Rt=new k(0,0,0),Qt=new k(1,1,1),Wt=new k,Zt=new k,oe=new k,Me=new tn,Ee=new V;class Se{constructor(t=0,e=0,n=0,r=Se.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,o=r[0],s=r[4],a=r[8],l=r[1],h=r[5],u=r[9],p=r[2],_=r[6],x=r[10];switch(e){case"XYZ":this._y=Math.asin(et(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,x),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(_,h),this._z=0);break;case"YXZ":this._x=Math.asin(-et(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,x),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(et(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-p,x),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-et(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(et(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(a,x));break;case"XZY":this._z=Math.asin(-et(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(_,h),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-u,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Me.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Me,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Ee.setFromEuler(this),this.setFromQuaternion(Ee,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new k(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Se.prototype.isEuler=!0,Se.DefaultOrder="XYZ",Se.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ve{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}}let en=0;const dn=new k,Tn=new V,yn=new tn,Xn=new k,Pn=new k,Vi=new k,To=new V,oo=new k(1,0,0),Fn=new k(0,1,0),$o=new k(0,0,1),so={type:"added"},wo={type:"removed"};class kn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:en++}),this.uuid=J(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kn.DefaultUp.clone();const t=new k,e=new Se,n=new V,r=new k(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new tn},normalMatrix:{value:new F}}),this.matrix=new tn,this.matrixWorld=new tn,this.matrixAutoUpdate=kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ve,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.multiply(Tn),this}rotateOnWorldAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.premultiply(Tn),this}rotateX(t){return this.rotateOnAxis(oo,t)}rotateY(t){return this.rotateOnAxis(Fn,t)}rotateZ(t){return this.rotateOnAxis($o,t)}translateOnAxis(t,e){return dn.copy(t).applyQuaternion(this.quaternion),this.position.add(dn.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(oo,t)}translateY(t){return this.translateOnAxis(Fn,t)}translateZ(t){return this.translateOnAxis($o,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(yn.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Xn.copy(t):Xn.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Pn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yn.lookAt(Pn,Xn,this.up):yn.lookAt(Xn,Pn,this.up),this.quaternion.setFromRotationMatrix(yn),r&&(yn.extractRotation(r.matrixWorld),Tn.setFromRotationMatrix(yn),this.quaternion.premultiply(Tn.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(so)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(wo)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(wo)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),yn.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),yn.multiply(t.parent.matrixWorld)),t.applyMatrix4(yn),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,t,Vi),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,To,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const p=l[h];o(t.shapes,p)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(o(t.materials,this.material[l]));r.material=a}else r.material=o(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(t.animations,l))}}if(e){const a=s(t.geometries),l=s(t.materials),h=s(t.textures),u=s(t.images),p=s(t.shapes),_=s(t.skeletons),x=s(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),p.length>0&&(n.shapes=p),_.length>0&&(n.skeletons=_),x.length>0&&(n.animations=x)}return n.object=r,n;function s(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}kn.DefaultUp=new k(0,1,0),kn.DefaultMatrixAutoUpdate=!0,kn.prototype.isObject3D=!0;const jn=new k,Qi=new k,Yr=new k,Ri=new k,Mr=new k,Dr=new k,Qo=new k,ts=new k,So=new k,Eo=new k;class di{constructor(t=new k,e=new k,n=new k){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),jn.subVectors(t,e),r.cross(jn);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,n,r,o){jn.subVectors(r,e),Qi.subVectors(n,e),Yr.subVectors(t,e);const s=jn.dot(jn),a=jn.dot(Qi),l=jn.dot(Yr),h=Qi.dot(Qi),u=Qi.dot(Yr),p=s*h-a*a;if(p===0)return o.set(-2,-1,-1);const _=1/p,x=(h*l-a*u)*_,w=(s*u-a*l)*_;return o.set(1-x-w,w,x)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Ri),Ri.x>=0&&Ri.y>=0&&Ri.x+Ri.y<=1}static getUV(t,e,n,r,o,s,a,l){return this.getBarycoord(t,e,n,r,Ri),l.set(0,0),l.addScaledVector(o,Ri.x),l.addScaledVector(s,Ri.y),l.addScaledVector(a,Ri.z),l}static isFrontFacing(t,e,n,r){return jn.subVectors(n,e),Qi.subVectors(t,e),jn.cross(Qi).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return jn.subVectors(this.c,this.b),Qi.subVectors(this.a,this.b),.5*jn.cross(Qi).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(t){return di.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return di.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,o){return di.getUV(t,this.a,this.b,this.c,e,n,r,o)}containsPoint(t){return di.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return di.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,o=this.c;let s,a;Mr.subVectors(r,n),Dr.subVectors(o,n),ts.subVectors(t,n);const l=Mr.dot(ts),h=Dr.dot(ts);if(l<=0&&h<=0)return e.copy(n);So.subVectors(t,r);const u=Mr.dot(So),p=Dr.dot(So);if(u>=0&&p<=u)return e.copy(r);const _=l*p-u*h;if(_<=0&&l>=0&&u<=0)return s=l/(l-u),e.copy(n).addScaledVector(Mr,s);Eo.subVectors(t,o);const x=Mr.dot(Eo),w=Dr.dot(Eo);if(w>=0&&x<=w)return e.copy(o);const A=x*h-l*w;if(A<=0&&h>=0&&w<=0)return a=h/(h-w),e.copy(n).addScaledVector(Dr,a);const C=u*w-x*p;if(C<=0&&p-u>=0&&x-w>=0)return Qo.subVectors(o,r),a=(p-u)/(p-u+(x-w)),e.copy(r).addScaledVector(Qo,a);const G=1/(C+A+_);return s=A*G,a=_*G,e.copy(n).addScaledVector(Mr,s).addScaledVector(Dr,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let es=0;class Ii extends D{constructor(){super(),Object.defineProperty(this,"id",{value:es++}),this.uuid=J(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1;continue}const r=this[e];r!==void 0?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(n.blending=this.blending),this.side!==0&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),e){const o=r(t.textures),s=r(t.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const r=e.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=e[o].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}Ii.prototype.isMaterial=!0;const _r={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Li={h:0,s:0,l:0},Fr={h:0,s:0,l:0};function Ao(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<.16666666666666666?i+6*(t-i)*e:e<.5?t:e<.6666666666666666?i+6*(t-i)*(.6666666666666666-e):i}function ao(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function Mo(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}class fn{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=pt(t,1),e=et(e,0,1),n=et(n,0,1),e===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,o=2*n-r;this.r=Ao(o,r,t+.3333333333333333),this.g=Ao(o,r,t),this.b=Ao(o,r,t-.3333333333333333)}return this}setStyle(t){function e(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let r;const o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const a=parseFloat(r[1])/360,l=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,l,h)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=n[1],o=r.length;if(o===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=_r[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=ao(t.r),this.g=ao(t.g),this.b=ao(t.b),this}copyLinearToSRGB(t){return this.r=Mo(t.r),this.g=Mo(t.g),this.b=Mo(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,r=this.b,o=Math.max(e,n,r),s=Math.min(e,n,r);let a,l;const h=(s+o)/2;if(s===o)a=0,l=0;else{const u=o-s;switch(l=h<=.5?u/(o+s):u/(2-o-s),o){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;case r:a=(e-n)/u+4}a/=6}return t.h=a,t.s=l,t.l=h,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Li),Li.h+=t,Li.s+=e,Li.l+=n,this.setHSL(Li.h,Li.s,Li.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Li),t.getHSL(Fr);const n=Nt(Li.h,Fr.h,e),r=Nt(Li.s,Fr.s,e),o=Nt(Li.l,Fr.l,e);return this.setHSL(n,r,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}fn.NAMES=_r,fn.prototype.isColor=!0,fn.prototype.r=1,fn.prototype.g=1,fn.prototype.b=1;class tr extends Ii{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}tr.prototype.isMeshBasicMaterial=!0;const Mn=new k,Co=new I;class Yn{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new fn),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new I),e[n++]=s.x,e[n++]=s.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new k),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Ot),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)Co.fromBufferAttribute(this,e),Co.applyMatrix3(t),this.setXY(e,Co.x,Co.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)Mn.fromBufferAttribute(this,e),Mn.applyMatrix3(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyMatrix4(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyNormalMatrix(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.transformDirection(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==35044&&(t.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(t.updateRange=this.updateRange),t}}Yn.prototype.isBufferAttribute=!0;class Ss extends Yn{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class ma extends Yn{constructor(t,e,n){super(new Int32Array(t),e,n)}}class Ro extends Yn{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends Yn{constructor(i,t,e){super(new Uint16Array(i),t,e)}}).prototype.isFloat16BufferAttribute=!0;class An extends Yn{constructor(t,e,n){super(new Float32Array(t),e,n)}}function Es(i){if(i.length===0)return-1/0;let t=i[0];for(let e=1,n=i.length;e<n;++e)i[e]>t&&(t=i[e]);return t}let ns=0;const wi=new tn,is=new kn,yr=new k,Ni=new _t,lo=new _t,vi=new k;class Wn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:ns++}),this.uuid=J(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Es(t)>65535?Ro:Ss)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new F().getNormalMatrix(t);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return wi.makeRotationFromQuaternion(t),this.applyMatrix4(wi),this}rotateX(t){return wi.makeRotationX(t),this.applyMatrix4(wi),this}rotateY(t){return wi.makeRotationY(t),this.applyMatrix4(wi),this}rotateZ(t){return wi.makeRotationZ(t),this.applyMatrix4(wi),this}translate(t,e,n){return wi.makeTranslation(t,e,n),this.applyMatrix4(wi),this}scale(t,e,n){return wi.makeScale(t,e,n),this.applyMatrix4(wi),this}lookAt(t){return is.lookAt(t),is.updateMatrix(),this.applyMatrix4(is.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yr).negate(),this.translate(yr.x,yr.y,yr.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];e.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new An(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _t);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const o=e[n];Ni.setFromBufferAttribute(o),this.morphTargetsRelative?(vi.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(vi),vi.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(vi)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ge);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new k,1/0);if(t){const n=this.boundingSphere.center;if(Ni.setFromBufferAttribute(t),e)for(let o=0,s=e.length;o<s;o++){const a=e[o];lo.setFromBufferAttribute(a),this.morphTargetsRelative?(vi.addVectors(Ni.min,lo.min),Ni.expandByPoint(vi),vi.addVectors(Ni.max,lo.max),Ni.expandByPoint(vi)):(Ni.expandByPoint(lo.min),Ni.expandByPoint(lo.max))}Ni.getCenter(n);let r=0;for(let o=0,s=t.count;o<s;o++)vi.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(vi));if(e)for(let o=0,s=e.length;o<s;o++){const a=e[o],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)vi.fromBufferAttribute(a,h),l&&(yr.fromBufferAttribute(t,h),vi.add(yr)),r=Math.max(r,n.distanceToSquared(vi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,o=e.normal.array,s=e.uv.array,a=r.length/3;e.tangent===void 0&&this.setAttribute("tangent",new Yn(new Float32Array(4*a),4));const l=e.tangent.array,h=[],u=[];for(let Ft=0;Ft<a;Ft++)h[Ft]=new k,u[Ft]=new k;const p=new k,_=new k,x=new k,w=new I,A=new I,C=new I,G=new k,K=new k;function it(Ft,Et,Mt){p.fromArray(r,3*Ft),_.fromArray(r,3*Et),x.fromArray(r,3*Mt),w.fromArray(s,2*Ft),A.fromArray(s,2*Et),C.fromArray(s,2*Mt),_.sub(p),x.sub(p),A.sub(w),C.sub(w);const Lt=1/(A.x*C.y-C.x*A.y);isFinite(Lt)&&(G.copy(_).multiplyScalar(C.y).addScaledVector(x,-A.y).multiplyScalar(Lt),K.copy(x).multiplyScalar(A.x).addScaledVector(_,-C.x).multiplyScalar(Lt),h[Ft].add(G),h[Et].add(G),h[Mt].add(G),u[Ft].add(K),u[Et].add(K),u[Mt].add(K))}let ft=this.groups;ft.length===0&&(ft=[{start:0,count:n.length}]);for(let Ft=0,Et=ft.length;Ft<Et;++Ft){const Mt=ft[Ft],Lt=Mt.start;for(let Pt=Lt,ee=Lt+Mt.count;Pt<ee;Pt+=3)it(n[Pt+0],n[Pt+1],n[Pt+2])}const nt=new k,gt=new k,lt=new k,dt=new k;function Ut(Ft){lt.fromArray(o,3*Ft),dt.copy(lt);const Et=h[Ft];nt.copy(Et),nt.sub(lt.multiplyScalar(lt.dot(Et))).normalize(),gt.crossVectors(dt,Et);const Mt=gt.dot(u[Ft])<0?-1:1;l[4*Ft]=nt.x,l[4*Ft+1]=nt.y,l[4*Ft+2]=nt.z,l[4*Ft+3]=Mt}for(let Ft=0,Et=ft.length;Ft<Et;++Ft){const Mt=ft[Ft],Lt=Mt.start;for(let Pt=Lt,ee=Lt+Mt.count;Pt<ee;Pt+=3)Ut(n[Pt+0]),Ut(n[Pt+1]),Ut(n[Pt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Yn(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let _=0,x=n.count;_<x;_++)n.setXYZ(_,0,0,0);const r=new k,o=new k,s=new k,a=new k,l=new k,h=new k,u=new k,p=new k;if(t)for(let _=0,x=t.count;_<x;_+=3){const w=t.getX(_+0),A=t.getX(_+1),C=t.getX(_+2);r.fromBufferAttribute(e,w),o.fromBufferAttribute(e,A),s.fromBufferAttribute(e,C),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),a.fromBufferAttribute(n,w),l.fromBufferAttribute(n,A),h.fromBufferAttribute(n,C),a.add(u),l.add(u),h.add(u),n.setXYZ(w,a.x,a.y,a.z),n.setXYZ(A,l.x,l.y,l.z),n.setXYZ(C,h.x,h.y,h.z)}else for(let _=0,x=e.count;_<x;_+=3)r.fromBufferAttribute(e,_+0),o.fromBufferAttribute(e,_+1),s.fromBufferAttribute(e,_+2),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),n.setXYZ(_+0,u.x,u.y,u.z),n.setXYZ(_+1,u.x,u.y,u.z),n.setXYZ(_+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(t.attributes[r]===void 0)continue;const o=n[r].array,s=t.attributes[r],a=s.array,l=s.itemSize*e,h=Math.min(a.length,o.length-l);for(let u=0,p=l;u<h;u++,p++)o[p]=a[u]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)vi.fromBufferAttribute(t,e),vi.normalize(),t.setXYZ(e,vi.x,vi.y,vi.z)}toNonIndexed(){function t(a,l){const h=a.array,u=a.itemSize,p=a.normalized,_=new h.constructor(l.length*u);let x=0,w=0;for(let A=0,C=l.length;A<C;A++){x=a.isInterleavedBufferAttribute?l[A]*a.data.stride+a.offset:l[A]*u;for(let G=0;G<u;G++)_[w++]=h[x++]}return new Yn(_,u,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Wn,n=this.index.array,r=this.attributes;for(const a in r){const l=t(r[a],n);e.setAttribute(a,l)}const o=this.morphAttributes;for(const a in o){const l=[],h=o[a];for(let u=0,p=h.length;u<p;u++){const _=t(h[u],n);l.push(_)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const h=s[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(t[h]=l[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const h=n[l];t.data.attributes[l]=h.toJSON(t.data)}const r={};let o=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let p=0,_=h.length;p<_;p++){const x=h[p];u.push(x.toJSON(t.data))}u.length>0&&(r[l]=u,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new Wn().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const r=t.attributes;for(const h in r){const u=r[h];this.setAttribute(h,u.clone(e))}const o=t.morphAttributes;for(const h in o){const u=[],p=o[h];for(let _=0,x=p.length;_<x;_++)u.push(p[_].clone(e));this.morphAttributes[h]=u}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let h=0,u=s.length;h<u;h++){const p=s[h];this.addGroup(p.start,p.count,p.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Wn.prototype.isBufferGeometry=!0;const Io=new tn,Br=new gi,Po=new Ge,Cr=new k,Rr=new k,ar=new k,Oo=new k,Lo=new k,No=new k,Y=new k,g=new k,m=new k,y=new I,N=new I,q=new I,ht=new k,bt=new k;class wt extends kn{constructor(t=new Wn,e=new tr){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Po.copy(n.boundingSphere),Po.applyMatrix4(o),t.ray.intersectsSphere(Po)===!1)||(Io.copy(o).invert(),Br.copy(t.ray).applyMatrix4(Io),n.boundingBox!==null&&Br.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,u=n.morphTargetsRelative,p=n.attributes.uv,_=n.attributes.uv2,x=n.groups,w=n.drawRange;if(a!==null)if(Array.isArray(r))for(let A=0,C=x.length;A<C;A++){const G=x[A],K=r[G.materialIndex];for(let it=Math.max(G.start,w.start),ft=Math.min(G.start+G.count,w.start+w.count);it<ft;it+=3){const nt=a.getX(it),gt=a.getX(it+1),lt=a.getX(it+2);s=Kt(this,K,t,Br,l,h,u,p,_,nt,gt,lt),s&&(s.faceIndex=Math.floor(it/3),s.face.materialIndex=G.materialIndex,e.push(s))}}else for(let A=Math.max(0,w.start),C=Math.min(a.count,w.start+w.count);A<C;A+=3){const G=a.getX(A),K=a.getX(A+1),it=a.getX(A+2);s=Kt(this,r,t,Br,l,h,u,p,_,G,K,it),s&&(s.faceIndex=Math.floor(A/3),e.push(s))}else if(l!==void 0)if(Array.isArray(r))for(let A=0,C=x.length;A<C;A++){const G=x[A],K=r[G.materialIndex];for(let it=Math.max(G.start,w.start),ft=Math.min(G.start+G.count,w.start+w.count);it<ft;it+=3)s=Kt(this,K,t,Br,l,h,u,p,_,it,it+1,it+2),s&&(s.faceIndex=Math.floor(it/3),s.face.materialIndex=G.materialIndex,e.push(s))}else for(let A=Math.max(0,w.start),C=Math.min(l.count,w.start+w.count);A<C;A+=3)s=Kt(this,r,t,Br,l,h,u,p,_,A,A+1,A+2),s&&(s.faceIndex=Math.floor(A/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Kt(i,t,e,n,r,o,s,a,l,h,u,p){Cr.fromBufferAttribute(r,h),Rr.fromBufferAttribute(r,u),ar.fromBufferAttribute(r,p);const _=i.morphTargetInfluences;if(t.morphTargets&&o&&_){Y.set(0,0,0),g.set(0,0,0),m.set(0,0,0);for(let w=0,A=o.length;w<A;w++){const C=_[w],G=o[w];C!==0&&(Oo.fromBufferAttribute(G,h),Lo.fromBufferAttribute(G,u),No.fromBufferAttribute(G,p),s?(Y.addScaledVector(Oo,C),g.addScaledVector(Lo,C),m.addScaledVector(No,C)):(Y.addScaledVector(Oo.sub(Cr),C),g.addScaledVector(Lo.sub(Rr),C),m.addScaledVector(No.sub(ar),C)))}Cr.add(Y),Rr.add(g),ar.add(m)}i.isSkinnedMesh&&(i.boneTransform(h,Cr),i.boneTransform(u,Rr),i.boneTransform(p,ar));const x=function(w,A,C,G,K,it,ft,nt){let gt;if(gt=A.side===1?G.intersectTriangle(ft,it,K,!0,nt):G.intersectTriangle(K,it,ft,A.side!==2,nt),gt===null)return null;bt.copy(nt),bt.applyMatrix4(w.matrixWorld);const lt=C.ray.origin.distanceTo(bt);return lt<C.near||lt>C.far?null:{distance:lt,point:bt.clone(),object:w}}(i,t,e,n,Cr,Rr,ar,ht);if(x){a&&(y.fromBufferAttribute(a,h),N.fromBufferAttribute(a,u),q.fromBufferAttribute(a,p),x.uv=di.getUV(ht,Cr,Rr,ar,y,N,q,new I)),l&&(y.fromBufferAttribute(l,h),N.fromBufferAttribute(l,u),q.fromBufferAttribute(l,p),x.uv2=di.getUV(ht,Cr,Rr,ar,y,N,q,new I));const w={a:h,b:u,c:p,normal:new k,materialIndex:0};di.getNormal(Cr,Rr,ar,w.normal),x.face=w}return x}wt.prototype.isMesh=!0;class ne extends Wn{constructor(t=1,e=1,n=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],h=[],u=[],p=[];let _=0,x=0;function w(A,C,G,K,it,ft,nt,gt,lt,dt,Ut){const Ft=ft/lt,Et=nt/dt,Mt=ft/2,Lt=nt/2,Pt=gt/2,ee=lt+1,$t=dt+1;let zt=0,Xt=0;const pe=new k;for(let be=0;be<$t;be++){const Pe=be*Et-Lt;for(let Ct=0;Ct<ee;Ct++){const Bt=Ct*Ft-Mt;pe[A]=Bt*K,pe[C]=Pe*it,pe[G]=Pt,h.push(pe.x,pe.y,pe.z),pe[A]=0,pe[C]=0,pe[G]=gt>0?1:-1,u.push(pe.x,pe.y,pe.z),p.push(Ct/lt),p.push(1-be/dt),zt+=1}}for(let be=0;be<dt;be++)for(let Pe=0;Pe<lt;Pe++){const Ct=_+Pe+ee*be,Bt=_+Pe+ee*(be+1),ve=_+(Pe+1)+ee*(be+1),le=_+(Pe+1)+ee*be;l.push(Ct,Bt,le),l.push(Bt,ve,le),Xt+=6}a.addGroup(x,Xt,Ut),x+=Xt,_+=zt}w("z","y","x",-1,-1,n,e,t,s,o,0),w("z","y","x",1,-1,n,e,-t,s,o,1),w("x","z","y",1,1,t,n,e,r,s,2),w("x","z","y",1,-1,t,n,-e,r,s,3),w("x","y","z",1,-1,t,e,n,r,o,4),w("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(l),this.setAttribute("position",new An(h,3)),this.setAttribute("normal",new An(u,3)),this.setAttribute("uv",new An(p,2))}static fromJSON(t){return new ne(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Fe(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[e][n]=r.clone():Array.isArray(r)?t[e][n]=r.slice():t[e][n]=r}}return t}function Te(i){const t={};for(let e=0;e<i.length;e++){const n=Fe(i[e]);for(const r in n)t[r]=n[r]}return t}const $e={clone:Fe,merge:Te};class hn extends Ii{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Fe(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?e.uniforms[r]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?e.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?e.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?e.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?e.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?e.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?e.uniforms[r]={type:"m4",value:o.toArray()}:e.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}hn.prototype.isShaderMaterial=!0;class vn extends kn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tn,this.projectionMatrix=new tn,this.projectionMatrixInverse=new tn}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}vn.prototype.isCamera=!0;class un extends vn{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*X*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*z*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*X*Math.atan(Math.tan(.5*z*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,o,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*z*this.fov)/this.zoom,n=2*e,r=this.aspect*n,o=-.5*r;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,h=s.fullHeight;o+=s.offsetX*r/l,e-=s.offsetY*n/h,r*=s.width/l,n*=s.height/h}const a=this.filmOffset;a!==0&&(o+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}un.prototype.isPerspectiveCamera=!0;class Kn extends kn{constructor(t,e,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new un(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new k(1,0,0)),this.add(r);const o=new un(90,1,t,e);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new k(-1,0,0)),this.add(o);const s=new un(90,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new k(0,1,0)),this.add(s);const a=new un(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new k(0,-1,0)),this.add(a);const l=new un(90,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new k(0,0,1)),this.add(l);const h=new un(90,1,t,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new k(0,0,-1)),this.add(h)}update(t,e){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,o,s,a,l,h]=this.children,u=t.xr.enabled,p=t.getRenderTarget();t.xr.enabled=!1;const _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=_,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(p),t.xr.enabled=u}}class _i extends Q{constructor(t,e,n,r,o,s,a,l,h,u){super(t=t!==void 0?t:[],e=e!==void 0?e:301,n,r,o,s,a=a!==void 0?a:1022,l,h,u),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}_i.prototype.isCubeTexture=!0;class yi extends Vt{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new _i(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.generateMipmaps=e.generateMipmaps!==void 0&&e.generateMipmaps,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:1006,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=1023,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ne(5,5,5),o=new hn({name:"CubemapFromEquirect",uniforms:Fe(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=e;const s=new wt(r,o),a=e.minFilter;return e.minFilter===1008&&(e.minFilter=1006),new Kn(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){const o=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(o)}}yi.prototype.isWebGLCubeRenderTarget=!0;const ni=new k,Bi=new k,ki=new F;class ui{constructor(t=new k(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=ni.subVectors(n,e).cross(Bi.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(ni),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(n).multiplyScalar(o).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||ki.getNormalMatrix(t),r=this.coplanarPoint(ni).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}ui.prototype.isPlane=!0;const Si=new Ge,xr=new k;class kr{constructor(t=new ui,e=new ui,n=new ui,r=new ui,o=new ui,s=new ui){this.planes=[t,e,n,r,o,s]}set(t,e,n,r,o,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],o=n[1],s=n[2],a=n[3],l=n[4],h=n[5],u=n[6],p=n[7],_=n[8],x=n[9],w=n[10],A=n[11],C=n[12],G=n[13],K=n[14],it=n[15];return e[0].setComponents(a-r,p-l,A-_,it-C).normalize(),e[1].setComponents(a+r,p+l,A+_,it+C).normalize(),e[2].setComponents(a+o,p+h,A+x,it+G).normalize(),e[3].setComponents(a-o,p-h,A-x,it-G).normalize(),e[4].setComponents(a-s,p-u,A-w,it-K).normalize(),e[5].setComponents(a+s,p+u,A+w,it+K).normalize(),this}intersectsObject(t){const e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Si.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Si)}intersectsSprite(t){return Si.center.set(0,0,0),Si.radius=.7071067811865476,Si.applyMatrix4(t.matrixWorld),this.intersectsSphere(Si)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(xr.x=r.normal.x>0?t.max.x:t.min.x,xr.y=r.normal.y>0?t.max.y:t.min.y,xr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(xr)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function rs(){let i=null,t=!1,e=null,n=null;function r(o,s){e(o,s),n=i.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){i=o}}}function os(i,t){const e=t.isWebGL2,n=new WeakMap;return{get:function(r){return r.isInterleavedBufferAttribute&&(r=r.data),n.get(r)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);const o=n.get(r);o&&(i.deleteBuffer(o.buffer),n.delete(r))},update:function(r,o){if(r.isGLBufferAttribute){const a=n.get(r);return void((!a||a.version<r.version)&&n.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version}))}r.isInterleavedBufferAttribute&&(r=r.data);const s=n.get(r);s===void 0?n.set(r,function(a,l){const h=a.array,u=a.usage,p=i.createBuffer();i.bindBuffer(l,p),i.bufferData(l,h,u),a.onUploadCallback();let _=5126;return h instanceof Float32Array?_=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?a.isFloat16BufferAttribute?e?_=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):_=5123:h instanceof Int16Array?_=5122:h instanceof Uint32Array?_=5125:h instanceof Int32Array?_=5124:h instanceof Int8Array?_=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(_=5121),{buffer:p,type:_,bytesPerElement:h.BYTES_PER_ELEMENT,version:a.version}}(r,o)):s.version<r.version&&(function(a,l,h){const u=l.array,p=l.updateRange;i.bindBuffer(h,a),p.count===-1?i.bufferSubData(h,0,u):(e?i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u,p.offset,p.count):i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u.subarray(p.offset,p.offset+p.count)),p.count=-1)}(s.buffer,r,o),s.version=r.version)}}}class Ir extends Wn{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const o=t/2,s=e/2,a=Math.floor(n),l=Math.floor(r),h=a+1,u=l+1,p=t/a,_=e/l,x=[],w=[],A=[],C=[];for(let G=0;G<u;G++){const K=G*_-s;for(let it=0;it<h;it++){const ft=it*p-o;w.push(ft,-K,0),A.push(0,0,1),C.push(it/a),C.push(1-G/l)}}for(let G=0;G<l;G++)for(let K=0;K<a;K++){const it=K+h*G,ft=K+h*(G+1),nt=K+1+h*(G+1),gt=K+1+h*G;x.push(it,ft,gt),x.push(ft,nt,gt)}this.setIndex(x),this.setAttribute("position",new An(w,3)),this.setAttribute("normal",new An(A,3)),this.setAttribute("uv",new An(C,2))}static fromJSON(t){return new Ir(t.width,t.height,t.widthSegments,t.heightSegments)}}const On={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},sn={common:{diffuse:{value:new fn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new F},uv2Transform:{value:new F},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new I(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new F}},sprite:{diffuse:{value:new fn(16777215)},opacity:{value:1},center:{value:new I(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new F}}},Pr={basic:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.fog]),vertexShader:On.meshbasic_vert,fragmentShader:On.meshbasic_frag},lambert:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshlambert_vert,fragmentShader:On.meshlambert_frag},phong:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:On.meshphong_vert,fragmentShader:On.meshphong_frag},standard:{uniforms:Te([sn.common,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.roughnessmap,sn.metalnessmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag},toon:{uniforms:Te([sn.common,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.gradientmap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshtoon_vert,fragmentShader:On.meshtoon_frag},matcap:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,{matcap:{value:null}}]),vertexShader:On.meshmatcap_vert,fragmentShader:On.meshmatcap_frag},points:{uniforms:Te([sn.points,sn.fog]),vertexShader:On.points_vert,fragmentShader:On.points_frag},dashed:{uniforms:Te([sn.common,sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:On.linedashed_vert,fragmentShader:On.linedashed_frag},depth:{uniforms:Te([sn.common,sn.displacementmap]),vertexShader:On.depth_vert,fragmentShader:On.depth_frag},normal:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,{opacity:{value:1}}]),vertexShader:On.normal_vert,fragmentShader:On.normal_frag},sprite:{uniforms:Te([sn.sprite,sn.fog]),vertexShader:On.sprite_vert,fragmentShader:On.sprite_frag},background:{uniforms:{uvTransform:{value:new F},t2D:{value:null}},vertexShader:On.background_vert,fragmentShader:On.background_frag},cube:{uniforms:Te([sn.envmap,{opacity:{value:1}}]),vertexShader:On.cube_vert,fragmentShader:On.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:On.equirect_vert,fragmentShader:On.equirect_frag},distanceRGBA:{uniforms:Te([sn.common,sn.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:On.distanceRGBA_vert,fragmentShader:On.distanceRGBA_frag},shadow:{uniforms:Te([sn.lights,sn.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:On.shadow_vert,fragmentShader:On.shadow_frag}};function Qh(i,t,e,n,r){const o=new fn(0);let s,a,l=0,h=null,u=0,p=null;function _(x,w){e.buffers.color.setClear(x.r,x.g,x.b,w,r)}return{getClearColor:function(){return o},setClearColor:function(x,w=1){o.set(x),l=w,_(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,_(o,l)},render:function(x,w){let A=!1,C=w.isScene===!0?w.background:null;C&&C.isTexture&&(C=t.get(C));const G=i.xr,K=G.getSession&&G.getSession();K&&K.environmentBlendMode==="additive"&&(C=null),C===null?_(o,l):C&&C.isColor&&(_(C,1),A=!0),(i.autoClear||A)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),C&&(C.isCubeTexture||C.mapping===306)?(a===void 0&&(a=new wt(new ne(1,1,1),new hn({name:"BackgroundCubeMaterial",uniforms:Fe(Pr.cube.uniforms),vertexShader:Pr.cube.vertexShader,fragmentShader:Pr.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(it,ft,nt){this.matrixWorld.copyPosition(nt.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),a.material.uniforms.envMap.value=C,a.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C._needsFlipEnvMap?-1:1,h===C&&u===C.version&&p===i.toneMapping||(a.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(a,a.geometry,a.material,0,0,null)):C&&C.isTexture&&(s===void 0&&(s=new wt(new Ir(2,2),new hn({name:"BackgroundMaterial",uniforms:Fe(Pr.background.uniforms),vertexShader:Pr.background.vertexShader,fragmentShader:Pr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=C,C.matrixAutoUpdate===!0&&C.updateMatrix(),s.material.uniforms.uvTransform.value.copy(C.matrix),h===C&&u===C.version&&p===i.toneMapping||(s.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(s,s.geometry,s.material,0,0,null))}}}function ho(i,t,e,n){const r=i.getParameter(34921),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),s=n.isWebGL2||o!==null,a={},l=_(null);let h=l;function u(ft){return n.isWebGL2?i.bindVertexArray(ft):o.bindVertexArrayOES(ft)}function p(ft){return n.isWebGL2?i.deleteVertexArray(ft):o.deleteVertexArrayOES(ft)}function _(ft){const nt=[],gt=[],lt=[];for(let dt=0;dt<r;dt++)nt[dt]=0,gt[dt]=0,lt[dt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:nt,enabledAttributes:gt,attributeDivisors:lt,object:ft,attributes:{},index:null}}function x(){const ft=h.newAttributes;for(let nt=0,gt=ft.length;nt<gt;nt++)ft[nt]=0}function w(ft){A(ft,0)}function A(ft,nt){const gt=h.newAttributes,lt=h.enabledAttributes,dt=h.attributeDivisors;gt[ft]=1,lt[ft]===0&&(i.enableVertexAttribArray(ft),lt[ft]=1),dt[ft]!==nt&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ft,nt),dt[ft]=nt)}function C(){const ft=h.newAttributes,nt=h.enabledAttributes;for(let gt=0,lt=nt.length;gt<lt;gt++)nt[gt]!==ft[gt]&&(i.disableVertexAttribArray(gt),nt[gt]=0)}function G(ft,nt,gt,lt,dt,Ut){n.isWebGL2!==!0||gt!==5124&&gt!==5125?i.vertexAttribPointer(ft,nt,gt,lt,dt,Ut):i.vertexAttribIPointer(ft,nt,gt,dt,Ut)}function K(){it(),h!==l&&(h=l,u(h.object))}function it(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(ft,nt,gt,lt,dt){let Ut=!1;if(s){const Ft=function(Et,Mt,Lt){const Pt=Lt.wireframe===!0;let ee=a[Et.id];ee===void 0&&(ee={},a[Et.id]=ee);let $t=ee[Mt.id];$t===void 0&&($t={},ee[Mt.id]=$t);let zt=$t[Pt];return zt===void 0&&(zt=_(n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()),$t[Pt]=zt),zt}(lt,gt,nt);h!==Ft&&(h=Ft,u(h.object)),Ut=function(Et,Mt){const Lt=h.attributes,Pt=Et.attributes;let ee=0;for(const $t in Pt){const zt=Lt[$t],Xt=Pt[$t];if(zt===void 0||zt.attribute!==Xt||zt.data!==Xt.data)return!0;ee++}return h.attributesNum!==ee||h.index!==Mt}(lt,dt),Ut&&function(Et,Mt){const Lt={},Pt=Et.attributes;let ee=0;for(const $t in Pt){const zt=Pt[$t],Xt={};Xt.attribute=zt,zt.data&&(Xt.data=zt.data),Lt[$t]=Xt,ee++}h.attributes=Lt,h.attributesNum=ee,h.index=Mt}(lt,dt)}else{const Ft=nt.wireframe===!0;h.geometry===lt.id&&h.program===gt.id&&h.wireframe===Ft||(h.geometry=lt.id,h.program=gt.id,h.wireframe=Ft,Ut=!0)}ft.isInstancedMesh===!0&&(Ut=!0),dt!==null&&e.update(dt,34963),Ut&&(function(Ft,Et,Mt,Lt){if(n.isWebGL2===!1&&(Ft.isInstancedMesh||Lt.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();const Pt=Lt.attributes,ee=Mt.getAttributes(),$t=Et.defaultAttributeValues;for(const zt in ee){const Xt=ee[zt];if(Xt>=0){const pe=Pt[zt];if(pe!==void 0){const be=pe.normalized,Pe=pe.itemSize,Ct=e.get(pe);if(Ct===void 0)continue;const Bt=Ct.buffer,ve=Ct.type,le=Ct.bytesPerElement;if(pe.isInterleavedBufferAttribute){const se=pe.data,Ie=se.stride,De=pe.offset;se&&se.isInstancedInterleavedBuffer?(A(Xt,se.meshPerAttribute),Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=se.meshPerAttribute*se.count)):w(Xt),i.bindBuffer(34962,Bt),G(Xt,Pe,ve,be,Ie*le,De*le)}else pe.isInstancedBufferAttribute?(A(Xt,pe.meshPerAttribute),Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=pe.meshPerAttribute*pe.count)):w(Xt),i.bindBuffer(34962,Bt),G(Xt,Pe,ve,be,0,0)}else if(zt==="instanceMatrix"){const be=e.get(Ft.instanceMatrix);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;A(Xt+0,1),A(Xt+1,1),A(Xt+2,1),A(Xt+3,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Xt+0,4,Ct,!1,64,0),i.vertexAttribPointer(Xt+1,4,Ct,!1,64,16),i.vertexAttribPointer(Xt+2,4,Ct,!1,64,32),i.vertexAttribPointer(Xt+3,4,Ct,!1,64,48)}else if(zt==="instanceColor"){const be=e.get(Ft.instanceColor);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;A(Xt,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Xt,3,Ct,!1,12,0)}else if($t!==void 0){const be=$t[zt];if(be!==void 0)switch(be.length){case 2:i.vertexAttrib2fv(Xt,be);break;case 3:i.vertexAttrib3fv(Xt,be);break;case 4:i.vertexAttrib4fv(Xt,be);break;default:i.vertexAttrib1fv(Xt,be)}}}}C()}(ft,nt,gt,lt),dt!==null&&i.bindBuffer(34963,e.get(dt).buffer))},reset:K,resetDefaultState:it,dispose:function(){K();for(const ft in a){const nt=a[ft];for(const gt in nt){const lt=nt[gt];for(const dt in lt)p(lt[dt].object),delete lt[dt];delete nt[gt]}delete a[ft]}},releaseStatesOfGeometry:function(ft){if(a[ft.id]===void 0)return;const nt=a[ft.id];for(const gt in nt){const lt=nt[gt];for(const dt in lt)p(lt[dt].object),delete lt[dt];delete nt[gt]}delete a[ft.id]},releaseStatesOfProgram:function(ft){for(const nt in a){const gt=a[nt];if(gt[ft.id]===void 0)continue;const lt=gt[ft.id];for(const dt in lt)p(lt[dt].object),delete lt[dt];delete gt[ft.id]}},initAttributes:x,enableAttribute:w,disableUnusedAttributes:C}}function ss(i,t,e,n){const r=n.isWebGL2;let o;this.setMode=function(s){o=s},this.render=function(s,a){i.drawArrays(o,s,a),e.update(a,o,1)},this.renderInstances=function(s,a,l){if(l===0)return;let h,u;if(r)h=i,u="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",h===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](o,s,a,l),e.update(a,o,l)}}function tu(i,t,e){let n;function r(ft){if(ft==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ft="mediump"}return ft==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext;let s=e.precision!==void 0?e.precision:"highp";const a=r(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||t.has("WEBGL_draw_buffers"),h=e.logarithmicDepthBuffer===!0,u=i.getParameter(34930),p=i.getParameter(35660),_=i.getParameter(3379),x=i.getParameter(34076),w=i.getParameter(34921),A=i.getParameter(36347),C=i.getParameter(36348),G=i.getParameter(36349),K=p>0,it=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const ft=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(ft.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:s,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:p,maxTextureSize:_,maxCubemapSize:x,maxAttributes:w,maxVertexUniforms:A,maxVaryings:C,maxFragmentUniforms:G,vertexTextures:K,floatFragmentTextures:it,floatVertexTextures:K&&it,maxSamples:o?i.getParameter(36183):0}}function eu(i){const t=this;let e=null,n=0,r=!1,o=!1;const s=new ui,a=new F,l={value:null,needsUpdate:!1};function h(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(p,_,x,w){const A=p!==null?p.length:0;let C=null;if(A!==0){if(C=l.value,w!==!0||C===null){const G=x+4*A,K=_.matrixWorldInverse;a.getNormalMatrix(K),(C===null||C.length<G)&&(C=new Float32Array(G));for(let it=0,ft=x;it!==A;++it,ft+=4)s.copy(p[it]).applyMatrix4(K,a),s.normal.toArray(C,ft),C[ft+3]=s.constant}l.value=C,l.needsUpdate=!0}return t.numPlanes=A,t.numIntersection=0,C}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,_,x){const w=p.length!==0||_||n!==0||r;return r=_,e=u(p,x,0),n=p.length,w},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,h()},this.setState=function(p,_,x){const w=p.clippingPlanes,A=p.clipIntersection,C=p.clipShadows,G=i.get(p);if(!r||w===null||w.length===0||o&&!C)o?u(null):h();else{const K=o?0:n,it=4*K;let ft=G.clippingState||null;l.value=ft,ft=u(w,_,it,x);for(let nt=0;nt!==it;++nt)ft[nt]=e[nt];G.clippingState=ft,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=K}}}function nu(i){let t=new WeakMap;function e(r,o){return o===303?r.mapping=301:o===304&&(r.mapping=302),r}function n(r){const o=r.target;o.removeEventListener("dispose",n);const s=t.get(o);s!==void 0&&(t.delete(o),s.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===303||o===304){if(t.has(r))return e(t.get(r).texture,r.mapping);{const s=r.image;if(s&&s.height>0){const a=i.getRenderTarget(),l=new yi(s.height/2);return l.fromEquirectangularTexture(i,r),t.set(r,l),i.setRenderTarget(a),r.addEventListener("dispose",n),e(l.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}function fl(i){const t={};function e(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float")},get:function(n){const r=e(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function iu(i,t,e,n){const r={},o=new WeakMap;function s(l){const h=l.target;h.index!==null&&t.remove(h.index);for(const p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",s),delete r[h.id];const u=o.get(h);u&&(t.remove(u),o.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,e.memory.geometries--}function a(l){const h=[],u=l.index,p=l.attributes.position;let _=0;if(u!==null){const A=u.array;_=u.version;for(let C=0,G=A.length;C<G;C+=3){const K=A[C+0],it=A[C+1],ft=A[C+2];h.push(K,it,it,ft,ft,K)}}else{const A=p.array;_=p.version;for(let C=0,G=A.length/3-1;C<G;C+=3){const K=C+0,it=C+1,ft=C+2;h.push(K,it,it,ft,ft,K)}}const x=new(Es(h)>65535?Ro:Ss)(h,1);x.version=_;const w=o.get(l);w&&t.remove(w),o.set(l,x)}return{get:function(l,h){return r[h.id]===!0||(h.addEventListener("dispose",s),r[h.id]=!0,e.memory.geometries++),h},update:function(l){const h=l.attributes;for(const p in h)t.update(h[p],34962);const u=l.morphAttributes;for(const p in u){const _=u[p];for(let x=0,w=_.length;x<w;x++)t.update(_[x],34962)}},getWireframeAttribute:function(l){const h=o.get(l);if(h){const u=l.index;u!==null&&h.version<u.version&&a(l)}else a(l);return o.get(l)}}}function ru(i,t,e,n){const r=n.isWebGL2;let o,s,a;this.setMode=function(l){o=l},this.setIndex=function(l){s=l.type,a=l.bytesPerElement},this.render=function(l,h){i.drawElements(o,h,s,l*a),e.update(h,o,1)},this.renderInstances=function(l,h,u){if(u===0)return;let p,_;if(r)p=i,_="drawElementsInstanced";else if(p=t.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",p===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[_](o,h,s,l*a,u),e.update(h,o,u)}}function ou(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function su(i,t){return i[0]-t[0]}function As(i,t){return Math.abs(t[1])-Math.abs(i[1])}function au(i){const t={},e=new Float32Array(8),n=[];for(let r=0;r<8;r++)n[r]=[r,0];return{update:function(r,o,s,a){const l=r.morphTargetInfluences,h=l===void 0?0:l.length;let u=t[o.id];if(u===void 0||u.length!==h){u=[];for(let A=0;A<h;A++)u[A]=[A,0];t[o.id]=u}for(let A=0;A<h;A++){const C=u[A];C[0]=A,C[1]=l[A]}u.sort(As);for(let A=0;A<8;A++)A<h&&u[A][1]?(n[A][0]=u[A][0],n[A][1]=u[A][1]):(n[A][0]=Number.MAX_SAFE_INTEGER,n[A][1]=0);n.sort(su);const p=s.morphTargets&&o.morphAttributes.position,_=s.morphNormals&&o.morphAttributes.normal;let x=0;for(let A=0;A<8;A++){const C=n[A],G=C[0],K=C[1];G!==Number.MAX_SAFE_INTEGER&&K?(p&&o.getAttribute("morphTarget"+A)!==p[G]&&o.setAttribute("morphTarget"+A,p[G]),_&&o.getAttribute("morphNormal"+A)!==_[G]&&o.setAttribute("morphNormal"+A,_[G]),e[A]=K,x+=K):(p&&o.hasAttribute("morphTarget"+A)===!0&&o.deleteAttribute("morphTarget"+A),_&&o.hasAttribute("morphNormal"+A)===!0&&o.deleteAttribute("morphNormal"+A),e[A]=0)}const w=o.morphTargetsRelative?1:1-x;a.getUniforms().setValue(i,"morphTargetBaseInfluence",w),a.getUniforms().setValue(i,"morphTargetInfluences",e)}}}function lu(i,t,e,n){let r=new WeakMap;function o(s){const a=s.target;a.removeEventListener("dispose",o),e.remove(a.instanceMatrix),a.instanceColor!==null&&e.remove(a.instanceColor)}return{update:function(s){const a=n.render.frame,l=s.geometry,h=t.get(s,l);return r.get(h)!==a&&(t.update(h),r.set(h,a)),s.isInstancedMesh&&(s.hasEventListener("dispose",o)===!1&&s.addEventListener("dispose",o),e.update(s.instanceMatrix,34962),s.instanceColor!==null&&e.update(s.instanceColor,34962)),h},dispose:function(){r=new WeakMap}}}Pr.physical={uniforms:Te([Pr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new I(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new fn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new I},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new fn(0)}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag};class ml extends Q{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}ml.prototype.isDataTexture2DArray=!0;class Ms extends Q{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ms.prototype.isDataTexture3D=!0;const gl=new Q,ga=new ml,hu=new Ms,vl=new _i,_l=[],yl=[],xl=new Float32Array(16),bl=new Float32Array(9),Tl=new Float32Array(4);function Do(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let o=_l[r];if(o===void 0&&(o=new Float32Array(r),_l[r]=o),t!==0){n.toArray(o,0);for(let s=1,a=0;s!==t;++s)a+=e,i[s].toArray(o,a)}return o}function Ji(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function Ui(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function va(i,t){let e=yl[t];e===void 0&&(e=new Int32Array(t),yl[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function uu(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function wl(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y||(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Ji(e,t))return;i.uniform2fv(this.addr,t),Ui(e,t)}}function T(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z||(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)e[0]===t.r&&e[1]===t.g&&e[2]===t.b||(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(Ji(e,t))return;i.uniform3fv(this.addr,t),Ui(e,t)}}function d(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z&&e[3]===t.w||(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Ji(e,t))return;i.uniform4fv(this.addr,t),Ui(e,t)}}function c(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Ji(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),Ui(e,t)}else{if(Ji(e,n))return;Tl.set(n),i.uniformMatrix2fv(this.addr,!1,Tl),Ui(e,n)}}function f(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Ji(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),Ui(e,t)}else{if(Ji(e,n))return;bl.set(n),i.uniformMatrix3fv(this.addr,!1,bl),Ui(e,n)}}function E(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Ji(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),Ui(e,t)}else{if(Ji(e,n))return;xl.set(n),i.uniformMatrix4fv(this.addr,!1,xl),Ui(e,n)}}function U(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function $(i,t){const e=this.cache;Ji(e,t)||(i.uniform2iv(this.addr,t),Ui(e,t))}function ot(i,t){const e=this.cache;Ji(e,t)||(i.uniform3iv(this.addr,t),Ui(e,t))}function ut(i,t){const e=this.cache;Ji(e,t)||(i.uniform4iv(this.addr,t),Ui(e,t))}function It(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function kt(i,t){const e=this.cache;Ji(e,t)||(i.uniform2uiv(this.addr,t),Ui(e,t))}function he(i,t){const e=this.cache;Ji(e,t)||(i.uniform3uiv(this.addr,t),Ui(e,t))}function te(i,t){const e=this.cache;Ji(e,t)||(i.uniform4uiv(this.addr,t),Ui(e,t))}function ge(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTexture2D(t||gl,r)}function xe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||hu,r)}function Be(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTextureCube(t||vl,r)}function Je(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||ga,r)}function qe(i,t){i.uniform1fv(this.addr,t)}function Ze(i,t){const e=Do(t,this.size,2);i.uniform2fv(this.addr,e)}function je(i,t){const e=Do(t,this.size,3);i.uniform3fv(this.addr,e)}function pn(i,t){const e=Do(t,this.size,4);i.uniform4fv(this.addr,e)}function _n(i,t){const e=Do(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function Un(i,t){const e=Do(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function Dn(i,t){const e=Do(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Ye(i,t){i.uniform1iv(this.addr,t)}function an(i,t){i.uniform2iv(this.addr,t)}function bn(i,t){i.uniform3iv(this.addr,t)}function Gn(i,t){i.uniform4iv(this.addr,t)}function qn(i,t){i.uniform1uiv(this.addr,t)}function Ei(i,t){i.uniform2uiv(this.addr,t)}function Qn(i,t){i.uniform3uiv(this.addr,t)}function xi(i,t){i.uniform4uiv(this.addr,t)}function Pi(i,t,e){const n=t.length,r=va(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTexture2D(t[o]||gl,r[o])}function Zi(i,t,e){const n=t.length,r=va(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTextureCube(t[o]||vl,r[o])}function Gi(i,t,e){this.id=i,this.addr=e,this.cache=[],this.setValue=function(n){switch(n){case 5126:return uu;case 35664:return wl;case 35665:return T;case 35666:return d;case 35674:return c;case 35675:return f;case 35676:return E;case 5124:case 35670:return U;case 35667:case 35671:return $;case 35668:case 35672:return ot;case 35669:case 35673:return ut;case 5125:return It;case 36294:return kt;case 36295:return he;case 36296:return te;case 35678:case 36198:case 36298:case 36306:case 35682:return ge;case 35679:case 36299:case 36307:return xe;case 35680:case 36300:case 36308:case 36293:return Be;case 36289:case 36303:case 36311:case 36292:return Je}}(t.type)}function ii(i,t,e){this.id=i,this.addr=e,this.cache=[],this.size=t.size,this.setValue=function(n){switch(n){case 5126:return qe;case 35664:return Ze;case 35665:return je;case 35666:return pn;case 35674:return _n;case 35675:return Un;case 35676:return Dn;case 5124:case 35670:return Ye;case 35667:case 35671:return an;case 35668:case 35672:return bn;case 35669:case 35673:return Gn;case 5125:return qn;case 36294:return Ei;case 36295:return Qn;case 36296:return xi;case 35678:case 36198:case 36298:case 36306:case 35682:return Pi;case 35680:case 36300:case 36308:case 36293:return Zi}}(t.type)}function Ai(i){this.id=i,this.seq=[],this.map={}}ii.prototype.updateCache=function(i){const t=this.cache;i instanceof Float32Array&&t.length!==i.length&&(this.cache=new Float32Array(i.length)),Ui(t,i)},Ai.prototype.setValue=function(i,t,e){const n=this.seq;for(let r=0,o=n.length;r!==o;++r){const s=n[r];s.setValue(i,t[s.id],e)}};const Hi=/(\w+)(\])?(\[|\.)?/g;function ji(i,t){i.seq.push(t),i.map[t.id]=t}function er(i,t,e){const n=i.name,r=n.length;for(Hi.lastIndex=0;;){const o=Hi.exec(n),s=Hi.lastIndex;let a=o[1];const l=o[2]==="]",h=o[3];if(l&&(a|=0),h===void 0||h==="["&&s+2===r){ji(e,h===void 0?new Gi(a,i,t):new ii(a,i,t));break}{let u=e.map[a];u===void 0&&(u=new Ai(a),ji(e,u)),e=u}}}function ri(i,t){this.seq=[],this.map={};const e=i.getProgramParameter(t,35718);for(let n=0;n<e;++n){const r=i.getActiveUniform(t,n);er(r,i.getUniformLocation(t,r.name),this)}}function Sl(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}ri.prototype.setValue=function(i,t,e,n){const r=this.map[t];r!==void 0&&r.setValue(i,e,n)},ri.prototype.setOptional=function(i,t,e){const n=t[e];n!==void 0&&this.setValue(i,e,n)},ri.upload=function(i,t,e,n){for(let r=0,o=t.length;r!==o;++r){const s=t[r],a=e[s.id];a.needsUpdate!==!1&&s.setValue(i,a.value,n)}},ri.seqWithValue=function(i,t){const e=[];for(let n=0,r=i.length;n!==r;++n){const o=i[n];o.id in t&&e.push(o)}return e};let cu=0;function El(i){switch(i){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function Al(i,t,e){const n=i.getShaderParameter(t,35713),r=i.getShaderInfoLog(t).trim();return n&&r===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+e+`
`+r+function(o){const s=o.split(`
`);for(let a=0;a<s.length;a++)s[a]=a+1+": "+s[a];return s.join(`
`)}(i.getShaderSource(t))}function as(i,t){const e=El(t);return"vec4 "+i+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function du(i,t){const e=El(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function U_(i,t){let e;switch(t){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="OptimizedCineon";break;case 4:e="ACESFilmic";break;case 5:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function _a(i){return i!==""}function Yd(i,t){return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function qd(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const G_=/^[ \t]*#include +<([\w\d./]+)>/gm;function pu(i){return i.replace(G_,H_)}function H_(i,t){const e=On[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return pu(e)}const j_=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,z_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Jd(i){return i.replace(z_,Zd).replace(j_,V_)}function V_(i,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Zd(i,t,e,n)}function Zd(i,t,e,n){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function Kd(i){let t="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?t+=`
#define HIGH_PRECISION`:i.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function W_(i,t,e,n){const r=i.getContext(),o=e.defines;let s=e.vertexShader,a=e.fragmentShader;const l=function(dt){let Ut="SHADOWMAP_TYPE_BASIC";return dt.shadowMapType===1?Ut="SHADOWMAP_TYPE_PCF":dt.shadowMapType===2?Ut="SHADOWMAP_TYPE_PCF_SOFT":dt.shadowMapType===3&&(Ut="SHADOWMAP_TYPE_VSM"),Ut}(e),h=function(dt){let Ut="ENVMAP_TYPE_CUBE";if(dt.envMap)switch(dt.envMapMode){case 301:case 302:Ut="ENVMAP_TYPE_CUBE";break;case 306:case 307:Ut="ENVMAP_TYPE_CUBE_UV"}return Ut}(e),u=function(dt){let Ut="ENVMAP_MODE_REFLECTION";if(dt.envMap)switch(dt.envMapMode){case 302:case 307:Ut="ENVMAP_MODE_REFRACTION"}return Ut}(e),p=function(dt){let Ut="ENVMAP_BLENDING_NONE";if(dt.envMap)switch(dt.combine){case 0:Ut="ENVMAP_BLENDING_MULTIPLY";break;case 1:Ut="ENVMAP_BLENDING_MIX";break;case 2:Ut="ENVMAP_BLENDING_ADD"}return Ut}(e),_=i.gammaFactor>0?i.gammaFactor:1,x=e.isWebGL2?"":function(dt){return[dt.extensionDerivatives||dt.envMapCubeUV||dt.bumpMap||dt.tangentSpaceNormalMap||dt.clearcoatNormalMap||dt.flatShading||dt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(dt.extensionFragDepth||dt.logarithmicDepthBuffer)&&dt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",dt.extensionDrawBuffers&&dt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(dt.extensionShaderTextureLOD||dt.envMap||dt.transmission>0)&&dt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_a).join(`
`)}(e),w=function(dt){const Ut=[];for(const Ft in dt){const Et=dt[Ft];Et!==!1&&Ut.push("#define "+Ft+" "+Et)}return Ut.join(`
`)}(o),A=r.createProgram();let C,G,K=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(C=[w].filter(_a).join(`
`),C.length>0&&(C+=`
`),G=[x,w].filter(_a).join(`
`),G.length>0&&(G+=`
`)):(C=[Kd(e),"#define SHADER_NAME "+e.shaderName,w,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(_a).join(`
`),G=[x,Kd(e),"#define SHADER_NAME "+e.shaderName,w,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+_,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+h:"",e.envMap?"#define "+u:"",e.envMap?"#define "+p:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.sheen?"#define USE_SHEEN":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==0?"#define TONE_MAPPING":"",e.toneMapping!==0?On.tonemapping_pars_fragment:"",e.toneMapping!==0?U_("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",On.encodings_pars_fragment,e.map?as("mapTexelToLinear",e.mapEncoding):"",e.matcap?as("matcapTexelToLinear",e.matcapEncoding):"",e.envMap?as("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMap?as("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.lightMap?as("lightMapTexelToLinear",e.lightMapEncoding):"",du("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(_a).join(`
`)),s=pu(s),s=Yd(s,e),s=qd(s,e),a=pu(a),a=Yd(a,e),a=qd(a,e),s=Jd(s),a=Jd(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(K=`#version 300 es
`,C=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+C,G=["#define varying in",e.glslVersion==="300 es"?"":"out highp vec4 pc_fragColor;",e.glslVersion==="300 es"?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+G);const it=K+G+a,ft=Sl(r,35633,K+C+s),nt=Sl(r,35632,it);if(r.attachShader(A,ft),r.attachShader(A,nt),e.index0AttributeName!==void 0?r.bindAttribLocation(A,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(A,0,"position"),r.linkProgram(A),i.debug.checkShaderErrors){const dt=r.getProgramInfoLog(A).trim(),Ut=r.getShaderInfoLog(ft).trim(),Ft=r.getShaderInfoLog(nt).trim();let Et=!0,Mt=!0;if(r.getProgramParameter(A,35714)===!1){Et=!1;const Lt=Al(r,ft,"vertex"),Pt=Al(r,nt,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(A,35715),"gl.getProgramInfoLog",dt,Lt,Pt)}else dt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",dt):Ut!==""&&Ft!==""||(Mt=!1);Mt&&(this.diagnostics={runnable:Et,programLog:dt,vertexShader:{log:Ut,prefix:C},fragmentShader:{log:Ft,prefix:G}})}let gt,lt;return r.deleteShader(ft),r.deleteShader(nt),this.getUniforms=function(){return gt===void 0&&(gt=new ri(r,A)),gt},this.getAttributes=function(){return lt===void 0&&(lt=function(dt,Ut){const Ft={},Et=dt.getProgramParameter(Ut,35721);for(let Mt=0;Mt<Et;Mt++){const Lt=dt.getActiveAttrib(Ut,Mt).name;Ft[Lt]=dt.getAttribLocation(Ut,Lt)}return Ft}(r,A)),lt},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(A),this.program=void 0},this.name=e.shaderName,this.id=cu++,this.cacheKey=t,this.usedTimes=1,this.program=A,this.vertexShader=ft,this.fragmentShader=nt,this}function X_(i,t,e,n,r,o){const s=[],a=n.isWebGL2,l=n.logarithmicDepthBuffer,h=n.floatVertexTextures,u=n.maxVertexUniforms,p=n.vertexTextures;let _=n.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},w=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function A(C){let G;return C&&C.isTexture?G=C.encoding:C&&C.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),G=C.texture.encoding):G=3e3,G}return{getParameters:function(C,G,K,it,ft){const nt=it.fog,gt=C.isMeshStandardMaterial?it.environment:null,lt=t.get(C.envMap||gt),dt=x[C.type],Ut=ft.isSkinnedMesh?function(Lt){const Pt=Lt.skeleton.bones;if(h)return 1024;{const ee=u,$t=Math.floor((ee-20)/4),zt=Math.min($t,Pt.length);return zt<Pt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Pt.length+" bones. This GPU supports "+zt+"."),0):zt}}(ft):0;let Ft,Et;if(C.precision!==null&&(_=n.getMaxPrecision(C.precision),_!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",_,"instead.")),dt){const Lt=Pr[dt];Ft=Lt.vertexShader,Et=Lt.fragmentShader}else Ft=C.vertexShader,Et=C.fragmentShader;const Mt=i.getRenderTarget();return{isWebGL2:a,shaderID:dt,shaderName:C.type,vertexShader:Ft,fragmentShader:Et,defines:C.defines,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:_,instancing:ft.isInstancedMesh===!0,instancingColor:ft.isInstancedMesh===!0&&ft.instanceColor!==null,supportsVertexTextures:p,outputEncoding:Mt!==null?A(Mt.texture):i.outputEncoding,map:!!C.map,mapEncoding:A(C.map),matcap:!!C.matcap,matcapEncoding:A(C.matcap),envMap:!!lt,envMapMode:lt&&lt.mapping,envMapEncoding:A(lt),envMapCubeUV:!!lt&&(lt.mapping===306||lt.mapping===307),lightMap:!!C.lightMap,lightMapEncoding:A(C.lightMap),aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,emissiveMapEncoding:A(C.emissiveMap),bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===1,tangentSpaceNormalMap:C.normalMapType===0,clearcoatMap:!!C.clearcoatMap,clearcoatRoughnessMap:!!C.clearcoatRoughnessMap,clearcoatNormalMap:!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,alphaMap:!!C.alphaMap,gradientMap:!!C.gradientMap,sheen:!!C.sheen,transmission:!!C.transmission,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:C.normalMap&&C.vertexTangents,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&ft.geometry&&ft.geometry.attributes.color&&ft.geometry.attributes.color.itemSize===4,vertexUvs:!!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatMap||C.clearcoatRoughnessMap||C.clearcoatNormalMap||C.displacementMap||C.transmissionMap||C.thicknessMap),uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.transmission||C.transmissionMap||C.thicknessMap||!C.displacementMap),fog:!!nt,useFog:C.fog,fogExp2:nt&&nt.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:l,skinning:ft.isSkinnedMesh===!0&&Ut>0,maxBones:Ut,useVertexTexture:h,morphTargets:C.morphTargets,morphNormals:C.morphNormals,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&K.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,alphaTest:C.alphaTest,doubleSided:C.side===2,flipSided:C.side===1,depthPacking:C.depthPacking!==void 0&&C.depthPacking,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||e.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||e.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||e.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function(C){const G=[];if(C.shaderID?G.push(C.shaderID):(G.push(C.fragmentShader),G.push(C.vertexShader)),C.defines!==void 0)for(const K in C.defines)G.push(K),G.push(C.defines[K]);if(C.isRawShaderMaterial===!1){for(let K=0;K<w.length;K++)G.push(C[w[K]]);G.push(i.outputEncoding),G.push(i.gammaFactor)}return G.push(C.customProgramCacheKey),G.join()},getUniforms:function(C){const G=x[C.type];let K;if(G){const it=Pr[G];K=$e.clone(it.uniforms)}else K=C.uniforms;return K},acquireProgram:function(C,G){let K;for(let it=0,ft=s.length;it<ft;it++){const nt=s[it];if(nt.cacheKey===G){K=nt,++K.usedTimes;break}}return K===void 0&&(K=new W_(i,G,C,r),s.push(K)),K},releaseProgram:function(C){if(--C.usedTimes==0){const G=s.indexOf(C);s[G]=s[s.length-1],s.pop(),C.destroy()}},programs:s}}function Y_(){let i=new WeakMap;return{get:function(t){let e=i.get(t);return e===void 0&&(e={},i.set(t,e)),e},remove:function(t){i.delete(t)},update:function(t,e,n){i.get(t)[e]=n},dispose:function(){i=new WeakMap}}}function q_(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.program!==t.program?i.program.id-t.program.id:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function $d(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function Qd(i){const t=[];let e=0;const n=[],r=[],o=[],s={id:-1};function a(l,h,u,p,_,x){let w=t[e];const A=i.get(u);return w===void 0?(w={id:l.id,object:l,geometry:h,material:u,program:A.program||s,groupOrder:p,renderOrder:l.renderOrder,z:_,group:x},t[e]=w):(w.id=l.id,w.object=l,w.geometry=h,w.material=u,w.program=A.program||s,w.groupOrder=p,w.renderOrder=l.renderOrder,w.z=_,w.group=x),e++,w}return{opaque:n,transmissive:r,transparent:o,init:function(){e=0,n.length=0,r.length=0,o.length=0},push:function(l,h,u,p,_,x){const w=a(l,h,u,p,_,x);u.transmission>0?r.push(w):u.transparent===!0?o.push(w):n.push(w)},unshift:function(l,h,u,p,_,x){const w=a(l,h,u,p,_,x);u.transmission>0?r.unshift(w):u.transparent===!0?o.unshift(w):n.unshift(w)},finish:function(){for(let l=e,h=t.length;l<h;l++){const u=t[l];if(u.id===null)break;u.id=null,u.object=null,u.geometry=null,u.material=null,u.program=null,u.group=null}},sort:function(l,h){n.length>1&&n.sort(l||q_),r.length>1&&r.sort(h||$d),o.length>1&&o.sort(h||$d)}}}function J_(i){let t=new WeakMap;return{get:function(e,n){let r;return t.has(e)===!1?(r=new Qd(i),t.set(e,[r])):n>=t.get(e).length?(r=new Qd(i),t.get(e).push(r)):r=t.get(e)[n],r},dispose:function(){t=new WeakMap}}}function Z_(){const i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new k,color:new fn};break;case"SpotLight":e={position:new k,direction:new k,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new k,color:new fn,distance:0,decay:0};break;case"HemisphereLight":e={direction:new k,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":e={color:new fn,position:new k,halfWidth:new k,halfHeight:new k}}return i[t.id]=e,e}}}let K_=0;function $_(i,t){return(t.castShadow?1:0)-(i.castShadow?1:0)}function Q_(i,t){const e=new Z_,n=function(){const l={};return{get:function(h){if(l[h.id]!==void 0)return l[h.id];let u;switch(h.type){case"DirectionalLight":case"SpotLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new I};break;case"PointLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new I,shadowCameraNear:1,shadowCameraFar:1e3}}return l[h.id]=u,u}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new k);const o=new k,s=new tn,a=new tn;return{setup:function(l){let h=0,u=0,p=0;for(let nt=0;nt<9;nt++)r.probe[nt].set(0,0,0);let _=0,x=0,w=0,A=0,C=0,G=0,K=0,it=0;l.sort($_);for(let nt=0,gt=l.length;nt<gt;nt++){const lt=l[nt],dt=lt.color,Ut=lt.intensity,Ft=lt.distance,Et=lt.shadow&&lt.shadow.map?lt.shadow.map.texture:null;if(lt.isAmbientLight)h+=dt.r*Ut,u+=dt.g*Ut,p+=dt.b*Ut;else if(lt.isLightProbe)for(let Mt=0;Mt<9;Mt++)r.probe[Mt].addScaledVector(lt.sh.coefficients[Mt],Ut);else if(lt.isDirectionalLight){const Mt=e.get(lt);if(Mt.color.copy(lt.color).multiplyScalar(lt.intensity),lt.castShadow){const Lt=lt.shadow,Pt=n.get(lt);Pt.shadowBias=Lt.bias,Pt.shadowNormalBias=Lt.normalBias,Pt.shadowRadius=Lt.radius,Pt.shadowMapSize=Lt.mapSize,r.directionalShadow[_]=Pt,r.directionalShadowMap[_]=Et,r.directionalShadowMatrix[_]=lt.shadow.matrix,G++}r.directional[_]=Mt,_++}else if(lt.isSpotLight){const Mt=e.get(lt);if(Mt.position.setFromMatrixPosition(lt.matrixWorld),Mt.color.copy(dt).multiplyScalar(Ut),Mt.distance=Ft,Mt.coneCos=Math.cos(lt.angle),Mt.penumbraCos=Math.cos(lt.angle*(1-lt.penumbra)),Mt.decay=lt.decay,lt.castShadow){const Lt=lt.shadow,Pt=n.get(lt);Pt.shadowBias=Lt.bias,Pt.shadowNormalBias=Lt.normalBias,Pt.shadowRadius=Lt.radius,Pt.shadowMapSize=Lt.mapSize,r.spotShadow[w]=Pt,r.spotShadowMap[w]=Et,r.spotShadowMatrix[w]=lt.shadow.matrix,it++}r.spot[w]=Mt,w++}else if(lt.isRectAreaLight){const Mt=e.get(lt);Mt.color.copy(dt).multiplyScalar(Ut),Mt.halfWidth.set(.5*lt.width,0,0),Mt.halfHeight.set(0,.5*lt.height,0),r.rectArea[A]=Mt,A++}else if(lt.isPointLight){const Mt=e.get(lt);if(Mt.color.copy(lt.color).multiplyScalar(lt.intensity),Mt.distance=lt.distance,Mt.decay=lt.decay,lt.castShadow){const Lt=lt.shadow,Pt=n.get(lt);Pt.shadowBias=Lt.bias,Pt.shadowNormalBias=Lt.normalBias,Pt.shadowRadius=Lt.radius,Pt.shadowMapSize=Lt.mapSize,Pt.shadowCameraNear=Lt.camera.near,Pt.shadowCameraFar=Lt.camera.far,r.pointShadow[x]=Pt,r.pointShadowMap[x]=Et,r.pointShadowMatrix[x]=lt.shadow.matrix,K++}r.point[x]=Mt,x++}else if(lt.isHemisphereLight){const Mt=e.get(lt);Mt.skyColor.copy(lt.color).multiplyScalar(Ut),Mt.groundColor.copy(lt.groundColor).multiplyScalar(Ut),r.hemi[C]=Mt,C++}}A>0&&(t.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_FLOAT_1,r.rectAreaLTC2=sn.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_HALF_1,r.rectAreaLTC2=sn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=u,r.ambient[2]=p;const ft=r.hash;ft.directionalLength===_&&ft.pointLength===x&&ft.spotLength===w&&ft.rectAreaLength===A&&ft.hemiLength===C&&ft.numDirectionalShadows===G&&ft.numPointShadows===K&&ft.numSpotShadows===it||(r.directional.length=_,r.spot.length=w,r.rectArea.length=A,r.point.length=x,r.hemi.length=C,r.directionalShadow.length=G,r.directionalShadowMap.length=G,r.pointShadow.length=K,r.pointShadowMap.length=K,r.spotShadow.length=it,r.spotShadowMap.length=it,r.directionalShadowMatrix.length=G,r.pointShadowMatrix.length=K,r.spotShadowMatrix.length=it,ft.directionalLength=_,ft.pointLength=x,ft.spotLength=w,ft.rectAreaLength=A,ft.hemiLength=C,ft.numDirectionalShadows=G,ft.numPointShadows=K,ft.numSpotShadows=it,r.version=K_++)},setupView:function(l,h){let u=0,p=0,_=0,x=0,w=0;const A=h.matrixWorldInverse;for(let C=0,G=l.length;C<G;C++){const K=l[C];if(K.isDirectionalLight){const it=r.directional[u];it.direction.setFromMatrixPosition(K.matrixWorld),o.setFromMatrixPosition(K.target.matrixWorld),it.direction.sub(o),it.direction.transformDirection(A),u++}else if(K.isSpotLight){const it=r.spot[_];it.position.setFromMatrixPosition(K.matrixWorld),it.position.applyMatrix4(A),it.direction.setFromMatrixPosition(K.matrixWorld),o.setFromMatrixPosition(K.target.matrixWorld),it.direction.sub(o),it.direction.transformDirection(A),_++}else if(K.isRectAreaLight){const it=r.rectArea[x];it.position.setFromMatrixPosition(K.matrixWorld),it.position.applyMatrix4(A),a.identity(),s.copy(K.matrixWorld),s.premultiply(A),a.extractRotation(s),it.halfWidth.set(.5*K.width,0,0),it.halfHeight.set(0,.5*K.height,0),it.halfWidth.applyMatrix4(a),it.halfHeight.applyMatrix4(a),x++}else if(K.isPointLight){const it=r.point[p];it.position.setFromMatrixPosition(K.matrixWorld),it.position.applyMatrix4(A),p++}else if(K.isHemisphereLight){const it=r.hemi[w];it.direction.setFromMatrixPosition(K.matrixWorld),it.direction.transformDirection(A),it.direction.normalize(),w++}}},state:r}}function tp(i,t){const e=new Q_(i,t),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:function(){e.setup(n)},setupLightsView:function(o){e.setupView(n,o)},pushLight:function(o){n.push(o)},pushShadow:function(o){r.push(o)}}}function ty(i,t){let e=new WeakMap;return{get:function(n,r=0){let o;return e.has(n)===!1?(o=new tp(i,t),e.set(n,[o])):r>=e.get(n).length?(o=new tp(i,t),e.get(n).push(o)):o=e.get(n)[r],o},dispose:function(){e=new WeakMap}}}class ep extends Ii{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}ep.prototype.isMeshDepthMaterial=!0;class np extends Ii{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new k,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}np.prototype.isMeshDistanceMaterial=!0;function ip(i,t,e){let n=new kr;const r=new I,o=new I,s=new Ot,a=[],l=[],h={},u=e.maxTextureSize,p={0:1,1:0,2:2},_=new hn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new I},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const w=new Wn;w.setAttribute("position",new Yn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const A=new wt(w,_),C=this;function G(gt,lt){const dt=t.update(A);_.uniforms.shadow_pass.value=gt.map.texture,_.uniforms.resolution.value=gt.mapSize,_.uniforms.radius.value=gt.radius,i.setRenderTarget(gt.mapPass),i.clear(),i.renderBufferDirect(lt,null,dt,_,A,null),x.uniforms.shadow_pass.value=gt.mapPass.texture,x.uniforms.resolution.value=gt.mapSize,x.uniforms.radius.value=gt.radius,i.setRenderTarget(gt.map),i.clear(),i.renderBufferDirect(lt,null,dt,x,A,null)}function K(gt){const lt=gt<<0;let dt=a[lt];return dt===void 0&&(dt=new ep({depthPacking:3201,morphTargets:gt}),a[lt]=dt),dt}function it(gt){const lt=gt<<0;let dt=l[lt];return dt===void 0&&(dt=new np({morphTargets:gt}),l[lt]=dt),dt}function ft(gt,lt,dt,Ut,Ft,Et,Mt){let Lt=null,Pt=K,ee=gt.customDepthMaterial;if(Ut.isPointLight===!0&&(Pt=it,ee=gt.customDistanceMaterial),ee===void 0){let $t=!1;dt.morphTargets===!0&&($t=lt.morphAttributes&&lt.morphAttributes.position&&lt.morphAttributes.position.length>0),Lt=Pt($t)}else Lt=ee;if(i.localClippingEnabled&&dt.clipShadows===!0&&dt.clippingPlanes.length!==0){const $t=Lt.uuid,zt=dt.uuid;let Xt=h[$t];Xt===void 0&&(Xt={},h[$t]=Xt);let pe=Xt[zt];pe===void 0&&(pe=Lt.clone(),Xt[zt]=pe),Lt=pe}return Lt.visible=dt.visible,Lt.wireframe=dt.wireframe,Lt.side=Mt===3?dt.shadowSide!==null?dt.shadowSide:dt.side:dt.shadowSide!==null?dt.shadowSide:p[dt.side],Lt.clipShadows=dt.clipShadows,Lt.clippingPlanes=dt.clippingPlanes,Lt.clipIntersection=dt.clipIntersection,Lt.wireframeLinewidth=dt.wireframeLinewidth,Lt.linewidth=dt.linewidth,Ut.isPointLight===!0&&Lt.isMeshDistanceMaterial===!0&&(Lt.referencePosition.setFromMatrixPosition(Ut.matrixWorld),Lt.nearDistance=Ft,Lt.farDistance=Et),Lt}function nt(gt,lt,dt,Ut,Ft){if(gt.visible===!1)return;if(gt.layers.test(lt.layers)&&(gt.isMesh||gt.isLine||gt.isPoints)&&(gt.castShadow||gt.receiveShadow&&Ft===3)&&(!gt.frustumCulled||n.intersectsObject(gt))){gt.modelViewMatrix.multiplyMatrices(dt.matrixWorldInverse,gt.matrixWorld);const Mt=t.update(gt),Lt=gt.material;if(Array.isArray(Lt)){const Pt=Mt.groups;for(let ee=0,$t=Pt.length;ee<$t;ee++){const zt=Pt[ee],Xt=Lt[zt.materialIndex];if(Xt&&Xt.visible){const pe=ft(gt,Mt,Xt,Ut,dt.near,dt.far,Ft);i.renderBufferDirect(dt,null,Mt,pe,gt,zt)}}}else if(Lt.visible){const Pt=ft(gt,Mt,Lt,Ut,dt.near,dt.far,Ft);i.renderBufferDirect(dt,null,Mt,Pt,gt,null)}}const Et=gt.children;for(let Mt=0,Lt=Et.length;Mt<Lt;Mt++)nt(Et[Mt],lt,dt,Ut,Ft)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(gt,lt,dt){if(C.enabled===!1||C.autoUpdate===!1&&C.needsUpdate===!1||gt.length===0)return;const Ut=i.getRenderTarget(),Ft=i.getActiveCubeFace(),Et=i.getActiveMipmapLevel(),Mt=i.state;Mt.setBlending(0),Mt.buffers.color.setClear(1,1,1,1),Mt.buffers.depth.setTest(!0),Mt.setScissorTest(!1);for(let Lt=0,Pt=gt.length;Lt<Pt;Lt++){const ee=gt[Lt],$t=ee.shadow;if($t===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if($t.autoUpdate===!1&&$t.needsUpdate===!1)continue;r.copy($t.mapSize);const zt=$t.getFrameExtents();if(r.multiply(zt),o.copy($t.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/zt.x),r.x=o.x*zt.x,$t.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/zt.y),r.y=o.y*zt.y,$t.mapSize.y=o.y)),$t.map===null&&!$t.isPointLightShadow&&this.type===3){const pe={minFilter:1006,magFilter:1006,format:1023};$t.map=new Vt(r.x,r.y,pe),$t.map.texture.name=ee.name+".shadowMap",$t.mapPass=new Vt(r.x,r.y,pe),$t.camera.updateProjectionMatrix()}if($t.map===null){const pe={minFilter:1003,magFilter:1003,format:1023};$t.map=new Vt(r.x,r.y,pe),$t.map.texture.name=ee.name+".shadowMap",$t.camera.updateProjectionMatrix()}i.setRenderTarget($t.map),i.clear();const Xt=$t.getViewportCount();for(let pe=0;pe<Xt;pe++){const be=$t.getViewport(pe);s.set(o.x*be.x,o.y*be.y,o.x*be.z,o.y*be.w),Mt.viewport(s),$t.updateMatrices(ee,pe),n=$t.getFrustum(),nt(lt,dt,$t.camera,ee,this.type)}$t.isPointLightShadow||this.type!==3||G($t,dt),$t.needsUpdate=!1}C.needsUpdate=!1,i.setRenderTarget(Ut,Ft,Et)}}function ey(i,t,e){const n=e.isWebGL2,r=new function(){let Tt=!1;const jt=new Ot;let ie=null;const ae=new Ot(0,0,0,0);return{setMask:function(qt){ie===qt||Tt||(i.colorMask(qt,qt,qt,qt),ie=qt)},setLocked:function(qt){Tt=qt},setClear:function(qt,ye,nn,on,rn){rn===!0&&(qt*=on,ye*=on,nn*=on),jt.set(qt,ye,nn,on),ae.equals(jt)===!1&&(i.clearColor(qt,ye,nn,on),ae.copy(jt))},reset:function(){Tt=!1,ie=null,ae.set(-1,0,0,0)}}},o=new function(){let Tt=!1,jt=null,ie=null,ae=null;return{setTest:function(qt){qt?Pe(2929):Ct(2929)},setMask:function(qt){jt===qt||Tt||(i.depthMask(qt),jt=qt)},setFunc:function(qt){if(ie!==qt){if(qt)switch(qt){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);ie=qt}},setLocked:function(qt){Tt=qt},setClear:function(qt){ae!==qt&&(i.clearDepth(qt),ae=qt)},reset:function(){Tt=!1,jt=null,ie=null,ae=null}}},s=new function(){let Tt=!1,jt=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null;return{setTest:function(Sn){Tt||(Sn?Pe(2960):Ct(2960))},setMask:function(Sn){jt===Sn||Tt||(i.stencilMask(Sn),jt=Sn)},setFunc:function(Sn,Ci,Jn){ie===Sn&&ae===Ci&&qt===Jn||(i.stencilFunc(Sn,Ci,Jn),ie=Sn,ae=Ci,qt=Jn)},setOp:function(Sn,Ci,Jn){ye===Sn&&nn===Ci&&on===Jn||(i.stencilOp(Sn,Ci,Jn),ye=Sn,nn=Ci,on=Jn)},setLocked:function(Sn){Tt=Sn},setClear:function(Sn){rn!==Sn&&(i.clearStencil(Sn),rn=Sn)},reset:function(){Tt=!1,jt=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null}}};let a={},l=null,h={},u=null,p=!1,_=null,x=null,w=null,A=null,C=null,G=null,K=null,it=!1,ft=null,nt=null,gt=null,lt=null,dt=null;const Ut=i.getParameter(35661);let Ft=!1,Et=0;const Mt=i.getParameter(7938);Mt.indexOf("WebGL")!==-1?(Et=parseFloat(/^WebGL (\d)/.exec(Mt)[1]),Ft=Et>=1):Mt.indexOf("OpenGL ES")!==-1&&(Et=parseFloat(/^OpenGL ES (\d)/.exec(Mt)[1]),Ft=Et>=2);let Lt=null,Pt={};const ee=i.getParameter(3088),$t=i.getParameter(2978),zt=new Ot().fromArray(ee),Xt=new Ot().fromArray($t);function pe(Tt,jt,ie){const ae=new Uint8Array(4),qt=i.createTexture();i.bindTexture(Tt,qt),i.texParameteri(Tt,10241,9728),i.texParameteri(Tt,10240,9728);for(let ye=0;ye<ie;ye++)i.texImage2D(jt+ye,0,6408,1,1,0,6408,5121,ae);return qt}const be={};function Pe(Tt){a[Tt]!==!0&&(i.enable(Tt),a[Tt]=!0)}function Ct(Tt){a[Tt]!==!1&&(i.disable(Tt),a[Tt]=!1)}be[3553]=pe(3553,3553,1),be[34067]=pe(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Pe(2929),o.setFunc(3),se(!1),Ie(1),Pe(2884),le(0);const Bt={100:32774,101:32778,102:32779};if(n)Bt[103]=32775,Bt[104]=32776;else{const Tt=t.get("EXT_blend_minmax");Tt!==null&&(Bt[103]=Tt.MIN_EXT,Bt[104]=Tt.MAX_EXT)}const ve={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function le(Tt,jt,ie,ae,qt,ye,nn,on){if(Tt!==0){if(p===!1&&(Pe(3042),p=!0),Tt===5)qt=qt||jt,ye=ye||ie,nn=nn||ae,jt===x&&qt===C||(i.blendEquationSeparate(Bt[jt],Bt[qt]),x=jt,C=qt),ie===w&&ae===A&&ye===G&&nn===K||(i.blendFuncSeparate(ve[ie],ve[ae],ve[ye],ve[nn]),w=ie,A=ae,G=ye,K=nn),_=Tt,it=null;else if(Tt!==_||on!==it){if(x===100&&C===100||(i.blendEquation(32774),x=100,C=100),on)switch(Tt){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,0,769,771);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Tt)}else switch(Tt){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFunc(0,769);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Tt)}w=null,A=null,G=null,K=null,_=Tt,it=on}}else p===!0&&(Ct(3042),p=!1)}function se(Tt){ft!==Tt&&(Tt?i.frontFace(2304):i.frontFace(2305),ft=Tt)}function Ie(Tt){Tt!==0?(Pe(2884),Tt!==nt&&(Tt===1?i.cullFace(1029):Tt===2?i.cullFace(1028):i.cullFace(1032))):Ct(2884),nt=Tt}function De(Tt,jt,ie){Tt?(Pe(32823),lt===jt&&dt===ie||(i.polygonOffset(jt,ie),lt=jt,dt=ie)):Ct(32823)}function ce(Tt){Tt===void 0&&(Tt=33984+Ut-1),Lt!==Tt&&(i.activeTexture(Tt),Lt=Tt)}return{buffers:{color:r,depth:o,stencil:s},enable:Pe,disable:Ct,bindFramebuffer:function(Tt,jt){return jt===null&&l!==null&&(jt=l),h[Tt]!==jt&&(i.bindFramebuffer(Tt,jt),h[Tt]=jt,n&&(Tt===36009&&(h[36160]=jt),Tt===36160&&(h[36009]=jt)),!0)},bindXRFramebuffer:function(Tt){Tt!==l&&(i.bindFramebuffer(36160,Tt),l=Tt)},useProgram:function(Tt){return u!==Tt&&(i.useProgram(Tt),u=Tt,!0)},setBlending:le,setMaterial:function(Tt,jt){Tt.side===2?Ct(2884):Pe(2884);let ie=Tt.side===1;jt&&(ie=!ie),se(ie),Tt.blending===1&&Tt.transparent===!1?le(0):le(Tt.blending,Tt.blendEquation,Tt.blendSrc,Tt.blendDst,Tt.blendEquationAlpha,Tt.blendSrcAlpha,Tt.blendDstAlpha,Tt.premultipliedAlpha),o.setFunc(Tt.depthFunc),o.setTest(Tt.depthTest),o.setMask(Tt.depthWrite),r.setMask(Tt.colorWrite);const ae=Tt.stencilWrite;s.setTest(ae),ae&&(s.setMask(Tt.stencilWriteMask),s.setFunc(Tt.stencilFunc,Tt.stencilRef,Tt.stencilFuncMask),s.setOp(Tt.stencilFail,Tt.stencilZFail,Tt.stencilZPass)),De(Tt.polygonOffset,Tt.polygonOffsetFactor,Tt.polygonOffsetUnits),Tt.alphaToCoverage===!0?Pe(32926):Ct(32926)},setFlipSided:se,setCullFace:Ie,setLineWidth:function(Tt){Tt!==gt&&(Ft&&i.lineWidth(Tt),gt=Tt)},setPolygonOffset:De,setScissorTest:function(Tt){Tt?Pe(3089):Ct(3089)},activeTexture:ce,bindTexture:function(Tt,jt){Lt===null&&ce();let ie=Pt[Lt];ie===void 0&&(ie={type:void 0,texture:void 0},Pt[Lt]=ie),ie.type===Tt&&ie.texture===jt||(i.bindTexture(Tt,jt||be[Tt]),ie.type=Tt,ie.texture=jt)},unbindTexture:function(){const Tt=Pt[Lt];Tt!==void 0&&Tt.type!==void 0&&(i.bindTexture(Tt.type,null),Tt.type=void 0,Tt.texture=void 0)},compressedTexImage2D:function(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Tt){console.error("THREE.WebGLState:",Tt)}},texImage2D:function(){try{i.texImage2D.apply(i,arguments)}catch(Tt){console.error("THREE.WebGLState:",Tt)}},texImage3D:function(){try{i.texImage3D.apply(i,arguments)}catch(Tt){console.error("THREE.WebGLState:",Tt)}},scissor:function(Tt){zt.equals(Tt)===!1&&(i.scissor(Tt.x,Tt.y,Tt.z,Tt.w),zt.copy(Tt))},viewport:function(Tt){Xt.equals(Tt)===!1&&(i.viewport(Tt.x,Tt.y,Tt.z,Tt.w),Xt.copy(Tt))},reset:function(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),n===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),a={},Lt=null,Pt={},l=null,h={},u=null,p=!1,_=null,x=null,w=null,A=null,C=null,G=null,K=null,it=!1,ft=null,nt=null,gt=null,lt=null,dt=null,zt.set(0,0,i.canvas.width,i.canvas.height),Xt.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),s.reset()}}}function ny(i,t,e,n,r,o,s){const a=r.isWebGL2,l=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,p=r.maxSamples,_=new WeakMap;let x,w=!1;try{w=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(Ct,Bt){return w?new OffscreenCanvas(Ct,Bt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function C(Ct,Bt,ve,le){let se=1;if((Ct.width>le||Ct.height>le)&&(se=le/Math.max(Ct.width,Ct.height)),se<1||Bt===!0){if(typeof HTMLImageElement!="undefined"&&Ct instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Ct instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Ct instanceof ImageBitmap){const Ie=Bt?L:Math.floor,De=Ie(se*Ct.width),ce=Ie(se*Ct.height);x===void 0&&(x=A(De,ce));const Tt=ve?A(De,ce):x;return Tt.width=De,Tt.height=ce,Tt.getContext("2d").drawImage(Ct,0,0,De,ce),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ct.width+"x"+Ct.height+") to ("+De+"x"+ce+")."),Tt}return"data"in Ct&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ct.width+"x"+Ct.height+")."),Ct}return Ct}function G(Ct){return vt(Ct.width)&&vt(Ct.height)}function K(Ct,Bt){return Ct.generateMipmaps&&Bt&&Ct.minFilter!==1003&&Ct.minFilter!==1006}function it(Ct,Bt,ve,le,se=1){i.generateMipmap(Ct),n.get(Bt).__maxMipLevel=Math.log2(Math.max(ve,le,se))}function ft(Ct,Bt,ve){if(a===!1)return Bt;if(Ct!==null){if(i[Ct]!==void 0)return i[Ct];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ct+"'")}let le=Bt;return Bt===6403&&(ve===5126&&(le=33326),ve===5131&&(le=33325),ve===5121&&(le=33321)),Bt===6407&&(ve===5126&&(le=34837),ve===5131&&(le=34843),ve===5121&&(le=32849)),Bt===6408&&(ve===5126&&(le=34836),ve===5131&&(le=34842),ve===5121&&(le=32856)),le!==33325&&le!==33326&&le!==34842&&le!==34836||t.get("EXT_color_buffer_float"),le}function nt(Ct){return Ct===1003||Ct===1004||Ct===1005?9728:9729}function gt(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",gt),function(ve){const le=n.get(ve);le.__webglInit!==void 0&&(i.deleteTexture(le.__webglTexture),n.remove(ve))}(Bt),Bt.isVideoTexture&&_.delete(Bt),s.memory.textures--}function lt(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",lt),function(ve){const le=ve.texture,se=n.get(ve),Ie=n.get(le);if(!!ve){if(Ie.__webglTexture!==void 0&&(i.deleteTexture(Ie.__webglTexture),s.memory.textures--),ve.depthTexture&&ve.depthTexture.dispose(),ve.isWebGLCubeRenderTarget)for(let De=0;De<6;De++)i.deleteFramebuffer(se.__webglFramebuffer[De]),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer[De]);else i.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&i.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer&&i.deleteRenderbuffer(se.__webglColorRenderbuffer),se.__webglDepthRenderbuffer&&i.deleteRenderbuffer(se.__webglDepthRenderbuffer);if(ve.isWebGLMultipleRenderTargets)for(let De=0,ce=le.length;De<ce;De++){const Tt=n.get(le[De]);Tt.__webglTexture&&(i.deleteTexture(Tt.__webglTexture),s.memory.textures--),n.remove(le[De])}n.remove(le),n.remove(ve)}}(Bt)}let dt=0;function Ut(Ct,Bt){const ve=n.get(Ct);if(Ct.isVideoTexture&&function(le){const se=s.render.frame;_.get(le)!==se&&(_.set(le,se),le.update())}(Ct),Ct.version>0&&ve.__version!==Ct.version){const le=Ct.image;if(le===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(le.complete!==!1)return void ee(ve,Ct,Bt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}e.activeTexture(33984+Bt),e.bindTexture(3553,ve.__webglTexture)}function Ft(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?function(le,se,Ie){if(se.image.length!==6)return;Pt(le,se),e.activeTexture(33984+Ie),e.bindTexture(34067,le.__webglTexture),i.pixelStorei(37440,se.flipY),i.pixelStorei(37441,se.premultiplyAlpha),i.pixelStorei(3317,se.unpackAlignment),i.pixelStorei(37443,0);const De=se&&(se.isCompressedTexture||se.image[0].isCompressedTexture),ce=se.image[0]&&se.image[0].isDataTexture,Tt=[];for(let on=0;on<6;on++)Tt[on]=De||ce?ce?se.image[on].image:se.image[on]:C(se.image[on],!1,!0,h);const jt=Tt[0],ie=G(jt)||a,ae=o.convert(se.format),qt=o.convert(se.type),ye=ft(se.internalFormat,ae,qt);let nn;if(Lt(34067,se,ie),De){for(let on=0;on<6;on++){nn=Tt[on].mipmaps;for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn];se.format!==1023&&se.format!==1022?ae!==null?e.compressedTexImage2D(34069+on,rn,ye,Sn.width,Sn.height,0,Sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):e.texImage2D(34069+on,rn,ye,Sn.width,Sn.height,0,ae,qt,Sn.data)}}le.__maxMipLevel=nn.length-1}else{nn=se.mipmaps;for(let on=0;on<6;on++)if(ce){e.texImage2D(34069+on,0,ye,Tt[on].width,Tt[on].height,0,ae,qt,Tt[on].data);for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn].image[on].image;e.texImage2D(34069+on,rn+1,ye,Sn.width,Sn.height,0,ae,qt,Sn.data)}}else{e.texImage2D(34069+on,0,ye,ae,qt,Tt[on]);for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn];e.texImage2D(34069+on,rn+1,ye,ae,qt,Sn.image[on])}}le.__maxMipLevel=nn.length}K(se,ie)&&it(34067,se,jt.width,jt.height),le.__version=se.version,se.onUpdate&&se.onUpdate(se)}(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(34067,ve.__webglTexture))}const Et={1e3:10497,1001:33071,1002:33648},Mt={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function Lt(Ct,Bt,ve){if(ve?(i.texParameteri(Ct,10242,Et[Bt.wrapS]),i.texParameteri(Ct,10243,Et[Bt.wrapT]),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,Et[Bt.wrapR]),i.texParameteri(Ct,10240,Mt[Bt.magFilter]),i.texParameteri(Ct,10241,Mt[Bt.minFilter])):(i.texParameteri(Ct,10242,33071),i.texParameteri(Ct,10243,33071),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,33071),Bt.wrapS===1001&&Bt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(Ct,10240,nt(Bt.magFilter)),i.texParameteri(Ct,10241,nt(Bt.minFilter)),Bt.minFilter!==1003&&Bt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const le=t.get("EXT_texture_filter_anisotropic");if(Bt.type===1015&&t.has("OES_texture_float_linear")===!1||a===!1&&Bt.type===1016&&t.has("OES_texture_half_float_linear")===!1)return;(Bt.anisotropy>1||n.get(Bt).__currentAnisotropy)&&(i.texParameterf(Ct,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,r.getMaxAnisotropy())),n.get(Bt).__currentAnisotropy=Bt.anisotropy)}}function Pt(Ct,Bt){Ct.__webglInit===void 0&&(Ct.__webglInit=!0,Bt.addEventListener("dispose",gt),Ct.__webglTexture=i.createTexture(),s.memory.textures++)}function ee(Ct,Bt,ve){let le=3553;Bt.isDataTexture2DArray&&(le=35866),Bt.isDataTexture3D&&(le=32879),Pt(Ct,Bt),e.activeTexture(33984+ve),e.bindTexture(le,Ct.__webglTexture),i.pixelStorei(37440,Bt.flipY),i.pixelStorei(37441,Bt.premultiplyAlpha),i.pixelStorei(3317,Bt.unpackAlignment),i.pixelStorei(37443,0);const se=function(qt){return!a&&(qt.wrapS!==1001||qt.wrapT!==1001||qt.minFilter!==1003&&qt.minFilter!==1006)}(Bt)&&G(Bt.image)===!1,Ie=C(Bt.image,se,!1,u),De=G(Ie)||a,ce=o.convert(Bt.format);let Tt,jt=o.convert(Bt.type),ie=ft(Bt.internalFormat,ce,jt);Lt(le,Bt,De);const ae=Bt.mipmaps;if(Bt.isDepthTexture)ie=6402,a?ie=Bt.type===1015?36012:Bt.type===1014?33190:Bt.type===1020?35056:33189:Bt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Bt.format===1026&&ie===6402&&Bt.type!==1012&&Bt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Bt.type=1012,jt=o.convert(Bt.type)),Bt.format===1027&&ie===6402&&(ie=34041,Bt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Bt.type=1020,jt=o.convert(Bt.type))),e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ce,jt,null);else if(Bt.isDataTexture)if(ae.length>0&&De){for(let qt=0,ye=ae.length;qt<ye;qt++)Tt=ae[qt],e.texImage2D(3553,qt,ie,Tt.width,Tt.height,0,ce,jt,Tt.data);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ce,jt,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isCompressedTexture){for(let qt=0,ye=ae.length;qt<ye;qt++)Tt=ae[qt],Bt.format!==1023&&Bt.format!==1022?ce!==null?e.compressedTexImage2D(3553,qt,ie,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):e.texImage2D(3553,qt,ie,Tt.width,Tt.height,0,ce,jt,Tt.data);Ct.__maxMipLevel=ae.length-1}else if(Bt.isDataTexture2DArray)e.texImage3D(35866,0,ie,Ie.width,Ie.height,Ie.depth,0,ce,jt,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isDataTexture3D)e.texImage3D(32879,0,ie,Ie.width,Ie.height,Ie.depth,0,ce,jt,Ie.data),Ct.__maxMipLevel=0;else if(ae.length>0&&De){for(let qt=0,ye=ae.length;qt<ye;qt++)Tt=ae[qt],e.texImage2D(3553,qt,ie,ce,jt,Tt);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,ce,jt,Ie),Ct.__maxMipLevel=0;K(Bt,De)&&it(le,Bt,Ie.width,Ie.height),Ct.__version=Bt.version,Bt.onUpdate&&Bt.onUpdate(Bt)}function $t(Ct,Bt,ve,le,se){const Ie=o.convert(ve.format),De=o.convert(ve.type),ce=ft(ve.internalFormat,Ie,De);se===32879||se===35866?e.texImage3D(se,0,ce,Bt.width,Bt.height,Bt.depth,0,Ie,De,null):e.texImage2D(se,0,ce,Bt.width,Bt.height,0,Ie,De,null),e.bindFramebuffer(36160,Ct),i.framebufferTexture2D(36160,le,se,n.get(ve).__webglTexture,0),e.bindFramebuffer(36160,null)}function zt(Ct,Bt,ve){if(i.bindRenderbuffer(36161,Ct),Bt.depthBuffer&&!Bt.stencilBuffer){let le=33189;if(ve){const se=Bt.depthTexture;se&&se.isDepthTexture&&(se.type===1015?le=36012:se.type===1014&&(le=33190));const Ie=pe(Bt);i.renderbufferStorageMultisample(36161,Ie,le,Bt.width,Bt.height)}else i.renderbufferStorage(36161,le,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,36096,36161,Ct)}else if(Bt.depthBuffer&&Bt.stencilBuffer){if(ve){const le=pe(Bt);i.renderbufferStorageMultisample(36161,le,35056,Bt.width,Bt.height)}else i.renderbufferStorage(36161,34041,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,33306,36161,Ct)}else{const le=Bt.isWebGLMultipleRenderTargets===!0?Bt.texture[0]:Bt.texture,se=o.convert(le.format),Ie=o.convert(le.type),De=ft(le.internalFormat,se,Ie);if(ve){const ce=pe(Bt);i.renderbufferStorageMultisample(36161,ce,De,Bt.width,Bt.height)}else i.renderbufferStorage(36161,De,Bt.width,Bt.height)}i.bindRenderbuffer(36161,null)}function Xt(Ct){const Bt=n.get(Ct),ve=Ct.isWebGLCubeRenderTarget===!0;if(Ct.depthTexture){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");(function(le,se){if(se&&se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,le),!se.depthTexture||!se.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(se.depthTexture).__webglTexture&&se.depthTexture.image.width===se.width&&se.depthTexture.image.height===se.height||(se.depthTexture.image.width=se.width,se.depthTexture.image.height=se.height,se.depthTexture.needsUpdate=!0),Ut(se.depthTexture,0);const Ie=n.get(se.depthTexture).__webglTexture;if(se.depthTexture.format===1026)i.framebufferTexture2D(36160,36096,3553,Ie,0);else{if(se.depthTexture.format!==1027)throw new Error("Unknown depthTexture format");i.framebufferTexture2D(36160,33306,3553,Ie,0)}})(Bt.__webglFramebuffer,Ct)}else if(ve){Bt.__webglDepthbuffer=[];for(let le=0;le<6;le++)e.bindFramebuffer(36160,Bt.__webglFramebuffer[le]),Bt.__webglDepthbuffer[le]=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer[le],Ct,!1)}else e.bindFramebuffer(36160,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer,Ct,!1);e.bindFramebuffer(36160,null)}function pe(Ct){return a&&Ct.isWebGLMultisampleRenderTarget?Math.min(p,Ct.samples):0}let be=!1,Pe=!1;this.allocateTextureUnit=function(){const Ct=dt;return Ct>=l&&console.warn("THREE.WebGLTextures: Trying to use "+Ct+" texture units while this GPU supports only "+l),dt+=1,Ct},this.resetTextureUnits=function(){dt=0},this.setTexture2D=Ut,this.setTexture2DArray=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ee(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(35866,ve.__webglTexture))},this.setTexture3D=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ee(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(32879,ve.__webglTexture))},this.setTextureCube=Ft,this.setupRenderTarget=function(Ct){const Bt=Ct.texture,ve=n.get(Ct),le=n.get(Bt);Ct.addEventListener("dispose",lt),Ct.isWebGLMultipleRenderTargets!==!0&&(le.__webglTexture=i.createTexture(),le.__version=Bt.version,s.memory.textures++);const se=Ct.isWebGLCubeRenderTarget===!0,Ie=Ct.isWebGLMultipleRenderTargets===!0,De=Ct.isWebGLMultisampleRenderTarget===!0,ce=Bt.isDataTexture3D||Bt.isDataTexture2DArray,Tt=G(Ct)||a;if(!a||Bt.format!==1022||Bt.type!==1015&&Bt.type!==1016||(Bt.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),se){ve.__webglFramebuffer=[];for(let jt=0;jt<6;jt++)ve.__webglFramebuffer[jt]=i.createFramebuffer()}else if(ve.__webglFramebuffer=i.createFramebuffer(),Ie)if(r.drawBuffers){const jt=Ct.texture;for(let ie=0,ae=jt.length;ie<ae;ie++){const qt=n.get(jt[ie]);qt.__webglTexture===void 0&&(qt.__webglTexture=i.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(De)if(a){ve.__webglMultisampledFramebuffer=i.createFramebuffer(),ve.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,ve.__webglColorRenderbuffer);const jt=o.convert(Bt.format),ie=o.convert(Bt.type),ae=ft(Bt.internalFormat,jt,ie),qt=pe(Ct);i.renderbufferStorageMultisample(36161,qt,ae,Ct.width,Ct.height),e.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,ve.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),Ct.depthBuffer&&(ve.__webglDepthRenderbuffer=i.createRenderbuffer(),zt(ve.__webglDepthRenderbuffer,Ct,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(se){e.bindTexture(34067,le.__webglTexture),Lt(34067,Bt,Tt);for(let jt=0;jt<6;jt++)$t(ve.__webglFramebuffer[jt],Ct,Bt,36064,34069+jt);K(Bt,Tt)&&it(34067,Bt,Ct.width,Ct.height),e.bindTexture(34067,null)}else if(Ie){const jt=Ct.texture;for(let ie=0,ae=jt.length;ie<ae;ie++){const qt=jt[ie],ye=n.get(qt);e.bindTexture(3553,ye.__webglTexture),Lt(3553,qt,Tt),$t(ve.__webglFramebuffer,Ct,qt,36064+ie,3553),K(qt,Tt)&&it(3553,qt,Ct.width,Ct.height)}e.bindTexture(3553,null)}else{let jt=3553;ce&&(a?jt=Bt.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(jt,le.__webglTexture),Lt(jt,Bt,Tt),$t(ve.__webglFramebuffer,Ct,Bt,36064,jt),K(Bt,Tt)&&it(jt,Bt,Ct.width,Ct.height,Ct.depth),e.bindTexture(jt,null)}Ct.depthBuffer&&Xt(Ct)},this.updateRenderTargetMipmap=function(Ct){const Bt=G(Ct)||a,ve=Ct.isWebGLMultipleRenderTargets===!0?Ct.texture:[Ct.texture];for(let le=0,se=ve.length;le<se;le++){const Ie=ve[le];if(K(Ie,Bt)){const De=Ct.isWebGLCubeRenderTarget?34067:3553,ce=n.get(Ie).__webglTexture;e.bindTexture(De,ce),it(De,Ie,Ct.width,Ct.height),e.bindTexture(De,null)}}},this.updateMultisampleRenderTarget=function(Ct){if(Ct.isWebGLMultisampleRenderTarget)if(a){const Bt=Ct.width,ve=Ct.height;let le=16384;Ct.depthBuffer&&(le|=256),Ct.stencilBuffer&&(le|=1024);const se=n.get(Ct);e.bindFramebuffer(36008,se.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,se.__webglFramebuffer),i.blitFramebuffer(0,0,Bt,ve,0,0,Bt,ve,le,9728),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ct,Bt){Ct&&Ct.isWebGLRenderTarget&&(be===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),be=!0),Ct=Ct.texture),Ut(Ct,Bt)},this.safeSetTextureCube=function(Ct,Bt){Ct&&Ct.isWebGLCubeRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Pe=!0),Ct=Ct.texture),Ft(Ct,Bt)}}function iy(i,t,e){const n=e.isWebGL2;return{convert:function(r){let o;if(r===1009)return 5121;if(r===1017)return 32819;if(r===1018)return 32820;if(r===1019)return 33635;if(r===1010)return 5120;if(r===1011)return 5122;if(r===1012)return 5123;if(r===1013)return 5124;if(r===1014)return 5125;if(r===1015)return 5126;if(r===1016)return n?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(r===1021)return 6406;if(r===1022)return 6407;if(r===1023)return 6408;if(r===1024)return 6409;if(r===1025)return 6410;if(r===1026)return 6402;if(r===1027)return 34041;if(r===1028)return 6403;if(r===1029)return 36244;if(r===1030)return 33319;if(r===1031)return 33320;if(r===1032)return 36248;if(r===1033)return 36249;if(r===33776||r===33777||r===33778||r===33779){if(o=t.get("WEBGL_compressed_texture_s3tc"),o===null)return null;if(r===33776)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===33777)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===33778)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===33779)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===35840||r===35841||r===35842||r===35843){if(o=t.get("WEBGL_compressed_texture_pvrtc"),o===null)return null;if(r===35840)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===35841)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===35842)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===35843)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===36196)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((r===37492||r===37496)&&(o=t.get("WEBGL_compressed_texture_etc"),o!==null)){if(r===37492)return o.COMPRESSED_RGB8_ETC2;if(r===37496)return o.COMPRESSED_RGBA8_ETC2_EAC}return r===37808||r===37809||r===37810||r===37811||r===37812||r===37813||r===37814||r===37815||r===37816||r===37817||r===37818||r===37819||r===37820||r===37821||r===37840||r===37841||r===37842||r===37843||r===37844||r===37845||r===37846||r===37847||r===37848||r===37849||r===37850||r===37851||r===37852||r===37853?(o=t.get("WEBGL_compressed_texture_astc"),o!==null?r:null):r===36492?(o=t.get("EXT_texture_compression_bptc"),o!==null?r:null):r===1020?n?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class rp extends un{constructor(t=[]){super(),this.cameras=t}}rp.prototype.isArrayCamera=!0;class Cs extends kn{constructor(){super(),this.type="Group"}}Cs.prototype.isGroup=!0;const ry={type:"move"};class fu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Cs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Cs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Cs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,h=this._hand;if(t&&e.session.visibilityState!=="visible-blurred")if(a!==null&&(r=e.getPose(t.targetRaySpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(ry))),h&&t.hand){s=!0;for(const A of t.hand.values()){const C=e.getJointPose(A,n);if(h.joints[A.jointName]===void 0){const K=new Cs;K.matrixAutoUpdate=!1,K.visible=!1,h.joints[A.jointName]=K,h.add(K)}const G=h.joints[A.jointName];C!==null&&(G.matrix.fromArray(C.transform.matrix),G.matrix.decompose(G.position,G.rotation,G.scale),G.jointRadius=C.radius),G.visible=C!==null}const u=h.joints["index-finger-tip"],p=h.joints["thumb-tip"],_=u.position.distanceTo(p.position),x=.02,w=.005;h.inputState.pinching&&_>x+w?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&_<=x-w&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(o=e.getPose(t.gripSpace,n),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),h!==null&&(h.visible=s!==null),this}}class oy extends D{constructor(t,e){super();const n=this,r=t.state;let o=null,s=1,a=null,l="local-floor",h=null,u=null,p=null,_=null;const x=[],w=new Map,A=new un;A.layers.enable(1),A.viewport=new Ot;const C=new un;C.layers.enable(2),C.viewport=new Ot;const G=[A,C],K=new rp;K.layers.enable(1),K.layers.enable(2);let it=null,ft=null;function nt(Lt){const Pt=w.get(Lt.inputSource);Pt&&Pt.dispatchEvent({type:Lt.type,data:Lt.inputSource})}function gt(){w.forEach(function(Lt,Pt){Lt.disconnect(Pt)}),w.clear(),it=null,ft=null,r.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),Mt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function lt(Lt){const Pt=o.inputSources;for(let ee=0;ee<x.length;ee++)w.set(Pt[ee],x[ee]);for(let ee=0;ee<Lt.removed.length;ee++){const $t=Lt.removed[ee],zt=w.get($t);zt&&(zt.dispatchEvent({type:"disconnected",data:$t}),w.delete($t))}for(let ee=0;ee<Lt.added.length;ee++){const $t=Lt.added[ee],zt=w.get($t);zt&&zt.dispatchEvent({type:"connected",data:$t})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Lt){let Pt=x[Lt];return Pt===void 0&&(Pt=new fu,x[Lt]=Pt),Pt.getTargetRaySpace()},this.getControllerGrip=function(Lt){let Pt=x[Lt];return Pt===void 0&&(Pt=new fu,x[Lt]=Pt),Pt.getGripSpace()},this.getHand=function(Lt){let Pt=x[Lt];return Pt===void 0&&(Pt=new fu,x[Lt]=Pt),Pt.getHandSpace()},this.setFramebufferScaleFactor=function(Lt){s=Lt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Lt){l=Lt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return o},this.setSession=async function(Lt){if(o=Lt,o!==null){o.addEventListener("select",nt),o.addEventListener("selectstart",nt),o.addEventListener("selectend",nt),o.addEventListener("squeeze",nt),o.addEventListener("squeezestart",nt),o.addEventListener("squeezeend",nt),o.addEventListener("end",gt),o.addEventListener("inputsourceschange",lt);const Pt=e.getContextAttributes();if(Pt.xrCompatible!==!0&&await e.makeXRCompatible(),o.renderState.layers===void 0){const ee={antialias:Pt.antialias,alpha:Pt.alpha,depth:Pt.depth,stencil:Pt.stencil,framebufferScaleFactor:s},$t=new XRWebGLLayer(o,e,ee);o.updateRenderState({baseLayer:$t})}else{let ee=0;Pt.depth&&(ee=Pt.stencil?34041:6402);const $t={colorFormat:Pt.alpha?6408:6407,depthFormat:ee,scaleFactor:s};u=new XRWebGLBinding(o,e),_=u.createProjectionLayer($t),p=e.createFramebuffer(),o.updateRenderState({layers:[_]})}a=await o.requestReferenceSpace(l),Mt.setContext(o),Mt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const dt=new k,Ut=new k;function Ft(Lt,Pt){Pt===null?Lt.matrixWorld.copy(Lt.matrix):Lt.matrixWorld.multiplyMatrices(Pt.matrixWorld,Lt.matrix),Lt.matrixWorldInverse.copy(Lt.matrixWorld).invert()}this.updateCamera=function(Lt){if(o===null)return;K.near=C.near=A.near=Lt.near,K.far=C.far=A.far=Lt.far,it===K.near&&ft===K.far||(o.updateRenderState({depthNear:K.near,depthFar:K.far}),it=K.near,ft=K.far);const Pt=Lt.parent,ee=K.cameras;Ft(K,Pt);for(let zt=0;zt<ee.length;zt++)Ft(ee[zt],Pt);K.matrixWorld.decompose(K.position,K.quaternion,K.scale),Lt.position.copy(K.position),Lt.quaternion.copy(K.quaternion),Lt.scale.copy(K.scale),Lt.matrix.copy(K.matrix),Lt.matrixWorld.copy(K.matrixWorld);const $t=Lt.children;for(let zt=0,Xt=$t.length;zt<Xt;zt++)$t[zt].updateMatrixWorld(!0);ee.length===2?function(zt,Xt,pe){dt.setFromMatrixPosition(Xt.matrixWorld),Ut.setFromMatrixPosition(pe.matrixWorld);const be=dt.distanceTo(Ut),Pe=Xt.projectionMatrix.elements,Ct=pe.projectionMatrix.elements,Bt=Pe[14]/(Pe[10]-1),ve=Pe[14]/(Pe[10]+1),le=(Pe[9]+1)/Pe[5],se=(Pe[9]-1)/Pe[5],Ie=(Pe[8]-1)/Pe[0],De=(Ct[8]+1)/Ct[0],ce=Bt*Ie,Tt=Bt*De,jt=be/(-Ie+De),ie=jt*-Ie;Xt.matrixWorld.decompose(zt.position,zt.quaternion,zt.scale),zt.translateX(ie),zt.translateZ(jt),zt.matrixWorld.compose(zt.position,zt.quaternion,zt.scale),zt.matrixWorldInverse.copy(zt.matrixWorld).invert();const ae=Bt+jt,qt=ve+jt,ye=ce-ie,nn=Tt+(be-ie),on=le*ve/qt*ae,rn=se*ve/qt*ae;zt.projectionMatrix.makePerspective(ye,nn,on,rn,ae,qt)}(K,A,C):K.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return K};let Et=null;const Mt=new rs;Mt.setAnimationLoop(function(Lt,Pt){if(h=Pt.getViewerPose(a),h!==null){const $t=h.views,zt=o.renderState.baseLayer;o.renderState.layers===void 0&&r.bindXRFramebuffer(zt.framebuffer);let Xt=!1;$t.length!==K.cameras.length&&(K.cameras.length=0,Xt=!0);for(let pe=0;pe<$t.length;pe++){const be=$t[pe];let Pe=null;if(o.renderState.layers===void 0)Pe=zt.getViewport(be);else{const Bt=u.getViewSubImage(_,be);r.bindXRFramebuffer(p),e.framebufferTexture2D(36160,36064,3553,Bt.colorTexture,0),Bt.depthStencilTexture!==void 0&&e.framebufferTexture2D(36160,36096,3553,Bt.depthStencilTexture,0),Pe=Bt.viewport}const Ct=G[pe];Ct.matrix.fromArray(be.transform.matrix),Ct.projectionMatrix.fromArray(be.projectionMatrix),Ct.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),pe===0&&K.matrix.copy(Ct.matrix),Xt===!0&&K.cameras.push(Ct)}}const ee=o.inputSources;for(let $t=0;$t<x.length;$t++){const zt=x[$t],Xt=ee[$t];zt.update(Xt,Pt,a)}Et&&Et(Lt,Pt)}),this.setAnimationLoop=function(Lt){Et=Lt},this.dispose=function(){}}}function sy(i){function t(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.specularMap&&(n.specularMap.value=r.specularMap);const o=i.get(r).envMap;if(o){n.envMap.value=o,n.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,n.reflectivity.value=r.reflectivity,n.refractionRatio.value=r.refractionRatio;const l=i.get(o).__maxMipLevel;l!==void 0&&(n.maxMipLevel.value=l)}let s,a;r.lightMap&&(n.lightMap.value=r.lightMap,n.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?s=r.map:r.specularMap?s=r.specularMap:r.displacementMap?s=r.displacementMap:r.normalMap?s=r.normalMap:r.bumpMap?s=r.bumpMap:r.roughnessMap?s=r.roughnessMap:r.metalnessMap?s=r.metalnessMap:r.alphaMap?s=r.alphaMap:r.emissiveMap?s=r.emissiveMap:r.clearcoatMap?s=r.clearcoatMap:r.clearcoatNormalMap?s=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(s=r.clearcoatRoughnessMap),s!==void 0&&(s.isWebGLRenderTarget&&(s=s.texture),s.matrixAutoUpdate===!0&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}function e(n,r){n.roughness.value=r.roughness,n.metalness.value=r.metalness,r.roughnessMap&&(n.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(n.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===1&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===1&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),i.get(r).envMap&&(n.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(n,r){n.fogColor.value.copy(r.color),r.isFog?(n.fogNear.value=r.near,n.fogFar.value=r.far):r.isFogExp2&&(n.fogDensity.value=r.density)},refreshMaterialUniforms:function(n,r,o,s,a){r.isMeshBasicMaterial?t(n,r):r.isMeshLambertMaterial?(t(n,r),function(l,h){h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap)}(n,r)):r.isMeshToonMaterial?(t(n,r),function(l,h){h.gradientMap&&(l.gradientMap.value=h.gradientMap),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshPhongMaterial?(t(n,r),function(l,h){l.specular.value.copy(h.specular),l.shininess.value=Math.max(h.shininess,1e-4),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshStandardMaterial?(t(n,r),r.isMeshPhysicalMaterial?function(l,h,u){e(l,h),l.reflectivity.value=h.reflectivity,l.clearcoat.value=h.clearcoat,l.clearcoatRoughness.value=h.clearcoatRoughness,h.sheen&&l.sheen.value.copy(h.sheen),h.clearcoatMap&&(l.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(l.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(l.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),l.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===1&&l.clearcoatNormalScale.value.negate()),l.transmission.value=h.transmission,h.transmissionMap&&(l.transmissionMap.value=h.transmissionMap),h.transmission>0&&(l.transmissionSamplerMap.value=u.texture,l.transmissionSamplerSize.value.set(u.width,u.height)),l.thickness.value=h.thickness,h.thicknessMap&&(l.thicknessMap.value=h.thicknessMap),l.attenuationDistance.value=h.attenuationDistance,l.attenuationColor.value.copy(h.attenuationColor)}(n,r,a):e(n,r)):r.isMeshMatcapMaterial?(t(n,r),function(l,h){h.matcap&&(l.matcap.value=h.matcap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDepthMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDistanceMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias),l.referencePosition.value.copy(h.referencePosition),l.nearDistance.value=h.nearDistance,l.farDistance.value=h.farDistance}(n,r)):r.isMeshNormalMaterial?(t(n,r),function(l,h){h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isLineBasicMaterial?(function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity}(n,r),r.isLineDashedMaterial&&function(l,h){l.dashSize.value=h.dashSize,l.totalSize.value=h.dashSize+h.gapSize,l.scale.value=h.scale}(n,r)):r.isPointsMaterial?function(l,h,u,p){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.size.value=h.size*u,l.scale.value=.5*p,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let _;h.map?_=h.map:h.alphaMap&&(_=h.alphaMap),_!==void 0&&(_.matrixAutoUpdate===!0&&_.updateMatrix(),l.uvTransform.value.copy(_.matrix))}(n,r,o,s):r.isSpriteMaterial?function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.rotation.value=h.rotation,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let u;h.map?u=h.map:h.alphaMap&&(u=h.alphaMap),u!==void 0&&(u.matrixAutoUpdate===!0&&u.updateMatrix(),l.uvTransform.value.copy(u.matrix))}(n,r):r.isShadowMaterial?(n.color.value.copy(r.color),n.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ti(i={}){const t=i.canvas!==void 0?i.canvas:function(){const Ht=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Ht.style.display="block",Ht}(),e=i.context!==void 0?i.context:null,n=i.alpha!==void 0&&i.alpha,r=i.depth===void 0||i.depth,o=i.stencil===void 0||i.stencil,s=i.antialias!==void 0&&i.antialias,a=i.premultipliedAlpha===void 0||i.premultipliedAlpha,l=i.preserveDrawingBuffer!==void 0&&i.preserveDrawingBuffer,h=i.powerPreference!==void 0?i.powerPreference:"default",u=i.failIfMajorPerformanceCaveat!==void 0&&i.failIfMajorPerformanceCaveat;let p=null,_=null;const x=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const A=this;let C=!1,G=0,K=0,it=null,ft=-1,nt=null;const gt=new Ot,lt=new Ot;let dt=null,Ut=t.width,Ft=t.height,Et=1,Mt=null,Lt=null;const Pt=new Ot(0,0,Ut,Ft),ee=new Ot(0,0,Ut,Ft);let $t=!1;const zt=[],Xt=new kr;let pe=!1,be=!1,Pe=null;const Ct=new tn,Bt=new k,ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return it===null?Et:1}let se,Ie,De,ce,Tt,jt,ie,ae,qt,ye,nn,on,rn,Sn,Ci,Jn,mr,nl,il,rl,ur,gr,He=e;function Wg(Ht,Ce){for(let me=0;me<Ht.length;me++){const Re=Ht[me],Xe=t.getContext(Re,Ce);if(Xe!==null)return Xe}return null}try{const Ht={alpha:n,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",Yg,!1),t.addEventListener("webglcontextrestored",qg,!1),He===null){const Ce=["webgl2","webgl","experimental-webgl"];if(A.isWebGL1Renderer===!0&&Ce.shift(),He=Wg(Ce,Ht),He===null)throw Wg(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}He.getShaderPrecisionFormat===void 0&&(He.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ht){throw console.error("THREE.WebGLRenderer: "+Ht.message),Ht}function Xg(){se=new fl(He),Ie=new tu(He,se,i),se.init(Ie),ur=new iy(He,se,Ie),De=new ey(He,se,Ie),zt[0]=1029,ce=new ou,Tt=new Y_,jt=new ny(He,se,De,Tt,Ie,ur,ce),ie=new nu(A),ae=new os(He,Ie),gr=new ho(He,se,ae,Ie),qt=new iu(He,ae,ce,gr),ye=new lu(He,qt,ae,ce),nl=new au(He),Ci=new eu(Tt),nn=new X_(A,ie,se,Ie,gr,Ci),on=new sy(Tt),rn=new J_(Tt),Sn=new ty(se,Ie),mr=new Qh(A,ie,De,ye,a),Jn=new ip(A,ye,Ie),il=new ss(He,se,ce,Ie),rl=new ru(He,se,ce,Ie),ce.programs=nn.programs,A.capabilities=Ie,A.extensions=se,A.properties=Tt,A.renderLists=rn,A.shadowMap=Jn,A.state=De,A.info=ce}Xg();const Sr=new oy(A,He);function Yg(Ht){Ht.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function qg(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const Ht=ce.autoReset,Ce=Jn.enabled,me=Jn.autoUpdate,Re=Jn.needsUpdate,Xe=Jn.type;Xg(),ce.autoReset=Ht,Jn.enabled=Ce,Jn.autoUpdate=me,Jn.needsUpdate=Re,Jn.type=Xe}function Jg(Ht){const Ce=Ht.target;Ce.removeEventListener("dispose",Jg),function(me){(function(Re){const Xe=Tt.get(Re).programs;Xe!==void 0&&Xe.forEach(function(Vn){nn.releaseProgram(Vn)})})(me),Tt.remove(me)}(Ce)}this.xr=Sr,this.getContext=function(){return He},this.getContextAttributes=function(){return He.getContextAttributes()},this.forceContextLoss=function(){const Ht=se.get("WEBGL_lose_context");Ht&&Ht.loseContext()},this.forceContextRestore=function(){const Ht=se.get("WEBGL_lose_context");Ht&&Ht.restoreContext()},this.getPixelRatio=function(){return Et},this.setPixelRatio=function(Ht){Ht!==void 0&&(Et=Ht,this.setSize(Ut,Ft,!1))},this.getSize=function(Ht){return Ht.set(Ut,Ft)},this.setSize=function(Ht,Ce,me){Sr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ut=Ht,Ft=Ce,t.width=Math.floor(Ht*Et),t.height=Math.floor(Ce*Et),me!==!1&&(t.style.width=Ht+"px",t.style.height=Ce+"px"),this.setViewport(0,0,Ht,Ce))},this.getDrawingBufferSize=function(Ht){return Ht.set(Ut*Et,Ft*Et).floor()},this.setDrawingBufferSize=function(Ht,Ce,me){Ut=Ht,Ft=Ce,Et=me,t.width=Math.floor(Ht*me),t.height=Math.floor(Ce*me),this.setViewport(0,0,Ht,Ce)},this.getCurrentViewport=function(Ht){return Ht.copy(gt)},this.getViewport=function(Ht){return Ht.copy(Pt)},this.setViewport=function(Ht,Ce,me,Re){Ht.isVector4?Pt.set(Ht.x,Ht.y,Ht.z,Ht.w):Pt.set(Ht,Ce,me,Re),De.viewport(gt.copy(Pt).multiplyScalar(Et).floor())},this.getScissor=function(Ht){return Ht.copy(ee)},this.setScissor=function(Ht,Ce,me,Re){Ht.isVector4?ee.set(Ht.x,Ht.y,Ht.z,Ht.w):ee.set(Ht,Ce,me,Re),De.scissor(lt.copy(ee).multiplyScalar(Et).floor())},this.getScissorTest=function(){return $t},this.setScissorTest=function(Ht){De.setScissorTest($t=Ht)},this.setOpaqueSort=function(Ht){Mt=Ht},this.setTransparentSort=function(Ht){Lt=Ht},this.getClearColor=function(Ht){return Ht.copy(mr.getClearColor())},this.setClearColor=function(){mr.setClearColor.apply(mr,arguments)},this.getClearAlpha=function(){return mr.getClearAlpha()},this.setClearAlpha=function(){mr.setClearAlpha.apply(mr,arguments)},this.clear=function(Ht,Ce,me){let Re=0;(Ht===void 0||Ht)&&(Re|=16384),(Ce===void 0||Ce)&&(Re|=256),(me===void 0||me)&&(Re|=1024),He.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Yg,!1),t.removeEventListener("webglcontextrestored",qg,!1),rn.dispose(),Sn.dispose(),Tt.dispose(),ie.dispose(),ye.dispose(),gr.dispose(),Sr.dispose(),Sr.removeEventListener("sessionstart",Zg),Sr.removeEventListener("sessionend",Kg),Pe&&(Pe.dispose(),Pe=null),xs.stop()},this.renderBufferImmediate=function(Ht,Ce){gr.initAttributes();const me=Tt.get(Ht);Ht.hasPositions&&!me.position&&(me.position=He.createBuffer()),Ht.hasNormals&&!me.normal&&(me.normal=He.createBuffer()),Ht.hasUvs&&!me.uv&&(me.uv=He.createBuffer()),Ht.hasColors&&!me.color&&(me.color=He.createBuffer());const Re=Ce.getAttributes();Ht.hasPositions&&(He.bindBuffer(34962,me.position),He.bufferData(34962,Ht.positionArray,35048),gr.enableAttribute(Re.position),He.vertexAttribPointer(Re.position,3,5126,!1,0,0)),Ht.hasNormals&&(He.bindBuffer(34962,me.normal),He.bufferData(34962,Ht.normalArray,35048),gr.enableAttribute(Re.normal),He.vertexAttribPointer(Re.normal,3,5126,!1,0,0)),Ht.hasUvs&&(He.bindBuffer(34962,me.uv),He.bufferData(34962,Ht.uvArray,35048),gr.enableAttribute(Re.uv),He.vertexAttribPointer(Re.uv,2,5126,!1,0,0)),Ht.hasColors&&(He.bindBuffer(34962,me.color),He.bufferData(34962,Ht.colorArray,35048),gr.enableAttribute(Re.color),He.vertexAttribPointer(Re.color,3,5126,!1,0,0)),gr.disableUnusedAttributes(),He.drawArrays(4,0,Ht.count),Ht.count=0},this.renderBufferDirect=function(Ht,Ce,me,Re,Xe,Vn){Ce===null&&(Ce=ve);const En=Xe.isMesh&&Xe.matrixWorld.determinant()<0,Ke=tv(Ht,Ce,Re,Xe);De.setMaterial(Re,En);let Nn=me.index;const mn=me.attributes.position;if(Nn===null){if(mn===void 0||mn.count===0)return}else if(Nn.count===0)return;let zn,wn=1;Re.wireframe===!0&&(Nn=qt.getWireframeAttribute(me),wn=2),(Re.morphTargets||Re.morphNormals)&&nl.update(Xe,me,Re,Ke),gr.setup(Xe,Re,Ke,me,Nn);let Hn=il;Nn!==null&&(zn=ae.get(Nn),Hn=rl,Hn.setIndex(zn));const Di=Nn!==null?Nn.count:mn.count,hi=me.drawRange.start*wn,Wr=me.drawRange.count*wn,si=Vn!==null?Vn.start*wn:0,io=Vn!==null?Vn.count*wn:1/0,zi=Math.max(hi,si),Er=Math.min(Di,hi+Wr,si+io)-1,sr=Math.max(0,Er-zi+1);if(sr!==0){if(Xe.isMesh)Re.wireframe===!0?(De.setLineWidth(Re.wireframeLinewidth*le()),Hn.setMode(1)):Hn.setMode(4);else if(Xe.isLine){let ol=Re.linewidth;ol===void 0&&(ol=1),De.setLineWidth(ol*le()),Xe.isLineSegments?Hn.setMode(1):Xe.isLineLoop?Hn.setMode(2):Hn.setMode(3)}else Xe.isPoints?Hn.setMode(0):Xe.isSprite&&Hn.setMode(4);if(Xe.isInstancedMesh)Hn.renderInstances(zi,sr,Xe.count);else if(me.isInstancedBufferGeometry){const ol=Math.min(me.instanceCount,me._maxInstanceCount);Hn.renderInstances(zi,sr,ol)}else Hn.render(zi,sr)}},this.compile=function(Ht,Ce){_=Sn.get(Ht),_.init(),Ht.traverseVisible(function(me){me.isLight&&me.layers.test(Ce.layers)&&(_.pushLight(me),me.castShadow&&_.pushShadow(me))}),_.setupLights(),Ht.traverse(function(me){const Re=me.material;if(Re)if(Array.isArray(Re))for(let Xe=0;Xe<Re.length;Xe++)qc(Re[Xe],Ht,me);else qc(Re,Ht,me)})};let Yc=null;function Zg(){xs.stop()}function Kg(){xs.start()}const xs=new rs;function Lh(Ht,Ce,me){const Re=Ce.isScene===!0?Ce.overrideMaterial:null;for(let Xe=0,Vn=Ht.length;Xe<Vn;Xe++){const En=Ht[Xe],Ke=En.object,Nn=En.geometry,mn=Re===null?En.material:Re,zn=En.group;if(me.isArrayCamera){const wn=me.cameras;for(let Hn=0,Di=wn.length;Hn<Di;Hn++){const hi=wn[Hn];Ke.layers.test(hi.layers)&&(De.viewport(gt.copy(hi.viewport)),_.setupLightsView(hi),$g(Ke,Ce,hi,Nn,mn,zn))}}else $g(Ke,Ce,me,Nn,mn,zn)}}function $g(Ht,Ce,me,Re,Xe,Vn){if(Ht.onBeforeRender(A,Ce,me,Re,Xe,Vn),Ht.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,Ht.matrixWorld),Ht.normalMatrix.getNormalMatrix(Ht.modelViewMatrix),Ht.isImmediateRenderObject){const En=tv(me,Ce,Xe,Ht);De.setMaterial(Xe),gr.reset(),function(Ke,Nn){Ke.render(function(mn){A.renderBufferImmediate(mn,Nn)})}(Ht,En)}else Xe.transparent===!0&&Xe.side===2?(Xe.side=1,Xe.needsUpdate=!0,A.renderBufferDirect(me,Ce,Re,Xe,Ht,Vn),Xe.side=0,Xe.needsUpdate=!0,A.renderBufferDirect(me,Ce,Re,Xe,Ht,Vn),Xe.side=2):A.renderBufferDirect(me,Ce,Re,Xe,Ht,Vn);Ht.onAfterRender(A,Ce,me,Re,Xe,Vn)}function qc(Ht,Ce,me){Ce.isScene!==!0&&(Ce=ve);const Re=Tt.get(Ht),Xe=_.state.lights,Vn=_.state.shadowsArray,En=Xe.state.version,Ke=nn.getParameters(Ht,Xe.state,Vn,Ce,me),Nn=nn.getProgramCacheKey(Ke);let mn=Re.programs;Re.environment=Ht.isMeshStandardMaterial?Ce.environment:null,Re.fog=Ce.fog,Re.envMap=ie.get(Ht.envMap||Re.environment),mn===void 0&&(Ht.addEventListener("dispose",Jg),mn=new Map,Re.programs=mn);let zn=mn.get(Nn);if(zn!==void 0){if(Re.currentProgram===zn&&Re.lightsStateVersion===En)return Qg(Ht,Ke),zn}else Ke.uniforms=nn.getUniforms(Ht),Ht.onBuild(Ke,A),Ht.onBeforeCompile(Ke,A),zn=nn.acquireProgram(Ke,Nn),mn.set(Nn,zn),Re.uniforms=Ke.uniforms;const wn=Re.uniforms;(Ht.isShaderMaterial||Ht.isRawShaderMaterial)&&Ht.clipping!==!0||(wn.clippingPlanes=Ci.uniform),Qg(Ht,Ke),Re.needsLights=function(hi){return hi.isMeshLambertMaterial||hi.isMeshToonMaterial||hi.isMeshPhongMaterial||hi.isMeshStandardMaterial||hi.isShadowMaterial||hi.isShaderMaterial&&hi.lights===!0}(Ht),Re.lightsStateVersion=En,Re.needsLights&&(wn.ambientLightColor.value=Xe.state.ambient,wn.lightProbe.value=Xe.state.probe,wn.directionalLights.value=Xe.state.directional,wn.directionalLightShadows.value=Xe.state.directionalShadow,wn.spotLights.value=Xe.state.spot,wn.spotLightShadows.value=Xe.state.spotShadow,wn.rectAreaLights.value=Xe.state.rectArea,wn.ltc_1.value=Xe.state.rectAreaLTC1,wn.ltc_2.value=Xe.state.rectAreaLTC2,wn.pointLights.value=Xe.state.point,wn.pointLightShadows.value=Xe.state.pointShadow,wn.hemisphereLights.value=Xe.state.hemi,wn.directionalShadowMap.value=Xe.state.directionalShadowMap,wn.directionalShadowMatrix.value=Xe.state.directionalShadowMatrix,wn.spotShadowMap.value=Xe.state.spotShadowMap,wn.spotShadowMatrix.value=Xe.state.spotShadowMatrix,wn.pointShadowMap.value=Xe.state.pointShadowMap,wn.pointShadowMatrix.value=Xe.state.pointShadowMatrix);const Hn=zn.getUniforms(),Di=ri.seqWithValue(Hn.seq,wn);return Re.currentProgram=zn,Re.uniformsList=Di,zn}function Qg(Ht,Ce){const me=Tt.get(Ht);me.outputEncoding=Ce.outputEncoding,me.instancing=Ce.instancing,me.skinning=Ce.skinning,me.numClippingPlanes=Ce.numClippingPlanes,me.numIntersection=Ce.numClipIntersection,me.vertexAlphas=Ce.vertexAlphas}function tv(Ht,Ce,me,Re){Ce.isScene!==!0&&(Ce=ve),jt.resetTextureUnits();const Xe=Ce.fog,Vn=me.isMeshStandardMaterial?Ce.environment:null,En=it===null?A.outputEncoding:it.texture.encoding,Ke=ie.get(me.envMap||Vn),Nn=me.vertexColors===!0&&Re.geometry&&Re.geometry.attributes.color&&Re.geometry.attributes.color.itemSize===4,mn=Tt.get(me),zn=_.state.lights;if(pe===!0&&(be===!0||Ht!==nt)){const sr=Ht===nt&&me.id===ft;Ci.setState(me,Ht,sr)}let wn=!1;me.version===mn.__version?mn.needsLights&&mn.lightsStateVersion!==zn.state.version||mn.outputEncoding!==En||Re.isInstancedMesh&&mn.instancing===!1?wn=!0:Re.isInstancedMesh||mn.instancing!==!0?Re.isSkinnedMesh&&mn.skinning===!1?wn=!0:Re.isSkinnedMesh||mn.skinning!==!0?mn.envMap!==Ke||me.fog&&mn.fog!==Xe?wn=!0:mn.numClippingPlanes===void 0||mn.numClippingPlanes===Ci.numPlanes&&mn.numIntersection===Ci.numIntersection?mn.vertexAlphas!==Nn&&(wn=!0):wn=!0:wn=!0:wn=!0:(wn=!0,mn.__version=me.version);let Hn=mn.currentProgram;wn===!0&&(Hn=qc(me,Ce,Re));let Di=!1,hi=!1,Wr=!1;const si=Hn.getUniforms(),io=mn.uniforms;if(De.useProgram(Hn.program)&&(Di=!0,hi=!0,Wr=!0),me.id!==ft&&(ft=me.id,hi=!0),Di||nt!==Ht){if(si.setValue(He,"projectionMatrix",Ht.projectionMatrix),Ie.logarithmicDepthBuffer&&si.setValue(He,"logDepthBufFC",2/(Math.log(Ht.far+1)/Math.LN2)),nt!==Ht&&(nt=Ht,hi=!0,Wr=!0),me.isShaderMaterial||me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshStandardMaterial||me.envMap){const sr=si.map.cameraPosition;sr!==void 0&&sr.setValue(He,Bt.setFromMatrixPosition(Ht.matrixWorld))}(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&si.setValue(He,"isOrthographic",Ht.isOrthographicCamera===!0),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial||me.isShadowMaterial||Re.isSkinnedMesh)&&si.setValue(He,"viewMatrix",Ht.matrixWorldInverse)}if(Re.isSkinnedMesh){si.setOptional(He,Re,"bindMatrix"),si.setOptional(He,Re,"bindMatrixInverse");const sr=Re.skeleton;sr&&(Ie.floatVertexTextures?(sr.boneTexture===null&&sr.computeBoneTexture(),si.setValue(He,"boneTexture",sr.boneTexture,jt),si.setValue(He,"boneTextureSize",sr.boneTextureSize)):si.setOptional(He,sr,"boneMatrices"))}var zi,Er;return(hi||mn.receiveShadow!==Re.receiveShadow)&&(mn.receiveShadow=Re.receiveShadow,si.setValue(He,"receiveShadow",Re.receiveShadow)),hi&&(si.setValue(He,"toneMappingExposure",A.toneMappingExposure),mn.needsLights&&(Er=Wr,(zi=io).ambientLightColor.needsUpdate=Er,zi.lightProbe.needsUpdate=Er,zi.directionalLights.needsUpdate=Er,zi.directionalLightShadows.needsUpdate=Er,zi.pointLights.needsUpdate=Er,zi.pointLightShadows.needsUpdate=Er,zi.spotLights.needsUpdate=Er,zi.spotLightShadows.needsUpdate=Er,zi.rectAreaLights.needsUpdate=Er,zi.hemisphereLights.needsUpdate=Er),Xe&&me.fog&&on.refreshFogUniforms(io,Xe),on.refreshMaterialUniforms(io,me,Et,Ft,Pe),ri.upload(He,mn.uniformsList,io,jt)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(ri.upload(He,mn.uniformsList,io,jt),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&si.setValue(He,"center",Re.center),si.setValue(He,"modelViewMatrix",Re.modelViewMatrix),si.setValue(He,"normalMatrix",Re.normalMatrix),si.setValue(He,"modelMatrix",Re.matrixWorld),Hn}xs.setAnimationLoop(function(Ht){Yc&&Yc(Ht)}),typeof window!="undefined"&&xs.setContext(window),this.setAnimationLoop=function(Ht){Yc=Ht,Sr.setAnimationLoop(Ht),Ht===null?xs.stop():xs.start()},Sr.addEventListener("sessionstart",Zg),Sr.addEventListener("sessionend",Kg),this.render=function(Ht,Ce){if(Ce!==void 0&&Ce.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(C===!0)return;Ht.autoUpdate===!0&&Ht.updateMatrixWorld(),Ce.parent===null&&Ce.updateMatrixWorld(),Sr.enabled===!0&&Sr.isPresenting===!0&&(Sr.cameraAutoUpdate===!0&&Sr.updateCamera(Ce),Ce=Sr.getCamera()),Ht.isScene===!0&&Ht.onBeforeRender(A,Ht,Ce,it),_=Sn.get(Ht,w.length),_.init(),w.push(_),Ct.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),Xt.setFromProjectionMatrix(Ct),be=this.localClippingEnabled,pe=Ci.init(this.clippingPlanes,be,Ce),p=rn.get(Ht,x.length),p.init(),x.push(p),function En(Ke,Nn,mn,zn){if(Ke.visible===!1)return;if(Ke.layers.test(Nn.layers)){if(Ke.isGroup)mn=Ke.renderOrder;else if(Ke.isLOD)Ke.autoUpdate===!0&&Ke.update(Nn);else if(Ke.isLight)_.pushLight(Ke),Ke.castShadow&&_.pushShadow(Ke);else if(Ke.isSprite){if(!Ke.frustumCulled||Xt.intersectsSprite(Ke)){zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct);const Hn=ye.update(Ke),Di=Ke.material;Di.visible&&p.push(Ke,Hn,Di,mn,Bt.z,null)}}else if(Ke.isImmediateRenderObject)zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct),p.push(Ke,null,Ke.material,mn,Bt.z,null);else if((Ke.isMesh||Ke.isLine||Ke.isPoints)&&(Ke.isSkinnedMesh&&Ke.skeleton.frame!==ce.render.frame&&(Ke.skeleton.update(),Ke.skeleton.frame=ce.render.frame),!Ke.frustumCulled||Xt.intersectsObject(Ke))){zn&&Bt.setFromMatrixPosition(Ke.matrixWorld).applyMatrix4(Ct);const Hn=ye.update(Ke),Di=Ke.material;if(Array.isArray(Di)){const hi=Hn.groups;for(let Wr=0,si=hi.length;Wr<si;Wr++){const io=hi[Wr],zi=Di[io.materialIndex];zi&&zi.visible&&p.push(Ke,Hn,zi,mn,Bt.z,io)}}else Di.visible&&p.push(Ke,Hn,Di,mn,Bt.z,null)}}const wn=Ke.children;for(let Hn=0,Di=wn.length;Hn<Di;Hn++)En(wn[Hn],Nn,mn,zn)}(Ht,Ce,0,A.sortObjects),p.finish(),A.sortObjects===!0&&p.sort(Mt,Lt),pe===!0&&Ci.beginShadows();const me=_.state.shadowsArray;Jn.render(me,Ht,Ce),_.setupLights(),_.setupLightsView(Ce),pe===!0&&Ci.endShadows(),this.info.autoReset===!0&&this.info.reset(),mr.render(p,Ht);const Re=p.opaque,Xe=p.transmissive,Vn=p.transparent;Re.length>0&&Lh(Re,Ht,Ce),Xe.length>0&&function(En,Ke,Nn,mn){if(Pe===null){const Hn=s===!0&&Ie.isWebGL2===!0;Pe=new(Hn?st:Vt)(1024,1024,{generateMipmaps:!0,type:ur.convert(1016)!==null?1016:1009,minFilter:1008,magFilter:1003,wrapS:1001,wrapT:1001})}const zn=A.getRenderTarget();A.setRenderTarget(Pe),A.clear();const wn=A.toneMapping;A.toneMapping=0,Lh(En,Nn,mn),A.toneMapping=wn,jt.updateMultisampleRenderTarget(Pe),jt.updateRenderTargetMipmap(Pe),A.setRenderTarget(zn),Lh(Ke,Nn,mn)}(Re,Xe,Ht,Ce),Vn.length>0&&Lh(Vn,Ht,Ce),it!==null&&(jt.updateMultisampleRenderTarget(it),jt.updateRenderTargetMipmap(it)),Ht.isScene===!0&&Ht.onAfterRender(A,Ht,Ce),De.buffers.depth.setTest(!0),De.buffers.depth.setMask(!0),De.buffers.color.setMask(!0),De.setPolygonOffset(!1),gr.resetDefaultState(),ft=-1,nt=null,w.pop(),_=w.length>0?w[w.length-1]:null,x.pop(),p=x.length>0?x[x.length-1]:null},this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return it},this.setRenderTarget=function(Ht,Ce=0,me=0){it=Ht,G=Ce,K=me,Ht&&Tt.get(Ht).__webglFramebuffer===void 0&&jt.setupRenderTarget(Ht);let Re=null,Xe=!1,Vn=!1;if(Ht){const En=Ht.texture;(En.isDataTexture3D||En.isDataTexture2DArray)&&(Vn=!0);const Ke=Tt.get(Ht).__webglFramebuffer;Ht.isWebGLCubeRenderTarget?(Re=Ke[Ce],Xe=!0):Re=Ht.isWebGLMultisampleRenderTarget?Tt.get(Ht).__webglMultisampledFramebuffer:Ke,gt.copy(Ht.viewport),lt.copy(Ht.scissor),dt=Ht.scissorTest}else gt.copy(Pt).multiplyScalar(Et).floor(),lt.copy(ee).multiplyScalar(Et).floor(),dt=$t;if(De.bindFramebuffer(36160,Re)&&Ie.drawBuffers){let En=!1;if(Ht)if(Ht.isWebGLMultipleRenderTargets){const Ke=Ht.texture;if(zt.length!==Ke.length||zt[0]!==36064){for(let Nn=0,mn=Ke.length;Nn<mn;Nn++)zt[Nn]=36064+Nn;zt.length=Ke.length,En=!0}}else zt.length===1&&zt[0]===36064||(zt[0]=36064,zt.length=1,En=!0);else zt.length===1&&zt[0]===1029||(zt[0]=1029,zt.length=1,En=!0);En&&(Ie.isWebGL2?He.drawBuffers(zt):se.get("WEBGL_draw_buffers").drawBuffersWEBGL(zt))}if(De.viewport(gt),De.scissor(lt),De.setScissorTest(dt),Xe){const En=Tt.get(Ht.texture);He.framebufferTexture2D(36160,36064,34069+Ce,En.__webglTexture,me)}else if(Vn){const En=Tt.get(Ht.texture),Ke=Ce||0;He.framebufferTextureLayer(36160,36064,En.__webglTexture,me||0,Ke)}},this.readRenderTargetPixels=function(Ht,Ce,me,Re,Xe,Vn,En){if(!Ht||!Ht.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ke=Tt.get(Ht).__webglFramebuffer;if(Ht.isWebGLCubeRenderTarget&&En!==void 0&&(Ke=Ke[En]),Ke){De.bindFramebuffer(36160,Ke);try{const Nn=Ht.texture,mn=Nn.format,zn=Nn.type;if(mn!==1023&&ur.convert(mn)!==He.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const wn=zn===1016&&(se.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&se.has("EXT_color_buffer_float"));if(!(zn===1009||ur.convert(zn)===He.getParameter(35738)||zn===1015&&(Ie.isWebGL2||se.has("OES_texture_float")||se.has("WEBGL_color_buffer_float"))||wn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");He.checkFramebufferStatus(36160)===36053?Ce>=0&&Ce<=Ht.width-Re&&me>=0&&me<=Ht.height-Xe&&He.readPixels(Ce,me,Re,Xe,ur.convert(mn),ur.convert(zn),Vn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Nn=it!==null?Tt.get(it).__webglFramebuffer:null;De.bindFramebuffer(36160,Nn)}}},this.copyFramebufferToTexture=function(Ht,Ce,me=0){const Re=Math.pow(2,-me),Xe=Math.floor(Ce.image.width*Re),Vn=Math.floor(Ce.image.height*Re);let En=ur.convert(Ce.format);Ie.isWebGL2&&(En===6407&&(En=32849),En===6408&&(En=32856)),jt.setTexture2D(Ce,0),He.copyTexImage2D(3553,me,En,Ht.x,Ht.y,Xe,Vn,0),De.unbindTexture()},this.copyTextureToTexture=function(Ht,Ce,me,Re=0){const Xe=Ce.image.width,Vn=Ce.image.height,En=ur.convert(me.format),Ke=ur.convert(me.type);jt.setTexture2D(me,0),He.pixelStorei(37440,me.flipY),He.pixelStorei(37441,me.premultiplyAlpha),He.pixelStorei(3317,me.unpackAlignment),Ce.isDataTexture?He.texSubImage2D(3553,Re,Ht.x,Ht.y,Xe,Vn,En,Ke,Ce.image.data):Ce.isCompressedTexture?He.compressedTexSubImage2D(3553,Re,Ht.x,Ht.y,Ce.mipmaps[0].width,Ce.mipmaps[0].height,En,Ce.mipmaps[0].data):He.texSubImage2D(3553,Re,Ht.x,Ht.y,En,Ke,Ce.image),Re===0&&me.generateMipmaps&&He.generateMipmap(3553),De.unbindTexture()},this.copyTextureToTexture3D=function(Ht,Ce,me,Re,Xe=0){if(A.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Vn=Ht.max.x-Ht.min.x+1,En=Ht.max.y-Ht.min.y+1,Ke=Ht.max.z-Ht.min.z+1,Nn=ur.convert(Re.format),mn=ur.convert(Re.type);let zn;if(Re.isDataTexture3D)jt.setTexture3D(Re,0),zn=32879;else{if(!Re.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");jt.setTexture2DArray(Re,0),zn=35866}He.pixelStorei(37440,Re.flipY),He.pixelStorei(37441,Re.premultiplyAlpha),He.pixelStorei(3317,Re.unpackAlignment);const wn=He.getParameter(3314),Hn=He.getParameter(32878),Di=He.getParameter(3316),hi=He.getParameter(3315),Wr=He.getParameter(32877),si=me.isCompressedTexture?me.mipmaps[0]:me.image;He.pixelStorei(3314,si.width),He.pixelStorei(32878,si.height),He.pixelStorei(3316,Ht.min.x),He.pixelStorei(3315,Ht.min.y),He.pixelStorei(32877,Ht.min.z),me.isDataTexture||me.isDataTexture3D?He.texSubImage3D(zn,Xe,Ce.x,Ce.y,Ce.z,Vn,En,Ke,Nn,mn,si.data):me.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),He.compressedTexSubImage3D(zn,Xe,Ce.x,Ce.y,Ce.z,Vn,En,Ke,Nn,si.data)):He.texSubImage3D(zn,Xe,Ce.x,Ce.y,Ce.z,Vn,En,Ke,Nn,mn,si),He.pixelStorei(3314,wn),He.pixelStorei(32878,Hn),He.pixelStorei(3316,Di),He.pixelStorei(3315,hi),He.pixelStorei(32877,Wr),Xe===0&&Re.generateMipmaps&&He.generateMipmap(zn),De.unbindTexture()},this.initTexture=function(Ht){jt.setTexture2D(Ht,0),De.unbindTexture()},this.resetState=function(){G=0,K=0,it=null,De.reset(),gr.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends ti{}).prototype.isWebGL1Renderer=!0;class mu extends kn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}}mu.prototype.isScene=!0;class ya{constructor(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=J()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,o=this.stride;r<o;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=J()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=J()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ya.prototype.isInterleavedBuffer=!0;const Oi=new k;class xa{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.applyMatrix4(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.applyNormalMatrix(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.transformDirection(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=o,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return new Yn(new this.array.constructor(e),this.itemSize,this.normalized)}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new xa(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}xa.prototype.isInterleavedBufferAttribute=!0;class op extends Ii{constructor(t){super(),this.type="SpriteMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Rs;op.prototype.isSpriteMaterial=!0;const ba=new k,Is=new k,Ps=new k,Os=new I,Ta=new I,sp=new tn,Ml=new k,wa=new k,Cl=new k,ap=new I,gu=new I,lp=new I;class ay extends kn{constructor(t){if(super(),this.type="Sprite",Rs===void 0){Rs=new Wn;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new ya(e,5);Rs.setIndex([0,1,2,0,2,3]),Rs.setAttribute("position",new xa(n,3,0,!1)),Rs.setAttribute("uv",new xa(n,2,3,!1))}this.geometry=Rs,this.material=t!==void 0?t:new op,this.center=new I(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Is.setFromMatrixScale(this.matrixWorld),sp.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Ps.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Is.multiplyScalar(-Ps.z);const n=this.material.rotation;let r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));const s=this.center;Rl(Ml.set(-.5,-.5,0),Ps,s,Is,r,o),Rl(wa.set(.5,-.5,0),Ps,s,Is,r,o),Rl(Cl.set(.5,.5,0),Ps,s,Is,r,o),ap.set(0,0),gu.set(1,0),lp.set(1,1);let a=t.ray.intersectTriangle(Ml,wa,Cl,!1,ba);if(a===null&&(Rl(wa.set(-.5,.5,0),Ps,s,Is,r,o),gu.set(0,1),a=t.ray.intersectTriangle(Ml,Cl,wa,!1,ba),a===null))return;const l=t.ray.origin.distanceTo(ba);l<t.near||l>t.far||e.push({distance:l,point:ba.clone(),uv:di.getUV(ba,Ml,wa,Cl,ap,gu,lp,new I),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function Rl(i,t,e,n,r,o){Os.subVectors(i,e).addScalar(.5).multiply(n),r!==void 0?(Ta.x=o*Os.x-r*Os.y,Ta.y=r*Os.x+o*Os.y):Ta.copy(Os),i.copy(t),i.x+=Ta.x,i.y+=Ta.y,i.applyMatrix4(sp)}ay.prototype.isSprite=!0;const hp=new k,up=new Ot,cp=new Ot,ly=new k,dp=new tn;class pp extends wt{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tn,this.bindMatrixInverse=new tn}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ot,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;up.fromBufferAttribute(r.attributes.skinIndex,t),cp.fromBufferAttribute(r.attributes.skinWeight,t),hp.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let o=0;o<4;o++){const s=cp.getComponent(o);if(s!==0){const a=up.getComponent(o);dp.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(ly.copy(hp).applyMatrix4(dp),s)}}return e.applyMatrix4(this.bindMatrixInverse)}}pp.prototype.isSkinnedMesh=!0;class hy extends kn{constructor(){super(),this.type="Bone"}}hy.prototype.isBone=!0;class fp extends Q{constructor(t=null,e=1,n=1,r,o,s,a,l,h=1003,u=1003,p,_){super(null,s,a,l,h,u,r,o,p,_),this.image={data:t,width:e,height:n},this.magFilter=h,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}fp.prototype.isDataTexture=!0;const mp=new tn,gp=new tn,Il=[],Sa=new wt;class uy extends wt{constructor(t,e,n){super(t,e),this.instanceMatrix=new Yn(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(Sa.geometry=this.geometry,Sa.material=this.material,Sa.material!==void 0)for(let o=0;o<r;o++){this.getMatrixAt(o,mp),gp.multiplyMatrices(n,mp),Sa.matrixWorld=gp,Sa.raycast(t,Il);for(let s=0,a=Il.length;s<a;s++){const l=Il[s];l.instanceId=o,l.object=this,e.push(l)}Il.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new Yn(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}uy.prototype.isInstancedMesh=!0;class Ea extends Ii{constructor(t){super(),this.type="LineBasicMaterial",this.color=new fn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}Ea.prototype.isLineBasicMaterial=!0;const vp=new k,_p=new k,yp=new tn,vu=new gi,Pl=new Ge;class _u extends kn{constructor(t=new Wn,e=new Ea){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[0];for(let r=1,o=e.count;r<o;r++)vp.fromBufferAttribute(e,r-1),_p.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=vp.distanceTo(_p);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Pl.copy(n.boundingSphere),Pl.applyMatrix4(r),Pl.radius+=o,t.ray.intersectsSphere(Pl)===!1)return;yp.copy(r).invert(),vu.copy(t.ray).applyMatrix4(yp);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new k,u=new k,p=new k,_=new k,x=this.isLineSegments?2:1;if(n.isBufferGeometry){const w=n.index,A=n.attributes.position;if(w!==null)for(let C=Math.max(0,s.start),G=Math.min(w.count,s.start+s.count)-1;C<G;C+=x){const K=w.getX(C),it=w.getX(C+1);if(h.fromBufferAttribute(A,K),u.fromBufferAttribute(A,it),vu.distanceSqToSegment(h,u,_,p)>l)continue;_.applyMatrix4(this.matrixWorld);const ft=t.ray.origin.distanceTo(_);ft<t.near||ft>t.far||e.push({distance:ft,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}else for(let C=Math.max(0,s.start),G=Math.min(A.count,s.start+s.count)-1;C<G;C+=x){if(h.fromBufferAttribute(A,C),u.fromBufferAttribute(A,C+1),vu.distanceSqToSegment(h,u,_,p)>l)continue;_.applyMatrix4(this.matrixWorld);const K=t.ray.origin.distanceTo(_);K<t.near||K>t.far||e.push({distance:K,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}_u.prototype.isLine=!0;const xp=new k,bp=new k;class yu extends _u{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[];for(let r=0,o=e.count;r<o;r+=2)xp.fromBufferAttribute(e,r),bp.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+xp.distanceTo(bp);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}yu.prototype.isLineSegments=!0;class cy extends _u{constructor(t,e){super(t,e),this.type="LineLoop"}}cy.prototype.isLineLoop=!0;class Tp extends Ii{constructor(t){super(),this.type="PointsMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}Tp.prototype.isPointsMaterial=!0;const wp=new tn,xu=new gi,Ol=new Ge,Ll=new k;class dy extends kn{constructor(t=new Wn,e=new Tp){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ol.copy(n.boundingSphere),Ol.applyMatrix4(r),Ol.radius+=o,t.ray.intersectsSphere(Ol)===!1)return;wp.copy(r).invert(),xu.copy(t.ray).applyMatrix4(wp);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){const h=n.index,u=n.attributes.position;if(h!==null)for(let p=Math.max(0,s.start),_=Math.min(h.count,s.start+s.count);p<_;p++){const x=h.getX(p);Ll.fromBufferAttribute(u,x),Sp(Ll,x,l,r,t,e,this)}else for(let p=Math.max(0,s.start),_=Math.min(u.count,s.start+s.count);p<_;p++)Ll.fromBufferAttribute(u,p),Sp(Ll,p,l,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Sp(i,t,e,n,r,o,s){const a=xu.distanceSqToPoint(i);if(a<e){const l=new k;xu.closestPointToPoint(i,l),l.applyMatrix4(n);const h=r.ray.origin.distanceTo(l);if(h<r.near||h>r.far)return;o.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:s})}}dy.prototype.isPoints=!0,class extends Q{constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.format=s!==void 0?s:1022,this.minFilter=o!==void 0?o:1006,this.magFilter=r!==void 0?r:1006,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in i&&i.requestVideoFrameCallback(function u(){h.needsUpdate=!0,i.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){const i=this.image;!("requestVideoFrameCallback"in i)&&i.readyState>=i.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0;class py extends Q{constructor(t,e,n,r,o,s,a,l,h,u,p,_){super(null,s,a,l,h,u,r,o,p,_),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}py.prototype.isCompressedTexture=!0,class extends Q{constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,class extends Q{constructor(i,t,e,n,r,o,s,a,l,h){if((h=h!==void 0?h:1026)!==1026&&h!==1027)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");e===void 0&&h===1026&&(e=1012),e===void 0&&h===1027&&(e=1020),super(null,n,r,o,s,a,h,e,l),this.image={width:i,height:t},this.magFilter=s!==void 0?s:1003,this.minFilter=a!==void 0?a:1003,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=!0,new k,new k,new k,new di;class Or{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),o=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),o+=n.distanceTo(r),e.push(o),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const o=n.length;let s;s=e||t*n[o-1];let a,l=0,h=o-1;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),a=n[r]-s,a<0)l=r+1;else{if(!(a>0)){h=r;break}h=r-1}if(r=h,n[r]===s)return r/(o-1);const u=n[r];return(r+(s-u)/(n[r+1]-u))/(o-1)}getTangent(t,e){let n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);const o=this.getPoint(n),s=this.getPoint(r),a=e||(o.isVector2?new I:new k);return a.copy(s).sub(o).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new k,r=[],o=[],s=[],a=new k,l=new tn;for(let x=0;x<=t;x++){const w=x/t;r[x]=this.getTangentAt(w,new k),r[x].normalize()}o[0]=new k,s[0]=new k;let h=Number.MAX_VALUE;const u=Math.abs(r[0].x),p=Math.abs(r[0].y),_=Math.abs(r[0].z);u<=h&&(h=u,n.set(1,0,0)),p<=h&&(h=p,n.set(0,1,0)),_<=h&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let x=1;x<=t;x++){if(o[x]=o[x-1].clone(),s[x]=s[x-1].clone(),a.crossVectors(r[x-1],r[x]),a.length()>Number.EPSILON){a.normalize();const w=Math.acos(et(r[x-1].dot(r[x]),-1,1));o[x].applyMatrix4(l.makeRotationAxis(a,w))}s[x].crossVectors(r[x],o[x])}if(e===!0){let x=Math.acos(et(o[0].dot(o[t]),-1,1));x/=t,r[0].dot(a.crossVectors(o[0],o[t]))>0&&(x=-x);for(let w=1;w<=t;w++)o[w].applyMatrix4(l.makeRotationAxis(r[w],x*w)),s[w].crossVectors(r[w],o[w])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Nl extends Or{constructor(t=0,e=0,n=1,r=1,o=0,s=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(t,e){const n=e||new I,r=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=s?0:r),this.aClockwise!==!0||s||(o===r?o=-r:o-=r);const a=this.aStartAngle+t*o;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),p=Math.sin(this.aRotation),_=l-this.aX,x=h-this.aY;l=_*u-x*p+this.aX,h=_*p+x*u+this.aY}return n.set(l,h)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}Nl.prototype.isEllipseCurve=!0;class Ep extends Nl{constructor(t,e,n,r,o,s){super(t,e,n,n,r,o,s),this.type="ArcCurve"}}function bu(){let i=0,t=0,e=0,n=0;function r(o,s,a,l){i=o,t=a,e=-3*o+3*s-2*a-l,n=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,h){r(s,a,h*(a-o),h*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,h,u,p){let _=(s-o)/h-(a-o)/(h+u)+(a-s)/u,x=(a-s)/u-(l-s)/(u+p)+(l-a)/p;_*=u,x*=u,r(s,a,_,x)},calc:function(o){const s=o*o;return i+t*o+e*s+n*(s*o)}}}Ep.prototype.isArcCurve=!0;const Dl=new k,Tu=new bu,wu=new bu,Su=new bu;class Ap extends Or{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new k){const n=e,r=this.points,o=r.length,s=(o-(this.closed?0:1))*t;let a,l,h=Math.floor(s),u=s-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/o)+1)*o:u===0&&h===o-1&&(h=o-2,u=1),this.closed||h>0?a=r[(h-1)%o]:(Dl.subVectors(r[0],r[1]).add(r[0]),a=Dl);const p=r[h%o],_=r[(h+1)%o];if(this.closed||h+2<o?l=r[(h+2)%o]:(Dl.subVectors(r[o-1],r[o-2]).add(r[o-1]),l=Dl),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let w=Math.pow(a.distanceToSquared(p),x),A=Math.pow(p.distanceToSquared(_),x),C=Math.pow(_.distanceToSquared(l),x);A<1e-4&&(A=1),w<1e-4&&(w=A),C<1e-4&&(C=A),Tu.initNonuniformCatmullRom(a.x,p.x,_.x,l.x,w,A,C),wu.initNonuniformCatmullRom(a.y,p.y,_.y,l.y,w,A,C),Su.initNonuniformCatmullRom(a.z,p.z,_.z,l.z,w,A,C)}else this.curveType==="catmullrom"&&(Tu.initCatmullRom(a.x,p.x,_.x,l.x,this.tension),wu.initCatmullRom(a.y,p.y,_.y,l.y,this.tension),Su.initCatmullRom(a.z,p.z,_.z,l.z,this.tension));return n.set(Tu.calc(u),wu.calc(u),Su.calc(u)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new k().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Mp(i,t,e,n,r){const o=.5*(n-t),s=.5*(r-e),a=i*i;return(2*e-2*n+o+s)*(i*a)+(-3*e+3*n-2*o-s)*a+o*i+e}function Aa(i,t,e,n){return function(r,o){const s=1-r;return s*s*o}(i,t)+function(r,o){return 2*(1-r)*r*o}(i,e)+function(r,o){return r*r*o}(i,n)}function Ma(i,t,e,n,r){return function(o,s){const a=1-o;return a*a*a*s}(i,t)+function(o,s){const a=1-o;return 3*a*a*o*s}(i,e)+function(o,s){return 3*(1-o)*o*o*s}(i,n)+function(o,s){return o*o*o*s}(i,r)}Ap.prototype.isCatmullRomCurve3=!0;class Eu extends Or{constructor(t=new I,e=new I,n=new I,r=new I){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new I){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Ma(t,r.x,o.x,s.x,a.x),Ma(t,r.y,o.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Eu.prototype.isCubicBezierCurve=!0;class Cp extends Or{constructor(t=new k,e=new k,n=new k,r=new k){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new k){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Ma(t,r.x,o.x,s.x,a.x),Ma(t,r.y,o.y,s.y,a.y),Ma(t,r.z,o.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Cp.prototype.isCubicBezierCurve3=!0;class Fl extends Or{constructor(t=new I,e=new I){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new I){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new I;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Fl.prototype.isLineCurve=!0;class Au extends Or{constructor(t=new I,e=new I,n=new I){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new I){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(Aa(t,r.x,o.x,s.x),Aa(t,r.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Au.prototype.isQuadraticBezierCurve=!0;class Rp extends Or{constructor(t=new k,e=new k,n=new k){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new k){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(Aa(t,r.x,o.x,s.x),Aa(t,r.y,o.y,s.y),Aa(t,r.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Rp.prototype.isQuadraticBezierCurve3=!0;class Mu extends Or{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new I){const n=e,r=this.points,o=(r.length-1)*t,s=Math.floor(o),a=o-s,l=r[s===0?s:s-1],h=r[s],u=r[s>r.length-2?r.length-1:s+1],p=r[s>r.length-3?r.length-1:s+2];return n.set(Mp(a,l.x,h.x,u.x,p.x),Mp(a,l.y,h.y,u.y,p.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new I().fromArray(r))}return this}}Mu.prototype.isSplineCurve=!0;var Ip=Object.freeze({__proto__:null,ArcCurve:Ep,CatmullRomCurve3:Ap,CubicBezierCurve:Eu,CubicBezierCurve3:Cp,EllipseCurve:Nl,LineCurve:Fl,LineCurve3:class extends Or{constructor(i=new k,t=new k){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=i,this.v2=t}getPoint(i,t=new k){const e=t;return i===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(i).add(this.v1)),e}getPointAt(i,t){return this.getPoint(i,t)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},QuadraticBezierCurve:Au,QuadraticBezierCurve3:Rp,SplineCurve:Mu});const fy=function(i,t,e=2){const n=t&&t.length,r=n?t[0]*e:i.length;let o=Pp(i,0,r,e,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,h,u,p,_,x;if(n&&(o=function(w,A,C,G){const K=[];let it,ft,nt,gt,lt;for(it=0,ft=A.length;it<ft;it++)nt=A[it]*G,gt=it<ft-1?A[it+1]*G:w.length,lt=Pp(w,nt,gt,G,!1),lt===lt.next&&(lt.steiner=!0),K.push(Ty(lt));for(K.sort(yy),it=0;it<K.length;it++)xy(K[it],C),C=Fo(C,C.next);return C}(i,t,o,e)),i.length>80*e){a=h=i[0],l=u=i[1];for(let w=e;w<r;w+=e)p=i[w],_=i[w+1],p<a&&(a=p),_<l&&(l=_),p>h&&(h=p),_>u&&(u=_);x=Math.max(h-a,u-l),x=x!==0?1/x:0}return Ca(o,s,e,a,l,x),s};function Pp(i,t,e,n,r){let o,s;if(r===function(a,l,h,u){let p=0;for(let _=l,x=h-u;_<h;_+=u)p+=(a[x]-a[_])*(a[_+1]+a[x+1]),x=_;return p}(i,t,e,n)>0)for(o=t;o<e;o+=n)s=Np(o,i[o],i[o+1],s);else for(o=e-n;o>=t;o-=n)s=Np(o,i[o],i[o+1],s);return s&&Bl(s,s.next)&&(Ia(s),s=s.next),s}function Fo(i,t){if(!i)return i;t||(t=i);let e,n=i;do if(e=!1,n.steiner||!Bl(n,n.next)&&bi(n.prev,n,n.next)!==0)n=n.next;else{if(Ia(n),n=t=n.prev,n===n.next)break;e=!0}while(e||n!==t);return t}function Ca(i,t,e,n,r,o,s){if(!i)return;!s&&o&&function(u,p,_,x){let w=u;do w.z===null&&(w.z=Cu(w.x,w.y,p,_,x)),w.prevZ=w.prev,w.nextZ=w.next,w=w.next;while(w!==u);w.prevZ.nextZ=null,w.prevZ=null,function(A){let C,G,K,it,ft,nt,gt,lt,dt=1;do{for(G=A,A=null,ft=null,nt=0;G;){for(nt++,K=G,gt=0,C=0;C<dt&&(gt++,K=K.nextZ,K);C++);for(lt=dt;gt>0||lt>0&&K;)gt!==0&&(lt===0||!K||G.z<=K.z)?(it=G,G=G.nextZ,gt--):(it=K,K=K.nextZ,lt--),ft?ft.nextZ=it:A=it,it.prevZ=ft,ft=it;G=K}ft.nextZ=null,dt*=2}while(nt>1)}(w)}(i,n,r,o);let a,l,h=i;for(;i.prev!==i.next;)if(a=i.prev,l=i.next,o?gy(i,n,r,o):my(i))t.push(a.i/e),t.push(i.i/e),t.push(l.i/e),Ia(i),i=l.next,h=l.next;else if((i=l)===h){s?s===1?Ca(i=vy(Fo(i),t,e),t,e,n,r,o,2):s===2&&_y(i,t,e,n,r,o):Ca(Fo(i),t,e,n,r,o,1);break}}function my(i){const t=i.prev,e=i,n=i.next;if(bi(t,e,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(Ls(t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y)&&bi(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function gy(i,t,e,n){const r=i.prev,o=i,s=i.next;if(bi(r,o,s)>=0)return!1;const a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,h=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,p=Cu(a,l,t,e,n),_=Cu(h,u,t,e,n);let x=i.prevZ,w=i.nextZ;for(;x&&x.z>=p&&w&&w.z<=_;){if(x!==i.prev&&x!==i.next&&Ls(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&bi(x.prev,x,x.next)>=0||(x=x.prevZ,w!==i.prev&&w!==i.next&&Ls(r.x,r.y,o.x,o.y,s.x,s.y,w.x,w.y)&&bi(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;x&&x.z>=p;){if(x!==i.prev&&x!==i.next&&Ls(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&bi(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;w&&w.z<=_;){if(w!==i.prev&&w!==i.next&&Ls(r.x,r.y,o.x,o.y,s.x,s.y,w.x,w.y)&&bi(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function vy(i,t,e){let n=i;do{const r=n.prev,o=n.next.next;!Bl(r,o)&&Op(r,n,n.next,o)&&Ra(r,o)&&Ra(o,r)&&(t.push(r.i/e),t.push(n.i/e),t.push(o.i/e),Ia(n),Ia(n.next),n=i=o),n=n.next}while(n!==i);return Fo(n)}function _y(i,t,e,n,r,o){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&wy(s,a)){let l=Lp(s,a);return s=Fo(s,s.next),l=Fo(l,l.next),Ca(s,t,e,n,r,o),void Ca(l,t,e,n,r,o)}a=a.next}s=s.next}while(s!==i)}function yy(i,t){return i.x-t.x}function xy(i,t){if(t=function(e,n){let r=n;const o=e.x,s=e.y;let a,l=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const w=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(w<=o&&w>l){if(l=w,w===o){if(s===r.y)return r;if(s===r.next.y)return r.next}a=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!a)return null;if(o===l)return a;const h=a,u=a.x,p=a.y;let _,x=1/0;r=a;do o>=r.x&&r.x>=u&&o!==r.x&&Ls(s<p?o:l,s,u,p,s<p?l:o,s,r.x,r.y)&&(_=Math.abs(s-r.y)/(o-r.x),Ra(r,e)&&(_<x||_===x&&(r.x>a.x||r.x===a.x&&by(a,r)))&&(a=r,x=_)),r=r.next;while(r!==h);return a}(i,t)){const e=Lp(t,i);Fo(t,t.next),Fo(e,e.next)}}function by(i,t){return bi(i.prev,i,t.prev)<0&&bi(t.next,i,i.next)<0}function Cu(i,t,e,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ty(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Ls(i,t,e,n,r,o,s,a){return(r-s)*(t-a)-(i-s)*(o-a)>=0&&(i-s)*(n-a)-(e-s)*(t-a)>=0&&(e-s)*(o-a)-(r-s)*(n-a)>=0}function wy(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(e,n){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&Op(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}(i,t)&&(Ra(i,t)&&Ra(t,i)&&function(e,n){let r=e,o=!1;const s=(e.x+n.x)/2,a=(e.y+n.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&s<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next;while(r!==e);return o}(i,t)&&(bi(i.prev,i,t.prev)||bi(i,t.prev,t))||Bl(i,t)&&bi(i.prev,i,i.next)>0&&bi(t.prev,t,t.next)>0)}function bi(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Bl(i,t){return i.x===t.x&&i.y===t.y}function Op(i,t,e,n){const r=Ul(bi(i,t,e)),o=Ul(bi(i,t,n)),s=Ul(bi(e,n,i)),a=Ul(bi(e,n,t));return r!==o&&s!==a||!(r!==0||!kl(i,e,t))||!(o!==0||!kl(i,n,t))||!(s!==0||!kl(e,i,n))||!(a!==0||!kl(e,t,n))}function kl(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Ul(i){return i>0?1:i<0?-1:0}function Ra(i,t){return bi(i.prev,i,i.next)<0?bi(i,t,i.next)>=0&&bi(i,i.prev,t)>=0:bi(i,t,i.prev)<0||bi(i,i.next,t)<0}function Lp(i,t){const e=new Ru(i.i,i.x,i.y),n=new Ru(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function Np(i,t,e,n){const r=new Ru(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Ia(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ru(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Bo{static area(t){const e=t.length;let n=0;for(let r=e-1,o=0;o<e;r=o++)n+=t[r].x*t[o].y-t[o].x*t[r].y;return .5*n}static isClockWise(t){return Bo.area(t)<0}static triangulateShape(t,e){const n=[],r=[],o=[];Dp(t),Fp(n,t);let s=t.length;e.forEach(Dp);for(let l=0;l<e.length;l++)r.push(s),s+=e[l].length,Fp(n,e[l]);const a=fy(n,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function Dp(i){const t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function Fp(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}class Ns extends Wn{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],o=[];for(let a=0,l=t.length;a<l;a++)s(t[a]);function s(a){const l=[],h=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1;let p=e.depth!==void 0?e.depth:100,_=e.bevelEnabled===void 0||e.bevelEnabled,x=e.bevelThickness!==void 0?e.bevelThickness:6,w=e.bevelSize!==void 0?e.bevelSize:x-2,A=e.bevelOffset!==void 0?e.bevelOffset:0,C=e.bevelSegments!==void 0?e.bevelSegments:3;const G=e.extrudePath,K=e.UVGenerator!==void 0?e.UVGenerator:Sy;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=e.amount);let it,ft,nt,gt,lt,dt=!1;G&&(it=G.getSpacedPoints(u),dt=!0,_=!1,ft=G.computeFrenetFrames(u,!1),nt=new k,gt=new k,lt=new k),_||(C=0,x=0,w=0,A=0);const Ut=a.extractPoints(h);let Ft=Ut.shape;const Et=Ut.holes;if(!Bo.isClockWise(Ft)){Ft=Ft.reverse();for(let ce=0,Tt=Et.length;ce<Tt;ce++){const jt=Et[ce];Bo.isClockWise(jt)&&(Et[ce]=jt.reverse())}}const Mt=Bo.triangulateShape(Ft,Et),Lt=Ft;for(let ce=0,Tt=Et.length;ce<Tt;ce++){const jt=Et[ce];Ft=Ft.concat(jt)}function Pt(ce,Tt,jt){return Tt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Tt.clone().multiplyScalar(jt).add(ce)}const ee=Ft.length,$t=Mt.length;function zt(ce,Tt,jt){let ie,ae,qt;const ye=ce.x-Tt.x,nn=ce.y-Tt.y,on=jt.x-ce.x,rn=jt.y-ce.y,Sn=ye*ye+nn*nn,Ci=ye*rn-nn*on;if(Math.abs(Ci)>Number.EPSILON){const Jn=Math.sqrt(Sn),mr=Math.sqrt(on*on+rn*rn),nl=Tt.x-nn/Jn,il=Tt.y+ye/Jn,rl=((jt.x-rn/mr-nl)*rn-(jt.y+on/mr-il)*on)/(ye*rn-nn*on);ie=nl+ye*rl-ce.x,ae=il+nn*rl-ce.y;const ur=ie*ie+ae*ae;if(ur<=2)return new I(ie,ae);qt=Math.sqrt(ur/2)}else{let Jn=!1;ye>Number.EPSILON?on>Number.EPSILON&&(Jn=!0):ye<-Number.EPSILON?on<-Number.EPSILON&&(Jn=!0):Math.sign(nn)===Math.sign(rn)&&(Jn=!0),Jn?(ie=-nn,ae=ye,qt=Math.sqrt(Sn)):(ie=ye,ae=nn,qt=Math.sqrt(Sn/2))}return new I(ie/qt,ae/qt)}const Xt=[];for(let ce=0,Tt=Lt.length,jt=Tt-1,ie=ce+1;ce<Tt;ce++,jt++,ie++)jt===Tt&&(jt=0),ie===Tt&&(ie=0),Xt[ce]=zt(Lt[ce],Lt[jt],Lt[ie]);const pe=[];let be,Pe=Xt.concat();for(let ce=0,Tt=Et.length;ce<Tt;ce++){const jt=Et[ce];be=[];for(let ie=0,ae=jt.length,qt=ae-1,ye=ie+1;ie<ae;ie++,qt++,ye++)qt===ae&&(qt=0),ye===ae&&(ye=0),be[ie]=zt(jt[ie],jt[qt],jt[ye]);pe.push(be),Pe=Pe.concat(be)}for(let ce=0;ce<C;ce++){const Tt=ce/C,jt=x*Math.cos(Tt*Math.PI/2),ie=w*Math.sin(Tt*Math.PI/2)+A;for(let ae=0,qt=Lt.length;ae<qt;ae++){const ye=Pt(Lt[ae],Xt[ae],ie);ve(ye.x,ye.y,-jt)}for(let ae=0,qt=Et.length;ae<qt;ae++){const ye=Et[ae];be=pe[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Pt(ye[nn],be[nn],ie);ve(rn.x,rn.y,-jt)}}}const Ct=w+A;for(let ce=0;ce<ee;ce++){const Tt=_?Pt(Ft[ce],Pe[ce],Ct):Ft[ce];dt?(gt.copy(ft.normals[0]).multiplyScalar(Tt.x),nt.copy(ft.binormals[0]).multiplyScalar(Tt.y),lt.copy(it[0]).add(gt).add(nt),ve(lt.x,lt.y,lt.z)):ve(Tt.x,Tt.y,0)}for(let ce=1;ce<=u;ce++)for(let Tt=0;Tt<ee;Tt++){const jt=_?Pt(Ft[Tt],Pe[Tt],Ct):Ft[Tt];dt?(gt.copy(ft.normals[ce]).multiplyScalar(jt.x),nt.copy(ft.binormals[ce]).multiplyScalar(jt.y),lt.copy(it[ce]).add(gt).add(nt),ve(lt.x,lt.y,lt.z)):ve(jt.x,jt.y,p/u*ce)}for(let ce=C-1;ce>=0;ce--){const Tt=ce/C,jt=x*Math.cos(Tt*Math.PI/2),ie=w*Math.sin(Tt*Math.PI/2)+A;for(let ae=0,qt=Lt.length;ae<qt;ae++){const ye=Pt(Lt[ae],Xt[ae],ie);ve(ye.x,ye.y,p+jt)}for(let ae=0,qt=Et.length;ae<qt;ae++){const ye=Et[ae];be=pe[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Pt(ye[nn],be[nn],ie);dt?ve(rn.x,rn.y+it[u-1].y,it[u-1].x+jt):ve(rn.x,rn.y,p+jt)}}}function Bt(ce,Tt){let jt=ce.length;for(;--jt>=0;){const ie=jt;let ae=jt-1;ae<0&&(ae=ce.length-1);for(let qt=0,ye=u+2*C;qt<ye;qt++){const nn=ee*qt,on=ee*(qt+1);se(Tt+ie+nn,Tt+ae+nn,Tt+ae+on,Tt+ie+on)}}}function ve(ce,Tt,jt){l.push(ce),l.push(Tt),l.push(jt)}function le(ce,Tt,jt){Ie(ce),Ie(Tt),Ie(jt);const ie=r.length/3,ae=K.generateTopUV(n,r,ie-3,ie-2,ie-1);De(ae[0]),De(ae[1]),De(ae[2])}function se(ce,Tt,jt,ie){Ie(ce),Ie(Tt),Ie(ie),Ie(Tt),Ie(jt),Ie(ie);const ae=r.length/3,qt=K.generateSideWallUV(n,r,ae-6,ae-3,ae-2,ae-1);De(qt[0]),De(qt[1]),De(qt[3]),De(qt[1]),De(qt[2]),De(qt[3])}function Ie(ce){r.push(l[3*ce+0]),r.push(l[3*ce+1]),r.push(l[3*ce+2])}function De(ce){o.push(ce.x),o.push(ce.y)}(function(){const ce=r.length/3;if(_){let Tt=0,jt=ee*Tt;for(let ie=0;ie<$t;ie++){const ae=Mt[ie];le(ae[2]+jt,ae[1]+jt,ae[0]+jt)}Tt=u+2*C,jt=ee*Tt;for(let ie=0;ie<$t;ie++){const ae=Mt[ie];le(ae[0]+jt,ae[1]+jt,ae[2]+jt)}}else{for(let Tt=0;Tt<$t;Tt++){const jt=Mt[Tt];le(jt[2],jt[1],jt[0])}for(let Tt=0;Tt<$t;Tt++){const jt=Mt[Tt];le(jt[0]+ee*u,jt[1]+ee*u,jt[2]+ee*u)}}n.addGroup(ce,r.length/3-ce,0)})(),function(){const ce=r.length/3;let Tt=0;Bt(Lt,Tt),Tt+=Lt.length;for(let jt=0,ie=Et.length;jt<ie;jt++){const ae=Et[jt];Bt(ae,Tt),Tt+=ae.length}n.addGroup(ce,r.length/3-ce,1)}()}this.setAttribute("position",new An(r,3)),this.setAttribute("uv",new An(o,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(e,n,r){if(r.shapes=[],Array.isArray(e))for(let o=0,s=e.length;o<s;o++){const a=e[o];r.shapes.push(a.uuid)}else r.shapes.push(e.uuid);return n.extrudePath!==void 0&&(r.options.extrudePath=n.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let o=0,s=t.shapes.length;o<s;o++){const a=e[t.shapes[o]];n.push(a)}const r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new Ip[r.type]().fromJSON(r)),new Ns(n,t.options)}}const Sy={generateTopUV:function(i,t,e,n,r){const o=t[3*e],s=t[3*e+1],a=t[3*n],l=t[3*n+1],h=t[3*r],u=t[3*r+1];return[new I(o,s),new I(a,l),new I(h,u)]},generateSideWallUV:function(i,t,e,n,r,o){const s=t[3*e],a=t[3*e+1],l=t[3*e+2],h=t[3*n],u=t[3*n+1],p=t[3*n+2],_=t[3*r],x=t[3*r+1],w=t[3*r+2],A=t[3*o],C=t[3*o+1],G=t[3*o+2];return Math.abs(a-u)<Math.abs(s-h)?[new I(s,1-l),new I(h,1-p),new I(_,1-w),new I(A,1-G)]:[new I(a,1-l),new I(u,1-p),new I(x,1-w),new I(C,1-G)]}};class Iu extends Wn{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],o=[],s=[];let a=0,l=0;if(Array.isArray(t)===!1)h(t);else for(let u=0;u<t.length;u++)h(t[u]),this.addGroup(a,l,u),a+=l,l=0;function h(u){const p=r.length/3,_=u.extractPoints(e);let x=_.shape;const w=_.holes;Bo.isClockWise(x)===!1&&(x=x.reverse());for(let C=0,G=w.length;C<G;C++){const K=w[C];Bo.isClockWise(K)===!0&&(w[C]=K.reverse())}const A=Bo.triangulateShape(x,w);for(let C=0,G=w.length;C<G;C++){const K=w[C];x=x.concat(K)}for(let C=0,G=x.length;C<G;C++){const K=x[C];r.push(K.x,K.y,0),o.push(0,0,1),s.push(K.x,K.y)}for(let C=0,G=A.length;C<G;C++){const K=A[C],it=K[0]+p,ft=K[1]+p,nt=K[2]+p;n.push(it,ft,nt),l+=3}}this.setIndex(n),this.setAttribute("position",new An(r,3)),this.setAttribute("normal",new An(o,3)),this.setAttribute("uv",new An(s,2))}toJSON(){const t=super.toJSON();return function(e,n){if(n.shapes=[],Array.isArray(e))for(let r=0,o=e.length;r<o;r++){const s=e[r];n.shapes.push(s.uuid)}else n.shapes.push(e.uuid);return n}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,o=t.shapes.length;r<o;r++){const s=e[t.shapes[r]];n.push(s)}return new Iu(n,t.curveSegments)}}class Ey extends Ii{constructor(t){super(),this.type="ShadowMaterial",this.color=new fn(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}Ey.prototype.isShadowMaterial=!0;class Ay extends hn{constructor(t){super(t),this.type="RawShaderMaterial"}}Ay.prototype.isRawShaderMaterial=!0;class Bp extends Ii{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}Bp.prototype.isMeshStandardMaterial=!0;class My extends Bp{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new I(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=et(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new fn(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new fn).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}My.prototype.isMeshPhysicalMaterial=!0;class kp extends Ii{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}kp.prototype.isMeshPhongMaterial=!0;class Cy extends Ii{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Cy.prototype.isMeshToonMaterial=!0;class Ry extends Ii{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Ry.prototype.isMeshNormalMaterial=!0;class Iy extends Ii{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Iy.prototype.isMeshLambertMaterial=!0;class Py extends Ii{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Py.prototype.isMeshMatcapMaterial=!0;class Oy extends Ea{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Oy.prototype.isLineDashedMaterial=!0;const pi={arraySlice:function(i,t,e){return pi.isTypedArray(i)?new i.constructor(i.subarray(t,e!==void 0?e:i.length)):i.slice(t,e)},convertArray:function(i,t,e){return!i||!e&&i.constructor===t?i:typeof t.BYTES_PER_ELEMENT=="number"?new t(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,e=new Array(t);for(let n=0;n!==t;++n)e[n]=n;return e.sort(function(n,r){return i[n]-i[r]}),e},sortedArray:function(i,t,e){const n=i.length,r=new i.constructor(n);for(let o=0,s=0;s!==n;++o){const a=e[o]*t;for(let l=0;l!==t;++l)r[s++]=i[a+l]}return r},flattenJSON:function(i,t,e,n){let r=1,o=i[0];for(;o!==void 0&&o[n]===void 0;)o=i[r++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(t.push(o.time),e.push.apply(e,s)),o=i[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(t.push(o.time),s.toArray(e,e.length)),o=i[r++];while(o!==void 0);else do s=o[n],s!==void 0&&(t.push(o.time),e.push(s)),o=i[r++];while(o!==void 0)},subclip:function(i,t,e,n,r=30){const o=i.clone();o.name=t;const s=[];for(let l=0;l<o.tracks.length;++l){const h=o.tracks[l],u=h.getValueSize(),p=[],_=[];for(let x=0;x<h.times.length;++x){const w=h.times[x]*r;if(!(w<e||w>=n)){p.push(h.times[x]);for(let A=0;A<u;++A)_.push(h.values[x*u+A])}}p.length!==0&&(h.times=pi.convertArray(p,h.times.constructor),h.values=pi.convertArray(_,h.values.constructor),s.push(h))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(i,t=0,e=i,n=30){n<=0&&(n=30);const r=e.tracks.length,o=t/n;for(let s=0;s<r;++s){const a=e.tracks[s],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=i.tracks.find(function(G){return G.name===a.name&&G.ValueTypeName===l});if(h===void 0)continue;let u=0;const p=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);let _=0;const x=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);const w=a.times.length-1;let A;if(o<=a.times[0]){const G=u,K=p-u;A=pi.arraySlice(a.values,G,K)}else if(o>=a.times[w]){const G=w*p+u,K=G+p-u;A=pi.arraySlice(a.values,G,K)}else{const G=a.createInterpolant(),K=u,it=p-u;G.evaluate(o),A=pi.arraySlice(G.resultBuffer,K,it)}l==="quaternion"&&new V().fromArray(A).normalize().conjugate().toArray(A);const C=h.times.length;for(let G=0;G<C;++G){const K=G*x+_;if(l==="quaternion")V.multiplyQuaternionsFlat(h.values,K,A,0,h.values,K);else{const it=x-2*_;for(let ft=0;ft<it;++ft)h.values[K+ft]-=A[ft]}}}return i.blendMode=2501,i}};class ko{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],o=e[n-1];t:{e:{let s;n:{i:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<o)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,o)}if(n===a)break;if(o=r,r=e[++n],t<r)break e}s=e.length;break n}if(t>=o)break t;{const a=e[1];t<a&&(n=2,o=a);for(let l=n-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===l)break;if(r=o,o=e[--n-1],t>=o)break e}s=n,n=0}}for(;n<s;){const a=n+s>>>1;t<e[a]?s=a:n=a+1}if(r=e[n],o=e[n-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(r===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,o,t)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=t*r;for(let s=0;s!==r;++s)e[s]=n[o+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}ko.prototype.beforeStart_=ko.prototype.copySampleValue_,ko.prototype.afterEnd_=ko.prototype.copySampleValue_;class Ly extends ko{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(t,e,n){const r=this.parameterPositions;let o=t-2,s=t+1,a=r[o],l=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case 2401:o=t,a=2*e-n;break;case 2402:o=r.length-2,a=e+r[o]-r[o+1];break;default:o=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case 2401:s=t,l=2*n-e;break;case 2402:s=1,l=n+r[1]-r[0];break;default:s=t-1,l=e}const h=.5*(n-e),u=this.valueSize;this._weightPrev=h/(e-a),this._weightNext=h/(l-n),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=this._offsetPrev,p=this._offsetNext,_=this._weightPrev,x=this._weightNext,w=(n-e)/(r-e),A=w*w,C=A*w,G=-_*C+2*_*A-_*w,K=(1+_)*C+(-1.5-2*_)*A+(-.5+_)*w+1,it=(-1-x)*C+(1.5+x)*A+.5*w,ft=x*C-x*A;for(let nt=0;nt!==a;++nt)o[nt]=G*s[u+nt]+K*s[h+nt]+it*s[l+nt]+ft*s[p+nt];return o}}class Up extends ko{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=(n-e)/(r-e),p=1-u;for(let _=0;_!==a;++_)o[_]=s[h+_]*p+s[l+_]*u;return o}}class Ny extends ko{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class qr{constructor(t,e,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=pi.convertArray(e,this.TimeBufferType),this.values=pi.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:pi.convertArray(t.times,Array),values:pi.convertArray(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Ny(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Up(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Ly(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let o=0,s=r-1;for(;o!==r&&n[o]<t;)++o;for(;s!==-1&&n[s]>e;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=pi.arraySlice(n,o,s),this.values=pi.arraySlice(this.values,o*a,s*a)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==o;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),t=!1;break}s=l}if(r!==void 0&&pi.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),t=!1;break}}return t}optimize(){const t=pi.arraySlice(this.times),e=pi.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===2302,o=t.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const h=t[a];if(h!==t[a+1]&&(a!==1||h!==t[0]))if(r)l=!0;else{const u=a*n,p=u-n,_=u+n;for(let x=0;x!==n;++x){const w=e[u+x];if(w!==e[p+x]||w!==e[_+x]){l=!0;break}}}if(l){if(a!==s){t[s]=t[a];const u=a*n,p=s*n;for(let _=0;_!==n;++_)e[p+_]=e[u+_]}++s}}if(o>0){t[s]=t[o];for(let a=o*n,l=s*n,h=0;h!==n;++h)e[l+h]=e[a+h];++s}return s!==t.length?(this.times=pi.arraySlice(t,0,s),this.values=pi.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=pi.arraySlice(this.times,0),e=pi.arraySlice(this.values,0),n=new this.constructor(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}qr.prototype.TimeBufferType=Float32Array,qr.prototype.ValueBufferType=Float32Array,qr.prototype.DefaultInterpolation=2301;class Ds extends qr{}Ds.prototype.ValueTypeName="bool",Ds.prototype.ValueBufferType=Array,Ds.prototype.DefaultInterpolation=2300,Ds.prototype.InterpolantFactoryMethodLinear=void 0,Ds.prototype.InterpolantFactoryMethodSmooth=void 0;class Gp extends qr{}Gp.prototype.ValueTypeName="color";class Gl extends qr{}Gl.prototype.ValueTypeName="number";class Dy extends ko{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(n-e)/(r-e);let h=t*a;for(let u=h+a;h!==u;h+=4)V.slerpFlat(o,0,s,h-a,s,h,l);return o}}class Pa extends qr{InterpolantFactoryMethodLinear(t){return new Dy(this.times,this.values,this.getValueSize(),t)}}Pa.prototype.ValueTypeName="quaternion",Pa.prototype.DefaultInterpolation=2301,Pa.prototype.InterpolantFactoryMethodSmooth=void 0;class Fs extends qr{}Fs.prototype.ValueTypeName="string",Fs.prototype.ValueBufferType=Array,Fs.prototype.DefaultInterpolation=2300,Fs.prototype.InterpolantFactoryMethodLinear=void 0,Fs.prototype.InterpolantFactoryMethodSmooth=void 0;class Hl extends qr{}Hl.prototype.ValueTypeName="vector";class Hp{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=J(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(Fy(n[s]).scale(r));const o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let o=0,s=n.length;o!==s;++o)e.push(qr.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const o=e.length,s=[];for(let a=0;a<o;a++){let l=[],h=[];l.push((a+o-1)%o,a,(a+1)%o),h.push(0,1,0);const u=pi.getKeyframeOrder(l);l=pi.sortedArray(l,1,u),h=pi.sortedArray(h,1,u),r||l[0]!==0||(l.push(o),h.push(h[0])),s.push(new Gl(".morphTargetInfluences["+e[a].name+"]",l,h).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const h=t[a],u=h.name.match(o);if(u&&u.length>1){const p=u[1];let _=r[p];_||(r[p]=_=[]),_.push(h)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,p,_,x,w){if(_.length!==0){const A=[],C=[];pi.flattenJSON(_,A,C,x),A.length!==0&&w.push(new u(p,A,C))}},r=[],o=t.name||"default",s=t.fps||30,a=t.blendMode;let l=t.length||-1;const h=t.hierarchy||[];for(let u=0;u<h.length;u++){const p=h[u].keys;if(p&&p.length!==0)if(p[0].morphTargets){const _={};let x;for(x=0;x<p.length;x++)if(p[x].morphTargets)for(let w=0;w<p[x].morphTargets.length;w++)_[p[x].morphTargets[w]]=-1;for(const w in _){const A=[],C=[];for(let G=0;G!==p[x].morphTargets.length;++G){const K=p[x];A.push(K.time),C.push(K.morphTarget===w?1:0)}r.push(new Gl(".morphTargetInfluence["+w+"]",A,C))}l=_.length*(s||1)}else{const _=".bones["+e[u].name+"]";n(Hl,_+".position",p,"pos",r),n(Pa,_+".quaternion",p,"rot",r),n(Hl,_+".scale",p,"scl",r)}}return r.length===0?null:new this(o,l,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Fy(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gl;case"vector":case"vector2":case"vector3":case"vector4":return Hl;case"color":return Gp;case"quaternion":return Pa;case"bool":case"boolean":return Ds;case"string":return Fs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(i.type);if(i.times===void 0){const e=[],n=[];pi.flattenJSON(i.keys,e,n,"value"),i.times=e,i.values=n}return t.parse!==void 0?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}const Bs={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class By{constructor(t,e,n){const r=this;let o=!1,s=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,o===!1&&r.onStart!==void 0&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,p){return h.push(u,p),this},this.removeHandler=function(u){const p=h.indexOf(u);return p!==-1&&h.splice(p,2),this},this.getHandler=function(u){for(let p=0,_=h.length;p<_;p+=2){const x=h[p],w=h[p+1];if(x.global&&(x.lastIndex=0),x.test(u))return w}return null}}}const ky=new By;class Uo{constructor(t){this.manager=t!==void 0?t:ky,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,o){n.load(t,r,e,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Ur={};class Uy extends Uo{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Bs.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;if(Ur[t]!==void 0)return void Ur[t].push({onLoad:e,onProgress:n,onError:r});const a=t.match(/^data:(.*?)(;base64)?,(.*)$/);let l;if(a){const h=a[1],u=!!a[2];let p=a[3];p=decodeURIComponent(p),u&&(p=atob(p));try{let _;const x=(this.responseType||"").toLowerCase();switch(x){case"arraybuffer":case"blob":const w=new Uint8Array(p.length);for(let C=0;C<p.length;C++)w[C]=p.charCodeAt(C);_=x==="blob"?new Blob([w.buffer],{type:h}):w.buffer;break;case"document":_=new DOMParser().parseFromString(p,h);break;case"json":_=JSON.parse(p);break;default:_=p}setTimeout(function(){e&&e(_),o.manager.itemEnd(t)},0)}catch(_){setTimeout(function(){r&&r(_),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{Ur[t]=[],Ur[t].push({onLoad:e,onProgress:n,onError:r}),l=new XMLHttpRequest,l.open("GET",t,!0),l.addEventListener("load",function(h){const u=this.response,p=Ur[t];if(delete Ur[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Bs.add(t,u);for(let _=0,x=p.length;_<x;_++){const w=p[_];w.onLoad&&w.onLoad(u)}o.manager.itemEnd(t)}else{for(let _=0,x=p.length;_<x;_++){const w=p[_];w.onError&&w.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),l.addEventListener("progress",function(h){const u=Ur[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onProgress&&x.onProgress(h)}},!1),l.addEventListener("error",function(h){const u=Ur[t];delete Ur[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),l.addEventListener("abort",function(h){const u=Ur[t];delete Ur[t];for(let p=0,_=u.length;p<_;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),this.responseType!==void 0&&(l.responseType=this.responseType),this.withCredentials!==void 0&&(l.withCredentials=this.withCredentials),l.overrideMimeType&&l.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const h in this.requestHeader)l.setRequestHeader(h,this.requestHeader[h]);l.send(null)}return o.manager.itemStart(t),l}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class jp extends Uo{constructor(t){super(t)}load(t,e,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Bs.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function l(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),Bs.add(t,this),e&&e(this),o.manager.itemEnd(t)}function h(u){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),r&&r(u),o.manager.itemError(t),o.manager.itemEnd(t)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(t),a.src=t,a}}class Gy extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=new _i,s=new jp(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(h){s.load(t[h],function(u){o.images[h]=u,a++,a===6&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}for(let h=0;h<t.length;++h)l(h);return o}}class Hy extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=new Q,s=new jp(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(a){o.image=a;const l=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;o.format=l?1022:1023,o.needsUpdate=!0,e!==void 0&&e(o)},n,r),o}}class jy extends Or{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Fl(e,t))}getPoint(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const o=n[r]-e,s=this.curves[r],a=s.getLength(),l=a===0?0:1-o/a;return s.getPointAt(l)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],a=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,l=s.getPoints(a);for(let h=0;h<l.length;h++){const u=l[h];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(new Ip[r.type]().fromJSON(r))}return this}}class ks extends jy{constructor(t){super(),this.type="Path",this.currentPoint=new I,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Fl(this.currentPoint.clone(),new I(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const o=new Au(this.currentPoint.clone(),new I(t,e),new I(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,o,s){const a=new Eu(this.currentPoint.clone(),new I(t,e),new I(n,r),new I(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Mu(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,o,s){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,r,o,s),this}absarc(t,e,n,r,o,s){return this.absellipse(t,e,n,n,r,o,s),this}ellipse(t,e,n,r,o,s,a,l){const h=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+h,e+u,n,r,o,s,a,l),this}absellipse(t,e,n,r,o,s,a,l){const h=new Nl(t,e,n,r,o,s,a,l);if(this.curves.length>0){const p=h.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(h);const u=h.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Pu extends ks{constructor(t){super(t),this.uuid=J(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(new ks().fromJSON(r))}return this}}class Jr extends kn{constructor(t,e=1){super(),this.type="Light",this.color=new fn(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}Jr.prototype.isLight=!0;class zy extends Jr{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.groundColor=new fn(e)}copy(t){return Jr.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}zy.prototype.isHemisphereLight=!0;const zp=new tn,Vp=new k,Wp=new k;class Ou{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new I(512,512),this.map=null,this.mapPass=null,this.matrix=new tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new kr,this._frameExtents=new I(1,1),this._viewportCount=1,this._viewports=[new Ot(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Vp.setFromMatrixPosition(t.matrixWorld),e.position.copy(Vp),Wp.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Wp),e.updateMatrixWorld(),zp.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zp),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Xp extends Ou{constructor(){super(new un(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*X*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=t.distance||e.far;n===e.fov&&r===e.aspect&&o===e.far||(e.fov=n,e.aspect=r,e.far=o,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}Xp.prototype.isSpotLightShadow=!0;class Vy extends Jr{constructor(t,e,n=0,r=Math.PI/3,o=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.distance=n,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new Xp}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Vy.prototype.isSpotLight=!0;const Yp=new tn,Oa=new k,Lu=new k;class qp extends Ou{constructor(){super(new un(90,1,.5,500)),this._frameExtents=new I(4,2),this._viewportCount=6,this._viewports=[new Ot(2,1,1,1),new Ot(0,1,1,1),new Ot(3,1,1,1),new Ot(1,1,1,1),new Ot(3,0,1,1),new Ot(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,o=t.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),Oa.setFromMatrixPosition(t.matrixWorld),n.position.copy(Oa),Lu.copy(n.position),Lu.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Lu),n.updateMatrixWorld(),r.makeTranslation(-Oa.x,-Oa.y,-Oa.z),Yp.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yp)}}qp.prototype.isPointLightShadow=!0;class Wy extends Jr{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new qp}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Wy.prototype.isPointLight=!0;class Nu extends vn{constructor(t=-1,e=1,n=1,r=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-t,s=n+t,a=r+e,l=r-e;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,s=o+h*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}Nu.prototype.isOrthographicCamera=!0;class Jp extends Ou{constructor(){super(new Nu(-5,5,5,-5,.5,500))}}Jp.prototype.isDirectionalLightShadow=!0;class Xy extends Jr{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.shadow=new Jp}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Xy.prototype.isDirectionalLight=!0;class Yy extends Jr{constructor(t,e){super(t,e),this.type="AmbientLight"}}Yy.prototype.isAmbientLight=!0;class qy extends Jr{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}qy.prototype.isRectAreaLight=!0;class Zp{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new k)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*o),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*r*1.092548),e.addScaledVector(s[5],r*o*1.092548),e.addScaledVector(s[6],.315392*(3*o*o-1)),e.addScaledVector(s[7],n*o*1.092548),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*r),e.addScaledVector(s[2],1.023328*o),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*r),e.addScaledVector(s[5],.858086*r*o),e.addScaledVector(s[6],.743125*o*o-.247708),e.addScaledVector(s[7],.858086*n*o),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,o=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*o,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*o,e[6]=.315392*(3*o*o-1),e[7]=1.092548*n*o,e[8]=.546274*(n*n-r*r)}}Zp.prototype.isSphericalHarmonics3=!0;class Du extends Jr{constructor(t=new Zp,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Du.prototype.isLightProbe=!0;class Jy{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}}class Zy extends Wn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}Zy.prototype.isInstancedBufferGeometry=!0;class Ky extends Yn{constructor(t,e,n,r=1){typeof n=="number"&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}Ky.prototype.isInstancedBufferAttribute=!0,class extends Uo{constructor(i){super(i),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,t,e,n){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const r=this,o=Bs.get(i);if(o!==void 0)return r.manager.itemStart(i),setTimeout(function(){t&&t(o),r.manager.itemEnd(i)},0),o;const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader,fetch(i,s).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(a){Bs.add(i,a),t&&t(a),r.manager.itemEnd(i)}).catch(function(a){n&&n(a),r.manager.itemError(i),r.manager.itemEnd(i)}),r.manager.itemStart(i)}}.prototype.isImageBitmapLoader=!0;let Fu;const $y=function(){return Fu===void 0&&(Fu=new(window.AudioContext||window.webkitAudioContext)),Fu};class Qy extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=this,s=new Uy(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(a){try{const l=a.slice(0);$y().decodeAudioData(l,function(h){e(h)})}catch(l){r?r(l):console.error(l),o.manager.itemError(t)}},n,r)}}(class extends Du{constructor(i,t,e=1){super(void 0,e);const n=new fn().set(i),r=new fn().set(t),o=new k(n.r,n.g,n.b),s=new k(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends Du{constructor(i,t=1){super(void 0,t);const e=new fn().set(i);this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class tx extends kn{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl!==!1)return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl!==!1)return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class ex{constructor(t,e,n){let r,o,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,o=t*r+r;let s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)n[o+a]=n[a];s=e}else{s+=e;const a=e/s;this._mixBufferRegion(n,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=e*this._origIndex;this._mixBufferRegion(n,r,l,1-o,e)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let l=e,h=e+e;l!==h;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let o=n,s=r;o!==s;++o)e[o]=e[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,o){if(r>=.5)for(let s=0;s!==o;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){V.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,o){const s=this._workIndex*o;V.multiplyQuaternionsFlat(t,s,t,e,t,n),V.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,o){const s=1-r;for(let a=0;a!==o;++a){const l=e+a;t[l]=t[l]*s+t[n+a]*r}}_lerpAdditive(t,e,n,r,o){for(let s=0;s!==o;++s){const a=e+s;t[a]=t[a]+t[n+s]*r}}}const nx=new RegExp("[\\[\\]\\.:\\/]","g"),ix="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",rx=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),ox=/(WCOD+)?/.source.replace("WCOD",ix),sx=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),ax=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),lx=new RegExp("^"+rx+ox+sx+ax+"$"),hx=["material","materials","bones"];class $n{constructor(t,e,n){this.path=e,this.parsedPath=n||$n.parseTrackName(e),this.node=$n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new $n.Composite(t,e,n):new $n(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(nx,"")}static parseTrackName(t){const e=lx.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=n.nodeName.substring(r+1);hx.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(o){for(let s=0;s<o.length;s++){const a=o[s];if(a.name===e||a.uuid===e)return a;const l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.node[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let o=e.propertyIndex;if(t||(t=$n.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let h=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===h){h=u;break}break;default:if(t[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(h!==void 0){if(t[h]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const s=t[r];if(s===void 0){const h=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}$n.Composite=class{constructor(i,t,e){const n=e||$n.parseTrackName(t);this._targetGroup=i,this._bindings=i.subscribe_(t,n)}getValue(i,t){this.bind();const e=this._targetGroup.nCachedObjects_,n=this._bindings[e];n!==void 0&&n.getValue(i,t)}setValue(i,t){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].setValue(i,t)}bind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].bind()}unbind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].unbind()}},$n.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},$n.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},$n.prototype.GetterByBindingType=[$n.prototype._getValue_direct,$n.prototype._getValue_array,$n.prototype._getValue_arrayElement,$n.prototype._getValue_toArray],$n.prototype.SetterByBindingTypeAndVersioning=[[$n.prototype._setValue_direct,$n.prototype._setValue_direct_setNeedsUpdate,$n.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[$n.prototype._setValue_array,$n.prototype._setValue_array_setNeedsUpdate,$n.prototype._setValue_array_setMatrixWorldNeedsUpdate],[$n.prototype._setValue_arrayElement,$n.prototype._setValue_arrayElement_setNeedsUpdate,$n.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[$n.prototype._setValue_fromArray,$n.prototype._setValue_fromArray_setNeedsUpdate,$n.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class ux{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const o=e.tracks,s=o.length,a=new Array(s),l={endingStart:2400,endingEnd:2400};for(let h=0;h!==s;++h){const u=o[h].createInterpolant(null);a[h]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const r=this._clip.duration,o=t._clip.duration,s=o/r,a=r/o;t.warp(1,s,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,o=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=o,l[1]=o+n,h[0]=t/s,h[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const o=this._startTime;if(o!==null){const l=(t-o)*n;if(l<0||n===0)return;this._startTime=null,e=n*l}e*=this._updateTimeScale(t);const s=this._updateTime(e),a=this._updateWeight(t);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case 2501:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulateAdditive(a);break;case 2500:default:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulate(r,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,o=this._loopCount;const s=n===2202;if(t===0)return o===-1?r:s&&(1&o)==1?e-r:r;if(n===2200){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=e||r<0){const a=Math.floor(r/e);r-=e*a,o+=Math.abs(a);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const h=t<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(1&o)==1)return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(t,e,n){const r=this._mixer,o=r.time;let s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=e,a[1]=o+t,l[1]=n,this}}(class extends D{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,t){const e=i._localRoot||this._root,n=i._clip.tracks,r=n.length,o=i._propertyBindings,s=i._interpolants,a=e.uuid,l=this._bindingsByRootAndName;let h=l[a];h===void 0&&(h={},l[a]=h);for(let u=0;u!==r;++u){const p=n[u],_=p.name;let x=h[_];if(x!==void 0)o[u]=x;else{if(x=o[u],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,a,_));continue}const w=t&&t._propertyBindings[u].binding.parsedPath;x=new ex($n.create(e,_,w),p.ValueTypeName,p.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,a,_),o[u]=x}s[u].resultBuffer=x.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){const e=(i._localRoot||this._root).uuid,n=i._clip.uuid,r=this._actionsByClip[n];this._bindAction(i,r&&r.knownActions[0]),this._addInactiveAction(i,n,e)}const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];r.useCount++==0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.useCount==0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){const t=i._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(i,t,e){const n=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,r[t]=o;else{const s=o.knownActions;i._byClipCacheIndex=s.length,s.push(i)}i._cacheIndex=n.length,n.push(i),o.actionByRoot[e]=i}_removeInactiveAction(i){const t=this._actions,e=t[t.length-1],n=i._cacheIndex;e._cacheIndex=n,t[n]=e,t.pop(),i._cacheIndex=null;const r=i._clip.uuid,o=this._actionsByClip,s=o[r],a=s.knownActions,l=a[a.length-1],h=i._byClipCacheIndex;l._byClipCacheIndex=h,a[h]=l,a.pop(),i._byClipCacheIndex=null,delete s.actionByRoot[(i._localRoot||this._root).uuid],a.length===0&&delete o[r],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.referenceCount==0&&this._removeInactiveBinding(r)}}_lendAction(i){const t=this._actions,e=i._cacheIndex,n=this._nActiveActions++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackAction(i){const t=this._actions,e=i._cacheIndex,n=--this._nActiveActions,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_addInactiveBinding(i,t,e){const n=this._bindingsByRootAndName,r=this._bindings;let o=n[t];o===void 0&&(o={},n[t]=o),o[e]=i,i._cacheIndex=r.length,r.push(i)}_removeInactiveBinding(i){const t=this._bindings,e=i.binding,n=e.rootNode.uuid,r=e.path,o=this._bindingsByRootAndName,s=o[n],a=t[t.length-1],l=i._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[r],Object.keys(s).length===0&&delete o[n]}_lendBinding(i){const t=this._bindings,e=i._cacheIndex,n=this._nActiveBindings++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackBinding(i){const t=this._bindings,e=i._cacheIndex,n=--this._nActiveBindings,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_lendControlInterpolant(){const i=this._controlInterpolants,t=this._nActiveControlInterpolants++;let e=i[t];return e===void 0&&(e=new Up(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),e.__cacheIndex=t,i[t]=e),e}_takeBackControlInterpolant(i){const t=this._controlInterpolants,e=i.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];i.__cacheIndex=n,t[n]=i,r.__cacheIndex=e,t[e]=r}clipAction(i,t,e){const n=t||this._root,r=n.uuid;let o=typeof i=="string"?Hp.findByName(n,i):i;const s=o!==null?o.uuid:i,a=this._actionsByClip[s];let l=null;if(e===void 0&&(e=o!==null?o.blendMode:2500),a!==void 0){const u=a.actionByRoot[r];if(u!==void 0&&u.blendMode===e)return u;l=a.knownActions[0],o===null&&(o=l._clip)}if(o===null)return null;const h=new ux(this,o,t,e);return this._bindAction(h,l),this._addInactiveAction(h,s,r),h}existingAction(i,t){const e=t||this._root,n=e.uuid,r=typeof i=="string"?Hp.findByName(e,i):i,o=r?r.uuid:i,s=this._actionsByClip[o];return s!==void 0&&s.actionByRoot[n]||null}stopAllAction(){const i=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)i[t].stop();return this}update(i){i*=this.timeScale;const t=this._actions,e=this._nActiveActions,n=this.time+=i,r=Math.sign(i),o=this._accuIndex^=1;for(let l=0;l!==e;++l)t[l]._update(n,i,r,o);const s=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)s[l].apply(o);return this}setTime(i){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){const t=this._actions,e=i.uuid,n=this._actionsByClip,r=n[e];if(r!==void 0){const o=r.knownActions;for(let s=0,a=o.length;s!==a;++s){const l=o[s];this._deactivateAction(l);const h=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=h,t[h]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[e]}}uncacheRoot(i){const t=i.uuid,e=this._actionsByClip;for(const r in e){const o=e[r].actionByRoot[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}const n=this._bindingsByRootAndName[t];if(n!==void 0)for(const r in n){const o=n[r];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(i,t){const e=this.existingAction(i,t);e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1),class extends ya{constructor(i,t,e=1){super(i,t),this.meshPerAttribute=e}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}clone(i){const t=super.clone(i);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(i){const t=super.toJSON(i);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}.prototype.isInstancedInterleavedBuffer=!0,new I,new k,new k,class extends kn{constructor(i){super(),this.material=i,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const Go=new k,jl=new tn,Bu=new tn,cx=new Float32Array(1);new Int32Array(cx.buffer);const Kp=[.125,.215,.35,.446,.526,.582],dx=5+Kp.length,px=new tr({side:1,depthWrite:!1,depthTest:!1});new wt(new ne,px),fx();function fx(){const i=[],t=[],e=[];let n=8;for(let r=0;r<dx;r++){const o=Math.pow(2,n);t.push(o);let s=1/o;r>4?s=Kp[r-8+4-1]:r==0&&(s=0),e.push(s);const a=1/(o-1),l=-a/2,h=1+a/2,u=[l,l,h,l,h,h,l,l,h,h,l,h],p=6,_=6,x=3,w=2,A=1,C=new Float32Array(x*_*p),G=new Float32Array(w*_*p),K=new Float32Array(A*_*p);for(let ft=0;ft<p;ft++){const nt=ft%3*2/3-1,gt=ft>2?0:-1,lt=[nt,gt,0,nt+2/3,gt,0,nt+2/3,gt+1,0,nt,gt,0,nt+2/3,gt+1,0,nt,gt+1,0];C.set(lt,x*_*ft),G.set(u,w*_*ft);const dt=[ft,ft,ft,ft,ft,ft];K.set(dt,A*_*ft)}const it=new Wn;it.setAttribute("position",new Yn(C,x)),it.setAttribute("uv",new Yn(G,w)),it.setAttribute("faceIndex",new Yn(K,A)),i.push(it),n>4&&n--}return{_lodPlanes:i,_sizeLods:t,_sigmas:e}}Or.create=function(i,t){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(Or.prototype),i.prototype.constructor=i,i.prototype.getPoint=t,i},ks.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)},class extends yu{constructor(i=10,t=10,e=4473924,n=8947848){e=new fn(e),n=new fn(n);const r=t/2,o=i/t,s=i/2,a=[],l=[];for(let u=0,p=0,_=-s;u<=t;u++,_+=o){a.push(-s,0,_,s,0,_),a.push(_,0,-s,_,0,s);const x=u===r?e:n;x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3}const h=new Wn;h.setAttribute("position",new An(a,3)),h.setAttribute("color",new An(l,3)),super(h,new Ea({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends yu{constructor(i){const t=function a(l){const h=[];l&&l.isBone&&h.push(l);for(let u=0;u<l.children.length;u++)h.push.apply(h,a(l.children[u]));return h}(i),e=new Wn,n=[],r=[],o=new fn(0,0,1),s=new fn(0,1,0);for(let a=0;a<t.length;a++){const l=t[a];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}e.setAttribute("position",new An(n,3)),e.setAttribute("color",new An(r,3)),super(e,new Ea({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=t,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const t=this.bones,e=this.geometry,n=e.getAttribute("position");Bu.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const s=t[r];s.parent&&s.parent.isBone&&(jl.multiplyMatrices(Bu,s.matrixWorld),Go.setFromMatrixPosition(jl),n.setXYZ(o,Go.x,Go.y,Go.z),jl.multiplyMatrices(Bu,s.parent.matrixWorld),Go.setFromMatrixPosition(jl),n.setXYZ(o+1,Go.x,Go.y,Go.z),o+=2)}e.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Uo.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Jy.extractUrlBase(i)},Uo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},_t.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)},_t.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},_t.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},_t.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},_t.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)},Ge.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},kr.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)},F.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},F.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},F.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},F.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},F.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},F.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},tn.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)},tn.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new k().setFromMatrixColumn(this,3)},tn.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)},tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tn.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tn.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)},tn.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tn.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tn.prototype.makeFrustum=function(i,t,e,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,t,n,e,r,o)},tn.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},ui.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)},V.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)},V.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},gi.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},gi.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)},gi.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},di.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},di.prototype.barycoordFromPoint=function(i,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,t)},di.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)},di.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)},di.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)},di.barycoordFromPoint=function(i,t,e,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),di.getBarycoord(i,t,e,n,r)},di.normal=function(i,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),di.getNormal(i,t,e,n)},Pu.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)},Pu.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ns(this,i)},Pu.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Iu(this,i)},I.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},I.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},I.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},k.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},k.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},k.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)},k.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)},k.prototype.getColumnFromMatrix=function(i,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)},k.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)},k.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},k.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},k.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ot.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},Ot.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},kn.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)},kn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},kn.prototype.translate=function(i,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,i)},kn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},kn.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),wt.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(wt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),pp.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},un.prototype.setLens=function(i,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(i)},Object.defineProperties(Jr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}}),Object.defineProperties(Yn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Yn.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},Yn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Yn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Wn.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)},Wn.prototype.addAttribute=function(i,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(i,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new Yn(arguments[1],arguments[2])))},Wn.prototype.addDrawCall=function(i,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,t)},Wn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Wn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Wn.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)},Wn.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(Wn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ya.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},ya.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ns.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ns.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ns.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},mu.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(Ii.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}}}),Object.defineProperties(hn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}}),ti.prototype.clearTarget=function(i,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(t,e,n)},ti.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)},ti.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ti.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ti.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ti.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ti.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ti.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ti.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ti.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ti.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ti.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ti.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ti.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ti.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)},ti.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ti.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ti.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ti.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ti.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ti.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ti.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ti.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ti.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ti.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ti.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ip.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Vt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}}),tx.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new Qy().load(i,function(e){t.setBuffer(e)}),this},Kn.prototype.updateCubeMap=function(i,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,t)},Kn.prototype.clear=function(i,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,t,e,n)},P.crossOrigin=void 0,P.loadTexture=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new Hy;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},P.loadTextureCube=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new Gy;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},P.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},P.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"130"}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="130");var mx=v(6),fi=v.n(mx),gx=v(34),vx=v.n(gx),_x=v(9),mi=v.n(_x);class yx{constructor(){this.camera=new Nu(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(t,e){t.position.z=50}updateAspect(t,e){this.camera.left=-1*t/2,this.camera.right=t/2,this.camera.top=e/2,this.camera.bottom=-1*e/2,this.camera.updateProjectionMatrix()}}const $p={linear:(i,t,e,n)=>e*i/n+t,easeIn:(i,t,e,n)=>e*(i/=n)*i+t,strongEaseIn:(i,t,e,n)=>e*(i/=n)*i*i*i*i+t,strongEaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i*i*i+1)+t,sineaseIn:(i,t,e,n)=>e*(i/=n)*i*i+t,sineaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i+1)+t},br=new Q;class Ki{constructor(){this.camera=new yx,this.mesh=new wt,this.material=null,this.geometry=null}applyOptions(t){}addObjects(t){this.mesh.position.z=50,t.add(this.mesh)}setSize(t,e){this.camera.updateAspect(t,e),this.geometry=new Ir(t,e,1,1),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:t},height:{value:e},timePercent:{value:0},texturePrev:{value:br},textureNext:{value:br}},this.applyOptions(this.options),this.mesh.geometry=this.geometry,this.mesh.material=this.material}setPrevTexture(t){this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.material.uniforms.textureNext.value=t}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var xx=v(72),bx=v.n(xx),Tx=v(73),wx=v.n(Tx),Sx=v(74),Ex=v.n(Sx),Ax=v(75),Mx=v.n(Ax),Cx=v(76),Rx=v.n(Cx),Ix=v(77),Px=v.n(Ix),Ox=v(78),Lx=v.n(Ox),Nx=v(79),Dx=v.n(Nx),Fx=v(80),Bx=v.n(Fx),kx=v(81),Ux=v.n(kx),Gx=v(82),Hx=v.n(Gx),jx=v(83),zx=v.n(jx),Vx=v(84),Wx=v.n(Vx),Xx=v(85),Yx=v.n(Xx);class ls{constructor(){this.camera=new un(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}focus(t,e){const n=.5*e/Math.tan(Math.PI/6);t.position.z=1e3-n}}class La{constructor(){this.prevTexture=br,this.nextTexture=br,this.geometry=new Wn,this.material=null,this.camera=new ls,this.mesh=new wt,this.textureWidth=0,this.textureHeight=0}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}applyOptions(t){this.options=t}initMesh(t,e){const n=[],r=[],o=[],s=this.verticalSegments,a=this.horizontalSegments(),l=t/2,h=e/2,u=t/a,p=e/s,_=this.extraAttributes(),x=Object.keys(_),w=x.reduce((A,C)=>(A[C]=[],A),{});for(let A=0;A<s;A++){const C=A*p-h;for(let G=0;G<a;G++){const K=G*u-l;r.push(K,-C,0),o.push(1*G/a,1-1*A/s),x.forEach(it=>w[it].push(..._[it].generator(A,G))),r.push(K+u,-C,0),o.push(1*(G+1)/a,1-1*A/s),x.forEach(it=>w[it].push(..._[it].generator(A,G))),r.push(K,-C-p,0),o.push(1*G/a,1-1*(A+1)/s),x.forEach(it=>w[it].push(..._[it].generator(A,G))),r.push(K+u,-C-p,0),o.push(1*(G+1)/a,1-1*(A+1)/s),x.forEach(it=>w[it].push(..._[it].generator(A,G)))}}for(let A=0;A<s*a;A++){const C=4*A,G=C+1,K=C+2,it=C+3;n.push(G,C,it),n.push(C,K,it)}return this.geometry.setIndex(n),this.geometry.setAttribute("position",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),x.forEach(A=>{const{threeType:C,jsType:G,itemSize:K}=_[A];this.geometry.setAttribute(A,new C(new G(w[A]),K))}),{verticalSegments:s,horizontalSegments:a,segmentWidth:u,segmentHeight:p}}setSize(t,e){this.textureWidth=t,this.textureHeight=e,this.camera.updateAspect(t,e),this.camera.focus(this.mesh,e),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:2}),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material;const{verticalSegments:n,horizontalSegments:r,segmentWidth:o,segmentHeight:s}=this.initMesh(t,e);this.material.uniforms={segmentWidth:{value:o},segmentHeight:{value:s},verticalSegments:{value:n},horizontalSegments:{value:r},timePercent:{value:0},texturePrev:{value:br},textureNext:{value:br}},this.applyOptions(this.options)}setPrevTexture(t){this.prevTexture=t,this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.nextTexture=t,this.material.uniforms.textureNext.value=t}addObjects(t){t.add(this.mesh)}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var qx=v(86),Jx=v.n(qx),Zx=v(87),Kx=v.n(Zx),$x=v(88),Qx=v.n($x),t1=v(89),e1=v.n(t1),n1=v(90),i1=v.n(n1),r1=v(91),o1=v.n(r1),s1=v(92),a1=v.n(s1),l1=v(93),h1=v.n(l1),u1=v(94),c1=v.n(u1),d1=v(95),p1=v.n(d1),f1=v(96),m1=v.n(f1),g1=v(97),v1=v.n(g1);class Qp extends La{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=v1.a,this.vertexShader=m1.a,this.verticalSegments=100}addObjects(t){t.add(this.mesh),t.background=this.nextTexture}extraAttributes(){return{}}applyOptions(t){super.applyOptions(t);const e=this.options.find(n=>n.name==="invX");this.material.uniforms.option={value:e!=null&&e.value?Number(e.value):0}}}var _1=v(98),y1=v.n(_1),x1=v(99),b1=v.n(x1),T1=v(100),w1=v.n(T1),S1=v(101),E1=v.n(S1),A1=v(102),M1=v.n(A1),C1=v(103),R1=v.n(C1),I1=v(104),P1=v.n(I1),O1=v(105),L1=v.n(O1),N1=v(47),tf=v.n(N1),D1=v(48),ef=v.n(D1),F1=v(106),B1=v.n(F1),k1=v(107),U1=v.n(k1);const G1={RandomLines:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=wx.a,this.options=[{name:"dir",value:"horz"}]}genRandomLines(){let i=[1];for(let e=20;e--;){let n=i.sort((l,h)=>h-l)[0],r=i.indexOf(n),o=Math.random(),s=n*o,a=n*(1-o);i.splice(r,1),i.push(s,a)}let t=i.length;for(;t;){let e=Math.floor(Math.random()*t--);[i[e],i[t]]=[i[t],i[e]]}return i}applyOptions(i){var t,e;super.applyOptions(i),this.material.uniforms.direction={value:((e=(t=this.options)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.value)==="horz"?0:1}}setSize(i,t){super.setSize(i,t),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=bx.a}},Shape:class extends Ki{constructor(){super(...arguments),this.duration=800,this.fragmentShader=Ex.a,this.options=[]}},Ripples:class extends Ki{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=Mx.a,this.options=[{name:"dir",value:"center"}],this.optionsMap={center:0,ru:1,lu:2,ld:3,rd:4}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"center"]}}},Erase:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Rx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Dissolve:class extends Ki{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=Px.a,this.options=[],this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setSize(i,t){super.setSize(i,t);for(let e=0;e<1600;e++){let n=this.random40(),r=this.random40();for(;this.dissolveIndices[`${n}_${r}`]!==void 0;)n=this.random40(),r=this.random40();this.dissolveIndices[`${n}_${r}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var i=new Uint8Array(4800);for(let t=0;t<1600;t++){const e=t%40+1,n=Math.floor(t/40)+1,r=3*t;this.dissolveIndices[`${e}_${n}`]===0?(i[r]=0,i[r+1]=0,i[r+2]=0):(i[r]=255,i[r+1]=255,i[r+2]=255)}return new fp(i,40,40,1022)}updateAnimation(i){const t=1600*i-Object.keys(this.dissolveIndices).filter(e=>this.dissolveIndices[e]===1).length;for(let e=0;e<t;e++){const n=Object.keys(this.dissolveIndices).filter(o=>this.dissolveIndices[o]===0),r=Math.ceil(Math.random()*n.length)-1;this.dissolveIndices[n[r]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends Ki{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=Lx.a,this.options=[]}},FadeInOut:class extends Ki{constructor(){super(...arguments),this.duration=700,this.fragmentShader=Dx.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="thruBlk");this.material.uniforms.option={value:(t==null?void 0:t.value)==="1"?1:0}}},Push:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Bx.a,this.options=[],this.optionsMap={u:0,r:1,d:2,l:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"l"]}}},Separation:class extends Ki{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=Ux.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(n=>n.name==="orient"),e=this.options.find(n=>n.name==="dir");this.material.uniforms.orient={value:(t==null?void 0:t.value)==="vert"},this.material.uniforms.direction={value:(e==null?void 0:e.value)==="in"}}},Display:class extends Ki{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=Hx.a,this.options=[]}applyOptions(i){const t=this.options.find(n=>n.name==="dir"),e=this.options.find(n=>n.name==="thruBlk");this.material.uniforms.direction={value:(t==null?void 0:t.value)==="r"},this.material.uniforms.thruBlk={value:(e==null?void 0:e.value)==="1"}}},Uncover:class extends Ki{constructor(){super(...arguments),this.duration=750,this.fragmentShader=zx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Cover:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Wx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Flash:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Yx.a,this.options=[]}},Checkerboard:class extends La{constructor(){super(...arguments),this.duration=2500,this.options=[{name:"dir",value:"horz"}],this.fragmentShader=Kx.a,this.vertexShader=Jx.a,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>(this.vIndex!==`${i}${t}`&&(this.delay=.3*Math.random(),this.vIndex=`${i}${t}`),[this.delay])},segment:{threeType:An,jsType:Float32Array,itemSize:2,generator:(i,t)=>[t,i]},option:{threeType:ma,jsType:Int32Array,itemSize:1,generator:()=>[this.options.find(i=>i.name==="dir"&&i.value==="horz")?0:1]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new Wn,this.material=new hn({fragmentShader:e1.a,vertexShader:Qx.a,side:2}),this.camera=new ls,this.mesh=new wt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=Math.ceil(124*i/t),h=i/2,u=t/2,p=i/l,_=t/124;for(let x=0;x<124;x++){const w=x*_-u;for(let A=0;A<l;A++){const C=A*p-h,G=Math.ceil((A+1)/((l+1)/12)),K=.4/G,it=(G-1)*K+Math.random()*K;n.push(C,-w,0),o.push(1*A/l,1-1*x/124),r.push(0,0,1),s.push(A,x),a.push(it),n.push(C+p,-w,0),o.push(1*(A+1)/l,1-1*x/124),r.push(0,0,1),s.push(A,x),a.push(it),n.push(C,-w-_,0),o.push(1*A/l,1-1*(x+1)/124),r.push(0,0,1),s.push(A,x),a.push(it),n.push(C+p,-w-_,0),o.push(1*(A+1)/l,1-1*(x+1)/124),r.push(0,0,1),s.push(A,x),a.push(it)}}for(let x=0;x<124*l;x++){const w=4*x,A=w+1,C=w+2,G=w+3;e.push(A,w,G),e.push(w,C,G)}return this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("normal",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("segment",new An(new Float32Array(s),2)),this.geometry.setAttribute("times",new An(new Float32Array(a),1)),{verticalSegments:124,horizontalSegments:l,segmentWidth:p,segmentHeight:_}}setSize(i,t){const{verticalSegments:e,horizontalSegments:n,segmentWidth:r,segmentHeight:o}=this.initData(i,t);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:r},segmentHeight:{value:o},verticalSegments:{value:e},horizontalSegments:{value:n},timePercent:{value:0},texturePrev:{value:br},textureNext:{value:br}},this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,new kp({side:2,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new Wn,this.material=new hn({fragmentShader:o1.a,vertexShader:i1.a,side:2}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new ls,this.mesh=new wt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=i/2,h=t/2,u=i/this.horizontalSegments;for(let p=0;p<this.horizontalSegments;p++){const _=Math.abs(p-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),x=p*u-l;n.push(x,h,0),r.push(0),o.push(p/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,h,0),r.push(0),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x,-1*h,0),r.push(0),o.push(p/this.horizontalSegments,0),s.push(p),a.push(_),n.push(x+u,-1*h,0),o.push((p+1)/this.horizontalSegments,0),r.push(0),s.push(p),a.push(_),n.push(x+u,h,0),r.push(1),o.push(p/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,h,-1*u),r.push(1),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(_),n.push(x+u,-1*h,0),r.push(1),o.push(p/this.horizontalSegments,0),s.push(p),a.push(_),n.push(x+u,-1*h,-1*u),o.push((p+1)/this.horizontalSegments,0),r.push(1),s.push(p),a.push(_)}for(let p=0;p<this.horizontalSegments;p++){const _=8*p,x=_+1,w=_+2,A=_+3,C=_+4,G=_+5,K=_+6,it=_+7;e.push(x,_,A),e.push(_,w,A),e.push(G,C,it),e.push(C,K,it)}this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("index",new An(new Float32Array(s),1)),this.geometry.setAttribute("type",new An(new Float32Array(r),1)),this.geometry.setAttribute("delay",new An(new Float32Array(a),1))}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}setSize(i,t){this.initData(i,t),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:i/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:br},textureNext:{value:br}},this.meshToCameraDistance=.5*t/Math.tan(Math.PI/6),this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},Curtain:class extends La{constructor(){super(...arguments),this.duration=6e3,this.options=[],this.fragmentShader=h1.a,this.vertexShader=a1.a,this.verticalSegments=100}extraAttributes(){return{isLeft:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>[t<this.horizontalSegments()/2?1:0]}}}addObjects(i){super.addObjects(i),this.mesh.position.z+=20,i.background=this.nextTexture}},Fall:class extends La{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.options=[{name:"invX",value:"0"}],this.verticalSegments=100,this.fragmentShader=p1.a,this.vertexShader=c1.a}extraAttributes(){return{}}setSize(i,t){var e;super.setSize(i,t);const n=this.options.find(r=>r.name==="invX");this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))},this.material.uniforms.option={value:(e=n==null?void 0:n.value)!==null&&e!==void 0?e:0}}addObjects(i){i.add(this.mesh),i.background=this.nextTexture}updateAnimation(i){this.material.uniforms.timePercent.value=i}},Suspension:class extends Qp{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=b1.a,this.vertexShader=y1.a}addObjects(i){i.add(this.mesh),i.background=this.prevTexture}},Clock:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=w1.a,this.options=[]}},Combing:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=E1.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="vert"?1:0}}},Scale:class extends Ki{constructor(){super(...arguments),this.duration=900,this.fragmentShader=M1.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="in"?0:1}}},PeelOff:Qp,Flip:class extends La{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=P1.a,this.vertexShader=R1.a,this.verticalSegments=1}extraAttributes(){return{}}applyOptions(i){const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="l"?1:0}}},Strips:class extends Ki{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=L1.a,this.options=[],this.defaultDir="lu",this.optionsMap={[this.defaultDir]:0,ld:1,rd:2,ru:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Gallery:class{constructor(){this.camera=new ls,this.duration=1600,this.options=[],this.gap=10,this.group=new Cs,this.prevMesh=new wt,this.nextMesh=new wt,this.width=100,this.height=100,this.prevMaterial=new hn({vertexShader:tf.a,fragmentShader:ef.a,side:2,uniforms:{galleryTexture:{value:br},galleryHeight:{value:1}}}),this.nextMaterial=new hn({vertexShader:tf.a,fragmentShader:ef.a,side:2,uniforms:{galleryTexture:{value:br},galleryHeight:{value:1}}})}get isRight(){const i=this.options.find(t=>t.name==="dir");return!i||i.value==="r"}addObjects(i){this.group.add(this.prevMesh),this.group.add(this.nextMesh),i.add(this.group)}dispose(){this.prevMaterial.dispose(),this.nextMaterial.dispose(),this.prevMesh.geometry.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){this.nextMaterial.uniforms.galleryTexture.value=i,this.nextMesh.material=this.nextMaterial}setPrevTexture(i){this.prevMaterial.uniforms.galleryTexture.value=i,this.prevMesh.material=this.prevMaterial}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.gap=this.width/20,this.prevMaterial.uniforms.galleryHeight.value=t,this.nextMaterial.uniforms.galleryHeight.value=t;const e=new Ir(i,1.2*t+8,1,1);this.prevMesh.geometry=e;const n=new Ir(i,1.2*t+8,1,1);this.nextMesh.geometry=n,this.nextMesh.position.z=this.prevMesh.position.z,this.isRight?this.nextMesh.position.x=i+this.gap:this.nextMesh.position.x=-1*(i+this.gap)}updateAnimation(i){if(i<.3){const t=i/.3;this.isRight?(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*-1*t):(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*t)}else if(i>=.3&&i<.7){const t=(i-.3)/.4;this.isRight?(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=-1*(this.width+this.gap)*t):(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=(this.width+this.gap)*t)}else{const t=(i-.7)/.3;this.isRight?(this.group.position.x=-1*(this.width+this.gap),this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*-1*(1-t)):(this.group.position.x=this.width+this.gap,this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*(1-t))}}},Switch:class{constructor(){this.camera=new ls,this.duration=6e3,this.options=[],this.prevMesh=new wt,this.nextMesh=new wt,this.width=100,this.height=100,this.depth=1,this.prevDepth=1}addObjects(i){i.add(this.prevMesh),i.add(this.nextMesh)}dispose(){Array.isArray(this.prevMesh.material)?this.prevMesh.material.forEach(i=>i.dispose()):this.prevMesh.material.dispose(),this.prevMesh.geometry.dispose(),Array.isArray(this.nextMesh.material)?this.nextMesh.material.forEach(i=>i.dispose()):this.nextMesh.material.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){const t=new tr({map:i});this.nextMesh.material=t}setPrevTexture(i){const t=new tr({map:i});this.prevMesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.depth=t/2;const e=new Ir(i,t,1,1);this.prevMesh.geometry=e;const n=new Ir(i,t,1,1);this.nextMesh.geometry=n,this.prevDepth=this.prevMesh.position.z}updateAnimation(i){const t=this.options.find(e=>e.name==="dir");if(i<.5){const e=i/.5;this.prevMesh.position.x=this.width/2*e,this.prevMesh.rotation.y=-Math.PI/10*e,this.nextMesh.position.x=-this.width/2*e,this.nextMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.z=this.prevDepth-this.depth*(1-e)}else{const e=(i-.5)/.5;this.prevMesh.position.x=this.width/2*(1-e),this.prevMesh.rotation.y=-Math.PI/10*(1-e),this.prevMesh.position.z=this.prevDepth-this.depth*e,this.nextMesh.position.x=-this.width/2*(1-e),this.nextMesh.rotation.y=Math.PI/10*(1-e)}if(t&&t.value==="l")if(i<.5){const e=i/.5;this.prevMesh.position.x=-this.width/2*e,this.prevMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.x=this.width/2*e,this.nextMesh.rotation.y=-Math.PI/10*e}else{const e=(i-.5)/.5;this.prevMesh.position.x=-this.width/2*(1-e),this.prevMesh.rotation.y=Math.PI/10*(1-e),this.nextMesh.position.x=this.width/2*(1-e),this.nextMesh.rotation.y=-Math.PI/10*(1-e)}}},Prism:class{constructor(){this.camera=new ls,this.duration=6e3,this.preset=null,this.presetZ=0,this.mesh=new wt,this.width=100,this.height=100}addObjects(i){this.mesh.geometry=this.box,i.add(this.mesh)}dispose(){Array.isArray(this.mesh.material)?this.mesh.material.forEach(i=>i.dispose()):this.mesh.material.dispose(),this.mesh.geometry.dispose()}setNextTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new tr({map:i})),t.push(new tr({map:i})),t.push(new tr({map:i})),this.mesh.material=t}setPrevTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new tr({map:i})),t.push(new tr({map:i})),t.push(new tr({map:i})),this.mesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.position.z-=i/2,this.width=i,this.height=t,this.box=new ne(i,t,i,1,1,1),this.mesh.geometry=this.box}updateAnimation(i){this.preset===null&&(this.preset=i>0?0:Math.PI/2,this.presetZ=this.mesh.position.z);const t=Math.PI/2*i,e=(Math.sqrt(2)-1)*(this.width/2);this.mesh.rotation.y=this.preset+t,this.mesh.position.z=i<=.5?this.presetZ-i/.5*e:this.presetZ-(1-(i-.5)/.5)*e}},Doors:class{constructor(){this.camera=new ls,this.duration=1600,this.options=[],this.width=100,this.preMaterial=new hn({fragmentShader:U1.a,vertexShader:B1.a,uniforms:{prevTexture:{value:br},timePercent:{value:0},offset:{value:0}}}),this.prevGeometry=new Wn,this.prevMesh=new wt,this.nextMesh=new wt}addObjects(i){this.prevMesh.material=this.preMaterial,this.prevMesh.geometry=this.prevGeometry,this.prevMesh.material.transparent=!0,i.add(this.prevMesh),i.add(this.nextMesh)}setNextTexture(i){this.nextMesh.material=new tr({map:i})}setPrevTexture(i){this.preMaterial.uniforms.prevTexture.value=i}setSize(i,t){this.width=i,this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t);const e=i/2,n=t/2;this.preMaterial.uniforms.offset.value=i/2,this.prevGeometry.setIndex([0,1,2,3,4,5,6,7,8,9,10,11]);const r=this.options.find(s=>s.name==="dir"),o=r&&r.value==="vert"?0:1;this.preMaterial.uniforms.option={value:o},o===1?(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,0,0,e,n,0,-e,0,0,e,0,0,e,n,0,-e,0,0,-e,-n,0,e,0,0,-e,-n,0,e,-n,0,e,0,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,.5,1,1,0,.5,1,.5,1,1,0,.5,0,0,1,.5,0,0,1,0,1,.5],2))):(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,-n,0,0,n,0,-e,-n,0,0,-n,0,0,n,0,0,n,0,0,-n,0,e,n,0,0,-n,0,e,-n,0,e,n,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,0,.5,1,0,0,.5,0,.5,1,.5,1,.5,0,1,1,.5,0,1,0,1,1],2))),this.prevGeometry.setAttribute("left",new An([1,1,1,1,1,1,0,0,0,0,0,0],1)),this.nextMesh.geometry=new Ir(i,t,1,1),this.nextMesh.position.z=this.prevMesh.position.z-i/4}updateAnimation(i){this.preMaterial.uniforms.timePercent.value=i,this.nextMesh.position.z=this.prevMesh.position.z-(1-i)*(this.width/4)}dispose(){}}};class H1{constructor(){this.startTime=0,this.lastTime=0,this.lastFPSTime=0,this.renderingDuration=16,this.reverse=!1,this.scene=new mu,this.delay=0,this.easeFn=$p.linear,this.preset=null,this.onTransactionEnd=()=>{},this.isTransactionStartApplied=!1,this.prevTexture=null,this.nextTexture=null,this.animationId=null,this.config=null,this.renderer=new ti({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(t=-1)=>{var e,n,r;if(!this.fps(t))return void(this.animationId=window.requestAnimationFrame(this.animate));this.renderer.clear(),t>this.delay&&this.lastTime===0&&(this.lastTime=t,this.startTime=t);let o=0;this.lastTime>0&&o<1&&(o=this.easeFn(t-this.startTime,0,1,(n=(e=this.preset)===null||e===void 0?void 0:e.duration)!==null&&n!==void 0?n:0)),o>1&&(o=1),(r=this.preset)===null||r===void 0||r.updateAnimation(this.reverse?1-o:o),this.rerender(),this.isTransactionStartApplied||(this.isTransactionStartApplied=!0),o<1?this.animationId=window.requestAnimationFrame(this.animate):this.onTransactionEnd()}}initPlayer(t){this.config=t,this.reverse=t.reverse,t.delay&&Number.isInteger(t.delay)&&(this.delay=t.delay),t.easeFn&&(this.easeFn=$p[t.easeFn]),t.maxFPS&&Number.isInteger(t.maxFPS)&&t.maxFPS>0&&(this.renderingDuration=Math.ceil(1e3/t.maxFPS)),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1,this.renderer.setClearColor(t.clearColor||0),this.isTransactionStartApplied=!1,this.renderer.setSize(t.stageWidth,t.stageHeight),this.preset=new G1[t.presetType],t.options&&(this.preset.options=t.options),t.duration&&Number.isInteger(t.duration)&&(this.preset.duration=t.duration),this.preset.setSize(t.stageWidth,t.stageHeight)}setPrevTexture(t){var e,n,r,o;t.needsUpdate=!0,this.reverse?(this.nextTexture=t,(e=this.preset)===null||e===void 0||e.setNextTexture(t)):(this.prevTexture=t,(n=this.preset)===null||n===void 0||n.setPrevTexture(t)),(r=this.preset)===null||r===void 0||r.addObjects(this.scene),(o=this.preset)===null||o===void 0||o.updateAnimation(this.reverse?1:0),this.rerender()}setNextTexture(t){var e,n;t.needsUpdate=!0,this.reverse?(this.prevTexture=t,(e=this.preset)===null||e===void 0||e.setPrevTexture(t)):(this.nextTexture=t,(n=this.preset)===null||n===void 0||n.setNextTexture(t))}play(){return new Promise(t=>{this.onTransactionEnd=t,this.animate(),this.isPlaying=!0})}rerender(){var t;this.renderer.clear(),!((t=this.preset)===null||t===void 0)&&t.camera.camera&&this.renderer.render(this.scene,this.preset.camera.camera)}fps(t){return t<=0?!0:this.lastFPSTime<0?(this.lastFPSTime=t,!0):t-this.lastFPSTime>=this.renderingDuration&&(this.lastFPSTime=t,!0)}skip(){var t;(t=this.preset)===null||t===void 0||t.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var t,e,n;window.cancelAnimationFrame(this.animationId),this.renderer.clear(),this.isPlaying=!1,(t=this.preset)===null||t===void 0||t.dispose(),(e=this.prevTexture)===null||e===void 0||e.dispose(),(n=this.nextTexture)===null||n===void 0||n.dispose();for(let r=this.scene.children.length-1;r>=0;r--){const o=this.scene.children[r];this.scene.remove(o)}this.scene.background=null}destroy(){this.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose()}}v(139);var xn=v(3),Cn=v(5);Cn.c.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var nf=function(){function i(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(xn.isMobile.tablet||xn.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2 .toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(i.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),i.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2 .toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},i.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},i.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)===null||t===void 0||t.appendChild(this.div))},i.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)===null||t===void 0||t.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},i.prototype.update=function(){var t=performance.now();if(!(xn.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,r=e.top,o=e.width,s=e.height,a=this.renderer,l=a.width,h=a.height,u=a.resolution,p=o/l*u,_=s/h*u,x=this.div;x.style.left=n+"px",x.style.top=r+"px",x.style.width=l+"px",x.style.height=h+"px";for(var w=0;w<this.children.length;w++){var A=this.children[w];if(A.renderId!==this.renderId)A._accessibleActive=!1,Object(xn.removeItems)(this.children,w,1),this.div.removeChild(A._accessibleDiv),this.pool.push(A._accessibleDiv),A._accessibleDiv=null,w--;else{x=A._accessibleDiv;var C=A.hitArea,G=A.worldTransform;A.hitArea?(x.style.left=(G.tx+C.x*G.a)*p+"px",x.style.top=(G.ty+C.y*G.d)*_+"px",x.style.width=C.width*G.a*p+"px",x.style.height=C.height*G.d*_+"px"):(C=A.getBounds(),this.capHitArea(C),x.style.left=C.x*p+"px",x.style.top=C.y*_+"px",x.style.width=C.width*p+"px",x.style.height=C.height*_+"px",x.title!==A.accessibleTitle&&A.accessibleTitle!==null&&(x.title=A.accessibleTitle),x.getAttribute("aria-label")!==A.accessibleHint&&A.accessibleHint!==null&&x.setAttribute("aria-label",A.accessibleHint)),A.accessibleTitle===x.title&&A.tabIndex===x.tabIndex||(x.title=A.accessibleTitle,x.tabIndex=A.tabIndex,this.debug&&this.updateDebugHTML(x))}}this.renderId++}},i.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},i.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,r=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>r&&(t.height=r-t.y)},i.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2 .toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:t.accessibleHint&&t.accessibleHint!==null||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},i.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"click",r),e.dispatchEvent(n,"pointertap",r),e.dispatchEvent(n,"tap",r)},i.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseover",r)},i.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseout",r)},i.prototype._onKeyDown=function(t){t.keyCode===9&&this.activate()},i.prototype._onMouseMove=function(t){t.movementX===0&&t.movementY===0||this.deactivate()},i.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i}(),Oe=v(1),nr=v(7),rf=function(){function i(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Oe.g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(i.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),i.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},i.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},i.prototype.reset=function(){this.isPrimary=!1},i}(),of=function(i,t){return(of=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},j1=function(){function i(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return i.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},i.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},i}(),ku=function(){function i(t){this._pointerId=t,this._flags=i.FLAGS.NONE}return i.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(i.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"none",{get:function(){return this._flags===i.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"over",{get:function(){return(this._flags&i.FLAGS.OVER)!=0},set:function(t){this._doSet(i.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rightDown",{get:function(){return(this._flags&i.FLAGS.RIGHT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leftDown",{get:function(){return(this._flags&i.FLAGS.LEFT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),i}(),z1=function(){function i(){this._tempPoint=new Oe.g}return i.prototype.recursiveFindHit=function(t,e,n,r,o){if(!e||!e.visible)return!1;var s=t.data.global,a=!1,l=o=e.interactive||o,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(r=!1,h=!1)),l=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,p=u.length-1;p>=0;p--){var _=u[p],x=this.recursiveFindHit(t,_,n,r,l);if(x){if(!_.parent)continue;l=!1,x&&(t.target&&(r=!1),a=!0)}}return o&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),n&&n(t,e,!!a))),a},i.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},i}(),V1={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(i){i?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Cn.c.mixin(V1);var zl={target:null,data:{global:null}},sf=function(i){function t(e,n){var r=i.call(this)||this;return n=n||{},r.renderer=e,r.autoPreventDefault=n.autoPreventDefault===void 0||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new rf,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new j1,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new z1,r._tempDisplayObject=new Cn.d,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=n.useSystemTicker===void 0||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(e,n){function r(){this.constructor=e}of(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,n){return zl.target=null,zl.data.global=e,n||(n=this.lastObjectRendered),this.processInteractive(zl,n,null,!0),zl.target},t.prototype.setTargetElement=function(e,n){n===void 0&&(n=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=n,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(nr.a.system.add(this.tickerUpdate,this,nr.c.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(nr.a.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var n=this.activeInteractionData[e];if(n.originalEvent&&n.pointerType!=="touch"){var r=this.configureInteractionEventForDOMEvent(this.eventData,n.originalEvent,n);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var n=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(n=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var r=this.cursorStyles[e];if(r)switch(typeof r){case"string":n&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(e);break;case"object":n&&Object.assign(this.interactionDOMElement.style,r)}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,n,r){r.stopPropagationHint&&e!==r.stopsPropagatingAt||(r.currentTarget=e,r.type=n,e.emit(n,r),e[n]&&e[n](r))},t.prototype.delayDispatchEvent=function(e,n,r){this.delayedEvents.push({displayObject:e,eventString:n,eventData:r})},t.prototype.mapPositionToPoint=function(e,n,r){var o;o=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var s=1/this.resolution;e.x=(n-o.left)*(this.interactionDOMElement.width/o.width)*s,e.y=(r-o.top)*(this.interactionDOMElement.height/o.height)*s},t.prototype.processInteractive=function(e,n,r,o){var s=this.search.findHit(e,n,r,o),a=this.delayedEvents;if(!a.length)return s;e.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var h=0;h<l;h++){var u=a[h],p=u.displayObject,_=u.eventString,x=u.eventData;x.stopsPropagatingAt===p&&(x.stopPropagationHint=!0),this.dispatchEvent(p,_,x)}return s},t.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);if(l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",l),s.pointerType==="touch")this.emit("touchstart",l);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var h=s.button===2;this.emit(h?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,n,r){var o=e.data,s=e.data.identifier;if(r){if(n.trackedPointers[s]||(n.trackedPointers[s]=new ku(s)),this.dispatchEvent(n,"pointerdown",e),o.pointerType==="touch")this.dispatchEvent(n,"touchstart",e);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var a=o.button===2;a?n.trackedPointers[s].rightDown=!0:n.trackedPointers[s].leftDown=!0,this.dispatchEvent(n,a?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,n,r){for(var o=this.normalizeToPointerData(e),s=o.length,a=e.target!==this.interactionDOMElement?"outside":"",l=0;l<s;l++){var h=o[l],u=this.getInteractionDataForPointerId(h),p=this.configureInteractionEventForDOMEvent(this.eventData,h,u);if(p.data.originalEvent=e,this.processInteractive(p,this.lastObjectRendered,r,n||!a),this.emit(n?"pointercancel":"pointerup"+a,p),h.pointerType==="mouse"||h.pointerType==="pen"){var _=h.button===2;this.emit(_?"rightup"+a:"mouseup"+a,p)}else h.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+a,p),this.releaseInteractionDataForPointerId(h.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,n){var r=e.data,o=e.data.identifier;n.trackedPointers[o]!==void 0&&(delete n.trackedPointers[o],this.dispatchEvent(n,"pointercancel",e),r.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,n,r){var o=e.data,s=e.data.identifier,a=n.trackedPointers[s],l=o.pointerType==="touch",h=o.pointerType==="mouse"||o.pointerType==="pen",u=!1;if(h){var p=o.button===2,_=ku.FLAGS,x=p?_.RIGHT_DOWN:_.LEFT_DOWN,w=a!==void 0&&a.flags&x;r?(this.dispatchEvent(n,p?"rightup":"mouseup",e),w&&(this.dispatchEvent(n,p?"rightclick":"click",e),u=!0)):w&&this.dispatchEvent(n,p?"rightupoutside":"mouseupoutside",e),a&&(p?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(n,"pointerup",e),l&&this.dispatchEvent(n,"touchend",e),a&&(h&&!u||this.dispatchEvent(n,"pointertap",e),l&&(this.dispatchEvent(n,"tap",e),a.over=!1))):a&&(this.dispatchEvent(n,"pointerupoutside",e),l&&this.dispatchEvent(n,"touchendoutside",e)),a&&a.none&&delete n.trackedPointers[s]},t.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);n[0].pointerType!=="mouse"&&n[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),s.pointerType==="touch"&&this.emit("touchmove",l),s.pointerType!=="mouse"&&s.pointerType!=="pen"||this.emit("mousemove",l)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,n,r){var o=e.data,s=o.pointerType==="touch",a=o.pointerType==="mouse"||o.pointerType==="pen";a&&this.processPointerOverOut(e,n,r),this.moveWhenInside&&!r||(this.dispatchEvent(n,"pointermove",e),s&&this.dispatchEvent(n,"touchmove",e),a&&this.dispatchEvent(n,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e)[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(r.identifier)}},t.prototype.processPointerOverOut=function(e,n,r){var o=e.data,s=e.data.identifier,a=o.pointerType==="mouse"||o.pointerType==="pen",l=n.trackedPointers[s];r&&!l&&(l=n.trackedPointers[s]=new ku(s)),l!==void 0&&(r&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(n,"pointerover",e),a&&this.delayDispatchEvent(n,"mouseover",e)),a&&this.cursor===null&&(this.cursor=n.cursor)):l.over&&(l.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),a&&this.dispatchEvent(n,"mouseout",e),l.none&&delete n.trackedPointers[s]))},t.prototype.onPointerOver=function(e){var n=this.normalizeToPointerData(e)[0],r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),n.pointerType!=="mouse"&&n.pointerType!=="pen"||this.emit("mouseover",o)},t.prototype.getInteractionDataForPointerId=function(e){var n,r=e.pointerId;return r===1||e.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[r]?n=this.activeInteractionData[r]:((n=this.interactionDataPool.pop()||new rf).identifier=r,this.activeInteractionData[r]=n),n.copyEvent(e),n},t.prototype.releaseInteractionDataForPointerId=function(e){var n=this.activeInteractionData[e];n&&(delete this.activeInteractionData[e],n.reset(),this.interactionDataPool.push(n))},t.prototype.configureInteractionEventForDOMEvent=function(e,n,r){return e.data=r,this.mapPositionToPoint(r.global,n.clientX,n.clientY),n.pointerType==="touch"&&(n.globalX=r.global.x,n.globalY=r.global.y),r.originalEvent=n,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,o=e.changedTouches.length;r<o;r++){var s=e.changedTouches[r];s.button===void 0&&(s.button=e.touches.length?1:0),s.buttons===void 0&&(s.buttons=e.touches.length?1:0),s.isPrimary===void 0&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),s.width===void 0&&(s.width=s.radiusX||1),s.height===void 0&&(s.height=s.radiusY||1),s.tiltX===void 0&&(s.tiltX=0),s.tiltY===void 0&&(s.tiltY=0),s.pointerType===void 0&&(s.pointerType="touch"),s.pointerId===void 0&&(s.pointerId=s.identifier||0),s.pressure===void 0&&(s.pressure=s.force||.5),s.twist===void 0&&(s.twist=0),s.tangentialPressure===void 0&&(s.tangentialPressure=0),s.layerX===void 0&&(s.layerX=s.offsetX=s.clientX),s.layerY===void 0&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,n.push(s)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))n.push(e);else{var a=e;a.isPrimary===void 0&&(a.isPrimary=!0),a.width===void 0&&(a.width=1),a.height===void 0&&(a.height=1),a.tiltX===void 0&&(a.tiltX=0),a.tiltY===void 0&&(a.tiltY=0),a.pointerType===void 0&&(a.pointerType="mouse"),a.pointerId===void 0&&(a.pointerId=1),a.pressure===void 0&&(a.pressure=.5),a.twist===void 0&&(a.twist=0),a.tangentialPressure===void 0&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}return n},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(xn.EventEmitter),ue=v(2),Vl=function(){function i(t){var e=this;this.stage=new Cn.b,t=Object.assign({forceCanvas:!1},t),this.renderer=Object(ue.y)(t),i._plugins.forEach(function(n){n.init.call(e,t)})}return i.registerPlugin=function(t){i._plugins.push(t)},i.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(i.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),i.prototype.destroy=function(t,e){var n=this,r=i._plugins.slice(0);r.reverse(),r.forEach(function(o){o.destroy.call(n)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},i._plugins=[],i}(),W1=function(){function i(){}return i.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var n,r;if(e.cancelResize(),e._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{var o=e._resizeTo;n=o.clientWidth,r=o.clientHeight}e.renderer.resize(n,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},i.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},i}();Vl.registerPlugin(W1);/*!
 * @pixi/extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Uu=/iPhone/i,af=/iPod/i,lf=/iPad/i,hf=/\biOS-universal(?:.+)Mac\b/i,Gu=/\bAndroid(?:.+)Mobile\b/i,uf=/Android/i,Us=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Wl=/Silk/i,uo=/Windows Phone/i,cf=/\bWindows(?:.+)ARM\b/i,df=/BlackBerry/i,pf=/BB10/i,ff=/Opera Mini/i,mf=/\b(CriOS|Chrome)(?:.+)Mobile/i,gf=/Mobile(?:.+)Firefox\b/i,vf=function(i){return i!==void 0&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var _f,yf,xf,bf,Tf,wf,Sf,Ef,Af,Hu,ju,zu,Mf,Cf,Vu,Na,Rf,Wu,If,Gs=function(i){var t={userAgent:"",platform:"",maxTouchPoints:0};i||typeof navigator=="undefined"?typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=t.userAgent,n=e.split("[FBAN");n[1]!==void 0&&(e=n[0]),(n=e.split("Twitter"))[1]!==void 0&&(e=n[0]);var r=function(s){return function(a){return a.test(s)}}(e),o={apple:{phone:r(Uu)&&!r(uo),ipod:r(af),tablet:!r(Uu)&&(r(lf)||vf(t))&&!r(uo),universal:r(hf),device:(r(Uu)||r(af)||r(lf)||r(hf)||vf(t))&&!r(uo)},amazon:{phone:r(Us),tablet:!r(Us)&&r(Wl),device:r(Us)||r(Wl)},android:{phone:!r(uo)&&r(Us)||!r(uo)&&r(Gu),tablet:!r(uo)&&!r(Us)&&!r(Gu)&&(r(Wl)||r(uf)),device:!r(uo)&&(r(Us)||r(Wl)||r(Gu)||r(uf))||r(/\bokhttp\b/i)},windows:{phone:r(uo),tablet:r(cf),device:r(uo)||r(cf)},other:{blackberry:r(df),blackberry10:r(pf),opera:r(ff),firefox:r(gf),chrome:r(mf),device:r(df)||r(pf)||r(ff)||r(gf)||r(mf)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(globalThis.navigator);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(_f||(_f={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(yf||(yf={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(xf||(xf={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(bf||(bf={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Tf||(Tf={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(wf||(wf={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Sf||(Sf={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(Ef||(Ef={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Af||(Af={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Hu||(Hu={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ju||(ju={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(zu||(zu={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Mf||(Mf={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Cf||(Cf={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Vu||(Vu={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Na||(Na={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Rf||(Rf={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Wu||(Wu={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(If||(If={}));var X1={MIPMAP_TEXTURES:zu.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Wu.NONE,SPRITE_MAX_TEXTURES:function(i){var t=!0;if(Gs.tablet||Gs.phone){var e;Gs.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(t=!1),Gs.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(t=!1)}return t?i:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Vu.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:ju.CLAMP,SCALE_MODE:Hu.LINEAR,PRECISION_VERTEX:Na.HIGH,PRECISION_FRAGMENT:Gs.apple.device?Na.HIGH:Na.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Gs.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,SORTABLE_CHILDREN:!1},Pf=function(){function i(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return i.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},i.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},i.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Oe.j.EMPTY:((t=t||new Oe.j(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},i.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},i.prototype.addPointMatrix=function(t,e){var n=t.a,r=t.b,o=t.c,s=t.d,a=t.tx,l=t.ty,h=n*e.x+o*e.y+a,u=r*e.x+s*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},i.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY,s=t[0],a=t[1];e=s<e?s:e,n=a<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[2])<e?s:e,n=(a=t[3])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[4])<e?s:e,n=(a=t[5])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[6])<e?s:e,n=(a=t[7])<n?a:n,r=s>r?s:r,o=a>o?a:o,this.minX=e,this.minY=n,this.maxX=r,this.maxY=o},i.prototype.addFrame=function(t,e,n,r,o){this.addFrameMatrix(t.worldTransform,e,n,r,o)},i.prototype.addFrameMatrix=function(t,e,n,r,o){var s=t.a,a=t.b,l=t.c,h=t.d,u=t.tx,p=t.ty,_=this.minX,x=this.minY,w=this.maxX,A=this.maxY,C=s*e+l*n+u,G=a*e+h*n+p;_=C<_?C:_,x=G<x?G:x,w=C>w?C:w,A=G>A?G:A,_=(C=s*r+l*n+u)<_?C:_,x=(G=a*r+h*n+p)<x?G:x,w=C>w?C:w,A=G>A?G:A,_=(C=s*e+l*o+u)<_?C:_,x=(G=a*e+h*o+p)<x?G:x,w=C>w?C:w,A=G>A?G:A,_=(C=s*r+l*o+u)<_?C:_,x=(G=a*r+h*o+p)<x?G:x,w=C>w?C:w,A=G>A?G:A,this.minX=_,this.minY=x,this.maxX=w,this.maxY=A},i.prototype.addVertexData=function(t,e,n){for(var r=this.minX,o=this.minY,s=this.maxX,a=this.maxY,l=e;l<n;l+=2){var h=t[l],u=t[l+1];r=h<r?h:r,o=u<o?u:o,s=h>s?h:s,a=u>a?u:a}this.minX=r,this.minY=o,this.maxX=s,this.maxY=a},i.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},i.prototype.addVerticesMatrix=function(t,e,n,r,o,s){o===void 0&&(o=0),s===void 0&&(s=o);for(var a=t.a,l=t.b,h=t.c,u=t.d,p=t.tx,_=t.ty,x=this.minX,w=this.minY,A=this.maxX,C=this.maxY,G=n;G<r;G+=2){var K=e[G],it=e[G+1],ft=a*K+h*it+p,nt=u*it+l*K+_;x=Math.min(x,ft-o),A=Math.max(A,ft+o),w=Math.min(w,nt-s),C=Math.max(C,nt+s)}this.minX=x,this.minY=w,this.maxX=A,this.maxY=C},i.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>o?t.maxY:o},i.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},i.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},i.prototype.addFramePad=function(t,e,n,r,o,s){t-=o,e-=s,n+=o,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},i}(),Of=function(i,t){return(Of=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Xu(i,t){function e(){this.constructor=i}Of(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Lf,Nf,Df,Ff,Bf,kf,Uf,Gf,Hf,jf,zf,Vf,Wf,Xf,Yf,qf,Yu,Jf,Zf,Da=function(i){function t(){var e=i.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Oe.m,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Pf,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return Xu(t,i),t.mixin=function(e){for(var n=Object.keys(e),r=0;r<n.length;++r){var o=n[r];Object.defineProperty(t.prototype,o,Object.getOwnPropertyDescriptor(e,o))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new Oe.j),n=this._boundsRect),this._bounds.getRectangle(n)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new Oe.j),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Pf);var n=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var o=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=o,this._bounds.updateID+=this._boundsID-s,a},t.prototype.toGlobal=function(e,n,r){return r===void 0&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)},t.prototype.toLocal=function(e,n,r,o){return n&&(e=n.toGlobal(e,r,o)),o||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,n,r,o,s,a,l,h,u){return e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=1),s===void 0&&(s=0),a===void 0&&(a=0),l===void 0&&(l=0),h===void 0&&(h=0),u===void 0&&(u=0),this.position.x=e,this.position.y=n,this.scale.x=r||1,this.scale.y=o||1,this.rotation=s,this.skew.x=a,this.skew.y=l,this.pivot.x=h,this.pivot.y=u,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Y1),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*Oe.i},set:function(e){this.transform.rotation=e*Oe.b},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){var n;this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount--,n._maskRefCount===0&&(n.renderable=!0,n.isMask=!1)),this._mask=e,this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount===0&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}},enumerable:!1,configurable:!0}),t}(xn.EventEmitter),Y1=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.sortDirty=null,e}return Xu(t,i),t}(Da);function q1(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}Da.prototype.displayObjectUpdateTransform=Da.prototype.updateTransform,function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"}(Lf||(Lf={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(Nf||(Nf={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(Df||(Df={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Ff||(Ff={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Bf||(Bf={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(kf||(kf={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Uf||(Uf={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(Gf||(Gf={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Hf||(Hf={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(jf||(jf={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(zf||(zf={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(Vf||(Vf={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Wf||(Wf={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Xf||(Xf={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Yf||(Yf={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(qf||(qf={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Yu||(Yu={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Jf||(Jf={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Zf||(Zf={}));var Kf=function(i){function t(){var e=i.call(this)||this;return e.children=[],e.sortableChildren=X1.SORTABLE_CHILDREN,e.sortDirty=!1,e}return Xu(t,i),t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.addChild(n[o]);else{var s=n[0];s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.push(s),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this)}return n[0]},t.prototype.addChildAt=function(e,n){if(n<0||n>this.children.length)throw new Error(e+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),this.emit("childAdded",e,this,n),e},t.prototype.swapChildren=function(e,n){if(e!==n){var r=this.getChildIndex(e),o=this.getChildIndex(n);this.children[r]=n,this.children[o]=e,this.onChildrenChange(r<o?r:o)}},t.prototype.getChildIndex=function(e){var n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},t.prototype.setChildIndex=function(e,n){if(n<0||n>=this.children.length)throw new Error("The index "+n+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(e);Object(xn.removeItems)(this.children,r,1),this.children.splice(n,0,e),this.onChildrenChange(n)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.removeChild(n[o]);else{var s=n[0],a=this.children.indexOf(s);if(a===-1)return null;s.parent=null,s.transform._parentID=-1,Object(xn.removeItems)(this.children,a,1),this._boundsID++,this.onChildrenChange(a),s.emit("removed",this),this.emit("childRemoved",s,this,a)}return n[0]},t.prototype.removeChildAt=function(e){var n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,Object(xn.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),this.emit("childRemoved",n,this,e),n},t.prototype.removeChildren=function(e,n){e===void 0&&(e=0),n===void 0&&(n=this.children.length);var r,o=e,s=n-o;if(s>0&&s<=n){r=this.children.splice(o,s);for(var a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,n=0,r=this.children.length;n<r;++n){var o=this.children[n];o._lastSortedIndex=n,e||o.zIndex===0||(e=!0)}e&&this.children.length>1&&this.children.sort(q1),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,n=this.children.length;e<n;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.visible&&n.renderable)if(n.calculateBounds(),n._mask){var r=n._mask.maskObject||n._mask;r.calculateBounds(),this._bounds.addBoundsMask(n._bounds,r._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,n){n===void 0&&(n=!1);var r=i.prototype.getLocalBounds.call(this,e);if(!n)for(var o=0,s=this.children.length;o<s;++o){var a=this.children[o];a.visible&&a.updateTransform()}return r},t.prototype._calculateBounds=function(){},t.prototype._renderWithCulling=function(e){var n=e.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var r,o;if(this.cullArea?(r=this.cullArea,o=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0)),r&&n.intersects(r,o))this._render(e);else if(this.cullArea)return;for(var s=0,a=this.children.length;s<a;++s){var l=this.children[s],h=l.cullable;l.cullable=h||!this.cullArea,l.render(e),l.cullable=h}}},t.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var n=0,r=this.children.length;n<r;++n)this.children[n].render(e)}},t.prototype.renderAdvanced=function(e){var n=this.filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var o=0;o<n.length;o++)n[o].enabled&&this._enabledFilters.push(n[o])}var s=n&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Yu.NONE));if(s&&e.batch.flush(),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e),o=0;for(var a=this.children.length;o<a;++o)this.children[o].render(e)}s&&e.batch.flush(),r&&e.mask.pop(this),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){i.prototype.destroy.call(this),this.sortDirty=!1;var n=typeof e=="boolean"?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(n)for(var o=0;o<r.length;++o)r[o].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var n=this.getLocalBounds().width;this.scale.x=n!==0?e/n:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var n=this.getLocalBounds().height;this.scale.y=n!==0?e/n:1,this._height=e},enumerable:!1,configurable:!0}),t}(Da);Kf.prototype.containerUpdateTransform=Kf.prototype.updateTransform;var qu=new Oe.j,J1=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o=this.renderer,s=!1,a=!1;t&&(t instanceof ue.p?r=t:(r=this.renderer.generateTexture(t),a=!0)),r?(e=r.baseTexture.resolution,n=r.frame,s=!1,o.renderTexture.bind(r)):(e=this.renderer.resolution,s=!0,(n=qu).width=this.renderer.width,n.height=this.renderer.height,o.renderTexture.bind(null));var l=Math.floor(n.width*e+1e-4),h=Math.floor(n.height*e+1e-4),u=new xn.CanvasRenderTarget(l,h,1),p=new Uint8Array(4*l*h),_=o.gl;_.readPixels(n.x*e,n.y*e,l,h,_.RGBA,_.UNSIGNED_BYTE,p);var x=u.context.getImageData(0,0,l,h);if(i.arrayPostDivide(p,x.data),u.context.putImageData(x,0,0),s){var w=new xn.CanvasRenderTarget(u.width,u.height,1);w.context.scale(1,-1),w.context.drawImage(u.canvas,0,-h),u.destroy(),u=w}return a&&r.destroy(!0),u.canvas},i.prototype.pixels=function(t,e){var n,r,o,s=this.renderer,a=!1;t&&(t instanceof ue.p?o=t:t instanceof Da&&(o=this.renderer.generateTexture(t),a=!0)),o?e?(n=e.resolution,r=o.frame,s.renderTexture.bind(o)):(n=o.baseTexture.resolution,r=o.frame,s.renderTexture.bind(o)):e?(n=e.resolution,(r=qu).width=e.width,r.height=e.height,s.renderTexture.bind(null)):(n=s.resolution,(r=qu).width=s.width,r.height=s.height,s.renderTexture.bind(null));var l=r.width*n,h=r.height*n,u=new Uint8Array(4*l*h),p=s.gl;return p.readPixels(r.x*n,r.y*n,l,h,p.RGBA,p.UNSIGNED_BYTE,u),a&&o.destroy(!0),i.arrayPostDivide(u,u),u},i.prototype.destroy=function(){this.renderer=null},i.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},i}(),Xl=function(){function i(t,e,n){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return i.prototype.detach=function(){return this._owner!==null&&(this._owner.detach(this),!0)},i}();function $f(i,t){return i._head?(i._tail._next=t,t._prev=i._tail,i._tail=t):(i._head=t,i._tail=t),t._owner=i,t}var Ju,co=function(){function i(){this._head=this._tail=void 0}return i.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},i.prototype.has=function(t){if(!(t instanceof Xl))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},i.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},i.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return $f(this,new Xl(t,!1,e))},i.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return $f(this,new Xl(t,!0,e))},i.prototype.detach=function(t){if(!(t instanceof Xl))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},i.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},i}();function Qf(i,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=e.parser[t.strictMode?"strict":"loose"].exec(i),r={},o=14;o--;)r[e.key[o]]=n[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(s,a,l){a&&(r[e.q.name][a]=l)}),r}var Yl=null;function tm(){}function em(i,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(i[t]=e)}function Zu(i){return i.toString().replace("object ","")}var Mi=function(){function i(t,e,n){if(this._dequeue=tm,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(i.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=i.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=tm,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new co,this.onProgress=new co,this.onComplete=new co,this.onAfterMiddleware=new co}return i.setExtensionLoadType=function(t,e){em(i._loadTypeMap,t,e)},i.setExtensionXhrType=function(t,e){em(i._xhrTypeMap,t,e)},Object.defineProperty(i.prototype,"isDataUrl",{get:function(){return this._hasFlag(i.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this._hasFlag(i.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isLoading",{get:function(){return this._hasFlag(i.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),i.prototype.complete=function(){this._clearEvents(),this._finish()},i.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=i.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},i.prototype.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(i.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case i.LOAD_TYPE.IMAGE:this.type=i.TYPE.IMAGE,this._loadElement("image");break;case i.LOAD_TYPE.AUDIO:this.type=i.TYPE.AUDIO,this._loadSourceElement("audio");break;case i.LOAD_TYPE.VIDEO:this.type=i.TYPE.VIDEO,this._loadSourceElement("video");break;case i.LOAD_TYPE.XHR:default:Ju===void 0&&(Ju=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),Ju&&this.crossOrigin?this._loadXdr():this._loadXhr()}},i.prototype._hasFlag=function(t){return(this._flags&t)!=0},i.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},i.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},i.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(i.STATUS_FLAGS.COMPLETE,!0),this._setFlag(i.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},i.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&globalThis.Image!==void 0?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},i.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&globalThis.Audio!==void 0?this.data=new Audio:this.data=document.createElement(t),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else e=this.metadata.mimeType,this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},i.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(t.withCredentials=!0),t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===i.XHR_RESPONSE_TYPE.JSON||this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=i.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},i.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},i.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},i.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},i.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},i.prototype._onTimeout=function(){this.abort("Load timed out.")},i.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Zu(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},i.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Zu(t)+" Request timed out.")},i.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Zu(t)+" Request was aborted by the user.")},i.prototype._xhrOnLoad=function(){var t=this.xhr,e="",n=t.status===void 0?200:t.status;if(t.responseType!==""&&t.responseType!=="text"&&t.responseType!==void 0||(e=t.responseText),n===0&&(e.length>0||t.responseType===i.XHR_RESPONSE_TYPE.BUFFER)?n=200:n===1223&&(n=204),(n/100|0)===2){if(this.xhrType===i.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=i.TYPE.TEXT;else if(this.xhrType===i.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=i.TYPE.JSON}catch(s){return void this.abort("Error trying to parse loaded json: "+s)}else if(this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e,this.data=o}this.type=i.TYPE.XML}catch(s){return void this.abort("Error trying to parse loaded xml: "+s)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},i.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Yl||(Yl=document.createElement("a")),Yl.href=t;var n=Qf(Yl.href,{strictMode:!0}),r=!n.port&&e.port===""||n.port===e.port,o=n.protocol?n.protocol+":":"";return n.host===e.hostname&&r&&o===e.protocol?"":"anonymous"},i.prototype._determineXhrType=function(){return i._xhrTypeMap[this.extension]||i.XHR_RESPONSE_TYPE.TEXT},i.prototype._determineLoadType=function(){return i._loadTypeMap[this.extension]||i.LOAD_TYPE.XHR},i.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),o=t.indexOf("#"),s=Math.min(r>-1?r:t.length,o>-1?o:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},i.prototype._getMimeFromXhrType=function(t){switch(t){case i.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case i.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case i.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case i.XHR_RESPONSE_TYPE.JSON:return"application/json";case i.XHR_RESPONSE_TYPE.DEFAULT:case i.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i}();function hs(){}function Z1(i){return function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(i===null)throw new Error("Callback was already called.");var r=i;i=null,r.apply(this,e)}}(function(i){var t,e,n,r;(t=i.STATUS_FLAGS||(i.STATUS_FLAGS={}))[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING",(e=i.TYPE||(i.TYPE={}))[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT",(n=i.LOAD_TYPE||(i.LOAD_TYPE={}))[n.XHR=1]="XHR",n[n.IMAGE=2]="IMAGE",n[n.AUDIO=3]="AUDIO",n[n.VIDEO=4]="VIDEO",(r=i.XHR_RESPONSE_TYPE||(i.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",i._loadTypeMap={gif:i.LOAD_TYPE.IMAGE,png:i.LOAD_TYPE.IMAGE,bmp:i.LOAD_TYPE.IMAGE,jpg:i.LOAD_TYPE.IMAGE,jpeg:i.LOAD_TYPE.IMAGE,tif:i.LOAD_TYPE.IMAGE,tiff:i.LOAD_TYPE.IMAGE,webp:i.LOAD_TYPE.IMAGE,tga:i.LOAD_TYPE.IMAGE,svg:i.LOAD_TYPE.IMAGE,"svg+xml":i.LOAD_TYPE.IMAGE,mp3:i.LOAD_TYPE.AUDIO,ogg:i.LOAD_TYPE.AUDIO,wav:i.LOAD_TYPE.AUDIO,mp4:i.LOAD_TYPE.VIDEO,webm:i.LOAD_TYPE.VIDEO},i._xhrTypeMap={xhtml:i.XHR_RESPONSE_TYPE.DOCUMENT,html:i.XHR_RESPONSE_TYPE.DOCUMENT,htm:i.XHR_RESPONSE_TYPE.DOCUMENT,xml:i.XHR_RESPONSE_TYPE.DOCUMENT,tmx:i.XHR_RESPONSE_TYPE.DOCUMENT,svg:i.XHR_RESPONSE_TYPE.DOCUMENT,tsx:i.XHR_RESPONSE_TYPE.DOCUMENT,gif:i.XHR_RESPONSE_TYPE.BLOB,png:i.XHR_RESPONSE_TYPE.BLOB,bmp:i.XHR_RESPONSE_TYPE.BLOB,jpg:i.XHR_RESPONSE_TYPE.BLOB,jpeg:i.XHR_RESPONSE_TYPE.BLOB,tif:i.XHR_RESPONSE_TYPE.BLOB,tiff:i.XHR_RESPONSE_TYPE.BLOB,webp:i.XHR_RESPONSE_TYPE.BLOB,tga:i.XHR_RESPONSE_TYPE.BLOB,json:i.XHR_RESPONSE_TYPE.JSON,text:i.XHR_RESPONSE_TYPE.TEXT,txt:i.XHR_RESPONSE_TYPE.TEXT,ttf:i.XHR_RESPONSE_TYPE.BUFFER,otf:i.XHR_RESPONSE_TYPE.BUFFER},i.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(Mi||(Mi={}));var K1=function(i,t){this.data=i,this.callback=t},Ku=function(){function i(t,e){var n=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=hs,this.unsaturated=hs,this.empty=hs,this.drain=hs,this.error=hs,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(r,o,s){if(s&&typeof s!="function")throw new Error("task callback must be a function");if(n.started=!0,r==null&&n.idle())setTimeout(function(){return n.drain()},1);else{var a=new K1(r,typeof s=="function"?s:hs);o?n._tasks.unshift(a):n._tasks.push(a),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var r=n._tasks.shift();n._tasks.length===0&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(r.data,Z1(n._next(r)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return i.prototype._next=function(t){var e=this;return function(){for(var n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];e.workers-=1,t.callback.apply(t,r),r[0]!=null&&e.error(r[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},i.prototype.push=function(t,e){this._insert(t,!1,e)},i.prototype.kill=function(){this.workers=0,this.drain=hs,this.started=!1,this._tasks=[]},i.prototype.unshift=function(t,e){this._insert(t,!0,e)},i.prototype.length=function(){return this._tasks.length},i.prototype.running=function(){return this.workers},i.prototype.idle=function(){return this._tasks.length+this.workers===0},i.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},i.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},i.eachSeries=function(t,e,n,r){var o=0,s=t.length;(function a(l){l||o===s?n&&n(l):r?setTimeout(function(){e(t[o++],a)},1):e(t[o++],a)})()},i.queue=function(t,e){return new i(t,e)},i}(),$1=/(#[\w-]+)?$/,Zr=function(){function i(t,e){var n=this;t===void 0&&(t=""),e===void 0&&(e=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this._queue=Ku.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new co,this.onError=new co,this.onLoad=new co,this.onStart=new co,this.onComplete=new co;for(var r=0;r<i._plugins.length;++r){var o=i._plugins[r],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this._protected=!1}return i.prototype._add=function(t,e,n,r){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Mi(t,e,n),typeof r=="function"&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var l=o.progressChunk*(s.length+1)/(s.length+2);for(o.children.push(this.resources[t]),o.progressChunk=l,a=0;a<s.length;++a)s[a].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},i.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},i.prototype.use=function(t){return this._afterMiddleware.push(t),this},i.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},i.prototype.load=function(t){if(typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(i.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),i.prototype._prepareUrl=function(t){var e,n=Qf(t,{strictMode:!0});if(e=n.protocol||!n.path||t.indexOf("//")===0?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=$1.exec(e)[0];(e=e.slice(0,e.length-r.length)).indexOf("?")!==-1?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},i.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,Ku.eachSeries(this._beforeMiddleware,function(r,o){r.call(n,t,function(){o(t.isComplete?{}:null)})},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())},!0)},i.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},i.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},i.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Ku.eachSeries(this._afterMiddleware,function(n,r){n.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},i.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(i,"shared",{get:function(){var t=i._shared;return t||((t=new i)._protected=!0,i._shared=t),t},enumerable:!1,configurable:!0}),i.registerPlugin=function(t){return i._plugins.push(t),t.add&&t.add(),i},i._plugins=[],i}();Zr.prototype.add=function(i,t,e,n){if(Array.isArray(i)){for(var r=0;r<i.length;++r)this.add(i[r]);return this}if(typeof i=="object"&&(e=i,n=t||e.callback||e.onComplete,t=e.url,i=e.name||e.key||e.url),typeof t!="string"&&(n=e,e=t,t=i),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof e=="function"&&(n=e,e=null),this._add(i,t,e,n)};var Q1=function(){function i(){}return i.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Zr.shared:new Zr},i.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},i}(),tb=function(){function i(){}return i.add=function(){Mi.setExtensionLoadType("svg",Mi.LOAD_TYPE.XHR),Mi.setExtensionXhrType("svg",Mi.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){if(!t.data||t.type!==Mi.TYPE.IMAGE&&t.extension!=="svg")e();else{var n=t.data,r=t.url,o=t.name,s=t.metadata;ue.t.fromLoader(n,r,o,s).then(function(a){t.texture=a,e()}).catch(e)}},i}();Zr.registerPlugin({use:function(i,t){if(i.data){if(i.xhr&&i.xhrType===Mi.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&typeof i.data!="string"){if(i.data.type.indexOf("image")===0){var e=globalThis.URL||globalThis.webkitURL,n=e.createObjectURL(i.data);return i.blob=i.data,i.data=new Image,i.data.src=n,i.type=Mi.TYPE.IMAGE,void(i.data.onload=function(){e.revokeObjectURL(n),i.data.onload=null,t()})}}else{var r=i.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0)return i.data=new Image,i.data.src="data:"+r+";base64,"+function(o){for(var s="",a=0;a<o.length;){for(var l=[0,0,0],h=[0,0,0,0],u=0;u<l.length;++u)a<o.length?l[u]=255&o.charCodeAt(a++):l[u]=0;switch(h[0]=l[0]>>2,h[1]=(3&l[0])<<4|l[1]>>4,h[2]=(15&l[1])<<2|l[2]>>6,h[3]=63&l[2],a-(o.length-1)){case 2:h[3]=64,h[2]=64;break;case 1:h[3]=64}for(u=0;u<h.length;++u)s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h[u])}return s}(i.xhr.responseText),i.type=Mi.TYPE.IMAGE,void(i.data.onload=function(){i.data.onload=null,t()})}t()}else t()}}),Zr.registerPlugin(tb);var oi,Ln,gn=v(0);/*!
 * @pixi/compressed-textures - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(i){i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(Ln||(Ln={}));var ql=((oi={})[Ln.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,oi[Ln.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,oi[Ln.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,oi[Ln.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,oi[Ln.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,oi[Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,oi[Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,oi[Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,oi[Ln.COMPRESSED_R11_EAC]=.5,oi[Ln.COMPRESSED_SIGNED_R11_EAC]=.5,oi[Ln.COMPRESSED_RG11_EAC]=1,oi[Ln.COMPRESSED_SIGNED_RG11_EAC]=1,oi[Ln.COMPRESSED_RGB8_ETC2]=.5,oi[Ln.COMPRESSED_RGBA8_ETC2_EAC]=1,oi[Ln.COMPRESSED_SRGB8_ETC2]=.5,oi[Ln.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,oi[Ln.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,oi[Ln.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,oi[Ln.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,oi[Ln.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,oi[Ln.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,oi[Ln.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,oi[Ln.COMPRESSED_RGB_ETC1_WEBGL]=.5,oi[Ln.COMPRESSED_RGB_ATC_WEBGL]=.5,oi[Ln.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,oi[Ln.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,oi),nm=function(i,t){return(nm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function im(i,t){function e(){this.constructor=i}nm(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function eb(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}}var Jl,Kr,$u=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.format=n.format,r.levels=n.levels||1,r._width=n.width,r._height=n.height,r._extension=t._formatToExtension(r.format),(n.levelBuffers||r.buffer)&&(r._levelBuffers=n.levelBuffers||t._createLevelBuffers(e instanceof Uint8Array?e:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return im(t,i),t.prototype.upload=function(e,n,r){var o=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var s=0,a=this.levels;s<a;s++){var l=this._levelBuffers[s],h=l.levelID,u=l.levelWidth,p=l.levelHeight,_=l.levelBuffer;o.compressedTexImage2D(o.TEXTURE_2D,h,this.format,u,p,0,_)}return!0},t.prototype.onBlobLoaded=function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},t._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},t._createLevelBuffers=function(e,n,r,o,s,a,l){for(var h=new Array(r),u=e.byteOffset,p=a,_=l,x=p+o-1&~(o-1),w=_+s-1&~(s-1),A=x*w*ql[n],C=0;C<r;C++)h[C]={levelID:C,levelWidth:r>1?p:x,levelHeight:r>1?_:w,levelBuffer:new Uint8Array(e.buffer,u,A)},u+=A,A=(x=(p=p>>1||1)+o-1&~(o-1))*(w=(_=_>>1||1)+s-1&~(s-1))*ql[n];return h},t}(function(i){function t(e,n){n===void 0&&(n={width:1,height:1,autoLoad:!0});var r,o,s=this;return typeof e=="string"?(r=e,o=new Uint8Array):(r=null,o=e),(s=i.call(this,o,n)||this).origin=r,s.buffer=o?new ue.x(o):null,s.origin&&n.autoLoad!==!1&&s.load(),o&&o.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return im(t,i),t.prototype.onBlobLoaded=function(e){},t.prototype.load=function(){return e=this,n=void 0,o=function(){var s;return eb(this,function(a){switch(a.label){case 0:return[4,fetch(this.origin)];case 1:return[4,a.sent().blob()];case 2:return[4,a.sent().arrayBuffer()];case 3:return s=a.sent(),this.data=new Uint32Array(s),this.buffer=new ue.x(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),[2,this]}})},new((r=Promise)||(r=Promise))(function(s,a){function l(p){try{u(o.next(p))}catch(_){a(_)}}function h(p){try{u(o.throw(p))}catch(_){a(_)}}function u(p){p.done?s(p.value):new r(function(_){_(p.value)}).then(l,h)}u((o=o.apply(e,n||[])).next())});var e,n,r,o},t}(ue.i)),nb=function(){function i(){}return i.use=function(t,e){var n=t.data;if(t.type===Mi.TYPE.JSON&&n&&n.cacheID&&n.textures){for(var r=n.textures,o=void 0,s=void 0,a=0,l=r.length;a<l;a++){var h=r[a],u=h.src,p=h.format;if(p||(s=u),i.textureFormats[p]){o=u;break}}if(!(o=o||s))return void e(new Error("Cannot load compressed-textures in "+t.url+", make sure you provide a fallback"));if(o===t.url)return void e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var _={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},x=xn.url.resolve(t.url.replace(this.baseUrl,""),o),w=n.cacheID;this.add(w,x,_,function(A){if(A.error)e(A.error);else{var C=A.texture,G=C===void 0?null:C,K=A.textures,it=K===void 0?{}:K;Object.assign(t,{texture:G,textures:it}),e()}})}else e()},Object.defineProperty(i,"textureExtensions",{get:function(){if(!i._textureExtensions){var t=document.createElement("canvas").getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var e={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};i._textureExtensions=e}return i._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(i,"textureFormats",{get:function(){if(!i._textureFormats){var t=i.textureExtensions;for(var e in i._textureFormats={},t){var n=t[e];n&&Object.assign(i._textureFormats,Object.getPrototypeOf(n))}}return i._textureFormats},enumerable:!1,configurable:!0}),i}();function rm(i,t,e){var n={textures:{},texture:null};return t&&t.map(function(r){return new ue.t(new ue.c(r,Object.assign({mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(r,o){var s=r.baseTexture,a=i+"-"+(o+1);ue.c.addToCache(s,a),ue.t.addToCache(r,a),o===0&&(ue.c.addToCache(s,i),ue.t.addToCache(r,i),n.texture=r),n.textures[a]=r}),n}Mi.setExtensionXhrType("dds",Mi.XHR_RESPONSE_TYPE.BUFFER);var Gr,Qu,ib=3,rb=4,ob=7,sb=19,ab=2,lb=0,hb=1,ub=2,cb=3;(function(i){i[i.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",i[i.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",i[i.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",i[i.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",i[i.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",i[i.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",i[i.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",i[i.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",i[i.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",i[i.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",i[i.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",i[i.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",i[i.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",i[i.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",i[i.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",i[i.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",i[i.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",i[i.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",i[i.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",i[i.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",i[i.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",i[i.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",i[i.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",i[i.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",i[i.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",i[i.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",i[i.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",i[i.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",i[i.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",i[i.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",i[i.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",i[i.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",i[i.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",i[i.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",i[i.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",i[i.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",i[i.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",i[i.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",i[i.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",i[i.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",i[i.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",i[i.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",i[i.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",i[i.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",i[i.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",i[i.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",i[i.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",i[i.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",i[i.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",i[i.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",i[i.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",i[i.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",i[i.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",i[i.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",i[i.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",i[i.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",i[i.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",i[i.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",i[i.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",i[i.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",i[i.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",i[i.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",i[i.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",i[i.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",i[i.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",i[i.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",i[i.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",i[i.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",i[i.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",i[i.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",i[i.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",i[i.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",i[i.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",i[i.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",i[i.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",i[i.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",i[i.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",i[i.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",i[i.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",i[i.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",i[i.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",i[i.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",i[i.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",i[i.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",i[i.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",i[i.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",i[i.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",i[i.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",i[i.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",i[i.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",i[i.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",i[i.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",i[i.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",i[i.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",i[i.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",i[i.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",i[i.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",i[i.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",i[i.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",i[i.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",i[i.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",i[i.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",i[i.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",i[i.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",i[i.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",i[i.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",i[i.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",i[i.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",i[i.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",i[i.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",i[i.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",i[i.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Gr||(Gr={})),function(i){i[i.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",i[i.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",i[i.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Qu||(Qu={}));var us,Ho,Zl,db=((Jl={})[827611204]=Ln.COMPRESSED_RGBA_S3TC_DXT1_EXT,Jl[861165636]=Ln.COMPRESSED_RGBA_S3TC_DXT3_EXT,Jl[894720068]=Ln.COMPRESSED_RGBA_S3TC_DXT5_EXT,Jl),pb=((Kr={})[Gr.DXGI_FORMAT_BC1_TYPELESS]=Ln.COMPRESSED_RGBA_S3TC_DXT1_EXT,Kr[Gr.DXGI_FORMAT_BC1_UNORM]=Ln.COMPRESSED_RGBA_S3TC_DXT1_EXT,Kr[Gr.DXGI_FORMAT_BC2_TYPELESS]=Ln.COMPRESSED_RGBA_S3TC_DXT3_EXT,Kr[Gr.DXGI_FORMAT_BC2_UNORM]=Ln.COMPRESSED_RGBA_S3TC_DXT3_EXT,Kr[Gr.DXGI_FORMAT_BC3_TYPELESS]=Ln.COMPRESSED_RGBA_S3TC_DXT5_EXT,Kr[Gr.DXGI_FORMAT_BC3_UNORM]=Ln.COMPRESSED_RGBA_S3TC_DXT5_EXT,Kr[Gr.DXGI_FORMAT_BC1_UNORM_SRGB]=Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Kr[Gr.DXGI_FORMAT_BC2_UNORM_SRGB]=Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Kr[Gr.DXGI_FORMAT_BC3_UNORM_SRGB]=Ln.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Kr),fb=function(){function i(){}return i.use=function(t,e){if(t.extension==="dds"&&t.data)try{Object.assign(t,rm(t.name||t.url,i.parse(t.data),t.metadata))}catch(n){return void e(n)}e()},i.parse=function(t){var e=new Uint32Array(t);if(e[0]!==542327876)throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[ib],o=n[rb],s=n[ob],a=new Uint32Array(t,sb*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),l=a[1];if(4&l){var h=a[ab];if(h!==808540228){var u=db[h],p=new Uint8Array(t,128);return[new $u(p,{format:u,width:o,height:r,levels:s})]}var _=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),x=_[lb],w=_[hb],A=_[ub],C=_[cb],G=pb[x];if(G===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+x);if(A===4)throw new Error("DDSLoader does not support cubemap textures");if(w===Qu.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var K=new Array;if(C===1)K.push(new Uint8Array(t,148));else{for(var it=ql[G],ft=0,nt=o,gt=r,lt=0;lt<s;lt++)ft+=Math.max(1,nt+3&-4)*Math.max(1,gt+3&-4)*it,nt>>>=1,gt>>>=1;var dt=148;for(lt=0;lt<C;lt++)K.push(new Uint8Array(t,dt,ft)),dt+=ft}return K.map(function(Ut){return new $u(Ut,{format:G,width:o,height:r,levels:s})})}throw 64&l?new Error("DDSLoader does not support uncompressed texture data."):512&l?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&l?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&l?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},i}();Mi.setExtensionXhrType("ktx",Mi.XHR_RESPONSE_TYPE.BUFFER);var om=[171,75,84,88,32,49,49,187,13,10,26,10],mb=12,gb=16,vb=24,_b=28,yb=36,xb=40,bb=44,Tb=48,wb=52,Sb=56,Eb=60,sm=((us={})[gn.r.UNSIGNED_BYTE]=1,us[gn.r.UNSIGNED_SHORT]=2,us[gn.r.INT]=4,us[gn.r.UNSIGNED_INT]=4,us[gn.r.FLOAT]=4,us[gn.r.HALF_FLOAT]=8,us),Ab=((Ho={})[gn.h.RGBA]=4,Ho[gn.h.RGB]=3,Ho[gn.h.RG]=2,Ho[gn.h.RED]=1,Ho[gn.h.LUMINANCE]=1,Ho[gn.h.LUMINANCE_ALPHA]=2,Ho[gn.h.ALPHA]=1,Ho),Mb=((Zl={})[gn.r.UNSIGNED_SHORT_4_4_4_4]=2,Zl[gn.r.UNSIGNED_SHORT_5_5_5_1]=2,Zl[gn.r.UNSIGNED_SHORT_5_6_5]=2,Zl),Cb=function(){function i(){}return i.use=function(t,e){if(t.extension==="ktx"&&t.data)try{var n=t.name||t.url,r=i.parse(n,t.data),o=r.compressed,s=r.uncompressed,a=r.kvData;if(o){var l=rm(n,o,t.metadata);if(a&&l.textures)for(var h in l.textures)l.textures[h].baseTexture.ktxKeyValueData=a;Object.assign(t,l)}else if(s){var u={};s.forEach(function(p,_){var x=new ue.t(new ue.c(p.resource,{mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA,type:p.type,format:p.format})),w=n+"-"+(_+1);a&&(x.baseTexture.ktxKeyValueData=a),ue.c.addToCache(x.baseTexture,w),ue.t.addToCache(x,w),_===0&&(u[n]=x,ue.c.addToCache(x.baseTexture,n),ue.t.addToCache(x,n)),u[w]=x}),Object.assign(t,{textures:u})}}catch(p){return void e(p)}e()},i.parse=function(t,e){var n=new DataView(e);if(!i.validate(t,n))return null;var r=n.getUint32(mb,!0)===67305985,o=n.getUint32(gb,r),s=n.getUint32(vb,r),a=n.getUint32(_b,r),l=n.getUint32(yb,r),h=n.getUint32(xb,r)||1,u=n.getUint32(bb,r)||1,p=n.getUint32(Tb,r)||1,_=n.getUint32(wb,r),x=n.getUint32(Sb,r),w=n.getUint32(Eb,r);if(h===0||u!==1)throw new Error("Only 2D textures are supported");if(_!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");var A,C=l+3&-4,G=h+3&-4,K=new Array(p),it=l*h;if(o===0&&(it=C*G),(A=o!==0?sm[o]?sm[o]*Ab[s]:Mb[o]:ql[a])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var ft=i.loadKeyValueData?i.parseKvData(n,w,r):null,nt=it*A,gt=l,lt=h,dt=C,Ut=G,Ft=64+w,Et=0;Et<x;Et++){for(var Mt=n.getUint32(Ft,r),Lt=Ft+4,Pt=0;Pt<p;Pt++){var ee=K[Pt];ee||(ee=K[Pt]=new Array(x)),ee[Et]={levelID:Et,levelWidth:x>1||o!==0?gt:dt,levelHeight:x>1||o!==0?lt:Ut,levelBuffer:new Uint8Array(e,Lt,nt)},Lt+=nt}Ft=(Ft+=Mt+4)%4!=0?Ft+4-Ft%4:Ft,nt=(dt=(gt=gt>>1||1)+4-1&-4)*(Ut=(lt=lt>>1||1)+4-1&-4)*A}return o!==0?{uncompressed:K.map(function($t){var zt=$t[0].levelBuffer,Xt=!1;return o===gn.r.FLOAT?zt=new Float32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4):o===gn.r.UNSIGNED_INT?(Xt=!0,zt=new Uint32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)):o===gn.r.INT&&(Xt=!0,zt=new Int32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)),{resource:new ue.i(zt,{width:$t[0].levelWidth,height:$t[0].levelHeight}),type:o,format:Xt?i.convertFormatToInteger(s):s}}),kvData:ft}:{compressed:K.map(function($t){return new $u(null,{format:a,width:l,height:h,levels:x,levelBuffers:$t})}),kvData:ft}},i.validate=function(t,e){for(var n=0;n<om.length;n++)if(e.getUint8(n)!==om[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},i.convertFormatToInteger=function(t){switch(t){case gn.h.RGBA:return gn.h.RGBA_INTEGER;case gn.h.RGB:return gn.h.RGB_INTEGER;case gn.h.RG:return gn.h.RG_INTEGER;case gn.h.RED:return gn.h.RED_INTEGER;default:return t}},i.parseKvData=function(t,e,n){for(var r=new Map,o=0;o<e;){var s=t.getUint32(64+o,n),a=64+o+4,l=3-(s+3)%4;if(s===0||s>e-o){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var h=0;h<s&&t.getUint8(a+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var u=new TextDecoder().decode(new Uint8Array(t.buffer,a,h)),p=new DataView(t.buffer,a+h+1,s-h-1);r.set(u,p),o+=4+s+l}return r},i.loadKeyValueData=!1,i}(),am=function(i,t){return(am=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function lm(i,t){function e(){this.constructor=i}am(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var jo,zo,Rb=function(i){function t(e,n,r,o){e===void 0&&(e=1500),r===void 0&&(r=16384),o===void 0&&(o=!1);var s=i.call(this)||this;return r>16384&&(r=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=r,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=gn.b.NORMAL,s.autoResize=o,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return lm(t,i),t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Object(xn.hex2rgb)(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var n=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var n=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<n;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[n]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},t}(Cn.b),hm=function(){function i(t,e,n){this.geometry=new ue.l,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var o=t[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||gn.r.FLOAT,offset:o.offset},e[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return i.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new ue.h(Object(xn.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(a=this.dynamicProperties[n]).offset=e,e+=a.size,this.dynamicStride+=a.size;var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new ue.h(this.dynamicData,!1,!1);var o=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(a=this.staticProperties[n]).offset=o,o+=a.size,this.staticStride+=a.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ue.h(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var a=this.dynamicProperties[n];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.dynamicStride,4*a.offset)}for(n=0;n<this.staticProperties.length;++n)a=this.staticProperties[n],t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.staticStride,4*a.offset)},i.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},i.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},i.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},i}(),Ib=function(i){function t(e){var n=i.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new Oe.d,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:gn.r.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=ue.r.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),n.state=ue.s.for2d(),n}return lm(t,i),t.prototype.render=function(e){var n=e.children,r=e._maxSize,o=e._batchSize,s=this.renderer,a=n.length;if(a!==0){a>r&&!e.autoResize&&(a=r);var l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));var h=n[0]._texture.baseTexture;this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),s.state.set(this.state);var u=s.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=Object(xn.premultiplyRgba)(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,h.alphaMode),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);for(var _=!1,x=0,w=0;x<a;x+=o,w+=1){var A=a-x;A>o&&(A=o),w>=l.length&&l.push(this._generateOneMoreBuffer(e));var C=l[w];C.uploadDynamic(n,x,A);var G=e._bufferUpdateIDs[w]||0;(_=_||C._updateID<G)&&(C._updateID=e._updateID,C.uploadStatic(n,x,A)),s.geometry.bind(C.geometry),u.drawElements(u.TRIANGLES,6*A,u.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var n=[],r=e._maxSize,o=e._batchSize,s=e._properties,a=0;a<r;a+=o)n.push(new hm(this.properties,s,o));return n},t.prototype._generateOneMoreBuffer=function(e){var n=e._batchSize,r=e._properties;return new hm(this.properties,r,n)},t.prototype.uploadVertices=function(e,n,r,o,s,a){for(var l=0,h=0,u=0,p=0,_=0;_<r;++_){var x=e[n+_],w=x._texture,A=x.scale.x,C=x.scale.y,G=w.trim,K=w.orig;G?(l=(h=G.x-x.anchor.x*K.width)+G.width,u=(p=G.y-x.anchor.y*K.height)+G.height):(l=K.width*(1-x.anchor.x),h=K.width*-x.anchor.x,u=K.height*(1-x.anchor.y),p=K.height*-x.anchor.y),o[a]=h*A,o[a+1]=p*C,o[a+s]=l*A,o[a+s+1]=p*C,o[a+2*s]=l*A,o[a+2*s+1]=u*C,o[a+3*s]=h*A,o[a+3*s+1]=u*C,a+=4*s}},t.prototype.uploadPosition=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].position;o[a]=h.x,o[a+1]=h.y,o[a+s]=h.x,o[a+s+1]=h.y,o[a+2*s]=h.x,o[a+2*s+1]=h.y,o[a+3*s]=h.x,o[a+3*s+1]=h.y,a+=4*s}},t.prototype.uploadRotation=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].rotation;o[a]=h,o[a+s]=h,o[a+2*s]=h,o[a+3*s]=h,a+=4*s}},t.prototype.uploadUvs=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l]._texture._uvs;h?(o[a]=h.x0,o[a+1]=h.y0,o[a+s]=h.x1,o[a+s+1]=h.y1,o[a+2*s]=h.x2,o[a+2*s+1]=h.y2,o[a+3*s]=h.x3,o[a+3*s+1]=h.y3,a+=4*s):(o[a]=0,o[a+1]=0,o[a+s]=0,o[a+s+1]=0,o[a+2*s]=0,o[a+2*s+1]=0,o[a+3*s]=0,o[a+3*s+1]=0,a+=4*s)}},t.prototype.uploadTint=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l],u=h._texture.baseTexture.alphaMode>0,p=h.alpha,_=p<1&&u?Object(xn.premultiplyTint)(h._tintRGB,p):h._tintRGB+(255*p<<24);o[a]=_,o[a+s]=_,o[a+2*s]=_,o[a+3*s]=_,a+=4*s}},t.prototype.destroy=function(){i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(ue.m),Tr=v(4);(function(i){i.MITER="miter",i.BEVEL="bevel",i.ROUND="round"})(jo||(jo={})),function(i){i.BUTT="butt",i.ROUND="round",i.SQUARE="square"}(zo||(zo={}));var Fa={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(i,t){if(t===void 0&&(t=20),!this.adaptive||!i||isNaN(i))return t;var e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},um=function(){function i(){this.color=16777215,this.alpha=1,this.texture=ue.t.WHITE,this.matrix=null,this.visible=!1,this.reset()}return i.prototype.clone=function(){var t=new i;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},i.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ue.t.WHITE,this.matrix=null,this.visible=!1},i.prototype.destroy=function(){this.texture=null,this.matrix=null},i}(),cm=function(i,t){return(cm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function tc(i,t){function e(){this.constructor=i}cm(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function dm(i,t){var e,n;t===void 0&&(t=!1);var r=i.length;if(!(r<6)){for(var o=0,s=0,a=i[r-2],l=i[r-1];s<r;s+=2){var h=i[s],u=i[s+1];o+=(h-a)*(u+l),a=h,l=u}if(!t&&o>0||t&&o<=0){var p=r/2;for(s=p+p%2;s<r;s+=2){var _=r-s-2,x=r-s-1,w=s,A=s+1;e=[i[w],i[_]],i[_]=e[0],i[w]=e[1],n=[i[A],i[x]],i[x]=n[0],i[A]=n[1]}}}}var pm={build:function(i){i.points=i.shape.points.slice()},triangulate:function(i,t){var e=i.points,n=i.holes,r=t.points,o=t.indices;if(e.length>=6){dm(e,!1);for(var s=[],a=0;a<n.length;a++){var l=n[a];dm(l.points,!0),s.push(e.length/2),e=e.concat(l.points)}var h=Object(xn.earcut)(e,s,2);if(!h)return;var u=r.length/2;for(a=0;a<h.length;a+=3)o.push(h[a]+u),o.push(h[a+1]+u),o.push(h[a+2]+u);for(a=0;a<e.length;a++)r.push(e[a])}}},Kl={build:function(i){var t,e,n,r,o,s,a=i.points;if(i.type===Oe.l.CIRC){var l=i.shape;t=l.x,e=l.y,o=s=l.radius,n=r=0}else if(i.type===Oe.l.ELIP){var h=i.shape;t=h.x,e=h.y,o=h.width,s=h.height,n=r=0}else{var u=i.shape,p=u.width/2,_=u.height/2;t=u.x+p,e=u.y+_,n=p-(o=s=Math.max(0,Math.min(u.radius,Math.min(p,_)))),r=_-s}if(o>=0&&s>=0&&n>=0&&r>=0){var x=Math.ceil(2.3*Math.sqrt(o+s)),w=8*x+(n?4:0)+(r?4:0);if(a.length=w,w!==0){if(x===0)return a.length=8,a[0]=a[6]=t+n,a[1]=a[3]=e+r,a[2]=a[4]=t-n,void(a[5]=a[7]=e-r);var A=0,C=4*x+(n?2:0)+2,G=C,K=w,it=t+(Ut=n+o),ft=t-Ut,nt=e+(Ft=r);if(a[A++]=it,a[A++]=nt,a[--C]=nt,a[--C]=ft,r){var gt=e-Ft;a[G++]=ft,a[G++]=gt,a[--K]=gt,a[--K]=it}for(var lt=1;lt<x;lt++){var dt=Math.PI/2*(lt/x);it=t+(Ut=n+Math.cos(dt)*o),ft=t-Ut,nt=e+(Ft=r+Math.sin(dt)*s),gt=e-Ft,a[A++]=it,a[A++]=nt,a[--C]=nt,a[--C]=ft,a[G++]=ft,a[G++]=gt,a[--K]=gt,a[--K]=it}var Ut,Ft;it=t+(Ut=n),ft=t-Ut,nt=e+(Ft=r+s),gt=e-Ft,a[A++]=it,a[A++]=nt,a[--K]=gt,a[--K]=it,n&&(a[A++]=ft,a[A++]=nt,a[--K]=gt,a[--K]=ft)}}else a.length=0},triangulate:function(i,t){var e,n,r=i.points,o=t.points,s=t.indices,a=o.length/2,l=a;if(i.type!==Oe.l.RREC){var h=i.shape;e=h.x,n=h.y}else{var u=i.shape;e=u.x+u.width/2,n=u.y+u.height/2}var p=i.matrix;o.push(i.matrix?p.a*e+p.c*n+p.tx:e,i.matrix?p.b*e+p.d*n+p.ty:n),a++,o.push(r[0],r[1]);for(var _=2;_<r.length;_+=2)o.push(r[_],r[_+1]),s.push(a++,l,a);s.push(l+1,l,a)}},Pb={build:function(i){var t=i.shape,e=t.x,n=t.y,r=t.width,o=t.height,s=i.points;s.length=0,s.push(e,n,e+r,n,e+r,n+o,e,n+o)},triangulate:function(i,t){var e=i.points,n=t.points,r=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function Hs(i,t,e){return i+(t-i)*e}function $l(i,t,e,n,r,o,s){s===void 0&&(s=[]);for(var a=s,l=0,h=0,u=0,p=0,_=0,x=0,w=0,A=0;w<=20;++w)l=Hs(i,e,A=w/20),h=Hs(t,n,A),u=Hs(e,r,A),p=Hs(n,o,A),_=Hs(l,u,A),x=Hs(h,p,A),w===0&&a[a.length-2]===_&&a[a.length-1]===x||a.push(_,x);return a}var Ob={build:function(i){if($i.nextRoundedRectBehavior)Kl.build(i);else{var t=i.shape,e=i.points,n=t.x,r=t.y,o=t.width,s=t.height,a=Math.max(0,Math.min(t.radius,Math.min(o,s)/2));e.length=0,a?($l(n,r+a,n,r,n+a,r,e),$l(n+o-a,r,n+o,r,n+o,r+a,e),$l(n+o,r+s-a,n+o,r+s,n+o-a,r+s,e),$l(n+a,r+s,n,r+s,n,r+s-a,e)):e.push(n,r,n+o,r,n+o,r+s,n,r+s)}},triangulate:function(i,t){if($i.nextRoundedRectBehavior)Kl.triangulate(i,t);else{for(var e=i.points,n=t.points,r=t.indices,o=n.length/2,s=Object(xn.earcut)(e,null,2),a=0,l=s.length;a<l;a+=3)r.push(s[a]+o),r.push(s[a+1]+o),r.push(s[a+2]+o);for(a=0,l=e.length;a<l;a++)n.push(e[a],e[++a])}}};function fm(i,t,e,n,r,o,s,a){var l,h;s?(l=n,h=-e):(l=-n,h=e);var u=i-e*r+l,p=t-n*r+h,_=i+e*o+l,x=t+n*o+h;return a.push(u,p),a.push(_,x),2}function js(i,t,e,n,r,o,s,a){var l=e-i,h=n-t,u=Math.atan2(l,h),p=Math.atan2(r-i,o-t);a&&u<p?u+=2*Math.PI:!a&&u>p&&(p+=2*Math.PI);var _=u,x=p-u,w=Math.abs(x),A=Math.sqrt(l*l+h*h),C=1+(15*w*Math.sqrt(A)/Math.PI>>0),G=x/C;if(_+=G,a){s.push(i,t),s.push(e,n);for(var K=1,it=_;K<C;K++,it+=G)s.push(i,t),s.push(i+Math.sin(it)*A,t+Math.cos(it)*A);s.push(i,t),s.push(r,o)}else{for(s.push(e,n),s.push(i,t),K=1,it=_;K<C;K++,it+=G)s.push(i+Math.sin(it)*A,t+Math.cos(it)*A),s.push(i,t);s.push(r,o),s.push(i,t)}return 2*C}function mm(i,t){i.lineStyle.native?function(e,n){var r=0,o=e.shape,s=e.points||o.points,a=o.type!==Oe.l.POLY||o.closeStroke;if(s.length!==0){var l=n.points,h=n.indices,u=s.length/2,p=l.length/2,_=p;for(l.push(s[0],s[1]),r=1;r<u;r++)l.push(s[2*r],s[2*r+1]),h.push(_,_+1),_++;a&&h.push(_,p)}}(i,t):function(e,n){var r=e.shape,o=e.points||r.points.slice(),s=n.closePointEps;if(o.length!==0){var a=e.lineStyle,l=new Oe.g(o[0],o[1]),h=new Oe.g(o[o.length-2],o[o.length-1]),u=r.type!==Oe.l.POLY||r.closeStroke,p=Math.abs(l.x-h.x)<s&&Math.abs(l.y-h.y)<s;if(u){o=o.slice(),p&&(o.pop(),o.pop(),h.set(o[o.length-2],o[o.length-1]));var _=.5*(l.x+h.x),x=.5*(h.y+l.y);o.unshift(_,x),o.push(_,x)}var w=n.points,A=o.length/2,C=o.length,G=w.length/2,K=a.width/2,it=K*K,ft=a.miterLimit*a.miterLimit,nt=o[0],gt=o[1],lt=o[2],dt=o[3],Ut=0,Ft=0,Et=-(gt-dt),Mt=nt-lt,Lt=0,Pt=0,ee=Math.sqrt(Et*Et+Mt*Mt);Et/=ee,Mt/=ee,Et*=K,Mt*=K;var $t=a.alignment,zt=2*(1-$t),Xt=2*$t;u||(a.cap===zo.ROUND?C+=js(nt-Et*(zt-Xt)*.5,gt-Mt*(zt-Xt)*.5,nt-Et*zt,gt-Mt*zt,nt+Et*Xt,gt+Mt*Xt,w,!0)+2:a.cap===zo.SQUARE&&(C+=fm(nt,gt,Et,Mt,zt,Xt,!0,w))),w.push(nt-Et*zt,gt-Mt*zt),w.push(nt+Et*Xt,gt+Mt*Xt);for(var pe=1;pe<A-1;++pe){nt=o[2*(pe-1)],gt=o[2*(pe-1)+1],lt=o[2*pe],dt=o[2*pe+1],Ut=o[2*(pe+1)],Ft=o[2*(pe+1)+1],Et=-(gt-dt),Mt=nt-lt,Et/=ee=Math.sqrt(Et*Et+Mt*Mt),Mt/=ee,Et*=K,Mt*=K,Lt=-(dt-Ft),Pt=lt-Ut,Lt/=ee=Math.sqrt(Lt*Lt+Pt*Pt),Pt/=ee,Lt*=K,Pt*=K;var be=lt-nt,Pe=gt-dt,Ct=lt-Ut,Bt=Ft-dt,ve=Pe*Ct-Bt*be,le=ve<0;if(Math.abs(ve)<.1)w.push(lt-Et*zt,dt-Mt*zt),w.push(lt+Et*Xt,dt+Mt*Xt);else{var se=(-Et+nt)*(-Mt+dt)-(-Et+lt)*(-Mt+gt),Ie=(-Lt+Ut)*(-Pt+dt)-(-Lt+lt)*(-Pt+Ft),De=(be*Ie-Ct*se)/ve,ce=(Bt*se-Pe*Ie)/ve,Tt=(De-lt)*(De-lt)+(ce-dt)*(ce-dt),jt=lt+(De-lt)*zt,ie=dt+(ce-dt)*zt,ae=lt-(De-lt)*Xt,qt=dt-(ce-dt)*Xt,ye=le?zt:Xt;Tt<=Math.min(be*be+Pe*Pe,Ct*Ct+Bt*Bt)+ye*ye*it?a.join===jo.BEVEL||Tt/it>ft?(le?(w.push(jt,ie),w.push(lt+Et*Xt,dt+Mt*Xt),w.push(jt,ie),w.push(lt+Lt*Xt,dt+Pt*Xt)):(w.push(lt-Et*zt,dt-Mt*zt),w.push(ae,qt),w.push(lt-Lt*zt,dt-Pt*zt),w.push(ae,qt)),C+=2):a.join===jo.ROUND?le?(w.push(jt,ie),w.push(lt+Et*Xt,dt+Mt*Xt),C+=js(lt,dt,lt+Et*Xt,dt+Mt*Xt,lt+Lt*Xt,dt+Pt*Xt,w,!0)+4,w.push(jt,ie),w.push(lt+Lt*Xt,dt+Pt*Xt)):(w.push(lt-Et*zt,dt-Mt*zt),w.push(ae,qt),C+=js(lt,dt,lt-Et*zt,dt-Mt*zt,lt-Lt*zt,dt-Pt*zt,w,!1)+4,w.push(lt-Lt*zt,dt-Pt*zt),w.push(ae,qt)):(w.push(jt,ie),w.push(ae,qt)):(w.push(lt-Et*zt,dt-Mt*zt),w.push(lt+Et*Xt,dt+Mt*Xt),a.join===jo.ROUND?C+=le?js(lt,dt,lt+Et*Xt,dt+Mt*Xt,lt+Lt*Xt,dt+Pt*Xt,w,!0)+2:js(lt,dt,lt-Et*zt,dt-Mt*zt,lt-Lt*zt,dt-Pt*zt,w,!1)+2:a.join===jo.MITER&&Tt/it<=ft&&(le?(w.push(ae,qt),w.push(ae,qt)):(w.push(jt,ie),w.push(jt,ie)),C+=2),w.push(lt-Lt*zt,dt-Pt*zt),w.push(lt+Lt*Xt,dt+Pt*Xt),C+=2)}}nt=o[2*(A-2)],gt=o[2*(A-2)+1],lt=o[2*(A-1)],Et=-(gt-(dt=o[2*(A-1)+1])),Mt=nt-lt,Et/=ee=Math.sqrt(Et*Et+Mt*Mt),Mt/=ee,Et*=K,Mt*=K,w.push(lt-Et*zt,dt-Mt*zt),w.push(lt+Et*Xt,dt+Mt*Xt),u||(a.cap===zo.ROUND?C+=js(lt-Et*(zt-Xt)*.5,dt-Mt*(zt-Xt)*.5,lt-Et*zt,dt-Mt*zt,lt+Et*Xt,dt+Mt*Xt,w,!1)+2:a.cap===zo.SQUARE&&(C+=fm(lt,dt,Et,Mt,zt,Xt,!1,w)));var nn=n.indices,on=Fa.epsilon*Fa.epsilon;for(pe=G;pe<C+G-2;++pe)nt=w[2*pe],gt=w[2*pe+1],lt=w[2*(pe+1)],dt=w[2*(pe+1)+1],Ut=w[2*(pe+2)],Ft=w[2*(pe+2)+1],Math.abs(nt*(dt-Ft)+lt*(Ft-gt)+Ut*(gt-dt))<on||nn.push(pe,pe+1,pe+2)}}(i,t)}var zs,gm=function(){function i(){}return i.curveTo=function(t,e,n,r,o,s){var a=s[s.length-2],l=s[s.length-1]-e,h=a-t,u=r-e,p=n-t,_=Math.abs(l*p-h*u);if(_<1e-8||o===0)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var x=l*l+h*h,w=u*u+p*p,A=l*u+h*p,C=o*Math.sqrt(x)/_,G=o*Math.sqrt(w)/_,K=C*A/x,it=G*A/w,ft=C*p+G*h,nt=C*u+G*l,gt=h*(G+K),lt=l*(G+K),dt=p*(C+it),Ut=u*(C+it);return{cx:ft+t,cy:nt+e,radius:o,startAngle:Math.atan2(lt-nt,gt-ft),endAngle:Math.atan2(Ut-nt,dt-ft),anticlockwise:h*u>p*l}},i.arc=function(t,e,n,r,o,s,a,l,h){for(var u=a-s,p=Fa._segmentsCount(Math.abs(u)*o,40*Math.ceil(Math.abs(u)/Oe.f)),_=u/(2*p),x=2*_,w=Math.cos(_),A=Math.sin(_),C=p-1,G=C%1/C,K=0;K<=C;++K){var it=_+s+x*(K+G*K),ft=Math.cos(it),nt=-Math.sin(it);h.push((w*ft+A*nt)*o+n,(w*-nt+A*ft)*o+r)}},i}(),Lb=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s,a,l){for(var h=0,u=0,p=0,_=0,x=0,w=0,A=0,C=0,G=0,K=0,it=0,ft=t,nt=e,gt=1;gt<=10;++gt)K=ft-(C=(A=(w=(x=1-(u=gt/10))*x)*x)*t+3*w*u*n+3*x*(p=u*u)*o+(_=p*u)*a),it=nt-(G=A*e+3*w*u*r+3*x*p*s+_*l),ft=C,nt=G,h+=Math.sqrt(K*K+it*it);return h},i.curveTo=function(t,e,n,r,o,s,a){var l=a[a.length-2],h=a[a.length-1];a.length-=2;var u=Fa._segmentsCount(i.curveLength(l,h,t,e,n,r,o,s)),p=0,_=0,x=0,w=0,A=0;a.push(l,h);for(var C=1,G=0;C<=u;++C)x=(_=(p=1-(G=C/u))*p)*p,A=(w=G*G)*G,a.push(x*l+3*_*G*t+3*p*w*n+A*o,x*h+3*_*G*e+3*p*w*r+A*s)},i}(),Nb=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s){var a=t-2*n+o,l=e-2*r+s,h=2*n-2*t,u=2*r-2*e,p=4*(a*a+l*l),_=4*(a*h+l*u),x=h*h+u*u,w=2*Math.sqrt(p+_+x),A=Math.sqrt(p),C=2*p*A,G=2*Math.sqrt(x),K=_/A;return(C*w+A*_*(w-G)+(4*x*p-_*_)*Math.log((2*A+K+w)/(K+G)))/(4*C)},i.curveTo=function(t,e,n,r,o){for(var s=o[o.length-2],a=o[o.length-1],l=Fa._segmentsCount(i.curveLength(s,a,t,e,n,r)),h=0,u=0,p=1;p<=l;++p){var _=p/l;h=s+(t-s)*_,u=a+(e-a)*_,o.push(h+(t+(n-t)*_-h)*_,u+(e+(r-e)*_-u)*_)}},i}(),Db=function(){function i(){this.reset()}return i.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},i.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},i.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},i}(),ec=((zs={})[Oe.l.POLY]=pm,zs[Oe.l.CIRC]=Kl,zs[Oe.l.ELIP]=Kl,zs[Oe.l.RECT]=Pb,zs[Oe.l.RREC]=Ob,zs),vm=[],Ql=[],_m=function(){function i(t,e,n,r){e===void 0&&(e=null),n===void 0&&(n=null),r===void 0&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}return i.prototype.clone=function(){return new i(this.shape,this.fillStyle,this.lineStyle,this.matrix)},i.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},i}(),Vs=new Oe.g,Fb=new Cn.a,Bb=function(i){function t(){var e=i.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Cn.a,e.boundsDirty=-1,e}return tc(t,i),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Ql.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var n=this.batches[e];n.reset(),vm.push(n)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,n,r,o){n===void 0&&(n=null),r===void 0&&(r=null),o===void 0&&(o=null);var s=new _m(e,n,r,o);return this.graphicsData.push(s),this.dirty++,this},t.prototype.drawHole=function(e,n){if(n===void 0&&(n=null),!this.graphicsData.length)return null;var r=new _m(e,null,null,n),o=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=o.lineStyle,o.holes.push(r),this.dirty++,this},t.prototype.destroy=function(){i.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var n=this.graphicsData,r=0;r<n.length;++r){var o=n[r];if(o.fillStyle.visible&&o.shape&&(o.matrix?o.matrix.applyInverse(e,Vs):Vs.copyFrom(e),o.shape.contains(Vs.x,Vs.y))){var s=!1;if(o.holes){for(var a=0;a<o.holes.length;a++)if(o.holes[a].shape.contains(Vs.x,Vs.y)){s=!0;break}}if(!s)return!0}}return!1},t.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var n=this.uvs,r=this.graphicsData,o=null,s=null;this.batches.length>0&&(s=(o=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<r.length;a++){this.shapeIndex++;var l=r[a],h=l.fillStyle,u=l.lineStyle;ec[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||u.visible)&&this.processHoles(l.holes);for(var p=0;p<2;p++){var _=p===0?h:u;if(_.visible){var x=_.texture.baseTexture,w=this.indices.length,A=this.points.length/2;x.wrapMode=gn.s.REPEAT,p===0?this.processFill(l):this.processLine(l);var C=this.points.length/2-A;C!==0&&(o&&!this._compareStyles(s,_)&&(o.end(w,A),o=null),o||((o=vm.pop()||new Db).begin(_,w,A),this.batches.push(o),s=_),this.addUvs(this.points,n,_.texture,A,C,_.matrix))}}}var G=this.indices.length,K=this.points.length/2;if(o&&o.end(G,K),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var it=K>65535&&e;this.indicesUint16=it?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},t.prototype._compareStyles=function(e,n){return!(!e||!n)&&e.texture.baseTexture===n.texture.baseTexture&&e.color+e.alpha===n.color+n.alpha&&!!e.native==!!n.native},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,n=this.graphicsData.length;e<n;e++){var r=this.graphicsData[e],o=r.fillStyle,s=r.lineStyle;if(o&&!o.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,n=0,r=e.length;n<r;n++)for(var o=e[n],s=0;s<o.size;s++){var a=o.start+s;this.indicesUint16[a]=this.indicesUint16[a]-o.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE},t.prototype.buildDrawCalls=function(){for(var e=++ue.c._globalBatch,n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),Ql.push(this.drawCalls[n]);this.drawCalls.length=0;var r=this.colors,o=this.textureIds,s=Ql.pop();s||((s=new ue.d).texArray=new ue.g),s.texArray.count=0,s.start=0,s.size=0,s.type=gn.f.TRIANGLES;var a=0,l=null,h=0,u=!1,p=gn.f.TRIANGLES,_=0;for(this.drawCalls.push(s),n=0;n<this.batches.length;n++){var x=this.batches[n],w=x.style,A=w.texture.baseTexture;u!==!!w.native&&(p=(u=!!w.native)?gn.f.LINES:gn.f.TRIANGLES,l=null,a=8,e++),l!==A&&(l=A,A._batchEnabled!==e&&(a===8&&(e++,a=0,s.size>0&&((s=Ql.pop())||((s=new ue.d).texArray=new ue.g),this.drawCalls.push(s)),s.start=_,s.size=0,s.texArray.count=0,s.type=p),A.touched=1,A._batchEnabled=e,A._batchLocation=a,A.wrapMode=gn.s.REPEAT,s.texArray.elements[s.texArray.count++]=A,a++)),s.size+=x.size,_+=x.size,h=A._batchLocation,this.addColors(r,w.color,w.alpha,x.attribSize,x.attribStart),this.addTextureIds(o,h,x.attribSize,x.attribStart)}ue.c._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,n=this.uvs,r=this.colors,o=this.textureIds,s=new ArrayBuffer(3*e.length*4),a=new Float32Array(s),l=new Uint32Array(s),h=0,u=0;u<e.length/2;u++)a[h++]=e[2*u],a[h++]=e[2*u+1],a[h++]=n[2*u],a[h++]=n[2*u+1],l[h++]=r[u],a[h++]=o[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?pm.triangulate(e,this):ec[e.type].triangulate(e,this)},t.prototype.processLine=function(e){mm(e,this);for(var n=0;n<e.holes.length;n++)mm(e.holes[n],this)},t.prototype.processHoles=function(e){for(var n=0;n<e.length;n++){var r=e[n];ec[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,n=Fb,r=Oe.d.IDENTITY;this._bounds.clear(),n.clear();for(var o=0;o<this.graphicsData.length;o++){var s=this.graphicsData[o],a=s.shape,l=s.type,h=s.lineStyle,u=s.matrix||Oe.d.IDENTITY,p=0;if(h&&h.visible&&(p=h.width,l!==Oe.l.POLY||s.fillStyle.visible?p*=Math.max(0,h.alignment):p*=Math.max(h.alignment,1-h.alignment)),r!==u&&(n.isEmpty()||(e.addBoundsMatrix(n,r),n.clear()),r=u),l===Oe.l.RECT||l===Oe.l.RREC){var _=a;n.addFramePad(_.x,_.y,_.x+_.width,_.y+_.height,p,p)}else if(l===Oe.l.CIRC){var x=a;n.addFramePad(x.x,x.y,x.x,x.y,x.radius+p,x.radius+p)}else if(l===Oe.l.ELIP){var w=a;n.addFramePad(w.x,w.y,w.x,w.y,w.width+p,w.height+p)}else{var A=a;e.addVerticesMatrix(r,A.points,0,A.points.length,p,p)}}n.isEmpty()||e.addBoundsMatrix(n,r),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,n){for(var r=0;r<e.length/2;r++){var o=e[2*r],s=e[2*r+1];e[2*r]=n.a*o+n.c*s+n.tx,e[2*r+1]=n.b*o+n.d*s+n.ty}},t.prototype.addColors=function(e,n,r,o,s){s===void 0&&(s=0);var a=(n>>16)+(65280&n)+((255&n)<<16),l=Object(xn.premultiplyTint)(a,r);e.length=Math.max(e.length,s+o);for(var h=0;h<o;h++)e[s+h]=l},t.prototype.addTextureIds=function(e,n,r,o){o===void 0&&(o=0),e.length=Math.max(e.length,o+r);for(var s=0;s<r;s++)e[o+s]=n},t.prototype.addUvs=function(e,n,r,o,s,a){a===void 0&&(a=null);for(var l=0,h=n.length,u=r.frame;l<s;){var p=e[2*(o+l)],_=e[2*(o+l)+1];if(a){var x=a.a*p+a.c*_+a.tx;_=a.b*p+a.d*_+a.ty,p=x}l++,n.push(p/u.width,_/u.height)}var w=r.baseTexture;(u.width<w.width||u.height<w.height)&&this.adjustUvs(n,r,h,s)},t.prototype.adjustUvs=function(e,n,r,o){for(var s=n.baseTexture,a=1e-6,l=r+2*o,h=n.frame,u=h.width/s.width,p=h.height/s.height,_=h.x/h.width,x=h.y/h.height,w=Math.floor(e[r]+a),A=Math.floor(e[r+1]+a),C=r+2;C<l;C+=2)w=Math.min(w,Math.floor(e[C]+a)),A=Math.min(A,Math.floor(e[C+1]+a));for(_-=w,x-=A,C=r;C<l;C+=2)e[C]=(e[C]+_)*u,e[C+1]=(e[C+1]+x)*p},t.BATCHABLE_SIZE=100,t}(ue.e),kb=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=zo.BUTT,e.join=jo.MITER,e.miterLimit=10,e}return tc(t,i),t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){i.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(um),Ub=new Float32Array(3),nc={},$i=function(i){function t(e){e===void 0&&(e=null);var n=i.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new um,n._lineStyle=new kb,n._matrix=null,n._holeMode=!1,n.state=ue.s.for2d(),n._geometry=e||new Bb,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=gn.b.NORMAL,n}return tc(t,i),Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,n,r,o,s){return e===void 0&&(e=null),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=.5),s===void 0&&(s=!1),typeof e=="number"&&(e={width:e,color:n,alpha:r,alignment:o,native:s}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:ue.t.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:zo.BUTT,join:jo.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new Oe.h,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[n-2],e[n-1]))}else this.currentPath=new Oe.h,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,n){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=n,this},t.prototype.lineTo=function(e,n){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,o=r[r.length-2],s=r[r.length-1];return o===e&&s===n||r.push(e,n),this},t.prototype._initCurve=function(e,n){e===void 0&&(e=0),n===void 0&&(n=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,n]):this.moveTo(e,n)},t.prototype.quadraticCurveTo=function(e,n,r,o){this._initCurve();var s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Nb.curveTo(e,n,r,o,s),this},t.prototype.bezierCurveTo=function(e,n,r,o,s,a){return this._initCurve(),Lb.curveTo(e,n,r,o,s,a,this.currentPath.points),this},t.prototype.arcTo=function(e,n,r,o,s){this._initCurve(e,n);var a=this.currentPath.points,l=gm.curveTo(e,n,r,o,s,a);if(l){var h=l.cx,u=l.cy,p=l.radius,_=l.startAngle,x=l.endAngle,w=l.anticlockwise;this.arc(h,u,p,_,x,w)}return this},t.prototype.arc=function(e,n,r,o,s,a){if(a===void 0&&(a=!1),o===s)return this;if(!a&&s<=o?s+=Oe.f:a&&o<=s&&(o+=Oe.f),s-o===0)return this;var l=e+Math.cos(o)*r,h=n+Math.sin(o)*r,u=this._geometry.closePointEps,p=this.currentPath?this.currentPath.points:null;if(p){var _=Math.abs(p[p.length-2]-l),x=Math.abs(p[p.length-1]-h);_<u&&x<u||p.push(l,h)}else this.moveTo(l,h),p=this.currentPath.points;return gm.arc(l,h,e,n,r,o,s,a,p),this},t.prototype.beginFill=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=1),this.beginTextureFill({texture:ue.t.WHITE,color:e,alpha:n})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:ue.t.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,n,r,o){return this.drawShape(new Oe.j(e,n,r,o))},t.prototype.drawRoundedRect=function(e,n,r,o,s){return this.drawShape(new Oe.k(e,n,r,o,s))},t.prototype.drawCircle=function(e,n,r){return this.drawShape(new Oe.a(e,n,r))},t.prototype.drawEllipse=function(e,n,r,o){return this.drawShape(new Oe.c(e,n,r,o))},t.prototype.drawPolygon=function(){for(var e,n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];var s=!0,a=r[0];a.points?(s=a.closeStroke,e=a.points):e=Array.isArray(r[0])?r[0]:r;var l=new Oe.h(e);return l.closeStroke=s,this.drawShape(l),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(e.length!==1||e[0].shape.type!==Oe.l.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var n=this._geometry,r=e.context.supports.uint32Indices;n.updateBatches(r),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,n=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(var o=0;o<r;o++){var s=e.batches[o],a=s.style.color,l=new Float32Array(this.vertexData.buffer,4*s.attribStart*2,2*s.attribSize),h=new Float32Array(e.uvsFloat32.buffer,4*s.attribStart*2,2*s.attribSize),u={vertexData:l,blendMode:n,indices:new Uint16Array(e.indicesUint16.buffer,2*s.start,s.size),uvs:h,_batchRGB:Object(xn.hex2rgb)(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[o]=u}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var n=0,r=this.batches.length;n<r;n++){var o=this.batches[n];o.worldAlpha=this.worldAlpha*o.alpha,e.plugins[this.pluginName].render(o)}}},t.prototype._renderDirect=function(e){var n=this._resolveDirectShader(e),r=this._geometry,o=this.tint,s=this.worldAlpha,a=n.uniforms,l=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(o>>16&255)/255*s,a.tint[1]=(o>>8&255)/255*s,a.tint[2]=(255&o)/255*s,a.tint[3]=s,e.shader.bind(n),e.geometry.bind(r,n),e.state.set(this.state);for(var h=0,u=l.length;h<u;h++)this._renderDrawCallDirect(e,r.drawCalls[h])},t.prototype._renderDrawCallDirect=function(e,n){for(var r=n.texArray,o=n.type,s=n.size,a=n.start,l=r.count,h=0;h<l;h++)e.texture.bind(r.elements[h],h);e.geometry.draw(o,s,a)},t.prototype._resolveDirectShader=function(e){var n=this.shader,r=this.pluginName;if(!n){if(!nc[r]){for(var o=e.plugins[r].MAX_TEXTURES,s=new Int32Array(o),a=0;a<o;a++)s[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new Oe.d,default:ue.v.from({uSamplers:s},!0)},h=e.plugins[r]._shader.program;nc[r]=new ue.r(h,l)}n=nc[r]}return n},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var n=e.bounds,r=n.minX,o=n.minY,s=n.maxX,a=n.maxY;this._bounds.addFrame(this.transform,r,o,s,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Object(xn.hex2rgb)(this.tint,Ub),n=0;n<this.batches.length;n++){var r=this.batches[n],o=r._batchRGB,s=(e[0]*o[0]*255<<16)+(e[1]*o[1]*255<<8)+(0|e[2]*o[2]*255);r._tintRGB=(s>>16)+(65280&s)+((255&s)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this._geometry.points,p=this.vertexData,_=0,x=0;x<u.length;x+=2){var w=u[x],A=u[x+1];p[_++]=r*w+s*A+l,p[_++]=a*A+o*w+h}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,i.prototype.destroy.call(this,e)},t.nextRoundedRectBehavior=!1,t._TEMP_POINT=new Oe.g,t}(Cn.b),ym=function(i,t){return(ym=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Ba,ka=new Oe.g,Gb=new Uint16Array([0,1,2,0,2,3]),ci=function(i){function t(e){var n=i.call(this)||this;return n._anchor=new Oe.e(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=gn.b.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||ue.t.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=Gb,n.pluginName="batch",n.isSprite=!0,n._roundPixels=Tr.b.ROUND_PIXELS,n}return function(e,n){function r(){this.constructor=e}ym(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Object(xn.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Object(xn.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this.vertexData,p=e.trim,_=e.orig,x=this._anchor,w=0,A=0,C=0,G=0;if(p?(w=(A=p.x-x._x*_.width)+p.width,C=(G=p.y-x._y*_.height)+p.height):(w=(A=-x._x*_.width)+_.width,C=(G=-x._y*_.height)+_.height),u[0]=r*A+s*G+l,u[1]=a*G+o*A+h,u[2]=r*w+s*G+l,u[3]=a*G+o*w+h,u[4]=r*w+s*C+l,u[5]=a*C+o*w+h,u[6]=r*A+s*C+l,u[7]=a*C+o*A+h,this._roundPixels)for(var K=Tr.b.RESOLUTION,it=0;it<u.length;++it)u[it]=Math.round((u[it]*K|0)/K)}},t.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,n=this.vertexTrimmedData,r=e.orig,o=this._anchor,s=this.transform.worldTransform,a=s.a,l=s.b,h=s.c,u=s.d,p=s.tx,_=s.ty,x=-o._x*r.width,w=x+r.width,A=-o._y*r.height,C=A+r.height;n[0]=a*x+h*A+p,n[1]=u*A+l*x+_,n[2]=a*w+h*A+p,n[3]=u*A+l*w+_,n[4]=a*w+h*C+p,n[5]=u*C+l*w+_,n[6]=a*x+h*C+p,n[7]=u*C+l*x+_},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Cn.a),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Oe.j),e=this._localBoundsRect),this._localBounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,ka);var n=this._texture.orig.width,r=this._texture.orig.height,o=-n*this.anchor.x,s=0;return ka.x>=o&&ka.x<o+n&&(s=-r*this.anchor.y,ka.y>=s&&ka.y<s+r)},t.prototype.destroy=function(e){if(i.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e&&e.texture){var n=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},t.from=function(e,n){return new t(e instanceof ue.t?e:ue.t.from(e,n))},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||ue.t.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Cn.b),xm=function(i,t){return(xm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};(function(i){i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Ba||(Ba={}));var ic={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ba.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Hb=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ws=function(){function i(t){this.styleID=0,this.reset(),oc(this,t,t)}return i.prototype.clone=function(){var t={};return oc(t,this,ic),new i(t)},i.prototype.reset=function(){oc(this,ic,ic)},Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=rc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=rc(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(e,n){if(!Array.isArray(e)||!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=rc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),i.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Hb.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},i}();function bm(i){return typeof i=="number"?Object(xn.hex2string)(i):(typeof i=="string"&&i.indexOf("0x")===0&&(i=i.replace("0x","#")),i)}function rc(i){if(Array.isArray(i)){for(var t=0;t<i.length;++t)i[t]=bm(i[t]);return i}return bm(i)}function oc(i,t,e){for(var n in e)Array.isArray(t[n])?i[n]=t[n].slice():i[n]=t[n]}var $r=function(){function i(t,e,n,r,o,s,a,l,h){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}return i.measureText=function(t,e,n,r){r===void 0&&(r=i._canvas),n=n==null?e.wordWrap:n;var o=e.toFontString(),s=i.measureFont(o);s.fontSize===0&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var a=r.getContext("2d");a.font=o;for(var l=(n?i.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),u=0,p=0;p<l.length;p++){var _=a.measureText(l[p]).width+(l[p].length-1)*e.letterSpacing;h[p]=_,u=Math.max(u,_)}var x=u+e.strokeThickness;e.dropShadow&&(x+=e.dropShadowDistance);var w=e.lineHeight||s.fontSize+e.strokeThickness,A=Math.max(w,s.fontSize+e.strokeThickness)+(l.length-1)*(w+e.leading);return e.dropShadow&&(A+=e.dropShadowDistance),new i(t,e,x,A,l,h,w+e.leading,u,s)},i.wordWrap=function(t,e,n){n===void 0&&(n=i._canvas);for(var r=n.getContext("2d"),o=0,s="",a="",l=Object.create(null),h=e.letterSpacing,u=e.whiteSpace,p=i.collapseSpaces(u),_=i.collapseNewlines(u),x=!p,w=e.wordWrapWidth+h,A=i.tokenize(t),C=0;C<A.length;C++){var G=A[C];if(i.isNewline(G)){if(!_){a+=i.addLine(s),x=!p,s="",o=0;continue}G=" "}if(p){var K=i.isBreakingSpace(G),it=i.isBreakingSpace(s[s.length-1]);if(K&&it)continue}var ft=i.getFromCache(G,h,l,r);if(ft>w)if(s!==""&&(a+=i.addLine(s),s="",o=0),i.canBreakWords(G,e.breakWords))for(var nt=i.wordWrapSplit(G),gt=0;gt<nt.length;gt++){for(var lt=nt[gt],dt=1;nt[gt+dt];){var Ut=nt[gt+dt],Ft=lt[lt.length-1];if(i.canBreakChars(Ft,Ut,G,gt,e.breakWords))break;lt+=Ut,dt++}gt+=lt.length-1;var Et=i.getFromCache(lt,h,l,r);Et+o>w&&(a+=i.addLine(s),x=!1,s="",o=0),s+=lt,o+=Et}else{s.length>0&&(a+=i.addLine(s),s="",o=0);var Mt=C===A.length-1;a+=i.addLine(G,!Mt),x=!1,s="",o=0}else ft+o>w&&(x=!1,a+=i.addLine(s),s="",o=0),(s.length>0||!i.isBreakingSpace(G)||x)&&(s+=G,o+=ft)}return a+=i.addLine(s,!1)},i.addLine=function(t,e){return e===void 0&&(e=!0),t=i.trimRight(t),t=e?t+`
`:t},i.getFromCache=function(t,e,n,r){var o=n[t];if(typeof o!="number"){var s=t.length*e;o=r.measureText(t).width+s,n[t]=o}return o},i.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},i.collapseNewlines=function(t){return t==="normal"},i.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var n=t[e];if(!i.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},i.isNewline=function(t){return typeof t=="string"&&i._newlines.indexOf(t.charCodeAt(0))>=0},i.isBreakingSpace=function(t,e){return typeof t=="string"&&i._breakingSpaces.indexOf(t.charCodeAt(0))>=0},i.tokenize=function(t){var e=[],n="";if(typeof t!="string")return e;for(var r=0;r<t.length;r++){var o=t[r],s=t[r+1];i.isBreakingSpace(o,s)||i.isNewline(o)?(n!==""&&(e.push(n),n=""),e.push(o)):n+=o}return n!==""&&e.push(n),e},i.canBreakWords=function(t,e){return e},i.canBreakChars=function(t,e,n,r,o){return!0},i.wordWrapSplit=function(t){return t.split("")},i.measureFont=function(t){if(i._fonts[t])return i._fonts[t];var e={ascent:0,descent:0,fontSize:0},n=i._canvas,r=i._context;r.font=t;var o=i.METRICS_STRING+i.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width),a=Math.ceil(r.measureText(i.BASELINE_SYMBOL).width),l=Math.ceil(i.HEIGHT_MULTIPLIER*a);a=a*i.BASELINE_MULTIPLIER|0,n.width=s,n.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,a);var h=r.getImageData(0,0,s,l).data,u=h.length,p=4*s,_=0,x=0,w=!1;for(_=0;_<a;++_){for(var A=0;A<p;A+=4)if(h[x+A]!==255){w=!0;break}if(w)break;x+=p}for(e.ascent=a-_,x=u-p,w=!1,_=l;_>a;--_){for(A=0;A<p;A+=4)if(h[x+A]!==255){w=!0;break}if(w)break;x-=p}return e.descent=_-a,e.fontSize=e.ascent+e.descent,i._fonts[t]=e,e},i.clearMetrics=function(t){t===void 0&&(t=""),t?delete i._fonts[t]:i._fonts={}},Object.defineProperty(i,"_canvas",{get:function(){if(!i.__canvas){var t=void 0;try{var e=new OffscreenCanvas(0,0),n=e.getContext("2d");if(n&&n.measureText)return i.__canvas=e,e;t=document.createElement("canvas")}catch{t=document.createElement("canvas")}t.width=t.height=10,i.__canvas=t}return i.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(i,"_context",{get:function(){return i.__context||(i.__context=i._canvas.getContext("2d")),i.__context},enumerable:!1,configurable:!0}),i}();$r._fonts={},$r.METRICS_STRING="|\xC9q\xC5",$r.BASELINE_SYMBOL="M",$r.BASELINE_MULTIPLIER=1.4,$r.HEIGHT_MULTIPLIER=2,$r._newlines=[10,13],$r._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var jb={texture:!0,children:!1,baseTexture:!0},sc=function(i){function t(e,n,r){var o=this,s=!1;r||(r=document.createElement("canvas"),s=!0),r.width=3,r.height=3;var a=ue.t.from(r);return a.orig=new Oe.j,a.trim=new Oe.j,(o=i.call(this,a)||this)._ownCanvas=s,o.canvas=r,o.context=o.canvas.getContext("2d"),o._resolution=Tr.b.RESOLUTION,o._autoResolution=!0,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=e,o.style=n,o.localStyleID=-1,o}return function(e,n){function r(){this.constructor=e}xm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.updateText=function(e){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!e){this._font=this._style.toFontString();var r,o,s=this.context,a=$r.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),l=a.width,h=a.height,u=a.lines,p=a.lineHeight,_=a.lineWidths,x=a.maxLineWidth,w=a.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,l)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var A=n.dropShadow?2:1,C=0;C<A;++C){var G=n.dropShadow&&C===0,K=G?Math.ceil(Math.max(1,h)+2*n.padding):0,it=K*this._resolution;if(G){s.fillStyle="black",s.strokeStyle="black";var ft=n.dropShadowColor,nt=Object(xn.hex2rgb)(typeof ft=="number"?ft:Object(xn.string2hex)(ft)),gt=n.dropShadowBlur*this._resolution,lt=n.dropShadowDistance*this._resolution;s.shadowColor="rgba("+255*nt[0]+","+255*nt[1]+","+255*nt[2]+","+n.dropShadowAlpha+")",s.shadowBlur=gt,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*lt,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*lt+it}else s.fillStyle=this._generateFillStyle(n,u,a),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var dt=(p-w.fontSize)/2;(!t.nextLineHeightBehavior||p-w.fontSize<0)&&(dt=0);for(var Ut=0;Ut<u.length;Ut++)r=n.strokeThickness/2,o=n.strokeThickness/2+Ut*p+w.ascent+dt,n.align==="right"?r+=x-_[Ut]:n.align==="center"&&(r+=(x-_[Ut])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[Ut],r+n.padding,o+n.padding-K,!0),n.fill&&this.drawLetterSpacing(u[Ut],r+n.padding,o+n.padding-K)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,n,r,o){o===void 0&&(o=!1);var s=this._style.letterSpacing,a=t.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(s===0||a)return a&&(this.context.letterSpacing=s,this.context.textLetterSpacing=s),void(o?this.context.strokeText(e,n,r):this.context.fillText(e,n,r));for(var l=n,h=Array.from?Array.from(e):e.split(""),u=this.context.measureText(e).width,p=0,_=0;_<h.length;++_){var x=h[_];o?this.context.strokeText(x,l,r):this.context.fillText(x,l,r);for(var w="",A=_+1;A<h.length;++A)w+=h[A];l+=u-(p=this.context.measureText(w).width)+s,u=p}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var n=Object(xn.trimCanvas)(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}var r=this._texture,o=this._style,s=o.trim?0:o.padding,a=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-2*s,r.orig.height=r._frame.height-2*s,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),i.prototype._render.call(this,e)},t.prototype.updateTransform=function(){this.updateText(!0),i.prototype.updateTransform.call(this)},t.prototype.getBounds=function(e,n){return this.updateText(!0),this._textureID===-1&&(e=!1),i.prototype.getBounds.call(this,e,n)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),i.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,n,r){var o,s=e.fill;if(!Array.isArray(s))return s;if(s.length===1)return s[0];var a=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-a-2*l,u=this.canvas.height/this._resolution-a-2*l,p=s.slice(),_=e.fillGradientStops.slice();if(!_.length)for(var x=p.length+1,w=1;w<x;++w)_.push(w/x);if(p.unshift(s[0]),_.unshift(0),p.push(s[s.length-1]),_.push(1),e.fillGradientType===Ba.LINEAR_VERTICAL){o=this.context.createLinearGradient(h/2,l,h/2,u+l);var A=r.fontProperties.fontSize+e.strokeThickness;for(w=0;w<n.length;w++){var C=r.lineHeight*(w-1)+A,G=r.lineHeight*w,K=G;w>0&&C>G&&(K=(G+C)/2);var it=G+A,ft=r.lineHeight*(w+1),nt=it;w+1<n.length&&ft<it&&(nt=(it+ft)/2);for(var gt=(nt-K)/u,lt=0;lt<p.length;lt++){var dt=0;dt=typeof _[lt]=="number"?_[lt]:lt/p.length;var Ut=Math.min(1,Math.max(0,K/u+dt*gt));Ut=Number(Ut.toFixed(5)),o.addColorStop(Ut,p[lt])}}}else{o=this.context.createLinearGradient(l,u/2,h+l,u/2);var Ft=p.length+1,Et=1;for(w=0;w<p.length;w++){var Mt=void 0;Mt=typeof _[w]=="number"?_[w]:Et/Ft,o.addColorStop(Mt,p[w]),Et++}}return o},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},jb,e),i.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof Ws?e:new Ws(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t.experimentalLetterSpacing=!1,t}(ci);/*!
 * @pixi/prepare - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Tr.b.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Tm=function(i,t){return(Tm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},zb=function(){function i(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return i.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},i.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},i}();function Vb(i,t){var e=!1;if(i&&i._textures&&i._textures.length){for(var n=0;n<i._textures.length;n++)if(i._textures[n]instanceof ue.t){var r=i._textures[n].baseTexture;t.indexOf(r)===-1&&(t.push(r),e=!0)}}return e}function Wb(i,t){if(i.baseTexture instanceof ue.c){var e=i.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function Xb(i,t){if(i._texture&&i._texture instanceof ue.t){var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function Yb(i,t){return t instanceof sc&&(t.updateText(!0),!0)}function qb(i,t){if(t instanceof Ws){var e=t.toFontString();return $r.measureFont(e),!0}return!1}function Jb(i,t){if(i instanceof sc){t.indexOf(i.style)===-1&&t.push(i.style),t.indexOf(i)===-1&&t.push(i);var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function Zb(i,t){return i instanceof Ws&&(t.indexOf(i)===-1&&t.push(i),!0)}var wm=function(){function i(t){var e=this;this.limiter=new zb(Tr.b.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Jb),this.registerFindHook(Zb),this.registerFindHook(Vb),this.registerFindHook(Wb),this.registerFindHook(Xb),this.registerUploadHook(Yb),this.registerUploadHook(qb)}return i.prototype.upload=function(t,e){typeof t=="function"&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,nr.a.system.addOnce(this.tick,this,nr.c.UTILITY))):e&&e()},i.prototype.tick=function(){setTimeout(this.delayedTick,0)},i.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed){for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)nr.a.system.addOnce(this.tick,this,nr.c.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);for(this.completes.length=0,n=0,r=o.length;n<r;n++)o[n]()}},i.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},i.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},i.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Cn.b)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},i.prototype.destroy=function(){this.ticking&&nr.a.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},i}();function Sm(i,t){return t instanceof ue.c&&(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0)}function Kb(i,t){if(!(t instanceof $i))return!1;var e=t.geometry;t.finishPoly(),e.updateBatches();for(var n=e.batches,r=0;r<n.length;r++){var o=n[r].style.texture;o&&Sm(i,o.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function $b(i,t){return i instanceof $i&&(t.push(i),!0)}var Qb=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook($b),n.registerUploadHook(Sm),n.registerUploadHook(Kb),n}return function(e,n){function r(){this.constructor=e}Tm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(wm),Em=function(){function i(t,e,n){n===void 0&&(n=null),this._texture=t instanceof ue.t?t:null,this.baseTexture=t instanceof ue.c?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i.prototype._updateResolution=function(t){t===void 0&&(t=null);var e=this.data.meta.scale,n=Object(xn.getResolutionOfUrl)(t,null);return n===null&&(n=e!==void 0?parseFloat(e):1),n!==1&&this.baseTexture.setResolution(n),n},i.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=i.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},i.prototype._processFrames=function(t){for(var e=t,n=i.BATCH_SIZE;e-t<n&&e<this._frameKeys.length;){var r=this._frameKeys[e],o=this._frames[r],s=o.frame;if(s){var a=null,l=null,h=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new Oe.j(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a=o.rotated?new Oe.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new Oe.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(l=new Oe.j(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new ue.t(this.baseTexture,a,u,l,o.rotated?2:0,o.anchor),ue.t.addToCache(this.textures[r],r)}e++}},i.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},i.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},i.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*i.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*i.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},i.prototype.destroy=function(t){var e;for(var n in t===void 0&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},i.BATCH_SIZE=1e3,i}(),tT=function(){function i(){}return i.use=function(t,e){var n,r,o=this,s=t.name+"_image";if(t.data&&t.type===Mi.TYPE.JSON&&t.data.frames&&!o.resources[s]){var a=(r=(n=t.data)===null||n===void 0?void 0:n.meta)===null||r===void 0?void 0:r.related_multi_packs;if(Array.isArray(a))for(var l=function(x){if(typeof x!="string")return"continue";var w=x.replace(".json",""),A=xn.url.resolve(t.url.replace(o.baseUrl,""),x);if(o.resources[w]||Object.values(o.resources).some(function(G){return xn.url.format(xn.url.parse(G.url))===A}))return"continue";var C={crossOrigin:t.crossOrigin,loadType:Mi.LOAD_TYPE.XHR,xhrType:Mi.XHR_RESPONSE_TYPE.JSON,parentResource:t,metadata:t.metadata};o.add(w,A,C)},h=0,u=a;h<u.length;h++)l(u[h]);var p={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},_=i.getResourcePath(t,o.baseUrl);o.add(s,_,p,function(x){if(x.error)e(x.error);else{var w=new Em(x.texture,t.data,t.url);w.parse(function(){t.spritesheet=w,t.textures=w.textures,e()})}})}else e()},i.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:xn.url.resolve(t.url.replace(e,""),t.data.meta.image)},i}(),Am=function(i,t){return(Am=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Mm(i,t){function e(){this.constructor=i}Am(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Ua=new Oe.g,eT=function(i){function t(e,n,r){n===void 0&&(n=100),r===void 0&&(r=100);var o=i.call(this,e)||this;return o.tileTransform=new Oe.m,o._width=n,o._height=r,o.uvMatrix=o.texture.uvMatrix||new ue.u(e),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return Mm(t,i),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var n=this._texture;n&&n.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,n=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),o=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,n,r,o)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Oe.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Ua);var n=this._width,r=this._height,o=-n*this.anchor._x;if(Ua.x>=o&&Ua.x<o+n){var s=-r*this.anchor._y;if(Ua.y>=s&&Ua.y<s+r)return!0}return!1},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,n){return new t(e instanceof ue.t?e:ue.t.from(e,n),n.width,n.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(ci),Cm=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,th=new Oe.d,nT=function(i){function t(e){var n=i.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new ue.o,n.state=ue.s.for2d(),n}return Mm(t,i),t.prototype.contextChange=function(){var e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=ue.r.from(Cm,`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,n),this.shader=e.context.webGLVersion>1?ue.r.from(`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,n):ue.r.from(Cm,`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,n)},t.prototype.render=function(e){var n=this.renderer,r=this.quad,o=r.vertices;o[0]=o[6]=e._width*-e.anchor.x,o[1]=o[3]=e._height*-e.anchor.y,o[2]=o[4]=e._width*(1-e.anchor.x),o[5]=o[7]=e._height*(1-e.anchor.y);var s=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;(o=r.uvs)[0]=o[6]=-s,o[1]=o[3]=-a,o[2]=o[4]=1-s,o[5]=o[7]=1-a,r.invalidate();var l=e._texture,h=l.baseTexture,u=e.tileTransform.localTransform,p=e.uvMatrix,_=h.isPowerOfTwo&&l.frame.width===h.width&&l.frame.height===h.height;_&&(h._glTextures[n.CONTEXT_UID]?_=h.wrapMode!==gn.s.CLAMP:h.wrapMode===gn.s.CLAMP&&(h.wrapMode=gn.s.REPEAT));var x=_?this.simpleShader:this.shader,w=l.width,A=l.height,C=e._width,G=e._height;th.set(u.a*w/C,u.b*w/G,u.c*A/C,u.d*A/G,u.tx/C,u.ty/G),th.invert(),_?th.prepend(p.mapCoord):(x.uniforms.uMapCoord=p.mapCoord.toArray(!0),x.uniforms.uClampFrame=p.uClampFrame,x.uniforms.uClampOffset=p.uClampOffset),x.uniforms.uTransform=th.toArray(!0),x.uniforms.uColor=Object(xn.premultiplyTintToRgba)(e.tint,e.worldAlpha,x.uniforms.uColor,h.alphaMode),x.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),x.uniforms.uSampler=l,n.shader.bind(x),n.geometry.bind(r),this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(ue.m),Xs=v(8),Rm=function(i,t){return(Rm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},eh=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},iT=function(){function i(){}return i.test=function(t){return typeof t=="string"&&t.indexOf("info face=")===0},i.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in e){var o=e[r].match(/^[a-z]+/gm)[0],s=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in s){var h=s[l].split("="),u=h[0],p=h[1].replace(/"/gm,""),_=parseFloat(p),x=isNaN(_)?p:_;a[u]=x}n[o].push(a)}var w=new eh;return n.info.forEach(function(A){return w.info.push({face:A.face,size:parseInt(A.size,10)})}),n.common.forEach(function(A){return w.common.push({lineHeight:parseInt(A.lineHeight,10)})}),n.page.forEach(function(A){return w.page.push({id:parseInt(A.id,10),file:A.file})}),n.char.forEach(function(A){return w.char.push({id:parseInt(A.id,10),page:parseInt(A.page,10),x:parseInt(A.x,10),y:parseInt(A.y,10),width:parseInt(A.width,10),height:parseInt(A.height,10),xoffset:parseInt(A.xoffset,10),yoffset:parseInt(A.yoffset,10),xadvance:parseInt(A.xadvance,10)})}),n.kerning.forEach(function(A){return w.kerning.push({first:parseInt(A.first,10),second:parseInt(A.second,10),amount:parseInt(A.amount,10)})}),n.distanceField.forEach(function(A){return w.distanceField.push({distanceRange:parseInt(A.distanceRange,10),fieldType:A.fieldType})}),w},i}(),ac=function(){function i(){}return i.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},i.parse=function(t){for(var e=new eh,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField"),h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<r.length;h++)e.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(h=0;h<o.length;h++)e.page.push({id:parseInt(o[h].getAttribute("id"),10)||0,file:o[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<a.length;h++)e.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(h=0;h<l.length;h++)e.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return e},i}(),rT=function(){function i(){}return i.test=function(t){if(typeof t=="string"&&t.indexOf("<font>")>-1){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return ac.test(e)}return!1},i.parse=function(t){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return ac.parse(e)},i}(),lc=[iT,ac,rT];function Im(i){for(var t=0;t<lc.length;t++)if(lc[t].test(i))return lc[t];return null}function oT(i,t,e,n,r,o,s){var a=e.text,l=e.fontProperties;t.translate(n,r),t.scale(o,o);var h=s.strokeThickness/2,u=-s.strokeThickness/2;if(t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=function(A,C,G,K,it,ft){var nt,gt=G.fill;if(!Array.isArray(gt))return gt;if(gt.length===1)return gt[0];var lt=G.dropShadow?G.dropShadowDistance:0,dt=G.padding||0,Ut=A.width/K-lt-2*dt,Ft=A.height/K-lt-2*dt,Et=gt.slice(),Mt=G.fillGradientStops.slice();if(!Mt.length)for(var Lt=Et.length+1,Pt=1;Pt<Lt;++Pt)Mt.push(Pt/Lt);if(Et.unshift(gt[0]),Mt.unshift(0),Et.push(gt[gt.length-1]),Mt.push(1),G.fillGradientType===Ba.LINEAR_VERTICAL){nt=C.createLinearGradient(Ut/2,dt,Ut/2,Ft+dt);var ee=0,$t=(ft.fontProperties.fontSize+G.strokeThickness)/Ft;for(Pt=0;Pt<it.length;Pt++)for(var zt=ft.lineHeight*Pt,Xt=0;Xt<Et.length;Xt++){var pe=zt/Ft+(typeof Mt[Xt]=="number"?Mt[Xt]:Xt/Et.length)*$t,be=Math.max(ee,pe);be=Math.min(be,1),nt.addColorStop(be,Et[Xt]),ee=be}}else{nt=C.createLinearGradient(dt,Ft/2,Ut+dt,Ft/2);var Pe=Et.length+1,Ct=1;for(Pt=0;Pt<Et.length;Pt++){var Bt=void 0;Bt=typeof Mt[Pt]=="number"?Mt[Pt]:Ct/Pe,nt.addColorStop(Bt,Et[Pt]),Ct++}}return nt}(i,t,s,o,[a],e),t.strokeStyle=s.stroke,s.dropShadow){var p=s.dropShadowColor,_=Object(xn.hex2rgb)(typeof p=="number"?p:Object(xn.string2hex)(p)),x=s.dropShadowBlur*o,w=s.dropShadowDistance*o;t.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+s.dropShadowAlpha+")",t.shadowBlur=x,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*w,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*w}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;s.stroke&&s.strokeThickness&&t.strokeText(a,h,u+e.lineHeight-l.descent),s.fill&&t.fillText(a,h,u+e.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Pm(i){return Array.from?Array.from(i):i.split("")}function nh(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}var Ys=function(){function i(t,e,n){var r,o,s=t.info[0],a=t.common[0],l=t.page[0],h=t.distanceField[0],u=Object(xn.getResolutionOfUrl)(l.file),p={};this._ownsTextures=n,this.font=s.face,this.size=s.size,this.lineHeight=a.lineHeight/u,this.chars={},this.pageTextures=p;for(var _=0;_<t.page.length;_++){var x=t.page[_],w=x.id,A=x.file;p[w]=e instanceof Array?e[_]:e[A],(h==null?void 0:h.fieldType)&&h.fieldType!=="none"&&(p[w].baseTexture.alphaMode=gn.a.NO_PREMULTIPLIED_ALPHA)}for(_=0;_<t.char.length;_++){var C=t.char[_],G=(w=C.id,C.page),K=t.char[_],it=K.x,ft=K.y,nt=K.width,gt=K.height,lt=K.xoffset,dt=K.yoffset,Ut=K.xadvance;it/=u,ft/=u,nt/=u,gt/=u,lt/=u,dt/=u,Ut/=u;var Ft=new Oe.j(it+p[G].frame.x/u,ft+p[G].frame.y/u,nt,gt);this.chars[w]={xOffset:lt,yOffset:dt,xAdvance:Ut,kerning:{},texture:new ue.t(p[G].baseTexture,Ft),page:G}}for(_=0;_<t.kerning.length;_++){var Et=t.kerning[_],Mt=Et.first,Lt=Et.second,Pt=Et.amount;Mt/=u,Lt/=u,Pt/=u,this.chars[Lt]&&(this.chars[Lt].kerning[Mt]=Pt)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=(o=(r=h==null?void 0:h.fieldType)===null||r===void 0?void 0:r.toLowerCase())!==null&&o!==void 0?o:"none"}return i.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},i.install=function(t,e,n){var r;if(t instanceof eh)r=t;else{var o=Im(t);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(t)}e instanceof ue.t&&(e=[e]);var s=new i(r,e,n);return i.available[s.font]=s,s},i.uninstall=function(t){var e=i.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete i.available[t]},i.from=function(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},i.defaultOptions,n),o=r.chars,s=r.padding,a=r.resolution,l=r.textureWidth,h=r.textureHeight,u=function(pe){typeof pe=="string"&&(pe=[pe]);for(var be=[],Pe=0,Ct=pe.length;Pe<Ct;Pe++){var Bt=pe[Pe];if(Array.isArray(Bt)){if(Bt.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+Bt.length+".");var ve=Bt[0].charCodeAt(0),le=Bt[1].charCodeAt(0);if(le<ve)throw new Error("[BitmapFont]: Invalid character range.");for(var se=ve,Ie=le;se<=Ie;se++)be.push(String.fromCharCode(se))}else be.push.apply(be,Pm(Bt))}if(be.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return be}(o),p=e instanceof Ws?e:new Ws(e),_=l,x=new eh;x.info[0]={face:p.fontFamily,size:p.fontSize},x.common[0]={lineHeight:p.fontSize};for(var w,A,C,G=0,K=0,it=0,ft=[],nt=0;nt<u.length;nt++){w||((w=document.createElement("canvas")).width=l,w.height=h,A=w.getContext("2d"),C=new ue.c(w,{resolution:a}),ft.push(new ue.t(C)),x.page.push({id:ft.length-1,file:""}));var gt=$r.measureText(u[nt],p,!1,w),lt=gt.width,dt=Math.ceil(gt.height),Ut=Math.ceil((p.fontStyle==="italic"?2:1)*lt);if(K>=h-dt*a){if(K===0)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+p.fontSize+"px fonts");--nt,w=null,A=null,C=null,K=0,G=0,it=0}else if(it=Math.max(dt+gt.fontProperties.descent,it),Ut*a+G>=_)--nt,K+=it*a,K=Math.ceil(K),G=0,it=0;else{oT(w,A,gt,G,K,a,p);var Ft=nh(gt.text);x.char.push({id:Ft,page:ft.length-1,x:G/a,y:K/a,width:Ut,height:dt,xoffset:0,yoffset:0,xadvance:Math.ceil(lt-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0))}),G+=(Ut+2*s)*a,G=Math.ceil(G)}}nt=0;for(var Et=u.length;nt<Et;nt++)for(var Mt=u[nt],Lt=0;Lt<Et;Lt++){var Pt=u[Lt],ee=A.measureText(Mt).width,$t=A.measureText(Pt).width,zt=A.measureText(Mt+Pt).width-(ee+$t);zt&&x.kerning.push({first:nh(Mt),second:nh(Pt),amount:zt})}var Xt=new i(x,ft,!0);return i.available[t]!==void 0&&i.uninstall(t),i.available[t]=Xt,Xt},i.ALPHA=[["a","z"],["A","Z"]," "],i.NUMERIC=[["0","9"]],i.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],i.ASCII=[[" ","~"]],i.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:i.ALPHANUMERIC},i.available={},i}(),sT=[],aT=[],Om=[],lT=(function(i){function t(e,n){n===void 0&&(n={});var r=i.call(this)||this;r._tint=16777215;var o=Object.assign({},t.styleDefaults,n),s=o.align,a=o.tint,l=o.maxWidth,h=o.letterSpacing,u=o.fontName,p=o.fontSize;if(!Ys.available[u])throw new Error('Missing BitmapFont "'+u+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=s,r._tint=a,r._fontName=u,r._fontSize=p||Ys.available[u].size,r.text=e,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=h,r._anchor=new Oe.e(function(){r.dirty=!0},r,0,0),r._roundPixels=Tr.b.ROUND_PIXELS,r.dirty=!0,r._resolution=Tr.b.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}(function(e,n){function r(){this.constructor=e}Rm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)})(t,i),t.prototype.updateText=function(){for(var e,n=Ys.available[this._fontName],r=this._fontSize/n.size,o=new Oe.g,s=[],a=[],l=[],h=Pm(this._text.replace(/(?:\r\n|\r)/g,`
`)||" "),u=this._maxWidth*n.size/this._fontSize,p=n.distanceFieldType==="none"?sT:aT,_=null,x=0,w=0,A=0,C=-1,G=0,K=0,it=0,ft=0,nt=0;nt<h.length;nt++){var gt=nh(se=h[nt]);if(/(?:\s)/.test(se)&&(C=nt,G=x,ft++),se!=="\r"&&se!==`
`){var lt=n.chars[gt];if(lt){_&&lt.kerning[_]&&(o.x+=lt.kerning[_]);var dt=Om.pop()||{texture:ue.t.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Oe.g};dt.texture=lt.texture,dt.line=A,dt.charCode=gt,dt.position.x=o.x+lt.xOffset+this._letterSpacing/2,dt.position.y=o.y+lt.yOffset,dt.prevSpaces=ft,s.push(dt),x=dt.position.x+Math.max(lt.xAdvance,lt.texture.orig.width),o.x+=lt.xAdvance+this._letterSpacing,it=Math.max(it,lt.yOffset+lt.texture.height),_=gt,C!==-1&&u>0&&o.x>u&&(++K,Object(xn.removeItems)(s,1+C-K,1+nt-C),nt=C,C=-1,a.push(G),l.push(s.length>0?s[s.length-1].prevSpaces:0),w=Math.max(w,G),A++,o.x=0,o.y+=n.lineHeight,_=null,ft=0)}}else a.push(x),l.push(-1),w=Math.max(w,x),++A,++K,o.x=0,o.y+=n.lineHeight,_=null,ft=0}var Ut=h[h.length-1];Ut!=="\r"&&Ut!==`
`&&(/(?:\s)/.test(Ut)&&(x=G),a.push(x),w=Math.max(w,x),l.push(-1));var Ft=[];for(nt=0;nt<=A;nt++){var Et=0;this._align==="right"?Et=w-a[nt]:this._align==="center"?Et=(w-a[nt])/2:this._align==="justify"&&(Et=l[nt]<0?0:(w-a[nt])/l[nt]),Ft.push(Et)}var Mt=s.length,Lt={},Pt=[],ee=this._activePagesMeshData;for(nt=0;nt<ee.length;nt++)p.push(ee[nt]);for(nt=0;nt<Mt;nt++){var $t=(De=s[nt].texture).baseTexture.uid;if(!Lt[$t]){if(!(ye=p.pop())){var zt=new Xs.b,Xt=void 0,pe=void 0;n.distanceFieldType==="none"?(Xt=new Xs.c(ue.t.EMPTY),pe=gn.b.NORMAL):(Xt=new Xs.c(ue.t.EMPTY,{program:ue.n.from(`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`),uniforms:{uFWidth:0}}),pe=gn.b.NORMAL_NPM);var be=new Xs.a(zt,Xt);be.blendMode=pe,ye={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:be,vertices:null,uvs:null,indices:null}}ye.index=0,ye.indexCount=0,ye.vertexCount=0,ye.uvsCount=0,ye.total=0;var Pe=this._textureCache;Pe[$t]=Pe[$t]||new ue.t(De.baseTexture),ye.mesh.texture=Pe[$t],ye.mesh.tint=this._tint,Pt.push(ye),Lt[$t]=ye}Lt[$t].total++}for(nt=0;nt<ee.length;nt++)Pt.indexOf(ee[nt])===-1&&this.removeChild(ee[nt].mesh);for(nt=0;nt<Pt.length;nt++)Pt[nt].mesh.parent!==this&&this.addChild(Pt[nt].mesh);for(var nt in this._activePagesMeshData=Pt,Lt){var Ct=(ye=Lt[nt]).total;if(!(((e=ye.indices)===null||e===void 0?void 0:e.length)>6*Ct)||ye.vertices.length<2*Xs.a.BATCHABLE_SIZE)ye.vertices=new Float32Array(8*Ct),ye.uvs=new Float32Array(8*Ct),ye.indices=new Uint16Array(6*Ct);else for(var Bt=ye.total,ve=ye.vertices,le=4*Bt*2;le<ve.length;le++)ve[le]=0;ye.mesh.size=6*Ct}for(nt=0;nt<Mt;nt++){var se,Ie=(se=s[nt]).position.x+Ft[se.line]*(this._align==="justify"?se.prevSpaces:1);this._roundPixels&&(Ie=Math.round(Ie));var De,ce=Ie*r,Tt=se.position.y*r,jt=Lt[(De=se.texture).baseTexture.uid],ie=De.frame,ae=De._uvs,qt=jt.index++;jt.indices[6*qt+0]=0+4*qt,jt.indices[6*qt+1]=1+4*qt,jt.indices[6*qt+2]=2+4*qt,jt.indices[6*qt+3]=0+4*qt,jt.indices[6*qt+4]=2+4*qt,jt.indices[6*qt+5]=3+4*qt,jt.vertices[8*qt+0]=ce,jt.vertices[8*qt+1]=Tt,jt.vertices[8*qt+2]=ce+ie.width*r,jt.vertices[8*qt+3]=Tt,jt.vertices[8*qt+4]=ce+ie.width*r,jt.vertices[8*qt+5]=Tt+ie.height*r,jt.vertices[8*qt+6]=ce,jt.vertices[8*qt+7]=Tt+ie.height*r,jt.uvs[8*qt+0]=ae.x0,jt.uvs[8*qt+1]=ae.y0,jt.uvs[8*qt+2]=ae.x1,jt.uvs[8*qt+3]=ae.y1,jt.uvs[8*qt+4]=ae.x2,jt.uvs[8*qt+5]=ae.y2,jt.uvs[8*qt+6]=ae.x3,jt.uvs[8*qt+7]=ae.y3}for(var nt in this._textWidth=w*r,this._textHeight=(o.y+n.lineHeight)*r,Lt){var ye=Lt[nt];if(this.anchor.x!==0||this.anchor.y!==0)for(var nn=0,on=this._textWidth*this.anchor.x,rn=this._textHeight*this.anchor.y,Sn=0;Sn<ye.total;Sn++)ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn;this._maxLineHeight=it*r;var Ci=ye.mesh.geometry.getBuffer("aVertexPosition"),Jn=ye.mesh.geometry.getBuffer("aTextureCoord"),mr=ye.mesh.geometry.getIndex();Ci.data=ye.vertices,Jn.data=ye.uvs,mr.data=ye.indices,Ci.update(),Jn.update(),mr.update()}for(nt=0;nt<s.length;nt++)Om.push(s[nt])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=Ys.available[this._fontName],r=n.distanceFieldRange,o=n.distanceFieldType,s=n.size;if(o!=="none")for(var a=this.worldTransform,l=a.a,h=a.b,u=a.c,p=a.d,_=Math.sqrt(l*l+h*h),x=Math.sqrt(u*u+p*p),w=(Math.abs(_)+Math.abs(x))/2,A=this._fontSize/s,C=0,G=this._activePagesMeshData;C<G.length;C++)G[C].mesh.shader.uniforms.uFWidth=w*r*A*this._resolution;i.prototype._render.call(this,e)},t.prototype.getLocalBounds=function(){return this.validate(),i.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Ys.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){var n=this._textureCache;for(var r in n)n[r].destroy(),delete n[r];this._textureCache=null,i.prototype.destroy.call(this,e)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(Cn.b),function(){function i(){}return i.add=function(){Mi.setExtensionXhrType("fnt",Mi.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){var n=Im(t.data);if(n)for(var r=i.getBaseUrl(this,t),o=n.parse(t.data),s={},a=function(A){s[A.metadata.pageFile]=A.texture,Object.keys(s).length===o.page.length&&(t.bitmapFont=Ys.install(o,s,!0),e())},l=0;l<o.page.length;++l){var h=o.page[l].file,u=r+h,p=!1;for(var _ in this.resources){var x=this.resources[_];if(x.url===u){x.metadata.pageFile=h,x.texture?a(x):x.onAfterMiddleware.add(a),p=!0;break}}if(!p){var w={crossOrigin:t.crossOrigin,loadType:Mi.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(u,w,a)}}else e()},i.getBaseUrl=function(t,e){var n=e.isDataUrl?"":i.dirname(e.url);return e.isDataUrl&&(n==="."&&(n=""),t.baseUrl&&n&&t.baseUrl.charAt(t.baseUrl.length-1)==="/"&&(n+="/")),(n=n.replace(t.baseUrl,""))&&n.charAt(n.length-1)!=="/"&&(n+="/"),n},i.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":e===""?"/":e},i}()),Lm=function(i,t){return(Lm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},hT=function(i){function t(e){e===void 0&&(e=1);var n=i.call(this,ue.A,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return n.alpha=e,n}return function(e,n){function r(){this.constructor=e}Lm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ue.k),Nm=function(i,t){return(Nm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Dm(i,t){function e(){this.constructor=i}Nm(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Fm,Bm,km,Um,Gm,Hm,jm,zm,Vm,Wm,Xm,Ym,qm,Ga,Jm,Zm,Km,$m,Qm,uT={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},cT=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(Fm||(Fm={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(Bm||(Bm={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(km||(km={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Um||(Um={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Gm||(Gm={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Hm||(Hm={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(jm||(jm={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(zm||(zm={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Vm||(Vm={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Wm||(Wm={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Xm||(Xm={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(Ym||(Ym={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(qm||(qm={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Ga||(Ga={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Jm||(Jm={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Zm||(Zm={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Km||(Km={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}($m||($m={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Qm||(Qm={}));var hc=function(i){function t(e,n,r,o,s){n===void 0&&(n=8),r===void 0&&(r=4),o===void 0&&(o=Tr.b.FILTER_RESOLUTION),s===void 0&&(s=5);var a=this,l=function(u,p){var _,x=Math.ceil(u/2),w=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,A="";_=p?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var C=0;C<u;C++){var G=_.replace("%index%",C.toString());A+=G=G.replace("%sampleIndex%",C-(x-1)+".0"),A+=`
`}return w=(w=w.replace("%blur%",A)).replace("%size%",u.toString())}(s,e),h=function(u){for(var p,_=uT[u],x=_.length,w=cT,A="",C=0;C<u;C++){var G="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",C.toString());p=C,C>=x&&(p=u-C-1),A+=G=G.replace("%value%",_[p].toString()),A+=`
`}return w=(w=w.replace("%blur%",A)).replace("%size%",u.toString())}(s);return(a=i.call(this,l,h)||this).horizontal=e,a.resolution=o,a._quality=0,a.quality=r,a.blur=n,a}return Dm(t,i),t.prototype.apply=function(e,n,r,o){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/n.width):this.uniforms.strength=1/r.height*(r.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,r,o);else{var s=e.getFilterTexture(),a=e.renderer,l=n,h=s;this.state.blend=!1,e.applyFilter(this,l,h,Ga.CLEAR);for(var u=1;u<this.passes-1;u++){e.bindAndClear(l,Ga.BLIT),this.uniforms.uSampler=h;var p=h;h=l,l=p,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,r,o),e.returnFilterTexture(s)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(ue.k),dT=function(i){function t(e,n,r,o){e===void 0&&(e=8),n===void 0&&(n=4),r===void 0&&(r=Tr.b.FILTER_RESOLUTION),o===void 0&&(o=5);var s=i.call(this)||this;return s.blurXFilter=new hc(!0,e,n,r,o),s.blurYFilter=new hc(!1,e,n,r,o),s.resolution=r,s.quality=n,s.blur=e,s.repeatEdgePixels=!1,s}return Dm(t,i),t.prototype.apply=function(e,n,r,o){var s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){var l=e.getFilterTexture();this.blurXFilter.apply(e,n,l,Ga.CLEAR),this.blurYFilter.apply(e,l,r,o),e.returnFilterTexture(l)}else a?this.blurYFilter.apply(e,n,r,o):this.blurXFilter.apply(e,n,r,o)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),t}(ue.k),t0=function(i,t){return(t0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},uc=function(i){function t(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=i.call(this,ue.z,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,n)||this).alpha=1,e}return function(e,n){function r(){this.constructor=e}t0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._loadMatrix=function(e,n){n===void 0&&(n=!1);var r=e;n&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e},t.prototype._colorMatrix=function(e){var n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},t.prototype.brightness=function(e,n){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.tint=function(e,n){var r=[(e>>16&255)/255,0,0,0,0,0,(e>>8&255)/255,0,0,0,0,0,(255&e)/255,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.greyscale=function(e,n){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,n){e=(e||0)/180*Math.PI;var r=Math.cos(e),o=Math.sin(e),s=1/3,a=(0,Math.sqrt)(s),l=[r+(1-r)*s,s*(1-r)-a*o,s*(1-r)+a*o,0,0,s*(1-r)+a*o,r+s*(1-r),s*(1-r)-a*o,0,0,s*(1-r)-a*o,s*(1-r)+a*o,r+s*(1-r),0,0,0,0,0,1,0];this._loadMatrix(l,n)},t.prototype.contrast=function(e,n){var r=(e||0)+1,o=-.5*(r-1),s=[r,0,0,0,o,0,r,0,0,o,0,0,r,0,o,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.saturate=function(e,n){e===void 0&&(e=0);var r=2*e/3+1,o=-.5*(r-1),s=[r,o,o,0,0,o,r,o,0,0,o,o,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,n,r,o,s){var a=((r=r||16770432)>>16&255)/255,l=(r>>8&255)/255,h=(255&r)/255,u=((o=o||3375104)>>16&255)/255,p=(o>>8&255)/255,_=(255&o)/255,x=[.3,.59,.11,0,0,a,l,h,e=e||.2,0,u,p,_,n=n||.15,0,a-u,l-p,h-_,0,0];this._loadMatrix(x,s)},t.prototype.night=function(e,n){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.predator=function(e,n){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ue.k);uc.prototype.grayscale=uc.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var e0=function(i,t){return(e0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},pT=function(i){function t(e,n){var r=this,o=new Oe.d;return e.renderable=!1,(r=i.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:e._texture,filterMatrix:o,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=o,n==null&&(n=20),r.scale=new Oe.g(n,n),r}return function(e,n){function r(){this.constructor=e}e0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.apply=function(e,n,r,o){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var s=this.maskSprite.worldTransform,a=Math.sqrt(s.a*s.a+s.b*s.b),l=Math.sqrt(s.c*s.c+s.d*s.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=s.a/a,this.uniforms.rotation[1]=s.b/a,this.uniforms.rotation[2]=s.c/l,this.uniforms.rotation[3]=s.d/l),e.applyFilter(this,n,r,o)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),t}(ue.k),n0=function(i,t){return(n0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},fT=function(i){function t(){return i.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(e,n){function r(){this.constructor=e}n0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(ue.k),i0=function(i,t){return(i0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},r0,o0,s0,a0,l0,h0,u0,c0,d0,p0,f0,m0,g0,v0,_0,y0,x0,cc,b0,mT=function(i){function t(e,n){e===void 0&&(e=.5),n===void 0&&(n=Math.random());var r=i.call(this,ue.z,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=n,r}return function(e,n){function r(){this.constructor=e}i0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t}(ue.k);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(r0||(r0={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(o0||(o0={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(s0||(s0={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(a0||(a0={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(l0||(l0={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(h0||(h0={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(u0||(u0={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(c0||(c0={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(d0||(d0={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(p0||(p0={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(f0||(f0={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(m0||(m0={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(g0||(g0={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(v0||(v0={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(_0||(_0={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(y0||(y0={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(x0||(x0={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(cc||(cc={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(b0||(b0={}));var T0=new Oe.d;Cn.c.prototype._cacheAsBitmap=!1,Cn.c.prototype._cacheData=null,Cn.c.prototype._cacheAsBitmapResolution=null,Cn.c.prototype._cacheAsBitmapMultisample=cc.NONE;var gT=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Cn.c.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(i){var t;this._cacheAsBitmap!==i&&(this._cacheAsBitmap=i,i?(this._cacheData||(this._cacheData=new gT),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),Cn.c.prototype._renderCached=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))},Cn.c.prototype._initCachedDisplayObject=function(i){var t;if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,i.batch.flush();var n=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;n.pad(r)}n.ceil(Tr.b.RESOLUTION);var o=i.renderTexture.current,s=i.renderTexture.sourceFrame.clone(),a=i.renderTexture.destinationFrame.clone(),l=i.projection.transform,h=ue.p.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||i.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:i.multisample}),u="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=u,ue.c.addToCache(h.baseTexture,u),ue.t.addToCache(h,u);var p=this.transform.localTransform.copyTo(T0).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:h,clear:!0,transform:p,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=l,i.renderTexture.bind(o,s,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var _=new ci(h);_.transform.worldTransform=this.transform.worldTransform,_.anchor.x=-n.x/n.width,_.anchor.y=-n.y/n.height,_.alpha=e,_._bounds=this._bounds,this._cacheData.sprite=_,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=_.containsPoint.bind(_)}},Cn.c.prototype._renderCachedCanvas=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))},Cn.c.prototype._initCachedDisplayObjectCanvas=function(i){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var n=i.context,r=i._projTransform;t.ceil(Tr.b.RESOLUTION);var o=ue.p.create({width:t.width,height:t.height}),s="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=s,ue.c.addToCache(o.baseTexture,s),ue.t.addToCache(o,s);var a=T0;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),i.context=n,i._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var l=new ci(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},Cn.c.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Cn.c.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Cn.c.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ue.c.removeFromCache(this._cacheData.textureCacheId),ue.t.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Cn.c.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)},Cn.c.prototype.name=null,Cn.b.prototype.getChildByName=function(i,t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].name===i)return this.children[e];if(t){for(e=0,n=this.children.length;e<n;e++)if(this.children[e].getChildByName){var r=this.children[e].getChildByName(i,!0);if(r)return r}}return null},Cn.c.prototype.getGlobalPosition=function(i,t){return i===void 0&&(i=new Oe.g),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var vT=v(16),w0=(v(12),function(i,t){return(w0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)}),ih=function(i){function t(e,n){n===void 0&&(n=!0);var r=i.call(this,e[0]instanceof ue.t?e[0]:e[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=n,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=e,r}return function(e,n){function r(){this.constructor=e}w0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(nr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(nr.a.shared.add(this.update,this,nr.c.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var n=this.animationSpeed*e,r=this.currentFrame;if(this._durations!==null){var o=this._currentTime%1*this._durations[this.currentFrame];for(o+=n/60*1e3;o<0;)this._currentTime--,o+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);o>=this._durations[this.currentFrame];)o-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=o/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(e){this.stop(),i.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ue.t.from(e[r]));return new t(n)},t.fromImages=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ue.t.from(e[r]));return new t(n)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof ue.t)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(nr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(nr.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),t}(ci);/*!
 * pixi.js - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ue.q.registerPlugin("accessibility",nf),ue.q.registerPlugin("extract",J1),ue.q.registerPlugin("interaction",sf),ue.q.registerPlugin("particle",Ib),ue.q.registerPlugin("prepare",Qb),ue.q.registerPlugin("batch",ue.f),ue.q.registerPlugin("tilingSprite",nT),Zr.registerPlugin(lT),Zr.registerPlugin(nb),Zr.registerPlugin(fb),Zr.registerPlugin(Cb),Zr.registerPlugin(tT),Vl.registerPlugin(nr.b),Vl.registerPlugin(Q1);var dc,qs={AlphaFilter:hT,BlurFilter:dT,BlurFilterPass:hc,ColorMatrixFilter:uc,DisplacementFilter:pT,FXAAFilter:fT,NoiseFilter:mT},Hr=v(11),_T=v(35),S0=function(){function i(){}return i.offsetPolygon=function(t,e){var n=[],r=t.length;e=i.isPolygonClockwise(t)?e:-1*e;for(var o=0;o<r;o+=2){var s=o-2;s<0&&(s+=r);var a=(o+2)%r,l=t[o]-t[s],h=t[o+1]-t[s+1],u=Math.sqrt(l*l+h*h);l/=u,h/=u;var p=-(h*=e),_=l*=e,x=[t[s]+p,t[s+1]+_],w=[t[o]+p,t[o+1]+_],A=t[a]-t[o],C=t[a+1]-t[o+1];A/=u=Math.sqrt(A*A+C*C),C/=u;var G=-(C*=e),K=A*=e,it=[t[o]+G,t[o+1]+K],ft=[t[a]+G,t[a+1]+K],nt=i.findIntersection(x[0],x[1],w[0],w[1],it[0],it[1],ft[0],ft[1]);nt&&n.push.apply(n,nt)}return n},i.findIntersection=function(t,e,n,r,o,s,a,l){var h=(l-s)*(n-t)-(a-o)*(r-e),u=(a-o)*(e-s)-(l-s)*(t-o);if(h===0)return u===0&&(n-t)*(e-s)-(r-e)*(t-o)===0?[(t+n)/2,(e+r)/2]:null;var p=u/h;return[t+p*(n-t),e+p*(r-e)]},i.isPolygonClockwise=function(t){for(var e=0,n=0,r=t.length-2;n<t.length;r=n,n+=2)e+=(t[n]-t[r])*(t[n+1]+t[r+1]);return e>0},i}(),yT=function(){function i(t){this._svgMatrix=null,this._tempMatrix=new Oe.d,this.renderer=t}return i.prototype._calcCanvasStyle=function(t,e){var n;return t.texture&&t.texture.baseTexture!==ue.t.WHITE.baseTexture?t.texture.valid?(n=Hr.b.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||Oe.d.IDENTITY)):n="#808080":n="#"+("00000"+(0|e).toString(16)).slice(-6),n},i.prototype.render=function(t){var e=this.renderer,n=e.context,r=t.worldAlpha,o=t.transform.worldTransform;e.setContextTransform(o),e.setBlendMode(t.blendMode);for(var s,a,l=t.geometry.graphicsData,h=(t.tint>>16&255)/255,u=(t.tint>>8&255)/255,p=(255&t.tint)/255,_=0;_<l.length;_++){var x=l[_],w=x.shape,A=x.fillStyle,C=x.lineStyle,G=0|x.fillStyle.color,K=0|x.lineStyle.color;if(x.matrix&&e.setContextTransform(o.copyTo(this._tempMatrix).append(x.matrix)),A.visible){var it=((G>>16&255)/255*h*255<<16)+((G>>8&255)/255*u*255<<8)+(255&G)/255*p*255;s=this._calcCanvasStyle(A,it)}if(C.visible){var ft=((K>>16&255)/255*h*255<<16)+((K>>8&255)/255*u*255<<8)+(255&K)/255*p*255;a=this._calcCanvasStyle(C,ft)}if(n.lineWidth=C.width,n.lineCap=C.cap,n.lineJoin=C.join,n.miterLimit=C.miterLimit,x.type===Oe.l.POLY){n.beginPath();var nt=(Pt=w).points,gt=x.holes,lt=void 0,dt=void 0,Ut=void 0,Ft=void 0,Et=void 0;n.moveTo(nt[0],nt[1]);for(var Mt=2;Mt<nt.length;Mt+=2)n.lineTo(nt[Mt],nt[Mt+1]);if(Pt.closeStroke&&n.closePath(),gt.length>0){for(Et=[],lt=0,Ut=nt[0],Ft=nt[1],Mt=2;Mt+2<nt.length;Mt+=2)lt+=(nt[Mt]-Ut)*(nt[Mt+3]-Ft)-(nt[Mt+2]-Ut)*(nt[Mt+1]-Ft);for(var Lt=0;Lt<gt.length;Lt++)if(nt=gt[Lt].shape.points){for(dt=0,Ut=nt[0],Ft=nt[1],Mt=2;Mt+2<nt.length;Mt+=2)dt+=(nt[Mt]-Ut)*(nt[Mt+3]-Ft)-(nt[Mt+2]-Ut)*(nt[Mt+1]-Ft);if(dt*lt<0)for(n.moveTo(nt[0],nt[1]),Mt=2;Mt<nt.length;Mt+=2)n.lineTo(nt[Mt],nt[Mt+1]);else for(n.moveTo(nt[nt.length-2],nt[nt.length-1]),Mt=nt.length-4;Mt>=0;Mt-=2)n.lineTo(nt[Mt],nt[Mt+1]);gt[Lt].shape.closeStroke&&n.closePath(),Et[Lt]=dt*lt<0}}A.visible&&(n.globalAlpha=A.alpha*r,n.fillStyle=s,n.fill()),C.visible&&this.paintPolygonStroke(Pt,C,a,gt,Et,r,n)}else if(x.type===Oe.l.RECT){var Pt=w;if(A.visible&&(n.globalAlpha=A.alpha*r,n.fillStyle=s,n.fillRect(Pt.x,Pt.y,Pt.width,Pt.height)),C.visible){var ee=C.width*(.5-(1-C.alignment)),$t=Pt.width+2*ee,zt=Pt.height+2*ee;n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.strokeRect(Pt.x-ee,Pt.y-ee,$t,zt)}}else if(x.type===Oe.l.CIRC)Pt=w,n.beginPath(),n.arc(Pt.x,Pt.y,Pt.radius,0,2*Math.PI),n.closePath(),A.visible&&(n.globalAlpha=A.alpha*r,n.fillStyle=s,n.fill()),C.visible&&(C.alignment!==.5&&(ee=C.width*(.5-(1-C.alignment)),n.beginPath(),n.arc(Pt.x,Pt.y,Pt.radius+ee,0,2*Math.PI),n.closePath()),n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke());else if(x.type===Oe.l.ELIP){if(Pt=w,(De=C.alignment===1)||this.paintEllipse(Pt,A,C,s,r,n),C.visible){if(C.alignment!==.5){ee=C.width*(.5-(1-C.alignment));var Xt=2*(Pt.width+ee),pe=2*(Pt.height+ee),be=Pt.x-Xt/2,Pe=Pt.y-pe/2,Ct=Xt/2*.5522848,Bt=pe/2*.5522848,ve=be+Xt,le=Pe+pe,se=be+Xt/2,Ie=Pe+pe/2;n.beginPath(),n.moveTo(be,Ie),n.bezierCurveTo(be,Ie-Bt,se-Ct,Pe,se,Pe),n.bezierCurveTo(se+Ct,Pe,ve,Ie-Bt,ve,Ie),n.bezierCurveTo(ve,Ie+Bt,se+Ct,le,se,le),n.bezierCurveTo(se-Ct,le,be,Ie+Bt,be,Ie),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}De&&this.paintEllipse(Pt,A,C,s,r,n)}else if(x.type===Oe.l.RREC){var De;if(Pt=w,(De=C.alignment===1)||this.paintRoundedRectangle(Pt,A,C,s,r,n),C.visible){if(C.alignment!==.5){$t=Pt.width,zt=Pt.height,ee=C.width*(.5-(1-C.alignment));var ce=Pt.x-ee,Tt=Pt.y-ee,jt=Pt.width+2*ee,ie=Pt.height+2*ee,ae=ee*(C.alignment>=1?Math.min(jt/$t,ie/zt):Math.min($t/jt,zt/ie)),qt=Pt.radius+ae,ye=Math.min(jt,ie)/2;qt=qt>ye?ye:qt,n.beginPath(),n.moveTo(ce,Tt+qt),n.lineTo(ce,Tt+ie-qt),n.quadraticCurveTo(ce,Tt+ie,ce+qt,Tt+ie),n.lineTo(ce+jt-qt,Tt+ie),n.quadraticCurveTo(ce+jt,Tt+ie,ce+jt,Tt+ie-qt),n.lineTo(ce+jt,Tt+qt),n.quadraticCurveTo(ce+jt,Tt,ce+jt-qt,Tt),n.lineTo(ce+qt,Tt),n.quadraticCurveTo(ce,Tt,ce,Tt+qt),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}De&&this.paintRoundedRectangle(Pt,A,C,s,r,n)}}},i.prototype.paintPolygonStroke=function(t,e,n,r,o,s,a){if(e.alignment!==.5){var l=e.width*(.5-(1-e.alignment)),h=S0.offsetPolygon(t.points,l),u=void 0;a.beginPath(),a.moveTo(h[0],h[1]);for(var p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);t.closeStroke&&a.closePath();for(var _=0;_<r.length;_++){if(u=r[_].shape.points,h=S0.offsetPolygon(u,l),o[_])for(a.moveTo(h[0],h[1]),p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);else for(a.moveTo(h[h.length-2],h[h.length-1]),p=h.length-4;p>=0;p-=2)a.lineTo(h[p],h[p+1]);r[_].shape.closeStroke&&a.closePath()}}a.globalAlpha=e.alpha*s,a.strokeStyle=n,a.stroke()},i.prototype.paintEllipse=function(t,e,n,r,o,s){var a=2*t.width,l=2*t.height,h=t.x-a/2,u=t.y-l/2,p=a/2*.5522848,_=l/2*.5522848,x=h+a,w=u+l,A=h+a/2,C=u+l/2;n.alignment===0&&s.save(),s.beginPath(),s.moveTo(h,C),s.bezierCurveTo(h,C-_,A-p,u,A,u),s.bezierCurveTo(A+p,u,x,C-_,x,C),s.bezierCurveTo(x,C+_,A+p,w,A,w),s.bezierCurveTo(A-p,w,h,C+_,h,C),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.paintRoundedRectangle=function(t,e,n,r,o,s){var a=t.x,l=t.y,h=t.width,u=t.height,p=t.radius,_=Math.min(h,u)/2;p=p>_?_:p,n.alignment===0&&s.save(),s.beginPath(),s.moveTo(a,l+p),s.lineTo(a,l+u-p),s.quadraticCurveTo(a,l+u,a+p,l+u),s.lineTo(a+h-p,l+u),s.quadraticCurveTo(a+h,l+u,a+h,l+u-p),s.lineTo(a+h,l+p),s.quadraticCurveTo(a+h,l,a+h-p,l),s.lineTo(a+p,l),s.quadraticCurveTo(a,l,a,l+p),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.setPatternTransform=function(t,e){if(this._svgMatrix!==!1){if(!this._svgMatrix){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n&&n.createSVGMatrix&&(this._svgMatrix=n.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},i.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},i}(),Ha=new Oe.d;$i.prototype.generateCanvasTexture=function(i,t){t===void 0&&(t=1);var e=this.getLocalBounds(),n=ue.p.create({width:e.width,height:e.height,scaleMode:i,resolution:t});dc||(dc=new Hr.a),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(Ha),Ha.invert(),Ha.tx-=e.x,Ha.ty-=e.y,dc.render(this,{renderTexture:n,clear:!0,transform:Ha});var r=ue.t.from(n.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return r.baseTexture.setResolution(t),r},$i.prototype.cachedGraphicsData=[],$i.prototype._renderCanvas=function(i){this.isMask!==!0&&(this.finishPoly(),i.plugins.graphics.render(this))};/*!
 * @pixi/canvas-sprite - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var E0=new Oe.d,xT=function(){function i(t){this.renderer=t}return i.prototype.render=function(t){var e=t._texture,n=this.renderer,r=n.context;if(e.valid){var o=e._frame.width,s=e._frame.height,a=t.transform.worldTransform,l=0,h=0,u=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&u){n.setBlendMode(t.blendMode,!0),n.context.globalAlpha=t.worldAlpha;var p=e.baseTexture.scaleMode===gn.p.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==p&&(r[n.smoothProperty]=p),e.trim?(l=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(l=(.5-t.anchor.x)*e.orig.width,h=(.5-t.anchor.y)*e.orig.height),e.rotate&&(a.copyTo(E0),a=E0,Oe.n.matrixAppendRotationInv(a,e.rotate,l,h),l=0,h=0),l-=o/2,h-=s/2,n.setContextTransform(a,t.roundPixels,1),t.roundPixels&&(l|=0,h|=0);var _=e.baseTexture.resolution,x=n._outerBlend;x&&(r.save(),r.beginPath(),r.rect(l*n.resolution,h*n.resolution,o*n.resolution,s*n.resolution),r.clip()),t.tint!==16777215?(t._cachedTint===t.tint&&t._tintedCanvas.tintId===t._texture._updateID||(t._cachedTint=t.tint,t._tintedCanvas=Hr.b.getTintedCanvas(t,t.tint)),r.drawImage(t._tintedCanvas,0,0,Math.floor(o*_),Math.floor(s*_),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution))):r.drawImage(u,e._frame.x*_,e._frame.y*_,Math.floor(o*_),Math.floor(s*_),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution)),x&&r.restore(),n.setBlendMode(gn.b.NORMAL)}}},i.prototype.destroy=function(){this.renderer=null},i}();ci.prototype._tintedCanvas=null,ci.prototype._renderCanvas=function(i){i.plugins.sprite.render(this)};/*!
 * @pixi/canvas-extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var A0=new Oe.j,bT=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ue.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=A0).width=this.renderer.width,r.height=this.renderer.height);var a=Math.floor(r.width*n+1e-4),l=Math.floor(r.height*n+1e-4),h=new xn.CanvasRenderTarget(a,l,1),u=e.getImageData(r.x*n,r.y*n,a,l);return h.context.putImageData(u,0,0),h.canvas},i.prototype.pixels=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ue.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=A0).width=s.width,r.height=s.height);var a=r.x*n,l=r.y*n,h=r.width*n,u=r.height*n;return e.getImageData(a,l,h,u).data},i.prototype.destroy=function(){this.renderer=null},i}(),M0=function(i,t){return(M0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function TT(i,t){var e=i;if(t instanceof ue.c){var n=t.source,r=n.width===0?e.canvas.width:Math.min(e.canvas.width,n.width),o=n.height===0?e.canvas.height:Math.min(e.canvas.height,n.height);return e.ctx.drawImage(n,0,0,r,o,0,0,e.canvas.width,e.canvas.height),!0}return!1}var Wi,wT=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=16,n.canvas.height=16,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(TT),n}return function(e,n){function r(){this.constructor=e}M0(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.destroy=function(){i.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(wm),rh=new Oe.d,ja=new Oe.d,Qr=[new Oe.g,new Oe.g,new Oe.g,new Oe.g];/*!
 * @pixi/canvas-sprite-tiling - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */eT.prototype._renderCanvas=function(i){var t=this._texture;if(t.baseTexture.valid){var e=i.context,n=this.worldTransform,r=t.baseTexture,o=r.getDrawableSource(),s=r.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var a=new xn.CanvasRenderTarget(t._frame.width,t._frame.height,s);this.tint!==16777215?(this._tintedCanvas=Hr.b.getTintedCanvas(this,this.tint),a.context.drawImage(this._tintedCanvas,0,0)):a.context.drawImage(o,-t._frame.x*s,-t._frame.y*s),this._cachedTint=this.tint,this._canvasPattern=a.context.createPattern(a.canvas,"repeat")}e.globalAlpha=this.worldAlpha,i.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();var l=this.tileTransform.localTransform,h=this._width,u=this._height;rh.identity(),ja.copyFrom(l),this.uvRespectAnchor||ja.translate(-this.anchor.x*h,-this.anchor.y*u),ja.scale(this.tileScale.x/s,this.tileScale.y/s),rh.prepend(ja),rh.prepend(n),i.setContextTransform(rh),e.fillStyle=this._canvasPattern;var p=this.anchor.x*-h,_=this.anchor.y*-u;Qr[0].set(p,_),Qr[1].set(p+h,_),Qr[2].set(p+h,_+u),Qr[3].set(p,_+u);for(var x=0;x<4;x++)ja.applyInverse(Qr[x],Qr[x]);for(e.beginPath(),e.moveTo(Qr[0].x,Qr[0].y),x=1;x<4;x++)e.lineTo(Qr[x].x,Qr[x].y);e.closePath(),e.fill()}},Rb.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var t=i.context,e=this.worldTransform,n=!0,r=0,o=0,s=0,a=0;i.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible&&h._texture.valid){var u=h._texture.frame;if(t.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(i.setContextTransform(e,!1,1),n=!1),r=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,s=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var p=h.worldTransform;i.setContextTransform(p,this.roundPixels,1),r=h.anchor.x*-u.width+.5,o=h.anchor.y*-u.height+.5,s=u.width,a=u.height}var _=h._texture.baseTexture.resolution;t.drawImage(h._texture.baseTexture.getDrawableSource(),u.x*_,u.y*_,u.width*_,u.height*_,r*i.resolution,o*i.resolution,s*i.resolution,a*i.resolution)}}}},Cn.b.prototype._renderCanvas=function(i){},Cn.b.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&i.maskManager.pushMask(this._mask),this._renderCanvas(i);for(var t=0,e=this.children.length;t<e;++t)this.children[t].renderCanvas(i);this._mask&&i.maskManager.popMask(i)}},Cn.c.prototype.renderCanvas=function(i){},sc.prototype._renderCanvas=function(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),ci.prototype._renderCanvas.call(this,i)},Hr.a.registerPlugin("accessibility",nf),Hr.a.registerPlugin("extract",bT),Hr.a.registerPlugin("graphics",yT),Hr.a.registerPlugin("interaction",sf),Hr.a.registerPlugin("mesh",_T.a),Hr.a.registerPlugin("prepare",wT),Hr.a.registerPlugin("sprite",xT);class ST extends fi.a{constructor(){super(),this.prevTime=-1,this.times=0,this.valueTotal=0,this.destroyed=!1,this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(t=>{const e=t-this.prevTime;this.valueTotal+=e,this.times+=1,this.times>20&&(this.value=Math.floor(1e3*this.times/this.valueTotal),this.valueTotal=0,this.times=0,this.destroyed||this.emit("update",this.value)),this.prevTime=t,this.destroyed||this.calcFps()})}destroy(){this.destroyed=!0}}(function(i){i.ResourceError="RESOURCE_ERROR",i.RuntimeError="RUNTIME_ERROR",i.RuntimeWarn="RUNTIME_WARN",i.CanvasCrash="CANVAS_CRASH"})(Wi||(Wi={}));class Ti extends Error{constructor(t,e){var n,r;super(e),n=this,r=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__&&(n.__proto__=r),this.errorType=t,this.errorMsg=e}static transform(t){return t instanceof Ti?t:new Ti(Wi.RuntimeError,t.message)}}function oh(){return function(i,t,e){const n=e.value;e.value=function(...r){try{return n.apply(this,r)}catch(o){throw new Ti(Wi.RuntimeWarn,o.message)}}}}var ET=v(49),C0=v.n(ET),R0=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function cs(){return R()}const po="__delay_resolve_result__";function I0(i){return new Promise(t=>{setTimeout(()=>{t(po)},i)})}function Js(i,t){return R0(this,void 0,void 0,function*(){const e=yield Promise.race([i(),I0(t)]);return e===po?po:e})}function sh(i,t){return R0(this,void 0,void 0,function*(){const e=Date.now();for(;!i()&&Date.now()-e<t;)yield I0(16)})}var pc=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function P0(i,t){return pc(this,void 0,void 0,function*(){const e=yield Js(()=>fetch(i),t);if(e===po)throw new Ti(Wi.ResourceError,`"${i}" loaded timeout"`);if(!e.ok)throw new Ti(Wi.ResourceError,`"${i}" loaded failed with status "${e.status}"`);return e})}class AT{constructor(t,e,n,r,o,s,a){this.timeout=15e3,this.useCache=!1,this.taskId="",this.delegate=null,this.urlInterrupter=null,this.useCache=e,this.localStorage=t,this.logger=n,this.tracker=r,this.timeout=o,this.delegate=s||null,this.urlInterrupter=a||null}attachTaskId(t){this.taskId=t}fetchJson(t){return pc(this,void 0,void 0,function*(){const e=Date.now();let n=t;const r=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const s=Date.now();n=yield this.urlInterrupter(n),this.logger.info(`use url interrupter, ${n}, time: ${Date.now()-s}`,this.taskId)}let o;if(this.useCache&&(this.logger.info("load resource from cache. "+r,this.taskId||""),o=yield this.localStorage.getItem(r)),o)return this.logger.info("cache hit. "+r,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"cache"}}),o;{let s;if(this.delegate){this.logger.info("load resource by delegate. "+r,this.taskId||"");const a=Date.now();try{const l=yield Js(()=>this.delegate.loadJson(n),this.timeout);if(this.logger.info(`load resource by delegate end. ${r}, time: ${Date.now()-a}`,this.taskId||""),l===po)throw new Ti(Wi.ResourceError,`"${r}" loaded timeout"`);s=JSON.parse(l),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}})}catch(l){throw this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}}),new Ti(Wi.ResourceError,`"${r}" loaded timeout"`)}}else{this.logger.info("load resource from server. "+r,this.taskId||"");const a=Date.now();try{s=yield(yield P0(""+n,this.timeout)).json()}catch(l){throw this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}}),l}this.logger.info(`load resource from server end. ${r}, time: ${Date.now()-a}`,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}})}return this.logger.info("load end. "+r,this.taskId||""),this.useCache&&this.localStorage.setItem(r,s).catch(()=>{}),s}})}fetchPng(t,e){return pc(this,void 0,void 0,function*(){const n=Date.now();let r=t;const o=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const C=Date.now();r=yield this.urlInterrupter(r),this.logger.info(`use url interrupter, ${r}, time: ${Date.now()-C}`,this.taskId)}let s;const a=o+"-v3";if(this.useCache){this.logger.info("load resource from cache. "+o,this.taskId||"");const C=yield this.localStorage.getItem(a);C&&(s=C.base64,this.logger.info("cache hit. "+o,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"cache"}}))}if(!s){let C;if(this.delegate)try{this.logger.info("load resource by delegate. "+o,this.taskId||"");const G=Date.now();if(C=yield Js(()=>this.delegate.loadImage(r),this.timeout),this.logger.info(`load resource by delegate end. ${o}, time: ${Date.now()-G}`,this.taskId||""),C===po)throw new Ti(Wi.ResourceError,`"${o}" loaded timeout"`);this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}catch(G){this.tracker({name:"slideResourceLoad",result:"fail",reason:G+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}else try{this.logger.info("load resource from server. "+o,this.taskId||"");const G=Date.now(),K=yield P0(r,this.timeout);this.logger.info(`load resource from server end. ${o}, time: ${Date.now()-G}`,this.taskId||""),C=yield K.blob(),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}catch(G){this.tracker({name:"slideResourceLoad",result:"fail",reason:G+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}s=yield function(G){return new Promise((K,it)=>{const ft=new FileReader;ft.onload=()=>{K(ft.result)},ft.onerror=()=>{it(new Ti(Wi.ResourceError,"Failed parse blob data."))},ft.readAsDataURL(G)})}(C),this.useCache&&this.localStorage.setItem(a,{base64:s}).catch(()=>{})}const l=document.createElement("img");l.src=s,yield new Promise((C,G)=>{l.onload=()=>C(""),l.onerror=()=>G(new Error("load sprite image failed"))});let h=e;const u=l.width||1,p=l.height||1;if(u>2048||p>2048){h*=2048/u;const C=h*p;C>2048&&(h*=p/C)}const _=document.createElement("canvas"),x=Math.ceil(l.width*h),w=Math.ceil(l.height*h);_.width=x,_.height=w,_.getContext("2d").drawImage(l,0,0,x,w);const A=new ue.c(_,{resolution:1});return this.logger.info("load end. "+o,this.taskId||""),{baseTexture:A,scale:h}})}destroy(){}}var MT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class CT{constructor(t){this.isPaused=!1,this.timestamp=0,this.callbackList=[],this.onTimeUpdate=e=>{const n=e/(Tr.b.TARGET_FPMS||.06);if(!this.isPaused){this.timestamp+=n,this.callbackList=this.callbackList.filter(o=>o&&!o.applied);let{length:r}=this.callbackList;for(let o=0;o<r;o++){const s=this.callbackList[o];if(s&&!s.applied){if(!(s.triggerTime<=this.timestamp))break;s.running=!0,s.fn(),s.applied=!0,r=this.callbackList.length}}}},this.ticker=t,this.ticker.add(this.onTimeUpdate)}setTimeout(t,e){const n=cs(),r=this.timestamp+Math.max(e||16,16);return this.callbackList.push({fn:t,triggerTime:r,id:n,applied:!1,running:!1}),this.callbackList.sort((o,s)=>o.triggerTime-s.triggerTime),n}clearTimeout(t){const e=this.callbackList.findIndex(n=>n.id===t);e>=0&&!this.callbackList[e].running&&this.callbackList.splice(e,1)}delay(t){return new Promise(e=>{this.setTimeout(e,t)})}waitUntil(t,e){return MT(this,void 0,void 0,function*(){const n=this.timestamp;for(;!t()&&this.timestamp-n<e;)yield this.delay(50)})}pause(){this.isPaused=!0}resume(){this.isPaused=!1}}var RT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function ah(i,t,e){return e?Math.floor(parseFloat(i)*t):Math.ceil(parseFloat(i)*t)}const lh={w:!1,h:!1,x:!0,y:!0};class IT{constructor(t){this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null),this.spriteSheets=[],this.loader=t}getTexture(t){return this.textures[t]||null}getFrameData(t){return this.frames[t]}getGifFrames(t){return this.gifs[t]?this.gifs[t].filter(e=>!!e):[]}loadSpriteSheetItem(t,e,n,r){return RT(this,void 0,void 0,function*(){const o=yield this.loader.fetchJson(`${t}/${e}/jsonOutput/${n}.json`),{baseTexture:s,scale:a}=yield this.loader.fetchPng(`${t}/${e}/jsonOutput/${n}.png`,r);(function(h,u){h.meta&&h.meta.size&&["w","h"].forEach(p=>{h.meta.size[p]=ah(h.meta.size[p],u,lh[p])}),h.frames&&Object.keys(h.frames).forEach(p=>{h.frames[p].frame&&["x","y","w","h"].forEach(_=>{h.frames[p].frame[_]=ah(h.frames[p].frame[_],u,lh[_])}),h.frames[p].spriteSourceSize&&["x","y","w","h"].forEach(_=>{h.frames[p].spriteSourceSize[_]=ah(h.frames[p].spriteSourceSize[_],u,lh[_])}),h.frames[p].sourceSize&&["w","h"].forEach(_=>{h.frames[p].sourceSize[_]=ah(h.frames[p].sourceSize[_],u,lh[_])})})})(o,a);const l=new Em(s,o);yield new Promise(h=>{l.parse(()=>h(""))}),this.spriteSheets.push(l),Object.keys(l.textures).forEach(h=>{const u=h.match(/^(.+)_gif_(\d+)$/);if(u&&u[1]&&u[2]){const p=u[1];this.gifs[p]||(this.gifs[p]=[]);const _=parseInt(u[2],10);this.gifs[p][_]=l.textures[h]}else this.frames[h]=o.frames[h],this.textures[h]=l.textures[h]})})}destroy(){this.spriteSheets.forEach(t=>t.destroy(!0)),this.spriteSheets=[],this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null)}}var PT=v(18),hh=v.n(PT),OT=v(13),fo=v.n(OT);function O0(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=Math.sin(o*(Math.PI/180))*e;else{const s=function(a){const l=a*Math.PI/180;return Math.tan(l)}(o);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=s*n}return{x:n,y:r}}function LT(i,t,e,n,r,o){const s=i,a=t;let l,h,u,p,_;if(Math.round(n)===0)l=r,h=o,_=0;else if(Math.round(n)>=360)l=r,h=o,u=r+2*i*Math.abs(Math.cos(-e/180*Math.PI)),p=o+2*t*Math.sin(-e/180*Math.PI),_=1;else{const x=-e,w=-(e+n),{x:A,y:C}=O0(x,s,a),G=r-A,K=o+C,{x:it,y:ft}=O0(w,s,a);l=it+G,h=K-ft,_=n>=-360&&n<-180?1:n>=-180&&n<0||n>0&&n<180?0:1}return{radiusX:s,radiusY:a,xAxisRotation:0,largeArcFlag:_,sweepFlag:n>0?1:0,endX:l,endY:h,middleX:u,middleY:p}}class L0{constructor(){this.pool=[]}getObject(t){const e=this.pool.find(n=>!n.isUsed);if(e)return e.isUsed=!0,e.obj;{const n={obj:this.createObject(),isUsed:!0,group:t};return this.pool.push(n),n.obj}}collectObject(t){const e=this.pool.find(n=>n.obj===t);e&&(e.isUsed=!1,this.resetObject(e.obj))}collectObjectByGroup(t){this.pool.filter(e=>e.group===t).forEach(e=>this.collectObject(e.obj))}}const fc=new class extends L0{createObject(){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i}resetObject(i){i.removeAttribute("viewBox"),i.removeAttribute("width"),i.removeAttribute("height"),i.innerHTML=""}};var NT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class DT{constructor(t){this.svgElements=[],this.idToHashMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.hashToIdMap=Object.create(null),this.maxResolution=t}render(t,e,n,r){return NT(this,void 0,void 0,function*(){const{items:o,width:s,height:a}=t,l=document.createElement("canvas");l.width=s*r,l.height=a*r;const h=new ue.c(l,{width:s*r,height:a*r,resolution:1}),u=fc.getObject(n);this.svgElements.push(u),u.setAttribute("viewBox",`0 0 ${s} ${a}`),u.setAttribute("width",""+s),u.setAttribute("height",""+a);const p={};o.forEach(A=>{const{item:C,x:G,y:K}=A,it=G+2,ft=K+2;C.pathsData.forEach(lt=>{let dt="";lt.cmds.forEach(([Ut,Ft])=>{dt+=Ut+" ",dt+=Ft.map(Et=>(fo()(Et)||(Et.x=Et.x+lt.offset.x+it,Et.y=Et.y+lt.offset.y+ft),Et)).reduce((Et,Mt)=>(fo()(Mt)?Et+=Mt+" ":Et+=`${Mt.x} ${Mt.y} `,Et),""),dt+=" "}),lt.pathElement.setAttribute("d",dt),u.appendChild(lt.pathElement)});const nt=C.width-4-2*C.padding,gt=C.height-4-2*C.padding;this.textures[C.hash]={texture:new ue.t(h,new Oe.j((it+2)*r,(ft+2)*r,nt*r,gt*r)),pivot:C.pivot,scale:1/r},p[C.hash]=this.hashToIdMap[C.hash]});const _=(x='<?xml version="1.0" encoding="utf-8"?>'+u.outerHTML,"data:image/svg+xml,"+encodeURIComponent(x).replace(/'/g,"%27").replace(/"/g,"%22"));var x;const w=document.createElement("img");w.src=_,yield new Promise((A,C)=>{w.onload=()=>A(""),w.onerror=()=>C()}),l.getContext("2d").drawImage(w,0,0,l.width,l.height)})}getGraphicsData(t){const e=this.idToHashMap[t]||"";return this.textures[e]||null}addGraphics(t,e,n,r,o,s,a,l,h,u,p){var _,x;if(!a&&!h)return t;const w=hh()(n+((x=(_=a==null?void 0:a.width)===null||_===void 0?void 0:_.toString())!==null&&x!==void 0?x:0)+h+u+p);if(this.hashToIdMap[w]||(this.hashToIdMap[w]=[]),this.hashToIdMap[w].push(t),this.idToHashMap[t]=w,this.graphics.findIndex(A=>A.hash===w)<0){const{graphicsWidth:A,graphicsHeight:C,pathsData:G,pivot:K,padding:it}=function(ft,nt,gt,lt,dt,Ut,Ft,Et,Mt){var Lt;const Pt=[],ee={x:Math.abs(dt.x),y:Math.abs(dt.y)};let $t=0,zt=0,Xt=0,pe=0,be=0,Pe="none";const Ct=(Lt=lt==null?void 0:lt.width)!==null&&Lt!==void 0?Lt:0;return Ft?($t=nt,zt=gt,be=0):(Pe=Mt||"#ff0000",be=Ct,Xt=.5*Ct,pe=.5*Ct,$t=nt+Ct,zt=gt+Ct,ee.x+=.5*Ct,ee.y+=.5*Ct),$t+=Math.abs(dt.x),zt+=Math.abs(dt.y),Xt+=Math.abs(dt.x),pe+=Math.abs(dt.y),$t+=4,zt+=4,Xt+=2,pe+=2,$t=Math.ceil($t),zt=Math.ceil(zt),ft.forEach(Bt=>{const ve=document.createElementNS("http://www.w3.org/2000/svg","path");Bt.fill!=="none"&&Ft?ve.setAttribute("fill",Et||"#ff0000"):ve.setAttribute("fill","none"),Bt.hasStroke&&!Ft&&(ve.setAttribute("stroke-linecap",(lt==null?void 0:lt.cap)||"butt"),ve.setAttribute("stroke-linejoin",(lt==null?void 0:lt.join)||"miter"),ve.setAttribute("stroke-width",be.toString()),ve.setAttribute("stroke",Pe),lt!=null&&lt.dash&&ve.setAttribute("stroke-dasharray",lt.dash));const{scale:le}=Bt,se=Bt.path.trim().split(" ");let Ie={x:0,y:0};const De={offset:{x:Xt,y:pe},cmds:[],pathElement:ve};for(let ce=0;ce<se.length;ce+=2){const Tt=se[ce],jt=se[ce+1];if(Tt==="M"){let[ie,ae]=jt.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,De.cmds.push(["M",[{x:ie,y:ae}]])}else if(Tt==="A"){const[ie,ae,qt,ye]=jt.split(",").map(Sn=>Number(Sn)),nn=qt/Math.PI*180,on=ye/Math.PI*180,rn=LT(ie,ae,nn,on,Ie.x,Ie.y);Math.round(on)>=360?(Ie={x:rn.endX,y:rn.endY},De.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.middleX/9525*le.x,y:rn.middleY/9525*le.y}]]),De.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]])):(Ie={x:rn.endX,y:rn.endY},De.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]]))}else if(Tt==="L"){let[ie,ae]=jt.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,De.cmds.push(["L",[{x:ie,y:ae}]])}else if(Tt==="QB"){let[ie,ae,qt,ye]=jt.split(",").map(nn=>Number(nn));Ie={x:qt,y:ye},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,De.cmds.push(["Q",[{x:ie,y:ae},{x:qt,y:ye}]])}else if(Tt==="CB"){let[ie,ae,qt,ye,nn,on]=jt.split(",").map(rn=>Number(rn));Ie={x:nn,y:on},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,nn=nn/9525*le.x,on=on/9525*le.y,De.cmds.push(["C",[{x:ie,y:ae},{x:qt,y:ye},{x:nn,y:on}]])}else Tt==="C"&&De.cmds.push(["Z",[]])}Pt.push(De)}),{graphicsWidth:$t,graphicsHeight:zt,pivot:ee,padding:2,pathsData:Pt}}(e,o,s,a,r,0,h,u,p);this.graphics.push({hash:w,pathsData:G,pivot:K,width:A,height:C,padding:it})}return t}pack(){return this.graphics.forEach(t=>{t.width+=4,t.height+=4}),function t(e){const n=[],r=e.filter(u=>{const p=u.width<2048&&u.height<2048;return p||n.push(u),p}).sort((u,p)=>u.width*u.height-p.width*p.height);let o=r.length+1,s=2050,a=2050;const l=[];let h=null;for(;(s>2048||a>2048)&&r.length>0;)o-=1,h=C0()(r.slice(0,o)),s=h.width,a=h.height;return h&&l.push(h),n.forEach(u=>{const p=C0()([u]);l.push(p)}),o<r.length?l.concat(t(r.slice(o))):l}(this.graphics)}destroy(){Object.keys(this.textures).forEach(t=>{var e;(e=this.textures[t])===null||e===void 0||e.texture.destroy(!0)}),this.textures=Object.create(null),this.svgElements.forEach(t=>fc.collectObject(t)),this.graphics=[]}}class FT{constructor(){this.runningTimeNodes={}}addRunningTimeNode(t,e,n){const r=`${e}_${t}`;if(this.runningTimeNodes[r])try{this.runningTimeNodes[r].dispose(!0)}catch{}this.runningTimeNodes[r]=n}removeRunningTimeNode(t,e){const n=`${e}_${t}`;delete this.runningTimeNodes[n]}}class BT{constructor(t){this.eventHub=t,this.targets=Object.create(null)}getTargets(){return Object.keys(this.targets).map(t=>this.targets[t])}addTarget(t,e){this.targets[t]=e}getTargetById(t){return this.targets[t]}getTarget(t,e,n={type:"el",index:0,id:""}){var r,o;let s=this.targets[t.id];return t.type!=="shape"?s:(t.type==="shape"&&t.txEl&&(s=(r=s==null?void 0:s.getTextElement(t.txEl.type,t.txEl.range))!==null&&r!==void 0?r:null),t.type==="shape"&&t.bg&&n.index===0&&(e=!1,s=(o=s==null?void 0:s.getBgElement())!==null&&o!==void 0?o:null,this.eventHub.emit("IterateTimeNodeEnd",n.id)),e&&s?s.getIterateEntry(n.type,n.index,n.id):(s||this.eventHub.emit("IterateTimeNodeEnd",n.id),s))}clearTargets(){this.targets=Object.create(null)}}class kT{constructor(t){this.target=t}get color(){return this.target.strokeColorFilter.currentColor}set color(t){this.target.strokeColorFilter.color=t}get on(){return this.target.strokeActive?"true":"false"}set on(t){this.target.strokeActive=t==="true"}}class UT{constructor(t){this.applyCommand=(e,n)=>{this.target.applyCommand(e,n)},this.target=t}}class GT{constructor(t){this.target=t}get color(){return this.target.pptColorFilter.currentColor}set color(t){this.target.pptColorActive&&(this.target.pptColorFilter.color=t)}get on(){return this.target.pptColorActive?"true":"false"}set on(t){this.target.pptColorActive=t==="true"}get designColor(){return this.target.pptColorFilter.designColor}toString(){return this.color}}class N0{constructor(t){this.target=t}get color(){return this.target.fillColorFilter.currentColor}set color(t){this.target.fillActive&&(this.target.fillColorFilter.color=t)}get on(){return this.target.fillActive?"true":"false"}set on(t){this.target.fillActive=t==="true"}get designColor(){return this.target.fillColorFilter.designColor}}class HT extends fi.a{constructor(t,e,n){super(),this.hardHidden=!1,this.designRotation=0,this.target=t,e===!0&&(this.hardHidden=!0),this.designRotation=n}get opacity(){return this.target.alpha}set opacity(t){this.target.alpha=t}get rotation(){return this.target.rotation/Math.PI*180}set rotation(t){this.target.rotation=t/180*Math.PI+this.designRotation}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(t){const e=this.visibility;this.visibility===t||this.hardHidden||(this.target.visible=t==="visible",this.emit("visibilityChange",e==="visible",this.target.visible))}}class D0{constructor(t,e){this.actions=[],this.ctx=e,this.object=t,this.object.interactive=!0}reset(t){this.object.interactive=!1,this.object.removeAllListeners(),this.object=t,this.object.interactive=!0}addAction(t,e){this.actions.push([t,e]),e==="click"?(this.object.addListener("pointertap",()=>this.handleAction(t)),this.object.cursor="pointer"):e==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(t))}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new Oe.k(0,0,this.object.width,this.object.height)}handleAction(t){this.ctx.eventHub.emit(We.hyperlinkTrigger,t),this.execAction(t)}execAction(t){var e;if(this.ctx.eventHub.emit(We.userInput),t.action==="ppaction://hlinksldjump"){const n=((e=t==null?void 0:t.target)!==null&&e!==void 0?e:"").match(/slide(\d+)\.xml/);n&&n[1]&&this.ctx.eventHub.emit(We.requestGotoSlide,Number(n[1]))}else if(t.action==="ppaction://hlinkshowjump?jump=nextslide")this.ctx.eventHub.emit(We.requestNextSlide);else if(t.action==="ppaction://hlinkshowjump?jump=previousslide")this.ctx.eventHub.emit(We.requestPrevSlide);else if(t.action==="ppaction://hlinkshowjump?jump=firstslide")this.ctx.eventHub.emit(We.requestGotoSlide,1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslide")this.ctx.eventHub.emit(We.requestGotoSlide,-1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslideviewed"){const n=this.ctx.lastViewedIndex;this.ctx.eventHub.emit(We.requestGotoSlide,n)}else t.action==="ppaction://hlinkshowjump?jump=endshow"?this.ctx.eventHub.emit(We.requestGotoSlide,-1):(t.action===""||t.action==="ppaction://hlinkfile")&&this.ctx.eventHub.emit(We.requestOpenUrl,t.target)}}function wr(i,t,e=5){return Math.abs(i-t)<=Math.pow(10,-e)}function Zs(i){return Math.floor(1e6*i)/1e6}class Vo{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(t,e){const n=new Vo;return n.point=t,n.slope=e,n}resolveY(t){return Math.tan(this.slope)*(t-this.point.x)+this.point.y}distanceToLinearEquation(t){return wr(this.slope,t.slope)?this.distanceToPoint(t.point):-1}distanceToPoint(t){let e=0;if(Math.tan(this.slope)*(t.x-this.point.x)+this.point.y===t.y)return 0;e=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const n=Vo.fromPointSlope(t,e),r=this.crossPoint(n);return r?Math.ceil(Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))):0}crossPoint(t){if(wr(t.slope,this.slope))return null;let e=0,n=0;const r=Math.tan(t.slope),o=Math.tan(this.slope),{x:s,y:a}=this.point,{x:l,y:h}=t.point;return wr(this.slope,Math.PI/2)?(e=this.point.x,n=r*(e-l)+h):wr(t.slope,Math.PI/2)?(e=t.point.x,n=o*(e-s)+a):wr(this.slope,Math.PI)||wr(this.slope,0)?(n=this.point.y,e=(n-h)/r+l):wr(t.slope,Math.PI)||wr(t.slope,0)?(n=t.point.y,e=(n-a)/o+s):(e=(r*l-h+a-o*s)/(r-o),n=o*(e-s)+a),{x:e,y:n}}}class mc{constructor(t,e,n){var r,o,s,a,l,h;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new Oe.j(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Cn.b,this.ctx=e,this.option=n,this.style=new HT(this.container,!!t.hardHidden,t.rotation||0),this.designGlobalPosition={x:n.parentGlobalPos.x+((o=(r=t.position)===null||r===void 0?void 0:r.x)!==null&&o!==void 0?o:0),y:n.parentGlobalPos.y+((a=(s=t.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0)},(t.hlinkClick||t.hlinkHover)&&(this.hyperlink=new D0(this.container,this.ctx),t.hlinkHover&&((l=this.hyperlink)===null||l===void 0||l.addAction(t.hlinkHover,"hover")),t.hlinkClick&&((h=this.hyperlink)===null||h===void 0||h.addAction(t.hlinkClick,"click"))),this.ctx.clock.waitUntil(()=>{try{return!!this.container.width}catch{return!1}},3e3).then(()=>{try{this.designWidth=this.designWidth||this.container.width}catch{}}),this.ctx.clock.waitUntil(()=>{try{return!!this.container.height}catch{return!1}},3e3).then(()=>{try{this.designHeight=this.designHeight||this.container.height}catch{}})}updateScale(){this.container&&(this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y)}updateTransform(t){var e,n,r,o,s,a,l,h;this.designWidth=t.width,this.designHeight=t.height,this.designX=(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,this.designY=(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0;const u=this.designWidth/2,p=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=u,this.container.pivot.y=p;const _=(a=(s=t.position)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:0,x=(h=(l=t.position)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:0;this.container.x=_+u,this.container.y=x+p,t.scale&&(this.designScale={x:t.scale.x,y:t.scale.y},this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y),t.rotation&&(this.container.rotation=t.rotation);const w=new $i;w.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(w),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=_,this.bound.y=x,this.bound.width=this.designWidth,this.bound.height=this.designHeight}get scale(){return this.scaleOrigin}set scale(t){this.scaleOrigin.x=t.x,this.scaleOrigin.y=t.y,this.updateScale()}get design_ppt_w(){return Zs(this.designWidth/this.ctx.stageWidth)}get design_ppt_h(){return Zs((this.designHeight||this.container.height)/this.ctx.stageHeight)}get design_ppt_x(){return Zs(this.designX/this.ctx.stageWidth)}get design_ppt_y(){return Zs(this.designY/this.ctx.stageHeight)}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(t){this.designWidth&&(this.scaleExt.x=t*this.ctx.stageWidth/this.designWidth,this.updateScale())}get ppt_h(){const t=this.designHeight||this.container.height;return this.scaleExt.y*this.scaleOrigin.y*t/this.ctx.stageHeight}set ppt_h(t){this.designHeight&&(this.scaleExt.y=t*this.ctx.stageHeight/this.designHeight,this.updateScale())}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(t){this.pptX=t;const e=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=t*this.ctx.stageWidth+this.container.pivot.x*e}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(t){this.pptY=t;const e=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=t*this.ctx.stageHeight+this.container.pivot.y*e}get r(){return this.container.rotation}set r(t){this.container.rotation=t}get ppt_r(){return this.container.angle}set ppt_r(t){this.container.angle=t}set xshear(t){this.container.skew.x=t}get xshear(){return this.container.skew.x}set yshear(t){this.container.skew.y=t}get yshear(){return this.container.skew.y}}var jT=v(112),zT=v.n(jT);class uh{constructor(t){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,t){this._isInit=!0;const e=t.match(/-?[0-9]+/g);e&&(this.h=parseInt(e[0],10),this.s=parseInt(e[1],10)/100,this.l=parseInt(e[2],10)/100)}}isInit(){return this._isInit}by(t,e){e.h=Math.max(Math.min(this.h+t.h,359),0),e.s=Math.max(Math.min(this.s+t.s,1),0),e.l=Math.max(Math.min(this.l+t.l,1),0),e.a=Math.max(Math.min(this.a+t.a,1),0)}fromHexString(t){const[e,n,r,o]=dr(t);let s=0,a=0,l=0;const h=Math.max(e,n,r),u=Math.min(e,n,r),p=h-u;l=(h+u)/2,p===0?s=0:h===e?s=(n-r)/p%6*60:h===n?s=60*((r-e)/p+2):h===r&&(s=60*((e-n)/p+4)),a=p===0?0:p/(1-Math.abs(2*l-1)),this.h=s,this.s=a,this.l=l,this.a=o}interpolationFrom(t,e,n){const r=t.h+(this.h-t.h)*e,o=t.s+(this.s-t.s)*e,s=t.l+(this.l-t.l)*e,a=t.a+(this.a-t.a)*e;n.h=Math.max(Math.min(r,359),0),n.s=Math.max(Math.min(o,1),0),n.l=Math.max(Math.min(s,1),0),n.a=Math.max(Math.min(a,1),0)}toHexString(){let t=[0,0,0,0];const{h:e,s:n,l:r}=this;if(e<360&&e>=0&&n<=1&&n>=0&&r<=1&&r>=0){let o,s,a;const l=(1-Math.abs(2*r-1))*n,h=l*(1-Math.abs(e/60%2-1)),u=r-l/2;[o,s,a]=e>=0&&e<60?[l,h,0]:e>=60&&e<120?[h,l,0]:e>=120&&e<180?[0,l,h]:e>=180&&e<240?[0,h,l]:e>=240&&e<300?[h,0,l]:[l,0,h],t=[o+u,s+u,a+u,this.a]}return B0(t)}}class ch{constructor(t){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,t&&(this._isInit=!0,this.fromHexString(t))}fromHexString(t){const[e,n,r,o]=dr(t);this.r=e,this.g=n,this.b=r,this.a=o}isInit(){return this._isInit}interpolationFrom(t,e,n){n.r=t.r+(this.r-t.r)*e,n.g=t.g+(this.g-t.g)*e,n.b=t.b+(this.b-t.b)*e,n.a=t.a+(this.a-t.a)*e}by(t,e){e.r=Math.min(Math.max(this.r+t.r,0),255),e.g=Math.min(Math.max(this.g+t.g,0),255),e.b=Math.min(Math.max(this.b+t.b,0),255),e.a=Math.min(Math.max(this.a+t.a,0),1)}toHexString(){return B0([this.r,this.g,this.b,this.a])}}function F0(i){const t=i.substring(1);return[parseInt(t.substring(0,6),16),parseInt(t.substring(6,8),16)/255]}function dr(i){return(i=i.replace(/^#/,"")).substring(6,8).length===0&&(i+="FF"),[parseInt(i.substring(0,2).padStart(8,"0"),16)/255,parseInt(i.substring(2,4).padStart(8,"0"),16)/255,parseInt(i.substring(4,6).padStart(8,"0"),16)/255,parseInt(i.substring(6,8).padStart(8,"0"),16)/255]}function B0(i){return"#"+Math.round(255*i[0]).toString(16).padStart(2,"0")+Math.round(255*i[1]).toString(16).padStart(2,"0")+Math.round(255*i[2]).toString(16).padStart(2,"0")+Math.round(255*i[3]).toString(16).padStart(2,"0")}function za(i,t,e){const n=dr(i),r=dr(t),o=Math.round(255*(n[0]+(r[0]-n[0])*e)),s=Math.round(255*(n[1]+(r[1]-n[1])*e)),a=Math.round(255*(n[2]+(r[2]-n[2])*e)),l=Math.round(255*(n[3]+(r[3]-n[3])*e));return"#"+o.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")+l.toString(16).padStart(2,"0")}class ds extends ue.k{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF",this.designColor="#FFFFFFFF"}set color(t){this.currentColor=t;const e=dr(t);this.uniforms.color=Float32Array.from(e)}get color(){return this.currentColor}}class VT extends ue.k{constructor(t){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        gl_FragColor = color;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0});const e=dr(t);this.uniforms.color=Float32Array.from(e)}}const k0=new qs.ColorMatrixFilter;k0.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const U0=new qs.ColorMatrixFilter;U0.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const G0=new qs.ColorMatrixFilter;G0.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const H0=new qs.ColorMatrixFilter;H0.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const WT={darken:k0,darkenLess:U0,lightenLess:H0,lighten:G0};class gc extends mc{get fillActive(){var t,e;return((e=(t=this.container.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set fillActive(t){var e,n;t?((n=(e=this.container.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0&&(this.container.filters=[this.fillColorFilter]):this.container.filters=[]}constructor(t,e,n){super({position:{x:t.x,y:t.y},width:t.width,height:t.height},e,n),this.fillColorFilter=new ds,this.fill=new N0(this),this.json=t,this.ctx=e,this.parentGlobalPos=n.parentGlobalPos,this.global={x:n.parentGlobalPos.x+t.x,y:n.parentGlobalPos.y+t.y},this.updateTransform({position:{x:t.x,y:t.y},width:t.width,height:t.height})}get renderContainer(){return this.container}get interactiveContainer(){return this.container}clearOnSlideChange(){}initOnReuse(){}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(t){const e=t*this.ctx.stageWidth-this.global.x,n=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+e+this.container.pivot.x*n}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(t){const e=t*this.ctx.stageHeight-this.global.y,n=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+e+this.container.pivot.y*n}get design_ppt_x(){return Zs(this.global.x/this.ctx.stageWidth)}get design_ppt_y(){return Zs(this.global.y/this.ctx.stageHeight)}}class XT{constructor(t,e,n,r,o,s,a,l,h,u,p){this.ctx=t,this.type=e,this.lineWidth=n,this.width=r,this.height=o,this.fillColor=s,this.isHorz=a,this.renderContainer=new Cn.b,this.ghcTextureId=`${l}-text-p${h}-l${u}-u${p}-underLine`}createPaths(){if(this.type==="ww")return null;{let t=`M 0,0 L ${9525*this.width},0`,[e,n]=[this.width,this.lineWidth];return this.isHorz||(t="M 0,0 L 0,"+9525*this.height,[e,n]=[this.lineWidth,this.height]),{paths:[{id:cs(),path:t,fill:"norm",hasStroke:!0,scale:{x:1,y:1},hash:hh()(t)}],width:e,height:n}}}getLineStyle(){const t={width:this.lineWidth};return this.type==="dotted"&&(t.dash=""+this.lineWidth),t}preRender(){const t=this.createPaths();if(t){const{paths:e,width:n,height:r}=t,o=e.reduce((s,a)=>s+a.hash,"");this.ctx.graphicsTexture.addGraphics(this.ghcTextureId,e,o,{x:0,y:0},n,r,this.getLineStyle(),this.ctx.objectPoolGroup,!1,null,this.fillColor)}}render(){if(this.ghcTextureId){const t=this.ctx.graphicsTexture.getGraphicsData(this.ghcTextureId);t&&(this.sprite=new ci,this.sprite.texture=t.texture,this.sprite.pivot.x=t.pivot.x,this.sprite.scale.x=t.scale,this.sprite.scale.y=t.scale)}}destroy(){var t;(t=this.sprite)===null||t===void 0||t.destroy({texture:!0})}}const ir=134217729;function vc(i,t,e,n,r){let o,s,a,l,h=t[0],u=n[0],p=0,_=0;u>h==u>-h?(o=h,h=t[++p]):(o=u,u=n[++_]);let x=0;if(p<i&&_<e)for(u>h==u>-h?(s=h+o,a=o-(s-h),h=t[++p]):(s=u+o,a=o-(s-u),u=n[++_]),o=s,a!==0&&(r[x++]=a);p<i&&_<e;)u>h==u>-h?(s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p]):(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++_]),o=s,a!==0&&(r[x++]=a);for(;p<i;)s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p],o=s,a!==0&&(r[x++]=a);for(;_<e;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++_],o=s,a!==0&&(r[x++]=a);return o===0&&x!==0||(r[x++]=o),x}function YT(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function Va(i){return new Float64Array(i)}const Ks=Va(4),j0=Va(8),z0=Va(12),V0=Va(16),lr=Va(4);function dh(i,t,e,n,r,o){const s=(t-o)*(e-r),a=(i-r)*(n-o),l=s-a;if(s===0||a===0||s>0!=a>0)return l;const h=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(u,p,_,x,w,A,C){let G,K,it,ft,nt,gt,lt,dt,Ut,Ft,Et,Mt,Lt,Pt,ee,$t,zt,Xt;const pe=u-w,be=_-w,Pe=p-A,Ct=x-A;Pt=pe*Ct,gt=ir*pe,lt=gt-(gt-pe),dt=pe-lt,gt=ir*Ct,Ut=gt-(gt-Ct),Ft=Ct-Ut,ee=dt*Ft-(Pt-lt*Ut-dt*Ut-lt*Ft),$t=Pe*be,gt=ir*Pe,lt=gt-(gt-Pe),dt=Pe-lt,gt=ir*be,Ut=gt-(gt-be),Ft=be-Ut,zt=dt*Ft-($t-lt*Ut-dt*Ut-lt*Ft),Et=ee-zt,nt=ee-Et,Ks[0]=ee-(Et+nt)+(nt-zt),Mt=Pt+Et,nt=Mt-Pt,Lt=Pt-(Mt-nt)+(Et-nt),Et=Lt-$t,nt=Lt-Et,Ks[1]=Lt-(Et+nt)+(nt-$t),Xt=Mt+Et,nt=Xt-Mt,Ks[2]=Mt-(Xt-nt)+(Et-nt),Ks[3]=Xt;let Bt=YT(4,Ks),ve=22204460492503146e-32*C;if(Bt>=ve||-Bt>=ve||(nt=u-pe,G=u-(pe+nt)+(nt-w),nt=_-be,it=_-(be+nt)+(nt-w),nt=p-Pe,K=p-(Pe+nt)+(nt-A),nt=x-Ct,ft=x-(Ct+nt)+(nt-A),G===0&&K===0&&it===0&&ft===0)||(ve=11093356479670487e-47*C+33306690738754706e-32*Math.abs(Bt),Bt+=pe*ft+Ct*G-(Pe*it+be*K),Bt>=ve||-Bt>=ve))return Bt;Pt=G*Ct,gt=ir*G,lt=gt-(gt-G),dt=G-lt,gt=ir*Ct,Ut=gt-(gt-Ct),Ft=Ct-Ut,ee=dt*Ft-(Pt-lt*Ut-dt*Ut-lt*Ft),$t=K*be,gt=ir*K,lt=gt-(gt-K),dt=K-lt,gt=ir*be,Ut=gt-(gt-be),Ft=be-Ut,zt=dt*Ft-($t-lt*Ut-dt*Ut-lt*Ft),Et=ee-zt,nt=ee-Et,lr[0]=ee-(Et+nt)+(nt-zt),Mt=Pt+Et,nt=Mt-Pt,Lt=Pt-(Mt-nt)+(Et-nt),Et=Lt-$t,nt=Lt-Et,lr[1]=Lt-(Et+nt)+(nt-$t),Xt=Mt+Et,nt=Xt-Mt,lr[2]=Mt-(Xt-nt)+(Et-nt),lr[3]=Xt;const le=vc(4,Ks,4,lr,j0);Pt=pe*ft,gt=ir*pe,lt=gt-(gt-pe),dt=pe-lt,gt=ir*ft,Ut=gt-(gt-ft),Ft=ft-Ut,ee=dt*Ft-(Pt-lt*Ut-dt*Ut-lt*Ft),$t=Pe*it,gt=ir*Pe,lt=gt-(gt-Pe),dt=Pe-lt,gt=ir*it,Ut=gt-(gt-it),Ft=it-Ut,zt=dt*Ft-($t-lt*Ut-dt*Ut-lt*Ft),Et=ee-zt,nt=ee-Et,lr[0]=ee-(Et+nt)+(nt-zt),Mt=Pt+Et,nt=Mt-Pt,Lt=Pt-(Mt-nt)+(Et-nt),Et=Lt-$t,nt=Lt-Et,lr[1]=Lt-(Et+nt)+(nt-$t),Xt=Mt+Et,nt=Xt-Mt,lr[2]=Mt-(Xt-nt)+(Et-nt),lr[3]=Xt;const se=vc(le,j0,4,lr,z0);Pt=G*ft,gt=ir*G,lt=gt-(gt-G),dt=G-lt,gt=ir*ft,Ut=gt-(gt-ft),Ft=ft-Ut,ee=dt*Ft-(Pt-lt*Ut-dt*Ut-lt*Ft),$t=K*it,gt=ir*K,lt=gt-(gt-K),dt=K-lt,gt=ir*it,Ut=gt-(gt-it),Ft=it-Ut,zt=dt*Ft-($t-lt*Ut-dt*Ut-lt*Ft),Et=ee-zt,nt=ee-Et,lr[0]=ee-(Et+nt)+(nt-zt),Mt=Pt+Et,nt=Mt-Pt,Lt=Pt-(Mt-nt)+(Et-nt),Et=Lt-$t,nt=Lt-Et,lr[1]=Lt-(Et+nt)+(nt-$t),Xt=Mt+Et,nt=Xt-Mt,lr[2]=Mt-(Xt-nt)+(Et-nt),lr[3]=Xt;const Ie=vc(se,z0,4,lr,V0);return V0[Ie-1]}(i,t,e,n,r,o,h)}const W0=Math.pow(2,-52),ph=new Uint32Array(512);class _c{static from(t,e=ZT,n=KT){const r=t.length,o=new Float64Array(2*r);for(let s=0;s<r;s++){const a=t[s];o[2*s]=e(a),o[2*s+1]=n(a)}return new _c(o)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let Ft=0;Ft<s;Ft++){const Et=t[2*Ft],Mt=t[2*Ft+1];Et<a&&(a=Et),Mt<l&&(l=Mt),Et>h&&(h=Et),Mt>u&&(u=Mt),this._ids[Ft]=Ft}const p=(a+h)/2,_=(l+u)/2;let x,w,A,C=1/0;for(let Ft=0;Ft<s;Ft++){const Et=yc(p,_,t[2*Ft],t[2*Ft+1]);Et<C&&(x=Ft,C=Et)}const G=t[2*x],K=t[2*x+1];C=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x)continue;const Et=yc(G,K,t[2*Ft],t[2*Ft+1]);Et<C&&Et>0&&(w=Ft,C=Et)}let it=t[2*w],ft=t[2*w+1],nt=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x||Ft===w)continue;const Et=JT(G,K,it,ft,t[2*Ft],t[2*Ft+1]);Et<nt&&(A=Ft,nt=Et)}let gt=t[2*A],lt=t[2*A+1];if(nt===1/0){for(let Mt=0;Mt<s;Mt++)this._dists[Mt]=t[2*Mt]-t[0]||t[2*Mt+1]-t[1];$s(this._ids,this._dists,0,s-1);const Ft=new Uint32Array(s);let Et=0;for(let Mt=0,Lt=-1/0;Mt<s;Mt++){const Pt=this._ids[Mt];this._dists[Pt]>Lt&&(Ft[Et++]=Pt,Lt=this._dists[Pt])}return this.hull=Ft.subarray(0,Et),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(dh(G,K,it,ft,gt,lt)<0){const Ft=w,Et=it,Mt=ft;w=A,it=gt,ft=lt,A=Ft,gt=Et,lt=Mt}const dt=function(Ft,Et,Mt,Lt,Pt,ee){const $t=Mt-Ft,zt=Lt-Et,Xt=Pt-Ft,pe=ee-Et,be=$t*$t+zt*zt,Pe=Xt*Xt+pe*pe,Ct=.5/($t*pe-zt*Xt);return{x:Ft+(pe*be-zt*Pe)*Ct,y:Et+($t*Pe-Xt*be)*Ct}}(G,K,it,ft,gt,lt);this._cx=dt.x,this._cy=dt.y;for(let Ft=0;Ft<s;Ft++)this._dists[Ft]=yc(t[2*Ft],t[2*Ft+1],dt.x,dt.y);$s(this._ids,this._dists,0,s-1),this._hullStart=x;let Ut=3;n[x]=e[A]=w,n[w]=e[x]=A,n[A]=e[w]=x,r[x]=0,r[w]=1,r[A]=2,o.fill(-1),o[this._hashKey(G,K)]=x,o[this._hashKey(it,ft)]=w,o[this._hashKey(gt,lt)]=A,this.trianglesLen=0,this._addTriangle(x,w,A,-1,-1,-1);for(let Ft,Et,Mt=0;Mt<this._ids.length;Mt++){const Lt=this._ids[Mt],Pt=t[2*Lt],ee=t[2*Lt+1];if(Mt>0&&Math.abs(Pt-Ft)<=W0&&Math.abs(ee-Et)<=W0||(Ft=Pt,Et=ee,Lt===x||Lt===w||Lt===A))continue;let $t=0;for(let Pe=0,Ct=this._hashKey(Pt,ee);Pe<this._hashSize&&($t=o[(Ct+Pe)%this._hashSize],$t===-1||$t===n[$t]);Pe++);$t=e[$t];let zt,Xt=$t;for(;zt=n[Xt],dh(Pt,ee,t[2*Xt],t[2*Xt+1],t[2*zt],t[2*zt+1])>=0;)if(Xt=zt,Xt===$t){Xt=-1;break}if(Xt===-1)continue;let pe=this._addTriangle(Xt,Lt,n[Xt],-1,-1,r[Xt]);r[Lt]=this._legalize(pe+2),r[Xt]=pe,Ut++;let be=n[Xt];for(;zt=n[be],dh(Pt,ee,t[2*be],t[2*be+1],t[2*zt],t[2*zt+1])<0;)pe=this._addTriangle(be,Lt,zt,r[Lt],-1,r[be]),r[Lt]=this._legalize(pe+2),n[be]=be,Ut--,be=zt;if(Xt===$t)for(;zt=e[Xt],dh(Pt,ee,t[2*zt],t[2*zt+1],t[2*Xt],t[2*Xt+1])<0;)pe=this._addTriangle(zt,Lt,Xt,-1,r[Xt],r[zt]),this._legalize(pe+2),r[zt]=pe,n[Xt]=Xt,Ut--,Xt=zt;this._hullStart=e[Lt]=Xt,n[Xt]=e[be]=Lt,n[Lt]=be,o[this._hashKey(Pt,ee)]=Lt,o[this._hashKey(t[2*Xt],t[2*Xt+1])]=Xt}this.hull=new Uint32Array(Ut);for(let Ft=0,Et=this._hullStart;Ft<Ut;Ft++)this.hull[Ft]=Et,Et=n[Et];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(n,r){const o=n/(Math.abs(n)+Math.abs(r));return(r>0?3-o:1+o)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let o=0,s=0;for(;;){const a=n[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=ph[--o];continue}const h=a-a%3,u=l+(t+1)%3,p=h+(a+2)%3,_=e[s],x=e[t],w=e[u],A=e[p];if(qT(r[2*_],r[2*_+1],r[2*x],r[2*x+1],r[2*w],r[2*w+1],r[2*A],r[2*A+1])){e[t]=A,e[a]=_;const C=n[p];if(C===-1){let K=this._hullStart;do{if(this._hullTri[K]===p){this._hullTri[K]=t;break}K=this._hullPrev[K]}while(K!==this._hullStart)}this._link(t,C),this._link(a,n[s]),this._link(s,p);const G=h+(a+1)%3;o<ph.length&&(ph[o++]=G)}else{if(o===0)break;t=ph[--o]}}return s}_link(t,e){this._halfedges[t]=e,e!==-1&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function yc(i,t,e,n){const r=i-e,o=t-n;return r*r+o*o}function qT(i,t,e,n,r,o,s,a){const l=i-s,h=t-a,u=e-s,p=n-a,_=r-s,x=o-a,w=u*u+p*p,A=_*_+x*x;return l*(p*A-w*x)-h*(u*A-w*_)+(l*l+h*h)*(u*x-p*_)<0}function JT(i,t,e,n,r,o){const s=e-i,a=n-t,l=r-i,h=o-t,u=s*s+a*a,p=l*l+h*h,_=.5/(s*h-a*l),x=(h*u-a*p)*_,w=(s*p-l*u)*_;return x*x+w*w}function $s(i,t,e,n){if(n-e<=20)for(let r=e+1;r<=n;r++){const o=i[r],s=t[o];let a=r-1;for(;a>=e&&t[i[a]]>s;)i[a+1]=i[a--];i[a+1]=o}else{let r=e+1,o=n;Wa(i,e+n>>1,r),t[i[e]]>t[i[n]]&&Wa(i,e,n),t[i[r]]>t[i[n]]&&Wa(i,r,n),t[i[e]]>t[i[r]]&&Wa(i,e,r);const s=i[r],a=t[s];for(;;){do r++;while(t[i[r]]<a);do o--;while(t[i[o]]>a);if(o<r)break;Wa(i,r,o)}i[e+1]=i[o],i[o]=s,n-r+1>=o-e?($s(i,t,r,n),$s(i,t,e,o-1)):($s(i,t,e,o-1),$s(i,t,r,n))}}function Wa(i,t,e){const n=i[t];i[t]=i[e],i[e]=n}function ZT(i){return i[0]}function KT(i){return i[1]}function $T(i,t,e){let n=null;const r=new Cn.b;if(i.stopList.sort((s,a)=>s.pos-a.pos),!i.stopList.find(s=>s.pos===0)){const s=i.stopList[0];i.stopList.unshift({pos:0,color:s.color})}if(!i.stopList.find(s=>s.pos===1)){const s=i.stopList[i.stopList.length-1];i.stopList.push({pos:1,color:s.color})}const o=s=>{const a=[];for(let l=0,h=s.length;l<h-1;l++){const u=s[l],p=s[l+1],_=u.pos+.5*(p.pos-u.pos),x=za(u.color,p.color,.5),w=2*l;a[w]=u,a[w+1]={color:x,pos:_},a[w+2]=p}return a};if(i.stopList=o(i.stopList),i.stopList=o(i.stopList),n=i.line?X0(i,t,e):i.path?function(s,a,l){var h,u,p;const _=[],x={x:0,y:0};if(((h=s.path)===null||h===void 0?void 0:h.path)==="circle"||((u=s.path)===null||u===void 0?void 0:u.path)==="rect"||((p=s.path)===null||p===void 0?void 0:p.path)==="shape"){const w=a/2,A=l/2,C=Math.sqrt(w*w+A*A);s.stopList.forEach(G=>{if(G.pos===0)_.push({point:{x:0,y:0},color:G.color});else{const K=C*G.pos,it=new ks;it.absellipse(0,0,K,K,0,2*Math.PI,!1,0),it.getPoints(50).forEach(ft=>{_.push({point:{x:ft.x,y:ft.y},color:G.color})})}x.x=w,x.y=A})}return{points:_,position:x}}(i,t,e):X0(i,t,e),n){const s=[],a=[],{position:l,points:h}=n,u=_c.from(h,A=>A.point.x,A=>A.point.y);for(let A=0;A<u.triangles.length;A+=3)s.push(h[u.triangles[A]].point.x,h[u.triangles[A]].point.y),s.push(h[u.triangles[A+1]].point.x,h[u.triangles[A+1]].point.y),s.push(h[u.triangles[A+2]].point.x,h[u.triangles[A+2]].point.y),a.push(...dr(h[u.triangles[A]].color)),a.push(...dr(h[u.triangles[A+1]].color)),a.push(...dr(h[u.triangles[A+2]].color));const p=new ue.l;p.addAttribute("aVertexPosition",s,2),p.addAttribute("aColor",a,4);const _=ue.r.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            float alpha = vColor.a;
            vec4 color = vColor;
            color.a = 1.0;
            gl_FragColor = color * alpha;
        }
    `),x=new $i;x.drawRect(0,0,t+1,e+1),r.mask=x,r.addChild(x);const w=new Xs.a(p,_);w.position.x=l.x,w.position.y=l.y,r.addChild(w)}return r}function X0(i,t,e){const n=t/2,r=e/2,o=[{x:-n,y:r},{x:-n,y:-r},{x:n,y:r},{x:n,y:-r}],s=[Vo.fromPointSlope({x:-n,y:0},Math.PI/2),Vo.fromPointSlope({x:0,y:r},0),Vo.fromPointSlope({x:n,y:0},Math.PI/2),Vo.fromPointSlope({x:0,y:-r},0)],a=[],l=i.stopList.slice(1,i.stopList.length-1).map(w=>{var A,C,G;const K=2*Math.PI;let it=(C=(A=i.line)===null||A===void 0?void 0:A.ang)!==null&&C!==void 0?C:0;for(;it>K;)it-=K;for(;it<0;)it+=K;const ft={x:0,y:0};wr(it,Math.PI/2)?(ft.x=0,ft.y=e/2-w.pos*e):wr(it,0)?(ft.x=w.pos*t-t/2,ft.y=0):(ft.x=w.pos*t-t/2,ft.y=e/2-w.pos*e),it>Math.PI/2&&it<=Math.PI&&(ft.x*=-1),it>Math.PI&&it<=2*Math.PI&&(ft.y*=-1);const nt=Vo.fromPointSlope(ft,Math.PI/2-(((G=i.line)===null||G===void 0?void 0:G.ang)||0)),gt=s.map(dt=>nt.crossPoint(dt)).filter(dt=>dt&&dt.x<=n&&dt.x>=-n&&dt.y<=r&&dt.y>=-r).map(dt=>({point:dt,color:w.color})).sort((dt,Ut)=>Ut.point.y-dt.point.y);a.push(...gt);let lt=Math.abs(gt[1].point.x-gt[0].point.x)/10;for(let dt=20;dt--;){const Ut=dt%2==0?1:-1,Ft=ft.x+Ut*lt,Et=nt.resolveY(Ft);Ft<=n&&Ft>=-n&&Et<=r&&Et>=-r&&a.push({point:{x:Ft,y:Et},color:w.color}),lt+=lt}return nt});let h=[],u=[];t:for(let w=0;w<o.length;w++){const A=o[w];for(let ft=0;ft<l.length-1;ft++){const nt=l[ft],gt=l[ft+1],lt=nt.distanceToLinearEquation(gt),dt=nt.distanceToPoint(A),Ut=gt.distanceToPoint(A);if(dt<lt&&Ut<lt){const Ft=i.stopList.slice(1,i.stopList.length-1)[ft],Et=i.stopList.slice(1,i.stopList.length-1)[ft+1],Mt=za(Ft.color,Et.color,dt/lt);a.splice(ft+1,0,{point:A,color:Mt});continue t}}const C=l[0],G=l[l.length-1],K=C.distanceToPoint(A),it=G.distanceToPoint(A);K<=it?h.push({point:A,dis:K}):u.push({point:A,dis:it})}h=h.sort((w,A)=>A.dis-w.dis);const p=h.map((w,A)=>{if(A===0)return{point:w.point,color:i.stopList[0].color};{const C=i.stopList[0].color,G=i.stopList[1].color;return{point:w.point,color:za(C,G,1-(h[0].dis===0?1:w.dis/h[0].dis))}}}).sort((w,A)=>A.point.y-w.point.y);u=u.sort((w,A)=>A.dis-w.dis);const _=u.map((w,A)=>{if(A===0)return{point:w.point,color:i.stopList[i.stopList.length-1].color};{const C=i.stopList[i.stopList.length-2].color,G=i.stopList[i.stopList.length-1].color;return{point:w.point,color:za(C,G,u[0].dis===0?0:w.dis/u[0].dis)}}}).sort((w,A)=>A.point.y-w.point.y),x=p.concat(...a).concat(_);for(let w=0;w<x.length;w++)x[w].point.x+=n,x[w].point.y=-x[w].point.y+r;return{points:x,position:{x:0,y:0}}}const fh=`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`,QT=[fh],tw={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= arg || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0) * texColor.a;
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0) * texColor.a;
    }
}
`,alphaModFix:`
vec4 transform(vec4 texColor, float arg) {
   return texColor * arg;
}
`,alphaBiLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < arg) {
        result.a = 0.0;
    } else {
        result.a = 1.0;
    }
    return result;
}
`,alphaCeiling:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a > 0.0) {
        result.a = 1.0;
    }
    return result;
}
`,alphaFloor:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < 1.0) {
        result.a = 0.0;
    }
    return result;
}
`,grayscl:`
vec4 transform(vec4 texColor, float arg) {
    float avg = (texColor.r + texColor.g + texColor.b) / 3.0;
    return vec4(avg, avg, avg, texColor.a);
}
`};class ew extends ue.k{constructor(t,e){var n;super(void 0,(n=tw[t],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${QT.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:e})}}const nw=[fh],iw={clrChange:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    float epsilon = 0.001;
    vec3 colorDiff = arg1.rgb - (texColor.rgb / max(texColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    if (colorDistance < epsilon) {
        arg2.rgb *= arg2.a;
        return arg2;
    } else {
        return texColor;
    }
}
`,changeBulletColor:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    if (texColor.a == 0.0) {
        return texColor;
    } else {
        return arg2;
    }
}
`,duotone:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    // float avg = (texColor.r + texColor.g + texColor.b) / 3.0;
    // vec3 hsl = rgb2hsl(vec3(avg, avg, avg));
    // vec3 result = arg2.rgb * hsl.z + arg1.rgb * (1.0 - hsl.z);
    // return vec4(result * texColor.a, texColor.a);
    
    float brightness = texColor.r * 0.3 + texColor.g * 0.59 + texColor.b * 0.11;
    
    return vec4(
        (arg1.r + brightness * (arg2.r - arg1.r)) * texColor.a,
        (arg1.g + brightness * (arg2.g - arg1.g)) * texColor.a,
        (arg1.b + brightness * (arg2.b - arg1.b)) * texColor.a,
        texColor.a
    );
}
`};class rw extends ue.k{constructor(t,e,n){var r;super(void 0,(r=iw[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform vec4 arg2;
uniform sampler2D uSampler;

${nw.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:Float32Array.from(e),arg2:Float32Array.from(n)})}}const ow=[fh],sw={lum:`
vec4 transform(vec4 texColor, float arg1, float arg2) {
    vec3 rgb = texColor.rgb / texColor.a;

    // \u5BF9\u6BD4\u5EA6
    highp float C = arg2 * 255.0;
    highp float F = (259.0 * (255.0 + C)) / (255.0 * (259.0 - C));
    rgb.rgb = F * (rgb.rgb - 0.5) + 0.5;

    // \u4EAE\u5EA6
    rgb.rgb += arg1 * rgb.rgb;

    rgb.rgb *= texColor.a;
    return vec4(rgb, texColor.a);
}
`};class aw extends ue.k{constructor(t,e,n){var r;super(void 0,(r=sw[t],`
varying vec2 vTextureCoord;

uniform float arg1;
uniform float arg2;
uniform sampler2D uSampler;

${ow.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:e,arg2:n})}}const lw=[fh],hw={alphaInv:`
vec4 transform(vec4 texColor, vec4 arg1) {
    float alpha = 1.0 - texColor.a;
    arg1.rgb = arg1.rgb * alpha;
    arg1.a = alpha;
    return arg1;
}
`};class uw extends ue.k{constructor(t,e){var n;super(void 0,(n=hw[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform sampler2D uSampler;

${lw.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1);
}
`),{arg1:Float32Array.from(e)})}}function Y0(i,t){const e=[];return i.forEach(n=>{const r=((t==null?void 0:t.filter)||[]).indexOf(n.type)>=0;if(["biLevel","alphaBiLevel","alphaCeiling","alphaModFix","alphaFloor","grayscl"].indexOf(n.type)>=0&&r)e.push(new ew(n.type,n.args[0]||0));else if(["clrChange","changeBulletColor","duotone"].indexOf(n.type)>=0&&r){const o=dr(n.args[0]),s=dr(n.args[1]);e.push(new rw(n.type,o,s))}else if(n.type==="lum"&&r)e.push(new aw(n.type,n.args[0],n.args[1]));else if(n.type==="alphaInv"&&r){const o=dr(n.args[0]);e.push(new uw(n.type,o))}}),e}class mo{get displayObject(){return this._displayObject||(this._displayObject=this.createDisplayObject()),this._displayObject}set displayObject(t){this._displayObject&&this._displayObject.destroy({children:!0,texture:!0}),this._displayObject=t}get hasFill(){return!!this.fillStyle&&this.fillStyle.fillType!=="noFill"}constructor(t,e,n,r,o){this.ctx=t,this.fillStyle=e,this.width=n,this.height=r,this.config=o,this.clonedObjects=[],this._displayObject=null,this.gradientHash=hh()(`${JSON.stringify(e)}${Math.ceil(n)}${Math.ceil(r)}`)}createDisplayObject(){var t,e;if(!this.fillStyle)return null;if(this.config.useSlideBackgroundFill&&this.ctx.bgTexture){const n=new ci;return n.texture=this.ctx.bgTexture,n}if(this.fillStyle.fillType==="solidFill"||this.fillStyle.fillType==="noFill")return null;if(this.fillStyle.fillType==="gradientFill"){const n=new ci,r=$T(JSON.parse(JSON.stringify(this.fillStyle)),this.width,this.height),o=ue.p.create({width:this.width,height:this.height,resolution:this.ctx.renderer.resolution});return this.ctx.renderer.render(r,{renderTexture:o}),r.destroy({children:!0,texture:!0}),n.texture=o,n}if(this.fillStyle.fillType==="blipFill"){const{src:n,filters:r}=this.fillStyle,o=this.ctx.spriteTexture.getTexture(n),s=this.ctx.spriteTexture.getFrameData(n);if(o){const a=new ci;if(a.texture=o,r.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(a.filters=Y0(r,this.ctx.featureList)),this.config.fillFloat){const{l,t:h,r:u,b:p}=this.config.fillFloat.fillRect,_=this.width*(1-l-u),x=this.height*(1-h-p),w=((t=this.config.shapeRotation)!==null&&t!==void 0?t:0)+((e=this.config.groupRotation)!==null&&e!==void 0?e:0),A=new $i;A.drawRect(0,0,_,x),A.pivot.x=_/2,A.pivot.y=x/2,A.rotation=w;const C=A.getBounds(),G=C.width,K=C.height;a.width=G,a.height=K,a.anchor.x=.5,a.anchor.y=.5,a.rotation=-1*w,a.name="math-texture",w===0?(a.position.x=G/2+l*this.width,a.position.y=K/2+h*this.height):(a.position.x=this.width/2,a.position.y=this.height/2)}else a.width=this.width,a.height=this.height,s.rotate&&(a.position.x=this.width/2,a.position.y=this.height/2,a.anchor.x=.5,a.anchor.y=.5,a.rotation=s.rotate/180*Math.PI);return a}}else if(this.fillStyle.fillType==="gifFill"){const{src:n,delays:r,filters:o}=this.fillStyle,s=this.ctx.spriteTexture.getGifFrames(n).map((u,p)=>({texture:u,time:r[p]||20})),a=new ih(s,!0);a.name=cs(),a.width=this.width,a.height=this.height,o.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(a.filters=Y0(o,this.ctx.featureList));const l=this.fillStyle.loop;let h=1;return a.onLoop=()=>{h+=1,l>0&&h>l&&a.gotoAndStop(a.totalFrames-1)},a}return null}isSolidFill(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"}getSolidFillColor(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"?this.fillStyle.color:"#000000"}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}class xc extends ue.k{}var cw=v(113),dw=v.n(cw),pw=v(114),fw=v.n(pw);class mw extends xc{constructor(t){super(dw.a,fw.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uGlowColor:dr(t.color),uSdfSampler:ue.t.WHITE,uSdfReady:0,uSdfMaxDis:0,uRad:t.rad/2,uSdfPosition:new Float32Array([0,0])}),this.priority=3,this.json=t}filterAreaJustify(t){const e=Math.ceil(this.json.rad),n=Math.ceil(t.width+2*e),r=Math.ceil(t.height+2*e);return new Oe.j(t.x-e,t.y-e,n,r)}sdfBox(t,e){const n=Math.ceil(this.json.rad),r=Math.ceil(t+2*n),o=Math.ceil(e+2*n);return new Oe.j(n,n,r,o)}}var gw=v(19),mh=v.n(gw),vw=v(115),_w=v.n(vw);class yw extends xc{constructor(t){super(mh.a,_w.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uRad:t.rad,uSdfSampler:ue.t.WHITE,uSdfReady:0,uSdfMaxDis:1}),this.priority=2,this.json=t}filterAreaJustify(t){return t}sdfBox(t,e){return new Oe.j(0,0,t,e)}}class q0{}var xw=v(116),bw=v.n(xw);class Tw extends ue.k{constructor(t){super(mh.a,bw.a,{uColor:dr(t)})}}class ww extends q0{constructor(t,e,n){super(),this.order=1,this.outputTexture=ue.t.WHITE,this.frameTextures=[],this.json=t,this.effectContainer=e,this.outputSprite=new ci,this.targetScale=n,this.outputSprite.scale.x=this.json.sx,this.outputSprite.scale.y=this.json.sy,this.outputSprite.skew.x=(this.targetScale.x>0?1:-1)*this.json.kx,this.outputSprite.skew.y=(this.targetScale.y>0?1:-1)*this.json.ky,this.outputSprite.filters=[new qs.BlurFilter(this.json.blurRad/2,4),new Tw(this.json.color)]}updateFrame(t){const e=this.frameTextures[t];if(e){const n=this.effectContainer.getBounds(),r=(this.effectContainer.width-e.width)/2,o=(this.effectContainer.height-e.height)/2,s=new Oe.g(n.x,n.y),a=new Oe.g(n.x,n.y);switch(this.json.align){case"tl":a.x=n.x,a.y=n.y;break;case"t":a.x=n.x+n.width/2,a.y=n.y,s.x+=n.width/2;break;case"tr":a.x=n.x+n.width,a.y=n.y,s.x+=n.width;break;case"l":a.x=n.x,a.y=n.y+n.height/2,s.y+=n.height/2;break;case"ctr":a.x=n.x+n.width/2,a.y=n.y+n.height/2,s.x+=n.width/2,s.y+=n.height/2;break;case"r":a.x=n.x+n.width,a.y=n.y+n.height/2,s.x+=n.width,s.y+=n.height/2;break;case"bl":a.x=n.x,a.y=n.y+n.height,s.y+=n.height;break;case"b":a.x=n.x+n.width/2,a.y=n.y+n.height,s.x+=n.width/2,s.y+=n.height;break;case"br":a.x=n.x+n.width,a.y=n.y+n.height,s.x+=n.width,s.y+=n.height}const l=this.effectContainer.toLocal(a);this.outputSprite.pivot.x=l.x,this.outputSprite.pivot.y=l.y;const h=new Oe.g(this.json.dist,0),u=new Oe.d;u.rotate(this.json.dir),u.translate(s.x+r,s.y+o),u.apply({x:h.x,y:h.y},h);const p=this.effectContainer.toLocal(h);this.outputSprite.position.x=p.x,this.outputSprite.position.y=p.y,this.outputSprite.texture=e}}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){}}var Sw=v(117),Ew=v.n(Sw);class Aw extends ue.k{constructor(t,e){super(mh.a,Ew.a,{uStartAlpha:t.startAlpha,uEndAlpha:t.endAlpha,uStartPos:t.startPos,uEndPos:t.endPos,uHeight:e}),console.log(this)}}class Mw extends q0{constructor(t,e,n,r,o){super(),this.order=2,this.outputSprite=new ci,this.outputTexture=ue.t.WHITE,this.frameTextures=[],this.json=t,this.shapeScaleX=r,this.effectContainer=e,this.rotation=n,this.ctx=o,this.outputSprite.anchor.x=.5,this.outputSprite.anchor.y=.5;const s=this.effectContainer.getBounds();this.outputSprite.filters=[new qs.BlurFilter(this.json.blurRad/2,4),new Aw(this.json,s.height)],this.outputSprite.alpha=.5,this.outputSprite.rotation=this.shapeScaleX===-1?Math.PI+2*this.rotation:Math.PI-2*this.rotation,this.outputSprite.scale.x=-1}updateFrame(t){const e=this.frameTextures[t];e&&(this.outputSprite.texture=e)}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){const n=this.effectContainer.getBounds(),r=new Oe.g(n.x+n.width/2,n.y+n.height/2),o=new Oe.g(r.x,r.y+n.height+this.json.dist),s=this.effectContainer.toLocal(o);this.outputSprite.position.x=s.x+t,this.outputSprite.position.y=s.y+e}}var Cw=v(118),Rw=v.n(Cw);class Iw extends xc{constructor(t){super(mh.a,Rw.a,{}),this.priority=1,this.json=t}filterAreaJustify(t){return t}sdfBox(){return null}}var J0=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Z0 extends fi.a{get container(){return this._targetContainer}constructor(t,e,n,r,o,s){super(),this.effects=[],this.attachs=[],this.frames=new Map,this._targetContainer=new Cn.b,this.frameCount=1,this.ctx=r,this.originWidth=t.width,this.originHeight=t.height,this.cacheKey=n,this.sourceSprite=new ci;for(const x of e)switch(x.type){case"innerShadow":this.effects.push(new Iw(x));break;case"softEdge":this.effects.push(new yw(x));break;case"glow":this.effects.push(new mw(x));break;case"reflection":this.attachs.push(new Mw(x,t,o,s.x,this.ctx));break;case"outerShadow":this.attachs.push(new ww(x,t,s))}this.effects=this.effects.sort((x,w)=>x.priority-w.priority),this.attachs=this.attachs.sort((x,w)=>x.order-w.order);for(const x of this.attachs)this._targetContainer.addChild(x.outputSprite);this.sourceSprite.name="source-sprite";const a=new Oe.j(0,0,this.originWidth,this.originHeight),l=this.effects.map(x=>x.filterAreaJustify(a)),h=l.map(x=>x.x),u=l.map(x=>x.y),p=l.map(x=>x.width),_=l.map(x=>x.height);this.filterArea=new Oe.j(Math.min(...h,0),Math.min(...u,0),Math.max(...p,this.originWidth),Math.max(..._,this.originHeight)),this.sourceSprite.filters=this.effects,this.sourceSprite.filterArea=new Oe.j(0,0,this.filterArea.width,this.filterArea.height),this._targetSprite=new ci,this._targetSprite.name="effect-sprite",this._targetContainer.sortableChildren=!0,this._targetSprite.zIndex=999,this._targetContainer.addChild(this._targetSprite)}getSdfTexture(t,e){return J0(this,void 0,void 0,function*(){const n=`${this.cacheKey}_${t}`,r=this.effects.map(o=>({sdfRect:o.sdfBox(e.width,e.height)})).reduce((o,s)=>(s.sdfRect&&(o.width<s.sdfRect.width&&(o.width=s.sdfRect.width),o.height<s.sdfRect.height&&(o.height=s.sdfRect.height)),o),new Oe.j(0,0));return r.width===0||r.height===0?null:this.ctx.sdfManager.getSdf(e,r,n)})}setFrameCount(t){this.frameCount=t}updateFrame(t){const e=this.frames.get(t);if(e){this._targetSprite.texture=e.texture,this._targetSprite.pivot.x=e.pivotX,this._targetSprite.pivot.y=e.pivotY;for(const n of this.attachs)n.updateFrame(t)}}hasFrame(t){return this.frames.has(t)}setFrameOffset(t,e){this._targetContainer.position.x=-1*t,this._targetContainer.position.y=-1*e,this.attachs.forEach(n=>n.setFrameOffset(t,e))}createFrame(t,e){var n,r;return J0(this,void 0,void 0,function*(){const o=e.width,s=e.height;if(this.frames.has(t))return;const a=yield this.getSdfTexture(t,e),l=(n=a==null?void 0:a.texture.width)!==null&&n!==void 0?n:0,h=(r=a==null?void 0:a.texture.height)!==null&&r!==void 0?r:0;for(const A of this.effects){const C=A.sdfBox(e.width,e.height);C&&a&&(A.uniforms.uSdfSampler=a.texture,A.uniforms.uSdfIsReady=1,A.uniforms.uSdfMaxDis=a.maxDis,A.uniforms.uSdfPosition=new Float32Array([(a.texture.width-C.width)/2/a.texture.width,(a.texture.height-C.height)/2/a.texture.height])),A.uniforms.uShapeFilterArea=new Float32Array([0,0,this.filterArea.width,this.filterArea.height])}this.sourceSprite.texture=e;const u=(this.filterArea.width-this.sourceSprite.width)/2,p=(this.filterArea.height-this.sourceSprite.height)/2;this.sourceSprite.x=u,this.sourceSprite.y=p;const _=Math.max(o,l,this.filterArea.width),x=Math.max(s,h,this.filterArea.height),w=ue.p.create({width:_,height:x,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.sourceSprite,{renderTexture:w}),this.frames.set(t,{texture:w,pivotX:-1*(this.originWidth-_)/2,pivotY:-1*(this.originWidth-_)/2});for(const A of this.attachs)A.createOutput(w,t);Array.from(this.frames.keys()).length===this.frameCount&&this.emit("ready")})}}var K0=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Pw extends gc{constructor(t,e,n){var r;super(t,e,n),this.textureContainer=new Cn.b,this.underline=null,this.cacheSprite=new ci,this.effectContainer=new Cn.b,this.effectObject=null;const{shapeId:o,paragraphIndex:s,lineIndex:a,unitIndex:l,lineHeight:h,width:u,underLine:p,fill:_,height:x,isHorz:w,lineWidth:A}=t,C=((r=_==null?void 0:_.fill)===null||r===void 0?void 0:r.fillType)==="solidFill"?_.fill.color:null;if(p){const G=w?h/16:A/16;this.underline=new XT(e,p.type,G,u,x,C,w,o,s,a,l)}if(this.textGraphics=this.createTextGraphics(),this.textFill=this.createTextFill(),this.strokeGraphics=this.createStrokeGraphics(),this.strokeFill=this.createStrokeFill(),this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),t.effectIndexList&&t.effectIndexList.length&&n.effectList){const{effectList:G}=n;this.effectList=t.effectIndexList.map(K=>{const it=G[K];return it.type==="outerShadow"&&it.dist>5&&(it.dist=5),G[K]}),this.ctx.slideScopeEventHub.once("slide-render",K=>{if(this.ctx.slideIndex===K&&this.effectObject){const it=this.getEffectTexture();if(it){const{texture:ft,offsetX:nt,offsetY:gt}=it;this.effectObject.setFrameOffset(nt,gt),this.effectObject.createFrame(1,ft)}}})}}getEffectTexture(){const{lineHeight:t,fillLineHeight:e,isHorz:n,lineWidth:r}=this.json,o=this.effectContainer.getLocalBounds();let s=0,a=0;for(const u of this.effectContainer.children)u.pivot.x>s&&(s=u.pivot.x),u.pivot.y>a&&(a=u.pivot.y);const l=new Oe.d;l.translate(s,a);const h=ue.p.create({width:n?o.width:r,height:n?Math.max(e,t):o.height,resolution:.5});return this.ctx.renderer.render(this.effectContainer,{renderTexture:h,transform:l}),{texture:h,offsetX:s,offsetY:a}}createStrokeFill(){const{stroke:t,lineWidth:e,lineHeight:n}=this.json;return new mo(this.ctx,t==null?void 0:t.fill,e,n,{useFilter:!1,useSlideBackgroundFill:!1})}createStrokeGraphics(){const{stroke:t}=this.json,e=t!=null&&t.key?{fillType:"blipFill",src:t.key,filters:[]}:void 0;return new mo(this.ctx,e,(t==null?void 0:t.width)||0,(t==null?void 0:t.height)||0,{useFilter:!1,useSlideBackgroundFill:!1})}applyEffectCacheAsBitMap(){}createTextFill(){const{isHorz:t,fill:e,lineWidth:n,lineHeight:r,fillLineHeight:o}=this.json;return t?new mo(this.ctx,e==null?void 0:e.fill,n,Math.max(o,r),{useFilter:!1,useSlideBackgroundFill:!1}):new mo(this.ctx,e==null?void 0:e.fill,o,r,{useFilter:!1,useSlideBackgroundFill:!1})}createTextGraphics(){var t;const{fill:e,content:n}=this.json;let r="#000000";((t=e==null?void 0:e.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"&&(r=e.fill.color);const o=e!=null&&e.key?{fillType:"blipFill",src:e.key,filters:[{type:"changeBulletColor",args:["#000000",r]}]}:void 0;return new mo(this.ctx,o,(e==null?void 0:e.width)||0,(e==null?void 0:e.height)||0,{useFilter:n==="\u25FE",useSlideBackgroundFill:!1})}getIterateEntry(){return null}getBgElement(){return null}updateTransform(t){var e,n,r,o;const{isHorz:s}=this.json;t.position={x:s&&(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:s?0:(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0},t.width=s?this.json.width:this.json.lineWidth,t.height=s?this.json.lineHeight:this.json.height,super.updateTransform(t)}preRender(){var t;(t=this.underline)===null||t===void 0||t.preRender()}render(t){t.addSubMTask(()=>K0(this,void 0,void 0,function*(){this.doRender()}),"@TextUnitImpl[doRender]"),t.addSubMTask(()=>K0(this,void 0,void 0,function*(){var e;if(this.effectList&&this.effectList.length>0){const n=`${this.ctx.taskId}_${this.ctx.slideIndex}_${(e=this.json.fill)===null||e===void 0?void 0:e.key}_${this.json.effectIndexList}`;this.effectObject=new Z0(this.effectContainer,this.effectList,n,this.ctx,0,new Oe.g(1,1)),this.effectObject.on("ready",()=>{var r;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(r=this.effectObject)===null||r===void 0||r.updateFrame(1)})}}),"@ShapeImpl[post.render]")}doRender(){let t=!1;const{lineWidth:e,lineHeight:n,baseLine:r,isHorz:o,underline:s,stroke:a,height:l,width:h,highlightColor:u,x:p,y:_,content:x,fillLineHeight:w,fill:A}=this.json;let C=this.json.needFill!==!1;if(A&&A.fill&&A.fill.fillType!=="solidFill"&&(C=!0),u){const G=new $i,[K,it]=F0(u);G.beginFill(K,it),G.drawRect(0,0,o?h:e,o?n:l),G.endFill(),this.textureContainer.addChild(G)}if(this.textGraphics.displayObject){const G=this.textGraphics.displayObject;if(o&&(G.position.y=_>0?_:0),C){const K=this.textFill.displayObject;if(K)K.mask=G,K.addChild(G),K.position.x=-p,G.position.x+=p,t=!0,this.textureContainer.addChild(K);else if(this.textFill.isSolidFill()){const it=new ds;it.color=this.textFill.getSolidFillColor(),G.filters=[it],t=!0,this.textureContainer.addChild(G)}}else this.textureContainer.addChild(G)}if(this.strokeGraphics.displayObject){const G=this.strokeGraphics.displayObject;if(C){const it=this.strokeFill.displayObject;if(it)it.mask=G,it.addChild(G),o?it.position.y=_>0?_:0:it.position.x=p,this.textureContainer.addChild(it);else if(this.strokeFill.isSolidFill()){o?G.position.y=Math.max(_,0):G.position.x=p;const ft=new ds;ft.color=this.strokeFill.getSolidFillColor(),G.filters=[ft],t=!0,this.textureContainer.addChild(G)}}else o?G.position.y=_>0?_:0:G.position.x=p,this.textureContainer.addChild(G);const K=a&&A?(a.width-(A==null?void 0:A.width))/4:0;G.position.x-=K}if(this.underline&&(this.underline.render(),this.underline.sprite)){o?(this.underline.sprite.position.y=s?s-n/16:r,this.underline.sprite.position.x=0):(this.underline.sprite.position.x=0,this.underline.sprite.position.y=0);const G=this.textFill.getClonedDisplayObject();G?(G.mask=this.underline.sprite,G.addChild(this.underline.sprite),this.textureContainer.addChild(G)):this.textureContainer.addChild(this.underline.sprite)}if(t){const G=ue.p.create({width:o?h:e,height:o?Math.max(w,n):l,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.textureContainer,{renderTexture:G}),this.cacheSprite.texture=G,o&&_<0&&(this.cacheSprite.position.y=_),this.effectContainer.addChild(this.cacheSprite)}else this.effectContainer.addChild(this.textureContainer);this.container.name=x}destroy(){this.textFill.destroy(),this.textGraphics.destroy(),this.strokeFill.destroy(),this.strokeGraphics.destroy(),this.cacheSprite.texture.destroy(!0),this.cacheSprite.destroy(),this.textureContainer.destroy(),this.container.destroy()}}var $0=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Ow extends gc{constructor(t,e,n){super(t,e,n),this.units=[],this.isHorz=!0,this.hyperLinkMap=new Map,this.hyperLinkContainerMap=new Map,this.effectList=[],n.effectList&&(this.effectList=n.effectList)}getIterateElements(){return this.units}getIterateEntry(t,e,n){return this.units[e]?this.units[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}applyEffectCacheAsBitMap(){}createUnits(t,e,n,r){for(let o=0,s=this.json.textUnits.length;o<s;o++)r.addSubMTask(()=>$0(this,void 0,void 0,function*(){const a=this.json.textUnits[o],{height:l,width:h,fillHeight:u,baseline:p,y:_,underline:x}=this.json,w=new Pw(Object.assign(Object.assign({},a),{lineHeight:l,lineWidth:h,baseLine:p-_,underline:x,fillLineHeight:u||l,isHorz:this.isHorz,shapeId:t,paragraphIndex:e,lineIndex:n,unitIndex:o}),this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});if(w.preRender(),this.units.push(w),a.hyperlink||a.hlinkHover){const A=new D0(w.container,this.ctx);a.hyperlink&&A.addAction(a.hyperlink,"click"),a.hlinkHover&&A.addAction(a.hlinkHover,"hover"),this.container.sortableChildren=!0}}),"@TextLineImpl[createUnits]")}render(t){for(const e of this.units.reverse())e.render(t),t.addSubMTask(()=>$0(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextLineImpl[container.addChild]")}destroy(){this.units.forEach(t=>{t.destroy()}),this.container.destroy({children:!1}),this.hyperLinkMap.clear();for(const t of this.hyperLinkContainerMap.values())t.destroy({children:!0,baseTexture:!0,texture:!0});this.hyperLinkContainerMap.clear()}}var Q0=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Lw extends gc{constructor(t,e,n){super(t,e,n),this.iterateElements=[],this.lines=[],this.effectList=[],this.isHorz=!0,n.effectList&&(this.effectList=n.effectList)}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const t=this.lines.reduce((e,n)=>e=e.concat(n.getIterateElements()),[]);return this.iterateElements=t,t}getIterateEntry(t,e,n){const r=this.getIterateElements();return r[e]?r[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}applyEffectCacheAsBitMap(){}createLines(t,e,n){for(let r=0,o=this.json.lines.length;r<o;r++)n.addSubMTask(()=>Q0(this,void 0,void 0,function*(){const s=this.json.lines[r],a=new Ow(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=this.isHorz,a.container.name="line-"+r,a.createUnits(t,e,r,n),this.lines.push(a)}),"@TextParagraphImpl[createLines]")}render(t){for(const e of this.lines)e.render(t),t.addSubMTask(()=>Q0(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextParagraphImpl[container.addChild]")}destroy(){this.lines.forEach(t=>{t.destroy()}),this.container.destroy({children:!1})}}function Nw(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=-Math.sin(o*(Math.PI/180))*e;else{const s=Math.tan(o*Math.PI/180);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=-s*n}return{x:n,y:r}}function Dw(i,t,e,n,r,o){const s=Nw((r=-r)/Math.PI*180,e,n),a=i.x-s.x,l=i.y-s.y;return{centerX:a/9525*t.x,centerY:l/9525*t.y,rx:e/9525*t.x,ry:n/9525*t.y,st:-r,end:-r+o,aClockWise:o<0}}function tg(i){const t=new ks,{scale:e}=i;let n={x:0,y:0};const r=i.path.trim().split(" ");for(let o=0;o<r.length;o+=2){const s=r[o],a=r[o+1];if(s==="M"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.moveTo(l,h)}else if(s==="A"){const[l,h,u,p]=a.split(",").map(it=>Number(it)),{centerX:_,centerY:x,rx:w,ry:A,st:C,end:G,aClockWise:K}=Dw(n,e,l,h,u,p);t.absellipse(_,x,w,A,C,G,K,0)}else if(s==="L"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.lineTo(l,h)}else if(s==="QB"){let[l,h,u,p]=a.split(",").map(_=>Number(_));n={x:u,y:p},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,t.quadraticCurveTo(l,h,u,p)}else if(s==="CB"){let[l,h,u,p,_,x]=a.split(",").map(w=>Number(w));n={x:_,y:x},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,_=_/9525*e.x,x=x/9525*e.y,t.bezierCurveTo(l,h,u,p,_,x)}else if(s==="C")try{t.closePath()}catch{}}return t}function Bn(i,t){return i.curves.map(e=>e.getPoints(t)).reduce((e,n)=>e.concat(n),[])}const bc={textCirclePour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textStop:{top:i=>Bn(i,100),bottom:i=>Bn(i,100)},textPlain:{top:i=>Bn(i,100),bottom:i=>Bn(i,100)},textTriangle:{top:i=>Bn(i,50),bottom:i=>Bn(i,101)},textTriangleInverted:{bottom:i=>Bn(i,50),top:i=>Bn(i,101)},textChevron:{bottom:i=>Bn(i,50),top:i=>Bn(i,50)},textChevronInverted:{bottom:i=>Bn(i,50),top:i=>Bn(i,50)},textRingInside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textRingOutside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchUpPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchDownPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave1:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textWave2:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDoubleWave1:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave4:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textInflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDeflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textInflateBottom:{top:i=>Bn(i,180),bottom:i=>i.getPoints(180)},textDeflateBottom:{top:i=>Bn(i,180),bottom:i=>i.getPoints(180)},textInflateTop:{bottom:i=>Bn(i,180),top:i=>i.getPoints(180)},textDeflateTop:{bottom:i=>Bn(i,180),top:i=>i.getPoints(180)},textFadeRight:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeLeft:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textFadeDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textSlantUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textSlantDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCascadeUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCascadeDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textArchUp:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textArchDown:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)},textCircle:{bottom:i=>Bn(i,180),top:i=>Bn(i,180)}};function Fw(i,t,e,n,r){const o=i.trim().split(" "),[s,a]=o[1].split(",").map(K=>parseFloat(K)),[l,h,u,p]=o[3].split(",").map(K=>parseFloat(K)),_=function(K,it,ft,nt,gt,lt){const dt=Math.abs(lt*Math.sqrt((ft*ft+nt*nt)/2)),Ut=Math.ceil(dt/9525/10);let Ft=0,Et=gt,Mt={x:K+ft*Math.cos(Et),y:it+nt*Math.sin(Et)};for(let Lt=0;Lt<Ut;Lt+=1){Et+=lt/Ut;const Pt={x:K+ft*Math.cos(Et),y:it+nt*Math.sin(Et)};Ft+=Math.sqrt(Math.pow(Pt.x-Mt.x,2)+Math.pow(Pt.y-Mt.y,2)),Mt=Pt}return Ft}(s,a,l,h,u,p);r*=Math.min(1,_/9525/n);const x=new Oe.d;x.translate(r+t/2,0),x.rotate(2*Math.PI-u);const w=new Oe.g(0,0),A=x.apply(w);A.x+=t/2,A.y=e/2-A.y;const C=l+9525*r,G=h+9525*r;return`M ${9525*A.x},${9525*A.y} A ${C},${G},${u},${p}`}var Xa=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Bw{get width(){return this.json.width}get height(){return this.json.height}get x(){return this.json.position.x}get y(){return this.json.position.y}set color(t){var e;((e=this.container.filters)!==null&&e!==void 0?e:[]).length>0&&(this.textColorFilter.color=t)}get color(){return this.textColorFilter.color}get on(){var t;return((t=this.container.filters)!==null&&t!==void 0?t:[]).length>0?"true":"false"}set on(t){var e;t==="true"?((e=this.container.filters)!==null&&e!==void 0?e:[]).indexOf(this.textColorFilter)<0&&(this.container.filters=[this.textColorFilter]):this.container.filters=[]}constructor(t,e,n,r,o){var s;this.iterateElements=[],this.paragraphs=[],this.effectList=[],this.container=new Cn.b,this.textContainer=new Cn.b,this.textColorFilter=new ds,this.json=t,this.ctx=e,this.shapeRotation=o,this.parentGlobalPos=r,this.iterateType=n,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+t.position.x,y:this.parentGlobalPos.y+t.position.y},this.container.position.x=t.position.x,this.container.position.y=t.position.y,this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y;const a=new $i;a.drawRect(0,0,t.width,t.height),this.container.addChild(a),this.container.addChild(this.textContainer),this.textColorFilter.currentColor="#000000FF",this.textColorFilter.designColor="#000000FF",this.effectList=(s=t.effectList)!==null&&s!==void 0?s:[],this.json.rot&&(this.container.pivot.x+=this.json.width/2,this.container.pivot.y+=this.json.height/2,this.container.rotation=this.json.rot*Math.PI/180,this.container.position.x+=this.json.width/2*this.container.scale.x,this.container.position.y+=this.json.height/2*this.container.scale.y)}getTextElement(t,e){return t==="paragraph"?this.paragraphs[e[0]]:null}getIterateEntry(t,e){return this.iterateElements[t]?this.iterateElements[t]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",e),null)}applyEffectCacheAsBitMap(){}destroy(){this.paragraphs.forEach(t=>{t.destroy()}),this.textColorFilter.destroy()}createParagraphs(t,e){for(let n=0,r=this.json.paragraphs.length;n<r;n++)e.addSubMTask(()=>Xa(this,void 0,void 0,function*(){var o;const s=this.json.paragraphs[n],a=new Lw(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=(o=this.json.isHorz)===null||o===void 0||o,a.createLines(t,n,e),e.addSubMTask(()=>Xa(this,void 0,void 0,function*(){this.iterateElements=this.iterateElements.concat(a.getIterateElements()),a.container.name="\u6BB5\u843D-"+n,this.paragraphs.push(a)}),"@TextBodyImpl[paragraphs.push]")}),"@TextBodyImpl[createParagraphs]")}render(t){for(const e of this.paragraphs)e.render(t),t.addSubMTask(()=>Xa(this,void 0,void 0,function*(){this.textContainer.addChild(e.container)}),"@TextBodyImpl[container.addChild]");t.addSubMTask(()=>Xa(this,void 0,void 0,function*(){const{width:e}=this.container;this.container.scale.x<0&&(this.container.x+=-1*e)}),"@TextBodyImpl[reset width]"),t.addSubMTask(()=>Xa(this,void 0,void 0,function*(){if(this.json.presetTextShape){const e=this.json.paragraphs.map(u=>u.x).reduce((u,p)=>Math.min(u,p)),n=this.json.paragraphs[0].y,r=this.textContainer.getBounds(),o=this.json.paragraphs.map(u=>u.lines.map(p=>p.width).sort((p,_)=>p-_)[0]).sort((u,p)=>u-p)[0],{width:s,height:a}=r,{geometry:l,type:h}=this.json.presetTextShape;if(l.paths){const u=ue.p.create({width:o,height:a,resolution:this.ctx.renderer.resolution}),p=new Oe.d;p.translate(-e,-n),this.ctx.renderer.render(this.textContainer,{renderTexture:u,transform:p});const _=this.json.isHorz!==void 0&&!this.json.isHorz;if(["textCircle","textArchUp","textArchDown"].indexOf(this.json.presetTextShape.type)>=0){const w=Fw(l.paths[0].path,this.json.width,this.json.height,s,a);l.paths.unshift(Object.assign(Object.assign({},l.paths[0]),{path:w}))}const x=function(w,A,C,G){if(!bc[C])return null;const K=bc[C].top(tg(A)),it=bc[C].bottom(tg(w));if(K.length!==it.length)return null;const ft=Math.min(K.length,it.length),nt=1/(ft-1),gt=[],lt=[],dt=new Array(2*ft).fill("").map((Ut,Ft)=>Ft);for(let Ut=0;Ut<ft;Ut++)gt.push(K[Ut].x,K[Ut].y),G?lt.push(1,nt*Ut):lt.push(nt*Ut,0),gt.push(it[Ut].x,it[Ut].y),G?lt.push(0,nt*Ut):lt.push(nt*Ut,1);return{vertices:new Float32Array(gt),uvs:new Float32Array(lt),drawMode:gn.f.TRIANGLE_STRIP,indices:new Uint16Array(dt)}}(l.paths[1],l.paths[0],h,_);if(x){const w=new vT.b(u,x.vertices,x.uvs,x.indices,x.drawMode);this.textContainer.visible=!1,this.container.addChild(w)}}}}),"presetTextShape")}}class kw{constructor(t){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=t.id,this.type=t.type,this.heightSize=t.heightSize,this.widthSize=t.widthSize,this.fillStyle=t.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=t.lineWidth||1,this.position=t.position||{x:0,y:0},this.rotate=t.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"triangle":this.pivot={x:.7*this.width,y:this.height/2};break;case"arrow":case"stealth":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+hh()(this.path+this.scaleX+this.scaleY),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=.75;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=.75;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class Tc{get displayObject(){return this._displayObject}constructor(t,e,n,r,o,s,a,l,h,u,p){this.id=t,this.ctx=e,this.paths=n,this.hash=r,this.nept=o,this.width=s,this.height=a,this.lineStyle=l,this.shouldFill=h,this.bgColor=u,this.lnColor=p,this.clonedObjects=[],this._displayObject=null,this.isRectangle=!1,this.isPureRect=!1,this.isColoredPureRect=!1,this.isRectangle=this.rectangleDetect(n),this.isRectangle&&h?this.bgColor?this.isColoredPureRect=!0:this.isPureRect=!0:this.ctx.graphicsTexture.addGraphics(this.id,this.paths,this.hash,this.nept,this.width,this.height,this.lineStyle,this.ctx.objectPoolGroup,this.shouldFill,this.bgColor,this.lnColor)}pointDis(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}isPoint(t){return Number.isNaN(Number(t.x))||Number.isNaN(Number(t.y))}isSolidSquare(t,e){if(t.join("")!=="MLLLC"&&t.join("")!=="MLLLCC")return!1;const n=e.filter(l=>!this.isPoint(l));if(n.length!==4)return!1;const r=Math.min(...n.map(l=>l.x)),o=Math.min(...n.map(l=>l.y)),s=Math.max(...n.map(l=>l.x)),a=Math.max(...n.map(l=>l.y));for(const l of n)if(l.x!==r&&l.x!==s||l.y!==o&&l.y!==a)return!1;return!0}rectangleDetect(t){if(t.length!==1)return!1;const e=t[0].path.trim().split(" "),n=[],r=[];for(let l=0;l<e.length;l+=2){const h=e[l],u=e[l+1],[p,_]=u.split(",").map(x=>Number(x)/100);n.push(h),r.push({x:p,y:_})}if(r.length<4||n.find(l=>l==="CB"||l==="QB"||l==="A"))return!1;if(this.isSolidSquare(n,r))return!0;for(let l=0;l<3;l++){const h=r[l],u=r[l+1];if(h.x!==u.x&&h.y!==u.y)return!1}const o=r.slice(0,4).reduce((l,h)=>l+h.x,0)/4,s=r.slice(0,4).reduce((l,h)=>l+h.y,0)/4;if(Number.isNaN(o)||Number.isNaN(s))return!1;const a={x:o,y:s};return wr(this.pointDis(a,r[0]),this.pointDis(a,r[1]))&&wr(this.pointDis(a,r[0]),this.pointDis(a,r[2]))&&wr(this.pointDis(a,r[0]),this.pointDis(a,r[3]))&&this.pointDis(a,r[0])===this.pointDis(a,r[1])}createDisplayObject(){if(this.isPureRect){const t=new $i;return t.beginFill(0,1),t.drawRect(0,0,this.width,this.height),t}if(this.isColoredPureRect&&this.bgColor){const t=new $i,[e,n]=F0(this.bgColor);return t.beginFill(e,n),t.drawRect(0,0,this.width,this.height),t}{const t=new ci,e=this.ctx.graphicsTexture.getGraphicsData(this.id);return e?(t.texture=e.texture,t.pivot.x=e.pivot.x,t.pivot.y=e.pivot.y,t.scale.x=e.scale,t.scale.y=e.scale,t):null}}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}getPictureMask(){const t=this.createDisplayObject();if(t){t.filters=[new VT("#ff0000")];const e=ue.p.create({width:t==null?void 0:t.width,height:(t==null?void 0:t.height)||0,resolution:1});this.ctx.renderer.render(t,{renderTexture:e});const n=new ci;return n.texture=e,n}return null}render(){this._displayObject=this.createDisplayObject()}isNeedMask(t,e){let n=!1;return this._displayObject&&(n=!(this.isRectangle&&Math.abs(t-this._displayObject.width)<2&&Math.abs(e-this._displayObject.height)<2&&this.shouldFill)),n}addArrows(t){var e;(e=this._displayObject)===null||e===void 0||e.addChild(t)}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}const eg=[[10,10,2],[10,20,3],[10,30,5],[10,40,6],[10,50,8],[10,60,9],[10,70,9],[10,80,10],[10,90,10],[10,100,10],[10,110,9],[10,120,9],[10,130,8],[10,140,6],[10,150,5],[10,160,3],[10,170,2],[10,180,0],[10,190,-2],[10,200,-3],[10,210,-5],[10,220,-6],[10,230,-8],[10,240,-9],[10,250,-9],[10,260,-10],[10,270,-10],[10,280,-10],[10,290,-9],[10,300,-9],[10,310,-8],[10,320,-6],[10,330,-5],[10,340,-3],[10,350,-2],[10,360,0],[20,10,4],[20,20,7],[20,30,10],[20,40,14],[20,50,16],[20,60,18],[20,70,19],[20,80,20],[20,90,20],[20,100,20],[20,110,19],[20,120,18],[20,130,16],[20,140,14],[20,150,10],[20,160,7],[20,170,4],[20,180,0],[20,190,-4],[20,200,-7],[20,210,-10],[20,220,-14],[20,230,-16],[20,240,-18],[20,250,-19],[20,260,-20],[20,270,-20],[20,280,-20],[20,290,-19],[20,300,-18],[20,310,-16],[20,320,-14],[20,330,-10],[20,340,-7],[20,350,-4],[20,360,0],[30,10,6],[30,20,11],[30,30,16],[30,40,20],[30,50,23],[30,60,26],[30,70,28],[30,80,30],[30,90,30],[30,100,30],[30,110,28],[30,120,26],[30,130,23],[30,140,20],[30,150,16],[30,160,11],[30,170,6],[30,180,0],[30,190,-6],[30,200,-11],[30,210,-16],[30,220,-20],[30,230,-23],[30,240,-26],[30,250,-28],[30,260,-30],[30,270,-30],[30,280,-30],[30,290,-28],[30,300,-26],[30,310,-23],[30,320,-20],[40,10,8],[40,20,16],[40,30,23],[40,40,28],[40,50,33],[40,60,36],[40,70,38],[40,80,40],[40,90,40],[40,100,40],[40,110,38],[40,120,36],[40,130,33],[40,140,28],[40,150,23],[40,160,16],[40,170,8],[40,180,0],[40,190,-8],[40,200,-16],[40,210,-23],[40,220,-28],[40,230,-33],[40,240,-36],[40,250,-38],[40,260,-40],[40,270,-40],[40,280,-40],[40,290,-38],[40,300,-36],[40,310,-33],[40,320,-28],[40,330,-23],[40,340,-16],[40,350,-8],[40,360,0],[50,10,12],[50,20,22],[50,30,31],[50,40,37],[50,50,42],[50,60,46],[50,70,48],[50,80,50],[50,90,50],[50,100,50],[50,110,48],[50,120,46],[50,130,42],[50,140,37],[50,150,31],[50,160,22],[50,170,12],[50,180,0],[50,190,-12],[50,200,-22],[50,210,-31],[50,220,-37],[50,230,-42],[50,240,-46],[50,250,-48],[50,260,-50],[50,270,-50],[50,280,-50],[50,290,-48],[50,300,-46],[50,310,-42],[50,320,-37],[50,330,-31],[50,340,-22],[50,350,-12],[50,360,0],[60,10,17],[60,20,31],[60,30,41],[60,40,48],[60,50,53],[60,60,56],[60,70,58],[60,80,60],[60,90,60],[60,100,60],[60,110,58],[60,120,56],[60,130,53],[60,140,48],[60,150,41],[60,160,31],[60,170,17],[60,180,0],[60,190,-17],[60,200,-31],[60,210,-41],[60,220,-48],[60,230,-53],[60,240,-56],[60,250,-58],[60,260,-60],[60,270,-60],[60,280,-60],[60,290,-58],[60,300,-56],[60,310,-53],[60,320,-48],[60,330,-41],[60,340,-31],[60,350,-17],[60,360,0],[70,10,26],[70,20,43],[70,30,54],[70,40,60],[70,50,65],[70,60,67],[70,70,68],[70,80,70],[70,90,70],[70,100,70],[70,110,68],[70,120,67],[70,130,65],[70,140,60],[70,150,54],[70,160,43],[70,170,26],[70,180,0],[70,190,-26],[70,200,-43],[70,210,-54],[70,220,-60],[70,230,-65],[70,240,-67],[70,250,-68],[70,260,-70],[70,270,-70],[70,280,-70],[70,290,-68],[70,300,-67],[70,310,-65],[70,320,-60],[70,330,-54],[70,340,-43],[70,350,-26],[70,360,0],[80,10,45],[80,20,62],[80,30,70],[80,40,74],[80,50,77],[80,60,78],[80,70,79],[80,80,80],[80,90,80],[80,100,80],[80,110,79],[80,120,78],[80,130,77],[80,140,74],[80,150,70],[80,160,62],[80,170,45],[80,180,0],[80,190,-45],[80,200,-62],[80,210,-70],[80,220,-74],[80,230,-77],[80,240,-78],[80,250,-79],[80,260,-80],[80,270,-80],[80,280,-80],[80,290,-79],[80,300,-78],[80,310,-77],[80,320,-74],[80,330,-70],[80,340,-62],[80,350,-45],[80,360,0],[90,10,0],[90,20,0],[90,30,0],[90,40,0],[90,50,0],[90,60,0],[90,70,0],[90,80,0],[90,90,0],[90,100,0],[90,110,0],[90,120,0],[90,130,0],[90,140,0],[90,150,0],[90,160,0],[90,170,0],[90,180,0],[90,190,0],[90,200,0],[90,210,0],[90,220,0],[90,230,0],[90,240,0],[90,250,0],[90,260,0],[90,270,0],[90,280,0],[90,290,0],[90,300,0],[90,310,0],[90,320,0],[90,330,0],[90,340,0],[90,350,0],[90,360,0],[100,10,-45],[100,20,-63],[100,30,-71],[100,40,-74],[100,50,-77],[100,60,-78],[100,70,-79],[100,80,-80],[100,90,-80],[100,100,-80],[100,110,-79],[100,120,-78],[100,130,-77],[100,140,-74],[100,150,-71],[100,160,-63],[100,170,-45],[100,180,0],[100,190,45],[100,200,63],[100,210,71],[100,220,74],[100,230,77],[100,240,78],[100,250,79],[100,260,80],[100,270,80],[100,280,80],[100,290,79],[100,300,78],[100,310,77],[100,320,74],[100,330,71],[100,340,63],[100,350,45],[100,360,0],[110,10,-26],[110,20,-43],[110,30,-54],[110,40,-60],[110,50,-65],[110,60,-67],[110,70,-69],[110,80,-70],[110,90,-70],[110,100,-70],[110,110,-69],[110,120,-67],[110,130,-65],[110,140,-60],[110,150,-54],[110,160,-43],[110,170,-26],[110,180,0],[110,190,26],[110,200,43],[110,210,54],[110,220,60],[110,230,65],[110,240,67],[110,250,69],[110,260,70],[110,270,70],[110,280,70],[110,290,69],[110,300,67],[110,310,65],[110,320,60],[110,330,54],[110,340,43],[110,350,26],[110,360,0],[120,10,-17],[120,20,-31],[120,30,-41],[120,40,-48],[120,50,-53],[120,60,-56],[120,70,-58],[120,80,-60],[120,90,-60],[120,100,-60],[120,110,-58],[120,120,-56],[120,130,-53],[120,140,-48],[120,150,-41],[120,160,-31],[120,170,-17],[120,180,0],[120,190,17],[120,200,31],[120,210,41],[120,220,48],[120,230,53],[120,240,56],[120,250,58],[120,260,60],[120,270,60],[120,280,60],[120,290,58],[120,300,56],[120,310,53],[120,320,48],[120,330,41],[120,340,31],[120,350,17],[120,360,0],[130,10,-12],[130,20,-22],[130,30,-31],[130,40,-37],[130,50,-42],[130,60,-46],[130,70,-48],[130,80,-49],[130,90,-50],[130,100,-49],[130,110,-48],[130,120,-46],[130,130,-42],[130,140,-37],[130,150,-31],[130,160,-22],[130,170,-12],[130,180,0],[130,190,12],[130,200,22],[130,210,31],[130,220,37],[130,230,42],[130,240,46],[130,250,48],[130,260,49],[130,270,50],[130,280,49],[130,290,48],[130,300,46],[130,310,42],[130,320,37],[130,330,31],[130,340,22],[130,350,12],[140,10,-8],[140,20,-16],[140,30,-23],[140,40,-28],[140,50,-33],[140,60,-36],[140,70,-38],[140,80,-40],[140,90,-40],[140,100,-40],[140,110,-38],[140,120,-36],[140,130,-33],[140,140,-28],[140,150,-23],[140,160,-16],[140,170,-8],[140,180,0],[140,190,8],[140,200,16],[140,210,23],[140,220,28],[140,230,33],[140,240,36],[140,250,38],[140,260,39],[140,270,40],[140,280,39],[140,290,38],[140,300,36],[140,310,33],[140,320,28],[140,330,23],[140,340,16],[140,350,8],[140,360,0],[150,10,-6],[150,20,-11],[150,30,-16],[150,40,-20],[150,50,-24],[150,60,-27],[150,70,-29],[150,80,-31],[150,90,-30],[150,100,-31],[150,110,-29],[150,120,-27],[150,130,-24],[150,140,-20],[150,150,-16],[150,160,-11],[150,170,-6],[150,180,0],[150,190,6],[150,200,11],[150,210,16],[150,220,20],[150,230,24],[150,240,27],[150,250,29],[150,260,31],[150,270,30],[150,280,31],[150,290,29],[150,300,27],[150,310,24],[150,320,20],[150,330,16],[150,340,11],[150,350,6],[150,360,0],[160,10,-4],[160,20,-7],[160,30,-10],[160,40,-13],[160,50,-16],[160,60,-18],[160,70,-19],[160,80,-20],[160,90,-20],[160,100,-20],[160,110,-19],[160,120,-18],[160,130,-16],[160,140,-13],[160,150,-10],[160,160,-7],[160,170,-4],[160,180,0],[160,190,4],[160,200,7],[160,210,10],[160,220,13],[160,230,16],[160,240,18],[160,250,19],[160,260,20],[160,270,20],[160,280,20],[160,290,19],[160,300,18],[160,310,16],[160,320,13],[160,330,10],[160,340,7],[160,350,4],[160,360,0],[170,10,-2],[170,20,-4],[170,30,-5],[170,40,-6],[170,50,-8],[170,60,-9],[170,70,-9],[170,80,-10],[170,90,-10],[170,100,-10],[170,110,-9],[170,120,-9],[170,130,-8],[170,140,-6],[170,150,-5],[170,160,-4],[170,170,-2],[170,180,0],[170,190,2],[170,200,4],[170,210,5],[170,220,6],[170,230,8],[170,240,9],[170,250,9],[170,260,10],[170,270,10],[170,280,10],[170,290,9],[170,300,9],[170,310,8],[170,320,6],[170,330,5],[170,340,4],[170,350,2],[170,360,0],[180,10,0],[180,20,0],[180,30,0],[180,40,0],[180,50,0],[180,60,0],[180,70,0],[180,80,0],[180,90,0],[180,100,0],[180,110,0],[180,120,0],[180,130,0],[180,140,0],[180,150,0],[180,160,0],[180,170,0],[180,180,0],[180,190,0],[180,200,0],[180,210,0],[180,220,0],[180,230,0],[180,240,0],[180,250,0],[180,260,0],[180,270,0],[180,280,0],[180,290,0],[180,300,0],[180,310,0],[180,320,0],[180,330,0],[180,340,0],[180,350,0],[180,360,0],[190,10,2],[190,20,4],[190,30,5],[190,40,6],[190,50,8],[190,60,9],[190,70,9],[190,80,10],[190,90,10],[190,100,10],[190,110,9],[190,120,9],[190,130,8],[190,140,6],[190,150,5],[190,160,4],[190,170,2],[190,180,0],[190,190,-2],[190,200,-4],[190,210,-5],[190,220,-6],[190,230,-8],[190,240,-9],[190,250,-9],[190,260,-10],[190,270,-10],[190,280,-10],[190,290,-9],[190,300,-9],[190,310,-8],[190,320,-6],[190,330,-5],[190,340,-4],[190,350,-2],[190,360,0],[200,10,4],[200,20,7],[200,30,11],[200,40,13],[200,50,16],[200,60,18],[200,70,19],[200,80,20],[200,90,20],[200,100,20],[200,110,19],[200,120,18],[200,130,16],[200,140,13],[200,150,11],[200,160,7],[200,170,4],[200,180,0],[200,190,-4],[200,200,-7],[200,210,-11],[200,220,-13],[200,230,-16],[200,240,-18],[200,250,-19],[200,260,-20],[200,270,-20],[200,280,-20],[200,290,-19],[200,300,-18],[200,310,-16],[200,320,-13],[200,330,-11],[200,340,-7],[200,350,-4],[200,360,0],[210,10,6],[210,20,12],[210,30,16],[210,40,20],[210,50,24],[210,60,27],[210,70,29],[210,80,30],[210,90,30],[210,100,30],[210,110,29],[210,120,27],[210,130,24],[210,140,20],[210,150,16],[210,160,12],[210,170,6],[210,180,0],[210,190,-6],[210,200,-12],[210,210,-16],[210,220,-20],[210,230,-24],[210,240,-27],[210,250,-29],[210,260,-30],[210,270,-30],[210,280,-30],[210,290,-29],[210,300,-27],[210,310,-24],[210,320,-20],[210,330,-16],[210,340,-12],[210,350,-6],[210,360,0],[220,10,8],[220,20,16],[220,30,23],[220,40,28],[220,50,33],[220,60,36],[220,70,38],[220,80,40],[220,90,40],[220,100,40],[220,110,38],[220,120,36],[220,130,33],[220,140,28],[220,150,23],[220,160,16],[220,170,8],[220,180,0],[220,190,-8],[220,200,-16],[220,210,-23],[220,220,-28],[220,230,-33],[220,240,-36],[220,250,-38],[220,260,-40],[220,270,-40],[220,280,-40],[220,290,-38],[220,300,-36],[220,310,-33],[220,320,-28],[220,330,-23],[220,340,-16],[220,350,-8],[220,360,0],[230,10,12],[230,20,22],[230,30,31],[230,40,38],[230,50,42],[230,60,46],[230,70,48],[230,80,50],[230,90,50],[230,100,50],[230,110,48],[230,120,46],[230,130,42],[230,140,38],[230,150,31],[230,160,22],[230,170,12],[230,180,0],[230,190,-12],[230,200,-22],[230,210,-31],[230,220,-38],[230,230,-42],[230,240,-46],[230,250,-48],[230,260,-50],[230,270,-50],[230,280,-50],[230,290,-48],[230,300,-46],[230,310,-42],[230,320,-38],[230,330,-31],[230,340,-22],[230,350,-12],[230,360,0],[240,10,17],[240,20,31],[240,30,41],[240,40,48],[240,50,53],[240,60,56],[240,70,59],[240,80,60],[240,90,60],[240,100,60],[240,110,59],[240,120,56],[240,130,53],[240,140,48],[240,150,41],[240,160,31],[240,170,17],[240,180,0],[240,190,-17],[240,200,-31],[240,210,-41],[240,220,-48],[240,230,-53],[240,240,-56],[240,250,-59],[240,260,-60],[240,270,-60],[240,280,-60],[240,290,-59],[240,300,-56],[240,310,-53],[240,320,-48],[240,330,-41],[240,340,-31],[240,350,-17],[240,360,0],[250,10,26],[250,20,44],[250,30,54],[250,40,61],[250,50,65],[250,60,67],[250,70,69],[250,80,70],[250,90,70],[250,100,70],[250,110,69],[250,120,67],[250,130,65],[250,140,61],[250,150,54],[250,160,44],[250,170,26],[250,180,0],[250,190,-26],[250,200,-44],[250,210,-54],[250,220,-61],[250,230,-65],[250,240,-67],[250,250,-69],[250,260,-70],[250,270,-70],[250,280,-70],[250,290,-69],[250,300,-67],[250,310,-65],[250,320,-61],[250,330,-54],[250,340,-44],[250,350,-26],[250,360,0],[260,10,45],[260,20,63],[260,30,71],[260,40,75],[260,50,77],[260,60,79],[260,70,79],[260,80,80],[260,90,80],[260,100,80],[260,110,79],[260,120,79],[260,130,77],[260,140,75],[260,150,71],[260,160,63],[260,170,45],[260,180,0],[260,190,-45],[260,200,-63],[260,210,-71],[260,220,-75],[260,230,-77],[260,240,-79],[260,250,-79],[260,260,-80],[260,270,-80],[260,280,-80],[260,290,-79],[260,300,-79],[260,310,-77],[260,320,-75],[260,330,-71],[260,340,-63],[260,350,-45],[260,360,0],[270,10,90],[270,20,90],[270,30,90],[270,40,90],[270,50,90],[270,60,90],[270,70,90],[270,80,90],[270,90,90],[270,100,90],[270,110,90],[270,120,90],[270,130,90],[270,140,90],[270,150,90],[270,160,90],[270,170,90],[270,180,90],[270,190,90],[270,200,90],[270,210,90],[270,220,90],[270,230,90],[270,240,90],[270,250,90],[270,260,90],[270,270,90],[270,280,90],[270,290,90],[270,300,90],[270,310,90],[270,320,90],[270,330,90],[270,340,90],[270,350,90],[270,360,90],[280,10,-45],[280,20,-63],[280,30,-71],[280,40,-75],[280,50,-77],[280,60,-79],[280,70,-79],[280,80,-80],[280,90,-80],[280,100,-80],[280,110,-79],[280,120,-79],[280,130,-77],[280,140,-75],[280,150,-71],[280,160,-63],[280,170,-45],[280,180,90],[280,190,45],[280,20,63],[280,210,71],[280,220,75],[280,230,77],[280,240,79],[280,250,79],[280,260,80],[280,270,80],[280,280,80],[280,290,79],[280,300,79],[280,310,77],[280,320,75],[280,330,71],[280,340,63],[280,350,45],[280,360,90],[290,10,-26],[290,20,-43],[290,30,-54],[290,40,-60],[290,50,-65],[290,60,-67],[290,70,-69],[290,80,-70],[290,90,-70],[290,100,-70],[290,110,-69],[290,120,-67],[290,130,-65],[290,140,-60],[290,150,-54],[290,160,-43],[290,170,-26],[290,180,0],[290,190,26],[290,200,43],[290,210,54],[290,220,60],[290,230,65],[290,240,67],[290,250,69],[290,260,70],[290,270,70],[290,280,70],[290,290,69],[290,300,67],[290,310,65],[290,320,60],[290,330,54],[290,340,43],[290,350,26],[290,360,0],[300,10,-17],[300,20,-31],[300,30,-41],[300,40,-48],[300,50,-53],[300,60,-56],[300,70,-58],[300,80,-60],[300,90,-60],[300,100,-60],[300,110,-58],[300,120,-56],[300,130,-53],[300,140,-48],[300,150,-41],[300,160,-31],[300,170,-17],[300,180,0],[300,190,17],[300,200,31],[300,210,41],[300,220,48],[300,230,53],[300,240,56],[300,250,58],[300,260,60],[300,270,60],[300,280,60],[300,290,58],[300,300,56],[300,310,53],[300,320,48],[300,330,41],[300,340,31],[300,350,17],[300,360,0],[310,10,-12],[310,20,-23],[310,30,-31],[310,40,-38],[310,50,-43],[310,60,-46],[310,70,-48],[310,80,-50],[310,90,-50],[310,100,-50],[310,110,-48],[310,120,-46],[310,130,-43],[310,140,-38],[310,150,-31],[310,160,-23],[310,170,-12],[310,180,0],[310,190,12],[310,200,23],[310,210,31],[310,220,38],[310,230,43],[310,240,46],[310,250,48],[310,260,50],[310,270,50],[310,280,50],[310,290,48],[310,300,46],[310,310,43],[310,320,38],[310,330,31],[310,340,23],[310,350,12],[310,360,0],[320,10,-9],[320,20,-16],[320,30,-23],[320,40,-29],[320,50,-33],[320,60,-36],[320,70,-39],[320,80,-40],[320,90,-40],[320,100,-40],[320,110,-39],[320,120,-36],[320,130,-33],[320,140,-29],[320,150,-23],[320,160,-16],[320,170,-9],[320,180,0],[320,190,9],[320,200,16],[320,210,23],[320,220,29],[320,230,33],[320,240,36],[320,250,39],[320,260,40],[320,270,40],[320,280,40],[320,290,39],[320,300,36],[320,310,33],[320,320,29],[320,330,23],[320,340,16],[320,350,9],[320,360,0],[330,10,-6],[330,20,-11],[330,30,-16],[330,40,-21],[330,50,-24],[330,60,-27],[330,70,-29],[330,80,-30],[330,90,-30],[330,100,-30],[330,110,-29],[330,120,-27],[330,130,-24],[330,140,-21],[330,150,-16],[330,160,-11],[330,170,-6],[330,180,0],[330,190,6],[330,200,11],[330,210,16],[330,220,21],[330,230,24],[330,240,27],[330,250,29],[330,260,30],[330,270,30],[330,280,30],[330,290,29],[330,300,27],[330,310,24],[330,320,21],[330,330,16],[330,340,11],[330,350,6],[330,360,0],[340,10,-4],[340,20,-8],[340,30,-11],[340,40,-13],[340,50,-16],[340,60,-18],[340,70,-19],[340,80,-20],[340,90,-20],[340,100,-20],[340,110,-19],[340,120,-18],[340,130,-16],[340,140,-13],[340,150,-11],[340,160,-8],[340,170,-4],[340,180,0],[340,190,4],[340,200,8],[340,210,11],[340,220,13],[340,230,16],[340,240,18],[340,250,19],[340,260,20],[340,270,20],[340,280,20],[340,290,19],[340,300,18],[340,310,16],[340,320,13],[340,330,11],[340,340,8],[340,350,4],[340,360,0],[350,10,-2],[350,20,-4],[350,30,-5],[350,40,-7],[350,50,-8],[350,60,-9],[350,70,-10],[350,80,-10],[350,90,-10],[350,100,-10],[350,110,-10],[350,120,-9],[350,130,-8],[350,140,-7],[350,150,-5],[350,160,-4],[350,170,-2],[350,180,0],[350,190,2],[350,200,4],[350,210,5],[350,220,7],[350,230,8],[350,240,9],[350,250,10],[350,260,10],[350,270,10],[350,280,10],[350,290,10],[350,300,9],[350,310,8],[350,320,7],[350,330,5],[350,340,4],[350,350,2],[350,360,0],[360,10,0],[360,20,0],[360,30,0],[360,40,0],[360,50,0],[360,60,0],[360,70,0],[360,80,0],[360,90,0],[360,100,0],[360,110,0],[360,120,0],[360,130,0],[360,140,0],[360,150,0],[360,160,0],[360,170,0],[360,180,0],[360,190,0],[360,200,0],[360,210,0],[360,220,0],[360,230,0],[360,240,0],[360,250,0],[45,35,30],[315,35,-30],[314.7,324.6,30],[314.7,35.4,-30],[64,18,33],[334,18,-8],[306.5,301.3,49],[26,18,9],[296,18,-32],[53.5,301.3,-49]];function Uw(i,t){const e=[];return i.forEach(n=>{const r=function(o,s){try{const[a,l]=o,[h,u]=s;return Math.sqrt(Math.pow(h-a,2)+Math.pow(u-l,2))}catch{return 1/0}}(n,t);if(e.length<4&&e.push([...n,r]),r<Math.max(...e.map(o=>o[3]))){const o=e.findIndex(s=>s[3]===Math.max(...e.map(a=>a[3])));e[o]=[...n,r]}}),e}var gh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const ps={pivot:{x:0,y:0},width:0,height:0};class ng extends mc{constructor(t,e,n){var r,o,s,a,l,h,u,p,_;super(t,e,n),this.renderContainer=new Cn.b,this.needCacheAsBitMap=!1,this.backgroundGraphics=null,this.effectList=[],this.strokeGraphics=null,this.ghco=null,this.useGroupFill=!1,this.arrowList=[],this.fillColorFilter=new ds,this.strokeColorFilter=new ds,this.pptColorFilter=new ds,this.id="",this.ppt_c=new GT(this),this.fill=new N0(this),this.stroke=new kT(this),this.effectObject=null,this.effectContainer=new Cn.b,this.effectDisposer=()=>{},this.json=t,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle,this.useGroupFill=!0),this.id=t.id;const{fillStyle:x,lineStyle:w}=this.json;this.container.sortableChildren=!0,this.container.name=t.id+"_container_[Shape]",this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),this.renderContainer.name=t.id+"_render_container_[Shape]",this.generateArrowList(),this.backgroundFill=this.createBackgroundFill(),this.backgroundGraphics=this.createBackgroundGraphics(),this.strokeFill=this.createStrokeFill(),this.strokeGraphics=this.createStrokeGraphics();try{this.ghco=new Tc(this.json.id+"-path-graphics-text-wrap",this.ctx,(s=(o=(r=this.json.textBody)===null||r===void 0?void 0:r.presetTextShape)===null||o===void 0?void 0:o.geometry.paths)!==null&&s!==void 0?s:[],(h=(l=(a=this.json.textBody)===null||a===void 0?void 0:a.presetTextShape)===null||l===void 0?void 0:l.geometry.hash)!==null&&h!==void 0?h:"",{x:0,y:0},((u=this.json.textBody)===null||u===void 0?void 0:u.width)||100,((p=this.json.textBody)===null||p===void 0?void 0:p.height)||100,{width:2,fill:{fillType:"solidFill",color:"#FF0000FF"}},!1,null,null)}catch(A){this.ctx.logger.error(A.message,this.ctx.taskId)}if(this.ctx.timingTargets.addTarget(this.id,this),(x==null?void 0:x.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=x.color,this.fillColorFilter.designColor=x.color),((_=w==null?void 0:w.fill)===null||_===void 0?void 0:_.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=w.fill.color,this.strokeColorFilter.designColor=w.fill.color),this.updateTransform(this.json),t.textBody&&(this.text=new Bw(t.textBody,this.ctx,t.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y},this.json.rotation||0)),this.container.hitArea=new Oe.k(1,1,this.json.width,this.json.height),this.ctx.slideScopeEventHub.once("slide-render",A=>{if(this.ctx.slideIndex===A&&this.effectObject){const C=this.getEffectTexture();if(C){const{texture:G,offsetX:K,offsetY:it}=C;this.effectObject.setFrameOffset(K,it),this.effectObject.createFrame(1,G)}}}),this.ctx.mode==="addLink"){this.interactiveContainer.interactive=!0,this.interactiveContainer.cursor="pointer";const A=new $i;this.interactiveContainer.addListener("pointerover",()=>{const C=this.interactiveContainer.getLocalBounds();A.lineStyle(2,65535),A.beginFill(65535,.2),A.drawRect(0,0,C.width,C.height),A.endFill(),A.position.set(C.x,C.y),this.interactiveContainer.addChild(A),this.interactiveContainer.alpha=.9}),this.interactiveContainer.addListener("pointerout",()=>{this.interactiveContainer.removeChild(A),A.clear(),this.interactiveContainer.alpha=1}),this.interactiveContainer.addListener("click",()=>{this.ctx.globalEventHub.emit("user-add-click",this.json.id)})}}get interactiveContainer(){return this.renderContainer}get strokeActive(){var t,e,n,r,o,s,a;return this.strokeFill.displayObject?((n=(e=(t=this.strokeFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set strokeActive(t){var e,n,r,o,s,a;const{displayObject:l}=this.strokeFill;t?l&&((n=(e=l.filters)===null||e===void 0?void 0:e.indexOf(this.strokeColorFilter))!==null&&n!==void 0?n:-1)<0?l.filters=[this.strokeColorFilter]:((r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.strokeGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.strokeColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.strokeGraphics.displayObject.filters=[this.strokeColorFilter]):l?l.filters=[]:!((a=this.strokeGraphics)===null||a===void 0)&&a.displayObject&&(this.strokeGraphics.displayObject.filters=[])}get pptColorActive(){var t,e;return((e=(t=this.renderContainer.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set pptColorActive(t){this.renderContainer.filters=t?[this.pptColorFilter]:[]}get fillActive(){var t,e,n,r,o,s,a;return this.backgroundFill.displayObject?((n=(e=(t=this.backgroundFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set fillActive(t){var e,n,r,o,s,a;t?this.backgroundFill.displayObject&&((n=(e=this.backgroundFill.displayObject.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0?this.backgroundFill.displayObject.filters=[this.fillColorFilter]:((r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.backgroundGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.fillColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.backgroundGraphics.displayObject.filters=[this.fillColorFilter]):this.backgroundFill.displayObject?this.backgroundFill.displayObject.filters=[]:!((a=this.backgroundGraphics)===null||a===void 0)&&a.displayObject&&(this.backgroundGraphics.displayObject.filters=[])}getTextElement(t,e){var n,r;if(this.json.isMathFallback){if(!this.json.textBody)return this;const o=()=>this.json.textBody.paragraphs[0].lines.length<=1,s=()=>this.json.textBody.paragraphs[0].lines[0].textUnits.length<=1,a=()=>this.json.textBody.paragraphs[0].lines[0].textUnits[0].content.trim()==="";if((()=>this.json.textBody.paragraphs.length<=1)()&&o()&&s()&&a())return this}return(r=(n=this.text)===null||n===void 0?void 0:n.getTextElement(t,e))!==null&&r!==void 0?r:null}getBgElement(){return this}getIterateEntry(t,e,n){return e===0?this:t==="el"?(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null):this.text?this.text.getIterateEntry(e-1,n)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getEffectTexture(){const t=this.effectContainer.getLocalBounds();let e=0,n=0;for(const s of this.effectContainer.children)s.pivot.x>e&&(e=s.pivot.x),s.pivot.y>n&&(n=s.pivot.y);const r=new Oe.d;if(r.translate(e,n),this.effectContainer.children.length===0)return null;const o=ue.p.create({width:t.width,height:t.height,resolution:.5});return this.ctx.renderer.render(this.effectContainer,{renderTexture:o,transform:r}),{texture:o,offsetX:e,offsetY:n}}createStrokeGraphics(){var t,e,n,r;const{id:o,geometry:s,lineStyle:a}=this.json,{width:l,height:h,pivot:u}=(s==null?void 0:s.lineTransform)||ps,p=l||this.json.width,_=h||this.json.height,x=((t=a==null?void 0:a.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?a.fill.color:null;return a&&((e=a.fill)===null||e===void 0?void 0:e.fillType)!=="noFill"?new Tc(o+"-path-graphics",this.ctx,(n=s==null?void 0:s.paths)!==null&&n!==void 0?n:[],(r=s==null?void 0:s.hash)!==null&&r!==void 0?r:"",u||{x:0,y:0},p,_,a,!1,null,x):null}createStrokeFill(){const[t,e]=this.calculateFillObjectOffset(),{geometry:n,lineStyle:r,width:o,height:s}=this.json,a=(n==null?void 0:n.lineTransform)||ps,l=fo()(r==null?void 0:r.width)?r.width:1;return new mo(this.ctx,r==null?void 0:r.fill,(a.width||o)+l+t,Math.max((a.height||s)+l,e),{useFilter:!0,useSlideBackgroundFill:!1})}createBackgroundGraphics(){var t;const{geometry:e,lineStyle:n,fillStyle:r,id:o}=this.json,{width:s,height:a,pivot:l}=(e==null?void 0:e.lineTransform)||ps,h=s||this.json.width,u=a||this.json.height,p=(r==null?void 0:r.fillType)==="solidFill"?r.color:null;return r&&r.fillType!=="noFill"||this.json.isPicture?new Tc(o+"-bg-graphics",this.ctx,(t=e==null?void 0:e.paths)!==null&&t!==void 0?t:[],(e==null?void 0:e.hash)||"",l||{x:0,y:0},h,u,n,!0,p,null):null}createBackgroundFill(){var t,e,n,r;const{fillStyle:o,width:s,height:a,lineStyle:l,geometry:h}=this.json,u=(h==null?void 0:h.fillTransform)||ps,p={useFilter:!0,useSlideBackgroundFill:this.json.useBgFill,fillFloat:this.json.fillFloat,shapeRotation:this.json.rotation,groupRotation:this.option.groupRotation},_=this.useGroupFill&&((t=this.option.groupSize)===null||t===void 0?void 0:t.w)?this.option.groupSize.w:u.width||s,x=this.useGroupFill&&((e=this.option.groupSize)===null||e===void 0?void 0:e.h)?this.option.groupSize.h:u.height||a;return new mo(this.ctx,o,_+((n=l==null?void 0:l.width)!==null&&n!==void 0?n:0),x+((r=l==null?void 0:l.width)!==null&&r!==void 0?r:0),p)}createBackground(){var t,e,n,r,o,s,a,l,h,u,p,_;const{pivot:x,width:w,height:A}=((t=this.json.geometry)===null||t===void 0?void 0:t.fillTransform)||ps,{displayObject:C}=this.backgroundFill;C?(this.json.useBgFill&&((n=this.backgroundGraphics)===null||n===void 0?void 0:n.displayObject)?(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,C.pivot.x=((r=this.json.position)===null||r===void 0?void 0:r.x)||0,C.pivot.y=((o=this.json.position)===null||o===void 0?void 0:o.y)||0,this.effectContainer.addChild(this.backgroundGraphics.displayObject)):((s=this.json.fillStyle)===null||s===void 0?void 0:s.fillType)==="gifFill"?(C.height=A||this.designHeight,C.width=w||this.designWidth,C instanceof ih&&C.play(),!((a=this.backgroundGraphics)===null||a===void 0)&&a.isNeedMask(C.width,C.height)&&(C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))):!((l=this.backgroundGraphics)===null||l===void 0)&&l.isNeedMask(C.width,C.height)&&(this.json.fillFloat||(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))),this.json.fillFloat||(C.x=x.x,C.y=x.y),this.useGroupFill&&(C.x-=(u=(h=this.json.position)===null||h===void 0?void 0:h.x)!==null&&u!==void 0?u:0,C.y-=(_=(p=this.json.position)===null||p===void 0?void 0:p.y)!==null&&_!==void 0?_:0),this.effectContainer.addChild(C)):this.backgroundFill.hasFill&&((e=this.backgroundGraphics)===null||e===void 0?void 0:e.displayObject)&&this.effectContainer.addChild(this.backgroundGraphics.displayObject)}createPathFill(){var t,e,n;const{displayObject:r}=this.strokeFill,o=(t=this.strokeGraphics)===null||t===void 0?void 0:t.displayObject,[s,a]=this.calculateFillObjectOffset();r?(((e=this.strokeGraphics)===null||e===void 0?void 0:e.isNeedMask(r.width,r.height))&&o&&(this.needCacheAsBitMap=!0,r.pivot.x=o.pivot.x,r.pivot.y=o.pivot.y,o.pivot.x=0,o.pivot.y=0,r.mask=o,r.addChild(o),r.position.x=-s/2,r.position.y=-a/2,o.position.x=s/2,o.position.y=a/2),this.effectContainer.addChild(r)):this.strokeFill.hasFill&&((n=this.strokeGraphics)===null||n===void 0?void 0:n.displayObject)&&this.effectContainer.addChild(this.strokeGraphics.displayObject)}createFilledPathMask(){var t,e,n;const r=((e=(t=this.json.geometry)===null||t===void 0?void 0:t.paths)===null||e===void 0?void 0:e.filter(o=>o.fill!=="none"&&o.fill!=="norm"))||[];for(const o of r){const s=this.ctx.graphicsTexture.getGraphicsData(o.id);if(s){const a=new ci(s.texture);a.pivot.x=s.pivot.x,a.pivot.y=s.pivot.y,a.scale.x=s.scale,a.scale.y=s.scale;const l=this.backgroundFill.getClonedDisplayObject(),h=(n=this.backgroundGraphics)===null||n===void 0?void 0:n.getClonedDisplayObject(),u=l||h;u&&(this.backgroundFill.displayObject&&(u.pivot.x=this.backgroundFill.displayObject.pivot.x,u.pivot.y=this.backgroundFill.displayObject.pivot.y),u.mask=a,u.filters=[WT[o.fill]],this.needCacheAsBitMap=!0,this.effectContainer.addChild(u),this.effectContainer.addChild(a))}}}createArrow(){this.arrowList.length&&this.arrowList.forEach(t=>{var e;const n=this.ctx.graphicsTexture.getGraphicsData(t.graphicsId);if(n){const{texture:r}=n,o=new ci(r);o.pivot.x=t.pivot.x,o.pivot.y=t.pivot.y,o.position.x=t.position.x,o.position.y=t.position.y,o.rotation=t.rotate/180*Math.PI,o.scale.x=n.scale,o.scale.y=n.scale,this.json.fillStyle&&this.json.fillStyle.fillType!=="noFill"?(e=this.backgroundGraphics)===null||e===void 0||e.addArrows(o):this.effectContainer.addChild(o)}})}generateArrowList(){var t,e;const{lineArrowList:n,lineStyle:r,id:o}=this.json,s=((t=r==null?void 0:r.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?r.fill.color:null;(e=n||[])===null||e===void 0||e.forEach((a,l)=>{var h,u,p,_,x,w,A,C;const G=new kw(Object.assign(Object.assign({},a),{position:{x:a.position.x-((p=(u=(h=this.json.geometry)===null||h===void 0?void 0:h.lineTransform)===null||u===void 0?void 0:u.pivot.x)!==null&&p!==void 0?p:0),y:a.position.y-((w=(x=(_=this.json.geometry)===null||_===void 0?void 0:_.lineTransform)===null||x===void 0?void 0:x.pivot.y)!==null&&w!==void 0?w:0)},fillStyle:r==null?void 0:r.fill,lineWidth:(A=r==null?void 0:r.width)!==null&&A!==void 0?A:0}));G.graphicsId=`${o}-arrow-${l}-graphics`,G.textureId=`${o}-arrow-${l}-fill`,this.ctx.graphicsTexture.addGraphics(G.graphicsId,(C=G.paths)!==null&&C!==void 0?C:[],G.hash,{x:0,y:0},G.width,G.height,void 0,this.ctx.objectPoolGroup,!0,s,null),this.arrowList.push(G)})}calculateFillObjectOffset(){let[t,e]=[0,0];return this.arrowList.length&&(t=this.arrowList.reduce((n,r)=>Math.max(n,r.width),0),e=this.arrowList.reduce((n,r)=>Math.max(n,r.height),0)),[t,e]}preRender(t){var e,n,r;const{lineStyle:o,geometry:s}=this.json,{width:a,height:l}=(s==null?void 0:s.lineTransform)||ps,h=a||this.json.width,u=l||this.json.height,p=((e=s==null?void 0:s.paths)===null||e===void 0?void 0:e.filter(x=>x.fill!=="none"&&x.fill!=="norm"))||[],_=((n=o==null?void 0:o.fill)===null||n===void 0?void 0:n.fillType)==="solidFill"?o.fill.color:null;t.addSubMTask(()=>gh(this,void 0,void 0,function*(){for(const x of p)this.ctx.graphicsTexture.addGraphics(x.id,[x],x.hash,((s==null?void 0:s.lineTransform)||ps).pivot,h,u,o,this.ctx.objectPoolGroup,!0,null,_)}),"@ShapeImpl[addGraphics]"),(r=this.text)===null||r===void 0||r.createParagraphs(this.json.id,t)}subClassRender(){return gh(this,void 0,void 0,function*(){})}render(t){t.addSubMTask(()=>gh(this,void 0,void 0,function*(){var e,n;(e=this.strokeGraphics)===null||e===void 0||e.render(),(n=this.backgroundGraphics)===null||n===void 0||n.render(),this.createBackground(),yield this.subClassRender(),this.createFilledPathMask(),this.createPathFill(),this.createArrow()}),"@ShapeImpl[render]"),this.text&&this.text.render(t),t.addSubMTask(()=>gh(this,void 0,void 0,function*(){var e,n,r,o,s,a,l,h,u,p,_,x,w,A,C,G,K,it,ft;if(((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="wd"||((n=this.json.textBody)===null||n===void 0?void 0:n.iterateType)==="lt"){if(this.renderContainer.addChild(this.container),this.text){const{x:nt,y:gt}=(r=this.json.scale)!==null&&r!==void 0?r:{x:1,y:1};this.text.container.scale.x=gt<0?-Math.abs(nt):Math.abs(nt),this.text.container.scale.y=gt,this.text.container.position.x=((s=(o=this.json.position)===null||o===void 0?void 0:o.x)!==null&&s!==void 0?s:0)+this.text.x,this.text.container.position.y=((l=(a=this.json.position)===null||a===void 0?void 0:a.y)!==null&&l!==void 0?l:0)+this.text.y,this.text.container.scale.y<0&&(this.text.container.position.y+=this.text.height),this.text.container.scale.x<0&&(this.text.container.position.x+=this.json.width),this.json.textRotation&&(this.text.container.rotation=this.json.textRotation),this.renderContainer.addChild(this.text.container)}}else{if(this.text){if(this.json.textRotation){this.text.container.rotation=this.json.textRotation;const{width:dt,height:Ut}=this.text,{x:Ft,y:Et}=this.text.container.position;this.text.container.pivot.x=dt/2,this.text.container.pivot.y=Ut/2,this.text.container.x=Ft+dt/2,this.text.container.y=Et+Ut/2}if(zT()(this.json.textRotateWithShape)&&!this.json.textRotateWithShape){const dt=this.json.rotation||0;this.text.container.rotation=-dt;const{width:Ut}=this.text;this.text.container.position.x=Ut}this.text.container.zIndex=100;const nt=(h=this.json.effectList)===null||h===void 0?void 0:h.find(dt=>dt.type==="outerShadow"),gt=(u=this.json.effectList)===null||u===void 0?void 0:u.find(dt=>dt.type==="softEdge"),lt=(p=this.json.effectList)===null||p===void 0?void 0:p.find(dt=>dt.type==="glow");nt&&nt.sx!==1||gt||lt?this.container.addChild(this.text.container):this.effectContainer.addChild(this.text.container)}this.renderContainer.addChild(this.container)}if(this.json.id==="background"&&this.ctx.hasBackgroundFillShape){const nt=ue.p.create({width:this.json.width,height:this.json.height,resolution:Math.ceil(this.ctx.renderer.resolution)});this.ctx.renderer.render(this.renderContainer,{renderTexture:nt}),this.ctx.bgTexture=nt}if(((_=this.json.fillStyle)===null||_===void 0?void 0:_.fillType)==="noFill"){const nt=(w=(x=this.json.effectList)===null||x===void 0?void 0:x.findIndex(gt=>gt.type==="innerShadow"))!==null&&w!==void 0?w:-1;nt>=0&&((A=this.json.effectList)===null||A===void 0||A.splice(nt,1))}if(this.json.effectList&&this.json.effectList.length>0&&((C=this.ctx.featureList)===null||C===void 0?void 0:C.effect)&&!this.ctx.forceCanvas&&!this.json.media&&(this.effectObject=new Z0(this.effectContainer,this.json.effectList,`${this.ctx.taskId}_${this.ctx.slideIndex}_${this.json.id}`,this.ctx,this.json.rotation||0,new Oe.g(((G=this.json.scale)===null||G===void 0?void 0:G.x)||1,((K=this.json.scale)===null||K===void 0?void 0:K.y)||1)),function(nt){var gt,lt,dt;return((gt=nt.fillStyle)===null||gt===void 0?void 0:gt.fillType)==="gifFill"||((dt=(lt=nt.lineStyle)===null||lt===void 0?void 0:lt.fill)===null||dt===void 0?void 0:dt.fillType)==="gifFill"||!!nt.picFill&&nt.picFill.fillType==="gifFill"}(this.json)&&this.effectObject.setFrameCount(-1),this.effectObject.on("ready",()=>{var nt;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(nt=this.effectObject)===null||nt===void 0||nt.updateFrame(1),this.applyEffectCacheAsBitMap(!0)})),(ft=(it=this.json.scene3d)===null||it===void 0?void 0:it.camera)===null||ft===void 0?void 0:ft.rotation)try{const{latitude:nt,longitude:gt,revolution:lt}=this.json.scene3d.camera.rotation,dt=function(Pt,ee){if(Pt===0||ee===0)return 0;const $t=eg.find(zt=>zt[0]===Pt&&zt[1]===ee);return $t?$t[2]*Math.PI/180:function(zt){if(zt.length<4)return 0;let Xt=0;for(const pe of zt)Xt+=pe[2];return Xt/zt.length}(Uw(eg,[Pt,ee]))*Math.PI/180}(gt,nt),{width:Ut,height:Ft}=this.effectContainer;let Et=Math.cos(gt/180*Math.PI);const Mt=Math.cos(nt/180*Math.PI);dt!==0&&(Et/=Math.cos(dt)),this.effectContainer.scale.x*=Et,this.effectContainer.scale.y*=Mt,this.effectContainer.skew.y=dt,this.effectContainer.position.x+=(Ut-this.effectContainer.width*Math.cos(dt))/2;const Lt=this.effectContainer.height+this.effectContainer.width*Math.sin(dt);this.effectContainer.position.y+=(Ft-Lt)/2,this.effectContainer.angle-=lt}catch(nt){this.ctx.logger.error("[ShapeImpl][render] 3d scene error: "+nt.message,this.ctx.taskId)}}),"@ShapeImpl[post.render]")}applyEffectCacheAsBitMap(t){var e,n;((e=this.json.fillStyle)===null||e===void 0?void 0:e.fillType)!=="gifFill"&&((n=this.effectObject)===null||n===void 0||n.container.children.forEach(r=>{r.name!=="effect-sprite"&&(r.cacheAsBitmap=t)}))}clearOnSlideChange(){}initOnReuse(){}destroy(){var t,e,n,r;(t=this.text)===null||t===void 0||t.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.backgroundFill.destroy(),(e=this.backgroundGraphics)===null||e===void 0||e.destroy(),this.strokeFill.destroy(),(n=this.strokeGraphics)===null||n===void 0||n.destroy(),this.renderContainer.destroy(),(r=this.arrowRenderTexture)===null||r===void 0||r.destroy(!0),this.arrowList=[],this.effectDisposer()}}var Gw=v(119);const wc=new(v.n(Gw)).a,Hw=wc.getDevice(),jw=wc.getBrowser(),vh=wc.getOS(),fs={isDesktop(){let i=!0;return Hw.type==="mobile"&&(i=!1),/Samsung/.test(jw.name||"")&&(i=!1),window.__nativeTags&&window.__nativeTags.platform&&(i=!1),i},isIOS(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^ios/i.test(window.__nativeTags.platform)&&(i=!0),vh.name&&/iOS/.test(vh.name)&&(i=!0),i},isAndroid(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^android/i.test(window.__nativeTags.platform)&&(i=!0),vh.name&&/android/i.test(vh.name)&&(i=!0),i},isLowGpuMemory(){var i,t;const e=(t=(i=window.__nativeTags)===null||i===void 0?void 0:i.platform)!==null&&t!==void 0?t:"";if(e){const n=e.split(" ");if(n[1]){if(/^iPad/.test(n[1])){const r=n[1].match(/^iPad(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=6)}if(/^iPhone/.test(n[1])){const r=n[1].match(/^iPhone(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=9)}return!1}return!1}return!0}};var _h=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function rr(i,t){for(const e in t)i.style[e]=t[e]}const Wo={medianContainerClass:"median-container",hoverHiddeDelay:1500,portalWidth:300,portalHeight:50,hiddenOpacity:"0",hoverOpacity:"1",opacityAnimationTime:.4};class Ya{get clippedDuration(){return this.duration}constructor(t){var e,n;this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.fullScreenButton=document.createElement("div"),this.exitFullScreenButton=document.createElement("div"),this.medianIsEnd=!1,this.pickBookmarkIndex=0,this.playCallBackList=[],this.duration=0,this.isVideo=!1,this.start=0,this.end=0,this.fullscreenStatus=!1,this.fadeState={in:!1,out:!1},this.changeMediaProgress=r=>{if(this.ctx.isPlayerPaused())return void this.ctx.logger.info("Media controller prevent seek event with paused state",this.ctx.taskId);r.stopPropagation();const o=r.offsetX/this.progress.clientWidth*this.duration;this.medianIsEnd=!1,this.ctx.mode!=="interactive"&&this.jumpToTime(o),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(We.mediaSeek,{id:this.targetId,time:o,isPlaying:this.media.isPlaying}),this.delayHide()},this.jumpToTime=(r=0)=>_h(this,void 0,void 0,function*(){yield sh(()=>!!this.duration,3e3);const o=Math.floor(r)+this.start;this.media.currentTime!==o&&(this.media.currentTime=o,this.changeBookmarkIndex(o,o>this.media.currentTime))}),this.showController=r=>{r.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.media.duration,this.start&&(this.duration-=this.start,this.jumpToTime()),this.end&&(this.duration-=this.end)),this.totalTime.innerText=Ya.formatTime(this.duration)},this.playMedia=()=>_h(this,void 0,void 0,function*(){this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.media.play(),this.medianIsEnd&&(this.medianIsEnd=!1,this.jumpToTime()),this.playCallBackList.forEach(r=>{r()}),this.delayHide()}),this.pauseMedia=()=>_h(this,void 0,void 0,function*(){this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.media.pause()}),this.onMouseOut=r=>{r.stopPropagation(),this.hide()},this.mediaTimeUpdate=()=>_h(this,void 0,void 0,function*(){const r=this.media.currentTime-this.start;if(this.duration>0&&(Math.abs(r-this.duration)<.3||r>this.duration)&&(yield this.pauseMedia(),this.medianIsEnd=!0,this.jumpToTime(),this.ctx.eventHub.emit(We.mediaStop,{id:this.targetId}),this.onClickCancelFullScreenButtonHandle()),this.currentTime.innerText=Ya.formatTime(r),this.currentProgress.style.flex=(r/this.duration).toString(),this.bookmarkList&&this.bookmarkList.length>0){const o=this.bookmarkList[this.pickBookmarkIndex];o&&o.time.toFixed(0)===this.media.currentTime.toFixed(0)&&(this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`),this.pickBookmarkIndex+=1)}this.fadeHit(r)}),this.onPauseMedia=()=>{this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.fadeState={in:!1,out:!1},this.fadeHit(0),this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(r=>{r()}),this.media.currentTime<this.start&&this.jumpToTime()},this._playMediaFromCtrl=()=>{this.playMediaFromCtrl(!1)},this._pauseMediaFromCtrl=()=>{this.pauseMediaFromCtrl(!1),this.delayHide()},this.onClickFullScreenButtonHandle=()=>{this.fullscreenPlay()},this.onClickCancelFullScreenButtonHandle=()=>{this.fullscreenStatus=!1,this.media.requestCancelFullscreen(),this.ctx.eventHub.emit(We.fullscreenChange,{targetId:this.targetId,state:!1}),this.delayHide()},this.onFullScreenChange=r=>{const{status:o,targetId:s,slideIndex:a}=r;this.changeFullScreenState(o,s,a),this.delayHide()},this.onContainerSizeChange=()=>{this.setControllerPosition()},this.onControllerShowStatusChange=({slideIndex:r,targetId:o,status:s})=>{if(r===this.ctx.slideIndex){if(this.targetId===o){const{hiddenOpacity:a,hoverOpacity:l}=Wo;s?(this.mediaController.style.opacity=l,this.mediaController.style.display="flex"):this.mediaController.style.opacity=a}this.delayHide()}},this.targetId=t.targetId,this.ctx=t.ctx,this.height=t.height,this.width=t.width,this.target=t.target,this.media=t.media,this.info=t.info,this.shapeId=t.shapeId,this.canvasElement=t.canvasElement,this.media.type==="video"&&(this.isVideo=!0),this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(e=this.info.cut.start)!==null&&e!==void 0?e:0,this.end=(n=this.info.cut.end)!==null&&n!==void 0?n:0),this.info.bookmarkList&&(this.bookmarkList=this.info.bookmarkList.sort((r,o)=>r.time-o.time)),this.ctx.globalEventHub.on("togglePlayStatus",r=>{r===this.targetId&&(this.media.isPlaying?this.pauseMediaFromCtrl(!1):this.playMediaFromCtrl(!1))})}getMedianContainer(){var t;const{medianContainerClass:e}=Wo;let n=(t=this.canvasElement.parentElement)===null||t===void 0?void 0:t.querySelector("."+e);n||(n=document.createElement("div"),n.className=e,this.canvasElement.parentElement.appendChild(n)),this.container=n}static formatTime(t){let e="00:00";if(t){const n=Math.floor(t/60),r=String(n<0?0:n).padStart(2,"0"),o=Math.floor(t%60);e=`${r}:${String(o<0?0:o).padStart(2,"0")}`}return e}generatePlayButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","polyline");return r.setAttributeNS(null,"points","35 0, 477 256, 35 512"),r.setAttributeNS(null,"fill","#000000"),n.appendChild(r),n}generatePauseButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px"}),n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"x","35"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","148"),r.setAttributeNS(null,"height","512");const o=r.cloneNode(!0);return o.setAttributeNS(null,"x","330"),n.append(r,o),n}generateFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M918.116352 107.409408c10.186752 10.175488 10.186752 26.691584 0 36.87936L653.734912 407.038976c-10.187776 10.187776-26.703872 10.187776-36.891648 0-10.175488-10.187776-10.175488-26.703872 0.013312-36.891648l264.38144-262.73792c10.174464-10.187776 26.69056-10.200064 36.87936-0.013312L918.117376 107.409408zM878.281728 148.096l-161.155072-0.44544c-11.283456 0.279552-20.85888-8.226816-21.90336-19.458048l0-13.421568c0.318464-10.671104 8.889344-19.241984 19.560448-19.560448l187.030528 0.827392c0.1792-0.037888 0.357376-0.0768 0.523264-0.089088l9.549824-0.229376c5.005312-0.152576 9.843712 1.770496 13.372416 5.336064 3.32288 3.629056 4.9664 8.49408 4.545536 13.40928l-1.032192 9.537536c0 0.191488 0.70144 0.318464 0.70144 0.49664l-0.534528 188.279808c-0.54784 9.984-9.092096 17.637376-19.076096 17.089536-0.165888-0.012288-0.319488-0.0256-0.484352-0.037888L896.009216 329.8304c-10.379264-0.0512-18.733056-8.506368-18.681856-18.885632 0.013312-0.191488 0.013312-0.381952 0.013312-0.585728L878.281728 148.096zM105.884672 916.661248c-10.187776-10.175488-10.200064-26.691584-0.013312-36.87936 0 0 0-0.013312 0.013312-0.013312l265.19552-262.73792c10.35264-10.008576 26.86976-9.729024 36.866048 0.636928 9.766912 10.110976 9.766912 26.131456 0 36.242432L143.579136 916.661248C133.072896 926.848 116.3776 926.848 105.884672 916.661248L105.884672 916.661248zM146.533376 875.973632l161.154048 0.433152c11.283456-0.292864 20.85888 8.213504 21.891072 19.458048l0 13.38368c-0.292864 10.672128-8.876032 19.255296-19.560448 19.561472l-187.858944-0.828416c-0.165888 0.037888-0.344064 0.075776-0.509952 0.089088l-9.550848 0.229376c-5.004288 0.152576-9.831424-1.782784-13.35808-5.336064-3.323904-3.629056-4.979712-8.493056-4.54656-13.395968l1.031168-9.537536c0-0.191488-0.712704-0.330752-0.700416-0.509952l0.534528-188.278784c0.534528-9.984 9.066496-17.625088 19.050496-17.089536 0.165888 0.013312 0.330752 0.0256 0.508928 0.037888l14.212096 0c10.365952 0.0512 18.719744 8.507392 18.656256 18.873344 0 0.191488 0 0.395264-0.013312 0.598016L146.533376 875.973632zM918.116352 916.661248c10.186752-10.175488 10.200064-26.691584 0.012288-36.87936 0 0 0-0.013312-0.012288-0.013312l-264.38144-262.73792c-10.365952-10.008576-26.86976-9.729024-36.87936 0.636928-9.766912 10.110976-9.766912 26.131456 0 36.242432L881.22368 916.661248c10.186752 10.186752 26.703872 10.186752 36.891648 0.013312L918.115328 916.661248 918.116352 916.661248zM878.281728 875.973632l-161.168384 0.433152c-11.270144-0.292864-20.845568 8.213504-21.890048 19.458048l0 13.38368c0.306176 10.672128 8.889344 19.241984 19.560448 19.561472l187.030528-0.828416c0.1792 0.037888 0.357376 0.075776 0.523264 0.089088l9.549824 0.229376c5.005312 0.152576 9.843712-1.782784 13.372416-5.336064 3.32288-3.629056 4.978688-8.493056 4.545536-13.395968l-1.032192-9.537536c0-0.191488 0.70144-0.330752 0.70144-0.509952l-0.534528-188.278784c-0.54784-9.984-9.092096-17.637376-19.076096-17.089536-0.165888 0.013312-0.319488 0.0256-0.484352 0.037888L896.009216 694.19008c-10.379264 0.0512-18.733056 8.507392-18.681856 18.885632 0 0.191488 0.013312 0.381952 0.013312 0.584704L878.281728 875.973632zM105.884672 107.409408c-10.187776 10.175488-10.187776 26.691584 0 36.87936l265.19552 262.750208c10.187776 10.187776 26.691584 10.187776 36.87936 0s10.175488-26.703872-0.012288-36.891648l-264.368128-262.73792C133.072896 97.222656 116.3776 97.222656 105.884672 107.409408L105.884672 107.409408zM146.533376 148.096l161.154048-0.44544c11.283456 0.292864 20.85888-8.213504 21.891072-19.458048l0-13.421568c-0.306176-10.671104-8.889344-19.241984-19.560448-19.560448l-187.858944 0.827392c-0.165888-0.0512-0.344064-0.0768-0.509952-0.089088l-9.550848-0.229376c-5.004288-0.152576-9.831424 1.782784-13.35808 5.336064-3.323904 3.629056-4.979712 8.49408-4.54656 13.40928l1.031168 9.537536c0 0.191488-0.712704 0.318464-0.700416 0.49664l0.534528 188.279808c0.534528 9.970688 9.066496 17.624064 19.050496 17.089536 0.165888-0.012288 0.330752-0.0256 0.508928-0.037888l14.212096 0c10.365952-0.0512 18.719744-8.506368 18.656256-18.87232 0-0.191488 0-0.395264-0.013312-0.598016L146.533376 148.096z"),n.appendChild(r),document.body.appendChild(n),n}generateExitFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path"),o=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M716.8 998.4a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 0 1 25.6-25.6h256a25.6 25.6 0 1 1 0 51.2h-230.4v230.4a25.6 25.6 0 0 1-25.6 25.6zM307.2 998.4a25.6 25.6 0 0 1-25.6-25.6v-230.4H51.2a25.6 25.6 0 1 1 0-51.2h256a25.6 25.6 0 0 1 25.6 25.6v256a25.6 25.6 0 0 1-25.6 25.6zM972.8 332.8h-256a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 1 1 51.2 0v230.4h230.4a25.6 25.6 0 1 1 0 51.2zM307.2 332.8h-256a25.6 25.6 0 1 1 0-51.2h230.4V51.2a25.6 25.6 0 1 1 51.2 0v256a25.6 25.6 0 0 1-25.6 25.6z"),o.setAttributeNS(null,"d","M307.2 332.8a25.6 25.6 0 0 1-18.112-7.488L56.896 93.12a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192A25.6 25.6 0 0 1 307.2 332.8zM716.8 332.8a25.6 25.6 0 0 1-18.112-43.712L930.88 56.896a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488zM948.992 974.592a25.6 25.6 0 0 1-18.112-7.488l-232.192-232.192a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192a25.6 25.6 0 0 1-18.112 43.712zM75.008 974.592a25.6 25.6 0 0 1-18.112-43.712l232.192-232.192a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488z"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),n}createButton(){const t={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px",display:"flex",justifyContent:"center",alignItems:"center"};rr(this.playButton,Object.assign(Object.assign({},t),{display:"block"}));const e=this.generatePlayButton();rr(e,{height:"20px"}),this.playButton.appendChild(e),rr(this.pauseButton,Object.assign(Object.assign({},t),{display:"none"}));const n=this.generatePauseButton();if(rr(n,{height:"20px"}),this.pauseButton.appendChild(n),!this.isVideo)return;const r=this.generateFullScreenButton(20,20);this.fullScreenButton.appendChild(r),rr(this.fullScreenButton,Object.assign(Object.assign({},t),{display:"block"}));const o=this.generateExitFullScreenButton(20,20);this.exitFullScreenButton.appendChild(o),rr(this.exitFullScreenButton,Object.assign(Object.assign({},t),{display:"none"}))}createTimer(){const t=document.createElement("div");rr(t,{width:"100px"}),this.currentTime.innerText="00:00";const e=document.createElement("span");return e.innerText="/",t.append(this.currentTime,e,this.totalTime),t}createProgress(){const t={flex:"1",position:"relative"};this.isVideo||(t.marginRight="10px"),rr(this.progress,t);const e=document.createElement("div");rr(e,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(e),rr(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),e.appendChild(this.currentProgress)}fadeHit(t){if(!this.info.fade)return;const{start:e,end:n}=this.info.fade;e&&!this.fadeState.in&&t>=0&&(this.fadeState.in=!0,this.media.fadeIn(0,e)),n&&!this.fadeState.out&&t>=this.duration-n/1e3&&(this.fadeState.out=!0,this.media.fadeOut(0,n))}changeBookmarkIndex(t,e){if(this.bookmarkList&&this.bookmarkList.length!==0){if(this.pickBookmarkIndex>0){for(let n=0;n<this.pickBookmarkIndex;n++)if(this.bookmarkList[n].time>t){this.pickBookmarkIndex=n;break}}if(e){let n=this.pickBookmarkIndex-1;for(let r=0;r<this.bookmarkList.length;r++)this.bookmarkList[r].time<t&&(n=r);for(let r=this.pickBookmarkIndex;r<=n;r++){const o=this.bookmarkList[r];o&&this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`)}this.pickBookmarkIndex=n+1}}}playMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent play event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.playMedia(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(We.mediaPlay,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}pauseMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent pause event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.pauseMedia(),this.ctx.mode==="local"||this.ctx.isRendering||this.ctx.eventHub.emit(We.mediaPause,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}setControllerPosition(){var t;const{target:e}=this,{portalWidth:n,portalHeight:r}=Wo,{stageWidth:o,stageHeight:s}=this.ctx,a=e.getGlobalPosition(),l=Number((t=this.container)===null||t===void 0?void 0:t.getAttribute("data-scale")),h=o*l,u=1/l*(n>h?h/n:1);a.y=a.y+this.height-r,a.x=Math.max(a.x,0),a.x=Math.min(a.x,o-n*u),a.y=Math.max(a.y,0),a.y=Math.min(a.y,s-r),rr(this.mediaController,{height:r+"px",borderRadius:r/2+"px",width:n+"px",flexDirection:"row",alignItems:"center",position:"absolute",left:a.x+"px",top:a.y+"px",background:"#fff",zIndex:"2",border:"1px solid #ccc",transform:`scale(${u})`,transformOrigin:"0 100%"}),this.fullscreenStatus&&rr(this.mediaController,{left:"0",top:s-r+"px"})}createMediaController(){this.setControllerPosition(),rr(this.mediaController,{display:"none",transition:`opacity ${Wo.opacityAnimationTime}s`}),this.createButton();const t=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,t,this.progress),this.isVideo&&this.mediaController.append(this.fullScreenButton,this.exitFullScreenButton),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(t){this.playCallBackList.push(t)}fullscreenPlay(){this.fullscreenStatus=!0,this.ctx.mode!=="interactive"&&this.media.requestFullscreen(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(We.fullscreenChange,{targetId:this.targetId,state:!0}),this.delayHide()}changeFullScreenState(t,e,n){n===this.ctx.slideIndex&&(t&&this.targetId===e?this.fullscreenStatus=t:this.fullscreenStatus=!1,this.fullscreenStatus?(this.fullScreenButton.style.display="none",this.exitFullScreenButton.style.display="block"):(this.fullScreenButton.style.display="block",this.exitFullScreenButton.style.display="none"),this.setControllerPosition())}bindEvent(){fs.isDesktop()&&(this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.mediaController.addEventListener("mouseover",this.showController,!1)),this.progress.addEventListener("click",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.addEventListener("click",this._pauseMediaFromCtrl,!1),this.media.on("durationchange",this.getMediaDuration,!1),this.media.on("timeupdate",this.mediaTimeUpdate,!1),this.media.on("pause",this.onPauseMedia,!1),this.media.on("play",this.onPlayMedia,!1),this.containerObserver=new MutationObserver(this.onContainerSizeChange),this.container&&this.containerObserver.observe(this.container,{attributes:!0,attributeFilter:["data-scale","style"]}),this.isVideo&&(this.ctx.globalEventHub.on("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.on("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.addEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.addEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}unbindEvent(){var t;fs.isDesktop()&&(this.mediaController.removeEventListener("mouseout",this.onMouseOut,!1),this.mediaController.removeEventListener("mouseover",this.showController,!1)),this.progress.removeEventListener("click",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.removeEventListener("click",this._pauseMediaFromCtrl,!1),this.media.removeAllListeners(),(t=this.containerObserver)===null||t===void 0||t.disconnect(),this.isVideo&&(this.ctx.globalEventHub.removeListener("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.removeListener("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.removeEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.removeEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}show(){this.setControllerPosition(),this.mediaController.style.opacity=Wo.hoverOpacity,this.fullscreenStatus||(this.mediaController.style.display="flex"),this.delayHide()}hide(){this.fullscreenStatus?this.mediaController.style.opacity=Wo.hiddenOpacity:this.mediaController.style.display="none"}delayHide(){clearTimeout(this.autoHiddenTimer),this.autoHiddenTimer=setTimeout(()=>{this.hide()},Wo.hoverHiddeDelay)}destroy(){var t;this.unbindEvent(),this.playCallBackList=[],(t=this.container)===null||t===void 0||t.removeChild(this.mediaController)}}var zw=v(120);class Sc extends fi.a{constructor(t,e,n,r){var o,s;super(),this.isGlobalPause=!1,this.lastTime=-1,this.howl=null,this.rctClient=null,this.domAudio=null,this.pcmSource=null,this.isHowlEnd=!1,this.isHowlLoadEmit=!1,this.staticEventId=1001,this._catParams=void 0,this.isDomAudioPlayed=!1,this.domAudioRemainSeek=[],this.url=t,this.runningAudio=e,n&&(this._catParams=n),hr.RtcAudioClazz?(this.rctClient=new hr.RtcAudioClazz(t,(o=this._catParams)===null||o===void 0?void 0:o.start,(s=this._catParams)===null||s===void 0?void 0:s.end),this.rctClient.on("load",()=>this.emit("load")),this.rctClient.on("pause",()=>this.emit("pause")),this.rctClient.on("play",()=>{this.startTimeChangeEmit(),this.emit("play")}),this.rctClient.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{this.emit("resumeAllAudioInterruptByAudioSessionChanged")})):window.__pcmProxy?(this.domAudio=document.createElement("audio"),this.domAudio.src=t,this.domAudio.crossOrigin="anonymous",this.domAudio.addEventListener("pause",()=>{this.emit("pause")}),this.pcmSource=window.__pcmProxy.connect(this.domAudio),this.domAudio.addEventListener("loadedmetadata",()=>{this.emit("load")}),this.domAudio.addEventListener("playing",()=>{this.isDomAudioPlayed=!0,this.domAudioRemainSeek.length>0&&this.domAudio&&(this.domAudio.currentTime=this.domAudioRemainSeek[this.domAudioRemainSeek.length-1]),this.startTimeChangeEmit(),this.emit("play")})):(this.howl=new zw.Howl({src:[t],html5:r==null?void 0:r.enableWebAudio}),[this.staticEventId]=this.howl._getSoundIds(),this.howl.load(),this.howl.on("load",()=>{this.isHowlLoadEmit=!0,this.emit("load")}),this.howl.on("pause",()=>this.emit("pause")),this.howl.on("play",()=>{this.isHowlLoadEmit||this.emit("load"),this.isHowlEnd=!1,this.startTimeChangeEmit(),this.emit("play")}),this.howl.on("end",()=>{this.isHowlEnd=!0}))}startTimeChangeEmit(){this.currentTime!==this.lastTime&&(this.lastTime=this.currentTime,this.emit("timeupdate",this.lastTime)),this.isPaused||setTimeout(()=>{this.isPaused||this.startTimeChangeEmit()},300)}play(){var t,e,n,r;this.runningAudio.has(this.url)&&((t=this.runningAudio.get(this.url))===null||t===void 0||t.stop(),this.runningAudio.delete(this.url)),this.isHowlEnd=!1,this.lastTime=-1,(e=this.howl)===null||e===void 0||e.play(this.staticEventId),(n=this.rctClient)===null||n===void 0||n.play(),(r=this.domAudio)===null||r===void 0||r.play(),this.runningAudio.set(this.url,this)}fade(t,e,n){this.howl&&this.howl.fade(t,e,n)}pause(){var t,e,n;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),(e=this.rctClient)===null||e===void 0||e.pause(),(n=this.domAudio)===null||n===void 0||n.pause(),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}globalPause(){this.isPaused||(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}stop(){var t,e;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),(e=this.domAudio)===null||e===void 0||e.pause(),this.rctClient&&(this.rctClient.pause(),this.rctClient.currentTime=0),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}destroy(){var t,e,n,r,o,s,a,l,h;(t=this.howl)===null||t===void 0||t.stop(this.staticEventId),(e=this.howl)===null||e===void 0||e.unload(),(n=this.rctClient)===null||n===void 0||n.pause(),(r=this.rctClient)===null||r===void 0||r.destroy(),(o=this.rctClient)===null||o===void 0||o.removeAllListeners("load"),(s=this.rctClient)===null||s===void 0||s.removeAllListeners("play"),(a=this.rctClient)===null||a===void 0||a.removeAllListeners("pause"),(l=this.rctClient)===null||l===void 0||l.removeAllListeners("resumeAllAudioInterruptByAudioSessionChanged"),(h=this.pcmSource)===null||h===void 0||h.disconnect(),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}get currentTime(){return this.rctClient?this.rctClient.currentTime:this.howl?this.howl.seek(this.staticEventId):this.domAudio?this.domAudio.currentTime:-1}set currentTime(t){this.rctClient?this.rctClient.currentTime=t:this.howl?this.howl.seek(t,this.staticEventId):this.domAudio&&(this.isDomAudioPlayed?this.domAudio.currentTime=t:this.domAudioRemainSeek.push(t))}get duration(){return this.rctClient?this.rctClient.duration:this.howl?this.howl.duration(this.staticEventId):this.domAudio?this.domAudio.duration:0}get isPaused(){return this.rctClient?this.rctClient.isPaused:this.howl?!this.howl.playing(this.staticEventId):!!this.domAudio&&this.domAudio.paused}volume(t){this.rctClient?this.rctClient.volume(t):this.howl?this.howl.volume(t):this.domAudio&&(this.domAudio.volume=t)}}var ig=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Vw extends fi.a{get videoElement(){return this.videoResource.source}get currentTime(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.currentTime)!==null&&e!==void 0?e:0}set currentTime(t){this.videoElement&&(this.videoElement.currentTime=t),this.rtcAudio&&(this.rtcAudio.currentTime=t)}get paused(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.paused)===null||e===void 0||e}get duration(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.duration)!==null&&e!==void 0?e:0}get clippedDuration(){return this.controller.clippedDuration}constructor(t){var e,n,r,o,s,a,l;super(),this.type="video",this.sprite=new ci,this.rtcAudio=null,this.isPlaying=!1,this.isGlobalPause=!1,this.fullscreen=!1,this.url="",this.isLoaded=!1,this.onVideoResourceLoaded=()=>{this.isLoaded=!0},this.onVideoStalled=()=>{this.ctx.logger.warn(this.url+", Failed to fetch data, but trying.",this.ctx.taskId)},this.updateVolume=C=>{var G;(G=this.rtcAudio)===null||G===void 0||G.volume(C),this.videoElement&&(this.videoElement.volume=C)},this.syncFullscreenVideoState=C=>{const{targetId:G,state:K,slideIndex:it}=C;it===this.ctx.slideIndex&&G===this.id&&(K?(this.requestFullscreen(),this.ctx.latestChangeFullscreenTargetId=G):this.requestCancelFullscreen())},this.id=t.id,this.start=(e=t.video.cut)===null||e===void 0?void 0:e.start,this.end=(n=t.video.cut)===null||n===void 0?void 0:n.end,this.fullscreen=(r=t.video.fullscreen)!==null&&r!==void 0&&r,this.container=t.container,this.ctx=t.ctx,this.ctx.medias[this.id]=this;const h=t.video.src;this.videoResource=new ue.w(h,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0}),(o=this.videoElement)===null||o===void 0||o.addEventListener("stalled",this.onVideoStalled),(s=this.videoElement)===null||s===void 0||s.addEventListener("loadedmetadata",this.onVideoResourceLoaded),this.url=t.video.src;let u=t.video.src.replace(/4$/,"3");this.ctx.loaderDelegate&&(u=this.ctx.loaderDelegate.redirectMedia(u),this.ctx.logger.info(`redirect media url from ${t.video.src.replace(/4$/,"3")} to ${u} by delegate.`,t.ctx.taskId)),this.rtcAudio=new Sc(u,t.ctx.runningAudio,{start:(a=t.video.cut)===null||a===void 0?void 0:a.start,end:(l=t.video.cut)===null||l===void 0?void 0:l.end},{enableWebAudio:t.ctx.enableWebAudio}),this.rtcAudio.on("timeupdate",C=>{if(this.videoElement){const G=this.videoElement.currentTime;Math.abs(G-C)>.5&&(this.videoElement.currentTime=C)}}),this.rtcAudio.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{var C;(C=this.videoElement)===null||C===void 0||C.pause(),setTimeout(()=>{var G,K;((G=this.rtcAudio)===null||G===void 0?void 0:G.isPaused)||(K=this.videoElement)===null||K===void 0||K.play()},200)});const{video:p,width:_,height:x,target:w}=t;this.controller=new Ya({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,width:_,height:x,target:w,media:this,info:p,canvasElement:t.canvasElement}),this.controller.addPlayCallBack(()=>{this.sprite.width=_,this.sprite.height=x,this.ctx.clock.setTimeout(()=>{this.sprite.visible=!0},50)});const A=new ue.c(null,{height:x,width:_});A.resource=this.videoResource,this.videoResource.bind(A),this.sprite=new ci,this.sprite.visible=!1,this.sprite.texture=new ue.t(A),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",C=>{C.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",C=>{C.stopPropagation(),this.controller.hide()}),["durationchange","timeupdate","pause","play"].forEach(C=>{var G;(G=this.videoElement)===null||G===void 0||G.addEventListener(C,()=>{C==="timeupdate"&&this.isPlaying,this.emit(C)})}),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume),this.ctx.globalEventHub.on("syncFullscreenVideoState",this.syncFullscreenVideoState)}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return ig(this,void 0,void 0,function*(){this.isPlaying=!0,this.updateVolume(this.ctx.volumeAdjuster.volume),yield this.load(),yield this.ctx.clock.waitUntil(()=>{const e=this.videoElement;return!!(e&&e.videoWidth>0)},3e3);const t=this.videoElement;t&&t.videoWidth<=0||(this.videoElement&&(this.videoElement.volume=0,this.videoElement.muted=!0),this.rtcAudio?(this.rtcAudio.on("play",()=>{var e;(e=this.videoElement)===null||e===void 0||e.play(),this.fullscreen&&this.controller.fullscreenPlay()}),this.rtcAudio.play()):this.videoElement&&(this.videoElement.addEventListener("playing",()=>{this.fullscreen&&this.controller.fullscreenPlay()}),this.videoElement.play()))})}load(){return this.videoResource.load()}pause(){var t;this.isPlaying=!1,this.ctx.logger.warn(this.url+", pause video manual.",this.ctx.taskId),this.ctx.logger.warn(this.url+", pause rtc audio manual.",this.ctx.taskId),this.rtcAudio&&(this.rtcAudio.once("pause",()=>{var e;(e=this.videoElement)===null||e===void 0||e.pause()}),this.rtcAudio.pause()),(t=this.videoElement)===null||t===void 0||t.pause()}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.controller.jumpToTime(t)}stop(){var t;(t=this.rtcAudio)===null||t===void 0||t.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(We.mediaStop,{id:this.id})}requestFullscreen(){return ig(this,void 0,void 0,function*(){yield sh(()=>this.isLoaded,5e3);const t=new ue.t(this.sprite.texture.baseTexture);this.ctx.globalEventHub.emit("requestFullscreen",{texture:t,index:this.ctx.slideIndex,targetId:this.id})})}requestCancelFullscreen(){this.ctx.globalEventHub.emit("requestCancelFullscreen",{targetId:this.id,index:this.ctx.slideIndex})}destroy(){var t,e,n,r;this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.ctx.globalEventHub.removeListener("syncFullscreenVideoState",this.syncFullscreenVideoState),(t=this.videoElement)===null||t===void 0||t.removeEventListener("stalled",this.onVideoStalled),(e=this.videoElement)===null||e===void 0||e.removeEventListener("loadedmetadata",this.onVideoResourceLoaded),this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(n=this.videoResource)===null||n===void 0||n.destroy(),(r=this.rtcAudio)===null||r===void 0||r.destroy(),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this)}fadeIn(t,e){var n;(n=this.rtcAudio)===null||n===void 0||n.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){var n;(n=this.rtcAudio)===null||n===void 0||n.fade(this.ctx.volumeAdjuster.volume,t,e)}}var Ww=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Xw extends fi.a{constructor(t){var e,n;super(),this.type="audio",this.isPlaying=!1,this.isGlobalPause=!1,this.updateVolume=l=>{this.audioPlayer.volume(l)},this.id=t.id;const r=t.audio.src;this.audioPlayer=new Sc(r,t.ctx.runningAudio,{start:(e=t.audio.cut)===null||e===void 0?void 0:e.start,end:(n=t.audio.cut)===null||n===void 0?void 0:n.end},{enableWebAudio:t.ctx.enableWebAudio}),t.audio.cut&&(this.start=t.audio.cut.start,this.end=t.audio.cut.end),this.ctx=t.ctx,this.ctx.medias[this.id]=this;const{width:o,height:s,target:a}=t;this.controller=new Ya({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,height:s,width:o,target:a,media:this,info:t.audio,canvasElement:t.canvasElement}),this.audioPlayer.on("load",()=>this.emit("durationchange")),this.audioPlayer.on("timeupdate",()=>this.emit("timeupdate")),this.audioPlayer.on("pause",()=>this.emit("pause")),this.audioPlayer.on("play",()=>this.emit("play")),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume)}get currentTime(){return this.audioPlayer.currentTime}set currentTime(t){this.audioPlayer.currentTime=t}get clippedDuration(){return this.controller.clippedDuration}get paused(){return this.audioPlayer.isPaused}get isPaused(){return this.audioPlayer.isPaused}get duration(){return this.audioPlayer.duration}load(){return Promise.resolve()}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return Ww(this,void 0,void 0,function*(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent play event with paused state",this.ctx.taskId):(this.updateVolume(this.ctx.volumeAdjuster.volume),this.isPlaying=!0,this.audioPlayer.play())})}pause(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent pause event with paused state",this.ctx.taskId):(this.isPlaying=!1,this.audioPlayer.pause())}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent seek event with paused state",this.ctx.taskId):this.controller.jumpToTime(t)}stop(){this.audioPlayer.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(We.mediaStop,{id:this.id})}requestFullscreen(){}requestCancelFullscreen(){}destroy(){this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this),this.audioPlayer.destroy()}fadeIn(t,e){this.audioPlayer.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){this.audioPlayer.fade(this.ctx.volumeAdjuster.volume,t,e)}}var rg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Yw extends ng{constructor(t,e,n){var r,o;super(Object.assign(Object.assign({},t),{type:"Shape",useBgFill:!1,textRotateWithShape:!0,isPicture:!0}),e,n),this.isInteractiveOutside=!1,this.maxLimitLoop=0,this.cmd=new UT(this),this.onSlideRenderPlayGif=(s,a)=>{var l;const{displayObject:h}=this.picFill;h&&h instanceof ih&&this.ctx.slideIndex===s&&((l=this.effectObject)===null||l===void 0||l.setFrameCount(h.totalFrames),a?h.gotoAndPlay(0):this.maxLimitLoop>0?h.gotoAndStop(h.totalFrames-1):h.gotoAndPlay(0),h.onFrameChange=u=>{if(this.effectObject)if(this.effectObject.hasFrame(u))this.effectObject.updateFrame(u);else{const p=this.getEffectTexture();p&&(this.effectObject.createFrame(u,p.texture),this.effectObject.setFrameOffset(p.offsetX,p.offsetY))}})},this.media=t==null?void 0:t.media,this.container.name=t.id+"_container_[Picture]",this.renderContainer.name=t.id+"_render_container_[Picture]",this.picFill=new mo(this.ctx,t.picFill,t.width,t.height,{useFilter:!0,useSlideBackgroundFill:!1}),((r=t.picFill)===null||r===void 0?void 0:r.fillType)==="gifFill"&&(this.maxLimitLoop=(o=t.picFill.loop)!==null&&o!==void 0?o:0),this.style.on("visibilityChange",(s,a)=>{this.mediaPlayer&&s&&!a&&this.mediaPlayer.stop()})}applyCommand(t,e){var n,r,o,s;if(e==="call")if(/playFrom\(([0-9.]+)\)/.test(t)){const a=t.match(/playFrom\(([0-9.]+)\)/),l=Number(a[1]||"0");(n=this.mediaPlayer)===null||n===void 0||n.controller.playMediaFromCtrl(!0),Math.abs(l)>.1&&((r=this.mediaPlayer)===null||r===void 0||r.controller.jumpToTime(l))}else t==="custom-pause"?(o=this.mediaPlayer)===null||o===void 0||o.controller.pauseMediaFromCtrl(!0):t==="togglePause"?this.mediaPlayer&&(this.mediaPlayer.isPlaying?this.mediaPlayer.controller.pauseMediaFromCtrl(!0):this.mediaPlayer.controller.playMediaFromCtrl(!0)):t==="stop"&&((s=this.mediaPlayer)===null||s===void 0||s.stop())}applyEffectCacheAsBitMap(t){var e,n,r;((e=this.json.fillStyle)===null||e===void 0?void 0:e.fillType)==="gifFill"||this.media&&this.media.type==="video"||((n=this.json.picFill)===null||n===void 0?void 0:n.fillType)==="gifFill"||(r=this.effectObject)===null||r===void 0||r.container.children.forEach(o=>{o.name!=="effect-sprite"&&(o.cacheAsBitmap=t)})}renderPic(){var t,e,n,r,o,s;return rg(this,void 0,void 0,function*(){const{displayObject:a}=this.picFill;if(a){a.name=this.json.id+"_pic_fill_[Picture]";const l=(t=this.backgroundGraphics)===null||t===void 0?void 0:t.getPictureMask();if(((e=this.backgroundGraphics)===null||e===void 0?void 0:e.isNeedMask(a.width,a.height))&&l&&(a.mask=l,this.effectContainer.addChild(l)),a.width=this.designWidth,a.height=this.designHeight,a instanceof ih&&this.ctx.slideScopeEventHub.on("slide-render",this.onSlideRenderPlayGif),this.effectContainer.addChild(a),this.media){let h=this.media.src;const[u,p]=h.split("dynamicConvert");if(p&&(h=`${this.ctx.prefix}${p}`),this.media.type==="audio"&&/mp4$/.test(h)&&(h=h.replace(/mp4$/,"mp3")),this.ctx.urlInterrupter){const _=Date.now();h=yield this.ctx.urlInterrupter(h),this.ctx.logger.info("redirect media url by interrupter. time: "+(Date.now()-_),this.ctx.taskId)}this.ctx.loaderDelegate&&(h=this.ctx.loaderDelegate.redirectMedia(h),this.ctx.logger.info(`redirect media url to ${h} by delegate.`,this.ctx.taskId)),this.media.src=h}if(((n=this.media)===null||n===void 0?void 0:n.type)==="video"&&this.media.src){if(this.mediaPlayer=new Vw({id:this.json.id+"-video",shapeId:this.json.id,ctx:this.ctx,video:this.media,height:this.designHeight,width:this.designWidth,target:a,container:this.effectContainer,canvasElement:this.ctx.view}),((r=this.mediaPlayer)===null||r===void 0?void 0:r.sprite)&&l){const h=(o=this.backgroundGraphics)===null||o===void 0?void 0:o.getClonedDisplayObject();h&&(this.mediaPlayer.sprite.mask=h,this.container.addChild(h))}}else((s=this.media)===null||s===void 0?void 0:s.type)==="audio"&&this.media.src&&(this.mediaPlayer=new Xw({id:this.json.id+"-audio",shapeId:this.json.id,ctx:this.ctx,audio:this.media,height:this.designHeight,width:this.designWidth,target:a,canvasElement:this.ctx.view,fade:this.media.fade}));this.mediaPlayer&&(this.isInteractiveOutside=!!this.container.interactive,this.container.interactive=!0,fs.isDesktop()?(this.container.on("mouseover",()=>{this.mediaPlayer.showController()}),this.container.on("mouseout",()=>{this.mediaPlayer.hideController()},!1)):this.container.on("pointerdown",()=>{this.mediaPlayer.showController()}))}})}preRender(t){super.preRender(t)}subClassRender(){return rg(this,void 0,void 0,function*(){yield this.renderPic()})}clearOnSlideChange(){super.clearOnSlideChange(),this.mediaPlayer&&(this.container.interactive=!1,this.mediaPlayer.stop(),this.mediaPlayer.hideController())}initOnReuse(){super.initOnReuse(),this.mediaPlayer&&(this.container.interactive=!0)}destroy(){this.mediaPlayer&&(this.picFill.displayObject&&!this.isInteractiveOutside&&(this.container.interactive=!1),this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picFill.destroy(),this.ctx.slideScopeEventHub.removeListener("slide-render",this.onSlideRenderPlayGif),this.style.removeAllListeners()}}var yh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Ec extends mc{constructor(t,e,n,r){super(t,e,n),this.children=[],this.cacheSprite=new ci,this.cacheContainer=new Cn.b,this.json=t,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle),this.container.name=t.id+"_container_[Container]",this.cacheContainer.name=t.id+"_cache_container_[Container]",this.ctx.timingTargets.addTarget(t.id,this),this.updateTransform(this.json),this.fillObject=new mo(this.ctx,t.fillStyle,t.width,t.height,{useFilter:!1,useSlideBackgroundFill:!1}),this.createChildren(r)}createChildren(t){var e,n,r,o;const s={x:(n=(e=this.json.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:(o=(r=this.json.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0};for(let a=0,l=this.json.children.length;a<l;a++)t.addSubMTask(()=>yh(this,void 0,void 0,function*(){var h,u,p,_;let x=this.json.children[a],w=null;if(!(!this.ctx.featureList||!this.ctx.featureList.smartArt)&&((x==null?void 0:x.type)==="Shape"||(x==null?void 0:x.type)==="Picture")&&this.ctx.smartArtShapeList){const{id:C}=x,G=this.ctx.smartArtShapeList.find(K=>K.id===C);G&&(x=G)}const A={parentGlobalPos:s,groupFillStyle:(h=this.json.fillStyle)!==null&&h!==void 0?h:{fillType:"noFill"},groupSize:{w:this.json.width,h:this.json.height},groupRotation:((u=this.json.rotation)!==null&&u!==void 0?u:0)+((_=(p=this.option)===null||p===void 0?void 0:p.groupRotation)!==null&&_!==void 0?_:0)};(x==null?void 0:x.type)==="Shape"?w=new ng(x,this.ctx,A):(x==null?void 0:x.type)==="Picture"?w=new Yw(x,this.ctx,A):(x==null?void 0:x.type)==="Container"&&(w=new Ec(x,this.ctx,A,t)),w&&this.children.push(w)}),"@ContainerImpl[child.init]")}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(t){for(const e of this.children)t.addSubMTask(()=>yh(this,void 0,void 0,function*(){e.preRender(t)}),"@ContainerImpl[child.preRender]")}getBgElement(){return null}getIterateEntry(t,e,n){return e===0?this:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getTextElement(){return null}render(t){for(const e of this.children)e.render(t),t.addSubMTask(()=>yh(this,void 0,void 0,function*(){this.cacheContainer.addChild(e.renderContainer)}),"@ContainerImpl[child.render]");t.addSubMTask(()=>yh(this,void 0,void 0,function*(){this.container.addChild(this.cacheContainer)}),"@ContainerImpl[child.append]")}applyEffectCacheAsBitMap(t){this.children.forEach(e=>e.applyEffectCacheAsBitMap(t))}clearOnSlideChange(){this.children.forEach(t=>t.clearOnSlideChange())}initOnReuse(){this.children.forEach(t=>t.initOnReuse())}isChildrenInteractive(){for(const t of this.json.children)if((t==null?void 0:t.type)==="Container"||(t==null?void 0:t.type)==="Stage"||(t==null?void 0:t.hlinkHover)||(t==null?void 0:t.hlinkClick))return!0;return!1}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(t=>t.destroy()),this.container.destroy({children:!0,texture:!0,baseTexture:!0}),this.cacheContainer.destroy({children:!0,texture:!0,baseTexture:!0})}}class qa extends fi.a{constructor(t,e,n,r){super(),this.cond={},this.timeoutIds=[],this.condHandle=(o,s={})=>{if(o)if(o.delay&&o.delay>0){const a=this.ctx.clock.setTimeout(()=>{o.event&&(this.cond[o.event]=!0,this.detectTrigger(s))},o.delay);this.timeoutIds.push(a)}else this.cond[o.event]=!0,this.detectTrigger(s);else this.detectTrigger(s)},this.id=t,this.ctx=r,this.eventHubs=n,e.forEach(o=>{this.addCond(o)})}setTriggerParams(t){this.triggerParams=t}addCond(t){const e=(...n)=>{this.condHandle(t,n)};t.event&&(/^shape/.test(t.event)||/^time/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.global.addListener(t.event,e)):/^runtime/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):/^self/.test(t.event)?t.delay&&t.delay>0&&(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):this.cond[t.event]=!1)}isTrigger(){return Object.keys(this.cond).every(t=>!!this.cond[t])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(t=>t!=="self").every(t=>!!this.cond[t])}detectTrigger(t){if(Object.keys(this.cond).every(e=>!!this.cond[e])){Object.keys(this.cond).forEach(n=>{this.cond[n]=!1});const e=this.triggerParams;this.triggerParams=void 0,this.emit("active",e,t)}}reset(){Object.keys(this.cond).forEach(t=>{this.cond[t]=!1}),this.timeoutIds.forEach(t=>this.ctx.clock.clearTimeout(t))}}class qw extends fi.a{constructor(t){super(),this.isTimeNodeEndSync=!1,this.interactiveListeners=[],this.runtimeNodeEventHub=new fi.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=(_=!1)=>{var x,w,A,C,G,K;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(x=this.commonTimeNode.children[this.currentSeqIndex])===null||x===void 0||x.commonTimeNode.seekToStart(),(w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((A=this.commonTimeNode.children[this.currentSeqIndex])===null||A===void 0||A.commonTimeNode.seekToStart(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(G=this.commonTimeNode.children[this.currentSeqIndex])===null||G===void 0||G.commonTimeNode.seekToStart(),(K=this.commonTimeNode.children[this.currentSeqIndex])===null||K===void 0||K.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide",_)},this.handleNext=(_,x)=>{var w,A,C,G;if(this.isTimeNodeEndSync&&(this.isTimeNodeEndSync=!1,this.currentSeqState="idle",this.currentSeqIndex=0),!this.hasNext()&&this.isMainSeq&&x)this.globalEventHub.emit("c:next slide",_);else{if(this.isInteractiveSeq){this.globalEventHub.emit("shape slide onNext"+(this.json.ctn.id||""));const K={result:null};this.findChildInfiniteRepeat(this.commonTimeNode,K),this.commonTimeNode.children.length===1&&K.result&&(K.result.json.subTnLst||[]).length>0&&this.currentSeqIndex===0&&this.currentSeqState==="running"&&this.commonTimeNode.allChildrenEndHandle()}this.currentSeqState==="idle"?(w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((A=this.commonTimeNode.children[this.currentSeqIndex])===null||A===void 0||A.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(G=this.commonTimeNode.children[this.currentSeqIndex])===null||G===void 0||G.commonTimeNode.startTimeNodeForce())}};const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p}=t;this.isMainSeq=e.ctn.nodeType==="mainSeq",this.isInteractiveSeq=e.ctn.nodeType==="interactiveSeq",this.id=e.ctn.id,this.isIterate=r,this.json=e,this.ctx=a,this.globalEventHub=l,this.commonTimeNode=new ta({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p||this.isInteractiveSeq,fromSeqId:this.isInteractiveSeq?this.json.ctn.id:""}),this.bindShapeEvent(),this.nextConds=new qa("mainSeq",e.nextCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new qa("mainSeq",e.preCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",_=>{const x=this.commonTimeNode.children.findIndex(w=>w.commonTimeNode.uuid===_.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(We.mainSeqStepStart,x)}),this.commonTimeNode.on("childTimeNodeEnd",_=>{const x=this.commonTimeNode.children.findIndex(w=>w.commonTimeNode.uuid===_.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="end",this.autoPlay&&this.ctx.clock.setTimeout(()=>{this.handleNext(!1,!0)}),this.isMainSeq&&this.ctx.eventHub.emit(We.mainSeqStepEnd,x)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.isTimeNodeEndSync=!0,this.commonTimeNode.resetForRepeat()}),this.commonTimeNode.on("timeNodeDestroy",()=>{this.interactiveListeners.forEach(([_,x])=>{_&&x&&_.interactiveContainer.removeListener("pointerdown",x)}),this.interactiveListeners=[]}),this.nextConds.on("active",(_,x)=>{Array.isArray(x)?this.handleNext(x[0],x[1]):this.handleNext(x,!0)}),this.prevConds.on("active",(_,x)=>{Array.isArray(x)?this.handlePrev(x[0]):this.handlePrev(x)})}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(t){this._currentSeqIndex=t,this.isMainSeq?this.ctx.eventHub.emit(We.mainSeqStepChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(We.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:t,state:this._currentSeqState}})}get currentSeqState(){return this._currentSeqState}set currentSeqState(t){this._currentSeqState=t,this.isMainSeq?this.ctx.eventHub.emit(We.mainSeqStateChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(We.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:this._currentSeqIndex,state:t}})}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}findChildInfiniteRepeat(t,e){t.isInfiniteRepeat()?e.result=t:t.children.map(n=>n.commonTimeNode).forEach(n=>this.findChildInfiniteRepeat(n,e))}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(t=>{if(/^shape/.test(t.event)){const e=t.event.split(" ")[1];if(e){const n=this.ctx.timingTargets.getTargetById(e);if(n){n.interactiveContainer.interactive=!0,n.interactiveContainer.cursor="pointer";const r=()=>{this.ctx.eventHub.emit(We.userInput);const o=`shape ${e} onClick`,{mode:s}=this.ctx;s!=="interactive"&&s!=="sync"||this.ctx.eventHub.emit(We.interactiveSeqAction,{action:o,seqId:this.json.ctn.id}),s!=="sync"&&s!=="local"||this.globalEventHub.emit(o)};n.interactiveContainer.on("pointerdown",r),this.interactiveListeners.push([n,r])}}}})}setCurrentStep(t,e){const{length:n}=this.commonTimeNode.children;if(t>n)return;this.isInteractiveSeq&&this.commonTimeNode.applyCount===0&&(this.commonTimeNode.applyCount=1);let r=t;if(this.commonTimeNode.seekToStart(),r===-1&&(r=n-1),r!==0||e!=="start"){if(r>=0&&r<n)for(let o=0;o<=r;o++){const s=this.commonTimeNode.children[o];o!==r?s.commonTimeNode.seekToEnd(!1,!0):e==="start"?s.commonTimeNode.seekToStart():e==="end"&&s.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=r,this.currentSeqState=e==="start"?"idle":"end"}}}function jr(i,t,e){const n=t.split(".");n.reduce((r,o,s)=>{if(r)return s!==n.length-1?r[o]:void(r[o]=e);console.warn(`${i} not support ${t}`)},i)}function Ja(i,t){return t?t.split(".").reduce((e,n)=>e?e[n]:(console.warn(`${i} not support ${t}`),null),i):null}class Xo{constructor(t){this.timingTarget=null,this.runtimeNodeEventHub=new fi.a,this.basicOnTimeNodeEnd=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr,w=this.getTargetId(x);this.ctx.conflictTimeNodeManager.removeRunningTimeNode(w,this.modifyAttrKey)}},this.basicOnTimeNodeStart=()=>{this.timingTarget&&this.timingTarget.applyEffectCacheAsBitMap(!1)},this.basicOnTimeLineStart=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr;if(this.activeWhenConflict==="next"){const w=this.getTargetId(x);this.ctx.conflictTimeNodeManager.addRunningTimeNode(w,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:e,isSub:n,json:r,ctx:o,parent:s,eventHub:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.json=r,this.id=r.cBhvr.ctn.id,this.ctx=o,this.globalEventHub=a,this.commonTimeNode=new ta({json:r.cBhvr.ctn,isSub:n,eventHubs:{global:a,runtime:this.runtimeNodeEventHub},ctx:o,parent:s,isIterate:e,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}),this.timingTarget=this.ctx.timingTargets.getTarget(r.cBhvr.target,e,{type:l,index:h,id:u}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.basicOnTimeLineStart),this.commonTimeNode.on("timeNodeEnd",this.basicOnTimeNodeEnd),this.commonTimeNode.on("timeNodeStart",this.basicOnTimeNodeStart)}getTargetId(t){let e=t.id;return t.type==="shape"&&t.txEl&&(e=`${e}-txEl-${t.txEl.range[0]}`),this.commonTimeNode.isIterate&&(e=`${e}-iterate-${this.commonTimeNode.iterateIndex}`),e}}class Ac extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Ja(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const e=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&jr(this.timingTarget,e,this.startVal)},this.onSeekToEnd=()=>{const e=this.json.cBhvr.attrList[0],n=this.json.cBhvr.to||this.json.to;n&&this.timingTarget&&jr(this.timingTarget,e,n)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timeUpdate",({duration:e,delta:n})=>{if(n/e>=1){const r=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const o=this.json.cBhvr.to||this.json.to;o&&this.timingTarget&&jr(this.timingTarget,r,o)}})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}var xh=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class bh{constructor(t,e){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:n=>n/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:n=>n/180*Math.PI,rand:n=>Math.random()*n,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=e,this.val=t.val.value,this.time=t.time,t.fmla&&(this.fmla=this.parseFmla(t.fmla))}parseFmla(t){let e=t.replace(/#ppt_h/g,`(${this.timingTarget.design_ppt_h})`);return e=e.replace(/#ppt_w/g,`(${this.timingTarget.design_ppt_w})`),e=e.replace(/#ppt_x/g,`(${this.timingTarget.design_ppt_x})`),e=e.replace(/#ppt_y/g,`(${this.timingTarget.design_ppt_y})`),e=e.replace(/ppt_w/g,"vars.ppt_w"),e=e.replace(/ppt_h/g,"vars.ppt_h"),e=e.replace(/ppt_x/g,"vars.ppt_x"),e=e.replace(/ppt_y/g,"vars.ppt_y"),e=e.replace(/ppt_r/g,"vars.ppt_r"),e=e.replace(/#/g,"vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(n=>{const r=new RegExp(`([^a-z])${n}([^a-z])`,"g");e=e.replace(r,(o,s,a)=>`${s}math.${n}${a}`)}),new Function("vars","math","$","return "+e)}}class og extends bh{constructor(t,e,n){super(t,e),this.value=t.val.value,n&&(this.fmla=this.parseFmla(n))}resolveValue(){return this.value}interpolationFrom(t,e,n){const r=t.resolveValue(n),o=r+(this.resolveValue()-r)*e;return t.fmla?t.fmla(n,this.math,o):o}}xh([oh()],og.prototype,"interpolationFrom",null);class Th extends bh{constructor(t,e){var n;super(t,e),this.value=(n=t.val)===null||n===void 0?void 0:n.value}interpolationFrom(t,e,n){let r=t.resolveValue(n);return e>this.time&&["hidden","visible"].indexOf(r)<0&&(r=this.resolveValue()),r}resolveValue(){return this.value||""}}xh([oh()],Th.prototype,"interpolationFrom",null);class Qs extends bh{constructor(t,e){super(t,e),this.fn=this.parseFmla(this.val)}resolveValue(t){return this.fn(t,this.math,1)}interpolationFrom(t,e,n){var r,o;this.fromValue=(r=this.fromValue)!==null&&r!==void 0?r:t.resolveValue(n),this.toValue=(o=this.toValue)!==null&&o!==void 0?o:this.resolveValue(n);const s=this.fromValue+(this.toValue-this.fromValue)*e;return t.fmla?t.fmla(n,this.math,s):s}}xh([oh()],Qs.prototype,"interpolationFrom",null);class sg extends bh{constructor(t,e){super(t,e),this.value=t.val.value}interpolationFrom(t,e){return za(t.resolveValue(),this.value,e)}resolveValue(){return this.value}}xh([oh()],sg.prototype,"interpolationFrom",null);class Jw extends Xo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0,ppt_r:0},this.keyFrames=[],this.isColorAnim=!1,this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Ja(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var e,n,r,o;!((e=this.timingTarget)===null||e===void 0)&&e.ppt_h&&(this.vars.ppt_h=this.timingTarget.ppt_h),!((n=this.timingTarget)===null||n===void 0)&&n.ppt_w&&(this.vars.ppt_w=this.timingTarget.ppt_w),!((r=this.timingTarget)===null||r===void 0)&&r.ppt_x&&(this.vars.ppt_x=this.timingTarget.ppt_x),!((o=this.timingTarget)===null||o===void 0)&&o.ppt_y&&(this.vars.ppt_y=this.timingTarget.ppt_y),this.isColorAnim},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e,o=this.keyFrames.findIndex(_=>r<=_[0]),{attrList:s}=this.json.cBhvr;if(o<0){const _=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&s&&s[0]&&jr(this.timingTarget,s[0],_[1].resolveValue(this.vars)))}const a=o-1,l=this.keyFrames[o],h=this.keyFrames[a]||l,u=l[0]-h[0]==0?1:(r-h[0])/(l[0]-h[0]),p=l[1].interpolationFrom(h[1],u,this.vars);this.timingTarget&&s&&s[0]&&jr(this.timingTarget,s[0],p)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&jr(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&jr(this.timingTarget,this.json.cBhvr.attrList[0],this.createVal)},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.createVal=Ja(this.timingTarget,this.json.cBhvr.attrList[0])}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var t;const{valueType:e}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const r={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(e==="num"&&this.timingTarget){const o=new Qs(r,this.timingTarget);this.keyFrames.push([r.time,o])}else if(e==="str"&&this.timingTarget){const o=new Th(r,this.timingTarget);this.keyFrames.push([r.time,o])}}const n={time:1,val:{type:"string",value:this.json.to},fmla:""};if(e==="num"&&this.timingTarget){const r=new Qs(n,this.timingTarget);this.keyFrames.push([n.time,r])}else if(e==="str"&&this.timingTarget){const r=new Th(n,this.timingTarget);this.keyFrames.push([n.time,r])}}else if(this.json.by){const n={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(e==="num"&&this.timingTarget){const o=new Qs(n,this.timingTarget);this.keyFrames.push([n.time,o])}const r={time:1,val:{type:"string",value:(((t=n.val)===null||t===void 0?void 0:t.value)||"")+"+"+this.json.by},fmla:""};if(e==="num"&&this.timingTarget){const o=new Qs(r,this.timingTarget);this.keyFrames.push([r.time,o])}}}if(this.json.tavLst.length>0){for(const n of this.json.tavLst)if(n.val&&this.timingTarget){let r=null;n.val.type==="string"?e==="num"?r=new Qs(n,this.timingTarget):e==="str"&&(r=new Th(n,this.timingTarget)):n.val.type==="number"?r=new og(n,this.timingTarget):n.val.type==="color"?(this.isColorAnim=!0,r=new sg(n,this.timingTarget)):n.val.type==="boolean"&&console.warn("not implements"),r&&this.keyFrames.push([n.time,r])}}}}class pr extends ue.k{constructor(t,e,n){super(t,e,n)}set percent(t){this.uniforms.percent=t}set transition(t){this.uniforms.transition=t}}var Zw=v(121),Kw=v.n(Zw),$w=v(122),Qw=v.n($w),tS=v(123),eS=v.n(tS),nS=v(124),iS=v.n(nS),rS=v(10),Lr=v.n(rS),oS=v(125),sS=v.n(oS),aS=v(126),lS=v.n(aS);const ag="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5QTFRFAAAATwAAOQAAZgAAKwAAPAAAPQAA7AAA/wAA/QAAugAA5QAAsQAAwQAAsAAAfwAAawAASQAAZAAAOAAAJwAALAAALQAAqQAAiwAAmgAA5AAA7QAAtQAAhQAALwAAfAAAXwAAYQAAigAAuQAAfgAAswAAcgAArQAAqgAAZwAAaQAAMgAAGAAAiAAAjwAA1gAA6QAA+wAA7wAA2AAAbQAA2gAA3QAAuwAA3wAA2QAAxQAA0QAAzwAA0gAAXQAAYAAADAAADwAAGQAALgAAjgAAcAAAzQAAwgAA+gAA3AAAGwAAoAAAowAAcQAAVwAA1QAAIQAAWQAA5wAAsgAAuAAASwAAbwAARwAAMAAAnAAAUQAAaAAA9wAA4gAAPwAAbAAAOwAAlwAA0wAAjQAAvAAAwwAAkwAAQQAAvgAAnwAAvQAA0AAA2wAAwAAAWwAATQAACwAABwAAQgAAtgAAgwAAvwAAgQAAlgAAEAAAxgAAtwAAmAAARgAAjAAAdwAAqwAArwAAywAAYgAACAAAmwAAHwAApQAA8QAAdAAAbgAAFgAAgAAAogAAewAAXgAA6AAA9gAA/AAAzgAA3gAAkgAAngAAdQAARAAAmQAATgAAUgAAJQAAIgAAqAAARQAAPgAAxwAACQAAAgAAMQAAiQAAhwAA4AAAUAAABQAAeQAAygAA9AAAFQAAVQAAyAAANQAA4wAAKAAAWAAAZQAApwAA4QAAyQAAXAAAkQAArAAAdgAApgAAHgAA8gAA/gAA6gAA8wAAFwAAHQAAhgAArgAAnQAANAAASAAA7gAAlQAAJgAA+AAA8AAANwAAJAAAHAAANgAAkAAAKQAAoQAAzAAABgAAFAAATAAAeAAAAQAADgAAggAA6wAAEQAAfQAAVAAA9QAAIAAADQAAEgAAVgAA5gAAQAAABAAA1wAA+QAAUHExBAAAJDlJREFUeJwlevk/lPv7/2XtOrKNsWcbzGCMJSmSpSxJZtQkjPEOg5mxRWns+xpZyr5ECGmcLIOsdVK2oyJbcVI0J8fp/Bff2+d7/+BhPO6Z1+u+ruf1XF4GAEAGZOXkFRQBTiD+dgKVTiqrqKqpq5M0ZMmaWtoAOrp6+qcMDMFIzdiEYmpmbqJBpVlYWtFJitYMG1sbFTskLvvTDmcQHM+ec3ImXp13uYCubvB/l7sHkC9eAk8jcy9Eb5/LvldQzQ+v+jsw1ZAlfwYDAK5dZ98IvIlBwXRNXVYIJ9TpLJUb9j9LvBVOj4jkRVGj/Y1i8AwiH09eEwhjMU4uXtsiAWLlqInMcLh+28okKRnuhNy945lic0+Uqu7NdErDdB/5DBo7MwuE4J+dw8jIzcsvwEIUFFGEisWQm1ACpcZlxF7vl1c8YMCJyqrqGio+fFRbVw8NjU2uec0isNWhVuq2XMPzmjcRBVHhSWCtXaPR2mZoybHzL0TUfmxPabeR6yg/+6QTY83VQNOkSwkbumsgkgzwtKe8tDdHYM7ts3sW1Q/Pn3PEWaGmYjoje+B3ewx9bM4V0LNfDB5XL3/o5v1hSBi5fzvQkQESOkQOwiiwI++5YBdkDjFIrKEx3cZK4Ti8eAlZpjcnYMSHKG0ygKKVeFSLRpOZNL9p19Ku1Q9enKlp45lZiQGr7hlWS17RKWp03mv8481cQnwBUNTAXwIUeAvsJwCCTnV4FyJC9CrKYDnOT91DpRZSG8Bsn7pAw2Ihd7Hn7R0hynXezjQcvQTyMGgUjV12kiW75XaR7Z9OK9kD0/j6ckfyk/fcPHCkvkz48NG/r3p4FeRpoQa9JA74sJAOcLubirEPqXqTpZ1hNzUN5exoNVbk5RmSOQqcJix5yWvvRZZ9nyay+tqAsb6U76oAwo3wgXvJkK6sCpOYQBTIdT6cg92rSxWh16pdV2c8NnDzfQhveqvND4k6aAB0ssWnHuL2yZQ7AHLzJTgUrreyZeWewhawpw1RMDWYHLP1OcNQgKzwlKVP5JV5crB7cZ+NRJ6AB3wx/x3RsEufEkozLu+g7+zkekfLbFQo8byEubp5ld7Ot2CQKxJ7qguZxF4SB3ozQF2pCEIbcaFxg6eAr0/MbeHb1DCK+vQCA3j4YTcwjNiWyEgcq1dRlfnXsq31K3hhhvNX/CYM0JC+asxk91d+7ahTr6AAaTAn3U2lTBfjIc1pr5VEX94yw8uIZhWQVAHQj66iLErxDLqNmN0wuO9hYf6FN+boQb1FjENYJAiWKrru2ejWzoZX6M9A91p2Sw1TTRT/rdDQsyiOT1f6br4fKm6Fpeb9qocNfvYOLPAuczuA5BTbeVT2O/ghlkYEScGHX0Df3StfyMT4iYHCTEQTLj04iWePVx6aomPYGLc08OXB+drJLqoq42/wXqB5eagtaqR+ZAPsymG8utBxt1rO8zFTPHITA50gCMQ4Gw7tQBZFo0DBsWb5ExlyKoBbvRAO7jdv6U8jMYne4Y+iWXmg53gvbNYsGg+gU3elEnaeXB/ufFUKJiyZdNZemo10NviBxr65KE1k/Rijg8KTan5647eoiJQAYPIL+9fuHPb/VSMucg/bcJHzKt557SPRYF8voq1+2SIWmSgQCZo2ZjhlymMigEZdZQ3MzX6wmmMTECwNWieLpWDlKihSZ2sVVwNX9AmecOXtMHP7C/WwPzvKbZqiJIYFZ7PuZngFJmNi9YatOLLQU77vGbS6PzGdsQVn/Ad7nQyALeZVbm01GA72t5bvR/aWTWVIIEVDwDJanzjqAc8QuFl4Yr9/2WTdPVPmHCtY7ZEZ4mJoDqURsbWcaHwtmIqJWrIXshpck5ilsHlYM34YFFXTG3dGzKrDMBxB8gsDn7G3bW/TDpe51ALDmy5KQW8lUgg4guspE7TN7wCTbFWnf7gBB16vuHtYoXsWo14j1cD9/Z+oyj5GF95jqI9KG0s6YtJ0N0jtISrVAZQcIO251QuKrBIaH7k2hLK/Mw8pyNmCnott3tGm6XjT9DsZUps7H8DCHwjc731hFRtTaF2UQ572Ca4Qp/On0RVdmFD0A219YL4DcFBN/lnfBvNr12E0W2MSZatepyNLVIbbFIg7jaYfoR/4W1VUKqL6zsF4NpNiq4orZEhCEjExd7AQ2j+B6GMOPmekeA7+DsM0IAsIqj31xrtAzvWqBsjmIWC6+uBONItM9R+HA8rGHxptX9JAF/G0L6QEiy3McdFEhp4+YNA0FHNwnW0/RFFEtwHRb/hwQsbzX/heYihsB6nNVJssfHnqQe/acYKMv8LqcRe7aEF7Y6ugtWxKLILeNmlzVF277PqxIg8dSxpo5gsaMBFxfgwvdWBhOvzOHHHzx4JUHLNpyc8LUzkLcfiIv3A2jQxpeQ1iL4IKUJ1dTmigtKLpgi6QjX2d8ISbHl1B8bH0UEbnI2DMVm5h4+6Ko+kTd3VVSVPGkpp4/p+BW7/faCjBhlD7MoDqRpcOJxz6lBe8gWYtBP80qaKf86k0FP9L1ziS+Y1m8MPaWpcD8BXkG2flILIvKvoC/hr8upkS1N2pwbQD5NtZmC6iNb2JUVJTRDoZxTXibAjQDp3w/y5Bhld8zynk7OU1S3S3LPnJLvjhzcfUaKeYeJwtkmPDDbYpWt0gTaf8e/gL32vUwV1i7lHVD65CN0n+CySLiHLZfbSx/XYollUUj09xeL/Cjqg2DUp2eM7igsEZPyXlnve63tfjYjZSbBwtUf7mlAhvX0N/CzxFIKE25lol9uEzuf4B95AK6EAVtXBSn3XGA6bVuISAxQuuFKTClSg4xz/VEivy43BYA1UY4x7aSd/i1RMdwdgzi68x0JEYIfLBbEMag6Kcur0R3WGGtXvT2744+WPE4QaWz1rrbq5fEmwQTMwOLPRNs2jAJiPTPpAjXA48lyGNDo/aEnNyEv39YQtTIKcLY2gVw/SWl2eGCgmvgRKcowIU96xWM6PvyJhk/4dRHbP4A2JaG+uq0xb1J15Gaa++VgngHKhh3L3grVzTsa95kyjw3wgZLYViuASK6smRQA8Ds39GAisCnrN+wiGik1BsIZfpFhk9aVvJNr+pUWJbSmxoOAqRzseBsHsCPJ+9EvFA6HLDuymPuB3VbLuUAeRzs5AnmhdV52drj6JdA/9JE6GEWqDZIrYYlrYCDM7hLcefRsAoFiZc4P3tYx5qFsH9ttFzAL0L/lgSwvjbS4Hlik7xGLuSVfejKzFhvtnHF3039B8VGq1UCpg4+cLt0KMDi46N3M5F9YWHiD/InKc21mDdj2pCGZNgqLihu2j14oFnH9dxycOd1FsVBZ+cMEBkuu0U7wwPJEfc9SWATH9MuG0EvfyJPxuf9enmuy3ipIOtB/Tq8fRSfpzQFs03/H+7yBgpxgsOgaPD69B90NfAH5SMhqmB4xns1ARtQlmao4VcBTRTDeuo6wPwzlIp/AQcGagk6KNOsPIQxV8P+wi/EIUDDVLWFGWvjTzIZnkLRH1UoJhWpXMTjPAjt3UAX17p6WGAJwxrWKi26AC0+gNR2jzhlwfEJrgvQCombOyaY8/bLwB9fMvueMLQvWNkBKGC0lq0Ht3KzP5jCcE4StVpESb3tdp2iHeZtLDMQ26rGa6n0GpULC4tIz4jBBxadsL3wHdFQPwahEAq1xR5rwJkcKwXQrx0f6F7awZw4fPbGa1gUiXJVpYOUgng1Il6/kdwHeGfQlS+PdZEZ/WbBBOmQjvC0LG6wpXRfApSSh5UP+GjCtGd2HwGkHtuvHkJDGvpqBlcXLXap5CKR9eJRzlgZ8W4zK891g7/yQl4SpDRz5B6E6FEUxFv8K/4i/p8Hn1DOZxLx2FQHi3X/cwgM0LCK+TZnTMszAMO3JUIXyO6zOQNiThG4OXOrwJNCE8XwV95JJ175KWLydZwJE882VhaOGyWMiSKcP771g4kaYKUFB2Dmz0JUdUk75Pplh8T7VBZwUY90zTpUDwWxIJNQ4p3+oSPgHVcJUQVskdpHklpVCunu2AMvq7HI2HuekbnizilxbZeVzVwQLUBT133fJUvswkKMu+OHgCDmIJX9+b8TDTiXIyTQUrXPXFm5NsIOF7X6snH0GkbLAqxPlJ9ecWoX5Ywy8Vl/GgAlgE21JAfp4T0F8NwItrDq/BXLuXDsET46eLTOOKK5svMyhZ3Ah1ePwHOvYdijiwWbAEJnbIP5V95SOcbXM43qIJm+5G32UABbhvaNNvRffVynh4jmDDQ3V+XtC1dHWnr5PFwd9Ds2UdVaIEHmECBo9V1OAz0w9Q7ZONc7xXtF+8+ETCmmX+G7+2+flmEDTEww2Dr5eQAbJggPltoLQ9vmismCRLQYIvSsXqDWOIS85DgRSlAhWjGdOxACJXNVdyGoSxA1lu2eETiYQrdn23iL9SxSRCa5LgEX0CruBRSxHIQWrdV/mq5qOUyNgs9QUYv+xsmlhwRichkxSqZko2RwH46USV7CUofNLnT23rewuaB+3Y+8g82zzjibgmdChhbQRFk34o/zPECaRHy7wKj5wlFDE8H30Jva81PwVlVT/UNLeH5C/T9cIDrBy3capubs5y2F7ATbAwpRvThn7BsaBvwbu0BBMDxHEtAsSE3DVOdF+kWWcXsfX3AFYeWSbrZP/TS/H80MGryotBYxj1U8rWXomZeevT+aQ0crFNLeulQLpiCr0J3rB5jTS3MR+wbSYRJirC2/5eEGCMHpzOUFWEplMsWaW0SVaCL8y8rZVI4hiy4qyEC7CW0YwNHTGLxvJ2vW6GNMctZQNF8YFxN+y/di6ENOZNtphmlCkIZsU3uvDqzlidm8vQCrkUfzYk6D4AYr6tk+mccy/i8xBKFQzibM/wWTIysZ6cDt/XhySBb1niUMBJRN+ILdWbj7Z6dnUgLZELPYXWeyXNhzV48NvUbAWzWEC0lD8PwVIGTt6rveS3h3gX3XiVRg1O5poRFvgPCL17nEx324dKJT5AC5OU7RFWXuEp0U1v+MRgY7mxikdoB4lle086YyXrr61aA8eVem+VOaY1TKn/sOxOeRhIcR4AZLNrygau7faIG/T/vTPO010Kbci6K9mAYPE3+D/Q/02VDHhOfPxxTud5MF+8KsrdY8Bw4TELjh26cdDiBfCo2ptEyDRsJrRk1KZcvgta3ckuK5CRPn7AxcptUHMpozoAU68b9ElVYL1uhaVz7RTJwRJ15W+0X8HZs7gUMi9wPAEik099Y6ilYhW7j1KNLmlFXlRwAb+NvU+PbN1AfHY1t+/sN4J1JVfn7FDYLloP1Scsg9GA3s2b6XMPgHYNbve6n3ghsmK0WGyzvNrCU7t0veADh7RGOKA7vXwYQc0uuPZMJMUQMLbBdz+2kFzkStJJNFEvH/f/cT1wnXJfsflkfnn+qJe89nGfU5c6Fpsd3vp8y31fD+eHg8uZSYXdwqcoBT9DS0aTRKoaZrdSqk0KtkFZb4+BBqXAnpKdyVLXBuP5clrK5wxSYyIWrghPCaNnLhJkp/A3x8fsMgMczROQeBhpGULvpU+ZNQqKLZQMr2c5uvEvEMHOemnBn5rN1M88Y+/TkhOxUIBP/2P2jr1+oIelfW2KEQFOnrjfGzrGWUsS6YsjIBTxTDwc64bw+fGhfW5AnvnpxLYAJDBm2lJ6rvaNZZMrsfTANYByHtYSbJahyNwhmaepqjdIPb+zS9jVAgfRHPZEjU1Gd3rhA/5cI2/I7HkyV/yE2rhd7VLRC+6h3nRnBwqHqGw2HNB46i9yPFIYrAbBjbP8Xiw3DuyzbyCf9d4TVDRcSKQussrgoejwBiAjYwZi0qcQK8KuYyotDvMBHuWgDgNhVUXyHsaOlkxmK4H0+NoRd5BhMX9v+E0DX3JzZF4fOt9EZhbDdj5dngkuAUBvofWKvSxgvWN/JXhGtuib/SxfY8KRQCXuP9M9m4RKN/YNl9WjkI76xL/vI3tkUW8UwNyBJ97wf3vZkr8zgZWjt09M51pPhhhhIa5n7iOjQUKxcVfAILZl0T4jc7FxaD1109JL9Ca0sSBbrEuNCQcFBiIv+SZSJPYe/1EYItPw54SrCk2fKxMmvjDJ19ORWT937dR9t2yrEWeJCbBTuaVFvARwhlXYkVrmPmMoeHL//5uHAvRj2Y8axOXO33AUsW/qXsBWn9CxkKIYN1C7xCb9tfTfE+3+m+utf4yM6L/i+ic02U8cQ2F98GKWj7KuD2pLDXkPCLCOzaCvJfwOemmSw+9kphfUY4yI+yj5/MmQxX+dJTNMaPNhkZY4Wbc3tEQKBn08wseAkoa6qqIQUIOD3kPmDGdgoM1ToC4KklkiDUBk4Uk/Fidp8zCJcFBMgHj+etTxbRFeHvwhf80CiSt3z3DIFYl6k1lWLVvRBn0lpMVKj6PITC0tar9jbVAPhHP8k4rhblOqCcOdqrAPy67Z1WL4TfMfVx0GLrHQJyH8iQUus8lkFKuv5kcYrNvW13YfKuZ89ORAmC15BmyKxBFilYKq8dxQRWdqGLLb8Rij6WrIs7/mxVyFptbrarK6uDO1v3yxzOWQjtaz2W/01pTvN/Omyfx8D2VGPK80olW8HfnliYW8J7UjIcIlewB+DJW6whrBEqHlPOAQ8W/xs1Hn5GmuasOM+K9M5T9RYI+PMwnvMsCTG6r+dbVXfMESA2YjneGLq0D1CQv4w2JrzNXBsshiH+QHHQa2Mr/AZ4I3FCYwSF30Bqgti3TOnZKmjAfxUANcv/0JqQQ2HHnOhMOwJodHns6/25Jg743Q1lQ+KbmEPuPq51Bt83snYTH17IxKtNv2roT2epeJDTPX4a0X9SZHNHJqSie0RtRDgKb5JGNRAJr4h2aypQVI68DWseD13hXjPfFQtgcpsWw3+bHWbYNMQ5bN4cjo9d8aBirB8/oJdnePZQoxNeCAZZbotwjOCA0wROeUdcuZjnmA4UdjXjcB5b5xb9AZYmwdFSH2DdhvscW5z5QnIMnYTFRngKajbkSdjvvVyWw6LwIJWxlYhshBPGlg4xDUFZOFLf2UlA4MUe8DA8TIea+IX2smNzuP0vmleE8ArQR+UsNqTqekrljgz0+vhX5+FaB5qs3t9J5cPuwScX+MPS/UkluQXNh5WrJFM9p4CGban0P71P43YKxglb2X+cyKQ94h/diX4v9RaCpnBsnLBEiBNo/0idpiYrznuGrJbXrCBGfcS8UOZNOTvW4hnUTwJkuVcBHodNx3R8t5LtTDmf9/EmsNByWOE4XyHplSzut+ilAlOYAW6FAoMlRP17j9CYvp40MImU7d5GfS2Drx+GW3yciuygcSeJPwW0wzd8Jx7iITtZPchNXC6aPAtKQrB2xa8z53r/+NXr2nhyLPFySAhSY0IYOQBgKT6h3kSWUhtwoeuSh11H23xn6OOue1lRwSZFtnWn9cdSaaEGqWp9dYsa7+ChyZcubQzxJjXzXLk9h89vBXfZGDIlvpsP4QIbmPMjqxhqsBfefv19nkI6ATGqFQsHNSKV1bi5RDhNzYOR3Ckunra8gfjADKT/ll0bAtT+Gyj2d7NLfv1oX/s3Dxbwcs6upK916xmn4Cn9qoUPECeybc02KdxfxGRB0zT8l0Zikliu1neuQQ0TmnzytBG1jCdcA7AUAfwLbEnAjIqNRI/tr3AS3HHzaJJ1AVHLTuHM72nkWqYVDDf+j66wmI+h8Lmvxl4OGEXnX3JOrwBz08R7ELtwHigs810rOj0viiWN/+sC7Ni5oBKQ6bZk8eHN3PYLZzQgVjEb5jNex3lMrEC0EzpQ3faNx4xd523exujDDnuf5ZP5S7v7/UuKqkqW2X94NfxXy7549ho3WWi6n1Vt7ABUIeJc5cdqWkRZrf4aNACabeODzxEINKtnW6CGh5734US98i9pjARiQfrdT+ax6iuaQ68hRSbykUQcJUr4DoFBkm4wgd2hq4tBIt5iGqkmIYjIK97X2Ac+y7Al6Eas2r5VF3EkYVixIGsqzlkm0RXA05xqwaznFZjzk8V80Y+iIDhMyNdfSpEMp3IheR2cbKGSnSfWK1HK5rU73te+Y+mp46Jt6oD3xe3/MKUzoD2UBzNmu3iQW2uCJHd2ne9t/x3h7lnn4kBxCEAK//UgVlyjyz9W5JHgDWu3g3OlGHBZO/680MjgZCrLsuOfLU+5jPl2Pxck02uqzyqmPlhPA0isbdnhRis6Qh/S179zV226tq30IMf1KqJ+bHgSCHhjM64dbIL8GGt21vGOEXP+/AJcER6NjIb286TKSzTCCidNp6Zf3rpsWZnG5dNhuEqU94Fd2sYHaDOgM3A3LO9nxQazFRTOJsT7cD4eScDOsG8UfQGqlmCqM7L0/3ZpnWylRSPqBu/B+eHEfYNZO+0QTaWrYVbLURYIK4TWR8iESRGfHHQWgthnGCFSR6XhpDR2Xtq0uhr2QQvOUVv8Giw6ImYIgOdd8OPo1dxm1hQCQV84zTzso6krY75wTfRjcwV5Geb/tJ4owfFd8kC7FDPX9B9mBYVZ0zuK21vYoVpvazdgKlwKfwFKZSgPgFfDQtTRYNOvy6JNZ7OeYCWEFJq/hygT5KPD9mIbenEBsAvHdzCG/K5iPb4S4aP/YhnMDJHIP/icNM6ztIK9gkRRdA71nyoMef+2jb3neklwx0pHH2SIdKb2jwOWG3JCmYK4Iva+7eEG0a3If9Da4KaFAGMYlTTCfFBFSoyK7YMSwyuICgV8M49c7bf4VqtKi5LOaLKCJlVZ5zBpLrIr9LvsMNctO/oiM3ab/MknNJPPbnirNLPbGflQrRr2aJJYXg/QIsh8k1PXzz+z9w5gIxiXea4P0RlO2OUDqhJdvv8EBpRLy6Z9p8GR+FFKgDHcGsMkkbMnJz0q7hAhDVdF3sCfBM6hj2P4SlE5njIsBmSky6FhkNYd2UfgLt37a35+BEvupCA+Jh5kmC5dWaGeQNmz35EEQvhwZG3qxKo/RZr66hM7IJ5Won7gh78anK172Zt3buKAMKyMDjzdR9ufcCZ0zU4DOA5RKIgkAMTbytB3LQFlT5MH/An6qfRJPjj2dg5WFP3mdlZkwFePrA+3eN2Wu0A+WAFKZrztzJRibcqCweEddxU/PSGWxOnjHtOUDzfDk9lEvDDj39cFH1E9dVeQLGVI3Qgeo0M34dZ6K/3cb9BBZcZf8uS+BivagqBuLW31L60FMADuX1jiTur3n1ZrBrIgpkFO//0OmyT9qWthHcnwzLRswTdDbgUflRNCAvfaODDSX8vQLo7QBDltK42Y/OdFbS1zUYFLv6qSiV43zDiUrcAtbEqoMVBPa37+RMTuT1gmrJVH1qqYsi12cyakNWPLrTGqg9NO1KY2vPwISkCnxobu6FodJWlXUwABhb1LwveepTps6Tt0E8j+tabfLiI+MdLLWSxLqA1cJON1hz8aZkisUWXUMhNOQpLrIR062CCV3Bg0ZwlU9OhbKefT1NjDog/g2q+TAW89zQllayE0d/y9qAdSAucb3iKOXZYzSSmdealQNS1IL3qMUpowYU6uuO7LEqyPD05MgXvXy6frzzrkpBXlAx+J30gur7J4OT/ziwA3fvIcKvLAHet4sqms0BCkZk6CKbyRPu8Xqwsv5KGfYcI4thniGI9nFwFwt1bfZm9racBom20+/R8n0upa1EAueM5b9A7lN3BE9empZqOTj5NkKNeCf630MV2jeKeEP8cImJ5W9l3gYGDg1wPxxZcmBvsZ4qZXUMim6a/M2jKAsHtYvPN1A0FsH3AAbpFvCxA200RpdN9ME2nSQL2g5pg9OIw6KkYT3gKe7QmWrItoXK1c/XBbJQ6pVOca2BzfQfoOCTygsFljpEPDG+tBLrte+jUDP2DcYKLisBjhgtTZnAmgmg8/Aus/awVIZGqScBZ1xa/82qG7rzT0BDLldEs0sP5HS8oNhU3lhDue5NS0TUt0T7YTZvSGH0HEYEs97dJ7xpNO1TKokYmLWenco4PvNEsv2hQ85pcgDjlA29jwVT9IoAcXQGCnhPG8fgYyhJ64NNzBiWf5p1XdoBx+xtXoPiVbK44FcHipEqTaar9/ruKsdneZuJmevOHPOjhmtvwVVX8Nmx+/eftj7gZmxlF3ocI/n5T0byPxzPfMi24AxSQeAGjdI3Q4hc5ffAT7v7F89ZNEgj6fheuHl2hjRQlG4EMMwpiAnsm1HT499a+zKPMejH0uAfnT4JyItDTiDQ4l5DoO/sQZ0HkzGpiM8KQNwaHk0Un9WaO+yuA1ZTV9z8Jm13bqwTlfNHncIi8M/kHQMFhMF7Imo2mUw/Sox7Bh3W6UplqvEiy+g2NvVzFPCtGkHSTLuFSL2CtGzpPY+E5O0PK3HSbUnBzNBZodkNnUAlch2Zk9/9F8JuAYBirgoVpE7QyheJ33WDOysDFYMSXBdm20XfXCWcGzsGyvXE8FJN7EadsGjIDzZ+GtIUEBWuQ6o87kaDvo4eplYs4dz6P06lSSCA0yAvpXKD1djjC8dnWdYtWsLpl4Fplhje74Y6i/M7VMSQnRvD54/CC4LPzx4vghhIOzVo6bLzl7QIHPvVyM/drqBBZ3tW1lYqvXfauRfH5WHe+RcHI+xxeqDECqJ9tdXLyy9L7RqxyUaZKwmlAux+zEzdzITSRlr36YuSm0LBhTpkivodWytR6BNULFxftqF42QqKLmoog9WlYNRb4GtNm93bHuxBvV5VcOUeY6N/9xDutwbqYhaN3rIzpg1M6XfrYctTdA5Msr2v4Aydmb+Nl2/Eqw+jSXYvctmuDHYUAei0pUc6E5N1bULPEjHAr+HI3gwDjpDg0nE2fMkXneCumq9ifZR5IKUOqn0aDIfN64olrhaHfV4msozkdG/3j5HHqsf5Els8kwvDrCaK4/BXb+YzYC00mJEOu8njPsKgB9dG+FjqqeToCsJKLTvHS+iQTnqFquCJ+yCckuDaHLnP4GzroGg7BelrYZWStEFay3j+vkEuXHy3B2zG5xBqSx+/pxoEOv+OfiCfq5QMCCNq26xXC+1DZ+eQdH2jJ9FXSh9yrISZTk56jTzMIzG9+Ye+pumQffxmh2lcvPXjmNWL3PoOgRpkx4o/TZzE2y3IMtEZNxpNUlBqFlnBVXuPS0TIBkF+ZfvW3y2bGWD14zb8Cju5+wiSW1pIIRRtD0DeaxOLIvup5BZ2R2QfQVx6ryHH4H/rls/fRJy6KIdsJ/qVsWrBZaKgKOhP0GOUjA16wS+vlpcmot72SIWJWQDwyiD04TLSU6LyObtnOC2W5QA0OCGXHtlTi9Cyh95AIL8UU6AaQOaDSDfuf3DbxO4065WUdqPZ6Zj9S26jGlhDs/3mX1c4h+to5J2UwvgO3dkFtmKMBF3OuQvskMsOO8R5FnXblT4zMUpkjhs3m1ygag6zQWKfFOQCFM8jmAFtaCpCqDX77xqhE3B99uGU3UT+41SufAp9fQENvgk5lwqneywazIE9IpGT8v23sBPibAHG34mLWiivxnjk8p2S5ofshihnLQd4CU5ABpVcMX/5Hg39Jm55k+hgxugBCGIR5KmY+qz6US5/wKYimBbjTOSBlyD9OiYpWxtoLH6PcoaUdK0dW4vKR121dfMwumvgSBf8g0fsVN0w8jbplh7Df1FVC9wZuTbZStSswGJu6IngHRvBgOFag8F3hwPVNuUYjxNngNURuMvnnOvway+3l+1sK7aILbzdSzAxUCtG9/CaaHsBFIVzMWEH7upNL6Hr6P+oI4i+VqT6NyQrYUMkRXYd2P1ZjEMDaJ1rrurxTBgTfMw9cZe8SHIAz0JA7jpgDmr+InVbg0HrkFNZVhQ2uBKn75tLEZwfMp2azBhkglsAXDPx2BccwTDGmnsjRDh2jHh9ynTQY4vLqcuv/NWRlP8sFHWyxSmm38ikF1UoTywoZL0oFE4I4ujqIcvCuo+0ABPohIMdyq8EqgTcogXcYNCGdgvytDCA/fwt2eG78+OAANOgmKkOI8WdjE3FaFdqW6rx/oOBunJoqMLOwnPtv67Cw7PY8c4jFvek2G/hk1Thivu5Pf2iV8YDA8DyziBPz6MKlF9XQlRt7ZRV09nZrygwo00ME7IpFuOiEsUrd14UcCvNC/DPkbFmqB1uQIg477mFiq2niVADUYnvdjiQPNpFfMTo4yg4X+tDW3rmH2WE9E2rY0ES40wM6QRwaQL5/fepJULkj3Zc6L1ItuWmO6zXbvou399GBCPcQwB2+rRpubsw03qWL2iRyHH9Afl/YHuFYa8v7zEXDEigXJo9RAtTM4BTzElQhSgePv55AmHTo4W9v4SmkPDlLIhOpcXBK4GO2AnyzeN0MaKP7umX9bZAfc5LA84bxj3frYCxezbP9KG7QeJzevIhiAU4p/j+y2OyMV2mxNgAAAABJRU5ErkJggg==";var hS=v(127),uS=v.n(hS),cS=v(128),dS=v.n(cS),pS=v(129),fS=v.n(pS),mS=v(130),gS=v.n(mS),vS=v(131),_S=v.n(vS),yS=v(132),xS=v.n(yS),bS=v(133),TS=v.n(bS),wS=v(134),SS=v.n(wS),ES=v(135),AS=v.n(ES);const lg={wipe:class extends pr{constructor(i){super(Qw.a,Kw.a,{percent:0,direction:1,transition:0});let t=1;i==="up"?t=1:i==="down"?t=2:i==="left"?t=3:i==="right"&&(t=4),this.uniforms.direction=t}},fade:class extends pr{constructor(i){super(void 0,eS.a,{percent:0,transition:1});let t=1;i==="out"?t=-1:i==="in"&&(t=1),this.uniforms.transition=Math.pow(t,t)}},blinds:class extends pr{constructor(i){super(Lr.a,iS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0}},checkerboard:class extends pr{constructor(i){super(Lr.a,sS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="down"?1:0}},dissolve:class extends pr{constructor(i){super(Lr.a,lS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ue.t.from(ag)}},randombar:class extends pr{constructor(i){super(Lr.a,uS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0,this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ue.t.from(ag)}},circle:class extends pr{constructor(i){super(Lr.a,dS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},box:class extends pr{constructor(i){super(Lr.a,fS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},diamond:class extends pr{constructor(i){super(Lr.a,gS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},plus:class extends pr{constructor(i){super(Lr.a,_S.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},barn:class extends pr{constructor(i){super(Lr.a,xS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="inHorizontal"?1:i==="outHorizontal"?2:i==="outVertical"?3:0}},strips:class extends pr{constructor(i){super(Lr.a,TS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="upLeft"?1:i==="downRight"?2:i==="upRight"?3:0}},wedge:class extends pr{constructor(i){super(Lr.a,SS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])})}},wheel:class extends pr{constructor(i){super(Lr.a,AS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=Number(i)||1}}};class MS extends Xo{constructor(t){var e;super(t),this.filterType="",this.isConflict=!1,this.activeWhenConflict="prev",this.removeTimeout=null,this.onTimeUpdate=({duration:o,delta:s})=>{var a;const l=s/o;if(this.filter){this.filter.percent=this.commonTimeNode.applyTimeFilter(l);const h=(a=this.timingTarget)===null||a===void 0?void 0:a.container.getBounds();h&&(this.filter.uniforms.uBoundRect=new Float32Array([h.x,h.y,h.width,h.height]))}l>=1&&this.timingTarget&&(this.removeTimeout=this.ctx.clock.setTimeout(()=>{this.removeFilter(),this.removeTimeout=null},34))},this.onSeekToStart=()=>{this.timingTarget&&this.removeFilter()},this.onSeekToEnd=()=>{this.timingTarget&&this.removeFilter()},this.onDestroy=()=>{this.removeFilter()},this.commonTimeNode.on("timelineStart",()=>{this.removeTimeout&&(this.ctx.clock.clearTimeout(this.removeTimeout),this.removeTimeout=null),this.filter&&this.timingTarget&&(this.timingTarget.container.filters&&this.timingTarget.container.filters.length!==0?this.timingTarget.container.filters.push(this.filter):this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let n=1;t.json.transition==="out"&&(n=-1);const r=(e=t.json.filter)===null||e===void 0?void 0:e.match(/^([a-zA-Z]+)(\((.+)\))?/);if(r){const o=r[1],s=r[3];lg[o]&&(this.filter=new lg[o](s),this.filterType=`${o}-${s}`,this.filter&&(this.filter.transition=n))}}get modifyAttrKey(){return this.filterType}removeFilter(){var t;if(!(!((t=this.timingTarget)===null||t===void 0)&&t.container.filters)||!this.filter)return;const e=this.timingTarget.container.filters.findIndex(n=>n===this.filter);e>=0&&this.timingTarget.container.filters.splice(e,1)}}class CS extends Xo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startPos=null,this.onTimeNodeStart=()=>{var e,n;this.startPos={x:((e=this.timingTarget)===null||e===void 0?void 0:e.ppt_x)||0,y:((n=this.timingTarget)===null||n===void 0?void 0:n.ppt_y)||0}},this.onTimeUpdate=({duration:e,delta:n})=>{var r;const o=n/e,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{this.timingTarget&&this.startPos&&(this.timingTarget.ppt_x=this.startPos.x,this.timingTarget.ppt_y=this.startPos.y)},this.onSeekToEnd=()=>{var e,n,r;const o=(n=(e=this.commonTimeNode.json)===null||e===void 0?void 0:e.spd)!==null&&n!==void 0?n:1,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o>0?1:0);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var t;const e=new ks,n=(t=this.json.path)===null||t===void 0?void 0:t.match(/[MLCmlc][^MLCmlc]+/g);if(n)for(const r of n){const[o,...s]=r.trim().replace(/\s+/g," ").split(" ");if(o==="M"){const[a,l]=s.map(h=>Number(h));e.moveTo(a,l)}else if(o==="L"){const[a,l]=s.map(h=>Number(h));e.lineTo(a,l)}else if(o==="C"){const[a,l,h,u,p,_]=s.map(x=>Number(x));e.bezierCurveTo(a,l,h,u,p,_)}else if(o==="Z")e.closePath();else if(o==="E")console.warn("not implements");else if(o==="c"){const[a,l,h,u,p,_]=s.map(w=>Number(w)),x=e.currentPoint;e.bezierCurveTo(a+x.x,l+x.y,h+x.x,u+x.y,p+x.x,_+x.y)}else if(o==="l"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.lineTo(l+a.x,h+a.y)}else if(o==="m"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.moveTo(l+a.x,h+a.y)}}this.path=e}}class RS extends Xo{constructor(t){var e;super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.onTimelineStart=n=>{n.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:n,delta:r})=>{var o,s,a,l,h;const u=r/n,p={x:1,y:1};if(this.to){const _=(o=this.from)!==null&&o!==void 0?o:{x:(a=(s=this.startVal)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:1,y:(h=(l=this.startVal)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:1};p.x=_.x+(this.to.x-_.x)*u,p.y=_.y+(this.to.y-_.y)*u}else if(this.by){const _={x:this.by.x,y:this.by.y};p.x=1+(_.x-1)*u,p.y=1+(_.y-1)*u}this.timingTarget&&(this.timingTarget.scale=p)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&(this.timingTarget.scale=this.createVal)},this.from=t.json.from,this.to=t.json.to,this.by=t.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),!((e=this.timingTarget)===null||e===void 0)&&e.scale.x&&(this.createVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class IS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isTimelineStart=!1,this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=e=>{if(this.isTimelineStart)return;this.isTimelineStart=!0,e.isReverse||this.updateCurrentValue(),this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to);const n=this.json.cBhvr.attrList[0],[r]=n.split(".");jr(this.timingTarget,r+".on","true")},this.onTimeNodeEnd=()=>{const e=this.json.cBhvr.attrList[0];if(this.json.cBhvr.ctn.fill==="remove"){const[n]=e.split(".");jr(this.timingTarget,n+".on","false")}this.isTimelineStart=!1},this.onSeekToStart=()=>{var e;const n=this.json.cBhvr.attrList[0];if(this.timingTarget){this.onTimeUpdate({duration:1,delta:0});const r=n==="ppt_c.color"||n==="text.color";if(((e=this.timingTarget.fill)===null||e===void 0?void 0:e.designColor.toUpperCase())===this.from.toHexString().toUpperCase()||r){const[o]=n.split(".");jr(this.timingTarget,o+".on","false")}}},this.onTimeNodeStart=()=>{if(this.timingTarget){const e=this.json.cBhvr.attrList[0],n=Ja(this.timingTarget,e);n&&(this.startColorString=n)}},this.onTimeUpdate=({delta:e,duration:n})=>{const r=e/n;if(this.to.interpolationFrom(this.from,r,this.target),this.timingTarget){const o=this.json.cBhvr.attrList[0];jr(this.timingTarget,o,this.target.toHexString())}},this.onSeekToEnd=()=>{this.isTimelineStart||this.onTimelineStart({isReverse:!1,activeCount:0,id:""}),this.onTimeUpdate({duration:1,delta:1})},this.replaceAttrToRelation(),this.json.clrSpc==="rgb"?(this.from=new ch(this.json.from),this.to=new ch(this.json.to),this.by=new ch(this.json.by),this.target=new ch):(this.from=new uh(this.json.from),this.to=new uh(this.json.to),this.by=new uh(this.json.by),this.target=new uh),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart)}replaceAttrToRelation(){const t=this.json.cBhvr.attrList[0];t!=="ppt_c"?t==="style.color"&&(this.json.cBhvr.attrList[0]="text.color"):this.json.cBhvr.attrList[0]="ppt_c.color"}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const t=this.json.cBhvr.attrList[0],e=Ja(this.timingTarget,t);e&&(this.currentColorString=e)}}}class PS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.lastVal=null,this.onTimelineStart=e=>{this.lastVal=null,e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e;let o=0,s=0;if(this.from!==void 0&&this.to!==void 0){o=this.from,s=this.to;const a=o+(s-o)*r;this.timingTarget&&(this.timingTarget.r=a)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const a=this.by*r-this.lastVal;this.lastVal=this.by*r,this.timingTarget&&(this.timingTarget.r+=a)}},this.onTimeNodeCreate=()=>{var e;fo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.createVal=this.timingTarget.r)},this.onTimeNodeStart=()=>{var e;fo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.timingTarget&&this.createVal!==null&&(this.timingTarget.r=this.createVal),this.startVal=null},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.onTimeNodeCreate(),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var t;this.currentVal=(t=this.timingTarget)===null||t===void 0?void 0:t.r}}class OS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var e,n;const{cmd:r,cmdType:o}=this.json;!this.isApplied&&r&&o&&(this.isApplied=!0,(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand(r,o))},this.onSeekToStart=()=>{var e,n;this.commonTimeNode.isInInteractiveSeq||(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("seekToStart",this.onSeekToStart),this.commonTimeNode.on("seekToEnd",this.onSeekToEnd)}get modifyAttrKey(){var t,e,n,r;return((e=(t=this.json)===null||t===void 0?void 0:t.cmd)!==null&&e!==void 0?e:"")+((r=(n=this.json)===null||n===void 0?void 0:n.cmdType)!==null&&r!==void 0?r:"")}}class LS{constructor(t){this.runtimeNodeEventHub=new fi.a,this.onVolumeUpdate=C=>{this.audio.volume(C)},this.stopAudio=()=>{this.audio.stop()},this.destroy=()=>{this.stopAudio(),this.audio.destroy(),this.ctx.activeMedia.delete(this.audio),this.ctx.volumeAdjuster.off("update",this.onVolumeUpdate)};const{json:e,isIterate:n,isSub:r,eventHub:o,ctx:s,parent:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.json=e,this.id=e.cMediaNode.ctn.id,this.commonTimeNode=new ta({json:e.cMediaNode.ctn,isSub:r,eventHubs:{global:o,runtime:this.runtimeNodeEventHub},ctx:s,parent:a,isIterate:n,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_});let x=e.cMediaNode.tgtEl;const[w,A]=x.split("dynamicConvert");A&&(x=`${s.prefix}${A}`),s.loaderDelegate&&(x=s.loaderDelegate.redirectMedia(x),s.logger.info(`redirect media url from ${e.cMediaNode.tgtEl} to ${x} by delegate.`,s.taskId)),this.audio=new Sc(x,s.runningAudio,void 0,{enableWebAudio:s.enableWebAudio}),s.activeMedia.add(this.audio),this.commonTimeNode.on("timelineStart",()=>{this.audio.volume(s.volumeAdjuster.volume),this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.destroy),this.ctx=s,this.ctx.volumeAdjuster.on("update",this.onVolumeUpdate)}}function Mc(i){return function(t){return!!(t!=null&&t.cBhvr)}(i)?i.cBhvr.ctn:function(t){var e;return!!(!((e=t==null?void 0:t.cMediaNode)===null||e===void 0)&&e.ctn)}(i)?i.cMediaNode.ctn:i.ctn}var NS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class ta extends fi.a{constructor(t){var e,n;super(),this.uuid=cs(),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId="",this.iterateShadows=[],this.isEndEventsEmitted=!1,this.tmFilter=[],this.timeDelta=0,this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.isInfiniteRepeat()?this.repeatTimeNodeEnd():this.seekToEnd(!1,!0))},this.handleActive=(G=!0)=>{if(this.isActive=!0,this.isConflictDispose=!1,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(G))}else this.startTimeLine(G)},this.updateTimeLine=G=>{const K=G/(Tr.b.TARGET_FPMS||.06);this.timeDelta+=K,this.duration-this.timeDelta<=K&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(G=!1)=>{(this.isTimeNodeEnd()||G)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:r,isIterate:o,ctx:s,eventHubs:a,parent:l,json:h,iterateType:u,iterateId:p,iterateIndex:_,isInInteractiveSeq:x,fromSeqId:w}=t;this.isSub=r,this.fromSeqId=w,this.isInInteractiveSeq=x,this.isIterate=o,this.parentTimeNode=l,this.json=h,this.ctx=s,this.iterateIndex=_,this.eventHubs=a,this.iterateType=u,this.iterateId=p,this.tmFilter=(n=(e=h.tmFilter)===null||e===void 0?void 0:e.split(";").map(G=>G.split(",").map(K=>parseFloat(K.trim()))))!==null&&n!==void 0?n:[];const A=Number(this.json.dur),C=this.json.spd||1;if(this.isNegativeSpeed=C<0,Number.isNaN(A)||(this.duration=A/Math.abs(C)),this.uuid+="--"+this.json.id,this.setPreStyle(),h.childTnLst&&this.createChildren(h.childTnLst),this.startConds=new qa(this.json.id||"",h.stCondLst,a,this.ctx),this.endConds=new qa(this.json.id||"",h.endCondLst,a,this.ctx),h.endSync&&(this.endSync=new qa(this.json.id||"",[h.endSync],a,this.ctx),this.endSync.on("active",()=>{var G;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(G=this.endSync)===null||G===void 0||G.reset())})),this.startConds.on("active",G=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(G))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(G=>G.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"){const G="shape slide onNext"+this.fromSeqId;this.startConds.addCond({event:G})}this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const t=cs();let e=!0,n=0;const r=o=>{o===t&&(e=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",r))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",r);e;){const o=JSON.parse(JSON.stringify(this.json)),s=new ta({json:o,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:o.iterate.type,iterateIndex:n,iterateId:t,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId});this.iterateShadows[n]=s,n+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(t){this.isReverse=t}createTimeNode(t,e){let n=null;const r={json:t,isSub:e,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId};return t.type==="seq"?n=new qw(r):t.type==="par"?n=new hg(r):t.type==="set"?n=new Ac(r):t.type==="anim"?n=new Jw(r):t.type==="animEffect"?n=new MS(r):t.type==="animMotion"?n=new CS(r):t.type==="animScale"?n=new RS(r):t.type==="animClr"?n=new IS(r):t.type==="animRot"?n=new PS(r):t.type==="cmd"?n=new OS(r):t.type==="audio"&&(n=new LS(r)),n}createSubList(t){this.subList&&this.subList.forEach(e=>e.commonTimeNode.destroy()),this.subList=[],t.forEach(e=>{const n=this.createTimeNode(e,!0);n&&this.subList.push(n)})}bindCommonTimeNodeEvent(t){t.commonTimeNode.on("timeNodeStart",e=>{this.emit("childTimeNodeStart",e)}),t.commonTimeNode.on("timeNodeEnd",e=>{this.emit("childTimeNodeEnd",e),this.children.every(n=>n.commonTimeNode.isTimeNodeEndWhenDetectEndSync())&&(this.json.iterate||this.allChildrenEndHandle())})}createChildren(t){function e(o){return Mc(o).presetOrder}function n(o){return/^slide/.test(o)?"slide":/^layout/.test(o)?"layout":/^master/.test(o)?"master":"unknow"}const r=["master","layout","slide","unknow"];t&&t[0]&&e(t[0])?[...t].sort((o,s)=>{var a,l,h,u;const p=Mc(o).id,_=Mc(s).id;if(p&&_){const x=n(p),w=n(_);return x===w?((a=e(o))!==null&&a!==void 0?a:0)-((l=e(s))!==null&&l!==void 0?l:0):r.indexOf(x)-r.indexOf(w)}return((h=e(o))!==null&&h!==void 0?h:0)-((u=e(s))!==null&&u!==void 0?u:0)}).forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))}):t.forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(t=>t.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=this.ctx.clock.setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.isInInteractiveSeq&&this.isInfiniteRepeat()&&this.repeatTimeNodeEnd(),this.timeDelta=0,this.children.forEach(t=>t.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(t=>t.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.isEndEventsEmitted=!1,this.timeDelta=0;const t=1e3/this.ctx.ticker.maxFPS;this.duration<=t&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(We.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>t&&(this.ctx.eventHub.emit(We.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(t=!0){if(t&&(this.isEndEventsEmitted=!1,this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.ctx.ticker.addOnce(()=>{this.onTimeLineEnd()})):this.duration>e&&(this.ctx.eventHub.emit(We.animateStart),this.updateTimeLine(0),this.ctx.ticker.add(this.updateTimeLine))}startIterate(){return NS(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const t of this.iterateShadows){if(this.isIterateEnd)break;t.children.forEach(e=>{e.commonTimeNode.startTimeNode()}),t.applyCount+=1,yield this.ctx.clock.delay(this.json.iterate.interval)}this.onTimeLineEnd()}})}applyTimeFilter(t){if(!this.tmFilter.every(e=>fo()(e[0])&&fo()(e[1])))return t;for(let e=0;e<this.tmFilter.length;e++){const n=this.tmFilter[e];if(t<n[0]){const r=this.tmFilter[e-1];return(t-r[0])/(n[0]-r[0])*(n[1]-r[1])+r[1]}}return this.tmFilter.length>0?this.tmFilter[this.tmFilter.length-1][1]:t}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}findTargets(){const t=[],e=n=>{n.forEach(r=>{var o,s,a;r.cBhvr&&r.cBhvr.target&&t.findIndex(l=>l.id===r.cBhvr.target.id)<0&&t.push(r.cBhvr.target),((s=(o=r==null?void 0:r.cBhvr)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.childTnLst)&&r.cBhvr.ctn.childTnLst.length>0&&e(r.cBhvr.ctn.childTnLst),((a=r==null?void 0:r.ctn)===null||a===void 0?void 0:a.childTnLst)&&r.ctn.childTnLst.length>0&&e(r.ctn.childTnLst)})};return e(this.json.childTnLst||[]),t}setPreStyle(){this.json.presetClass&&this.findTargets().forEach(t=>{if(this.json.iterate){let e=0,n=!0;for(;n;){const r=this.ctx.timingTargets.getTarget(t,!0,{type:this.json.iterate.type,index:e,id:""});r&&(this.setPreStyleForTarget(r),e+=1),n=!!r}}else{const e=this.ctx.timingTargets.getTarget(t,!1);e&&this.setPreStyleForTarget(e)}})}setPreStyleForTarget(t){var e,n;if(t&&this.json.presetSubtype&&(t.presetSubType=this.json.presetSubtype),t&&!t.hasPreset)if(this.json.presetClass==="entr"){const r=(n=(e=this.json)===null||e===void 0?void 0:e.childTnLst)===null||n===void 0?void 0:n.filter(o=>o.type==="set"&&o.to==="visible");r!=null&&r.length&&(t.hasPreset=!0,t.style.visibility="hidden")}else(this.json.presetClass==="exit"||this.json.presetClass==="path"||this.json.presetClass==="emph")&&(t.hasPreset=!0,t.style.visibility="visible")}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(t=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(t);const e=this.json.stCondLst.filter(r=>/^self/.test(r.event||""))[0];e&&this.startConds.condHandle(e);const n=this.json.endCondLst.filter(r=>/^self/.test(r.event||""))[0];n&&this.endConds.condHandle(n),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(t=>t.commonTimeNode.destroy())}seekToStart(t=!0){if(this.isEndEventsEmitted=!1,this.isActive=!1,this.dispose(),this.timeDelta=0,this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(e=>e.seekToStart(t));if(t)for(let e=this.subList.length-1;e>=0;e--){const n=this.subList[e];n==null||n.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}if(this.children.length>1)for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}}repeatTimeNodeEnd(){this.dispose(),this.children.forEach(t=>{t.commonTimeNode.isActive=!1,t.commonTimeNode.dispose()})}dispose(t=!1){this.isConflictDispose=t,this.ctx.clock.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(We.animateEnd);try{this.ctx.ticker.remove(this.updateTimeLine)}catch{}this.startConds.reset(),this.endConds.reset()}seekToEnd(t,e=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const n=this.json.autoRev||t;if(n?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(r=>r.seekToEnd(n,e));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(r=>r.commonTimeNode.seekToEnd(n,e)),e&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(r=>r.commonTimeNode.seekToEnd(!1)),this.clearSubList())}isTimeNodeEndWhenDetectEndSync(){if(this.isInInteractiveSeq&&this.isInfiniteRepeat())return!0;let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEndWhenDetectEndSync())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}isTimeNodeEnd(){let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}emitEndEvents(){this.isEndEventsEmitted||(this.isEndEventsEmitted=!0,this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}))}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(t=>t.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(t=>t.commonTimeNode.destroy()),this.clearSubList()}}class hg extends fi.a{constructor(t){super(),this.isRunning=!1,this.runtimeNodeEventHub=new fi.a;const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}=t;this.id=e.ctn.id,this.json=e,this.ctx=a,this.isIterate=r,this.globalEventHub=l,this.commonTimeNode=new ta({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:_}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),x.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end")),this.commonTimeNode.json.presetClass==="exit"&&this.commonTimeNode.children.length>=1&&this.commonTimeNode.children[this.commonTimeNode.children.length-1]instanceof Ac&&this.commonTimeNode.children.forEach(x=>{x instanceof Ac||typeof x.onSeekToStart!="function"||x.onSeekToStart()})})}}var DS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class FS{constructor(t,e,n){this.json=t,this.ctx=n,this.globalEventHub=e;const r=t.timeNodeList.find(o=>o.type==="par"&&o.ctn.nodeType==="tmRoot");r&&(this.tmRoot=new hg({json:r,isSub:!1,isIterate:!1,eventHub:e,ctx:n,parent:null,iterateType:"el",iterateIndex:0,iterateId:"",isInInteractiveSeq:!1,fromSeqId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(o=>{var s,a,l;return((s=o.json)===null||s===void 0?void 0:s.type)==="seq"&&((l=(a=o.json)===null||a===void 0?void 0:a.ctn)===null||l===void 0?void 0:l.nodeType)==="mainSeq"}))}findSeq(t){var e;return(e=this.tmRoot)===null||e===void 0?void 0:e.commonTimeNode.children.find(n=>{var r,o,s;return((r=n.json)===null||r===void 0?void 0:r.type)==="seq"&&((s=(o=n.json)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.id)===t})}start(){var t,e;return DS(this,void 0,void 0,function*(){this.json.autoPlayMainSeq?(yield this.ctx.clock.delay(16),(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.startTimeNode()):(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()})}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var t;(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.collectStartValue()}setMainSeqStep(t,e){var n;t===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(n=this.mainSeq)===null||n===void 0||n.setCurrentStep(t,e)}destroy(){var t;this.globalEventHub.removeAllListeners(),(t=this.tmRoot)===null||t===void 0||t.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(t){const e=this.findSeq(t);e&&e.commonTimeNode.seekToEnd(!1,!0)}setInteractiveSeqState(t,e,n){const r=this.findSeq(t);r&&r.setCurrentStep(e,n)}resetAllInteractiveSeq(){var t;(((t=this.tmRoot)===null||t===void 0?void 0:t.commonTimeNode.children.filter(e=>{var n,r,o;return((n=e.json)===null||n===void 0?void 0:n.type)==="seq"&&((o=(r=e.json)===null||r===void 0?void 0:r.ctn)===null||o===void 0?void 0:o.nodeType)==="interactiveSeq"}))||[]).forEach(e=>{e.setCurrentStep(0,"start")})}applyInteractiveAction(t){this.globalEventHub.emit(t)}}var ug=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class BS extends Ec{constructor(t,e,n,r){super({id:"stage",width:t.width,height:t.height,type:"Container",children:t.children},e,{parentGlobalPos:n},r),this.isRendered=!1,this.isTimingStartValueCollected=!1,this.json=t,this.json.smartArtShapeList&&(e.smartArtShapeList=this.json.smartArtShapeList),e.hasBackgroundFillShape=this.detectUseBackgroundFill(this.json),this.container.visible=!1,this.ctx=e;const o=new $i;o.beginFill(16777215),o.drawRect(0,0,t.width,t.height),o.endFill(),this.container.addChild(o)}detectUseBackgroundFill(t){return!!t&&(t.type==="Picture"||t.type==="Shape"?t.useBgFill:!(!t.children||!Array.isArray(t.children))&&t.children.some(e=>this.detectUseBackgroundFill(e)))}initOnReuse(){super.initOnReuse(),this.ctx.timingEventHub.on("c:prev slide",t=>{this.ctx.eventHub.emit(We.requestPrevSlide,t)}),this.ctx.timingEventHub.on("c:next slide",(t,e)=>{this.ctx.eventHub.emit(We.requestNextSlide,t,e)})}get interactiveContainer(){return this.container}applyEffectCacheAsBitMap(t){this.children.forEach(e=>e.applyEffectCacheAsBitMap(t))}render(t){this.isRendered||(this.collectAnimatedIds().forEach(e=>this.ctx.animatedIds.add(e)),this.isRendered=!0,super.render(t),t.addSubMTask(()=>ug(this,void 0,void 0,function*(){this.ctx.eventHub.emit("StageRenderEnd")}),"@StageImpl[emit.StageRenderEnd]"))}isListTimeNode(t){return["excel","seq","par"].indexOf(t.type)>=0}isAnimatedTimeNode(t){return!!t.cBhvr}collectAnimatedIdsForTimeNode(t,e){var n;this.isListTimeNode(t)?(n=t.ctn.childTnLst)===null||n===void 0||n.forEach(r=>{this.collectAnimatedIdsForTimeNode(r,e)}):this.isAnimatedTimeNode(t)&&e.push(t.cBhvr.target.id)}collectAnimatedIds(){const t=[];return this.json.timing&&this.json.timing.timeNodeList.forEach(e=>{this.collectAnimatedIdsForTimeNode(e,t)}),t}createTiming(){this.json.timing&&!this.timing&&(this.timing=new FS(this.json.timing,this.ctx.timingEventHub,this.ctx))}startTiming(){var t;return((t=this.timing)===null||t===void 0?void 0:t.start())||Promise.resolve()}setMainSeqApplied(){var t;(t=this.timing)===null||t===void 0||t.setMainSeqApplied()}setMainSeqStep(t,e){var n;(n=this.timing)===null||n===void 0||n.setMainSeqStep(t,e)}collectMainSeqStartValue(){var t;this.isTimingStartValueCollected||(this.isTimingStartValueCollected=!0,(t=this.timing)===null||t===void 0||t.collectMainSeqStartValue())}hasTiming(){return!!this.timing}clearOnSlideChange(){this.ctx.eventHub.removeAllListeners(),this.ctx.timingEventHub.removeAllListeners(),super.clearOnSlideChange()}clearOnTransactionEnd(){var t,e;this.ctx.timingTargets.getTargets().forEach(n=>{n.hasPreset=!1}),(t=this.timing)===null||t===void 0||t.resetAllInteractiveSeq(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0}destroy(){var t,e;this.isTimingStartValueCollected=!1,this.isRendered=!1,this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),(t=this.ctx.bgTexture)===null||t===void 0||t.destroy(!0),this.ctx.spriteTexture.destroy(),this.ctx.timingEventHub.removeAllListeners(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0,super.destroy()}mainSeqStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqStep())!==null&&e!==void 0?e:0}mainSeqLength(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqLength())!==null&&e!==void 0?e:0}mainSeqHasNextStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(t,e){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onNext",t,e)):this.ctx.eventHub.emit(We.requestNextSlide,t,e)}prevStep(t=!1){var e;this.hasTiming()&&((e=this.timing)===null||e===void 0?void 0:e.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onPrev",t)):this.ctx.eventHub.emit(We.requestPrevSlide,t)}applyInteractiveAction(t){var e;(e=this.timing)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.timing)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.timing)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){return ug(this,void 0,void 0,function*(){const r=this.ctx.medias[t];r&&(e?n?(yield sh(()=>r.clippedDuration>0,5e3),n<r.clippedDuration&&(r.once("play",()=>{r.seek(n)}),yield r.play())):yield r.play():(n&&r.seek(n),yield r.pause()))})}setMediaCurrentTime(t,e){const n=this.ctx.medias[t];n&&n.seek(e)}}class kS{constructor(t){this.ticker=t,this.tasks=[],this.couldRunning=!1,this.applyNext=()=>{this.tasks=this.tasks.filter(n=>!n.isEmpty());const e=this.tasks[0];e&&e.applyNext()},t.add(this.applyNext)}addTask(t){this.tasks.push(t),t.once("task-finish",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)}),t.once("task-error",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)})}start(){this.couldRunning=!0}stop(){this.couldRunning=!1}}var US=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const GS=i=>new Promise(t=>setTimeout(t,i));class HS extends fi.a{constructor(t,e,n){super(),this.slideIndex=t,this.taskId=e,this.logger=n,this.uuid=cs(),this.isCancel=!1,this.tasks=[]}isEmpty(){return this.tasks.length===0}addMTask(t,e){this.tasks.push({fn:t,state:"wait",sub:[],name:e})}addSubMTask(t,e){let n=this.tasks.findIndex(r=>r.state==="running");n<0&&(n=0),this.tasks[n].sub.push({fn:t,state:"wait",sub:[],name:e})}cancel(){this.tasks=[],this.isCancel=!0}applyNext(){if(this.tasks.some(e=>e.state==="running")||this.tasks.some(e=>e.state==="error"))return;if(this.tasks.every(e=>e.state==="finish"))return void(this.isCancel||this.emit("task-finish"));const t=this.tasks.find(e=>e.state==="wait");t&&(t.state="running",t.fn.apply(null).then(()=>{if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}).catch(e=>{t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",Ti.transform(e),this.slideIndex)}))}applyAll(){return US(this,void 0,void 0,function*(){for(;!this.tasks.every(t=>t.state==="finish");)if(this.tasks.some(t=>t.state==="running"))yield GS(16);else{if(this.tasks.some(t=>t.state==="error"))return;{const t=this.tasks.find(e=>e.state==="wait");if(t){t.state="running";try{if((yield Js(()=>t.fn.apply(null),6e4))===po)throw new Ti(Wi.RuntimeError,`subtask ${t.name} apply timeout`);if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}catch(e){let n;n=e!=null&&e.errorType?e:new Ti(Wi.RuntimeError,`subtask ${t.name} error. ${e}`),t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",Ti.transform(n),this.slideIndex);break}}}}!this.isCancel&&this.tasks.every(t=>t.state==="finish")&&this.emit("task-finish")})}}var jS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class zS{constructor(t,e){this.renderer=t,this.localStorage=e,this.worker=null,this.outputData=new Map,this.loadingSdfKeys=new Set;const n=new Blob([`
self.onmessage = function(e) {
    var data = e.data.data;
    var key = e.data.key;
    var height = Math.ceil(e.data.height);
    var width = Math.ceil(e.data.width);
    if (!data || !key) {
        return;
    }
    var maxDis = 0;
    var d = [];
    var p = [];
    var maxInt = Number.MAX_SAFE_INTEGER || 255 * 255 * 255;
    var setD = function(x, y, v) { d[y * width + x] = v; };
    var getD = function(x, y) { return d[y * width + x]; };
    var setP = function(x, y, v) { p[y * width + x] = v; };
    var getP = function(x, y) { return p[y * width + x]; };
    var isContains = function(x, y) { return x >= 0 && x < width && y >= 0 && y < height; };
    var isInterior = function(x, y) { return data[(y * width + x) * 4 + 3] > 10; };
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var c = isInterior(x, y);
            var t = isContains(x, y - 1) ? isInterior(x, y - 1) : false;
            var b = isContains(x, y + 1) ? isInterior(x, y + 1) : false;
            var l = isContains(x - 1, y) ? isInterior(x - 1, y) : false;
            var r = isContains(x + 1, y) ? isInterior(x + 1, y) : false;
            if (c !== t || c !== b || c !== l || c !== r) {
                setD(x, y, 0);
                setP(x, y, [x, y]);
            } else {
                setD(x, y, maxInt);
                setP(x, y, [-1, -1]);
            }
        }
    }
    
    var f = function (x, y, dir) {
        var d1 = 1;
        var d2 = Math.sqrt(2);
        var dx;
        var dy;
        var od;
        switch (dir) {
            case "TL": dx = -1; dy = -1; od = d2; break;
            case "T": dx = 0; dy = -1; od = d1; break;
            case "TR": dx = 1; dy = -1; od = d2; break;
            case "L": dx = -1; dy = 0; od = d1; break;
            case "R": dx = 1; dy = 0; od = d1; break;
            case "BL": dx = -1; dy = 1; od = d2; break;
            case "B": dx = 0; dy = 1; od = d1; break;
            case "BR": dx = 1; dy = 1; od = d2; break;
        }
        var b = isContains(x + dx, y + dy);
        var cb = b ? getD(x + dx, y + dy) : maxInt;
        if (cb + od < getD(x, y)) {
            var p = b ? getP(x + dx, y + dy) : [-1, -1];
            var dis = Math.sqrt(Math.pow(x - p[0], 2) + Math.pow(y - p[1], 2));
            setP(x, y, p);
            setD(x, y, dis);
            if (dis > maxDis) {
                maxDis = dis;
            }
        }
    };
    
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var dirs = ["TL", "T", "TR", "L"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    for (var y = height - 1; y >= 0; -- y) {
        for (var x = width - 1; x >= 0; -- x) {
            var dirs = ["R", "BL", "B", "BR"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    var outputData = [];
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            outputData.push(isInterior(x, y) ? 255: 0);
            outputData.push(0);
            outputData.push(0);
            outputData.push(Math.ceil(getD(x, y) / maxDis * 255));
        }
    }
    self.postMessage({
        key, outputData, maxDis
    });
};
`],{type:"text/javascript"});this.worker=new Worker(URL.createObjectURL(n)),this.worker.onmessage=r=>{this.outputData.set(r.data.key,{data:r.data.outputData,maxDis:r.data.maxDis})},this.outputData.set("111","222")}createSdfByWorker(t,e,n,r,o,s,a,l){const h=document.createElement("canvas");h.width=o,h.height=s;const u=h.getContext("2d");if(!u||!this.worker)return;u.drawImage(a,t,e,n,r);const{data:p}=u.getImageData(0,0,o,s);this.worker.postMessage({data:p,key:l,width:o,height:s})}createSdf(t,e,n){const r=document.createElement("canvas");r.width=t,r.height=e;const o=r.getContext("2d");if(!o)return{src:"",maxDis:1};o.drawImage(n,0,0);let s=0;const{data:a}=o.getImageData(0,0,t,e),l=[],h=[],u=function(K,it,ft){l[it*t+K]=ft},p=function(K,it){return l[it*t+K]},_=function(K,it,ft){h[it*t+K]=ft},x=function(K,it){return h[it*t+K]},w=function(K,it){return K>=0&&K<t&&it>=0&&it<e},A=function(K,it){return a[4*(it*t+K)+3]>10};for(let K=0;K<e;++K)for(let it=0;it<t;++it){const ft=A(it,K),nt=!!w(it,K-1)&&A(it,K-1),gt=!!w(it,K+1)&&A(it,K+1),lt=!!w(it-1,K)&&A(it-1,K),dt=!!w(it+1,K)&&A(it+1,K);ft!==nt||ft!==gt||ft!==lt||ft!==dt?(u(it,K,0),_(it,K,[it,K])):(u(it,K,Number.MAX_SAFE_INTEGER),_(it,K,[-1,-1]))}const C=function(K,it,ft){const nt=Math.sqrt(2);let gt,lt,dt;switch(ft){case"TL":gt=-1,lt=-1,dt=nt;break;case"T":gt=0,lt=-1,dt=1;break;case"TR":gt=1,lt=-1,dt=nt;break;case"L":gt=-1,lt=0,dt=1;break;case"R":gt=1,lt=0,dt=1;break;case"BL":gt=-1,lt=1,dt=nt;break;case"B":gt=0,lt=1,dt=1;break;case"BR":gt=1,lt=1,dt=nt}const Ut=w(K+gt,it+lt);if((Ut?p(K+gt,it+lt):Number.MAX_SAFE_INTEGER)+dt<p(K,it)){const Ft=Ut?x(K+gt,it+lt):[-1,-1],Et=Math.sqrt(Math.pow(K-Ft[0],2)+Math.pow(it-Ft[1],2));_(K,it,Ft),u(K,it,Et),Et>s&&(s=Et)}};for(let K=0;K<e;++K)for(let it=0;it<t;++it){const ft=["TL","T","TR","L"];for(const nt of ft)C(it,K,nt)}for(let K=e-1;K>=0;--K)for(let it=t-1;it>=0;--it){const ft=["R","BL","B","BR"];for(const nt of ft)C(it,K,nt)}const G=[];for(let K=0;K<e;++K)for(let it=0;it<t;++it)G.push(0,0,0,Math.ceil(p(it,K)/s*255));return o.putImageData(new ImageData(Uint8ClampedArray.from(G),t,e),0,0),{src:r.toDataURL("image/png"),maxDis:s}}getSdf(t,e,n){return jS(this,void 0,void 0,function*(){const r=Math.ceil(e.width),o=Math.ceil(e.height),s=Math.ceil(e.width-t.width)/2,a=Math.ceil(e.height-t.height)/2;let l=yield this.localStorage.getItem(`sdf-${n}-src`),h=yield this.localStorage.getItem(`sdf-${n}-maxDis`);if(!(l&&h||this.loadingSdfKeys.has(n))){this.loadingSdfKeys.add(n);const u=this.renderer.plugins.extract.image(t,"image/png");u.addEventListener("load",()=>{this.createSdfByWorker(s,a,t.width,t.height,r,o,u,n)}),u.addEventListener("error",()=>null),yield sh(()=>!!this.outputData.has(n),2e3),this.loadingSdfKeys.delete(n);const p=this.outputData.get(n);if(p){this.outputData.delete(n);const _=document.createElement("canvas");_.width=r,_.height=o;const x=_.getContext("2d");if(!x)return null;x.putImageData(new ImageData(Uint8ClampedArray.from(p.data),r,o),0,0),l=_.toDataURL("image/png"),h=p.maxDis,this.localStorage.setItem(`sdf-${n}-src`,l).catch(()=>{}),this.localStorage.setItem(`sdf-${n}-maxDis`,h).catch(()=>{})}}return!l||!h?null:(document.createElement("img").src=l,ue.t.fromURL(l).then(u=>({texture:u,maxDis:h})).catch(()=>null))})}destroy(){var t;(t=this.worker)===null||t===void 0||t.terminate(),this.worker=null}}var ea=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class VS{constructor(t,e,n,r,o,s,a,l,h,u,p,_,x,w,A,C,G,K,it){this.loader=t,this.mode=e,this.renderer=n,this.ticker=r,this.view=o,this.clock=s,this.objPoolGroup=a,this.errorChannel=l,this.localstorage=h,this.logger=u,this.loaderDelegate=p,this.urlInterrupter=_,this.isPlayerPaused=x,this.maxResolution=w,this.volumeAdjuster=A,this.forceCanvas=C,this.globalEventHub=G,this.enableWebAudio=K,this.customLinks=it,this.currentStageIndex=0,this.cacheCount=fs.isDesktop()?2:1,this.stageStates=Object.create(null),this.stageJsons=Object.create(null),this.stageCtxs=Object.create(null),this.stageImpls=Object.create(null),this.taskId="",this.url="",this.runningAudio=new Map,this.activeMedia=new Set,this.microTaskManager=new kS(r),this.sdfManager=new zS(n,h)}setResourceData(t,e){this.taskId=t,this.url=e}createCtx(t){const{task:e}=this.stageStates[t];e.addMTask(()=>ea(this,void 0,void 0,function*(){const n=new IT(this.loader),r=new fi.a,o={taskId:this.taskId,prefix:this.url,mode:this.mode,renderer:this.renderer,graphicsTexture:new DT(this.maxResolution),stageWidth:0,stageHeight:0,ticker:this.ticker,timingTargets:new BT(r),eventHub:r,view:this.view,medias:Object.create(null),lastViewedIndex:0,conflictTimeNodeManager:new FT,clock:this.clock,spriteTexture:n,slideIndex:t,objectPoolGroup:this.objPoolGroup,hasBackgroundFillShape:!1,slideScopeEventHub:new fi.a,logger:this.logger,sdfManager:this.sdfManager,loaderDelegate:this.loaderDelegate,runningAudio:this.runningAudio,activeMedia:this.activeMedia,isPlayerPaused:this.isPlayerPaused,timingEventHub:new fi.a,maxResolution:this.maxResolution,animatedIds:new Set,volumeAdjuster:this.volumeAdjuster,forceCanvas:this.forceCanvas,globalEventHub:this.globalEventHub,latestChangeFullscreenTargetId:"",isRendering:!1,urlInterrupter:this.urlInterrupter,enableWebAudio:this.enableWebAudio};this.stageCtxs[t]=o}),"@StagePool[createCtx]")}loadStageJson(t){const{task:e}=this.stageStates[t];e.addMTask(()=>ea(this,void 0,void 0,function*(){const n=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${t}.json`);this.stageJsons[t]=n,this.stageCtxs[t].stageWidth=n.width,this.stageCtxs[t].stageHeight=n.height,this.stageCtxs[t].featureList=n.featureList}),"@StagePool[loadStageJson]")}loadSpriteSheets(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{const n=this.stageJsons[t],{spriteTexture:r,stageWidth:o,stageHeight:s}=this.stageCtxs[t],{coloredSheets:a,sheets:l}=n,h=a||l;return h&&h.forEach(u=>{e.addSubMTask(()=>{let p=1;if(o>this.maxResolution.x||s>this.maxResolution.y){p=this.maxResolution.x/o;const _=p*s;_>this.maxResolution.y&&(p*=this.maxResolution.y/_)}return p=Math.min(1,p),r.loadSpriteSheetItem(this.url,this.taskId,u,p)},"@StagePool[spriteTexture.loadSpriteSheetItem]")}),Promise.resolve()},"@StagePool[loadSpriteSheets]")}insertCustomLinksFromScope(t,e){t&&t.length&&t.forEach(n=>{n&&(n.type==="Shape"||n.type==="Picture"?n.id===e.shapeId&&(n.hlinkClick&&this.logger.warn(`Custom link ${e.shapeId} already has action, will force rewrite`,this.taskId),n.hlinkClick={uuid:`customLink-${e.pageIndex}-${e.shapeId}`,action:"",target:e.link}):n.children&&this.insertCustomLinksFromScope(n.children,e))})}insertCustomLinks(t,e){return e&&e.length&&e.forEach(n=>{let r;r=n.shapeId.startsWith("master")?t.children[1]:n.shapeId.startsWith("layout")?t.children[2]:t.children[3],r||this.logger.error("Cannot find scope for custom link "+n.shapeId,this.taskId),this.insertCustomLinksFromScope(r.children,n)}),t}createStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{var n;let r=this.stageJsons[t];const o=this.stageCtxs[t],s=(n=this.customLinks)===null||n===void 0?void 0:n.filter(l=>l.pageIndex===t);r=this.insertCustomLinks(r,s);const a=new BS(r,o,{x:0,y:0},e);return this.stageImpls[t]=a,Promise.resolve()},"@StagePool[createStage]")}preRenderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>(this.stageImpls[t].preRender(e),Promise.resolve()),"@StagePool[preRenderStage]")}createGraphicsTexture(t){const{task:e}=this.stageStates[t];e.addMTask(()=>ea(this,void 0,void 0,function*(){const n=this.stageCtxs[t];n.graphicsTexture.pack().forEach((r,o)=>{e.addSubMTask(()=>n.graphicsTexture.render(r,o,this.objPoolGroup,1),"@StagePool[graphicsTexture.render]")})}),"@StagePool[createGraphicsTexture]")}renderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>ea(this,void 0,void 0,function*(){yield this.stageImpls[t].render(e)}),"@StagePool[renderStage]")}destroyStageByIndex(t){this.stageStates[t].state==="load"&&this.stageStates[t].task.cancel(),delete this.stageStates[t],this.stageImpls[t].destroy(),delete this.stageImpls[t],delete this.stageCtxs[t]}destroyStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);Math.abs(this.currentStageIndex-e)>this.cacheCount&&this.destroyStageByIndex(e)})}destroyAllStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);this.destroyStageByIndex(e)})}preloadResource(t){return ea(this,void 0,void 0,function*(){const e=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${t}.json`),{coloredSheets:n,sheets:r}=e,o=n||r;for(const s of o){yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/${s}.json`);let a=1;if(e.width>this.maxResolution.x||e.height>this.maxResolution.y){a=this.maxResolution.x/e.width;const l=a*e.height;l>this.maxResolution.y&&(a*=this.maxResolution.y/l)}a=Math.min(1,a),yield this.loader.fetchPng(`${this.url}/${this.taskId}/jsonOutput/${s}.png`,a)}})}preload(t,e=!1){return this.stageImpls[t]||this.stageStates[t]?Promise.resolve():new Promise((n,r)=>{const o=new HS(t,this.taskId,this.logger);o.on("task-error",(s,a)=>{delete this.stageStates[a],delete this.stageImpls[a],delete this.stageCtxs[a],this.errorChannel.emit("error",s,a),r(s)}),this.stageStates[t]={state:"load",task:o},this.createCtx(t),this.loadStageJson(t),this.loadSpriteSheets(t),this.createStage(t),this.preRenderStage(t),this.createGraphicsTexture(t),this.renderStage(t),this.microTaskManager.addTask(o),e?o.applyAll().then(()=>{n()}).catch(s=>{r(s)}):o.once("task-finish",()=>{this.stageStates[t].state="finish",Object.keys(this.stageStates).length>2*this.cacheCount+1&&this.destroyStage(),n()})})}getStageJson(t){return this.stageJsons[t]||null}getStage(t){return ea(this,void 0,void 0,function*(){this.currentStageIndex=t;const e=this.stageStates[t];return(e==null?void 0:e.state)==="finish"&&this.stageImpls[t]?this.stageImpls[t]:(e==null?void 0:e.state)==="load"?(yield e.task.applyAll(),this.stageImpls[t]):(yield this.preload(t,!0),this.stageImpls[t])})}destroy(){this.runningAudio.clear(),this.sdfManager.destroy()}}const WS=new class extends L0{createObject(){return document.createElement("img")}resetObject(i){i.removeAttribute("src")}};var cg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Nr{constructor(t){var e;this.logger=t,this.taskId="",this.isIndexDBReady=!1,this.memoryCache=new Map,(e=Nr.localCache)===null||e===void 0||e.ready(n=>{n||(this.isIndexDBReady=!0)}).catch(()=>{t.warn("local storage not ready",this.taskId)})}get couldUseIndexDBCache(){return this.isIndexDBReady&&this.taskId.length>0}attachTaskId(t){this.taskId=t}getItem(t){return cg(this,void 0,void 0,function*(){let e=null;if(this.couldUseIndexDBCache&&Nr.localCache)try{e=yield Js(()=>Nr.localCache.getItem(`${this.taskId}/${t}`),500)}catch{}return e=e===po?null:e,e||this.memoryCache.get(t)||null})}setItem(t,e,n=!1){return cg(this,void 0,void 0,function*(){if(!this.couldUseIndexDBCache)return n&&this.memoryCache.set(t,e),Promise.resolve();if(Nr.localCache){let r=null;try{r=yield Js(()=>Nr.localCache.setItem(`${this.taskId}/${t}`,e).catch(()=>{n&&this.memoryCache.set(t,e)}),500)}catch{}r!==po&&r!==null||!n||this.memoryCache.set(t,e)}})}dispose(){var t;this.memoryCache=new Map,this.couldUseIndexDBCache&&((t=Nr.localCache)===null||t===void 0||t.keys().then(e=>{e.filter(n=>n.indexOf(this.taskId)>=0).forEach(n=>{var r;(r=Nr.localCache)===null||r===void 0||r.removeItem(n).catch(()=>{})})}).catch(()=>{}))}}Nr.localCache=null;try{Nr.localCache=M.createInstance({name:"slide_local_cache",driver:M.INDEXEDDB,version:1})}catch{}const XS=new Oe.j;class Cc{constructor(t){this.localStorage=t}canvas(t,e,n,r){let o,s,a,l=!1,h=!1;t&&(t instanceof ue.p?a=t:(a=e.generateTexture(t),h=!0)),a?(o=a.baseTexture.resolution,s=a.frame,l=!1):(o=e.resolution,l=!0,s=XS,s.width=e.width,s.height=e.height,e.renderTexture.bind(null));const u=Math.floor(s.width*o+1e-4),p=Math.floor(s.height*o+1e-4);let _=document.createElement("canvas");_.width=u,_.height=p;const x=_.getContext("2d");if(!x)throw new Error("ctx");if(n)x.putImageData(n,0,0);else{const w=x.getImageData(0,0,u,p),A=new Uint8Array(4*u*p),{gl:C}=e;C.readPixels(s.x*o,s.y*o,u,p,C.RGBA,C.UNSIGNED_BYTE,A),Cc.arrayPostDivide(A,w.data),x.putImageData(w,0,0),r&&this.localStorage.setItem(r,w).catch(()=>{})}if(l){const w=document.createElement("canvas");w.width=u,w.height=p;const A=w.getContext("2d");A.scale(1,-1),A.drawImage(_,0,-p),_=w}return h&&(a==null||a.destroy(!0)),_}static arrayPostDivide(t,e){for(let n=0;n<t.length;n+=4){const r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}}}class dg extends fi.a{constructor(){super(...arguments),this._volume=.5}get volume(){return this._volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this._volume=t,this.emit("update",this._volume)}}var ms=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};xn.skipHello();const pg={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip",gallery:"Gallery",switch:"Switch",prism:"Prism",doors:"Doors"},We={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",interactiveSeqStateChange:"interactiveSeqStateChange",interactiveSeqAction:"interactiveSeqAction",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",animateStart:"animateStart",animateEnd:"animateEnd",mediaSeek:"mediaSeek",mediaPlay:"mediaPlay",mediaPause:"mediaPause",mediaStop:"mediaStop",requestNextStep:"requestNextStep",requestNextSlide:"requestNextSlide",requestPrevSlide:"requestPrevSlide",requestGotoSlide:"requestGotoSlide",requestOpenUrl:"requestOpenUrl",userInput:"userInput",fullscreenChange:"fullscreenChange",changeLocalFullscreenState:"changeLocalFullscreenState",useraddLink:"useraddLink"};class hr extends fi.a{get view(){return this.app.renderer?this.app.view:null}get nextSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.nextIndex?this.currentStage.json.nextIndex:this.currentIndex+1}get prevSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.prevIndex?this.currentStage.json.prevIndex:this.currentIndex-1}constructor(t,e={}){super(),this.errorChannel=new fi.a,this.transactionPlayer=null,this.isForward=!0,this.drawCall=0,this.scale=1,this._isPaused=!1,this.maxResolution=new Oe.g(0,0),this.transitionResolution=new Oe.g(0,0),this.isNVIDIA=!1,this.fps=new ST,this.designWidth=0,this.designHeight=0,this.currentIndex=0,this.slideCount=0,this.runtime={drawCall:0,fps:0},this.globalEventHub=new fi.a,this.globalVideoBackground=new $i,this.globalVideoSprite=new ci,this.onMousemoveTimeout=null,this.cacheFunctionMap=new Map,this.enableAutoForward=!1,this.isPlayerPaused=()=>this._isPaused,this.onWebGLLost=()=>{this.errorChannel.emit("error",new Ti(Wi.CanvasCrash,"webgl context lost."))},this.fullscreenOnMousemove=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!0}),this.onMousemoveTimeout&&clearTimeout(this.onMousemoveTimeout),this.onMousemoveTimeout=setTimeout(()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},Wo.hoverHiddeDelay)},this.fullscreenOnMouseleave=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},this.calculateFullscreenVideoPosition=o=>{const{width:s,height:a}=o,{designWidth:l,designHeight:h}=this,u=Math.min(l/s,h/a);return{x:(l-s*u)/2,y:(h-a*u)/2,width:s*u,height:a*u}},this.onRequestFullscreenVideo=o=>{const{texture:s,index:a,targetId:l}=o;if(a!==this.currentIndex)return void s.destroy(!1);this.onRequestCancelFullscreenVideo(),this.globalVideoBackground.width=this.designWidth,this.globalVideoBackground.height=this.designHeight,this.globalVideoBackground.beginFill(0,1),this.globalVideoBackground.drawRect(0,0,this.designWidth,this.designHeight),this.globalVideoBackground.endFill(),this.globalVideoBackground.interactive=!0,this.app.stage.addChild(this.globalVideoBackground);const{x:h,y:u,width:p,height:_}=this.calculateFullscreenVideoPosition(s);this.globalVideoSprite.texture=s,this.globalVideoSprite.width=p,this.globalVideoSprite.height=_,this.globalVideoSprite.position.x=h,this.globalVideoSprite.position.y=u,this.globalVideoBackground.addChild(this.globalVideoSprite),this.globalEventHub.emit("onFullscreenChange",{status:!0,targetId:l,slideIndex:this.currentIndex}),this.clearFullscreenEventListenersWithAppView();const x={handleEvent:()=>{var w;(w=this.currentStage)===null||w===void 0||w.ctx.eventHub.emit(We.userInput)}};if(this.app.view.addEventListener("pointerdown",x,!1),this.cacheFunctionMap.set("pointerdown",x),fs.isDesktop()){const w={handleEvent:()=>{this.fullscreenOnMouseleave({index:a,targetId:l})}};this.app.view.addEventListener("mouseout",w,!1);const A={handleEvent:()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:a,targetId:l,status:!0})}};this.app.view.addEventListener("mouseover",A,!1);const C={handleEvent:()=>{this.fullscreenOnMousemove({index:a,targetId:l})}},G={handleEvent:()=>{var K;(K=this.currentStage)===null||K===void 0||K.ctx.globalEventHub.emit("togglePlayStatus",l)}};this.app.view.addEventListener("mousemove",C,!1),this.app.view.addEventListener("click",G,!1),this.cacheFunctionMap.set("click",G),this.cacheFunctionMap.set("mouseover",A),this.cacheFunctionMap.set("mousemove",C),this.cacheFunctionMap.set("mouseout",w)}else{const w={handleEvent:()=>{var A;this.fullscreenOnMousemove({index:a,targetId:l}),(A=this.currentStage)===null||A===void 0||A.ctx.globalEventHub.emit("togglePlayStatus",l)}};this.app.view.addEventListener("touchstart",w,!1),this.cacheFunctionMap.set("touchstart",w)}},this.onRequestCancelFullscreenVideo=(o=!1)=>{var s,a;this.globalVideoSprite.texture.destroy(!1);try{this.globalVideoBackground.removeChild(this.globalVideoSprite)}catch{this.logger.error("removeChild error: PPTPlayer:1057",this.taskId)}try{this.app.stage.removeChild(this.globalVideoBackground)}catch{this.logger.error("removeChild error: PPTPlayer:1062",this.taskId)}this.globalEventHub.emit("onFullscreenChange",{status:!1,slideIndex:this.currentIndex,targetId:(s=this.currentStage)===null||s===void 0?void 0:s.ctx.latestChangeFullscreenTargetId}),this.clearFullscreenEventListenersWithAppView(),o&&this.emit(We.changeLocalFullscreenState,{status:!1,slideIndex:this.currentIndex,targetId:(a=this.currentStage)===null||a===void 0?void 0:a.ctx.latestChangeFullscreenTargetId})},this.logger=t.logger,this.tracker=t.tracker,this.mode=t.mode,this.volumeAdjuster=t.volumeAdjuster,this.localStorage=new Nr(this.logger),this.cachedExtract=new Cc(this.localStorage),this.enableWebAudio=!!mi()(t.enableWebAudio)||t.enableWebAudio,this.enableAutoForward=!mi()(t.enableAutoForward)&&t.enableAutoForward,this.config={minFPS:mi()(e.minFPS)?30:e.minFPS,maxFPS:mi()(e.maxFPS)?40:e.maxFPS,resolution:mi()(e.resolution)?1:e.resolution,autoFPS:!mi()(e.autoFPS)&&e.autoFPS,autoResolution:!mi()(e.autoResolution)&&e.autoResolution,transactionBgColor:mi()(e.transactionBgColor)?0:e.transactionBgColor,maxResolutionLevel:this.getMaxResolution(e.maxResolutionLevel),forceCanvas:!mi()(e.forceCanvas)&&e.forceCanvas,enableNvidiaDetect:!mi()(e.enableNvidiaDetect)&&e.enableNvidiaDetect,transitionResolutionLevel:this.getMaxResolution(e.transitionResolutionLevel),antialias:!!mi()(e.antialias)||e.antialias},this.updateMaxResolutionLevel(this.config.maxResolutionLevel),this.updateTransitionResolutionLevel(this.config.transitionResolutionLevel),this.loader=new AT(this.localStorage,t.useLocalCache,this.logger,this.tracker,t.resourceTimeout,t.loadDelegate,t.urlInterrupter);const n=xn.isWebGLSupported();this.app=new Vl({antialias:this.config.antialias,autoDensity:!1,backgroundColor:16777215,forceCanvas:this.config.forceCanvas||!n}),globalThis.__PIXI_APP__=this.app,this.tracker({name:"slidePlayerCreate",result:"",reason:"",payload:{webgl:n,resolution:this.config.resolution,minFPS:this.config.minFPS,maxFPS:this.config.maxFPS,maxResolutionLevel:this.config.maxResolutionLevel,forceCanvas:this.config.forceCanvas}}),this.updateConfig(this.config),this.app.ticker.maxFPS=60,this.app.ticker.minFPS=this.config.minFPS,this.app.ticker.maxFPS=this.config.maxFPS,this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const r=this.app.renderer;if(r.gl){const{drawElements:o}=r.gl,s=r.gl.getExtension("WEBGL_debug_renderer_info"),a=r.gl.getParameter(s.UNMASKED_RENDERER_WEBGL);/nvidia/i.test(a)&&this.config.enableNvidiaDetect&&(this.isNVIDIA=!0),r.gl.drawElements=(...l)=>{o.call(r.gl,...l),this.drawCall+=1}}this.fps.on("update",o=>{if(o<this.config.minFPS){if(this.config.autoResolution){const s=.7*this.scale,a=this.app.renderer.resolution,l=Math.max(s,a-.1);l>=s&&this.updateResolution(l)}}else if(o>this.config.maxFPS&&this.config.autoResolution){const s=this.scale*this.config.resolution,a=this.app.renderer.resolution,l=Math.min(s,a+.1);l<=this.config.resolution&&this.updateResolution(l)}}),this.app.ticker.add(()=>{this.runtime.drawCall=this.drawCall,this.runtime.fps=Math.floor(this.app.ticker.minFPS),this.drawCall=0},null,nr.c.LOW),this.clock=new CT(this.app.ticker),this.objPoolGroup=cs(),this.stagePool=new VS(this.loader,this.mode,this.app.renderer,this.app.ticker,this.app.view,this.clock,this.objPoolGroup,this.errorChannel,this.localStorage,this.logger,t.loadDelegate,t.urlInterrupter,this.isPlayerPaused,this.maxResolution,this.volumeAdjuster,this.config.forceCanvas,this.globalEventHub,this.enableWebAudio,t.customLinks),this.app.view.addEventListener("webglcontextlost",this.onWebGLLost);try{this.config.forceCanvas||(this.transactionPlayer=new H1)}catch(o){/Error creating WebGL context/.test(o.message)?this.errorChannel.emit("error",new Ti(Wi.CanvasCrash,"webgl context lost.")):this.errorChannel.emit("error",new Ti(Wi.RuntimeWarn,o.message))}this.globalEventHub.on("requestFullscreen",this.onRequestFullscreenVideo),this.globalEventHub.on("requestCancelFullscreen",this.onRequestCancelFullscreenVideo),this.mode==="addLink"&&this.globalEventHub.on("user-add-click",o=>{this.emit(We.useraddLink,o)}),this.enableAutoForward&&this.on(We.mainSeqStepEnd,()=>{this.startAutoForwardTimer(this.currentStage)})}getMaxResolution(t){return!mi()(t)&&Number.isInteger(t)?(t<1&&(t=1),t>4&&(t=4),t):hr.platform.isAndroid()||hr.platform.isIOS()?2:4}updateMaxResolutionLevel(t){t<0&&(t=0),t>4&&(t=4);const e=[640,960,1280,1920,3200][t],n=[360,540,720,1080,1800][t];this.maxResolution.set(e,n)}updateTransitionResolutionLevel(t){t<0&&(t=0),t>4&&(t=4);const e=[640,960,1280,1920,3200][t],n=[360,540,720,1080,1800][t];this.transitionResolution.set(e,n)}updateConfig(t){mi()(t.maxFPS)||mi()(t.minFPS)||(this.config.maxFPS=t.maxFPS,this.app.ticker.maxFPS=t.maxFPS,this.config.minFPS=t.minFPS,this.app.ticker.minFPS=t.minFPS),mi()(t.resolution)||(this.config.resolution=t.resolution,this.updateResolution(this.scale*this.config.resolution)),mi()(t.autoFPS)||(this.config.autoFPS=t.autoFPS),mi()(t.autoResolution)||(this.config.autoResolution=t.autoResolution),mi()(t.transactionBgColor)||(this.config.transactionBgColor=t.transactionBgColor),this.taskId&&this.logger.info("ppt player update config: "+JSON.stringify(this.config),this.taskId),mi()(t.maxResolutionLevel)||(this.config.maxResolutionLevel=t.maxResolutionLevel,this.updateMaxResolutionLevel(this.config.maxResolutionLevel)),mi()(t.transitionResolutionLevel)||(this.config.transitionResolutionLevel=t.transitionResolutionLevel,this.updateTransitionResolutionLevel(this.config.transitionResolutionLevel))}preload(t){return ms(this,void 0,void 0,function*(){if(t<1||t>this.slideCount)return;const e=Date.now();this.logger.info(`preload slide ${t} begin`,this.taskId),yield this.stagePool.preload(t),this.logger.info(`preload slide ${t} end`,this.taskId),this.tracker({name:"slidePreload",reason:"",result:"",payload:{duration:Date.now()-e,index:t}})})}preloadResource(t){return ms(this,void 0,void 0,function*(){if(t<1||t>this.slideCount)return;const e=Date.now();this.logger.info(`preload slide resource ${t} begin`,this.taskId),yield this.stagePool.preloadResource(t),this.logger.info(`preload slide resource ${t} end`,this.taskId),this.tracker({name:"slidePreloadResource",reason:"",result:"",payload:{duration:Date.now()-e,index:t}})})}setResourceData(t,e){this.logger.info("ppt player init config: "+JSON.stringify(this.config),t),this.logger.info("set resource to "+e,t),this.taskId=t,this.url=e,this.stagePool.setResourceData(t,e),this.localStorage.attachTaskId(t),this.loader.attachTaskId(t)}setInteractive(t){this.app.stage.interactive=t,this.app.stage.interactiveChildren=t}translateEvent(t,e){e.forEach(n=>{t.on(n,(...r)=>{var o,s,a,l;n===We.requestGotoSlide&&r[0]!==this.currentIndex&&((s=(o=this.currentStage)===null||o===void 0?void 0:o.timing)===null||s===void 0||s.setMainSeqStep(0,"start"),(l=(a=this.currentStage)===null||a===void 0?void 0:a.timing)===null||l===void 0||l.destroy()),this.emit(n,...r)})})}clearAutoForwardTimer(){this.enableAutoForward&&this.autoForwardTimer&&(this.clock.clearTimeout(this.autoForwardTimer),this.autoForwardTimer=null)}startAutoForwardTimer(t){var e;if(!this.enableAutoForward||!t)return;this.clearAutoForwardTimer();const n=(e=t.json.transition)===null||e===void 0?void 0:e.advTm;mi()(n)||(this.autoForwardTimer=this.clock.setTimeout(()=>{this.view&&this.mainSeqState()!=="running"&&(this.mainSeqHasNextStep()?this.emit(We.requestNextStep):this.currentIndex<this.slideCount?this.emit(We.requestNextSlide,!1):this.clearAutoForwardTimer())},n/(this.mainSeqLength()+1)))}renderSlide(t){var e,n,r;return ms(this,void 0,void 0,function*(){if(this.clearAutoForwardTimer(),this._isPaused)return void this.logger.info("ppt play prevent render slide with paused state",this.taskId);const o=this.currentIndex,s=Date.now();this.logger.info("render slide "+t,this.taskId),this.emit(We.renderStart,t);const a=yield this.stagePool.getStage(t),l=`snapshot-${t}-${this.isForward?"start":"end"}`,h=yield this.localStorage.getItem(l);if(!a)return;a.ctx.isRendering=!0,this.translateEvent(a.ctx.eventHub,[We.mainSeqStepChange,We.mainSeqStateChange,We.hyperlinkTrigger,We.interactiveSeqAction,We.mainSeqStepStart,We.mainSeqStepEnd,We.animateStart,We.animateEnd,We.mediaPlay,We.mediaPause,We.mediaSeek,We.mediaStop,We.requestGotoSlide,We.requestOpenUrl,We.requestNextSlide,We.requestPrevSlide,We.interactiveSeqStateChange,We.userInput,We.fullscreenChange,We.changeLocalFullscreenState]),this.currentIndex=Number(t);const{width:u,height:p,slideCount:_}=a.json;this.slideCount=_,this.designWidth=u,this.designHeight=p,(e=this.currentStage)===null||e===void 0||e.clearOnSlideChange();const x=this.currentStage;this.currentStage=a,a.initOnReuse(),a.createTiming(),a.container.visible=!0,a.collectMainSeqStartValue(),this.isForward?a.setMainSeqStep(0,"start"):a.setMainSeqStep(-1,"end"),this.onRequestCancelFullscreenVideo(!0);let w=!1;if(xn.isWebGLSupported()&&!this.config.forceCanvas&&a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&x){let{transition:A}=a.json;!this.isForward&&(x==null?void 0:x.json.transition)&&(A=x.json.transition);const C=this.getTransactionTexture(x,this.view,null,null);this.initTransactionPlayer(A),(n=this.transactionPlayer)===null||n===void 0||n.setPrevTexture(C),w=!0}if(this.app.stage.addChild(a.container),this.updateResolution(this.config.resolution*this.scale),x){x.clearOnTransactionEnd();try{this.app.stage.removeChild(x.container)}catch{this.logger.error("removeChild error: PPTPlayer:622",this.taskId)}}if(a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&this.transactionPlayer&&w){const A=yield this.getTransactionTexture(a,this.view,l,h);this.transactionPlayer.setNextTexture(A),this.tracker({name:"slidePageChangePure",reason:"",result:"",payload:{duration:Date.now()-s,from:o,to:t}}),yield this.transactionPlayer.play();const C=this.transactionPlayer.renderer.domElement;if(this.view.parentElement&&C)try{this.view.parentElement.removeChild(C)}catch{this.logger.error("removeChild error: PPTPlayer:637",this.taskId)}(r=this.transactionPlayer)===null||r===void 0||r.dispose()}this.isForward?yield a.startTiming():a.setMainSeqApplied(),a.ctx.slideScopeEventHub.emit("slide-render",a.ctx.slideIndex,this.isForward),this.emit(We.renderEnd,t),this.emit(We.slideChange,t),a.ctx.isRendering=!1,this.preload(t+1).catch(A=>{this.errorChannel.emit("error",Ti.transform(A),t+1)}),this.preload(t-1).catch(A=>{this.errorChannel.emit("error",Ti.transform(A),t-1)}),this.logger.info(`render slide ${t} done, time: ${Date.now()-s}ms`,this.taskId),this.isForward&&this.startAutoForwardTimer(a),this.tracker({name:"slidePageChange",reason:"",result:"",payload:{duration:Date.now()-s,from:o,to:t}})})}getTransactionTexture(t,e,n,r){let o=this.transitionResolution.x/t.json.width;Math.floor(t.json.height*o+1e-4)>t.json.height&&(o=this.transitionResolution.y/t.json.height),o=Math.min(1,o);const s=ue.p.create({width:t.json.width*o,height:t.json.height*o,resolution:1}),a=new Oe.d;a.scale(o,o),this.app.renderer.render(t.container,{renderTexture:s,transform:a});const l=this.cachedExtract.canvas(s,this.app.renderer,r,n);return new Q(l)}renderToBase64(t,e,n){return ms(this,void 0,void 0,function*(){const r=yield this.stagePool.getStage(t);if(r){const{width:o,height:s}=r.json;this.designWidth=o,this.designHeight=s;const a=ue.p.create({width:this.designWidth,height:this.designHeight,resolution:e});r.container.visible=!0,this.app.renderer.render(r.container,{renderTexture:a});const l=this.app.renderer.plugins.extract.base64(a,n);return this.stagePool.destroyStageByIndex(t),l}return"__null__"})}renderMainSeqToBase64(t,e,n){return ms(this,void 0,void 0,function*(){const r=[],o=yield this.stagePool.getStage(t);if(o.createTiming(),o){const{width:s,height:a}=o.json;this.designWidth=s,this.designHeight=a;const l=ue.p.create({width:this.designWidth,height:this.designHeight,resolution:e});o.container.visible=!0;const h=o.mainSeqLength();o.setMainSeqStep(0,"start"),this.app.renderer.render(o.container,{renderTexture:l});const u=this.app.renderer.plugins.extract.base64(l,n);r.push(u);for(let p=0;p<h;p+=1){o.setMainSeqStep(p,"end"),this.app.renderer.render(o.container,{renderTexture:l});const _=this.app.renderer.plugins.extract.base64(l,n);r.push(_)}}return r})}snapshotWithTimingEnd(t){return ms(this,void 0,void 0,function*(){const e=yield this.stagePool.getStage(t);if(e){const{width:n,height:r}=e.json;this.designWidth=n,this.designHeight=r;const o=ue.p.create({width:this.designWidth,height:this.designHeight,resolution:1});e.container.visible=!0,e.initOnReuse(),e.createTiming(),e.collectMainSeqStartValue(),e.setMainSeqStep(-1,"end"),this.app.renderer.render(e.container,{renderTexture:o});const s=this.app.renderer.plugins.extract.base64(o,"image/png");return t!==this.currentIndex&&this.stagePool.destroyStageByIndex(t),s}return null})}getBase64(t){if(!t.container.transform)return null;const e=ue.p.create({width:this.designWidth,height:this.designHeight,resolution:1});this.app.renderer.render(t.container,{renderTexture:e});const n=this.app.renderer.plugins.extract.base64(e,"image/jpeg");return e.destroy(!0),n}initTransactionPlayer(t){var e,n,r,o,s;const a=(e=this.view)===null||e===void 0?void 0:e.parentElement;if(this.view&&a&&pg[t.type]&&this.transactionPlayer){const l=(n=this.transactionPlayer)===null||n===void 0?void 0:n.renderer.domElement;this.transactionPlayer.initPlayer({reverse:!this.isForward,stageWidth:this.view.width,stageHeight:this.view.height,presetType:pg[t.type],duration:(o=(r=this.currentStage)===null||r===void 0?void 0:r.json.transition)===null||o===void 0?void 0:o.dur,delay:0,clearColor:this.config.transactionBgColor,maxFPS:Math.ceil((s=this.config.maxFPS)!==null&&s!==void 0?s:60),options:t.options}),l&&(l.style.position="absolute",l.style.zIndex="9",l.style.left="0",l.style.top="0",l.style.width=this.view.style.width,l.style.height=this.view.style.height),a.appendChild(l)}}scaleView(t,e,n){var r;this.view&&(this.view.style.width=Math.floor(this.designWidth*t)+"px",this.view.style.height=Math.floor(this.designHeight*t)+"px");const o=(r=this.transactionPlayer)===null||r===void 0?void 0:r.renderer.domElement;if(o&&this.view&&(o.style.width=this.view.style.width,o.style.height=this.view.style.height),e){this.scale=t;const s=this.scale*this.config.resolution;this.updateResolution(s,n)}}updateResolution(t,e){this.app.ticker.addOnce(()=>{let n=fs.isDesktop()?t:1;for(;n*this.designWidth>this.maxResolution.x||n*this.designHeight>this.maxResolution.y;)n-=.1;this.app.renderer.resolution=n,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.designWidth,this.designHeight),vx()(e)&&e()})}nextStep(t,e){var n;if(this._isPaused)this.logger.info("ppt play prevent next step with paused state",this.taskId);else{this.logger.info("ppt play trigger next step",this.taskId);try{this.onRequestCancelFullscreenVideo(!0),(n=this.currentStage)===null||n===void 0||n.nextStep(t,e)}catch(r){this.errorChannel.emit("error",Ti.transform(r),this.currentIndex)}}}prevStep(t=!1){var e;if(this._isPaused)this.logger.info("ppt play prevent prev step with paused state",this.taskId);else{this.logger.info("ppt play trigger prev step",this.taskId);try{this.clearAutoForwardTimer(),this.onRequestCancelFullscreenVideo(!0),(e=this.currentStage)===null||e===void 0||e.prevStep(t)}catch(n){this.errorChannel.emit("error",Ti.transform(n),this.currentIndex)}}}mainSeqLength(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqLength())!==null&&e!==void 0?e:0}mainSeqStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqStep())!==null&&e!==void 0?e:0}setMainSeqStep(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMainSeqStep(t,e)}mainSeqState(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqState())!==null&&e!==void 0?e:null}mainSeqHasNextStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}nextTick(t){this.app.ticker.addOnce(()=>{t()},nr.c.LOW)}applyInteractiveAction(t){var e;(e=this.currentStage)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.currentStage)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.currentStage)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){var r;return ms(this,void 0,void 0,function*(){yield(r=this.currentStage)===null||r===void 0?void 0:r.setMediaState(t,e,n)})}setMediaCurrentTime(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMediaCurrentTime(t,e)}pause(){var t;this.app.ticker.stop(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalPause()}),this._isPaused=!0}resume(){var t;this._isPaused=!1,this.app.ticker.start(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalResume()})}getSnapshot(){return this.currentStage&&this.getBase64(this.currentStage)||""}clearLocalCache(){this.localStorage.dispose()}static clearLocalCache(){var t;(t=Nr.localCache)===null||t===void 0||t.clear().catch(()=>{})}clearFullscreenEventListenersWithAppView(){["mousemove","click","mouseout","mouseover","touchstart","pointerdown"].forEach(t=>{this.cacheFunctionMap.has(t)&&(this.app.view.removeEventListener(t,this.cacheFunctionMap.get(t),!1),this.cacheFunctionMap.delete(t))})}syncFullscreenVideoState(t){this.globalEventHub.emit("syncFullscreenVideoState",t)}destroy(){var t;try{this.clearAutoForwardTimer(),this.app.view.removeEventListener("webglcontextlost",this.onWebGLLost),this.app.renderer.filter.texturePool.clear(!0),fc.collectObjectByGroup(this.objPoolGroup),WS.collectObjectByGroup(this.objPoolGroup),(t=this.transactionPlayer)===null||t===void 0||t.destroy(),this.loader.destroy(),this.fps.destroy(),this.stagePool.destroyAllStage(),this.stagePool.destroy(),this.app.renderer.gl.getExtension("WEBGL_lose_context").loseContext(),this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.tracker({name:"slidePlayerDestroy",result:"",reason:"",payload:{}})}catch{}}}hr.platform=fs,hr.RtcAudioClazz=null;var Rc=new Map,Za,YS=v(136),qS=v.n(YS),JS=v(24),wh=v.n(JS),ZS=v(50),fg=v.n(ZS),gs=[],mg="ResizeObserver loop completed with undelivered notifications.";(function(i){i.BORDER_BOX="border-box",i.CONTENT_BOX="content-box",i.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Za||(Za={}));var Ic,vs=function(i){return Object.freeze(i)},KS=function(i,t){this.inlineSize=i,this.blockSize=t,vs(this)},gg=function(){function i(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,vs(this)}return i.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},i.fromRect=function(t){return new i(t.x,t.y,t.width,t.height)},i}(),Pc=function(i){return i instanceof SVGElement&&"getBBox"in i},vg=function(i){if(Pc(i)){var t=i.getBBox(),e=t.width,n=t.height;return!e&&!n}var r=i,o=r.offsetWidth,s=r.offsetHeight;return!(o||s||i.getClientRects().length)},_g=function(i){var t;if(i instanceof Element)return!0;var e=(t=i==null?void 0:i.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(e&&i instanceof e.Element)},Ka=typeof window!="undefined"?window:{},Sh=new WeakMap,yg=/auto|scroll/,$S=/^tb|vertical/,QS=/msie|trident/i.test(Ka.navigator&&Ka.navigator.userAgent),to=function(i){return parseFloat(i||"0")},na=function(i,t,e){return i===void 0&&(i=0),t===void 0&&(t=0),e===void 0&&(e=!1),new KS((e?t:i)||0,(e?i:t)||0)},xg=vs({devicePixelContentBoxSize:na(),borderBoxSize:na(),contentBoxSize:na(),contentRect:new gg(0,0,0,0)}),bg=function(i,t){if(t===void 0&&(t=!1),Sh.has(i)&&!t)return Sh.get(i);if(vg(i))return Sh.set(i,xg),xg;var e=getComputedStyle(i),n=Pc(i)&&i.ownerSVGElement&&i.getBBox(),r=!QS&&e.boxSizing==="border-box",o=$S.test(e.writingMode||""),s=!n&&yg.test(e.overflowY||""),a=!n&&yg.test(e.overflowX||""),l=n?0:to(e.paddingTop),h=n?0:to(e.paddingRight),u=n?0:to(e.paddingBottom),p=n?0:to(e.paddingLeft),_=n?0:to(e.borderTopWidth),x=n?0:to(e.borderRightWidth),w=n?0:to(e.borderBottomWidth),A=p+h,C=l+u,G=(n?0:to(e.borderLeftWidth))+x,K=_+w,it=a?i.offsetHeight-K-i.clientHeight:0,ft=s?i.offsetWidth-G-i.clientWidth:0,nt=r?A+G:0,gt=r?C+K:0,lt=n?n.width:to(e.width)-nt-ft,dt=n?n.height:to(e.height)-gt-it,Ut=lt+A+ft+G,Ft=dt+C+it+K,Et=vs({devicePixelContentBoxSize:na(Math.round(lt*devicePixelRatio),Math.round(dt*devicePixelRatio),o),borderBoxSize:na(Ut,Ft,o),contentBoxSize:na(lt,dt,o),contentRect:new gg(p,l,lt,dt)});return Sh.set(i,Et),Et},Tg=function(i,t,e){var n=bg(i,e),r=n.borderBoxSize,o=n.contentBoxSize,s=n.devicePixelContentBoxSize;switch(t){case Za.DEVICE_PIXEL_CONTENT_BOX:return s;case Za.BORDER_BOX:return r;default:return o}},tE=function(i){var t=bg(i);this.target=i,this.contentRect=t.contentRect,this.borderBoxSize=vs([t.borderBoxSize]),this.contentBoxSize=vs([t.contentBoxSize]),this.devicePixelContentBoxSize=vs([t.devicePixelContentBoxSize])},wg=function(i){if(vg(i))return 1/0;for(var t=0,e=i.parentNode;e;)t+=1,e=e.parentNode;return t},eE=function(){var i=1/0,t=[];gs.forEach(function(r){if(r.activeTargets.length!==0){var o=[];r.activeTargets.forEach(function(s){var a=new tE(s.target),l=wg(s.target);o.push(a),s.lastReportedSize=Tg(s.target,s.observedBox),l<i&&(i=l)}),t.push(function(){r.callback.call(r.observer,o,r.observer)}),r.activeTargets.splice(0,r.activeTargets.length)}});for(var e=0,n=t;e<n.length;e++)(0,n[e])();return i},Sg=function(i){gs.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(e){e.isActive()&&(wg(e.target)>i?t.activeTargets.push(e):t.skippedTargets.push(e))})})},nE=function(){var i,t=0;for(Sg(t);gs.some(function(e){return e.activeTargets.length>0});)t=eE(),Sg(t);return gs.some(function(e){return e.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?i=new ErrorEvent("error",{message:mg}):((i=document.createEvent("Event")).initEvent("error",!1,!1),i.message=mg),window.dispatchEvent(i)),t>0},Eg=[],iE=function(i){if(!Ic){var t=0,e=document.createTextNode("");new MutationObserver(function(){return Eg.splice(0).forEach(function(n){return n()})}).observe(e,{characterData:!0}),Ic=function(){e.textContent="".concat(t?t--:t++)}}Eg.push(i),Ic()},Oc=0,rE={attributes:!0,characterData:!0,childList:!0,subtree:!0},Ag=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Mg=function(i){return i===void 0&&(i=0),Date.now()+i},Lc=!1,Nc=new(function(){function i(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return i.prototype.run=function(t){var e=this;if(t===void 0&&(t=250),!Lc){Lc=!0;var n,r=Mg(t);n=function(){var o=!1;try{o=nE()}finally{if(Lc=!1,t=r-Mg(),!Oc)return;o?e.run(1e3):t>0?e.run(t):e.start()}},iE(function(){requestAnimationFrame(n)})}},i.prototype.schedule=function(){this.stop(),this.run()},i.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,rE)};document.body?e():Ka.addEventListener("DOMContentLoaded",e)},i.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Ag.forEach(function(e){return Ka.addEventListener(e,t.listener,!0)}))},i.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),Ag.forEach(function(e){return Ka.removeEventListener(e,t.listener,!0)}),this.stopped=!0)},i}()),Cg=function(i){!Oc&&i>0&&Nc.start(),!(Oc+=i)&&Nc.stop()},oE=function(){function i(t,e){this.target=t,this.observedBox=e||Za.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return i.prototype.isActive=function(){var t,e=Tg(this.target,this.observedBox,!0);return t=this.target,Pc(t)||function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(t)||getComputedStyle(t).display!=="inline"||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},i}(),sE=function(i,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=i,this.callback=t},Eh=new WeakMap,Rg=function(i,t){for(var e=0;e<i.length;e+=1)if(i[e].target===t)return e;return-1},Ah=function(){function i(){}return i.connect=function(t,e){var n=new sE(t,e);Eh.set(t,n)},i.observe=function(t,e,n){var r=Eh.get(t),o=r.observationTargets.length===0;Rg(r.observationTargets,e)<0&&(o&&gs.push(r),r.observationTargets.push(new oE(e,n&&n.box)),Cg(1),Nc.schedule())},i.unobserve=function(t,e){var n=Eh.get(t),r=Rg(n.observationTargets,e),o=n.observationTargets.length===1;r>=0&&(o&&gs.splice(gs.indexOf(n),1),n.observationTargets.splice(r,1),Cg(-1))},i.disconnect=function(t){var e=this,n=Eh.get(t);n.observationTargets.slice().forEach(function(r){return e.unobserve(t,r.target)}),n.activeTargets.splice(0,n.activeTargets.length)},i}(),aE=function(){function i(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ah.connect(this,t)}return i.prototype.observe=function(t,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_g(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ah.observe(this,t,e)},i.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_g(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ah.unobserve(this,t)},i.prototype.disconnect=function(){Ah.disconnect(this)},i.toString=function(){return"function ResizeObserver () { [polyfill code] }"},i}(),lE=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},hE=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},uE=function(){function i(t,e,n,r,o){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=n,this.index=t,this.slideIndex=e,this.eventHub=r,this.id=o}return i.prototype.apply=function(){return lE(this,void 0,void 0,function(){var t;return hE(this,function(e){switch(e.label){case 0:this.eventHub.emit("task-start",this),e.label=1;case 1:return e.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return e.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return t=e.sent(),this.eventHub.emit("task-error",{task:this,error:t}),[3,4];case 4:return[2]}})})},i}(),cE=function(){function i(){var t=this;this.eventHub=new fi.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(e){var n,r=t.tasks.findIndex(function(s){return s.index===e.index}),o=r+1;o>=0&&((n=t.tasks[o])===null||n===void 0||n.apply()),r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask()),t.eventHub.emit("task-end-"+e.id)}),this.eventHub.on("task-error",function(e){var n=e.task,r=t.tasks.findIndex(function(o){return o.index===n.index});r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask()),t.eventHub.emit("task-error-"+n.id)})}return i.prototype.replaceIdleTask=function(){for(var t,e=this,n=new Set,r=0,o=this.tasks.length;r<o;r++)this.tasks[r].state==="idle"&&((t=this.tasks[r+1])===null||t===void 0?void 0:t.state)==="idle"&&n.add(r);Array.from(n).forEach(function(s){e.tasks.splice(s,1)})},i.prototype.addTask=function(t,e,n){var r=new uE(this.index++,e,t,this.eventHub,n);this.tasks.push(r),this.tasks.sort(function(o,s){return o.index-s.index}),this.replaceIdleTask(),this.tasks.length===1&&r.apply()},i.prototype.hasStartTask=function(){return this.tasks.some(function(t){return t.state==="start"})},i.prototype.destroy=function(){this.eventHub.removeAllListeners()},i}();function ia(i,t){var e=i.__state.conversionName.toString(),n=Math.round(i.r),r=Math.round(i.g),o=Math.round(i.b),s=i.a,a=Math.round(i.h),l=i.s.toFixed(1),h=i.v.toFixed(1);if(t||e==="THREE_CHAR_HEX"||e==="SIX_CHAR_HEX"){for(var u=i.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return e==="CSS_RGB"?"rgb("+n+","+r+","+o+")":e==="CSS_RGBA"?"rgba("+n+","+r+","+o+","+s+")":e==="HEX"?"0x"+i.hex.toString(16):e==="RGB_ARRAY"?"["+n+","+r+","+o+"]":e==="RGBA_ARRAY"?"["+n+","+r+","+o+","+s+"]":e==="RGB_OBJ"?"{r:"+n+",g:"+r+",b:"+o+"}":e==="RGBA_OBJ"?"{r:"+n+",g:"+r+",b:"+o+",a:"+s+"}":e==="HSV_OBJ"?"{h:"+a+",s:"+l+",v:"+h+"}":e==="HSVA_OBJ"?"{h:"+a+",s:"+l+",v:"+h+",a:"+s+"}":"unknown format"}var Ig=Array.prototype.forEach,$a=Array.prototype.slice,Ne={BREAK:{},extend:function(i){return this.each($a.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(i[e]=t[e])}.bind(this))},this),i},defaults:function(i){return this.each($a.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(i[e])&&(i[e]=t[e])}.bind(this))},this),i},compose:function(){var i=$a.call(arguments);return function(){for(var t=$a.call(arguments),e=i.length-1;e>=0;e--)t=[i[e].apply(this,t)];return t[0]}},each:function(i,t,e){if(i){if(Ig&&i.forEach&&i.forEach===Ig)i.forEach(t,e);else if(i.length===i.length+0){var n,r=void 0;for(r=0,n=i.length;r<n;r++)if(r in i&&t.call(e,i[r],r)===this.BREAK)return}else for(var o in i)if(t.call(e,i[o],o)===this.BREAK)return}},defer:function(i){setTimeout(i,0)},debounce:function(i,t,e){var n=void 0;return function(){var r=this,o=arguments;function s(){n=null,e||i.apply(r,o)}var a=e||!n;clearTimeout(n),n=setTimeout(s,t),a&&i.apply(r,o)}},toArray:function(i){return i.toArray?i.toArray():$a.call(i)},isUndefined:function(i){return i===void 0},isNull:function(i){return i===null},isNaN:function(i){function t(e){return i.apply(this,arguments)}return t.toString=function(){return i.toString()},t}(function(i){return isNaN(i)}),isArray:Array.isArray||function(i){return i.constructor===Array},isObject:function(i){return i===Object(i)},isNumber:function(i){return i===i+0},isString:function(i){return i===i+""},isBoolean:function(i){return i===!1||i===!0},isFunction:function(i){return i instanceof Function}},dE=[{litmus:Ne.isString,conversions:{THREE_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:ia},SIX_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9]{6})$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:ia},CSS_RGB:{read:function(i){var t=i.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:ia},CSS_RGBA:{read:function(i){var t=i.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:ia}}},{litmus:Ne.isNumber,conversions:{HEX:{read:function(i){return{space:"HEX",hex:i,conversionName:"HEX"}},write:function(i){return i.hex}}}},{litmus:Ne.isArray,conversions:{RGB_ARRAY:{read:function(i){return i.length===3&&{space:"RGB",r:i[0],g:i[1],b:i[2]}},write:function(i){return[i.r,i.g,i.b]}},RGBA_ARRAY:{read:function(i){return i.length===4&&{space:"RGB",r:i[0],g:i[1],b:i[2],a:i[3]}},write:function(i){return[i.r,i.g,i.b,i.a]}}}},{litmus:Ne.isObject,conversions:{RGBA_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b)&&Ne.isNumber(i.a))&&{space:"RGB",r:i.r,g:i.g,b:i.b,a:i.a}},write:function(i){return{r:i.r,g:i.g,b:i.b,a:i.a}}},RGB_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b))&&{space:"RGB",r:i.r,g:i.g,b:i.b}},write:function(i){return{r:i.r,g:i.g,b:i.b}}},HSVA_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v)&&Ne.isNumber(i.a))&&{space:"HSV",h:i.h,s:i.s,v:i.v,a:i.a}},write:function(i){return{h:i.h,s:i.s,v:i.v,a:i.a}}},HSV_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v))&&{space:"HSV",h:i.h,s:i.s,v:i.v}},write:function(i){return{h:i.h,s:i.s,v:i.v}}}}}],Qa=void 0,Mh=void 0,Dc=function(){Mh=!1;var i=arguments.length>1?Ne.toArray(arguments):arguments[0];return Ne.each(dE,function(t){if(t.litmus(i))return Ne.each(t.conversions,function(e,n){if(Qa=e.read(i),Mh===!1&&Qa!==!1)return Mh=Qa,Qa.conversionName=n,Qa.conversion=e,Ne.BREAK}),Ne.BREAK}),Mh},Pg=void 0,Ch={hsv_to_rgb:function(i,t,e){var n=Math.floor(i/60)%6,r=i/60-Math.floor(i/60),o=e*(1-t),s=e*(1-r*t),a=e*(1-(1-r)*t),l=[[e,a,o],[s,e,o],[o,e,a],[o,s,e],[a,o,e],[e,o,s]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(i,t,e){var n=Math.min(i,t,e),r=Math.max(i,t,e),o=r-n,s=void 0;return r===0?{h:NaN,s:0,v:0}:(s=i===r?(t-e)/o:t===r?2+(e-i)/o:4+(i-t)/o,(s/=6)<0&&(s+=1),{h:360*s,s:o/r,v:r/255})},rgb_to_hex:function(i,t,e){var n=this.hex_with_component(0,2,i);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,e)},component_from_hex:function(i,t){return i>>8*t&255},hex_with_component:function(i,t,e){return e<<(Pg=8*t)|i&~(255<<Pg)}},pE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},zr=function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")},Vr=function(){function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),Yo=function i(t,e,n){t===null&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(r===void 0){var o=Object.getPrototypeOf(t);return o===null?void 0:i(o,e,n)}if("value"in r)return r.value;var s=r.get;return s!==void 0?s.call(n):void 0},qo=function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(i,t):i.__proto__=t)},Jo=function(i,t){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?i:t},Xi=function(){function i(){if(zr(this,i),this.__state=Dc.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Vr(i,[{key:"toString",value:function(){return ia(this)}},{key:"toHexString",value:function(){return ia(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),i}();function Fc(i,t,e){Object.defineProperty(i,t,{get:function(){return this.__state.space==="RGB"||Xi.recalculateRGB(this,t,e),this.__state[t]},set:function(n){this.__state.space!=="RGB"&&(Xi.recalculateRGB(this,t,e),this.__state.space="RGB"),this.__state[t]=n}})}function Bc(i,t){Object.defineProperty(i,t,{get:function(){return this.__state.space==="HSV"||Xi.recalculateHSV(this),this.__state[t]},set:function(e){this.__state.space!=="HSV"&&(Xi.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}Xi.recalculateRGB=function(i,t,e){if(i.__state.space==="HEX")i.__state[t]=Ch.component_from_hex(i.__state.hex,e);else{if(i.__state.space!=="HSV")throw new Error("Corrupted color state");Ne.extend(i.__state,Ch.hsv_to_rgb(i.__state.h,i.__state.s,i.__state.v))}},Xi.recalculateHSV=function(i){var t=Ch.rgb_to_hsv(i.r,i.g,i.b);Ne.extend(i.__state,{s:t.s,v:t.v}),Ne.isNaN(t.h)?Ne.isUndefined(i.__state.h)&&(i.__state.h=0):i.__state.h=t.h},Xi.COMPONENTS=["r","g","b","h","s","v","hex","a"],Fc(Xi.prototype,"r",2),Fc(Xi.prototype,"g",1),Fc(Xi.prototype,"b",0),Bc(Xi.prototype,"h"),Bc(Xi.prototype,"s"),Bc(Xi.prototype,"v"),Object.defineProperty(Xi.prototype,"a",{get:function(){return this.__state.a},set:function(i){this.__state.a=i}}),Object.defineProperty(Xi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Ch.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(i){this.__state.space="HEX",this.__state.hex=i}});var _s=function(){function i(t,e){zr(this,i),this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0}return Vr(i,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),i}(),Og={};Ne.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(i,t){Ne.each(i,function(e){Og[e]=t})});var fE=/(\d+(\.\d+)?)px/;function eo(i){if(i==="0"||Ne.isUndefined(i))return 0;var t=i.match(fE);return Ne.isNull(t)?0:parseFloat(t[1])}var de={makeSelectable:function(i,t){i!==void 0&&i.style!==void 0&&(i.onselectstart=t?function(){return!1}:function(){},i.style.MozUserSelect=t?"auto":"none",i.style.KhtmlUserSelect=t?"auto":"none",i.unselectable=t?"on":"off")},makeFullscreen:function(i,t,e){var n=e,r=t;Ne.isUndefined(r)&&(r=!0),Ne.isUndefined(n)&&(n=!0),i.style.position="absolute",r&&(i.style.left=0,i.style.right=0),n&&(i.style.top=0,i.style.bottom=0)},fakeEvent:function(i,t,e,n){var r=e||{},o=Og[t];if(!o)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var a=r.x||r.clientX||0,l=r.y||r.clientY||0;s.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,a,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var h=s.initKeyboardEvent||s.initKeyEvent;Ne.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),h(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(t,r.bubbles||!1,r.cancelable||!0)}Ne.defaults(s,n),i.dispatchEvent(s)},bind:function(i,t,e,n){var r=n||!1;return i.addEventListener?i.addEventListener(t,e,r):i.attachEvent&&i.attachEvent("on"+t,e),de},unbind:function(i,t,e,n){var r=n||!1;return i.removeEventListener?i.removeEventListener(t,e,r):i.detachEvent&&i.detachEvent("on"+t,e),de},addClass:function(i,t){if(i.className===void 0)i.className=t;else if(i.className!==t){var e=i.className.split(/ +/);e.indexOf(t)===-1&&(e.push(t),i.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return de},removeClass:function(i,t){if(t)if(i.className===t)i.removeAttribute("class");else{var e=i.className.split(/ +/),n=e.indexOf(t);n!==-1&&(e.splice(n,1),i.className=e.join(" "))}else i.className=void 0;return de},hasClass:function(i,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(i.className)||!1},getWidth:function(i){var t=getComputedStyle(i);return eo(t["border-left-width"])+eo(t["border-right-width"])+eo(t["padding-left"])+eo(t["padding-right"])+eo(t.width)},getHeight:function(i){var t=getComputedStyle(i);return eo(t["border-top-width"])+eo(t["border-bottom-width"])+eo(t["padding-top"])+eo(t["padding-bottom"])+eo(t.height)},getOffset:function(i){var t=i,e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;while(t);return e},isActive:function(i){return i===document.activeElement&&(i.type||i.href)}},Lg=function(i){function t(e,n){zr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),de.bind(r.__checkbox,"change",function(){o.setValue(!o.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return qo(t,i),Vr(t,[{key:"setValue",value:function(e){var n=Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(_s),mE=function(i){function t(e,n,r){zr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r,a=o;if(o.__select=document.createElement("select"),Ne.isArray(s)){var l={};Ne.each(s,function(h){l[h]=h}),s=l}return Ne.each(s,function(h,u){var p=document.createElement("option");p.innerHTML=u,p.setAttribute("value",h),a.__select.appendChild(p)}),o.updateDisplay(),de.bind(o.__select,"change",function(){var h=this.options[this.selectedIndex].value;a.setValue(h)}),o.domElement.appendChild(o.__select),o}return qo(t,i),Vr(t,[{key:"setValue",value:function(e){var n=Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return de.isActive(this.__select)?this:(this.__select.value=this.getValue(),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(_s),gE=function(i){function t(e,n){zr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;function s(){o.setValue(o.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),de.bind(r.__input,"keyup",s),de.bind(r.__input,"change",s),de.bind(r.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),de.bind(r.__input,"keydown",function(a){a.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return qo(t,i),Vr(t,[{key:"updateDisplay",value:function(){return de.isActive(this.__input)||(this.__input.value=this.getValue()),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(_s);function Ng(i){var t=i.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var Dg=function(i){function t(e,n,r){zr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r||{};return o.__min=s.min,o.__max=s.max,o.__step=s.step,Ne.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Ng(o.__impliedStep),o}return qo(t,i),Vr(t,[{key:"setValue",value:function(e){var n=e;return this.__min!==void 0&&n<this.__min?n=this.__min:this.__max!==void 0&&n>this.__max&&(n=this.__max),this.__step!==void 0&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Ng(e),this}}]),t}(_s),Rh=function(i){function t(e,n,r){zr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));o.__truncationSuspended=!1;var s=o,a=void 0;function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function h(p){var _=a-p.clientY;s.setValue(s.getValue()+_*s.__impliedStep),a=p.clientY}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),de.bind(o.__input,"change",function(){var p=parseFloat(s.__input.value);Ne.isNaN(p)||s.setValue(p)}),de.bind(o.__input,"blur",function(){l()}),de.bind(o.__input,"mousedown",function(p){de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),a=p.clientY}),de.bind(o.__input,"keydown",function(p){p.keyCode===13&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,l())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return qo(t,i),Vr(t,[{key:"updateDisplay",value:function(){var e,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(e*r)/r),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Dg);function Fg(i,t,e,n,r){return n+(i-t)/(e-t)*(r-n)}var kc=function(i){function t(e,n,r,o,s){zr(this,t);var a=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:r,max:o,step:s})),l=a;function h(x){x.preventDefault();var w=l.__background.getBoundingClientRect();return l.setValue(Fg(x.clientX,w.left,w.right,l.__min,l.__max)),!1}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function p(x){var w=x.touches[0].clientX,A=l.__background.getBoundingClientRect();l.setValue(Fg(w,A.left,A.right,l.__min,l.__max))}function _(){de.unbind(window,"touchmove",p),de.unbind(window,"touchend",_),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),de.bind(a.__background,"mousedown",function(x){document.activeElement.blur(),de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),h(x)}),de.bind(a.__background,"touchstart",function(x){x.touches.length===1&&(de.bind(window,"touchmove",p),de.bind(window,"touchend",_),p(x))}),de.addClass(a.__background,"slider"),de.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return qo(t,i),Vr(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Dg),Bg=function(i){function t(e,n,r){zr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o;return o.__button=document.createElement("div"),o.__button.innerHTML=r===void 0?"Fire":r,de.bind(o.__button,"click",function(a){return a.preventDefault(),s.fire(),!1}),de.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return qo(t,i),Vr(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(_s),Uc=function(i){function t(e,n){zr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.__color=new Xi(r.getValue()),r.__temp=new Xi(0);var o=r;r.domElement=document.createElement("div"),de.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",de.bind(r.__input,"keydown",function(C){C.keyCode===13&&_.call(this)}),de.bind(r.__input,"blur",_),de.bind(r.__selector,"mousedown",function(){de.addClass(this,"drag").bind(window,"mouseup",function(){de.removeClass(o.__selector,"drag")})}),de.bind(r.__selector,"touchstart",function(){de.addClass(this,"drag").bind(window,"touchend",function(){de.removeClass(o.__selector,"drag")})});var s,a=document.createElement("div");function l(C){w(C),de.bind(window,"mousemove",w),de.bind(window,"touchmove",w),de.bind(window,"mouseup",u),de.bind(window,"touchend",u)}function h(C){A(C),de.bind(window,"mousemove",A),de.bind(window,"touchmove",A),de.bind(window,"mouseup",p),de.bind(window,"touchend",p)}function u(){de.unbind(window,"mousemove",w),de.unbind(window,"touchmove",w),de.unbind(window,"mouseup",u),de.unbind(window,"touchend",u),x()}function p(){de.unbind(window,"mousemove",A),de.unbind(window,"touchmove",A),de.unbind(window,"mouseup",p),de.unbind(window,"touchend",p),x()}function _(){var C=Dc(this.value);C!==!1?(o.__color.__state=C,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function x(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function w(C){C.type.indexOf("touch")===-1&&C.preventDefault();var G=o.__saturation_field.getBoundingClientRect(),K=C.touches&&C.touches[0]||C,it=K.clientX,ft=K.clientY,nt=(it-G.left)/(G.right-G.left),gt=1-(ft-G.top)/(G.bottom-G.top);return gt>1?gt=1:gt<0&&(gt=0),nt>1?nt=1:nt<0&&(nt=0),o.__color.v=gt,o.__color.s=nt,o.setValue(o.__color.toOriginal()),!1}function A(C){C.type.indexOf("touch")===-1&&C.preventDefault();var G=o.__hue_field.getBoundingClientRect(),K=1-((C.touches&&C.touches[0]||C).clientY-G.top)/(G.bottom-G.top);return K>1?K=1:K<0&&(K=0),o.__color.h=360*K,o.setValue(o.__color.toOriginal()),!1}return Ne.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Ne.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Ne.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Ne.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Ne.extend(a.style,{width:"100%",height:"100%",background:"none"}),kg(a,"top","rgba(0,0,0,0)","#000"),Ne.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(s=r.__hue_field).style.background="",s.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",s.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Ne.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),de.bind(r.__saturation_field,"mousedown",l),de.bind(r.__saturation_field,"touchstart",l),de.bind(r.__field_knob,"mousedown",l),de.bind(r.__field_knob,"touchstart",l),de.bind(r.__hue_field,"mousedown",h),de.bind(r.__hue_field,"touchstart",h),r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return qo(t,i),Vr(t,[{key:"updateDisplay",value:function(){var e=Dc(this.getValue());if(e!==!1){var n=!1;Ne.each(Xi.COMPONENTS,function(s){if(!Ne.isUndefined(e[s])&&!Ne.isUndefined(this.__color.__state[s])&&e[s]!==this.__color.__state[s])return n=!0,{}},this),n&&Ne.extend(this.__color.__state,e)}Ne.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,o=255-r;Ne.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,kg(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Ne.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(_s),vE=["-moz-","-o-","-webkit-","-ms-",""];function kg(i,t,e,n){i.style.background="",Ne.each(vE,function(r){i.style.cssText+="background: "+r+"linear-gradient("+t+", "+e+" 0%, "+n+" 100%); "})}var _E=function(i,t){var e=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=i;var r=e.getElementsByTagName("head")[0];try{r.appendChild(n)}catch{}},yE=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,xE=function(i,t){var e=i[t];return Ne.isArray(arguments[2])||Ne.isObject(arguments[2])?new mE(i,t,arguments[2]):Ne.isNumber(e)?Ne.isNumber(arguments[2])&&Ne.isNumber(arguments[3])?Ne.isNumber(arguments[4])?new kc(i,t,arguments[2],arguments[3],arguments[4]):new kc(i,t,arguments[2],arguments[3]):Ne.isNumber(arguments[4])?new Rh(i,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new Rh(i,t,{min:arguments[2],max:arguments[3]}):Ne.isString(e)?new gE(i,t):Ne.isFunction(e)?new Bg(i,t,""):Ne.isBoolean(e)?new Lg(i,t):null},bE=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){setTimeout(i,1e3/60)},TE=function(){function i(){zr(this,i),this.backgroundElement=document.createElement("div"),Ne.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),de.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Ne.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;de.bind(this.backgroundElement,"click",function(){t.hide()})}return Vr(i,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Ne.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function n(){t.domElement.style.display="none",t.backgroundElement.style.display="none",de.unbind(t.domElement,"webkitTransitionEnd",n),de.unbind(t.domElement,"transitionend",n),de.unbind(t.domElement,"oTransitionEnd",n)};de.bind(this.domElement,"webkitTransitionEnd",e),de.bind(this.domElement,"transitionend",e),de.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-de.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-de.getHeight(this.domElement)/2+"px"}}]),i}();_E(function(i){if(i&&typeof window!="undefined"){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=i,document.head.appendChild(t),i}}(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`));var tl=function(){try{return!!window.localStorage}catch{return!1}}(),Ih=void 0,Ug=!0,ra=void 0,Gc=!1,Gg=[],li=function i(t){var e=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),de.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Ne.defaults(n,{closeOnTop:!1,autoPlace:!0,width:i.DEFAULT_WIDTH}),n=Ne.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Ne.isUndefined(n.load)?n.load={preset:"Default"}:n.preset&&(n.load.preset=n.preset),Ne.isUndefined(n.parent)&&n.hideable&&Gg.push(this),n.resizable=Ne.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Ne.isUndefined(n.scrollable)&&(n.scrollable=!0);var r,o=tl&&localStorage.getItem(oa(this,"isLocal"))==="true",s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return e.parent?e.getRoot().preset:n.load.preset},set:function(u){e.parent?e.getRoot().preset=u:n.load.preset=u,function(p){for(var _=0;_<p.__preset_select.length;_++)p.__preset_select[_].value===p.preset&&(p.__preset_select.selectedIndex=_)}(this),e.revert()}},width:{get:function(){return n.width},set:function(u){n.width=u,Vc(e,u)}},name:{get:function(){return n.name},set:function(u){n.name=u,a&&(a.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(u){n.closed=u,n.closed?de.addClass(e.__ul,i.CLASS_CLOSED):de.removeClass(e.__ul,i.CLASS_CLOSED),this.onResize(),e.__closeButton&&(e.__closeButton.innerHTML=u?i.TEXT_OPEN:i.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return o},set:function(u){tl&&(o=u,u?de.bind(window,"unload",s):de.unbind(window,"unload",s),localStorage.setItem(oa(e,"isLocal"),u))}}}),Ne.isUndefined(n.parent)){if(this.closed=n.closed||!1,de.addClass(this.domElement,i.CLASS_MAIN),de.makeSelectable(this.domElement,!1),tl&&o){e.useLocalStorage=!0;var l=localStorage.getItem(oa(this,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=i.TEXT_CLOSED,de.addClass(this.__closeButton,i.CLASS_CLOSE_BUTTON),n.closeOnTop?(de.addClass(this.__closeButton,i.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(de.addClass(this.__closeButton,i.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),de.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{n.closed===void 0&&(n.closed=!0);var h=document.createTextNode(n.name);de.addClass(h,"controller-name"),a=Hc(e,h),de.addClass(this.__ul,i.CLASS_CLOSED),de.addClass(a,"title"),de.bind(a,"click",function(u){return u.preventDefault(),e.closed=!e.closed,!1}),n.closed||(this.closed=!1)}n.autoPlace&&(Ne.isUndefined(n.parent)&&(Ug&&(ra=document.createElement("div"),de.addClass(ra,"dg"),de.addClass(ra,i.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ra),Ug=!1),ra.appendChild(this.domElement),de.addClass(this.domElement,i.CLASS_AUTO_PLACE)),this.parent||Vc(e,n.width)),this.__resizeHandler=function(){e.onResizeDebounced()},de.bind(window,"resize",this.__resizeHandler),de.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),de.bind(this.__ul,"transitionend",this.__resizeHandler),de.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&SE(this),s=function(){tl&&localStorage.getItem(oa(e,"isLocal"))==="true"&&localStorage.setItem(oa(e,"gui"),JSON.stringify(e.getSaveObject()))},this.saveToLocalStorageIfPossible=s,n.parent||((r=e.getRoot()).width+=1,Ne.defer(function(){r.width-=1}))};function Hc(i,t,e){var n=document.createElement("li");return t&&n.appendChild(t),e?i.__ul.insertBefore(n,e):i.__ul.appendChild(n),i.onResize(),n}function Hg(i){de.unbind(window,"resize",i.__resizeHandler),i.saveToLocalStorageIfPossible&&de.unbind(window,"unload",i.saveToLocalStorageIfPossible)}function jc(i,t){var e=i.__preset_select[i.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function jg(i,t){var e=i.getRoot(),n=e.__rememberedObjects.indexOf(t.object);if(n!==-1){var r=e.__rememberedObjectIndecesToControllers[n];if(r===void 0&&(r={},e.__rememberedObjectIndecesToControllers[n]=r),r[t.property]=t,e.load&&e.load.remembered){var o=e.load.remembered,s=void 0;if(o[i.preset])s=o[i.preset];else{if(!o.Default)return;s=o.Default}if(s[n]&&s[n][t.property]!==void 0){var a=s[n][t.property];t.initialValue=a,t.setValue(a)}}}}function el(i,t,e,n){if(t[e]===void 0)throw new Error('Object "'+t+'" has no property "'+e+'"');var r=void 0;if(n.color)r=new Uc(t,e);else{var o=[t,e].concat(n.factoryArgs);r=xE.apply(i,o)}n.before instanceof _s&&(n.before=n.before.__li),jg(i,r),de.addClass(r.domElement,"c");var s=document.createElement("span");de.addClass(s,"property-name"),s.innerHTML=r.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(r.domElement);var l=Hc(i,a,n.before);return de.addClass(l,li.CLASS_CONTROLLER_ROW),r instanceof Uc?de.addClass(l,"color"):de.addClass(l,pE(r.getValue())),function(h,u,p){if(p.__li=u,p.__gui=h,Ne.extend(p,{options:function(w){if(arguments.length>1){var A=p.__li.nextElementSibling;return p.remove(),el(h,p.object,p.property,{before:A,factoryArgs:[Ne.toArray(arguments)]})}if(Ne.isArray(w)||Ne.isObject(w)){var C=p.__li.nextElementSibling;return p.remove(),el(h,p.object,p.property,{before:C,factoryArgs:[w]})}},name:function(w){return p.__li.firstElementChild.firstElementChild.innerHTML=w,p},listen:function(){return p.__gui.listen(p),p},remove:function(){return p.__gui.remove(p),p}}),p instanceof kc){var _=new Rh(p.object,p.property,{min:p.__min,max:p.__max,step:p.__step});Ne.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(w){var A=p[w],C=_[w];p[w]=_[w]=function(){var G=Array.prototype.slice.call(arguments);return C.apply(_,G),A.apply(p,G)}}),de.addClass(u,"has-slider"),p.domElement.insertBefore(_.domElement,p.domElement.firstElementChild)}else if(p instanceof Rh){var x=function(w){if(Ne.isNumber(p.__min)&&Ne.isNumber(p.__max)){var A=p.__li.firstElementChild.firstElementChild.innerHTML,C=p.__gui.__listening.indexOf(p)>-1;p.remove();var G=el(h,p.object,p.property,{before:p.__li.nextElementSibling,factoryArgs:[p.__min,p.__max,p.__step]});return G.name(A),C&&G.listen(),G}return w};p.min=Ne.compose(x,p.min),p.max=Ne.compose(x,p.max)}else p instanceof Lg?(de.bind(u,"click",function(){de.fakeEvent(p.__checkbox,"click")}),de.bind(p.__checkbox,"click",function(w){w.stopPropagation()})):p instanceof Bg?(de.bind(u,"click",function(){de.fakeEvent(p.__button,"click")}),de.bind(u,"mouseover",function(){de.addClass(p.__button,"hover")}),de.bind(u,"mouseout",function(){de.removeClass(p.__button,"hover")})):p instanceof Uc&&(de.addClass(u,"color"),p.updateDisplay=Ne.compose(function(w){return u.style.borderLeftColor=p.__color.toString(),w},p.updateDisplay),p.updateDisplay());p.setValue=Ne.compose(function(w){return h.getRoot().__preset_select&&p.isModified()&&jc(h.getRoot(),!0),w},p.setValue)}(i,l,r),i.__controllers.push(r),r}function oa(i,t){return document.location.href+"."+t}function zc(i,t,e){var n=document.createElement("option");n.innerHTML=t,n.value=t,i.__preset_select.appendChild(n),e&&(i.__preset_select.selectedIndex=i.__preset_select.length-1)}function zg(i,t){t.style.display=i.useLocalStorage?"block":"none"}function wE(i){var t=i.__save_row=document.createElement("li");de.addClass(i.domElement,"has-save"),i.__ul.insertBefore(t,i.__ul.firstChild),de.addClass(t,"save-row");var e=document.createElement("span");e.innerHTML="&nbsp;",de.addClass(e,"button gears");var n=document.createElement("span");n.innerHTML="Save",de.addClass(n,"button"),de.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",de.addClass(r,"button"),de.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",de.addClass(o,"button"),de.addClass(o,"revert");var s=i.__preset_select=document.createElement("select");if(i.load&&i.load.remembered?Ne.each(i.load.remembered,function(u,p){zc(i,p,p===i.preset)}):zc(i,"Default",!1),de.bind(s,"change",function(){for(var u=0;u<i.__preset_select.length;u++)i.__preset_select[u].innerHTML=i.__preset_select[u].value;i.preset=this.value}),t.appendChild(s),t.appendChild(e),t.appendChild(n),t.appendChild(r),t.appendChild(o),tl){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block",localStorage.getItem(oa(0,"isLocal"))==="true"&&l.setAttribute("checked","checked"),zg(i,a),de.bind(l,"change",function(){i.useLocalStorage=!i.useLocalStorage,zg(i,a)})}var h=document.getElementById("dg-new-constructor");de.bind(h,"keydown",function(u){!u.metaKey||u.which!==67&&u.keyCode!==67||Ih.hide()}),de.bind(e,"click",function(){h.innerHTML=JSON.stringify(i.getSaveObject(),void 0,2),Ih.show(),h.focus(),h.select()}),de.bind(n,"click",function(){i.save()}),de.bind(r,"click",function(){var u=prompt("Enter a new preset name.");u&&i.saveAs(u)}),de.bind(o,"click",function(){i.revert()})}function SE(i){var t=void 0;function e(o){return o.preventDefault(),i.width+=t-o.clientX,i.onResize(),t=o.clientX,!1}function n(){de.removeClass(i.__closeButton,li.CLASS_DRAG),de.unbind(window,"mousemove",e),de.unbind(window,"mouseup",n)}function r(o){return o.preventDefault(),t=o.clientX,de.addClass(i.__closeButton,li.CLASS_DRAG),de.bind(window,"mousemove",e),de.bind(window,"mouseup",n),!1}i.__resize_handle=document.createElement("div"),Ne.extend(i.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),de.bind(i.__resize_handle,"mousedown",r),de.bind(i.__closeButton,"mousedown",r),i.domElement.insertBefore(i.__resize_handle,i.domElement.firstElementChild)}function Vc(i,t){i.domElement.style.width=t+"px",i.__save_row&&i.autoPlace&&(i.__save_row.style.width=t+"px"),i.__closeButton&&(i.__closeButton.style.width=t+"px")}function Ph(i,t){var e={};return Ne.each(i.__rememberedObjects,function(n,r){var o={},s=i.__rememberedObjectIndecesToControllers[r];Ne.each(s,function(a,l){o[l]=t?a.initialValue:a.getValue()}),e[r]=o}),e}li.toggleHide=function(){Gc=!Gc,Ne.each(Gg,function(i){i.domElement.style.display=Gc?"none":""})},li.CLASS_AUTO_PLACE="a",li.CLASS_AUTO_PLACE_CONTAINER="ac",li.CLASS_MAIN="main",li.CLASS_CONTROLLER_ROW="cr",li.CLASS_TOO_TALL="taller-than-window",li.CLASS_CLOSED="closed",li.CLASS_CLOSE_BUTTON="close-button",li.CLASS_CLOSE_TOP="close-top",li.CLASS_CLOSE_BOTTOM="close-bottom",li.CLASS_DRAG="drag",li.DEFAULT_WIDTH=245,li.TEXT_CLOSED="Close Controls",li.TEXT_OPEN="Open Controls",li._keydownHandler=function(i){document.activeElement.type==="text"||i.which!==72&&i.keyCode!==72||li.toggleHide()},de.bind(window,"keydown",li._keydownHandler,!1),Ne.extend(li.prototype,{add:function(i,t){return el(this,i,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(i,t){return el(this,i,t,{color:!0})},remove:function(i){this.__ul.removeChild(i.__li),this.__controllers.splice(this.__controllers.indexOf(i),1);var t=this;Ne.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ra.removeChild(this.domElement);var i=this;Ne.each(this.__folders,function(t){i.removeFolder(t)}),de.unbind(window,"keydown",li._keydownHandler,!1),Hg(this)},addFolder:function(i){if(this.__folders[i]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+i+'"');var t={name:i,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[i]&&(t.closed=this.load.folders[i].closed,t.load=this.load.folders[i]);var e=new li(t);this.__folders[i]=e;var n=Hc(this,e.domElement);return de.addClass(n,"folder"),e},removeFolder:function(i){this.__ul.removeChild(i.domElement.parentElement),delete this.__folders[i.name],this.load&&this.load.folders&&this.load.folders[i.name]&&delete this.load.folders[i.name],Hg(i);var t=this;Ne.each(i.__folders,function(e){i.removeFolder(e)}),Ne.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var i=this.getRoot();if(i.scrollable){var t=de.getOffset(i.__ul).top,e=0;Ne.each(i.__ul.childNodes,function(n){i.autoPlace&&n===i.__save_row||(e+=de.getHeight(n))}),window.innerHeight-t-20<e?(de.addClass(i.domElement,li.CLASS_TOO_TALL),i.__ul.style.height=window.innerHeight-t-20+"px"):(de.removeClass(i.domElement,li.CLASS_TOO_TALL),i.__ul.style.height="auto")}i.__resize_handle&&Ne.defer(function(){i.__resize_handle.style.height=i.__ul.offsetHeight+"px"}),i.__closeButton&&(i.__closeButton.style.width=i.width+"px")},onResizeDebounced:Ne.debounce(function(){this.onResize()},50),remember:function(){if(Ne.isUndefined(Ih)&&((Ih=new TE).domElement.innerHTML=yE),this.parent)throw new Error("You can only call remember on a top level GUI.");var i=this;Ne.each(Array.prototype.slice.call(arguments),function(t){i.__rememberedObjects.length===0&&wE(i),i.__rememberedObjects.indexOf(t)===-1&&i.__rememberedObjects.push(t)}),this.autoPlace&&Vc(this,this.width)},getRoot:function(){for(var i=this;i.parent;)i=i.parent;return i},getSaveObject:function(){var i=this.load;return i.closed=this.closed,this.__rememberedObjects.length>0&&(i.preset=this.preset,i.remembered||(i.remembered={}),i.remembered[this.preset]=Ph(this)),i.folders={},Ne.each(this.__folders,function(t,e){i.folders[e]=t.getSaveObject()}),i},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Ph(this),jc(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(i){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=Ph(this,!0)),this.load.remembered[i]=Ph(this),this.preset=i,zc(this,i,!0),this.saveToLocalStorageIfPossible()},revert:function(i){Ne.each(this.__controllers,function(t){this.getRoot().load.remembered?jg(i||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Ne.each(this.__folders,function(t){t.revert(t)}),i||jc(this.getRoot(),!1)},listen:function(i){var t=this.__listening.length===0;this.__listening.push(i),t&&function e(n){n.length!==0&&bE.call(window,function(){e(n)}),Ne.each(n,function(r){r.updateDisplay()})}(this.__listening)},updateDisplay:function(){Ne.each(this.__controllers,function(i){i.updateDisplay()}),Ne.each(this.__folders,function(i){i.updateDisplay()})}});var EE=li,AE=function(){function i(t){this.player=t}return Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.player.fps.value},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawFrames",{get:function(){return this.player.runtime.fps},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"resolution",{get:function(){return this.player.config.resolution},set:function(t){this.player.updateConfig({resolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){var t,e;return((t=this.player.view)===null||t===void 0?void 0:t.width)+"*"+((e=this.player.view)===null||e===void 0?void 0:e.height)},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"minFPS",{get:function(){return this.player.config.minFPS},set:function(t){this.player.updateConfig({minFPS:t,maxFPS:this.player.config.maxFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxFPS",{get:function(){return this.player.config.maxFPS},set:function(t){this.player.updateConfig({maxFPS:t,minFPS:this.player.config.minFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoResolution",{get:function(){return this.player.config.autoResolution},set:function(t){this.player.updateConfig({autoResolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoFPS",{get:function(){return this.player.config.autoFPS},set:function(t){this.player.updateConfig({autoFPS:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"backgroundColor",{get:function(){return this.player.config.transactionBgColor},set:function(t){this.player.updateConfig({transactionBgColor:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxResolutionLevel",{get:function(){return this.player.config.maxResolutionLevel},set:function(t){this.player.updateConfig({maxResolutionLevel:t})},enumerable:!1,configurable:!0}),i}(),ME=function(){function i(t,e){var n;this.config=new AE(t),this.anchor=e,n=this.createControllerGUI(),this.gui=n[0],this.controller=n[1],this.createStats()}return i.prototype.createStats=function(){var t=this;this.stateId=setInterval(function(){t.controller.frameRate.updateDisplay(),t.controller.size.updateDisplay(),t.controller.minFPS.updateDisplay(),t.controller.drawFrames.updateDisplay(),t.controller.maxFPS.updateDisplay(),t.controller.resolution.updateDisplay(),t.controller.autoFps.updateDisplay(),t.controller.autoResolution.updateDisplay(),t.controller.drawCall.updateDisplay()},16)},i.prototype.createControllerGUI=function(){var t=new EE({autoPlace:!0,closed:!0});t.domElement.style.opacity=".6",t.domElement.style.transformOrigin="100% 0",t.domElement.style.transform="scale(1)",this.anchor.appendChild(t.domElement),t.domElement.style.position="absolute",t.domElement.style.right="0",t.domElement.style.top="0",t.domElement.style.zIndex="2";var e={frameRate:t.add(this.config,"frameRate"),drawFrames:t.add(this.config,"drawFrames"),drawCall:t.add(this.config,"drawCall"),size:t.add(this.config,"size"),minFPS:t.add(this.config,"minFPS",0,60),maxFPS:t.add(this.config,"maxFPS",0,60),resolution:t.add(this.config,"resolution",.5,8,.5),autoResolution:t.add(this.config,"autoResolution"),autoFps:t.add(this.config,"autoFPS"),maxResolutionLevel:t.add(this.config,"maxResolutionLevel",0,4,1),transactionBgColor:t.addColor(this.config,"backgroundColor")};return[t,e]},i.prototype.destroy=function(){try{window.clearInterval(this.stateId),this.anchor.removeChild(this.gui.domElement),this.gui.destroy()}catch{}},i}(),CE=function(){function i(t){var e=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){e.isScheduling=!0;var n=e.tasks.shift();n&&!e.isDestroy&&e.fn(n).finally(function(){e.tasks.length>0?window.requestAnimationFrame(e.schedule):e.isScheduling=!1})},this.fn=t}return i.prototype.destroy=function(){this.isDestroy=!0},i.prototype.addTask=function(t){this.tasks.push(t),this.isScheduling||this.schedule()},i}(),RE=function(){function i(t){this.autoUnlock=Object.create(null),this.locks=Object.create(null),this.available=!1,this.available=t}return i.prototype.addLock=function(t,e){var n=this;this.available&&(this.locks[t]=e,this.autoUnlock[t]=window.setTimeout(function(){delete n.locks[t]},3e3))},i.prototype.unlock=function(t,e){this.available&&e&&this.locks[t]&&this.locks[t]===e&&(window.clearTimeout(this.autoUnlock[t]),delete this.locks[t])},i.prototype.isLocked=function(t){return!!this.available&&!!this.locks[t]},i}(),IE=function(){function i(){var t=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){t.isScheduling=!0;var e=t.tasks.shift();e&&!t.isDestroy&&(e.status="running",e.fn.apply(null).then(function(){t.tasks.length>0?setTimeout(t.schedule):t.isScheduling=!1}).catch(function(){t.tasks.length>0?setTimeout(t.schedule):t.isScheduling=!1}))}}return i.prototype.getRunningTask=function(){return this.tasks[0]&&this.tasks[0].status==="running"?this.tasks[0]:null},i.prototype.addTask=function(t,e){var n={type:t,status:"wait",fn:e},r=this.getRunningTask();r&&t===r.type||(this.tasks=this.tasks.filter(function(o){return o.type!==t}),this.tasks.push(n),this.isScheduling||this.schedule())},i.prototype.destroy=function(){this.isDestroy=!0},i}(),Wc=function(){return(Wc=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}).apply(this,arguments)},go=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},vo=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},PE=function(){function i(){var t=this;this.logList=[],this.checkTimer=null,this.retryTimes=0,this.enable=!1,this.db=null,this.useIndexedDB=!1,this.DB_NAME="__slide_logs_report__",this.STORE_NAME="logs",this.BATCH_SIZE=1e3,this.uploadLoggerGlobalEvent=function(e){e.data.type==="@slide/_upload_log_"&&t.start()},this.config={checkTime:5e3,buffer:300},window.addEventListener("message",this.uploadLoggerGlobalEvent),this.initIndexedDB()}return i.prototype.initIndexedDB=function(){return go(this,void 0,void 0,function(){var t,e=this;return vo(this,function(n){if(!("indexedDB"in window))return this.useIndexedDB=!1,this.start(),[2];try{(t=indexedDB.open(this.DB_NAME,1)).onerror=function(){e.useIndexedDB=!1},t.onsuccess=function(){e.start(),e.db=t.result,e.useIndexedDB=!0},t.onupgradeneeded=function(r){var o=r.target.result;o.objectStoreNames.contains(e.STORE_NAME)||o.createObjectStore(e.STORE_NAME,{keyPath:"id",autoIncrement:!0}).createIndex("timestamp","timestamp")}}catch{this.useIndexedDB=!1}return[2]})})},i.prototype.storeLogInIndexedDB=function(t){return go(this,void 0,void 0,function(){var e,n=this;return vo(this,function(r){switch(r.label){case 0:if(!this.useIndexedDB)return[2];r.label=1;case 1:return r.trys.push([1,4,,5]),this.db&&this.isDatabaseHealthy()?[3,3]:[4,this.recreateDatabase()];case 2:if(r.sent(),!this.db||!this.useIndexedDB)throw new Error("Database not available after recreation attempt");r.label=3;case 3:return[2,new Promise(function(o,s){var a=n.db.transaction([n.STORE_NAME],"readwrite"),l=a.objectStore(n.STORE_NAME).add(t);a.onerror=function(){n.recreateDatabase().then(function(){if(n.db&&n.useIndexedDB){var h=n.db.transaction([n.STORE_NAME],"readwrite").objectStore(n.STORE_NAME).add(t);h.onsuccess=function(){return o()},h.onerror=function(){return s(h.error)}}else s(new Error("Database recreation failed"))}).catch(function(h){console.warn("Database recreation failed:",h),n.useIndexedDB=!1,s(h)})},l.onsuccess=function(){return o()},l.onerror=function(){var h,u;((h=l.error)===null||h===void 0?void 0:h.name)==="UnknownError"||((u=l.error)===null||u===void 0?void 0:u.name)==="NotFoundError"?n.recreateDatabase().catch(function(p){console.warn("Database recreation failed:",p),n.useIndexedDB=!1}).finally(function(){return s(l.error)}):s(l.error)}})];case 4:throw e=r.sent(),this.useIndexedDB=!1,e;case 5:return[2]}})})},i.prototype.getLogsFromIndexedDB=function(t){return go(this,void 0,void 0,function(){var e=this;return vo(this,function(n){switch(n.label){case 0:if(!this.useIndexedDB)return[2,[]];n.label=1;case 1:return n.trys.push([1,4,,5]),this.db&&this.isDatabaseHealthy()?[3,3]:[4,this.recreateDatabase()];case 2:if(n.sent(),!this.db||!this.useIndexedDB)return[2,[]];n.label=3;case 3:return[2,new Promise(function(r,o){var s=e.db.transaction([e.STORE_NAME],"readonly"),a=s.objectStore(e.STORE_NAME).index("timestamp").openCursor(null,"next"),l=[];s.onerror=function(){var h,u;((h=s.error)===null||h===void 0?void 0:h.name)==="UnknownError"||((u=s.error)===null||u===void 0?void 0:u.name)==="NotFoundError"?e.recreateDatabase().catch(function(p){console.warn("Database recreation failed:",p),e.useIndexedDB=!1}).finally(function(){return r([])}):o(s.error)},a.onsuccess=function(h){var u=h.target.result;u&&l.length<t?(l.push(u.value),u.continue()):r(l.map(function(p){var _;return Wc(Wc({},p),{id:(_=p.id)===null||_===void 0?void 0:_.toString()})}))},a.onerror=function(){var h,u;((h=a.error)===null||h===void 0?void 0:h.name)==="UnknownError"||((u=a.error)===null||u===void 0?void 0:u.name)==="NotFoundError"?e.recreateDatabase().catch(function(p){console.warn("Database recreation failed:",p),e.useIndexedDB=!1}).finally(function(){return r([])}):o(a.error)}})];case 4:return n.sent(),this.useIndexedDB=!1,[2,[]];case 5:return[2]}})})},i.prototype.deleteLogsFromIndexedDB=function(t){return go(this,void 0,void 0,function(){var e=this;return vo(this,function(n){switch(n.label){case 0:if(!this.useIndexedDB||t.length===0)return[2];n.label=1;case 1:return n.trys.push([1,4,,5]),this.db&&this.isDatabaseHealthy()?[3,3]:[4,this.recreateDatabase()];case 2:if(n.sent(),!this.db||!this.useIndexedDB)return[2];n.label=3;case 3:return[2,new Promise(function(r,o){var s=e.db.transaction([e.STORE_NAME],"readwrite"),a=s.objectStore(e.STORE_NAME),l=t.map(function(h){return new Promise(function(u,p){var _=Number(h.id);if(_){var x=a.delete(_);x.onsuccess=function(){return u()},x.onerror=function(){var w,A;((w=x.error)===null||w===void 0?void 0:w.name)==="UnknownError"||((A=x.error)===null||A===void 0?void 0:A.name)==="NotFoundError"?u():p(x.error)}}else u()})});s.onerror=function(){var h,u;((h=s.error)===null||h===void 0?void 0:h.name)==="UnknownError"||((u=s.error)===null||u===void 0?void 0:u.name)==="NotFoundError"?e.recreateDatabase().catch(function(p){console.warn("Database recreation failed:",p),e.useIndexedDB=!1}).finally(function(){return r()}):o(s.error)},Promise.all(l).then(function(){return r()}).catch(o)})];case 4:return n.sent(),this.useIndexedDB=!1,[3,5];case 5:return[2]}})})},i.prototype.start=function(){return go(this,void 0,void 0,function(){var t=this;return vo(this,function(e){return clearInterval(this.checkTimer),this.checkTimer=setInterval(function(){return go(t,void 0,void 0,function(){return vo(this,function(n){switch(n.label){case 0:return[4,this.uploadLog()];case 1:return n.sent(),[2]}})})},this.config.checkTime),[2]})})},i.prototype.pause=function(){clearInterval(this.checkTimer)},i.prototype.addLog=function(t,e,n,r){return go(this,void 0,void 0,function(){var o;return vo(this,function(s){switch(s.label){case 0:if(o={level:e,taskId:n,message:t,randomId:r,timestamp:Date.now().toString()},!this.useIndexedDB)return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.storeLogInIndexedDB(o)];case 2:return s.sent(),[3,4];case 3:return s.sent(),this.logList.push(o),[3,4];case 4:return[3,6];case 5:this.logList.push(o),s.label=6;case 6:return[2]}})})},i.prototype.isDatabaseHealthy=function(){if(!this.db)return!1;try{return this.db.transaction([this.STORE_NAME],"readonly").objectStore(this.STORE_NAME).index("timestamp"),!0}catch(t){return console.warn("Database health check failed:",t),!1}},i.prototype.recreateDatabase=function(){return go(this,void 0,void 0,function(){var t=this;return vo(this,function(e){return[2,new Promise(function(n,r){try{t.db&&(t.db.close(),t.db=null);var o=indexedDB.open(t.DB_NAME,1);o.onerror=function(){t.useIndexedDB=!1,r(o.error)},o.onsuccess=function(){t.db=o.result,t.useIndexedDB=!0,n()},o.onupgradeneeded=function(s){var a=s.target.result;a.objectStoreNames.contains(t.STORE_NAME)||a.createObjectStore(t.STORE_NAME,{keyPath:"id",autoIncrement:!0}).createIndex("timestamp","timestamp")}}catch(s){t.useIndexedDB=!1,r(s)}})]})})},i.prototype.destroy=function(){clearInterval(this.checkTimer),window.removeEventListener("message",this.uploadLoggerGlobalEvent),this.db&&(this.db.close(),this.db=null)},i.prototype.uploadLog=function(t){return t===void 0&&(t=!1),go(this,void 0,void 0,function(){var e,n,r,o=this;return vo(this,function(s){switch(s.label){case 0:return e=[],this.useIndexedDB?[4,this.getLogsFromIndexedDB(this.BATCH_SIZE)]:[3,2];case 1:return(e=s.sent()).length===0?[2]:[3,3];case 2:if(!(this.logList.length>=this.config.buffer||t))return[2];e=this.logList.splice(0),s.label=3;case 3:n=function(){o.useIndexedDB||(o.logList=e.concat(o.logList)),o.retryTimes>3&&o.pause(),o.retryTimes+=1},s.label=4;case 4:return s.trys.push([4,10,,11]),[4,fetch("https://netless-ppt-plugin-dev.cn-hangzhou.log.aliyuncs.com/logstores/netless-ppt-plugin-dev/track",{method:"POST",headers:{"x-log-apiversion":"0.6.0","Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({__topic__:"netless-ppt-plugin-dev",__source__:"netless-ppt-plugin-dev",__logs__:e})})];case 5:return s.sent().ok?(this.retryTimes=0,this.useIndexedDB?[4,this.deleteLogsFromIndexedDB(e)]:[3,7]):[3,8];case 6:s.sent(),s.label=7;case 7:return[3,9];case 8:n(),s.label=9;case 9:return[3,11];case 10:return r=s.sent(),console.warn(r),n(),[3,11];case 11:return[2]}})})},i.prototype.setEnable=function(t){this.enable!==t&&(t?this.start():this.pause())},i}(),OE=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},LE=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}};function NE(i,t,e,n,r){return OE(this,void 0,void 0,function(){var o,s,a,l,h,u;return LE(this,function(p){switch(p.label){case 0:return o=document.createElement("div"),(s=new no({anchor:o,renderOptions:{minFPS:1,maxFPS:1,resolution:1,maxResolutionLevel:e,forceCanvas:!0},mode:"local",interactive:!1,useLocalCache:!0})).setResource(i,t),[4,s.getSlideCountAsync()];case 1:a=p.sent(),p.label=2;case 2:if(p.trys.push([2,12,13,14]),!(r&&r.length>0))return[3,7];l=r.filter(function(_,x){return r.indexOf(_)===x}),u=0,p.label=3;case 3:return u<l.length?(h=l[u])>0&&h<=a?[4,s.player.stagePool.preload(h,!0)]:[3,5]:[3,6];case 4:p.sent(),n(Math.round((u+1)/l.length*100)/100),p.label=5;case 5:return u++,[3,3];case 6:return[3,11];case 7:u=1,p.label=8;case 8:return u<=a?[4,s.player.stagePool.preload(u,!0)]:[3,11];case 9:p.sent(),n(Math.round(u/a*100)/100),p.label=10;case 10:return u++,[3,8];case 11:return[3,14];case 12:throw p.sent();case 13:return s.destroy(),[7];case 14:return[2]}})})}var DE=function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])})(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ys=function(){return(ys=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}).apply(this,arguments)},FE=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Yi=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},qi=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},BE=window.ResizeObserver||aE,Oh=function(i){return new Promise(function(t){return setTimeout(t,i)})};function kE(i,t){return Yi(this,void 0,void 0,function(){var e;return qi(this,function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return!i()&&Date.now()-e<t?[4,Oh(50)]:[3,3];case 2:return n.sent(),e=Date.now(),[3,1];case 3:return[2]}})})}var or={syncDispatch:"syncDispatch",syncReceive:"syncReceive",syncEventLag:"syncEventLag",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd",stateChange:"stateChange",slideStepEnd:"slideEnd",slideStepStart:"slideStart",useraddLink:"useraddLink"},Vg={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,mediaState:Object.create(null),interactiveSeqState:Object.create(null)},Xc="";try{Xc="1.4.38"}catch{Xc="-dev-"}var fr=null;try{(fr=M.createInstance({name:"__slide_local_log__",driver:M.INDEXEDDB,version:1})).ready(function(i){}).catch(function(i){})}catch{}navigator.userAgent.toUpperCase().includes("HUAWEI")&&document.createElement("canvas").getContext("2d").fillText("\u9065\u9065\u9886\u5148",0,10);var no=function(i){function t(r){var o=i.call(this)||this;return o.iosResetCache=[],o.version=Xc,o.__slideState=fg()(Vg),o.userInputTime=0,o.isSyncingSlideState=!1,o.frozenTaskManager=new IE,o.randomId=R(),o.resize=!1,o.isAnimating=!1,o.renderingTaskManager=new cE,o.isLoading=!1,o.interactive=!0,o.renderingIndex=0,o.frameWidth=1,o.frameHeight=1,o.frame=document.createElement("div"),o.canvasContainer=document.createElement("div"),o.medianController=document.createElement("div"),o.frameResizeObserver=new BE(function(){return o.frameResizeHandler()}),o.timestamp=function(){return Date.now()},o.mode="local",o.enableGlobalClick=!1,o.lastEmitedState=null,o.playerController=null,o.isInitResized=!1,o.cacheImage=document.createElement("img"),o.isTouchStart=!1,o.touchStartId=void 0,o.taskId="",o.volumeAdjuster=new dg,o.designWidth=0,o.designHeight=0,o._slideCount=0,o._dispatchIncrId=0,o._receiveIncrId=0,o.resizeView=wh()(o._resizeView.bind(o),50),o.handleViewClick=wh()(o._handleViewClick.bind(o),300,{leading:!0}),o.resourceList=[],o._updateVolumeByStaticAdjuster=function(s){o.volumeAdjuster.volume=s},o.recoverHandler=function(s){if(s.data.type==="@slide/_recover_"&&s.data.slideId===o.randomId){var a=s.data,l=a.recoverBy,h=a.payload;if(!h)return;l==="renderOtherPage"&&h.slideIndex?o.doRenderSlide(h.slideIndex).catch(function(u){o.logger.error(u,o.taskId)}):l==="reloadCurrentPage"&&o.doRenderSlide(o.renderingIndex).catch(function(u){o.logger.error(u,o.taskId)})}},o.urlInterrupter=function(s){return Yi(o,void 0,void 0,function(){var a,l;return qi(this,function(h){return a=s,this.resourceList.length>0&&(l=s.replace(/^.*__internal__/,""),a=this.resourceList.find(function(u){return u.indexOf(l)>=0})||s),this.config.urlInterrupter?[2,this.config.urlInterrupter(a)]:[2,Promise.resolve(a)]})})},o.userInputHandle=function(){o.userInputTime=Date.now()},o.handleViewTouchStart=function(){window.clearTimeout(o.touchStartId),o.isTouchStart=!0,o.touchStartId=setTimeout(function(){o.isTouchStart=!1},350)},o.handleViewTouchEnd=function(){o.isTouchStart&&(o.isTouchStart=!1,o.handleViewClick())},o.handleSlideRef=function(){console.log(o),window.__slide=o},o.updateStageCountLimit=function(s){var a=Number(s.detail.value);a>0&&Number.isInteger(a)&&(t.__stageCountLimit=a)},o.receiveSyncHandler=function(s){return Yi(o,void 0,void 0,function(){var a,l,h,u,p,_=this;return qi(this,function(x){switch(x.label){case 0:return fo()(s.incrId)&&(s.incrId&&s.incrId-this._receiveIncrId!=1&&this.emit(or.syncEventLag),this._receiveIncrId=s.incrId||0),this.logger.info("sync receive "+JSON.stringify(s),this.taskId),s.type!=="nextStep"?[3,1]:(this.mainSeqStep!==s.next-1&&this.mainSeqStep+1!==this.mainSeqLength&&this.player?(this.setMainSeqStep(s.next,"start"),this.player.nextTick(function(){_.doNextStep(!0,s.clientId||"")})):this.doNextStep(!0,s.clientId||""),[3,6]);case 1:return s.type!=="prevStep"?[3,2]:(this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===s.next+1||this.mainSeqStep+1===this.mainSeqLength?this.doPrevStep(!0):(this.setMainSeqStep(s.next+1,"start"),(a=this.player)===null||a===void 0||a.nextTick(function(){_.doPrevStep(!0)})),[3,6]);case 2:return s.type!=="interactiveAnim"?[3,3]:(this.player?this.player.applyInteractiveAction(s.action):this.__slideState.interactiveSeqState[s.seqId]?this.__slideState.interactiveSeqState[s.seqId].step+=1:this.__slideState.interactiveSeqState[s.seqId]={step:0,state:"end"},[3,6]);case 3:return s.type!=="renderSlide"?[3,5]:[4,this.doRenderSlide(s.index,s.isForward)];case 4:return x.sent(),[3,6];case 5:s.type==="mediaPlay"?((l=this.player)===null||l===void 0||l.setMediaState(s.id,!0),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaPause"?((h=this.player)===null||h===void 0||h.setMediaState(s.id,!1),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaSeek"?((u=this.player)===null||u===void 0||u.setMediaCurrentTime(s.id,s.time),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaFullscreen"&&(s.targetId&&this.__slideState.mediaState[s.targetId]?this.__slideState.mediaState[s.targetId].fullscreen=s.state:this.__slideState.mediaState[s.targetId]={fullscreen:s.state,type:"pause",time:0},(p=this.player)===null||p===void 0||p.syncFullscreenVideoState({targetId:s.targetId,state:s.state,slideIndex:s.slideIndex})),x.label=6;case 6:return[2]}})})},o.flushDebounce=function(){o.resizeView.flush(),o.handleViewClick.flush()},o.handlePrevSlide=function(s){return s===void 0&&(s=!1),Yi(o,void 0,void 0,function(){var a,l;return qi(this,function(h){return this.player?((a=this.player.prevSlideIndex)>=1&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!1):this.renderSlide(a,!1)),[2]):[2]})})},o.handleNextSlide=function(s){return s===void 0&&(s=!1),Yi(o,void 0,void 0,function(){var a,l;return qi(this,function(h){return this.player?((a=this.player.nextSlideIndex)<=this.slideCount&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!0):this.renderSlide(a,!0)),[2]):[2]})})},o.handleGotoSlide=function(s){if(s<=o.slideCount&&s>=1){var a=o.slideState.currentSlideIndex<=s;o.renderSlide(s,a)}else s===-1&&o.renderSlide(o.slideCount,!0)},t.instances.push(o),o.config=o.initSlideConfig(r),o.tracker=function(s){r.whiteTracker&&r.whiteTracker.commit({name:s.name,reason:s.reason,result:s.result,payload:ys(ys({},s.payload),{slideId:o.randomId,taskId:o.taskId})},{slideVersion:o.version||""})},t.trackLogger.setEnable(!!o.config.enableTracking),o.logger={info:function(s,a){var l;t.appendLogString("INFO - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"info",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.info;h&&h("["+a+"] "+s)},warn:function(s,a){var l;t.appendLogString("WARN - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"warn",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.warn;h&&h("["+a+"] "+s)},error:function(s,a){var l;t.appendLogString("ERROR - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"error",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.error;h&&h("["+a+"] "+s)}},o.logger.info("new slide with clientId: "+o.config.clientId+", version: "+o.version,o.taskId),o.tracker({name:"initSlide",result:"",reason:"",payload:{taskId:o.taskId}}),o.anchor=o.config.anchor,o.syncQueue=new CE(o.receiveSyncHandler),o.lock=new RE(o.mode==="interactive"),o.cacheImage.style.position="absolute",o.cacheImage.style.display="block",o.cacheImage.style.zIndex="100",o.setMedianControllerAttribute(),o.canvasContainer.style.position="relative",o.canvasContainer.style.fontSize="0",o.canvasContainer.appendChild(o.medianController),o.frame.appendChild(o.canvasContainer),o.frame.appendChild(o.cacheImage),o.frameResizeObserver.observe(o.frame),o.on(or.syncReceive,function(s){o.lock.unlock(s.type,s.uuid),!o.player&&o.config.skipActionWhenFrozen||o.mode==="sync"&&o.config.clientId===s.clientId||o.syncQueue.addTask(s)}),o.renderingTaskManager.eventHub.on("task-error",function(s){var a=s.error,l=s.task,h=Ti.transform(a);h.errorType===Wi.RuntimeWarn?o.logger.warn(h.message,o.taskId):o.logger.error(h.message,o.taskId),o.isLoading=!1,o.reportError(h,l.slideIndex)}),window.addEventListener("__slide_ref__",o.handleSlideRef),window.addEventListener("__slide_updateStageCountLimit",o.updateStageCountLimit),o.resizeView=wh()(o.resizeView.bind(o),50),o.player=o.initPlayer(o.config),o.config.controller&&o.createController(),o.player.view&&o.canvasContainer.appendChild(o.player.view),o.handleViewClick=wh()(o.handleViewClick,300),o.player.errorChannel.on("error",function(s,a){var l=Ti.transform(s);l.errorType===Wi.RuntimeWarn?o.logger.warn(l.message,o.taskId):o.logger.error(l.message,o.taskId),o.isLoading=!1,o.reportError(s,a),o.tracker({name:"slideError",reason:l.errorMsg,result:"",payload:{code:l.errorType}})}),window.addEventListener("message",o.recoverHandler),t.volumeAdjuster.on("update",o._updateVolumeByStaticAdjuster),o.volumeAdjuster.volume=t.volumeAdjuster.volume,o}var e,n;return DE(t,i),t.flushLog=function(r){return r===void 0&&(r=!1),Yi(this,void 0,void 0,function(){return qi(this,function(o){switch(o.label){case 0:if(!(t._tempLog.length>131072||r&&t._tempLog.length>0))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fr==null?void 0:fr.setItem("run_time_log_"+t._tempLogIndex,t._tempLog)];case 2:return o.sent(),[3,4];case 3:return o.sent(),[3,4];case 4:t._tempLog="",t._tempLogIndex+=1,o.label=5;case 5:return[2]}})})},t.stopRemoteLog=function(){t.remoteLogAddress=null},t.startRemoteLog=function(r){return Yi(this,void 0,void 0,function(){var o,s,a,l,h;return qi(this,function(u){switch(u.label){case 0:return t.remoteLogAddress=r,[4,t.flushLog(!0)];case 1:if(u.sent(),!fr)return[3,13];o=[],u.label=2;case 2:return u.trys.push([2,4,,5]),[4,fr.keys()];case 3:return o=(u.sent()||[]).sort(function(p,_){return parseInt(p.replace("run_time_log_",""))-parseInt(_.replace("run_time_log_",""))}),[3,5];case 4:return u.sent(),[3,5];case 5:s=0,a=o,u.label=6;case 6:if(!(s<a.length))return[3,13];l=a[s],l.replace("run_time_log_",""),h="",u.label=7;case 7:return u.trys.push([7,9,,10]),[4,fr.getItem(l)];case 8:return h=u.sent()||"",[3,10];case 9:return u.sent(),[3,10];case 10:return[4,fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:h})})];case 11:u.sent(),u.label=12;case 12:return s++,[3,6];case 13:return[2]}})})},t.appendLogString=function(r){t._tempLog+=r,t.remoteLogAddress&&fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:r})}).catch(function(){})},t.setStageCountLimit=function(r){if(!fo()(r)||!Number.isInteger(r))throw new Error("Invalid stage count limit");t.__stageCountLimit=r},Object.defineProperty(t.prototype,"dispatchIncrId",{get:function(){return this._dispatchIncrId++},enumerable:!1,configurable:!0}),t.prototype.reportError=function(r,o){this.emit(or.renderError,{error:r,index:o}),window.postMessage({type:"@slide/_error_",errorType:r.errorType,errorMsg:r.errorMsg,slideId:this.randomId,slideIndex:o||-1,customMessage:"@slide/_error_"},"*"),t.trackLogger.uploadLog(!0)},t.prototype.initSlideConfig=function(r){return r.timestamp&&(this.timestamp=r.timestamp),r.rtcAudio&&(hr.RtcAudioClazz=r.rtcAudio),r.enableWebAudio!==!1&&(r.enableWebAudio=!0),this.mode=r.mode,this.anchor=r.anchor,this.anchor.appendChild(this.frame),this.enableGlobalClick=!mi()(r.enableGlobalClick)&&r.enableGlobalClick,this.resize=r.resize||!1,this.interactive=r.interactive,this.frame.style.cssText=r.fixedFrameSize?"width:"+r.fixedFrameSize.width+"px;height:"+r.fixedFrameSize.height+"px;":"width:100%;height:100%",this.frame.style.cssText+="display:flex;justify-content:center;align-items:center;visibility:hidden;position:relative;z-index:1;",r.fixedFrameSize&&(this.frameWidth=r.fixedFrameSize.width,this.frameHeight=r.fixedFrameSize.height),r},t.prototype.initPlayer=function(r){var o,s,a,l=this,h=new hr({mode:this.mode,useLocalCache:!!mi()(this.config.useLocalCache)||this.config.useLocalCache,logger:this.logger,resourceTimeout:mi()(this.config.resourceTimeout)?15e3:this.config.resourceTimeout,loadDelegate:this.config.loaderDelegate,volumeAdjuster:this.volumeAdjuster,urlInterrupter:this.urlInterrupter,tracker:this.tracker,enableWebAudio:this.config.enableWebAudio,enableAutoForward:this.config.enableAutoForward,customLinks:this.config.customLinks},r.renderOptions);return h.setInteractive(this.interactive),h.updateConfig(r.renderOptions||{}),h.on(We.renderStart,function(u){l.isLoading=!0,l.emit(or.renderStart,u),window.postMessage({type:"@slide/_render_start_",taskId:l.taskId,index:u},"*")}),h.on(We.renderEnd,function(u){l.isLoading=!1,l.player&&(l.designHeight=l.player.designHeight,l.designWidth=l.player.designWidth,l.cacheImage.style.width=l.player.designWidth+"px",l.cacheImage.style.height=l.player.designHeight+"px",l.cacheImage.style.maxWidth=l.player.designWidth+"px",l.cacheImage.style.minWidth=l.player.designHeight+"px",l._slideCount=l.player.slideCount),l.emit(or.renderEnd,u),window.postMessage({type:"@slide/_render_end_",taskId:l.taskId,index:u},"*")}),h.on(We.slideChange,function(u){l.__slideState.currentSlideIndex=u,l.emitStateChange(),l.emit(or.slideChange,u)}),h.on(We.mainSeqStateChange,function(u){l.__slideState.mainSeqState=u,l.emitStateChange()}),h.on(We.mainSeqStepChange,function(u){l.__slideState.mainSeqStep=u,l.emitStateChange()}),h.on(We.interactiveSeqStateChange,function(u){var p=u.id,_=u.state;l.__slideState.interactiveSeqState[p]=_,l.emitStateChange()}),h.on(We.animateStart,function(){l.isAnimating!==!0&&(l.isAnimating=!0,l.emit(or.animateStart))}),h.on(We.animateEnd,function(){l.isAnimating!==!1&&(l.isAnimating=!1,l.emit(or.animateEnd))}),h.on(We.interactiveSeqAction,function(u){var p=u.action,_=u.seqId;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"interactiveAnim",action:p,seqId:_}),l.emitStateChange()}),h.on(We.mainSeqStepStart,function(u){l.emit(or.mainSeqStepStart,u)}),h.on(We.mainSeqStepEnd,function(u){l.emit(or.mainSeqStepEnd,u)}),h.on(We.mediaPlay,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};_.type="play",_.time=l.timestamp()-1e3*u.time,l.__slideState.mediaState[u.id]=_,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:_}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:_}),l.emitStateChange()}),h.on(We.mediaStop,function(u){delete l.__slideState.mediaState[u.id],l.emitStateChange()}),h.on(We.mediaPause,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};_.type="pause",_.time=u.time,l.__slideState.mediaState[u.id]=_,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:_}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:_}),l.emitStateChange()}),h.on(We.mediaSeek,function(u){var p,_=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};u.isPlaying?(_.type="play",_.time=l.timestamp()-1e3*u.time):(_.type="pause",_.time=u.time),l.__slideState.mediaState[u.id]=_,l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaSeek",id:u.id,time:u.time,state:_}),l.emitStateChange()}),h.on(We.requestNextStep,function(){l.nextStep()}),h.on(We.requestPrevSlide,function(u){l.handlePrevSlide(u)}),h.on(We.requestNextSlide,function(u){l.handleNextSlide(u)}),h.on(We.useraddLink,function(u){l.emit(or.useraddLink,l.taskId,l.renderingIndex,u)}),h.on(We.requestGotoSlide,function(u){var p;!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.gotoPage?l.config.navigatorDelegate.gotoPage(u):l.handleGotoSlide(u)}),h.on(We.requestOpenUrl,function(u){var p;!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.openUrl&&l.config.navigatorDelegate.openUrl(u)}),h.on(We.fullscreenChange,function(u){var p,_=u.targetId,x=u.state;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaFullscreen",targetId:_,state:x});var w=(p=l.__slideState.mediaState[_])!==null&&p!==void 0?p:{};w.fullscreen=x,l.__slideState.mediaState[_]=w,l.emitStateChange()}),h.on(We.changeLocalFullscreenState,function(u){u.slideIndex===l.__slideState.currentSlideIndex?(u.targetId&&l.__slideState.mediaState[u.targetId]&&(l.__slideState.mediaState[u.targetId].fullscreen=u.status),l.emitStateChange()):l.logger.info("event slideIndex: "+u.slideIndex+", current slideIndex: "+l.__slideState.currentSlideIndex,l.taskId)}),(o=h.view)===null||o===void 0||o.addEventListener("touchend",this.handleViewTouchEnd),(s=h.view)===null||s===void 0||s.addEventListener("touchstart",this.handleViewTouchStart),(a=h.view)===null||a===void 0||a.addEventListener("click",this.handleViewClick),h.on(We.userInput,this.userInputHandle),h},t.prototype._handleViewClick=function(){var r=this;setTimeout(function(){var o=Date.now();Math.abs(o-r.userInputTime)>500&&r.enableGlobalClick&&r.nextStep()})},t.prototype.createController=function(){this.player&&(this.playerController=new ME(this.player,this.frame))},t.prototype.setMedianControllerAttribute=function(){this.medianController.className="median-container",this.medianController.style.position="absolute",this.medianController.style.left="0",this.medianController.style.top="0",this.medianController.style.zIndex="2",this.medianController.style.fontSize="16px"},t.prototype.frameResizeHandler=function(){if(!this.config.fixedFrameSize){var r=this.frame.getBoundingClientRect(),o=r.width,s=r.height;this.frameWidth=o,this.frameHeight=s,this.resizeView()}},t.prototype.updateFixedFrameSize=function(r,o,s){this.config.fixedFrameSize&&(this.frameWidth=r,this.frameHeight=o,this.frame.style.width=r+"px",this.frame.style.height=o+"px",this.resizeView(s))},t.prototype._resizeView=function(r){var o,s,a=this,l=this.width,h=this.height;if(l>0&&h>0){var u=this.frameWidth/l,p=u*h;p>this.frameHeight&&(u*=this.frameHeight/p),(o=this.player)===null||o===void 0||o.scaleView(u,this.resize,r),this.cacheImage.style.transform="scale("+u+")",this.medianController.style.transform="scale("+u+")",this.medianController.setAttribute("data-scale",u.toString()),this.isInitResized||(this.isInitResized=!0,(s=this.player)===null||s===void 0||s.clock.setTimeout(function(){a.frame.style.visibility="visible"},32))}},t.prototype.setSlideState=function(r){var o,s,a;return Yi(this,void 0,void 0,function(){var l,h=this;return qi(this,function(u){switch(u.label){case 0:return this.isSyncingSlideState=!0,this.logger.info("stateChange receive "+JSON.stringify(r),this.taskId),r.taskId&&r.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=r.taskId,(o=this.player)===null||o===void 0||o.setResourceData(r.taskId,this.__slideState.url)),r.url&&r.url!==this.__slideState.url&&(this.__slideState.url=r.url,(s=this.player)===null||s===void 0||s.setResourceData(this.__slideState.taskId,r.url)),Number.isInteger(r.currentSlideIndex)&&r.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=r.currentSlideIndex,[4,this.doRenderSlide(r.currentSlideIndex)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[4,(a=this.player)===null||a===void 0?void 0:a.clock.waitUntil(function(){var p,_;return((p=h.player)===null||p===void 0?void 0:p.currentIndex)===r.currentSlideIndex&&((_=h.player)===null||_===void 0?void 0:_.currentStage)},3e3)];case 3:return u.sent(),l=!1,Number.isInteger(r.mainSeqStep)&&r.mainSeqStep!==this.__slideState.mainSeqStep&&(l=!0,this.__slideState.mainSeqStep=r.mainSeqStep),r.mainSeqState&&r.mainSeqState!==this.__slideState.mainSeqState&&(l=!0,this.__slideState.mainSeqState=r.mainSeqState),l&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),r.interactiveSeqState&&(this.initInteractiveSeq(r),this.__slideState.interactiveSeqState=r.interactiveSeqState),[4,Oh(1500)];case 4:return u.sent(),r.mediaState&&(this.initMedia(r),this.__slideState.mediaState=r.mediaState),this.isSyncingSlideState=!1,[2]}})})},t.prototype.initInteractiveSeq=function(r){var o;for(var s in r.interactiveSeqState){var a=r.interactiveSeqState[s];(o=this.player)===null||o===void 0||o.setInteractiveSeqState(s,a.step,a.state==="idle"?"start":"end")}},t.prototype.initMedia=function(r){var o,s,a;for(var l in r.mediaState){var h=r.mediaState[l],u=this.__slideState.mediaState[l];if((o=this.player)===null||o===void 0||o.syncFullscreenVideoState({targetId:l,state:!!h.fullscreen,slideIndex:this.slideState.currentSlideIndex}),!u||h.type!==u.type||h.time!==u.time)if(h.type==="play"){var p=(this.timestamp()-h.time)/1e3;(s=this.player)===null||s===void 0||s.setMediaState(l,!0,p)}else(a=this.player)===null||a===void 0||a.setMediaState(l,!1,h.time)}},Object.defineProperty(t.prototype,"slideCount",{get:function(){return this._slideCount},enumerable:!1,configurable:!0}),t.prototype.getSizeAsync=function(){return Yi(this,void 0,void 0,function(){var r;return qi(this,function(o){switch(o.label){case 0:if(this.width>0&&this.height>0)return[2,[this.width,this.height]];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,o.sent().json()];case 3:return[2,[(r=o.sent()).width,r.height]];case 4:return o.sent(),[2,[0,0]];case 5:return[2]}})})},t.prototype.getSlideCountAsync=function(){return Yi(this,void 0,void 0,function(){return qi(this,function(r){switch(r.label){case 0:if(this._slideCount>0)return[2,this._slideCount];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,r.sent().json()];case 3:return[2,r.sent().slideCount];case 4:return r.sent(),[2,0];case 5:return[2]}})})},Object.defineProperty(t.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqLength",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqLength())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqStep",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqStep())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqState",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqState())||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderOptions",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.config)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drawCall",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.drawCall)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.fps)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"runtimeFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.fps.value)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.view)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.designWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.designHeight},enumerable:!1,configurable:!0}),t.prototype.updateRenderOption=function(r){this.player&&(this.player.updateConfig(r),this.renderOptions&&(this.config.renderOptions=this.renderOptions))},t.prototype.setResource=function(r,o){var s;this.taskId=r,(s=this.player)===null||s===void 0||s.setResourceData(r,o),this.__slideState.taskId=r,this.__slideState.url=o,this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"setResource",taskId:r,url:o})},t.prototype.setResourceList=function(r,o){var s;this.taskId=r,this.resourceList=o,(s=this.player)===null||s===void 0||s.setResourceData(r,"__internal__"),this.__slideState.taskId=r,this.__slideState.url="__internal__"},t.prototype._renderSlide=function(r){var o;return Yi(this,void 0,void 0,function(){var s=this;return qi(this,function(a){switch(a.label){case 0:return this.renderingIndex=r,this.player&&r===this.player.currentIndex?[2]:((hr.platform.isIOS()||hr.platform.isAndroid())&&this.iosResetCache.indexOf(r)<0&&this.iosResetCache.push(r),this.flushDebounce(),[4,(o=this.player)===null||o===void 0?void 0:o.renderSlide(r)]);case 1:return a.sent(),this.__slideState.currentSlideIndex=r,this.resizeView(),this.__slideState.interactiveSeqState={},this.__slideState.mediaState={},this.emitStateChange(),setTimeout(function(){var l,h;((h=(l=s.player)===null||l===void 0?void 0:l.view)===null||h===void 0?void 0:h.style.visibility)==="hidden"&&(s.player.view.style.visibility="visible"),s.frame.style.visibility==="hidden"&&(s.frame.style.visibility="visible"),s.cacheImage.style.display="none"},100),[2]}})})},t.prototype.renderSlide=function(r,o){if(o===void 0&&(o=!0),this.player){var s=Number(r);(s!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(s>this.slideCount&&this.slideCount>0||this.poseRenderSlide(s,o))}},t.prototype.needCreateNewPlayer=function(){var r=t.__stageCountLimit;return r<=0&&(r=hr.platform.isLowGpuMemory()?15:30),(hr.platform.isIOS()||hr.platform.isAndroid())&&this.iosResetCache.length>r},t.prototype.poseRenderSlide=function(r,o){this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o}):this.mode==="sync"?(this.doRenderSlide(r,o),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o})):this.doRenderSlide(r,o)},t.prototype.doRenderSlide=function(r,o){var s,a,l,h=this;if(o===void 0&&(o=!0),!this.player)return Promise.resolve();if(this.needCreateNewPlayer()&&(this.iosResetCache=[],this.iosNewPlayer=this.initPlayer(this.config),this.iosNewPlayer.setResourceData(this.__slideState.taskId,this.__slideState.url)),this.iosNewPlayer){var u=this.player.getSnapshot();this.cacheImage.src=u,this.player.destroy(),(s=this.playerController)===null||s===void 0||s.destroy(),this.player=this.iosNewPlayer,this.iosNewPlayer=void 0,!((a=this.config)===null||a===void 0)&&a.controller&&this.createController(),!((l=this==null?void 0:this.player)===null||l===void 0)&&l.view&&(this.player.view.style.visibility="hidden",this.canvasContainer.appendChild(this.player.view))}var p=Math.random().toString(32).substr(2);return this.player.isForward=o,this.renderingTaskManager.addTask(function(){return h._renderSlide(r)},r,p),new Promise(function(_,x){h.renderingTaskManager.eventHub.once("task-end-"+p,_),h.renderingTaskManager.eventHub.once("task-error-"+p,x)})},t.prototype.getSnapshot=function(){var r,o;return(o=(r=this.player)===null||r===void 0?void 0:r.getSnapshot())!==null&&o!==void 0?o:null},t.prototype.nextStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasNextStep()||this.emit(or.slideStepEnd),this.player.mainSeqHasNextStep()?this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()+1}):this.mode==="sync"?(this.doNextStep(!1,""),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()})):this.doNextStep(!1,""):this.handleNextSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+!!this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doNextStep=function(r,o){if(this.player){var s=!this.config.clientId||o===this.config.clientId;this.player.nextStep(r,s);var a=this.player.mainSeqStep();this.__slideState.mainSeqStep=a,this.emitStateChange()}},t.prototype.prevStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasPrevStep()||this.emit(or.slideStepStart),this.player.mainSeqHasPrevStep()?this.mode==="interactive"?this.emitSyncDispatch({type:"prevStep",slideIndex:this.__slideState.currentSlideIndex,next:this.player.mainSeqStep()-1}):this.mode==="sync"?(this.doPrevStep(),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"prevStep",next:this.player.mainSeqStep()})):this.doPrevStep():this.handlePrevSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doPrevStep=function(r){if(r===void 0&&(r=!1),this.player){this.player.prevStep(r);var o=this.player.mainSeqStep();this.__slideState.mainSeqStep=o,this.emitStateChange()}},t.prototype.isSlideStateReady=function(r){return r.taskId.length>0&&r.url.length>0&&r.currentSlideIndex>0},t.prototype.emitStateChange=function(){if(this.mode!=="local"&&!this.isSyncingSlideState){var r=this.slideState;!qS()(this.lastEmitedState,r)&&this.isSlideStateReady(r)&&(this.lastEmitedState=r,this.emit(or.stateChange,r),this.logger.info("stateChange dispatch "+JSON.stringify(this.slideState),this.taskId))}},t.prototype.emitSyncDispatch=function(r){if(!this.lock.isLocked(r.type)){var o=Math.random().toString(32).substr(2);this.lock.addLock(r.type,o);var s=ys(ys({},r),{uuid:o,clientId:this.config.clientId});this.config.mode==="sync"&&(s.incrId=this.dispatchIncrId),this.emit(or.syncDispatch,s),this.logger.info("sync dispatch "+JSON.stringify(s),this.taskId)}},t.prototype.setMainSeqStep=function(r,o){var s;(s=this.player)===null||s===void 0||s.setMainSeqStep(r,o)},t.prototype.setInteractive=function(r){var o;this.interactive=r,(o=this.player)===null||o===void 0||o.setInteractive(r)},t.prototype.pause=function(){var r;(r=this.player)===null||r===void 0||r.pause()},t.prototype.resume=function(){var r;(r=this.player)===null||r===void 0||r.resume()},t.prototype._doFrozen=function(r){var o;return Yi(this,void 0,void 0,function(){var s,a,l,h=this;return qi(this,function(u){switch(u.label){case 0:return this.logger.info("do frozen with player["+!!this.player+"]",this.taskId),this.tracker({name:"frozenSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.view&&this.player?[4,this.player.clock.waitUntil(function(){return!h.isLoading},6e4)]:[3,2];case 1:for(a in u.sent(),s=this.player.getSnapshot()||"",this.cacheImage.src=s,this.cacheImage.style.display="block",this.player.destroy(),(o=this.playerController)===null||o===void 0||o.destroy(),this.player=void 0,this.__slideState.mediaState)l=this.__slideState.mediaState[a],this.__slideState.mediaState[a]=ys(ys({},l),{frozenTime:this.timestamp()});u.label=2;case 2:return r&&r(),[2]}})})},t.prototype.frozen=function(r){var o=this;this.frozenTaskManager.addTask("frozen",function(){return o._doFrozen(r)})},t.prototype._doRelease=function(r){var o,s;return Yi(this,void 0,void 0,function(){var a,l,h,u;return qi(this,function(p){switch(p.label){case 0:if(this.logger.info("do release slide",this.taskId),this.tracker({name:"releaseSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.player)return[2];for(l in this.player=this.initPlayer(this.config),!((o=this.config)===null||o===void 0)&&o.controller&&this.createController(),this.player.view&&(this.canvasContainer.appendChild(this.player.view),this.player.view.style.visibility="hidden"),a=this.__slideState,this.__slideState=fg()(Vg),a.mediaState)(h=a.mediaState[l]).type==="play"&&(u=Math.max((s=h.frozenTime)!==null&&s!==void 0?s:0,h.time),h.time=this.timestamp()-(u-h.time),h.frozenTime=void 0);return[4,this.setSlideState(a)];case 1:return p.sent(),[4,this.player.clock.delay(333)];case 2:return p.sent(),this.player.view&&(this.player.view.style.visibility="visible"),this.cacheImage.style.display="none",r&&r(),[2]}})})},t.prototype.release=function(r){var o=this;this.frozenTaskManager.addTask("release",function(){return o._doRelease(r)})},t.prototype._doDestroy=function(){var r,o,s,a,l=this;this.logger.info("do destroy slide",this.taskId),this.tracker({name:"destroySlide",reason:"",result:"",payload:{taskId:this.taskId}});var h=t.instances.findIndex(function(u){return u.randomId===l.randomId});if(h>=0&&t.instances.splice(h,1),this.playerController&&this.playerController.destroy(),this.frameResizeObserver.disconnect(),(r=this.player)===null||r===void 0||r.removeAllListeners(),(o=this.player)===null||o===void 0||o.destroy(),(s=this.player)===null||s===void 0||s.removeAllListeners(),this.logger={warn:function(){return{}},info:function(){return{}},error:function(){return{}}},this.syncQueue.destroy(),this.renderingTaskManager.destroy(),this.frozenTaskManager.destroy(),window.removeEventListener("__slide_ref__",this.handleSlideRef),window.removeEventListener("__slide_updateStageCountLimit",this.updateStageCountLimit),window.removeEventListener("message",this.recoverHandler),this.removeAllListeners(),(a=this.player)===null||a===void 0?void 0:a.view)try{this.anchor.removeChild(this.player.view)}catch{this.logger.error("removeChild error Slide.ts:1982",this.taskId)}try{this.anchor.removeChild(this.frame)}catch{this.logger.error("removeChild error Slide.ts:1988",this.taskId)}t.volumeAdjuster.off("update",this._updateVolumeByStaticAdjuster)},t.prototype.waitLoadEnd=function(){return Yi(this,void 0,void 0,function(){var r;return qi(this,function(o){switch(o.label){case 0:r=0,o.label=1;case 1:return this.isLoading&&r<10?[4,Oh(100)]:[3,3];case 2:return o.sent(),r+=1,[3,1];case 3:return[2]}})})},t.prototype.preload=function(r){return this.player?this.player.preload(r):Promise.resolve()},t.prototype.preloadResource=function(r){return this.player?this.player.preloadResource(r):Promise.resolve()},t.prototype.destroy=function(){var r=this;this.logger.info("pre destroy slide",""),this.isLoading?this.waitLoadEnd().then(function(){r._doDestroy()}):this._doDestroy()},t.prototype.clearSlideCache=function(){var r;(r=this.player)===null||r===void 0||r.clearLocalCache()},t.prototype.hasNextStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===this.slideCount,o=this.mainSeqLength===0||this.mainSeqStep>=this.mainSeqLength-1,s=this.mainSeqState==="end"||this.mainSeqState==="running"||this.mainSeqState==null;return!(r&&o&&s)},t.prototype.hasPrevStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===1,o=this.mainSeqLength===0||this.mainSeqStep===0,s=this.mainSeqState==="idle"||this.mainSeqState===null;return!(r&&o&&s)},t.prototype.snapshot=function(){return Yi(this,void 0,void 0,function(){return qi(this,function(r){return this.player?[2,this.player.getSnapshot()]:[2,null]})})},t.prototype.snapshotWithTimingEnd=function(r){return Yi(this,void 0,void 0,function(){return qi(this,function(o){return this.player?[2,this.player.snapshotWithTimingEnd(r)]:[2,null]})})},t.prototype.updateGlobalVolume=function(r){this.volumeAdjuster.volume=r},t.prototype.getGlobalVolume=function(){return this.volumeAdjuster.volume},t.clearLocalCache=function(){hr.clearLocalCache()},t.disposeLocalCache=function(){},e=t,t.preloadResource=NE,t.instances=[],t._tempFrozenIds=[],t._tempLog="",t._tempLogIndex=1,t.remoteLogAddress=null,t.usePlugin=function(r){r.context({logger:{info:function(o){t.appendLogString("INFO - "+new Date().toISOString()+" - "+o+`
`)},warn:function(o){t.appendLogString("WARN - "+new Date().toISOString()+" - "+o+`
`)},error:function(o){t.appendLogString("ERROR - "+new Date().toISOString()+" - "+o+`
`)}}}),function(o){var s=Rc.get(o.hookPoint)||[];s.push(o),Rc.set(o.hookPoint,s)}(r)},t.volumeAdjuster=new dg,t.__stageCountLimit=-1,t.trackLogger=new PE,t.handleFrozenAllSlide=function(){t.instances.forEach(function(r){r.player&&(t._tempFrozenIds.push(r.randomId),r.frozen())})},t.handleReleaseAllSlide=function(){t._tempFrozenIds.forEach(function(r){var o=t.instances.find(function(s){return s.randomId===r});o&&o.release()}),t._tempFrozenIds=[]},t.handleLogReport=function(r){return Yi(void 0,void 0,void 0,function(){var o,s,a,l,h,u;return qi(e,function(p){switch(p.label){case 0:return[4,t.flushLog(!0)];case 1:if(p.sent(),!fr)return[3,12];o=[],p.label=2;case 2:return p.trys.push([2,4,,5]),[4,fr.keys()];case 3:return o=(p.sent()||[]).sort(function(_,x){return parseInt(_.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),[3,5];case 4:return p.sent(),[3,5];case 5:if(o.length===0)return window.postMessage({type:"@slide/_report_log_",log:"",index:1,total:1,customMessage:"@slide/_report_log_",sessionId:r},"*"),[2];s=0,a=o,p.label=6;case 6:if(!(s<a.length))return[3,12];l=a[s],h=l.replace("run_time_log_",""),u="",p.label=7;case 7:return p.trys.push([7,9,,10]),[4,fr.getItem(l)];case 8:return u=p.sent()||"",[3,10];case 9:return p.sent(),[3,10];case 10:window.postMessage({type:"@slide/_report_log_",log:u,index:parseInt(h,10),total:o.length,customMessage:"@slide/_report_log_",sessionId:r},"*"),p.label=11;case 11:return s++,[3,6];case 12:return[2]}})})},t.handleLogDownload=function(){return Yi(void 0,void 0,void 0,function(){var r,o,s,a,l,h,u;return qi(e,function(p){switch(p.label){case 0:return p.trys.push([0,7,,8]),[4,t.flushLog(!0)];case 1:return p.sent(),r="",fr?[4,fr.keys()]:[3,6];case 2:o=(p.sent()||[]).sort(function(_,x){return parseInt(_.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),s=0,a=o,p.label=3;case 3:return s<a.length?(l=a[s],h=r,[4,fr.getItem(l)]):[3,6];case 4:r=h+(p.sent()||""),p.label=5;case 5:return s++,[3,3];case 6:return(u=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(r)),u.setAttribute("download","slide_log"),u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),[3,8];case 7:return p.sent(),[3,8];case 8:return[2]}})})},FE([(n="Slide.initConfig",function(r,o,s){var a=s.value;s.value=function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];for(var u=Rc.get(n)||[],p=l,_=0,x=u;_<x.length;_++){var w=x[_];try{p=w.before(p)}catch{}if(!Array.isArray(p)||p.length!==l.length)throw new Error("plugin before hook return invalid args")}for(var A=a.bind(this).apply(void 0,p),C=0,G=u.reverse();C<G.length;C++){w=G[C];try{A=w.after(A)}catch{}if(!A)throw new Error("plugin after hook return undefined result")}return A}})],t.prototype,"initSlideConfig",null),t}(fi.a);fr==null||fr.clear().catch(function(){}),window.addEventListener("__slide_log__",no.handleLogDownload),window.addEventListener("message",function(i){var t;if(i.data.type==="@slide/_request_log_")no.handleLogReport(i.data.sessionId).catch(function(){});else if(i.data.type==="@slide/_request_frozen_")no.handleFrozenAllSlide();else if(i.data.type==="@slide/_request_release_")no.handleReleaseAllSlide();else if(i.data.type==="@slide/_update_volume_"){var e=.5;try{e=parseFloat(i.data.volume.toString())}catch{}no.volumeAdjuster.volume=e}else if(i.data.type==="@slide/_get_volume_")window.postMessage({type:"@slide/_report_volume_",volume:no.volumeAdjuster.volume,customMessage:"@slide/_report_volume_"},"*");else if(i.data.type==="@slide/_preload_slide_"){var n=(t=i.data.sessionId)!==null&&t!==void 0?t:Math.random().toString(32).substr(2);no.preloadResource(i.data.taskId,i.data.prefix,i.data.maxResolutionLevel,function(r){window.postMessage({type:"@slide/_preload_slide_progress_",sessionId:n,taskId:i.data.taskId,progress:r},"*")},i.data.pages).catch(function(r){window.postMessage({type:"@slide/_preload_slide_error_",sessionId:n,taskId:i.data.taskId,error:r},"*")})}}),window.setInterval(function(){no.flushLog().catch(function(){})},2e3)}]),ev="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",nv=87,iv=20,Jc=[],Zc=()=>{for(let b=0;b<iv;b++)Jc[b]=ev.charAt(Math.random()*nv);return Jc.join("")};function Kc(b){try{return b()}catch(S){console.error(S)}}var sa=class{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(b,S=this.genUID()){return this.flush(S),this.disposers.set(S,Array.isArray(b)?rv(b):b),S}add(b,S=this.genUID()){const v=b();return v?this.addDisposer(v,S):S}addEventListener(b,S,v,O,R=this.genUID()){return b.addEventListener(S,v,O),this.addDisposer(()=>b.removeEventListener(S,v,O),R),R}setTimeout(b,S,v=this.genUID()){const O=window.setTimeout(()=>{this.remove(v),b()},S);return this.addDisposer(()=>window.clearTimeout(O),v)}setInterval(b,S,v=this.genUID()){const O=window.setInterval(b,S);return this.addDisposer(()=>window.clearInterval(O),v)}remove(b){const S=this.disposers.get(b);return this.disposers.delete(b),S}flush(b){const S=this.remove(b);S&&S()}flushAll(){this.disposers.forEach(Kc),this.disposers.clear()}genUID(){let b;do b=Zc();while(this.disposers.has(b));return b}};function rv(b){return()=>b.forEach(Kc)}function $c(b,S,v){return Math.min(Math.max(b,S),v)}function ov(b){return typeof b=="object"&&b!==null}function sv(b){if(!b)return!1;const S=b.tagName;return S==="INPUT"||S==="TEXTAREA"||S==="SELECT"}var Qc={exports:{}},av={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},td={exports:{}},lv=function(S){return!S||typeof S=="string"?!1:S instanceof Array||Array.isArray(S)||S.length>=0&&(S.splice instanceof Function||Object.getOwnPropertyDescriptor(S,S.length-1)&&S.constructor.name!=="String")},hv=lv,uv=Array.prototype.concat,cv=Array.prototype.slice,ed=td.exports=function(S){for(var v=[],O=0,R=S.length;O<R;O++){var M=S[O];hv(M)?v=uv.call(v,cv.call(M)):v.push(M)}return v};ed.wrap=function(b){return function(){return b(ed(arguments))}};var aa=av,la=td.exports,nd=Object.hasOwnProperty,id=Object.create(null);for(var Nh in aa)nd.call(aa,Nh)&&(id[aa[Nh]]=Nh);var vr=Qc.exports={to:{},get:{}};vr.get=function(b){var S=b.substring(0,3).toLowerCase(),v,O;switch(S){case"hsl":v=vr.get.hsl(b),O="hsl";break;case"hwb":v=vr.get.hwb(b),O="hwb";break;default:v=vr.get.rgb(b),O="rgb";break}return v?{model:O,value:v}:null},vr.get.rgb=function(b){if(!b)return null;var S=/^#([a-f0-9]{3,4})$/i,v=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,O=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,R=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,M=/^(\w+)$/,D=[0,0,0,1],B,z,X;if(B=b.match(v)){for(X=B[2],B=B[1],z=0;z<3;z++){var J=z*2;D[z]=parseInt(B.slice(J,J+2),16)}X&&(D[3]=parseInt(X,16)/255)}else if(B=b.match(S)){for(B=B[1],X=B[3],z=0;z<3;z++)D[z]=parseInt(B[z]+B[z],16);X&&(D[3]=parseInt(X+X,16)/255)}else if(B=b.match(O)){for(z=0;z<3;z++)D[z]=parseInt(B[z+1],0);B[4]&&(B[5]?D[3]=parseFloat(B[4])*.01:D[3]=parseFloat(B[4]))}else if(B=b.match(R)){for(z=0;z<3;z++)D[z]=Math.round(parseFloat(B[z+1])*2.55);B[4]&&(B[5]?D[3]=parseFloat(B[4])*.01:D[3]=parseFloat(B[4]))}else return(B=b.match(M))?B[1]==="transparent"?[0,0,0,0]:nd.call(aa,B[1])?(D=aa[B[1]],D[3]=1,D):null:null;for(z=0;z<3;z++)D[z]=_o(D[z],0,255);return D[3]=_o(D[3],0,1),D},vr.get.hsl=function(b){if(!b)return null;var S=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(S);if(v){var O=parseFloat(v[4]),R=(parseFloat(v[1])%360+360)%360,M=_o(parseFloat(v[2]),0,100),D=_o(parseFloat(v[3]),0,100),B=_o(isNaN(O)?1:O,0,1);return[R,M,D,B]}return null},vr.get.hwb=function(b){if(!b)return null;var S=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(S);if(v){var O=parseFloat(v[4]),R=(parseFloat(v[1])%360+360)%360,M=_o(parseFloat(v[2]),0,100),D=_o(parseFloat(v[3]),0,100),B=_o(isNaN(O)?1:O,0,1);return[R,M,D,B]}return null},vr.to.hex=function(){var b=la(arguments);return"#"+sl(b[0])+sl(b[1])+sl(b[2])+(b[3]<1?sl(Math.round(b[3]*255)):"")},vr.to.rgb=function(){var b=la(arguments);return b.length<4||b[3]===1?"rgb("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+")":"rgba("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+", "+b[3]+")"},vr.to.rgb.percent=function(){var b=la(arguments),S=Math.round(b[0]/255*100),v=Math.round(b[1]/255*100),O=Math.round(b[2]/255*100);return b.length<4||b[3]===1?"rgb("+S+"%, "+v+"%, "+O+"%)":"rgba("+S+"%, "+v+"%, "+O+"%, "+b[3]+")"},vr.to.hsl=function(){var b=la(arguments);return b.length<4||b[3]===1?"hsl("+b[0]+", "+b[1]+"%, "+b[2]+"%)":"hsla("+b[0]+", "+b[1]+"%, "+b[2]+"%, "+b[3]+")"},vr.to.hwb=function(){var b=la(arguments),S="";return b.length>=4&&b[3]!==1&&(S=", "+b[3]),"hwb("+b[0]+", "+b[1]+"%, "+b[2]+"%"+S+")"},vr.to.keyword=function(b){return id[b.slice(0,3)]};function _o(b,S,v){return Math.min(Math.max(S,b),v)}function sl(b){var S=Math.round(b).toString(16).toUpperCase();return S.length<2?"0"+S:S}var dv=Qc.exports;class pv{constructor(S){this.enable=S,this.apps={},this.level="debug",this.roomLogger=null,this._onMessage=v=>{let O;v instanceof CustomEvent?O=v.detail:ov(v.data)&&(O=v.data),O&&(typeof O.slide=="boolean"?this.enable=O.slide:O.slide==="__instance"?console.log(this):O.slide==="__debug"&&Object.values(this.apps).forEach(R=>{var M,D;(D=(M=R.controller)==null?void 0:M.slide)==null||D.createController()}))},this.initialize()}setAppContext(S,v){var O;((O=this.apps)[S]||(O[S]={})).context=v,this.log(`[Slide] new ${S}`)}setAppController(S,v){var O;((O=this.apps)[S]||(O[S]={})).controller=v}deleteApp(S){delete this.apps[S],this.log(`[Slide] delete ${S}`)}initialize(){window.addEventListener("message",this._onMessage)}dispose(){window.removeEventListener("message",this._onMessage)}log(...S){this.roomLogger?this.roomLogger.info(...S):this.enable&&console.log(...S)}verbose(...S){this.roomLogger?this.roomLogger.debug(...S):this.enable&&this.level==="verbose"&&console.log(...S)}warn(...S){this.roomLogger?this.roomLogger.warn(...S):console.warn(...S)}}const Ar=new pv(!1),ei=Ar.log.bind(Ar),Dh=Ar.verbose.bind(Ar),fv=b=>{Ar.roomLogger=b.logger};function rd(b){try{const S=window.getComputedStyle(b).backgroundColor;if(S!=="rgba(0, 0, 0, 0)"&&S!=="transparent")return S;if(b.parentElement)return rd(b.parentElement)}catch{}return"#ffffff"}function mv(b){const S=dv.get(b);if(S&&S.model==="rgb"){const v=S.value,R=(((Math.round(v[0])&255)<<16)+((Math.round(v[1])&255)<<8)+(Math.round(v[2])&255)).toString(16);return"#"+"000000".substring(R.length)+R}else return b}let al="";function od(b){return al||(al=mv(rd(b)),ei("[Slide] guess bg color",al)),al}const gv=b=>b.tracker;function sd(b,S=[]){const{width:v,height:O,slideCount:R,slideState:M}=b,{taskId:D,url:B}=M,z=[];for(let X=1;X<=R;++X){const J=S.find(et=>et.indexOf(`preview/${X}.png`)>=0);J?z.push({width:v,height:O,thumbnail:J,src:"ppt"}):z.push({width:v,height:O,thumbnail:`${B}/${D}/preview/${X}.png`,src:"ppt"})}return z}function ad(b,S,v,O){var B;const R=v.slideState.currentSlideIndex;if(!(R>0)||!S.getIsWritable())return;const M=[O,R].join("/");if(S.isAddApp&&b.scenePathType(M)!=="page"){b.removeScenes(O);const z=v.slideCount,X=[];for(let J=1;J<=z;++J)X.push({name:`${J}`});b.putScenes(O,X)}let D;S.getBox().focus?D=b.state.sceneState.scenePath:D=((B=S.getView())==null?void 0:B.focusScenePath)||"",D!==M&&b.scenePathType(M)==="page"&&(ei("[Slide] xxxxxxxxxxxxxxxxxxxxxx333333333 ",M),S.setScenePath(M))}const Fh="https://convertcdn.netless.link/dynamicConvert",vv=40,Bh={taskId:"",url:"",state:null,resourceList:[],previewList:[],customLinks:[]},_v=function(){};class yv{constructor({context:S,anchor:v,onRenderStart:O,onPageChanged:R,onTransitionStart:M,onTransitionEnd:D,onNavigate:B,onError:z,onRenderError:X,showRenderError:J,invisibleBehavior:et},pt){var Nt;this.sideEffect=new sa,this.previewList=[],this.ready=!1,this.readyPromise=new Promise(vt=>{this.resolveReady=L=>{this.ready?ei("[Slide] render end",L):setTimeout(()=>{this.ready=!0,vt()},1e3)}}),this.onSyncDispatch=vt=>{if(this.context.getIsWritable()&&this.room){const L={type:ai.SLIDE_EVENTS.syncDispatch,payload:vt};Dh("[Slide] dispatch",JSON.stringify(vt)),this.context.dispatchMagixEvent(ai.SLIDE_EVENTS.syncDispatch,L)}},this.magixEventListener=vt=>{const{type:L,payload:I}=vt.payload;L===ai.SLIDE_EVENTS.syncDispatch&&(this.syncStateOnce(),Dh("[Slide] receive",JSON.stringify(I)),this.slide.emit(ai.SLIDE_EVENTS.syncReceive,I))},this.onStateChange=vt=>{this.context.getIsWritable()&&(Dh("[Slide] state change",JSON.stringify(vt,null,2)),this.context.storage.setState({state:vt}))},this.pollCount=0,this.pollReadyState=()=>{this.ready?(this._toFreeze===1?this.freeze():this._toFreeze===-1&&this.unfreeze(),this.preloadFirstRender()):this.pollCount<vv?(this.pollCount++,setTimeout(this.pollReadyState,500)):(this.pollCount=0,ei("[Slide] init timeout"))},this._pageCount=0,this.destroyed=!1,this.timestamp=()=>this.room&&this.room.calibrationTimestamp?this.room.calibrationTimestamp:this.player?this.player.beginTimestamp+this.player.progressTime:Date.now(),this.isFrozen=!1,this._toFreeze=0,this.freeze=()=>{this.isFrozen=!0,this.ready?(ei("[Slide] freeze",this.context.appId),this.invisibleBehavior==="frozen"?this.slide.frozen():this.slide.pause()):this._toFreeze=1},this.unfreeze=async()=>{if(!!this.visible)if(this.isFrozen=!1,this.ready){let vt=!1;if(ei("[Slide] unfreeze",this.context.appId),this.invisibleBehavior==="frozen"?(this.slide.release(),vt=!0):this.slide.resume(),vt){const L=this.context.storage.state.state;L&&(ei("[Slide] sync storage",JSON.stringify(L)),this.slide.setSlideState(L))}}else this._toFreeze=-1},this.onVisibilityChange=async()=>{(this.visible=document.visibilityState==="visible")?(ei("[Slide] unfreeze because tab becomes visible",{savedIsFrozen:this.savedIsFrozen}),this.savedIsFrozen||this.unfreeze()):(this.savedIsFrozen=this.isFrozen,ei("[Slide] freeze because tab becomes invisible"),this.freeze(),this.onFreezeEffect())},this.clientId=((Nt=S==null?void 0:S.getRoom())==null?void 0:Nt.uid)||Zc(),this.invisibleBehavior=et!=null?et:"frozen",this.onFreezeEffect=pt,this.onRenderStart=O,this.onPageChanged=R,this.onTransitionStart=M,this.onTransitionEnd=D,this.onNavigate=B||_v,this.onError=z,this.onRenderError=X,this.showRenderError=J!=null?J:!0,this.context=S,this.room=S.getRoom(),this.player=this.room?void 0:S.getDisplayer(),fv(this.room||this.player),this.slide=this.createSlide(v,{whiteTracker:gv(S.getDisplayer())}),this.syncStateOnceFlag=!this.context.isAddApp,this.visible=document.visibilityState==="visible",this.savedIsFrozen=!1,this.initialize()}jumpToPage(S,v){this.ready&&(S=$c(S,1,this.pageCount),this.onNavigate(S,v),this.slide.renderSlide(S))}initialize(){this.registerEventListeners(),this.kickStart()}kickStart(){const{context:S,slide:v}=this;S.getIsWritable()&&S.storage.ensureState(Bh);const{taskId:O,url:R,resourceList:M,previewList:D,state:B}=S.storage.state;this.previewList=D,M&&M.length>0?v.setResourceList(O,M):v.setResource(O,R||Fh),B?(ei("[Slide] init with state",JSON.stringify(B)),this.syncStateOnceFlag=!1,v.setSlideState(B)):S.isAddApp&&(ei("[Slide] init by renderSlide",1),v.renderSlide(1)),this.pollReadyState()}registerEventListeners(){const{context:S,slide:v}=this,O=this.sideEffect.addDisposer(S.storage.addStateChangedListener(()=>{S.storage.state.state&&(this.syncStateOnce(),this.sideEffect.flush(O))}));this.sideEffect.add(()=>S.addMagixEventListener(ai.SLIDE_EVENTS.syncDispatch,this.magixEventListener,{fireSelfEventAfterCommit:!0})),v.on(ai.SLIDE_EVENTS.renderStart,()=>{var R;v.player.app.ticker.minFPS=15,v.player.app.ticker.maxFPS=40,(R=this.onRenderStart)==null||R.call(this)}),v.on(ai.SLIDE_EVENTS.slideChange,this.onPageChanged),v.on(ai.SLIDE_EVENTS.renderEnd,()=>{v.player.app.ticker.minFPS=5,v.player.app.ticker.maxFPS=5}),v.on(ai.SLIDE_EVENTS.renderError,this.onError),v.on(ai.SLIDE_EVENTS.stateChange,this.onStateChange),v.on(ai.SLIDE_EVENTS.syncDispatch,this.onSyncDispatch),v.on(ai.SLIDE_EVENTS.renderEnd,this.resolveReady),v.on(ai.SLIDE_EVENTS.animateStart,()=>{v.player.app.ticker.minFPS=15,v.player.app.ticker.maxFPS=40}),v.on(ai.SLIDE_EVENTS.animateEnd,()=>{v.player.app.ticker.minFPS=5,v.player.app.ticker.maxFPS=5}),this.sideEffect.add(()=>(document.addEventListener("visibilitychange",this.onVisibilityChange),()=>document.removeEventListener("visibilitychange",this.onVisibilityChange)))}syncStateOnce(){if(this.syncStateOnceFlag){this.context.getIsWritable()&&this.context.storage.ensureState(Bh);const{state:S}=this.context.storage.state;S&&(ei("[Slide] sync with state (once)",JSON.stringify(S)),this.slide.setSlideState(S),this.syncStateOnceFlag=!1)}}get pageCount(){return this._pageCount>0?this._pageCount:(this._pageCount=this.slide.slideCount,this._pageCount)}get page(){return this.slide.slideState.currentSlideIndex}createSlide(S,v={}){var D,B,z;const O=this.context.getAppOptions()||{},R=this.context.storage.state,M=new ai.Slide({anchor:S,clientId:this.clientId,interactive:!0,mode:"sync",controller:Ar.enable,enableGlobalClick:(D=O.enableGlobalClick)!=null?D:!0,enableAutoForward:!0,renderOptions:{minFPS:O.minFPS||5,maxFPS:O.maxFPS||15,autoFPS:(B=O.autoFPS)!=null?B:!0,autoResolution:!0,transactionBgColor:O.bgColor||od(S),resolution:O.resolution,maxResolutionLevel:1,forceCanvas:O.forceCanvas,enableNvidiaDetect:O.enableNvidiaDetect,transitionResolutionLevel:1},fixedFrameSize:O.fixedFrameSize,loaderDelegate:O.loaderDelegate,navigatorDelegate:{gotoPage:X=>{this.context.getIsAppReadonly()||M.renderSlide(X)},...O.navigatorDelegate},urlInterrupter:O.urlInterrupter,resourceTimeout:O.resourceTimeout,rtcAudio:O.rtcAudio,useLocalCache:!0,logger:O.logger,whiteTracker:v.whiteTracker,timestamp:this.timestamp,customLinks:R.customLinks,skipActionWhenFrozen:(z=O.skipActionWhenFrozen)!=null?z:!0,antialias:!1});return M}async preloadFirstRender(){try{for(let S=this.slide.slideState.currentSlideIndex+4;S<this.slide.slideCount+1;S++)await this.slide.preloadResource(S);console.log("slide first load done")}catch(S){console.error(S),window.postMessage({type:"@slide/_preload_slide_first_finish_"})}}destroy(){this.sideEffect.flushAll(),this.destroyed||(ei("[Slide] destroy slide (once)"),this.slide.destroy(),this.destroyed=!0)}}function xv(b){const S="http://www.w3.org/2000/svg",v=document.createElementNS(S,"svg");v.setAttribute("class",`${b}-footer-icon-sidebar`),v.setAttribute("viewBox","0 0 64 64");const O=document.createElementNS(S,"path");return O.setAttribute("fill","currentColor"),O.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),v.appendChild(O),v}function bv(b){const S="http://www.w3.org/2000/svg",v=document.createElementNS(S,"svg");return v.setAttribute("class",`${b}-footer-icon-arrow-left`),v.setAttribute("viewBox","0 0 20 20"),v.innerHTML=`<g clip-path="url(#clip0_11800_99864)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5283 4.86182L12.4711 5.80463L8.22849 10.0473L12.4711 14.2899L11.5283 15.2327L6.34287 10.0473L11.5283 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99864">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,v}function Tv(b){const S="http://www.w3.org/2000/svg",v=document.createElementNS(S,"svg");return v.setAttribute("class",`${b}-footer-icon-arrow-right`),v.setAttribute("viewBox","0 0 20 20"),v.innerHTML=`<g clip-path="url(#clip0_11800_99870)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.1377 4.86182L7.19489 5.80463L11.4375 10.0473L7.19489 14.2899L8.1377 15.2327L13.3231 10.0473L8.1377 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99870">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,v}const yo=typeof window!="undefined",ld=yo&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),hd=yo&&"IntersectionObserver"in window,ud=yo&&"classList"in document.createElement("p"),cd=yo&&window.devicePixelRatio>1,wv={elements_selector:".lazy",container:ld||yo?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},dd=b=>Object.assign({},wv,b),pd=function(b,S){let v;const O="LazyLoad::Initialized",R=new b(S);try{v=new CustomEvent(O,{detail:{instance:R}})}catch{v=document.createEvent("CustomEvent"),v.initCustomEvent(O,!1,!1,{instance:R})}window.dispatchEvent(v)},Sv=(b,S)=>{if(!!S)if(!S.length)pd(b,S);else for(let v=0,O;O=S[v];v+=1)pd(b,O)},ro="src",kh="srcset",Uh="sizes",fd="poster",ha="llOriginalAttrs",md="data",Gh="loading",gd="loaded",vd="applied",Ev="entered",Hh="error",_d="native",yd="data-",xd="ll-status",cr=(b,S)=>b.getAttribute(yd+S),Av=(b,S,v)=>{const O=yd+S;if(v===null){b.removeAttribute(O);return}b.setAttribute(O,v)},ua=b=>cr(b,xd),Zo=(b,S)=>Av(b,xd,S),ll=b=>Zo(b,null),jh=b=>ua(b)===null,Mv=b=>ua(b)===Gh,Cv=b=>ua(b)===Hh,zh=b=>ua(b)===_d,Rv=[Gh,gd,vd,Hh],Iv=b=>Rv.indexOf(ua(b))>=0,xo=(b,S,v,O)=>{if(!(!b||typeof b!="function")){if(O!==void 0){b(S,v,O);return}if(v!==void 0){b(S,v);return}b(S)}},bs=(b,S)=>{if(S!==""){if(ud){b.classList.add(S);return}b.className+=(b.className?" ":"")+S}},Xr=(b,S)=>{if(S!==""){if(ud){b.classList.remove(S);return}b.className=b.className.replace(new RegExp("(^|\\s+)"+S+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}},Pv=b=>{b.llTempImage=document.createElement("IMG")},Ov=b=>{delete b.llTempImage},bd=b=>b.llTempImage,hl=(b,S)=>{if(!S)return;const v=S._observer;!v||v.unobserve(b)},Lv=b=>{b.disconnect()},Nv=(b,S,v)=>{S.unobserve_entered&&hl(b,v)},Vh=(b,S)=>{!b||(b.loadingCount+=S)},Dv=b=>{!b||(b.toLoadCount-=1)},Td=(b,S)=>{!b||(b.toLoadCount=S)},Fv=b=>b.loadingCount>0,Bv=b=>b.toLoadCount>0,wd=b=>{let S=[];for(let v=0,O;O=b.children[v];v+=1)O.tagName==="SOURCE"&&S.push(O);return S},Wh=(b,S)=>{const v=b.parentNode;if(!v||v.tagName!=="PICTURE")return;wd(v).forEach(S)},Sd=(b,S)=>{wd(b).forEach(S)},ul=[ro],Ed=[ro,fd],ca=[ro,kh,Uh],Ad=[md],cl=b=>!!b[ha],Md=b=>b[ha],Cd=b=>delete b[ha],Ts=(b,S)=>{if(cl(b))return;const v={};S.forEach(O=>{v[O]=b.getAttribute(O)}),b[ha]=v},kv=b=>{cl(b)||(b[ha]={backgroundImage:b.style.backgroundImage})},Uv=(b,S,v)=>{if(!v){b.removeAttribute(S);return}b.setAttribute(S,v)},Ko=(b,S)=>{if(!cl(b))return;const v=Md(b);S.forEach(O=>{Uv(b,O,v[O])})},Gv=b=>{if(!cl(b))return;const S=Md(b);b.style.backgroundImage=S.backgroundImage},Rd=(b,S,v)=>{bs(b,S.class_applied),Zo(b,vd),v&&(S.unobserve_completed&&hl(b,S),xo(S.callback_applied,b,v))},Id=(b,S,v)=>{bs(b,S.class_loading),Zo(b,Gh),v&&(Vh(v,1),xo(S.callback_loading,b,v))},bo=(b,S,v)=>{!v||b.setAttribute(S,v)},Pd=(b,S)=>{bo(b,Uh,cr(b,S.data_sizes)),bo(b,kh,cr(b,S.data_srcset)),bo(b,ro,cr(b,S.data_src))},Hv=(b,S)=>{Wh(b,v=>{Ts(v,ca),Pd(v,S)}),Ts(b,ca),Pd(b,S)},jv=(b,S)=>{Ts(b,ul),bo(b,ro,cr(b,S.data_src))},zv=(b,S)=>{Sd(b,v=>{Ts(v,ul),bo(v,ro,cr(v,S.data_src))}),Ts(b,Ed),bo(b,fd,cr(b,S.data_poster)),bo(b,ro,cr(b,S.data_src)),b.load()},Vv=(b,S)=>{Ts(b,Ad),bo(b,md,cr(b,S.data_src))},Wv=(b,S,v)=>{const O=cr(b,S.data_bg),R=cr(b,S.data_bg_hidpi),M=cd&&R?R:O;!M||(b.style.backgroundImage=`url("${M}")`,bd(b).setAttribute(ro,M),Id(b,S,v))},Xv=(b,S,v)=>{const O=cr(b,S.data_bg_multi),R=cr(b,S.data_bg_multi_hidpi),M=cd&&R?R:O;!M||(b.style.backgroundImage=M,Rd(b,S,v))},Yv=(b,S,v)=>{const O=cr(b,S.data_bg_set);if(!O)return;const R=O.split("|");let M=R.map(D=>`image-set(${D})`);b.style.backgroundImage=M.join(),b.style.backgroundImage===""&&(M=R.map(D=>`-webkit-image-set(${D})`),b.style.backgroundImage=M.join()),Rd(b,S,v)},Od={IMG:Hv,IFRAME:jv,VIDEO:zv,OBJECT:Vv},qv=(b,S)=>{const v=Od[b.tagName];!v||v(b,S)},Jv=(b,S,v)=>{const O=Od[b.tagName];!O||(O(b,S),Id(b,S,v))},Zv=["IMG","IFRAME","VIDEO","OBJECT"],Kv=b=>Zv.indexOf(b.tagName)>-1,Ld=(b,S)=>{S&&!Fv(S)&&!Bv(S)&&xo(b.callback_finish,S)},Nd=(b,S,v)=>{b.addEventListener(S,v),b.llEvLisnrs[S]=v},$v=(b,S,v)=>{b.removeEventListener(S,v)},Xh=b=>!!b.llEvLisnrs,Qv=(b,S,v)=>{Xh(b)||(b.llEvLisnrs={});const O=b.tagName==="VIDEO"?"loadeddata":"load";Nd(b,O,S),Nd(b,"error",v)},Yh=b=>{if(!Xh(b))return;const S=b.llEvLisnrs;for(let v in S){const O=S[v];$v(b,v,O)}delete b.llEvLisnrs},Dd=(b,S,v)=>{Ov(b),Vh(v,-1),Dv(v),Xr(b,S.class_loading),S.unobserve_completed&&hl(b,v)},t_=(b,S,v,O)=>{const R=zh(S);Dd(S,v,O),bs(S,v.class_loaded),Zo(S,gd),xo(v.callback_loaded,S,O),R||Ld(v,O)},e_=(b,S,v,O)=>{const R=zh(S);Dd(S,v,O),bs(S,v.class_error),Zo(S,Hh),xo(v.callback_error,S,O),v.restore_on_error&&Ko(S,ca),R||Ld(v,O)},qh=(b,S,v)=>{const O=bd(b)||b;if(Xh(O))return;Qv(O,D=>{t_(D,b,S,v),Yh(O)},D=>{e_(D,b,S,v),Yh(O)})},n_=(b,S,v)=>{Pv(b),qh(b,S,v),kv(b),Wv(b,S,v),Xv(b,S,v),Yv(b,S,v)},i_=(b,S,v)=>{qh(b,S,v),Jv(b,S,v)},Jh=(b,S,v)=>{Kv(b)?i_(b,S,v):n_(b,S,v)},r_=(b,S,v)=>{b.setAttribute("loading","lazy"),qh(b,S,v),qv(b,S),Zo(b,_d)},Fd=b=>{b.removeAttribute(ro),b.removeAttribute(kh),b.removeAttribute(Uh)},o_=b=>{Wh(b,S=>{Fd(S)}),Fd(b)},Bd=b=>{Wh(b,S=>{Ko(S,ca)}),Ko(b,ca)},s_={IMG:Bd,IFRAME:b=>{Ko(b,ul)},VIDEO:b=>{Sd(b,S=>{Ko(S,ul)}),Ko(b,Ed),b.load()},OBJECT:b=>{Ko(b,Ad)}},a_=b=>{const S=s_[b.tagName];if(!S){Gv(b);return}S(b)},l_=(b,S)=>{jh(b)||zh(b)||(Xr(b,S.class_entered),Xr(b,S.class_exited),Xr(b,S.class_applied),Xr(b,S.class_loading),Xr(b,S.class_loaded),Xr(b,S.class_error))},h_=(b,S)=>{a_(b),l_(b,S),ll(b),Cd(b)},u_=(b,S,v,O)=>{!v.cancel_on_exit||!Mv(b)||b.tagName==="IMG"&&(Yh(b),o_(b),Bd(b),Xr(b,v.class_loading),Vh(O,-1),ll(b),xo(v.callback_cancel,b,S,O))},c_=(b,S,v,O)=>{const R=Iv(b);Zo(b,Ev),bs(b,v.class_entered),Xr(b,v.class_exited),Nv(b,v,O),xo(v.callback_enter,b,S,O),!R&&Jh(b,v,O)},d_=(b,S,v,O)=>{jh(b)||(bs(b,v.class_exited),u_(b,S,v,O),xo(v.callback_exit,b,S,O))},p_=["IMG","IFRAME","VIDEO"],kd=b=>b.use_native&&"loading"in HTMLImageElement.prototype,f_=(b,S,v)=>{b.forEach(O=>{p_.indexOf(O.tagName)!==-1&&r_(O,S,v)}),Td(v,0)},m_=b=>b.isIntersecting||b.intersectionRatio>0,g_=b=>({root:b.container===document?null:b.container,rootMargin:b.thresholds||b.threshold+"px"}),v_=(b,S,v)=>{b.forEach(O=>m_(O)?c_(O.target,O,S,v):d_(O.target,O,S,v))},__=(b,S)=>{S.forEach(v=>{b.observe(v)})},y_=(b,S)=>{Lv(b),__(b,S)},x_=(b,S)=>{!hd||kd(b)||(S._observer=new IntersectionObserver(v=>{v_(v,b,S)},g_(b)))},Ud=b=>Array.prototype.slice.call(b),dl=b=>b.container.querySelectorAll(b.elements_selector),b_=b=>Ud(b).filter(jh),T_=b=>Cv(b),w_=b=>Ud(b).filter(T_),Gd=(b,S)=>b_(b||dl(S)),S_=(b,S)=>{w_(dl(b)).forEach(O=>{Xr(O,b.class_error),ll(O)}),S.update()},E_=(b,S)=>{!yo||(S._onlineHandler=()=>{S_(b,S)},window.addEventListener("online",S._onlineHandler))},A_=b=>{!yo||window.removeEventListener("online",b._onlineHandler)},da=function(b,S){const v=dd(b);this._settings=v,this.loadingCount=0,x_(v,this),E_(v,this),this.update(S)};da.prototype={update:function(b){const S=this._settings,v=Gd(b,S);if(Td(this,v.length),ld||!hd){this.loadAll(v);return}if(kd(S)){f_(v,S,this);return}y_(this._observer,v)},destroy:function(){this._observer&&this._observer.disconnect(),A_(this),dl(this._settings).forEach(b=>{Cd(b)}),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(b){const S=this._settings;Gd(b,S).forEach(O=>{hl(O,this),Jh(O,S,this)})},restoreAll:function(){const b=this._settings;dl(b).forEach(S=>{h_(S,b)})}},da.load=(b,S)=>{const v=dd(S);Jh(b,v)},da.resetStatus=b=>{ll(b)},yo&&Sv(da,window.lazyLoadOptions);function M_(b){let S=!1,v;return{html:b.map(R=>{var J,et,pt,Nt,vt,L;const M=`
      text-align: ${R.align==="l"?"left":R.align=="r"?"right":R.align};
      text-indent: ${R.indent}px;
      margin-left: ${R.marginLeft}px;
      margin-right: ${R.marginRight}px;
    `,D=/@~@(https?:\/\/[^\s@]+)@~@/,B=R.runs.some(I=>/@@@(https?:\/\/[^\s@]+)@@@/.test(I.text)||D.test(I.text));S=S||B;const z=R.runs.find(I=>/@@@(https?:\/\/[^\s@]+)@@@/.test(I.text)||D.test(I.text));z&&(v=((pt=(et=(J=z==null?void 0:z.text)==null?void 0:J.match)==null?void 0:et.call(J,/@@@(https?:\/\/[^\s@]+)@@@/))==null?void 0:pt[1])||((L=(vt=(Nt=z==null?void 0:z.text)==null?void 0:Nt.match)==null?void 0:vt.call(Nt,D))==null?void 0:L[1])||void 0);const X=R.runs.map(I=>{const F=`word-spacing: ${I.wordSpace}px; baseline-shift: ${I.baseline}px;`;let P=I.text;return I.bold&&(P=`<strong>${P}</strong>`),I.italic&&(P=`<em>${P}</em>`),`<span style="${F}">${P}</span>`}).join("");return`<div style="${M}">${X}</div>`}).join(""),hasLink:S,link:v}}const pa=(Xd=window.navigator)==null?void 0:Xd.userAgent;pa==null||pa.match(/(Edge?)\/(\d+)/);const Hd=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(pa),jd=()=>typeof navigator!="undefined"&&/Android/.test(pa);class zd{constructor({readonly:S,onNewPageIndex:v,onPlay:O,onPagesReady:R,urlInterrupter:M,box:D,context:B}){this._pages=[],this.noteVisible=!1,this.pageIndex=0,this.setPaused=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},this.setPlaying=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!0)},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new sa,this.readonly=S,this.onNewPageIndex=v,this.onPlay=O,this.onPagesReady=R,this.urlInterrupter=M||(z=>z),this.box=D,this.context=B,this.appReadonly=B==null?void 0:B.getIsAppReadonly(),this.render()}set pages(S){this._pages=S,this.refreshPreview(),this.refreshTotalPage(),this.onPagesReady&&this.onPagesReady(S),this.loading(!1)}get pages(){return this._pages}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(S){this.readonly=S,this.$content.classList.toggle(this.wrapClassName("readonly"),S),this.$footer.classList.toggle(this.wrapClassName("readonly"),S)}setAppReadonly(S){var v;this.appReadonly=S,(v=this.note$)==null||v.classList.toggle(this.wrapClassName("note-hide"),S)}destroy(){var S;(S=this.previewLazyLoad)==null||S.destroy(),this.sideEffect.flushAll(),this.unmount()}setPageIndex(S){Number.isNaN(S)||(this.scrollPreview(S),this.pageIndex=S,this.$pageNumberInput.textContent=String(S+1),this.$btnPageBack.classList.toggle(this.wrapClassName("footer-btn-disable"),S==0),this.$btnPageNext.classList.toggle(this.wrapClassName("footer-btn-disable"),S==this.pages.length-1),this.renderNoteContent())}scrollPreview(S){var B;const v=(B=this.$preview)==null?void 0:B.querySelectorAll("."+this.wrapClassName("preview-page"));if(v==null||v.forEach((z,X)=>{var J;(J=z.querySelector("img"))==null||J.classList.toggle(this.wrapClassName("active"),Number(S)==X)}),!v)return;const O=Array.prototype.slice.call(v).find(z=>z.querySelector("img").className.includes(this.wrapClassName("active")));if(!O)return;const R=this.$preview.getBoundingClientRect(),M=O==null?void 0:O.getBoundingClientRect();M.top>=R.top&&M.bottom<=R.bottom||this.$preview.scrollTo({top:O.offsetTop-16,behavior:this.isShowPreview?"smooth":"auto"})}refreshTotalPage(){this.pages.length?this.$totalPage.textContent=" / "+this.pages.length:this.$totalPage.textContent=""}setSmallBox(S){this.isSmallBox!==S&&(this.isSmallBox=S,this.$footer.classList.toggle(this.wrapClassName("float-footer"),S))}render(){return this.renderContent(),this.renderFooter(),this.loading(!0),this.$content}loading(S){if(S){this.$loading=document.createElement("div"),this.$loading.className=this.wrapClassName("loading");const v=document.createElement("div");v.className=this.wrapClassName("loader"),this.$loading.appendChild(v),this.$content.appendChild(this.$loading),setTimeout(()=>{this.$loading.remove()},2e4)}else this.$loading.remove()}renderContent(){if(!this.$content){const S=document.createElement("div");S.className=this.wrapClassName("content"),this.$content=S,this.readonly&&S.classList.add(this.wrapClassName("readonly")),this.renderNote()}return this.$content}getNoteHasLink(){return this.noteHasLink}getNoteLink(){return this.noteLink}renderNote(){var v,O;if(this.readonly||this.appReadonly||Hd()||jd())return;const S=document.createElement("div");return S.className=this.wrapClassName("note")+" tele-fancy-scrollbar",this.note$=S,(v=this.context)!=null&&v.storage.state.note&&fetch((O=this.context)==null?void 0:O.storage.state.note).then(R=>R.json()).then(R=>{this.notes=R,this.renderNoteContent()}),this.sideEffect.addEventListener(S,"click",R=>{var D;if(this.readonly)return;const M=R.target;if(M.tagName.toLocaleLowerCase()=="a"){R.preventDefault(),R.stopPropagation(),R.stopImmediatePropagation();const z=M.href;(D=this.context)==null||D.dispatchAppEvent("open-note-link",z)}}),S}toggleNoteVisible(S){var v,O;if(this.noteVisible=S,S){if(!this.note$)return;(v=this.$content)==null||v.appendChild(this.note$)}else(O=this.note$)==null||O.remove()}getNoteVisible(){return this.noteVisible}getNotes(){return this.notes}renderNoteContent(){var D,B,z,X,J,et,pt;if(this.readonly){this.noteHasLink=!1,this.noteLink=void 0;return}const S=document.createElement("div");S.className=this.wrapClassName("note-content");const v=(D=this.notes)==null?void 0:D[this.pageIndex+1];if((B=this.note$)==null||B.classList.toggle(this.wrapClassName("note-hide"),!v),(z=this.context)==null||z.dispatchAppEvent("toggleNoteVisible",!!v),!v)return;const{html:O,hasLink:R,link:M}=M_(v);S.innerHTML=O,this.noteHasLink=R,this.noteLink=M,(X=this.context)==null||X.dispatchAppEvent("noteHasLink",{hasLink:R,link:M}),(J=this.note$)!=null&&J.firstElementChild?(et=this.note$)==null||et.replaceChild(S,this.note$.firstElementChild):(pt=this.note$)==null||pt.appendChild(S)}renderPreview(){if(!this.$preview){const S=document.createElement("div");S.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=S,this.refreshPreview(),this.sideEffect.addEventListener(S,"click",v=>{var R;if(this.readonly)return;const O=(R=v.target.dataset)==null?void 0:R.pageIndex;O&&(v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation(),this.onNewPageIndex(Number(O),"preview"))})}return this.$preview}async refreshPreview(){var M,D;const{$preview:S}=this,v=this.wrapClassName("preview-page"),O=this.wrapClassName("preview-page-name");if(!S)return;for(;S.firstChild;)S.firstChild.remove();const R=[];for(let B=0,z=this.pages.length;B<z;B++){const X=this.pages[B],J=(M=X.thumbnail)!=null?M:X.src.startsWith("ppt")?void 0:X.src;J&&(R[B]=this.urlInterrupter(J))}for(let B=0,z=this.pages.length;B<z;B++)R[B]=await R[B];this.pages.forEach((B,z)=>{const X=R[z];if(!X)return;const J=String(z),et=document.createElement("a");et.className=v+" "+this.wrapClassName(`preview-page-${z}`),et.setAttribute("href","#"),et.dataset.pageIndex=J;const pt=document.createElement("span");pt.className=O,pt.textContent=String(z+1),pt.dataset.pageIndex=J;const Nt=document.createElement("img");Nt.width=B.width,Nt.height=B.height,z<10?Nt.src=X:Nt.dataset.src=X,Nt.dataset.pageIndex=J,Nt.classList.toggle(this.wrapClassName("active"),this.pageIndex==z),et.appendChild(pt),et.appendChild(Nt),S.appendChild(et)}),(D=this.previewLazyLoad)==null||D.update()}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",S=>{this.readonly||S.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){this.$btnSidebar.style.display=this.pages.length>0?"":"none"}renderFooter(){if(!this.$footer){const S=document.createElement("div");S.className=this.wrapClassName("footer"),this.$footer=S,this.readonly&&S.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&S.classList.add(this.wrapClassName("float-footer"));const v=this.renderFooterBtn("btn-sidebar",xv(this.namespace));this.sideEffect.addEventListener(v,"click",()=>{this.readonly||this.togglePreview()}),this.$btnSidebar=v,this.$btnSidebar.style.display="none",this.$footer.appendChild(v);const O=document.createElement("div");O.className=this.wrapClassName("page-jumps");const R=this.renderFooterBtn("btn-page-back",bv(this.namespace));this.sideEffect.addEventListener(R,"click",()=>{var X;this.readonly||((X=this.context)==null||X.dispatchAppEvent("pageBtnClick"),this.onNewPageIndex(this.pageIndex-1,"navigation"))}),O.appendChild(R),this.$btnPageBack=R;const M=document.createElement("div");M.className=this.wrapClassName("page-number");const D=document.createElement("span");D.className=this.wrapClassName("page-number-input"),D.textContent=String(this.pageIndex+1),this.$pageNumberInput=D;const B=document.createElement("span");this.$totalPage=B,M.appendChild(D),M.appendChild(B),O.appendChild(M);const z=this.renderFooterBtn("btn-page-next",Tv(this.namespace));this.sideEffect.addEventListener(z,"click",()=>{var X;this.readonly||(this.onPlay?this.onPlay():this.onNewPageIndex(this.pageIndex+1,"navigation"),(X=this.context)==null||X.dispatchAppEvent("pageBtnClick"))}),O.appendChild(z),this.$btnPageNext=z,!Hd()&&!jd()&&this.$footer.appendChild(O),this.box.events.on("maximized",X=>{this.$footer.classList.toggle(this.wrapClassName("hide"),X)})}return this.$footer}renderFooterBtn(S,v,O){const R=document.createElement("button");return R.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(S),R.appendChild(v),O&&R.appendChild(O),R}togglePreview(S){var v,O,R,M,D,B;this.isShowPreview=S!=null?S:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview?((O=(v=this.context)==null?void 0:v.extendWrapper)==null||O.appendChild(this.renderPreviewMask()),(M=(R=this.context)==null?void 0:R.extendWrapper)==null||M.appendChild(this.renderPreview()),(D=this.context)!=null&&D.extendWrapper&&(this.context.extendWrapper.style.display="block"),setTimeout(()=>{const z=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));z&&(this.previewLazyLoad||(this.previewLazyLoad=new da({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`})),this.$preview.scrollTo({top:z.offsetTop-16}))})):(B=this.context)!=null&&B.extendWrapper&&(this.context.extendWrapper.style.display="none",this.context.extendWrapper.innerHTML="")}wrapClassName(S){return`${this.namespace}-${S}`}}const C_=new Set(["clicker"]),R_=function(){};class I_{constructor({context:S,box:v,view:O,mountSlideController:R,mountWhiteboard:M,baseScenePath:D,appId:B,urlInterrupter:z,onPagesReady:X,onNavigate:J}){this.slideController=null,this.isViewMounted=!1,this.justSildeReadonly=!1,this.onError=({error:et,index:pt})=>{var Nt,vt;(Nt=this.slideController)!=null&&Nt.showRenderError&&(this.$overlay.textContent=`Error on slide[page=${this.slideController.page}]: ${et.message}`,this.$overlay.style.opacity="1"),(vt=this.slideController)!=null&&vt.onRenderError&&this.slideController.onRenderError(et,pt),Ar.warn("[Slide] render error",et)},this.onRenderStart=()=>{ei("[Slide] xxxxxxxxxxxxxxxxxxxxxx666666666 onRenderStart"),this.$whiteboardView.classList.add(this.wrapClassName("wb-view-hidden"))},this.onRenderEnd=()=>{},this.onPageChanged=()=>{clearTimeout(this._onPageChangedTimer),this._onPageChangedTimer=setTimeout(this._onPageChanged,200)},this._onPageChangedTimer=0,this._onPageChanged=()=>{this.$overlay.style.opacity="",ei("[Slide] xxxxxxxxxxxxxxxxxxxxxx555555555 onPageChanged"),this.$whiteboardView.classList.remove(this.wrapClassName("wb-view-hidden"))},this.refreshPages=()=>{this.slideController&&(this.viewer.pages=sd(this.slideController.slide,this.slideController.previewList),this.viewer.setPageIndex(this.getPageIndex(this.slideController.page)),this.scaleDocsToFit())},this.scaleDocsToFit=()=>{if(this.slideController){const{width:et,height:pt}=this.slideController.slide;et&&pt&&(this.whiteboardView.moveCameraToContain({originX:-et/2,originY:-pt/2,width:et,height:pt,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.whiteboardView.camera.scale,minContentMode:()=>this.whiteboardView.camera.scale,centerX:0,centerY:0,width:et,height:pt}),this.isViewMounted||(this.isViewMounted=!0,console.log("[Slide] mount whiteboard view"),this.mountWhiteboard(this.$whiteboardView)))}},this.onPlay=()=>{this.slideController&&this.slideController.slide.nextStep()},this.onNewPageIndex=(et,pt)=>{this.slideController&&this.slideController.jumpToPage(et+1,pt)},this.sideEffect=new sa,this.namespace="netless-app-slide",this.toPdf=async()=>{if(!this.slideController){this.reportProgress(100,null);return}const{slide:et}=this.slideController,pt=1920,Nt=document.createElement("canvas"),vt=Nt.getContext("2d"),{slideCount:L,width:I,height:F}=et;let W=Math.floor(I),P=Math.floor(F);W>pt&&(W=pt,P=Math.floor(F*W/I)),P>pt&&(P=pt,W=Math.floor(I*P/F)),Nt.width=W,Nt.height=P;const j=document.createElement("canvas");j.width=W,j.height=P;const Q=j.getContext("2d");if(!Q||!this.getWhiteSnapshot||!vt)return this.reportProgress(100,null),null;const H=W>P?"l":"p",{jsPDF:Ot}=await import("jspdf"),Vt=new Ot({format:[W,P],orientation:H,compress:!0});for(let k=1;k<=L;k++){let mt=null;try{mt=await this.slideController.slide.snapshotWithTimingEnd(k)}catch{}if(mt){const Dt=document.createElement("img");Dt.src=mt,await new Promise(Z=>Dt.onload=Z),vt.drawImage(Dt,0,0,W,P)}Q.clearRect(0,0,W,P),await this.getWhiteSnapshot(k,j,Q,I,F);try{const Dt=j.toDataURL("image/png"),Z=document.createElement("img");Z.src=Dt,await new Promise(ct=>Z.onload=ct),vt.drawImage(Z,0,0,W,P)}catch{}const tt=Nt.toDataURL("image/jpeg",.6);k>1&&Vt.addPage(),Vt.addImage(tt,"JPEG",0,0,W,P,"","FAST"),vt.clearRect(0,0,W,P),Math.ceil(k/L*100)<100&&this.reportProgress(Math.ceil(k/L*100),null)}const st=Vt.output("arraybuffer"),V=this.box.title;this.reportProgress(100,{pdf:st,title:V})},this.context=S,this.box=v,this.whiteboardView=O,this.mountSlideController=R,this.mountWhiteboard=M,this.onNavigate=J||R_,this.baseScenePath=D,this.appId=B,this.viewer=new zd({readonly:v.readonly,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay,urlInterrupter:z,onPagesReady:X,box:v,context:S}),this.sideEffect.add(()=>{const et=pt=>{this.setReadonly(pt)};return v.events.on("readonly",et),()=>v.events.off("readonly",et)}),this.sideEffect.add(()=>{const et=pt=>{pt.data.type==="@netless/_request_save_pdf_"&&pt.data.appId===this.appId&&this.toPdf().catch(()=>this.reportProgress(100,null))};return window.addEventListener("message",et),()=>{window.removeEventListener("message",et)}}),this.render()}setJustSildeReadonly(S){var v;this.justSildeReadonly=S,(v=this.slideController)==null||v.slide.setInteractive(!this.justSildeReadonly)}getNoteHasLink(){var S;return(S=this.viewer)==null?void 0:S.getNoteHasLink()}getNoteLink(){var S;return(S=this.viewer)==null?void 0:S.getNoteLink()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.viewer.$content.appendChild(this.renderOverlay()),this.sideEffect.addEventListener(window,"keydown",S=>{if(!this.justSildeReadonly&&this.box.focus&&this.slideController&&!sv(S.target))switch(S.key){case"ArrowUp":case"ArrowLeft":{this.slideController.slide.prevStep(),this.onNavigate(this.slideController.page,"keydown");break}case"ArrowRight":case"ArrowDown":{this.slideController.slide.nextStep(),this.onNavigate(this.slideController.page,"keydown");break}}})}renderOverlay(){if(!this.$overlay){const S=document.createElement("div");S.className=this.wrapClassName("overlay"),this.$overlay=S}return this.$overlay}renderSlideContainer(){if(!this.$slide){const S=document.createElement("div");S.className=this.wrapClassName("slide"),S.dataset.appKind="Slide",this.$slide=S}return this.$slide}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view")),this.$whiteboardView}mount(){return this.box.mountContent(this.viewer.$content),this.box.mountFooter(this.viewer.$footer),this.slideController=this.mountSlideController({anchor:this.$slide,onRenderStart:this.onRenderStart,onRenderEnd:this.onRenderEnd,onTransitionStart:this.viewer.setPlaying,onTransitionEnd:this.viewer.setPaused,onReady:this.refreshPages,onNavigate:this.onNavigate,onError:this.onError}),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit))),this}getPageIndex(S){return(S>0?S:1)-1}unmount(){return this.slideController&&(this.slideController.destroy(),this.slideController=null),this.viewer.unmount(),this}setReadonly(S){this.viewer.setReadonly(S)}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}toggleClickThrough(S){this.$whiteboardView.style.pointerEvents=!S||C_.has(S)?"none":"auto"}wrapClassName(S){return`${this.namespace}-${S}`}async getWhiteSnapshot(S,v,O,R,M){const D={centerX:0,centerY:0,scale:Math.min(v.width/R,v.height/M)},B=`${this.baseScenePath}/${S}`,z=this.context.manager.windowManger;z._appliancePlugin?await z._appliancePlugin.screenshotToCanvasAsync(O,B,v.width,v.height,D):this.whiteboardView.screenshotToCanvas(O,B,v.width,v.height,D)}reportProgress(S,v){window.postMessage({type:"@netless/_result_save_pdf_",appId:this.appId,progress:S,result:v})}}let Zh=!1;Fi.FreezerLength=2;function P_(){return Fi.FreezerLength}function O_(b){Fi.FreezerLength=b<1?1/0:b}const fa=b=>"["+b+"]",pl={map:new Map,boxes:new Map,queue:[],validateQueue(){for(this.queue.sort((b,S)=>{var R,M,D,B;const v=(M=(R=this.boxes.get(b))==null?void 0:R.zIndex)!=null?M:0,O=(B=(D=this.boxes.get(S))==null?void 0:D.zIndex)!=null?B:0;return-(v-O)}),ei("[Slide] freezer: validate",fa(this.queue));this.queue.length>Fi.FreezerLength;){const b=this.queue.pop(),S=this.map.get(b);S&&(ei("[Slide] freezer: validate-freeze",b,fa(this.queue)),S.freeze())}},set(b,S,v){ei("[Slide] freezer: add",b,fa(this.queue)),this.map.set(b,S),this.boxes.set(b,v),this.queue.includes(b)||this.queue.unshift(b),this.validateQueue()},delete(b){this.map.delete(b),this.boxes.delete(b),this.queue=this.queue.filter(S=>S!==b),ei("[Slide] freezer: delete",b,fa(this.queue))},focus(b){const S=this.map.get(b),v=this.queue.indexOf(b);v>-1&&this.queue.splice(v,1),this.queue.unshift(b),this.validateQueue(),ei("[Slide] freezer: focus",b,fa(this.queue)),S&&S.unfreeze()}},Kh=new Set;function L_(b){return Kh.add(b),()=>Kh.delete(b)}const $h=new Set;function N_(b){return $h.add(b),()=>$h.delete(b)}const D_=b=>{Zh=!0,b.on("focus",({appId:S})=>{pl.focus(S)}),b.on("created",({appId:S})=>{Kh.forEach(v=>v(S))}),b.on("destroy",({appId:S})=>{$h.forEach(v=>v(S))})};var Vd=`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:block;position:fixed;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;z-index:300;top:0;right:0;width:23%;padding:12px;box-shadow:-4.8px -3.2px 20px #20233826;transition:transform .4s;background:#f5f5fc;border-radius:4px;-webkit-box-shadow:-4.8px -3.2px 20px rgba(32,35,56,.15);height:100%;position:absolute}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0);opacity:1}.netless-app-slide-preview-head{display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:10px}.netless-app-slide-preview-head>h3{color:#484c70;font-weight:400;font-size:14px;width:calc(100% - 20px);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.netless-app-slide-preview-head .netless-app-slide-close{width:25px;height:25px;padding:0;outline:none;border:none;background:#fff;display:flex;justify-content:center;align-items:center;border-radius:100%;cursor:pointer}.netless-app-slide-preview-head .netless-app-slide-close button{width:22px;height:22px;padding:0;outline:none;border:none;background:center/cover no-repeat;background-image:url(./icons/close.svg)}.netless-app-slide-preview-page{position:relative;display:flex;width:100%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border-radius:4px;transition:border-color .3s;user-select:none;align-items:flex-end}.netless-app-slide-preview-page>img{width:calc(90% - 10px);height:auto;box-sizing:border-box;border:2px solid rgba(0,0,0,.5);border-radius:2px;background-color:#fff}.netless-app-slide-preview-page>img.netless-app-slide-active{border-color:#ff5353}.netless-app-slide-preview-page-name{text-align:right;font-size:12px;color:#8d8fa6;user-select:none;margin-right:10px;width:5%}.netless-app-slide-footer{box-sizing:border-box;height:2.778vw;display:flex;align-items:center;padding:0 1.11vw;color:#191919;background:#ebecfa}.netless-app-slide-note{width:80%;max-height:200px;padding:14px;position:absolute;left:10%;bottom:15px;z-index:102;background-color:#00000080;border-radius:14px}.netless-app-slide-note-content{color:#fff}.netless-app-slide-note-content a{color:#fff;text-decoration:underline}.netless-app-slide-note-hide{display:none}.netless-app-slide-float-footer{width:100%;min-height:2.778vw;position:absolute;left:0;bottom:0;z-index:2000;transition:opacity .4s;color:#191919}.netless-app-slide-footer-btn{box-sizing:border-box;width:1.81vw;height:1.81vw;font-size:0;margin:0;padding:3px;border:none;border-radius:4px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);color:#8d8fa6}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-disable{color:#c6c7d2;cursor:not-allowed}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-disable .arrow{fill:#c6c7d2}.netless-app-slide-footer-btn .arrow{fill:#8d8fa6}.netless-app-slide-footer-btn:hover{background-color:#1b1f4d0a}@media (hover: none){.netless-app-slide-footer-btn:hover{background:transparent!important}}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-hide{visibility:hidden}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center;gap:.556vw}.netless-app-slide-page-number{font-size:1vw;color:#8d8fa6;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 2px;text-align:right;font-size:1vw;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer,.netless-app-slide-readonly.netless-app-slide-note{display:none}.telebox-color-scheme-dark .netless-app-slide-page-number-input{color:#a6a6a8}.telebox-color-scheme-dark .netless-app-slide-page-number-input:active,.telebox-color-scheme-dark .netless-app-slide-page-number-input:focus,.telebox-color-scheme-dark .netless-app-slide-page-number-input:hover{color:#222}.telebox-color-scheme-dark .netless-app-slide-footer{color:#a6a6a8;background:#2d2d33;border-top:none}.telebox-color-scheme-dark .netless-app-slide-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-slide-preview{background:rgba(50,50,50,.9)}.netless-app-slide-loading{display:flex;justify-content:center;align-items:center;width:100%;height:100%;position:absolute;top:0;left:0;z-index:200;background:white}.netless-app-slide-loader{border:4px solid rgb(57,171,255);border-left-color:transparent;width:36px;height:36px;animation:spin 1s linear infinite;border-radius:100%}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden;transition:opacity .2s}.netless-app-slide-wb-view-hidden{opacity:0}.netless-app-slide-overlay{display:flex;align-items:center;justify-content:center;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%;padding:8px;background:rgba(255,0,0,.25);transition:opacity .3s;opacity:0;pointer-events:none}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`;function F_({container:b,taskId:S,resourceList:v=[],url:O=Fh,debug:R=!1,box:M}){if(!S)throw new Error("[Slide] taskId is required");b.style.cssText+="display:flex;flex-direction:column";const D=new Wd({target:b,box:M});return D.debug=!!R,D.mount(S,O,v),D}class Wd{constructor(S){this.slide=null,this.debug=!1,this.previewList=[],this.sideEffect=new sa,this.ready=!1,this.readyPromise=new Promise(v=>{this.resolveReady=()=>{this.ready=!0,v()}}),this.hotkeyListener=v=>{if(this.slide)switch(v.key){case"ArrowUp":case"ArrowLeft":{this.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slide.nextStep();break}}},this.onPageChanged=v=>{this.viewer.setPageIndex(v-1)},this.onTransitionStart=()=>{},this.onTransitionEnd=()=>{},this.onError=({error:v})=>{console.warn("[Slide] render error",v)},this.destroyed=!1,this.refreshPages=()=>{this.slide&&(this.viewer.pages=sd(this.slide,this.previewList),this.viewer.setPageIndex(this.getPageIndex(this.slide.slideState.currentSlideIndex)))},this.onPlay=()=>{this.slide&&this.slide.nextStep()},this.onNewPageIndex=v=>{this.slide&&this.slide.slideCount>0&&this.slide.renderSlide($c(v+1,1,this.slide.slideCount))},this.namespace="netless-app-slide",this.target=S.target,this.bgColor=od(this.target),this.viewer=new zd({readonly:!1,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay,box:S.box}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.registerHotKeys(window)}registerHotKeys(S){this.sideEffect.addEventListener(S,"keydown",this.hotkeyListener,void 0,"hotkey")}mount(S,v,O,R=[]){this.target.appendChild(this.renderStyle()),this.target.appendChild(this.viewer.$content),this.target.appendChild(this.viewer.$footer),this.slide=new ai.Slide({anchor:this.$slide,interactive:!0,mode:"local",controller:this.debug,enableGlobalClick:!0,enableAutoForward:!0,skipActionWhenFrozen:!0,renderOptions:{minFPS:5,maxFPS:15,autoFPS:!0,autoResolution:!0,transactionBgColor:this.bgColor,transitionResolutionLevel:1,maxResolutionLevel:1},antialias:!1}),this.registerEventListeners(),O.length>0?this.slide.setResourceList(S,O):this.slide.setResource(S,v),this.slide.renderSlide(1),this.previewList=R}renderStyle(){const S=document.createElement("style");return S.appendChild(document.createTextNode(Vd)),S}registerEventListeners(){if(!this.slide)return;const{slide:S}=this;S.on(ai.SLIDE_EVENTS.slideChange,this.onPageChanged),S.on(ai.SLIDE_EVENTS.renderStart,this.onTransitionStart),S.on(ai.SLIDE_EVENTS.renderEnd,this.onTransitionEnd),S.on(ai.SLIDE_EVENTS.mainSeqStepStart,this.onTransitionStart),S.on(ai.SLIDE_EVENTS.mainSeqStepEnd,this.onTransitionEnd),S.on(ai.SLIDE_EVENTS.renderError,this.onError),S.on(ai.SLIDE_EVENTS.renderEnd,this.resolveReady),this.readyPromise.then(this.refreshPages)}destroy(){this.sideEffect.flushAll(),this.slide&&!this.destroyed&&(this.slide.destroy(),this.destroyed=!0),this.viewer.destroy()}getPageIndex(S){return(S>0?S:1)-1}renderSlideContainer(){if(!this.$slide){const S=document.createElement("div");S.className=this.wrapClassName("slide"),S.dataset.appKind="Slide",this.$slide=S}return this.$slide}wrapClassName(S){return`${this.namespace}-${S}`}}const B_=ai.Slide.usePlugin.bind(ai.Slide),ws="0.2.81-wukongBeta.11",k_={kind:"Slide",setup(b){var pt,Nt;ei("SDK \u7248\u672C\u4FE1\u606F-App App Slide "+ws);const S=document.createElement("div");if(S.style.position="absolute",S.style.top="230px",S.style.left="0",S.style.color="red",S.style.fontSize="12px",S.style.zIndex="99999",S.innerHTML=`SDK \u7248\u672C\u4FE1\u606F-App App Slide ${ws}`,document.body.appendChild(S),console.log("[Slide] setup @ "+ws),console.log("[Slide] setup @111 "+ws),b.getIsWritable()&&b.storage.ensureState(Bh),!b.storage.state.taskId)throw new Error("[Slide] no taskId");const v=b.getView();if(!v)throw new Error("[Slide] no view, please set scenePath on addApp()");v.disableCameraTransform=!0;const O=b.getBox();O.mountStyles(Vd);try{O.$content.dataset.appSlideVersion=ws}catch{}const R=b.getInitScenePath();let M=null,D=!0;const B=()=>{D=!1},z=vt=>{const L=b.getRoom();if(M&&M.slideController){let I=!1;L&&b.getIsWritable()&&(ei("[Slide] xxxxxxxxxxxx1111111111 ",vt),D?(ad(L,b,M.slideController.slide,R),I=!0):D=!0),ei("[Slide] page to",vt,I?"(synced)":""),M.viewer.setPageIndex(vt-1),M.onPageChanged();const F=M.viewer.pages.length;F>0&&b.dispatchAppEvent("pageStateChange",{index:vt-1,length:F})}},X=vt=>{const L=b.getAppOptions()||{},I=new yv({context:b,...vt,onPageChanged:z,onNavigate:vt.onNavigate,onRenderError:L.onRenderError,showRenderError:L.showRenderError,invisibleBehavior:L.invisibleBehavior},B);return Zh&&pl.set(b.appId,I,O),Ar.setAppController(b.appId,I),I.readyPromise.then(vt.onReady).then(()=>{const F=b.getRoom();let W=!1;F&&b.getIsWritable()&&(ei("[Slide] xxxxxxxxxxxxxxxxxxxxxx444444444 ",R),ad(F,b,I.slide,R),W=!0);const P=I.slide.slideState.currentSlideIndex;ei("[Slide] page to",P,W?"(synced)":"","(on ready)"),I.slide.on("renderEnd",vt.onRenderEnd)}),I};M=new I_({context:b,box:O,view:v,mountSlideController:X,mountWhiteboard:b.mountView.bind(b),baseScenePath:R,appId:b.appId,urlInterrupter:(pt=b.getAppOptions())==null?void 0:pt.urlInterrupter,onPagesReady:({length:vt})=>{const L=(M==null?void 0:M.viewer.pageIndex)||0;b.dispatchAppEvent("pageStateChange",{index:L,length:vt})},onNavigate:(vt,L)=>{ei("[Slide] user navigate to",vt,L?`(${L})`:"")}}),(Nt=b.getAppOptions())!=null&&Nt.justSildeReadonly&&(M==null||M.setJustSildeReadonly(!0));const J=b.getRoom(),et=new sa;return et.add(()=>{var vt;return Ar.setAppContext(b.appId,b),Ar.enable=((vt=b.getAppOptions())==null?void 0:vt.debug)||!1,Ar.level="debug",()=>Ar.deleteApp(b.appId)}),J&&(M.toggleClickThrough(J.state.memberState.currentApplianceName),et.add(()=>{const vt=L=>{L.memberState&&M&&M.toggleClickThrough(L.memberState.currentApplianceName)};return J.callbacks.on("onRoomStateChanged",vt),()=>J.callbacks.off("onRoomStateChanged",vt)})),b.emitter.on("destroy",()=>{ei("[Slide] destroy",b.appId),Zh&&pl.delete(b.appId),et.flushAll(),M&&(M.destroy(),M=null)}),M.mount(),{setSildeReadonly:vt=>{M==null||M.setJustSildeReadonly(vt)},viewer:()=>M,controller:()=>M==null?void 0:M.slideController,slide:()=>{var vt;return(vt=M==null?void 0:M.slideController)==null?void 0:vt.slide},nextStep:()=>{var vt;if(M){if((vt=M==null?void 0:M.slideController)!=null&&vt.slide.hasNextStep())M.slideController.slide.nextStep();else{const L=M==null?void 0:M.slideController;if(L){const{page:I,pageCount:F}=L;F>0&&I<F&&L.jumpToPage(I+1)}}return!0}return!1},prevStep:()=>{var vt;return M&&M.slideController?((vt=M==null?void 0:M.slideController)==null||vt.slide.prevStep(),!0):!1},position:()=>{const vt=M==null?void 0:M.slideController;if(vt)return[vt.page,vt.pageCount]},nextPage:()=>{const vt=M==null?void 0:M.slideController;if(vt){const{page:L,pageCount:I}=vt;if(I>0&&L<I)return vt.jumpToPage(L+1),!0}return!1},prevPage:()=>{const vt=M==null?void 0:M.slideController;if(vt){const{page:L,pageCount:I}=vt;if(I>0&&L>1)return vt.jumpToPage(L-1),!0}return!1},jumpToPage:vt=>{const L=M==null?void 0:M.slideController;if(L){const{page:I,pageCount:F}=L;if(F>0&&I>0&&I<=F)return L.jumpToPage(vt),!0}return!1},togglePreview:vt=>{M==null||M.viewer.togglePreview(vt)},getNoteHasLink:()=>{var vt;return(vt=M==null?void 0:M.viewer.getNoteHasLink())!=null?vt:!1},getNoteLink:()=>M==null?void 0:M.viewer.getNoteLink(),toggleNoteVisible:vt=>M==null?void 0:M.viewer.toggleNoteVisible(vt),getNoteVisible:()=>M==null?void 0:M.viewer.getNoteVisible(),getNotes:()=>M==null?void 0:M.viewer.getNotes()}}};return Fi.DefaultUrl=Fh,Fi.Slide=ai.Slide,Fi.SlidePreviewer=Wd,Fi.addHooks=D_,Fi.apps=pl,Fi.default=k_,Fi.getFreezerLength=P_,Fi.onCreated=L_,Fi.onDestroyed=N_,Fi.previewSlide=F_,Fi.setFreezerLength=O_,Fi.usePlugin=B_,Fi.version=ws,Object.defineProperties(Fi,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Fi}({});
//# sourceMappingURL=main.iife.js.map
